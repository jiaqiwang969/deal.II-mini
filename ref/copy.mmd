
\title{
Numerical Models for Differential Problem
}

\author{
Alfio Quarteroni
翻译：Jiaqi
}




\textbf{Preface to the second edition}

微分方程（DEs）是许多实际应用的数学模型的基础。这些方程很少能以 "封闭" 形式求解：事实上，准确的解决方案很少能通过明确的、容易计算的数学公式来描述。几乎无一例外的是，人们不得不求助于适当的数值方法，其范围是精确微分模型的近似（或离散化），因此也是精确解。

本书是首次出现在 $2009$ 的第二版。它以相当全面地方式介绍了一些处理微分方程的最成功的数值方法，用于分析和应用于通常在应用中出现的问题类别。

尽管我们主要处理偏微分方程（PDEs），包括稳定问题（在多个空间维度）和时间依赖问题（有一个或几个空间变量），但部分材料专门用于一维边界值问题的常微分方程（ODEs），特别是当讨论本身很有趣或与PDE情况有关时。

主要关注的是有限元（FE）方法，它是工程设计和分析中最流行的离散化技术。我们还讨论了其他技术，尽管程度较低，如有限差分（FD）、有限体积（FV）和频谱方法，包括针对特定类型问题的进一步ad-hoc的特别方法。对不同方法性能的比较评估进行了讨论，特别是当它揭示了它们之间的相互作用。

我们还介绍和分析了旨在降低微分问题计算复杂性的数值策略：这些策略包括用于时间离散化的算子分割和分数步法、预处理、网格适应性技术、用于并行计算的域分解（DD）方法，以及用于有效解决参数化PDEs的reduce-basis（RB）方法。

除了经典的椭圆、抛物线和双曲线线性方程外，我们还处理大量应用领域中出现的更多的模型问题：线性和非线性守恒定律、具有支配性平流的平流-扩散方程、纳维尔-斯托克斯方程、鞍点问题和最优控制问题。

以下是各章的内容摘要。第1章简要调查了PDEs及其分类，第2章则介绍了全书中广泛使用的函数分析的主要概念和理论结果。

在第三章中，我们说明了椭圆方程的边界值问题（一维和数维），提出了它们的弱式或变式表述，处理了边界条件，并分析了良好处理性。还介绍了几个有物理意义的例子。

本书的第一块基石是第四章，在这一章中，我们提出了椭圆边界值问题数值离散化的Galerkin方法，并在一个抽象的函数环境中对其进行分析。然后我们介绍了Galerkin有限元方法，为了方便读者，首先是一维的，然后是多维的。我们构造了FE空间和FE插值算子，证明了稳定性和收敛性结果，并推导了几种误差估计。最后，我们提出了基于先验或后验误差估计的网格自适应程序。

第五章解释了抛物线问题的数值逼近：我们从半离散（时间上连续）的Galerkin逼近开始，然后考虑基于FD方案的时间离散的全离散逼近。这两种方法的稳定性和收敛性都得到了证明。

第6、7和8章专门讨论FE方法的算法特点和实际实施。更具体地说，第6章说明了网格生成的主要技术，第7章调查了解决由PDEs近似产生的无条件线性代数系统的基本算法，第8章介绍了FE代码的主要操作阶段，以及一个完整的工作实例。

第九章讨论了用于逼近扩散运动反应方程的有限体积方法的基本原理。由于其固有的、内在的守恒特性，有限体积方法在计算流体力学中得到普遍使用。

第10章讨论了谱系方法（Galerkin、collocation和谱系元素法）的多面性，彻底分析了其优越的精度特性的原因。

依靠不连续多项式子空间的Galerkin离散化技术是第12章的主题。我们更具体地介绍了不连续Galerkin(DG)方法和迫击炮方法，以及它们在有限元或谱元背景下的应用。

第13章重点讨论奇异扰动的椭圆边界值问题，特别是扩散运输方程和扩散反应方程，具有小的扩散。这类问题的精确解在计算域的微小子区域，即所谓的内部或边界层，可以表现出陡峭的梯度。对稳定技术给予了很大的关注，以防止振荡数值解的出现。我们讨论了FD近似的上卷技术，并分析了它们与$\mathrm{FE}$人工扩散的相似性。我们还介绍和讨论了$\mathrm{FE}$背景下的其他稳定方法，这导致了子网格广义Galerkin方法、Petrov-Galerkin方法和Galerkin的最小二乘法。

接下来的三章构成了一个主题单元，重点是一阶双曲方程的逼近。第14章讨论经典的FD方法。使用能量法和Von Neumann分析法研究了稳定性。利用后者，我们还分析了一个数值方案所具有的耗散和分散的特性。第15章专门讨论用$\mathrm{FE}$方法进行空间逼近，包括DG方法和谱系方法。特别强调了双曲系统边界处理的特征相容条件。第16章对非线性对偶定律的数值逼近有一个非常快速的概述。由于这一特定主题的相关性，建议感兴趣的读者查阅参考文献中提到的具体专著。

在第17章中，我们讨论了不可压缩流的Navier-Stokes方程，以及用FE、FV和谱系方法对其进行数值逼近。为鞍点问题的空间逼近提出了一般的稳定性和收敛性理论，其中包括稳定化的策略。接下来，我们提出并分析了一些时间微分方法，其中包括有限差分法、特征法、分数阶梯法和代数因子化技术。特别注意的是在多相流的情况下对界面的数值处理。

第18章讨论了椭圆PDEs的最优控制问题。该问题首先是在连续水平上提出的，其中使用两种不同的方法获得了最优性条件。然后我们讨论了优化和数值近似之间的相互作用。我们提出了几个例子，其中一些是初级的，另一些涉及到具有应用意义的物理过程。

第19章是领域分解方法。这些技术是专门为并行计算和处理多物理学的PDE问题而设计的。说明了Schwarz方法（有重叠的子域）和Schur方法（有不相连的子域）系列，并研究了它们的最优性（网格不变性）和可扩展性（子域大小不变性）的收敛特性。提供了几个域分解预处理的例子，并进行了数值测试。

最后，在第20章中，我们介绍了用于有效解决PDEs的reduce-basis $(\mathrm{RB})$方法。reduce-basis方法允许快速可靠地评估输入/输出关系，其中输出被表达为一个场变量的函数，是一个参数化PDE的解决方案。参数化PDEs模拟了几个与应用有关的过程，如热量或质量的稳定和非稳定转移、声学、固体和流体力学等，仅举几例。输入参数向量以各种方式描述了领域的几何配置、物理特性、边界条件或源条款。与有效的后验误差估计相结合，以及离线和在线计算的分割，是$\mathrm{RB}$方法在计算上取得成功的关键因素。

许多本应得到适当处理的重要议题只被部分触及（在某些情况下完全被忽略）。这一方面取决于提供一本合理规模的教科书的愿望，另一方面取决于我们自己的经验。值得注意的遗漏清单包括，例如，结构分析的方程近似和电磁波的传播。详细的研究可以在参考文献的专业文献中找到。

本书主要面向数学、工程、物理和计算机科学的研究生，以及更广泛的计算科学家。每一章都是为了在一个特定的主题上提供一个连贯的教学单元。特别是前八章，应被视为关于椭圆和抛物线PDEs有限元的全面和自足的论述。第9-17章是关于PDEs数值方法的高级课程，而最后三章包含了复杂PDE问题的数值求解的更微妙和复杂的主题。

这部作品已被用作米兰理工大学和洛桑联邦理工学院研究生水平课程的教科书。我们要感谢许多人--学生、同事和读者--他们在不同的阶段以不同的方式为本书的编写和早期草稿的改进做出了贡献。一个（远非完整的）名单包括Paola Antonietti, Luca Dedè, Marco Discacciati, Luca Formaggia, Loredana Chapter 1

\section{A brief survey of partial differential equations}

本章的目的是回顾与偏微分方程（简称PDEs）有关的基本概念。更广泛的覆盖面见[RR04, Eva98, LM68, Sal08]。

\subsection{Definitions and examples}

偏微分方程是包含未知函数相对于几个变量（时间或空间）的导数的微分方程。特别是，如果我们用$u$表示$d+1$独立变量 $\mathbf{x}=\left(x_{1}, \ldots, x_{d}\right)^{T}$和$t$中的未知函数，我们用以下方式表示

!!!!
\mathscr{P}(u, g)=F\left(\mathbf{x}, t, u, \frac{\partial u}{\partial t}, \frac{\partial u}{\partial x_{1}}, \ldots, \frac{\partial u}{\partial x_{d}}, \ldots, \frac{\partial^{p_{1}+\cdots+p_{d}+p_{t}} u}{\partial x_{1}^{p_{1}} \ldots \partial x_{d}^{p_{d}} \partial t^{p_{t}}}, g\right)=0
\label{1.1}\end{equation}

一个通用的PDE，$g$是PDE所依赖的数据集，而$p_{1}, \ldots, p_{d}, p_{t}$,

如果$q$是方程中出现的偏导数的最大阶数，即整数$p_{1}+p_{2}+\ldots+p_{d}+p_{t}$ 所取的最大值，我们说\ref{1.1}是$q$阶的。

如果\ref{1.1}线性地依赖于未知数$u$及其导数，则称该方程为线性的。在特殊情况下，具有最大阶的导数只以线性方式出现（系数可能取决于低阶导数），该方程被称为准线性。当它是准线性的，并且最大阶导数的系数只取决于$\mathbf{x}$和$t$，而不取决于解$u$时，它被称为半线性。最后，如果方程不包含独立于未知函数$u$的项，则称该PDE为同质性的。

我们在下面列出一些应用科学中经常遇到的PDE的例子。

例1.1.一个一阶线性方程是传输（或平流）方程

!!!!
\frac{\partial u}{\partial t}+\nabla \cdot(\boldsymbol{\beta} u)=0
\label{1.2}\end{equation}

表示的是

!!!!
\nabla \cdot \mathbf{v}=\operatorname{div}(\mathbf{v})=\sum_{i=1}^{d} \frac{\partial v_{i}}{\partial x_{i}}, \quad \mathbf{v}=\left(v_{1}, \ldots, v_{d}\right)^{T}
$$

的发散算子。在区域$\Omega \subset \mathbb{R}^{d},(1.2)$上的积分表达了占据区域$\Omega$的物质系统（连续介质）的质量守恒。$u$变量是系统的密度，而$\boldsymbol{\beta}(\mathbf{x}, \mathbf{t})$是系统中的粒子在时间$t$占据位置$\mathbf{x}$的速度。

例1.2.线性二阶方程包括：电位方程

!!!!
-\Delta u=f,
\label{1.3}\end{equation}

描述流体在均匀和各向同性区域的扩散$\Omega \subset \mathbb{R}^{d}$，但也描述弹性膜的垂直位移；热（或扩散）方程。

!!!!
\frac{\partial u}{\partial t}-\Delta u=f
\label{1.4}\end{equation}

波浪方程

!!!!
\frac{\partial^{2} u}{\partial t^{2}}-\Delta u=0
\label{1.5}\end{equation}

我们用

!!!!
\Delta u=\sum_{i=1}^{d} \frac{\partial^{2} u}{\partial x_{i}^{2}}
\label{1.6}\end{equation}

拉普拉斯算子（Laplacian）

例1.3.一个准线性一阶方程的例子是Burgers方程

!!!!
\frac{\partial u}{\partial t}+u \frac{\partial u}{\partial x_{1}}=0
$$

而它的变体是通过添加二阶扰动得到的

!!!!
\frac{\partial u}{\partial t}+u \frac{\partial u}{\partial x_{1}}=\varepsilon \frac{\partial^{2} u}{\partial x_{1}^{2}}, \quad \varepsilon>0
$$

是一个半线性方程的例子。

另一个二阶的非线性方程，是

!!!!
\left(\frac{\partial^{2} u}{\partial x_{1}^{2}}\right)^{2}+\left(\frac{\partial^{2} u}{\partial x_{2}^{2}}\right)^{2}=f
$$

如果一个函数$u=u\left(x_{1}, \ldots, x_{d}, t\right)$与它的所有导数一起被替换到(1.1)中，它就会使(1.1)成为一个同位数，那么就可以说它是(1.1)的一个解(或一个特殊的积分)。$(1.1)$的所有解的集合被称为$(1.1)$的一般积分。

例1.4.一维情况下的传输方程。

!!!!
\frac{\partial u}{\partial t}-\frac{\partial u}{\partial x_{1}}=0
\label{1.7}\end{equation}


承认一个形式为$u=w\left(x_{1}+t\right), w$的一般积分是一个足够规则的任意函数（见练习2）。同样地，一维波浪方程

!!!!
\frac{\partial^{2} u}{\partial t^{2}}-\frac{\partial^{2} u}{\partial x_{1}^{2}}=0
\label{1.8}\end{equation}

作为一个一般积分，承认

!!!!
u\left(x_{1}, t\right)=w_{1}\left(x_{1}+t\right)+w_{2}\left(x_{1}-t\right)
$$

$w_{1}$和$w_{2}$是两个足够规则的任意函数（见练习3）。

例1.5。让我们考虑一维热方程

!!!!
\frac{\partial u}{\partial t}-\frac{\partial^{2} u}{\partial x_{1}^{2}}=0
$$

为$0<x_{1}<1$和$t>0$，边界条件为

!!!!
u(0, t)=u(1, t)=0, \quad t>0
$$

和初始条件$\left.u\right|_{t=0}=u_{0}$ 。其解为

!!!!
u\left(x_{1}, t\right)=\sum_{j=1}^{\infty} u_{0, j} e^{-(j \pi)^{2} t} \sin \left(j \pi x_{1}\right)
$$

其中$u_{0}=u_{\mid t=0}$是初始基准点，而

!!!!
u_{0, j}=2 \int_{0}^{1} u_{0}\left(x_{1}\right) \sin \left(j \pi x_{1}\right) d x_{1}, \quad j=1,2, \ldots
$$

\subsection{Numerical solution}

一般来说，不可能以封闭（显式）形式获得\ref{1.1}的解。事实上，现有的分析积分方法（如变量分离技术）的适用性是有限的。另一方面，即使在一般积分已知的情况下，也不能保证特定的积分可以被确定。事实上，为了得到后者，有必要在域$\Omega$的边界处对$u$（和/或其导数）赋予适当的条件。此外，从所提供的例子中可以看出，一般的积分取决于一些任意的函数（而不是任意的常数，就像常微分方程那样），因此，施加边界条件将导致解决通常相当复杂的数学问题。

因此，从理论的角度来看，对一个给定的PDE的分析往往注定要研究其解的存在性、唯一性和可能的规则性，但缺乏实际的工具来确定它们。

由此可见，掌握数值方法是非常重要的，这些方法可以构建精确解$u$的近似值$u_{N}$，并评估（以某种合适的准则）将精确解$u$替换为近似解$u_{N}$时的误差$u_{N}-u$ 。一般来说，$N \geq 1$是一个正整数，表示近似问题的（有限的）维度。从原理上讲，我们将得到以下情况。

我们用$g_{N}$表示PDE所依赖的数据集$g$的近似，用$\mathscr{P}_{N}$表示描述近似问题的新函数关系。为了简单起见，我们写成$u=u(g)$和$u_{N}=u_{N}\left(g_{N}\right)$ 。


我们将从第4章开始介绍几种数值方法，在此，我们只回顾其主要特点。一个数值方法是收敛的，如果

!!!!
\left\|u-u_{N}\right\| \rightarrow 0 \quad \text { as } N \rightarrow \infty
$$

对于一个给定的准则。更确切地说，我们有收敛性，当且仅当

!!!!
\begin{aligned}
\forall \varepsilon>0, \exists N_{0}=N_{0}(\varepsilon)>0, \exists \delta=\delta\left(N_{0}, \varepsilon\right): \forall N>N_{0}, \forall g_{N} \text { such that }\left\|g-g_{N}\right\|<\delta \\
\left\|u(g)-u_{N}\left(g_{N}\right)\right\| \leq \varepsilon
\end{aligned}
$$

(用于数据的准则不一定与用于解决方案的准则相同）。)直接验证一个数值方法的收敛性可能并不容易。相反，建议对其一致性和稳定性进行验证。一个数值方法被认为是一致的，如果

!!!!
\mathscr{P}_{N}(u, g) \rightarrow 0 \text { as } N \rightarrow \infty
\label{1.9}\end{equation}

且强一致（或完全一致），如果

!!!!
\mathscr{P}_{N}(u, g)=0 \quad \forall N \geq 1
\label{1.10}\end{equation}

请注意,\ref{1.9}可以等价表述为

!!!!
\mathscr{P}_{N}(u, g)-\mathscr{P}(u, g) \rightarrow 0 \text { as } N \rightarrow \infty
$$

这表示$\mathscr{P}_{N}$（近似的PDE）"倾向于"$\mathscr{P}$（精确的PDE）的属性为$N \rightarrow \infty$ 。相反，我们说，如果数据的小扰动对应于解决方案的小扰动，那么数值方法是稳定的。更确切地说。

!!!!
\forall \varepsilon>0, \exists \delta=\delta(\varepsilon)>0: \forall \delta g_{N}:\left\|\delta g_{N}\right\|<\delta \Rightarrow\left\|\delta u_{N}\right\| \leq \varepsilon, \forall N \geq 1
$$

$u_{N}+\delta u_{N}$是扰动问题的解

!!!!
\mathscr{P}_{N}\left(u_{N}+\delta u_{N}, g_{N}+\delta g_{N}\right)=0
$$

(参见[QSS07, Chap 2]的深入报道）。

这个基本结果，经常被引用为Lax-Richtmyer等价定理，最终保证了

定理1.1.如果一个方法是一致和稳定的，那么它就是收敛的。

其他重要的属性显然会影响到数值方法的选择，例如它的收敛率（即相对于$1 / N$而言，误差趋于零的顺序）和它的计算成本，也就是在计算机上实现这种方法所需的计算时间和内存。

\subsection{PDE Classification}

偏微分方程可分为三个不同的系列：椭圆方程、抛物线方程和双曲线方程，对于每一个方程，我们将考虑适当的具体数值方法。为了简洁起见，在此我们将限于线性二阶PDE的情况，其系数为常数，形式为 $L u=G$ 。

!!!!
L u=A \frac{\partial^{2} u}{\partial x_{1}^{2}}+B \frac{\partial^{2} u}{\partial x_{1} \partial x_{2}}+C \frac{\partial^{2} u}{\partial x_{2}^{2}}+D \frac{\partial u}{\partial x_{1}}+E \frac{\partial u}{\partial x_{2}}+F u
\label{1.11}\end{equation}

(注意，$x_{i}$中的任何一个变量都可以代表时间变量。) 。在这种情况下，分类是根据判别符$\triangle=B^{2}-4 A C$的符号来进行的。特别是。

!!!!
\begin{array}{ll}
\text { if } \triangle<0 & \text { the equation is said to be elliptic, } \\
\text { if } \triangle=0 & \text { the equation is said to be parabolic, } \\
\text { if } \triangle>0 & \text { the equation is said to be hyperbolic. }
\end{array}
$$

例1.6.波浪方程\ref{1.8}是双曲的，而势能方程\ref{1.3}是椭圆的。抛物线问题的一个例子是由热方程\ref{1.4}给出的，但也由以下扩散-传输方程给出的

!!!!
\frac{\partial u}{\partial t}-\mu \Delta u+\nabla \cdot(\beta u)=0
$$

其中常数$\mu>0$和矢量场$\boldsymbol{\beta}$已经给出。上面介绍的标准使分类取决于最高导数的唯一系数，并通过下面的论证得到证明。读者会记得，二次代数方程

!!!!
A x_{1}^{2}+B x_{1} x_{2}+C x_{2}^{2}+D x_{1}+E x_{2}+F=G
$$

代表笛卡尔平面$\left(x_{1}, x_{2}\right)$上的双曲线、抛物线或椭圆，取决于$\triangle$是否为正数、空数或负数。这种平行关系促使人们为这三类偏导算子命名。

让我们更仔细地研究一下这三个类别之间的区别。让我们假设，在不做限制的情况下，$D, E, F$和$G$为空。我们寻找一种形式的变量变化，即

!!!!
\xi=\alpha x_{2}+\beta x_{1}, \quad \eta=\gamma x_{2}+\delta x_{1}
\label{1.12}\end{equation}

选择$\alpha, \beta, \gamma$和$\delta$，使$L u$成为$\partial^{2} u / \partial \xi \partial \eta$的倍数。由于

!!!!
\begin{aligned}
&L u=\left(A \beta^{2}+B \alpha \beta+C \alpha^{2}\right) \frac{\partial^{2} u}{\partial \xi^{2}} \\
&+(2 A \beta \delta+B(\alpha \delta+\beta \gamma)+2 C \alpha \gamma) \frac{\partial^{2} u}{\partial \xi \partial \eta}+\left(A \delta^{2}+B \gamma \delta+C \gamma^{2}\right) \frac{\partial^{2} u}{\partial \eta^{2}}
\end{aligned}
\label{1.13}\end{equation}

我们需要要求

!!!!
A \beta^{2}+B \alpha \beta+C \alpha^{2}=0, \quad A \delta^{2}+B \gamma \delta+C \gamma^{2}=0
\label{1.14}\end{equation}

如果$A=C=0$，琐碎的三段式$\xi=x_{2}, \eta=x_{1}$（例如）以所需的形式提供$L u$。

然后让我们假设$A$或$C$不是空的。假设$A \neq 0$并不是限制性的。那么，如果$\alpha \neq 0$和$\gamma \neq 0$ ，我们可以用$(1.14)$的第一个方程除以$\alpha^{2}$，第二个方程除以$\gamma^{2}$ 。我们发现两个相同的二次方程的比率 $\beta / \alpha$ 和 $\delta / \gamma$ 。通过解决它们，我们可以得到

!!!!
\frac{\beta}{\alpha}=\frac{1}{2 A}[-B \pm \sqrt{\triangle}], \quad \frac{\delta}{\gamma}=\frac{1}{2 A}[-B \pm \sqrt{\triangle}]
$$

为了使变换(1.12)是非星形的，商$\beta / \alpha$和$\delta / \gamma$必须不同。因此，我们必须在一种情况下取正号，而在另一种情况下取负号。此外，我们必须假设$\triangle>0$ 。如果$\triangle$确实是空的，那么这两个分数仍然是重合的，而如果$\triangle$是负的，这两个分数都不可能是真的。最后，我们可以把下列数值作为变换\ref{1.12}的系数。

!!!!
\alpha=\gamma=2 A, \quad \beta=-B+\sqrt{\triangle}, \quad \delta=-B-\sqrt{\triangle}
$$

相应地，\ref{1.12} 变为

!!!!
\xi=2 A x_{2}+[-B+\sqrt{\triangle}] x_{1}, \quad \eta=2 A x_{2}+[-B-\sqrt{\triangle}] x_{1}
$$

并且，经过转换，原微分问题$L u=0$变成了

!!!!
L u=-4 A \triangle \frac{\partial^{2} u}{\partial \xi \partial \eta}=0
\label{1.15}\end{equation}


(为了便于记述，我们仍然用$u$表示转换后的解，用$L$表示转换后的微分算子）。)$A=0$和$C \neq 0$的情况可以用类似的方式处理，即取$\xi=x_{1}, \eta=x_{2}-(C / B) x_{1}$ 。

总而言之，基于变换\ref{1.12}，原项$L u$可以成为$\partial^{2} u / \partial \xi \partial \eta$的倍数，当且仅当$\triangle>0$ ，在这种情况下，正如我们所预期的，问题被称为双曲。很容易验证，问题\ref{1.15}的一般解是

!!!!
u=p(\xi)+q(\eta)
$$

$p$和$q$是单变量的任意可微函数。线$\xi=$常数和$\eta=$常数被称为$L$的特征，其特点是在这些线上，函数$p$和$q$分别保持常数。特别是，解$u$的可能的不连续沿特征线传播（这将在第14章中详细说明）。事实上，如果$A \neq 0$，通过识别$x_{1}$与$t$和$x_{2}$与$x$，转变为

!!!!
x^{\prime}=x-\frac{B}{2 A} t, \quad t^{\prime}=t
$$

对双曲算子$L$进行变换，使得

!!!!
L u=A \frac{\partial^{2} u}{\partial t^{2}}+B \frac{\partial^{2} u}{\partial t \partial x}+C \frac{\partial^{2} u}{\partial x^{2}}
$$

在波浪算子$L$的一个倍数中，使得

!!!!
L u=\frac{\partial^{2} u}{\partial t^{2}}-c^{2} \frac{\partial^{2} u}{\partial x^{2}}, \text { with } c^{2}=\triangle / 4 A^{2}
$$

后者是坐标系中以速度移动的波算子 $-B / 2 A$ 。波浪算子的特征线是验证以下内容的线

!!!!
\left(\frac{d t}{d x}\right)^{2}=\frac{1}{c^{2}}
$$

就是说

!!!!
\frac{d t}{d x}=\frac{1}{c} \quad \text { and } \quad \frac{d t}{d x}=-\frac{1}{c} .
$$

当$\triangle=0$，如前所述$L$是抛物线。在这种情况下，只存在一个$\beta / \alpha$的值，其中$\partial^{2} u / \partial \xi^{2}$在$(1.13)$中的系数变为零：准确地说，是$\beta / \alpha=-B /(2 A)$ 。另一方面，由于$B /(2 A)=2 C / B$，这个选择也意味着$\partial^{2} u / \partial \xi \partial \eta$的系数变为零。因此，变量的变化

!!!!
\xi=2 A x_{2}-B x_{1}, \quad \eta=x_{1}
$$

将原问题$L u=0$转换为以下内容

!!!!
L u=A \frac{\partial^{2} u}{\partial \eta^{2}}=0
$$

的一般解决方案，其形式为

!!!!
u=p(\xi)+\eta q(\xi)
$$

因此，一个抛物线算子只有一个特征族，正是$\xi=$的常数。$u$的导数的不连续性沿着这种特征线传播。

最后，如果$\triangle<0$（椭圆算子）不存在任何使系数$\beta / \alpha$和$\delta / \gamma$为空的选择。然而，变换

!!!!
\xi=\frac{2 A x_{2}-B x_{1}}{\sqrt{-\triangle}}, \quad \eta=x_{1}
$$

将$L u=0$转换为

!!!!
L u=A\left(\frac{\partial^{2} u}{\partial \xi^{2}}+\frac{\partial^{2} u}{\partial \eta^{2}}\right)=0
$$

即电位方程的一个倍数。因此，后者没有特征线族。

\subsubsection{Quadratic form associated to a PDE}

我们可以把所谓的主符号$S^{p}$与方程\ref{1.11}联系起来，定义为

!!!!
S^{p}(\mathbf{x}, \mathbf{q})=-A(\mathbf{x}) q_{1}^{2}-B(\mathbf{x}) q_{1} q_{2}-C(\mathbf{x}) q_{2}^{2}
$$

这个二次元形式可以用矩阵形式表示如下。

!!!!
S^{p}(\mathbf{x}, \mathbf{q})=\mathbf{q}^{T}\left[\begin{array}{cc}
-A(\mathbf{x}) & -\frac{1}{2} B(\mathbf{x}) \\
-\frac{1}{2} B(\mathbf{x}) & -C(\mathbf{x})
\end{array}\right] \mathbf{q}
\label{1.16}\end{equation}

如果一个二次函数形式的相关矩阵的所有特征值都有相同的符号（正或负），则称其为定值；如果矩阵有两种符号的特征值，则称其为不定值；如果矩阵是奇异的，则称其为退化的。

那么可以说，如果方程\ref{1.11}的二次形式\ref{1.16}是确定的（正或负），那么它就是椭圆的，如果它是不确定的，就是双曲的，如果它是退化的，就是抛物线的。与势方程\ref{1.3}、（一维）热方程\ref{1.4}和波方程\ref{1.5}相关的矩阵分别为

!!!!
\left[\begin{array}{ll}
1 & 0 \\
0 & 1
\end{array}\right],\left[\begin{array}{ll}
0 & 0 \\
0 & 1
\end{array}\right] \text { and }\left[\begin{array}{cc}
-1 & 0 \\
0 & 1
\end{array}\right]
$$

并且在第一种情况下是正定的，在第二种情况下是单数，在第三种情况下是不确定的。

\subsection{Exercises}

1.根据以下方程的顺序和线性度对其进行分类。

!!!!
\begin{aligned}
&\text { (a) }\left[1+\left(\frac{\partial u}{\partial x_{1}}\right)^{2}\right] \frac{\partial^{2} u}{\partial x_{2}^{2}}-2 \frac{\partial u}{\partial x_{1}} \frac{\partial u}{\partial x_{2}} \frac{\partial^{2} u}{\partial x_{1} \partial x_{2}}+\left[1+\left(\frac{\partial u}{\partial x_{2}}\right)^{2}\right] \frac{\partial^{2} u}{\partial x_{1}^{2}}=0 \\
&\text { (b) } \rho \frac{\partial^{2} u}{\partial t^{2}}+K \frac{\partial^{4} u}{\partial x_{1}^{4}}=f \\
&\text { (c) }\left(\frac{\partial u}{\partial x_{1}}\right)^{2}+\left(\frac{\partial u}{\partial x_{2}}\right)^{2}=f
\end{aligned}
$$

[解。  $(a)$准线性，二阶；它是普拉托方程，在适当的假设下，制约着流体的平面运动。方程中出现的$u$是所谓的动势；$(b)$线性，四阶。这是振动棒方程，$\rho$是棒的密度，而$K$是一个正量，取决于棒本身的几何特性；$(c)$非线性，一阶。]

2.将一维运输方程(1.7)还原为形式为$\partial w / \partial y=0$的方程，有设$y=x_{1}-t$，并得到$u=w\left(x_{1}+t\right)$是原方程的解。

[解：操作变量的替换 $z=x_{1}+t, y=x_{1}-t, u\left(x_{1}, t\right)=$ $w(y, z)$ 。这样 $\partial u / \partial x_{1}=\partial w / \partial z+\partial w / \partial y$ ，其中 $\partial u / \partial t=\partial w / \partial z-\partial w / \partial y$ ，从而 $-2 \partial w / \partial y=0$ 。此时请注意，由此得到的方程有一个不依赖于$y$的解$w(y, z)$，使用原来的变量，我们得到$\left.u=w\left(x_{1}+t\right) .\right]$ 。

3.证明波浪方程

!!!!
\frac{\partial^{2} u}{\partial t^{2}}-c^{2} \frac{\partial^{2} u}{\partial x_{1}^{2}}=0
$$

常数$c$，承认$u\left(x_{1}, t\right)=w_{1}\left(x_{1}+c t\right)+w_{2}\left(x_{1}-c t\right), w_{1}$和$w_{2}$是两个足够有规律的任意函数。[解：与练习二相同，应用变量$y=!!!!x_{1}+c t, z=x_{1}-c t$的替换，并设置$\left.u\left(x_{1}, t\right)=w(y, z) .\right]$。

4.验证Korteveg-de-Vries方程

!!!!
\frac{\partial u}{\partial t}+\beta \frac{\partial u}{\partial x_{1}}+\alpha \frac{\partial^{3} u}{\partial x_{1}^{3}}=0
$$

是一个形式为$u=a \cos \left(k x_{1}-\omega t\right)$的一般积分，适当的$\omega$有待确定，而$a, \beta$和$\alpha$是分配的常数。这个方程描述了在长波传播的情况下，流体相对于参考位置的位置$u$。

[解：给定的$u$只有在$\omega=k \beta-\alpha k^{3}$时满足方程。]

5.考虑方程式

!!!!
x_{1}^{2} \frac{\partial^{2} u}{\partial x_{1}^{2}}-x_{2}^{2} \frac{\partial^{2} u}{\partial x_{2}^{2}}=0
$$

与$x_{1} x_{2} \neq 0$ 。对其进行分类并确定其特征线。

6.考虑一般的二阶半线性微分方程

!!!!
a\left(x_{1}, x_{2}\right) \frac{\partial^{2} u}{\partial x_{1}^{2}}+2 b\left(x_{1}, x_{2}\right) \frac{\partial^{2} u}{\partial x_{1} \partial x_{2}}+c\left(x_{1}, x_{2}\right) \frac{\partial^{2} u}{\partial x_{2}^{2}}+f(u, \nabla u)=0
$$

其中$\nabla u=\left(\frac{\partial u}{\partial x_{1}}, \frac{\partial u}{\partial x_{2}}\right)^{T}$是$u$的梯度。写出其特征线的方程，并通过区分不同的情况，从中推导出拟议方程的分类。

7.设置 $r(\mathbf{x})=|\mathbf{x}|=\left(x_{1}^{2}+x_{2}^{2}\right)^{1 / 2}$ 并定义 $u(\mathbf{x})=\ln (r(\mathbf{x})), \mathbf{x} \in \mathbb{R}^{2} \backslash\{\mathbf{0}\}$ 。验证

!!!!
\Delta u(\mathbf{x})=0, \quad \mathbf{x} \in \Omega
$$

其中$\Omega$是任何给定的开放集，使得$\bar{\Omega} \subset \mathbb{R}^{2} \backslash\{\mathbf{0}\}$ .[解：观察到

!!!!
\left.\frac{\partial^{2} u}{\partial x_{i}^{2}}=\frac{1}{r^{2}}\left(1-\frac{2 x_{i}^{2}}{r^{2}}\right), \quad i=1,2 .\right]
$$



\section{Elements of functional analysis}

在这一章中，我们回顾了本教材中广泛使用的一些概念：函数和双线性形式、分布、Sobolev空间、［$\mathrm{L}^{p}$］空间。对于更深入的阅读，读者可以参考例如 [Sal08],[Yos74] , [Bre86] , [LM68] , [Ada75] 。

\subsection{Functionals and bilinear forms}

该函数通常被表示为$F(v)=\langle F, v\rangle$，这种表达方式被称为对偶性或钩码。如果一个函数相对于它的参数是线性的，那么就说它是线性的，即如果

!!!!
F(\lambda v+\mu w)=\lambda F(v)+\mu F(w) \quad \forall \lambda, \mu \in \mathbb{R}, \forall v, w \in V
$$

如果存在一个常数$C>0$，那么一个线性函数是有界的，以便

!!!!
|F(v)| \leq C\|v\|_{V} \quad \forall v \in V .
\label{2.1}\end{equation}

巴拿赫空间（即规范的完整空间）上的线性和有界函数也是连续的。然后我们定义空间$V^{\prime}$，称为$V$的对偶，作为$V$上的线性和有界函数的集合，即

!!!!
V^{\prime}=\{F: V \mapsto \mathbb{R} \text { such that } F \text { is linear and bounded }\}
$$

我们用规范$\|\cdot\|_{V^{\prime}}$来装备它，定义为

!!!!
\|F\|_{V^{\prime}}=\sup _{v \in V \backslash\{0\}} \frac{|F(v)|}{\|v\|_{V}} .
\label{2.2}\end{equation}

出现在$(2.1)$中的常数$C$大于或等于$\|F\|_{V^{\prime}}$。

以下定理，称为识别或表示定理（[Yos74]），成立。

![](https://cdn.mathpix.com/snip/images/1U0hqVD3TB0qF72flkh_MO__i7-FTXdVHVHdQQN-f3I.original.fullsize.png)

!!!!
f(y)=\left(y, x_{f}\right)_{H} \quad \forall y \in H, \quad \text { and } \quad\|f\|_{H^{\prime}}=\left\|x_{f}\right\|_{H}
\label{2.3}\end{equation}

Conversely, each element $x \in H$ identifies a linear and bounded functional $f_{x}$ on H such that

!!!!
f_{x}(y)=(y, x)_{H} \quad \forall y \in H \quad \text { and } \quad\left\|f_{x}\right\|_{H^{\prime}}=\|x\|_{H}
\label{2.4}\end{equation}



如果$H$是一个希尔伯特空间，那么它在$H$上的线性和有界函数的对偶空间$H^{\prime}$也是一个希尔伯特空间。此外，由于定理$2.1$，在$H^{\prime}$和$H$之间存在一个双射和等距（即规范保全）变换$f \leftrightarrow x_{f}$，由于这个变换，$H^{\prime}$和$H$可以被识别。我们可以用以下方式表示这种转换。

!!!!
\begin{array}{ll}
\Lambda_{H}: H \rightarrow H^{\prime}, & x \rightarrow f_{x}=\Lambda_{H} x \\
\Lambda_{H}^{-1}: H^{\prime} \rightarrow H, & f \rightarrow x_{f}=\Lambda_{H}^{-1} x
\end{array}
\label{2.5}\end{equation}

我们现在介绍fom的概念。

一份表格被称为。

如果它对它的两个参数都是线性的，也就是说，如果。

!!!!
\begin{array}{ll}
a(\lambda u+\mu w, v)=\lambda a(u, v)+\mu a(w, v) & \forall \lambda, \mu \in \mathbb{R}, \forall u, v, w \in V \\
a(u, \lambda w+\mu v)=\lambda a(u, v)+\mu a(u, w) & \forall \lambda, \mu \in \mathbb{R}, \forall u, v, w \in V
\end{array}
$$

如果存在一个常数$M>0$，使其连续，则

!!!!
|a(u, v)| \leq M\|u\|_{V}\|v\|_{V} \quad \forall u, v \in V
\label{2.6}\end{equation}

对称性，如果

!!!!
a(u, v)=a(v, u) \quad \forall u, v \in V ;
\label{2.7}\end{equation}

正（或正定），如果

!!!!
a(v, v)>0 \quad \forall v \in V
\label{2.8}\end{equation}

如果存在一个常数$\alpha>0$，使其具有强制力

!!!!
a(v, v) \geq \alpha\|v\|_{V}^{2} \quad \forall v \in V
\label{2.9}\end{equation}

定义2.3。设$X$和$Y$是两个希尔伯特空间。如果存在一个常数$C$，使得$\|w\|_{Y} \leq C\|w\|_{X}!!!!\forall w \in X$，我们说$X$包含在$Y$中，并有连续注入。此外，如果属于$X$的每个元素都可以作为$\|\cdot\|_{Y}$准则中$X$元素序列的极限而得到，则$X$在$Y$中是密集的。

给定两个希尔伯特空间$V$和$H$，如$V \subset H$，$V$在$H$的注入是连续的，而且$V$在$H$是密集的。那么，在识别了$H$和$H^{\prime}$之后， 

!!!!
V \subset H \simeq H^{\prime} \subset V^{\prime}
\label{2.10}\end{equation}

对于椭圆问题，空间$V$和$H$通常会被分别选择为$H^{1}(\Omega)$（或其子空间之一，$H_{0}^{1}(\Omega)$或$\left.H_{\Gamma_{D}}^{1}(\Omega)\right)$和$L^{2}(\Omega)$，见章节$3$。

定义2.4.两个函数空间$X$和$Y$之间的一个线性和有界（因此是连续的）算子$\mathscr{T}$是一个同构，如果它对空间$X$和$Y$的元素进行了双向映射，并且其逆向$\mathscr{T}^{-1}$存在。如果$X \subset Y$也成立，那么这种同构就被称为典范。

\subsection{Differentiation in linear spaces}

在这一节中，我们简要报告了线性函数空间上应用的可分性和微分的概念；关于这一主题的进一步分析，以及这种概念在更一般情况下的扩展，见 [KF89] 。

让我们首先考虑强（或弗雷谢）微分的概念。

定义2.5。设$X$和$Y$是两个规范线性空间，$F$是一个应用。

我们把$X$在$Y$中的表达式，定义在一个开放集$E \subset X ;$上，这样的应用被称为可微。 我们把$L_{x} h$（或$\left.L_{x}[h]\right)$，它在$Y$中每生成一个元素的表达式，称为$L_{x} h$（或$\left.L_{x}[h]\right)$ ，它在$Y$ 中每生成一个元素
 $h \in X$，在$x \in E ;$处应用$F$的强微分（或Fréchet微分）。
算子$L_{x}$被称为$F$在$x$的应用的强导数，一般被称为
表示为$F^{\prime}(x)$ ，即$F^{\prime}(x)=L_{x}$ 。

从定义中，我们可以推导出，在$x$中的可微调应用在$x$中也是连续的。我们在下面列出一些从这个定义衍生出来的属性。

- 如果$F(x)=$不变，那么$F^{\prime}(x)$就是空运算符，也就是$L_{x}[h]=0 \forall h \in X$ 。

- 连续线性应用的强导数 $F(x)$ 是应用本身，也就是 $F^{\prime}(x)=F(x)$ 。

- 给出$F$和$G$的两个连续应用$Y$，如果这些应用在$x_{0}$是可微的，那么$F+G$和$\alpha F$也是可微的，对于所有$\alpha \in \mathbb{R}$，我们有。

!!!!
\begin{gathered}
(F+G)^{\prime}\left(x_{0}\right)=F^{\prime}\left(x_{0}\right)+G^{\prime}\left(x_{0}\right), \\
(\alpha F)^{\prime}\left(x_{0}\right)=\alpha F^{\prime}\left(x_{0}\right) .
\end{gathered}
$$

现在考虑以下弱微分（或伽特）的定义：空间$Y$的规范。如果弱微分$D F(x, h)$是线性的（一般来说，它是

请注意，如果一个应用$F$有一个强导数，那么它也承认有一个弱导数，与强导数重合；反之，一般不成立。然而，下面的定理成立（见[KF89]）。定理2.2.如果在$x_{0}$的邻域$U\left(x_{0}\right)$上存在应用$F$的弱导数$F_{G}^{\prime}(x)$，并且这种导数是$x$在这种邻域的函数

\subsection{Elements of distributions}

在这一节中，我们想回顾一下关于分布和Sobolev空间理论的主要定义，这对更好地理解课本中介绍的主题很有帮助。关于更深入的处理，请参见专著 [Bre86] , [Ada75] 和 [LM68] 。

让$\Omega$是$\mathbb{R}^{n}$和$f: \Omega \mapsto \mathbb{R}$的一个开放集。

定义2.7。我们所说的函数$f$的支持是指函数本身取值不同于零的集合的闭合，也就是

如果存在一个紧凑集$f: \Omega \mapsto \mathbb{R}$，使$\operatorname{supp} f \subset K$存在，则称一个函数$f: \Omega \mapsto \mathbb{R}$在$\Omega$中具有紧凑支持。

在这一点上，我们可以提供以下定义。

![](https://cdn.mathpix.com/cropped/10058ab4e7f0c5bd6fe5bcd4db204623-019.jpg?height=143&width=720&top_left_y=767&top_left_x=97)

我们介绍导数的多指数符号。设$\boldsymbol{\alpha}=\left(\alpha_{1}, \alpha_{2}, \ldots, \alpha_{n}\right)$是一个非负整数的n元组（称为多指数），设$f: \Omega \mapsto \mathbb{R}$是一个定义在$\Omega \subset \mathbb{R}^{n}$上的函数。我们将使用以下符号

!!!!
D^{\alpha} f(\mathbf{x})=\frac{\partial|\alpha| f(\mathbf{x})}{\partial x_{1}^{\alpha_{1}} \partial x_{2}^{\alpha_{2}} \ldots \partial x_{n}^{\alpha_{n}}}
$$

$|\alpha|=\alpha_{1}+\alpha_{2}+\ldots+\alpha_{n}$是与$f$的微分顺序相一致的多指数的长度。

${ }^{1}$ 用$\Omega \subset \mathbb{R}^{n}$，一个紧凑集是一个封闭且有界的集。在空间$\mathscr{D}(\Omega)$中，我们可以引入以下收敛的概念。

![](https://cdn.mathpix.com/cropped/10058ab4e7f0c5bd6fe5bcd4db204623-020.jpg?height=246&width=722&top_left_y=160&top_left_x=97)

我们现在能够定义$\Omega$上的分布空间。

![](https://cdn.mathpix.com/cropped/10058ab4e7f0c5bd6fe5bcd4db204623-020.jpg?height=270&width=722&top_left_y=463&top_left_x=97)

分布$T \in \mathscr{D}^{\prime}(\Omega)$对函数$\phi \in \mathscr{D}(\Omega)$的作用将总是通过身份对$\langle T, \phi\rangle$来表示。

例2.1.设a是集合$\Omega$的一个点。相对于a点的狄拉克三角是由以下关系定义的分布$\delta_{\mathrm{a}}$。

!!!!
\left\langle\delta_{\mathbf{a}}, \phi\right\rangle=\phi(\mathbf{a}) \quad \forall \phi \in \mathscr{D}(\Omega)
$$

另一个例子，见练习四。同样在$\mathscr{D}^{\prime}(\Omega)$中，我们引入了一个收敛的概念。

![](https://cdn.mathpix.com/cropped/10058ab4e7f0c5bd6fe5bcd4db204623-020.jpg?height=156&width=722&top_left_y=1068&top_left_x=97)



\subsubsection{Square-integrable functions}

我们考虑在$\Omega \subset \mathbb{R}^{n}$上的平方不可变函数的空间。

!!!!
\mathrm{L}^{2}(\Omega)=\left\{f: \Omega \mapsto \mathbb{R} \text { such that } \int_{\Omega}(f(\mathbf{x}))^{2} d \Omega<+\infty\right\}
$$

更确切地说，$L^{2}(\Omega)$是一个可测量函数的等价类空间，等价关系拟为如下。  当且仅当$v$和$w$几乎处处相等，即它们最多只在$\Omega$的一个零度量子集上不同时，$v$才与$w$等同。"在$\Omega$中几乎到处都是"（简而言之，即在$\Omega$中）的意思正是 "对于所有的$\mathbf{x} \in \Omega$，除了一个零度量集，最多是"。

空间$L^{2}(\Omega)$是一个希尔伯特空间，其标量积为

!!!!
(f, g)_{\mathrm{L}^{2}(\Omega)}=\int_{\Omega} f(\mathbf{x}) g(\mathbf{x}) d \Omega
$$

$L^{2}(\Omega)$中的规范是由这个标量乘积引起的，即

!!!!
\|f\|_{\mathrm{L}^{2}(\Omega)}=\sqrt{(f, f)_{\mathrm{L}^{2}(\Omega)}} .
$$

对于每个函数$f \in \mathrm{L}^{2}(\Omega)$，我们都会关联一个分布$T_{f} \in \mathscr{D}^{\prime}(\Omega)$，定义如下

!!!!
\left\langle T_{f}, \phi\right\rangle=\int_{\Omega} f(\mathbf{x}) \phi(\mathbf{x}) d \Omega \quad \forall \phi \in \mathscr{D}(\Omega)
$$

以下结果成立。

由于后者，有可能证明对应关系$f \rightarrow T_{f}$是注入的，因此我们可以将$\mathrm{L}^{2}(\Omega)$与$\mathscr{D}^{\prime}(\Omega)$的一个子集相识别，写成

!!!!
\mathrm{L}^{2}(\Omega) \subset \mathscr{D}^{\prime}(\Omega)
$$

例2.2.设$\Omega=\mathbb{R}$，让我们用$\chi_{[a, b]}(x)$表示区间$[a, b]$的特征函数，定义为

!!!!
\chi_{[a, b]}(x)= \begin{cases}1 & \text { if } x \in[a, b] \\ 0 & \text { otherwise }\end{cases}
$$

然后让我们考虑函数序列$f_{n}(x)=\frac{n}{2} \chi_{[-1 / n, 1 / n]}(x)$（见图2.1）。
 ![](https://cdn.mathpix.com/cropped/10058ab4e7f0c5bd6fe5bcd4db204623-022.jpg?height=226&width=640&top_left_y=112&top_left_x=135)

图2.1.区间$[-1 / n, 1 / n]$的特征函数（左）和三角函数$f_{n}$（右）。

我们要验证与前者相关的分布序列$\left\{T_{f_{n}}\right\}$是否收敛于分布$\delta_{0}$，即相对于原点的狄拉克三角。事实上，对于每个函数$\phi \in \mathscr{D}(\Omega)$，我们有

!!!!
\left\langle T_{f_{n}}, \phi\right\rangle=\int_{\mathbb{R}} f_{n}(x) \phi(x) d x=\frac{n}{2} \int_{-1 / n}^{1 / n} \phi(x) d x=\frac{n}{2}[\Phi(1 / n)-\Phi(-1 / n)]
$$

$\Phi$是$\phi$的一个基数。如果我们现在设定 $h=1 / n$ ，我们可以写出

!!!!
\left\langle T_{f n}, \phi\right\rangle=\frac{\Phi(h)-\Phi(-h)}{2 h}
$$

当$n \rightarrow \infty, h \rightarrow 0$，因此，根据导数的定义，我们有

!!!!
\frac{\Phi(h)-\Phi(-h)}{2 h} \rightarrow \Phi^{\prime}(0)
$$

根据结构$\Phi^{\prime}=\phi$，因此

!!!!
\left\langle T_{f_{n}}, \phi\right\rangle \rightarrow \phi(0)=\left\langle\delta_{0}, \phi\right\rangle,
$$

使用了$\delta_{0}$的定义（见例2.1）。

通过采取一连串的三角函数（见图2.1）或高斯函数，而不是矩形函数（只要它们仍有单位积分），可以得到同样的极限。

最后，我们指出，在通常的度量中，这种序列会收敛到一个几乎到处都是空的函数。

\subsubsection{Differentiation in the sense of distributions}

让$\Omega \subset \mathbb{R}^{n}$和$T \in \mathscr{D}^{\prime}(\Omega)$ 。它的导数$\frac{\partial T}{\partial x_{i}}$在分布的意义上是以下列方式定义的分布

!!!!
\left\langle\frac{\partial T}{\partial x_{i}}, \phi\right\rangle=-\left\langle T, \frac{\partial \phi}{\partial x_{i}}\right\rangle \quad \forall \phi \in \mathscr{D}(\Omega), \quad i=1, \ldots, n
$$


![](https://cdn.mathpix.com/cropped/10058ab4e7f0c5bd6fe5bcd4db204623-023.jpg?height=228&width=664&top_left_y=117&top_left_x=122)

图2.2.海维塞德函数（左）。右边是例$2.6$与$k=1 / 3$的函数。请注意，这个函数在原点处趋向于无穷大

以类似的方式，我们定义任意顺序的导数。确切地说，对于每个多指数$\boldsymbol{\alpha}=\left(\alpha_{1}, \alpha_{2}, \ldots, \alpha_{n}\right)$，我们有，$D^{\alpha} T$是一个新的分布，定义为

!!!!
\left\langle D^{\alpha} T, \phi\right\rangle=(-1)^{|\alpha|}\left\langle T, D^{\alpha} \phi\right\rangle \quad \forall \phi \in \mathscr{D}(\Omega)
$$

例2.3.在$\mathbb{R}$上的Heaviside函数（见图2.2）被定义为

!!!!
H(x)= \begin{cases}1 & \text { if } x>0 \\ 0 & \text { if } x \leq 0\end{cases}
$$

与后者相关的分布$T_{H}$的导数是相对于原点的狄拉克分布（见例2.1）；在确定函数$H$与相关分布$T_{H}$之后，我们将写出

!!!!
\frac{d H}{d x}=\delta_{0}
$$

分布背景下的微分享有一些重要的特性，而这些特性在更有限的经典函数微分背景下是不成立的。

属性2.1.集$\mathscr{D}^{\prime}(\Omega)$相对于微分操作而言是封闭的。

分布的意义），即每个分布都是可以无限次微分的，其分布导数本身就是分布。

属性2.2.在$\mathscr{D}^{\prime}(\Omega)$中的微分是一个连续操作，在这个意义上 我们最后指出，在分布意义上的微分是函数的经典微分的延伸。事实上，如果一个函数$f$在$\Omega$上是可微的，具有连续性（在经典意义上），那么对应于$f$的分布$T_{f}$的导数与对应于$f($的经典导数$T_{f^{\prime}}$的分布相吻合，见练习7）。

我们总是将$f$的函数$\mathrm{L}^{2}(\Omega)$与$\mathscr{D}^{\prime}(\Omega)$的相应分布$T_{f}$相提并论，用$f$来代替$T_{f}$ 。同样地，当我们谈论导数时，我们总是在分布的意义上指代后者。

\subsection{Sobolev spaces}

在第2.3.1节中，我们已经注意到，$\mathrm{L}^{2}(\Omega)$的函数是特殊的分布。然而，这并不能保证它们的导数（在分布的意义上）仍然是$L^{2}(\Omega)$的函数，如下面的例子所示。

例2.4。设$\Omega \subset \mathbb{R}$，设$[a, b] \subset \Omega$ 。那么，区间$[a, b]$的特征函数（见例2.2）属于$\mathrm{L}^{2}(\Omega)$，而其分布导数$d \chi_{[a, b]} / d x=\delta_{a}-\delta_{b}($见例$2.3)$不属于。

因此，引入以下空间是合理的。

定义2.12。设$\Omega$是$\mathbb{R}^{n}$的一个开放集，$k$是一个正整数。我们称$k$上的Sobolev空间为$\Omega$的函数总量所形成的空间。

显然，由此可见，$\mathrm{H}^{k+1}(\Omega) \subset \mathrm{H}^{k}(\Omega)$对于每个$k \geq 0$，这个包容是连续的。空间$\mathrm{L}^{2}(\Omega)$有时被表示为$\mathrm{H}^{0}(\Omega)$ 。

Sobolev空间$\mathrm{H}^{k}(\Omega)$是相对于以下标量积的希尔伯特空间

!!!!
(f, g)_{k}=\sum_{|\boldsymbol{\alpha}| \leq k} \int_{\Omega}\left(D^{\alpha} f\right)\left(D^{\alpha} g\right) d \Omega
$$

从中得出的规范

!!!!
\|f\|_{k}=\|f\|_{\mathrm{H}^{k}(\Omega)}=\sqrt{(f, f)_{k}}=\sqrt{\sum_{|\alpha| \leq k} \int_{\Omega}\left(D^{\alpha} f\right)^{2} d \Omega}
\label{2.11}\end{equation}

最后，我们定义了半形

!!!!
|f|_{k}=|f|_{\mathrm{H}^{k}(\Omega)}=\sqrt{\sum_{|\boldsymbol{\alpha}|=k} \int_{\Omega}\left(D^{\alpha} f\right)^{2} d \Omega}
$$

因此，$(2.11)$变成了

!!!!
\|f\|_{\mathrm{H}^{k}(\Omega)}=\sqrt{\sum_{m=0}^{k}|f|_{\mathrm{H}^{m}(\Omega)}^{2}}
$$

例2.5.如果$n=1$和$k=1$我们有。

!!!!
\begin{aligned}
&(f, g)_{1}=(f, g)_{\mathrm{H}^{1}(\Omega)}=\int_{\Omega} f g d \Omega+\int_{\Omega} f^{\prime} g^{\prime} d \Omega \\
&\|f\|_{1}=\|f\|_{\mathrm{H}^{1}(\Omega)}=\sqrt{\int_{\Omega} f^{2} d \Omega+\int_{\Omega} f^{\prime 2} d \Omega}=\sqrt{\|f\|_{\mathrm{L}^{2}(\Omega)}^{2}+\left\|f^{\prime}\right\|_{\mathrm{L}^{2}(\Omega)}^{2}} \\
&\qquad\left.f\right|_{1}=|f|_{\mathrm{H}^{1}(\Omega)}=\sqrt{\int_{\Omega}\left(f^{\prime}\right)^{2} d \Omega}=\left\|f^{\prime}\right\|_{\mathrm{L}^{2}(\Omega)} .
\end{aligned}
$$

\subsection{空间的规律性$\mathbf{H}^{k}(\Omega)$ }。

我们现在要把一个函数属于一个空间的事实$\mathrm{H}^{k}(\Omega)$与它的连续性属性联系起来。

例2.6.设$\Omega=B(0,1) \subset \mathbb{R}^{2}$是以原点为中心，半径为$1$的球。那么函数

!!!!
f\left(x_{1}, x_{2}\right)=\left|\ln \frac{1}{\sqrt{x_{1}^{2}+x_{2}^{2}}}\right|^{k}
\label{2.12}\end{equation}

当$0<k<1/2$ 时属于$\mathrm{H}^{1}(\Omega)$，见图$2.2$（右）。它在原点处出现了一个奇点，因此它既不连续也不受约束。类似的结论也可用于

!!!!
f\left(x_{1}, x_{2}\right)=\ln \left(-\ln \left(x_{1}^{2}+x_{2}^{2}\right)\right)
$$

这次是用 $\Omega=B(0,1 / 2) \subset \mathbb{R}^{2}$ 。

因此，如果$\mathrm{H}^{1}(\Omega)$是$\mathbb{R}^{2}$（或$\mathbb{R}^{3}$）的一个开放集，那么$\Omega$的所有函数并非都是连续的。一般来说，以下结果成立。

特别是，在一个空间维度$(n=1)$，$\mathrm{H}^{1}(\Omega)$的函数是连续的（它们确实是绝对连续的，见[Sal08]和[Bre86]），而在二维或三维，它们不一定如此。相反，$\mathrm{H}^{2}(\Omega)$的函数对于$n=1,2,3$总是连续的。

\subsubsection{The space $\mathrm{H}_{0}^{1}(\Omega)$ }。

如果$\Omega$是有界的，那么空间$\mathscr{D}(\Omega)$在$\mathrm{H}^{1}(\Omega)$中是不密集的。那么我们可以给出以下定义。

定义2.13。我们用$\mathrm{H}_{0}^{1}(\Omega)$表示$\mathscr{D}(\Omega)$在$\mathrm{H}^{1}(\Omega)$中的封闭。

$\mathrm{H}_{0}^{1}(\Omega)$的函数享有以下特性。

属性2.4（Poincaré不等式）。设$\Omega$是$\mathbb{R}^{n}$中的一个有界集；则存在一个常数$C_{\Omega}$，使得

!!!!
\|v\|_{\mathrm{L}^{2}(\Omega)} \leq C_{\Omega}|v|_{\mathrm{H}^{1}(\Omega)} \quad \forall v \in \mathrm{H}_{0}^{1}(\Omega)
\label{2.13}\end{equation}

证明。  $\Omega$是有界的，我们总能找到一个中心为$\mathbf{g}$、半径为$D>0$的球体$S_{D}=\{\mathbf{x}:|\mathbf{x}-\mathbf{g}|<D\}$，包含$\Omega$。由于$\mathscr{D}(\Omega)$在$\mathrm{H}_{0}^{1}(\Omega)$中是密集的，所以只需证明函数$u \in \mathscr{D}(\Omega)$的不等式即可（在$v \in \mathrm{H}_{0}^{1}(\Omega)$的一般情况下，只需建立一个以$\mathrm{H}^{1}(\Omega)$为准则收敛到$v$的序列$u_{i} \in \mathscr{D}(\Omega), i=1,2, \ldots$，对序列的项应用不等式，并传递到极限）。通过部分积分并利用$\operatorname{div}(\mathbf{x}-\mathbf{g})=n$这一事实。

!!!!
\begin{aligned}
&\|u\|_{\mathrm{L}^{2}(\Omega)}^{2}=n^{-1} \int_{\Omega} n \cdot|u(\mathbf{x})|^{2} d \Omega=-n^{-1} \int_{\Omega}(\mathbf{x}-\mathbf{g}) \cdot \nabla\left(|u(\mathbf{x})|^{2}\right) d \Omega \\
&\begin{array}{c}
=-2 n^{-1} \int_{\Omega}(\mathbf{x}-\mathbf{g}) \cdot[u(\mathbf{x}) \nabla u(\mathbf{x})] d \Omega \leq 2 n^{-1}\|\mathbf{x}-\mathbf{g}\|_{L^{\infty}(\Omega)}\|u\|_{\mathrm{L}^{2}(\Omega)}\|u\|_{\mathrm{H}^{1}(\Omega)} \\
\leq 2 n^{-1} D\|u\|_{\mathrm{L}^{2}(\Omega)}\|u\|_{\mathrm{H}^{1}(\Omega)}
\end{array}
\end{aligned}
$$

作为一个直接的后果，我们有这样的结果。

属性2.5。半规范$|v|_{H^{1}(\Omega)}$是空间$\mathrm{H}_{0}^{1}(\Omega)$上的一个规范，它变成了
等同于规范$\|y\|_{\text {. } 1}$ (n)

属性2.5。半规范$|v|_{H^{1}(\Omega)}$是空间$\mathrm{H}_{0}^{1}(\Omega)$上的一个规范，它变成了
等同于规范$\|v\|_{H^{1}(\Omega)}$。

证明。我们回顾一下，如果存在两个正常数$c_{1}$和$c_{2}$，那么两个规范$\|\cdot\|$和$\|\cdot\| \mid$就被称为等价的。

!!!!
c_{1}\left\|\left|v\|\mid \leq\| v\left\|\leq c_{2}\right\| v\|\| \quad \forall v \in V\right.\right.
$$

由于$\|v\|_{1}=\sqrt{|v|_{1}^{2}+\|v\|_{0}^{2}}$，显然$|v|_{1} \leq\|v\|_{1}$ 。反之，利用属性$2.4$ ,

!!!!
\|v\|_{1}=\sqrt{|v|_{1}^{2}+\|v\|_{0}^{2}} \leq \sqrt{|v|_{1}^{2}+C_{\Omega}^{2}|v|_{1}^{2}} \leq C_{\Omega}^{*}|v|_{1}
$$

由此我们推导出两个规范的等价性。

以类似的方式，我们将空间$\mathrm{H}_{0}^{k}(\Omega)$定义为$\mathscr{D}(\Omega)$在$\mathrm{H}^{k}(\Omega)$的闭合。

\subsubsection{Trace operators}

让$\Omega$是$\mathbb{R}^{n}$的一个域。我们的意思是

- 如果$n=1$，是一个开放的有界区间。

- 一个开放的有界连接集，具有足够规则的边界 $\partial \Omega$ 。例如，如果$n=2$是一个多边形（即一个域的边界是线段的有限联合），或者如果$n=3$是一个多面体（即一个域的边界是多边形的有限联合）。

让$v$成为$\mathrm{H}^{1}(\Omega):$的一个元素。  $2.4 .1$表明，定义$v$在$\Omega$边界上的 "值 "并不简单，这个值我们将称为$v$在$\partial \Omega$上的轨迹。我们利用以下结果。

定理2.3。设$\Omega$是$\mathbb{R}^{n}$的一个域，提供$\gamma_{0}$的 "足够规则 "的连续性，意味着存在一个常数$C>0$，使得

由于这个结果，在寻求$\mathrm{H}^{k}(\Omega)$中的解$v$时，迪里希特边界条件是有意义的，与$k \geq 1$，只要我们在轨迹的意义上解释边界值。

备注2.1.追踪算子$\gamma_{\Gamma}$在$\mathrm{L}^{2}(\Gamma)$上不是抛射性的。特别是，$L^{2}(\Gamma)$的函数集合是$H^{1}(\Omega)$函数的轨迹，构成了$\mathrm{L}^{2}(\Gamma)$的一个子空间，用$\mathrm{H}^{1 / 2}(\Gamma)$表示，其特征是介于$\mathrm{L}^{2}(\Gamma)$和$\mathrm{H}^{1}(\Gamma)$的中间规律性属性。更一般地说，对于每一个$k \geq 1$都存在一个唯一的线性和连续的应用$\gamma_{0}: \mathrm{H}^{k}(\Omega) \mapsto \mathrm{H}^{k-1 / 2}(\Gamma)$，这样$\gamma_{0} v=v_{\Gamma}$对于每一个$v \in \mathrm{H}^{k}(\Omega) \cap C^{0}(\bar{\Omega})$ 。

跟踪算子允许对以前定义的空间进行有趣的表征 $\mathrm{H}_{0}^{1}(\Omega)$ 。事实上，我们有以下的属性。换句话说，$\mathrm{H}_{0}^{1}(\Omega)$是由$\mathrm{H}^{1}(\Omega)$中在边界上具有空痕的函数形成的。

\subsection{The spaces $\mathrm{L}^{\infty}(\Omega)$ and $\mathrm{L}^{p}(\Omega)$ , with $1 \leq p<\infty$ }。

空间$L^{2}(\Omega)$可以用以下方式概括：对于每个实数$p$与$1 \leq p<\infty$，我们可以定义以下可测量函数（等价类）的空间

!!!!
\mathrm{L}^{p}(\Omega)=\left\{v: \Omega \mapsto \mathbb{R} \text { such that } \int_{\Omega}|v(\mathbf{x})|^{p} d \Omega<\infty\right\}
$$

其准则是由

!!!!
\|v\|_{\mathrm{L}^{p}(\Omega)}=\left(\int_{\Omega}|v(\mathbf{x})|^{p} d \Omega\right)^{1 / p}
$$

此外，我们定义了空间

!!!!
\mathrm{L}_{l o c}^{1}(\Omega)=\left\{f: \Omega \rightarrow \mathbb{R} \text { such that }\left.f\right|_{K} \in \mathrm{L}^{1}(K) \text { for each compact set } K \subset \Omega\right\}
$$

如果$1 \leq p<\infty$，那么$\mathscr{D}(\Omega)$在$\mathrm{L}^{p}(\Omega)$中是密集的。

在$p=\infty$的情况下，我们定义$\mathrm{L}^{\infty}(\Omega)$为在$\Omega$中即被约束的函数空间。其规范定义如下

!!!!
\begin{aligned}
\|v\|_{L^{\infty}(\Omega)} &=\inf \{C \in \mathbb{R}:|v(x)| \leq C, \text { a.e. in } \Omega\} \\
&=\sup \{|v(x)|, \text { a.e. in } \Omega\}
\end{aligned}
\label{2.16}\end{equation}

对于$1 \leq p \leq \infty$，提供了规范$\|\cdot\|_{\mathrm{L}^{p}(\Omega)}$的空间$\mathrm{L}^{p}(\Omega)$是Banach空间。

我们回顾一下霍尔德不等式：给定$v \in \mathrm{L}^{p}(\Omega)$和$w \in \mathrm{L}^{p^{\prime}}(\Omega)$与$1 \leq p \leq \infty$和$\frac{1}{p}+\frac{1}{p^{\prime}}=1$ ，那么$v w \in \mathrm{L}^{1}(\Omega)$和

!!!!
\int_{\Omega}|v(\mathbf{x}) w(\mathbf{x})| d \Omega \leq\|v\|_{L^{p}(\Omega)}\|w\|_{L^{\prime}(\Omega)}
\label{2.14}\end{equation}

索引 $p^{\prime}$ 被称为 $p$ 的共轭。

如果$1<p<\infty$，那么$\mathrm{L}^{p}(\Omega)$是一个反身空间：这意味着任何线性和连续形式$\varphi: \mathrm{L}^{p}(\Omega) \rightarrow \mathbb{R}$都可以被识别为$\mathrm{L}^{p^{\prime}}(\Omega)$的一个元素，即存在一个唯一的$g \in \mathrm{L}^{p^{\prime}}(\Omega)$，以便

!!!!
\varphi(f)=\int_{\Omega} f(\mathbf{x}) g(\mathbf{x}) d \Omega \quad \forall f \in \mathrm{L}^{p}(\Omega)
$$

如果$p=2$，那么$p^{\prime}=2$，所以霍尔德不等式变为

!!!!
(v, w)_{\mathrm{L}^{2}(\Omega)} \leq\|v\|_{\mathrm{L}^{2}(\Omega)}\|w\|_{\mathrm{L}^{2}(\Omega)} \quad \forall v, w \in \mathrm{L}^{2}(\Omega)
\label{2.17}\end{equation}

因此，它被称为Cauchy-Schwarz不等式。此外，以下不等式成立

!!!!
\|v w\|_{\mathrm{L}^{2}(\Omega)} \leq\|v\|_{\mathrm{L}^{4}(\Omega)}\|w\|_{\mathrm{L}^{4}(\Omega)} \quad \forall v, w \in \mathrm{L}^{4}(\Omega)
\label{2.18}\end{equation}

如果$\Omega \subset \mathbb{R}^{n}$是一个有界域，对于$1 \leq p \leq q \leq \infty$我们有

!!!!
\mathrm{L}^{q}(\Omega) \subset \mathrm{L}^{p}(\Omega) \subset \mathrm{L}^{1}(\Omega) \subset \mathrm{L}_{l o c}^{1}(\Omega)
$$

如果$\Omega$是无界的，我们总是有

!!!!
\mathrm{L}^{p}(\Omega) \subset \mathrm{L}_{l o c}^{1}(\Omega) \quad \forall p \geq 1
$$

此外，如果$\Omega \subset \mathbb{R}^{n}$和对于$n>1$的边界$\partial \Omega$是多边形的（更一般地说，它是Lipschitz连续的），我们有以下连续的内涵。

如果$0<2 s<n$，则$\mathrm{H}^{s}(\Omega) \subset \mathrm{L}^{q}(\Omega) \forall q$，这样$1 \leq q \leq q^{*}$与$q^{*}=2 n /(n-2 s)$就有了。

如果$2 s=n \quad$，则$\mathrm{H}^{s}(\Omega) \subset \mathrm{L}^{q}(\Omega) \forall q$，以便$1 \leq q<\infty$。

如果$2 s>n \quad$则$\mathrm{H}^{s}(\Omega) \subset C^{0}(\bar{\Omega})$ 。

最后，我们引入Sobolev空间$W^{k, p}(\Omega)$，其中$k$为非负整数，$1 \leq p \leq \infty$为函数$v \in L^{p}(\Omega)$的空间，使得$v$的所有阶数在$k$以内的分布导数都在$L^{p}(\Omega)$。

!!!!
W^{k, p}(\Omega)=\left\{v \in L^{p}(\Omega): D^{\alpha} v \in L^{p}(\Omega)\right.
$$

对于每个非负的多指数$\boldsymbol{\alpha}$，使$|\boldsymbol{\alpha}| \leq k\}$ .

对于$1 \leq p<\infty$来说，这是一个具有规范的巴拿赫空间

!!!!
\|v\|_{W^{k, p}(\Omega)}=\left(\sum_{|\alpha| \leq k}\left\|D^{\alpha} v\right\|_{L^{p}(\Omega)}^{p}\right)^{1 / p}
$$

它的 $|v|_{W^{k, p}(\Omega)}$ 的定义与此类似，只要我们对多整数$\alpha$求和，使$|\boldsymbol{\alpha}|=k$ .请注意，对于$k=0, W^{k, p}(\Omega)=L^{p}(\Omega)$和，对于$p=2, W^{k, 2}(\Omega)=H^{k}(\Omega)$ 。

\subsection{Adjoint operators of a linear operator}

设$X$和$Y$是两个巴拿赫空间，$\mathscr{L}(X, Y)$是$X$到$Y$的线性和有界算子空间。给定$L \in \mathscr{L}(X, Y)$，$L$的邻接（或共轭）算子是算子$L^{\prime}: Y^{\prime} \rightarrow X^{\prime}$，定义如下

!!!!
{ }_{X^{\prime}}\left\langle L^{\prime} f, x\right\rangle_{X}={ }_{Y^{\prime}}\langle f, L x\rangle_{Y} \quad \forall f \in Y^{\prime}, x \in X
\label{2.20}\end{equation}

$L^{\prime}$是$Y^{\prime}$和$X^{\prime}$之间的线性有界算子，即$L^{\prime} \in \mathscr{L}\left(Y^{\prime}, X^{\prime}\right)$，此外$\left\|L^{\prime}\right\|_{\mathscr{L}\left(Y^{\prime}, X^{\prime}\right)}=\|L\|_{\mathscr{L}(X, Y)}$，在这里我们设置了

\beginP{equation}
\|L\|_{\mathscr{L}(X, Y)}=\sup _{x \in X \atop x \neq 0} \frac{\|L x\|_{Y}}{\|x\|_{X}}
\label{2.21}\end{equation}

在$X$和$Y$是两个希尔伯特空间的情况下，可以引入一个额外的邻接算子，$L^{T}: Y \rightarrow X$，称为$L$的转置，。它的定义是

!!!!
\left(L^{T} y, x\right)_{X}=(y, L x)_{Y} \quad \forall x \in X, y \in Y
$$

这里，$(\cdot, \cdot)_{X}$表示$X$的标量积，而$(\cdot, \cdot)_{Y}$表示$Y$的标量积。上述定义可以解释如下：对于任何给定的元素$y \in Y$，实值函数$x \rightarrow(y, L x)_{Y}$是线性和连续的，因此它定义了$X^{\prime}$的一个元素。根据里兹定理（定理2.1），存在$X$的一个元素$x$，我们称之为$L^{T} y$，它满足$(2.22)$ 。这样的算子属于$\mathscr{L}(Y, X)$（也就是说，从$Y$到$X$是线性和有界的），而且

!!!!
\left\|L^{T}\right\|_{\mathscr{L}(Y, X)}=\|L\|_{\mathscr{L}(X, Y)}
\label{2.22}\end{equation}

因此，在$X$和$Y$是两个希尔伯特空间的情况下，我们有两个邻接算子的概念，$L^{\prime}$和$L^{T}$ 。这两个算子之间的关系是

!!!!
\Lambda_{X} L^{T}=L^{\prime} \Lambda_{Y}
\label{2.24}\end{equation}

$\Lambda_{X}$和$\Lambda_{Y}$是里兹从$X$到$X^{\prime}$和从$Y$到$Y^{\prime}$的典型同构，分别见$($ 。事实上，$\forall x \in X, y \in Y$ ,

!!!!
{ }_{X^{\prime}}\left\langle\Lambda_{X} L^{T} y, x\right\rangle_{X}=\left(L^{T} y, x\right)_{X}=(y, L x)_{Y}={Y^{\prime}}\left\langle\Lambda_{Y} y, L x\right\rangle_{Y}={ }_{X^{\prime}}\left\langle L^{\prime} \Lambda_{Y} y, x\right\rangle_{X}
$$

身份（$2.24)$可以通过说明图$2.3$中的图示是换元的来等价表达。

![](https://cdn.mathpix.com/cropped/10058ab4e7f0c5bd6fe5bcd4db204623-030.jpg?height=273&width=277&top_left_y=923&top_left_x=315)

图2.3.算子$L^{T}$和$L^{\prime}$的邻接算子$\mathrm{L}

\subsection{Spaces of time-dependent functions}

当考虑时空函数时$v(\mathbf{x}, t), \mathbf{x} \in \Omega \subset \mathbb{R}^{n}, n \geq 1, t \in(0, T), T>0$，很自然地引入函数空间

!!!!
\begin{aligned}
&L^{q}\left(0, T ; W^{k, p}(\Omega)\right)= \\
&\left\{v:(0, T) \rightarrow W^{k, p}(\Omega) \text { such that } v \text { is measurable and } \int_{0}^{T}\|v(t)\|_{W^{k, p}(\Omega)}^{q} d t<\infty\right\}
\end{aligned}
\label{2.25}\end{equation}

其中$k \geq 0$是一个非负整数，$1 \leq q<\infty, 1 \leq p \leq \infty$，被赋予了准则

!!!!
\|v\|_{L^{q}\left(0, T ; W^{k, p}(\Omega)\right)}=\left(\int_{0}^{T}\|v(t)\|_{W^{k, p}(\Omega)}^{q} d t\right)^{1 / q}
\label{2.26}\end{equation}}

对于每一个$t \in(0, T)$我们都用速记符号$v(t)$来表示该函数。

!!!!
v(t): \Omega \rightarrow \mathbb{R}, v(t)(\mathbf{x})=v(\mathbf{x}, t) \quad \forall \mathbf{x} \in \Omega
\label{2.27}\end{equation}}

空间$L^{\infty}\left(0, T: W^{k, p}(\Omega)\right)$和$C^{0}\left([0, T] ; W^{k, p}(\Omega)\right)$以类似的方式定义。

在处理时间依赖性的初始边界值问题时，以下结果对推导先验估计和稳定性不等式很有用。

![](https://cdn.mathpix.com/cropped/10058ab4e7f0c5bd6fe5bcd4db204623-031.jpg?height=528&width=723&top_left_y=717&top_left_x=96)

在处理初始边界值问题的完全离散（在空间和时间上）近似时，该定理的一个离散对应部分如下

关于这两个定理的证明，请参见，例如，[QV94，第1章]。

\subsection{ $2.8$ 练习}。

1.让$\Omega=(0,1)$和，对于$\alpha>0, f(x)=x^{-\alpha}$ 。对于哪个$\alpha$，我们有$f \in \mathrm{L}^{p}(\Omega)$ 。

$1 \leq p<\infty$ ?是否有一个$\alpha>0$的$f \in \mathrm{L}^{\infty}(\Omega) ?$？

2.设$\Omega=\left(0, \frac{1}{2}\right)$和$f(x)=\frac{1}{x(\ln x)^{2}}$ .证明$f \in \mathrm{L}^{1}(\Omega)$ .

3.证明对于哪些$\alpha \in \mathbb{R}$我们有$f \in \mathrm{L}_{l o c}^{1}(0,1)$，与$f(x)=x^{-\alpha}$。

4.让$u \in \mathrm{L}_{\text {loc }}^{1}(\Omega)$ 。定义$T_{u} \in \mathscr{D}^{\prime}(\Omega)$如下

!!!!
\left\langle T_{u}, \varphi\right\rangle=\int_{\Omega} \varphi(\mathbf{x}) u(\mathbf{x}) d \Omega \quad \forall \varphi \in \mathscr{D}(\Omega)
$$

验证$T_{u}$确实是一个分布，并且应用$u \rightarrow T_{u}$是注入性的。因此，我们可以将$u$与$T_{u}$相认，并通过观察$\mathrm{L}_{l o c}^{1}(\Omega) \subset!!!!D^{\prime}(\Omega)$得出结论。

5.证明定义为以下的函数。

!!!!
\begin{aligned}
&f(x)=e^{1 /\left(x^{2}-1\right)} \text { if } x \in(-1,1) \\
&f(x)=0 \text { if } x \in]-\infty,-1] \cup[1,+\infty[
\end{aligned}
$$

属于$\mathscr{D}(\mathbb{R})$ 。6.证明对于$f$中定义的函数$(2.12)$，我们有

!!!!
\|f\|_{\mathrm{H}^{1}(\Omega)}^{2}=2 \pi \int_{0}^{r}|\log s|^{2 k} s d s+2 \pi k^{2} \int_{0}^{r} \frac{1}{s}|\log s|^{2 k-2} d s
$$

因此，对于每一个$0<k<\frac{1}{2}$，$f$都属于$\mathrm{H}^{1}(\Omega)$ 。

7.让$\varphi \in C^{1}(-1,1)$ .证明在经典意义上计算的导数$\frac{d \varphi}{d x}$等于在分布意义上计算的$\frac{d \varphi}{d x}$，在观察到$C^{0}(-1,1) \subset$ $\mathrm{L}_{l o c}^{1}(-1,1) \subset \mathscr{D}^{\prime}(-1,1)$ .

8.证明如果$\Omega=(a, b)$的Poincaré不等式$(2.13)$与$C_{\Omega}=(b-$a) $/ \sqrt{2}$成立。

[解：观察考奇-施瓦茨不等式，意味着

!!!!
v(x)=\int_{a}^{x} v^{\prime}(t) d t \leq\left(\int_{a}^{x}\left[v^{\prime}(t)\right]^{2} d t\right)^{1 / 2}\left(\int_{a}^{x} 1 d t\right)^{1 / 2} \leq \sqrt{x-a}\left\|v^{\prime}\right\|_{\mathrm{L}^{2}(a, b)}
$$

从何而来

!!!!
\left.\|v\|_{L^{2}(a, b)}^{2} \leq\left\|v^{\prime}\right\|_{L^{2}(a, b)}^{2} \int_{a}^{b}(x-a) d x\right] .
$$


\section{椭圆方程及其弱解}

\subsection{Poisson equation}

考虑一个域$\Omega \subset \mathbb{R}^{2}$，即一个开放的有界和连接的集合，并让$\partial \Omega$为其边界。我们用$\mathbf{x}$表示空间变量对$\left(x_{1}, x_{2}\right)$ 。要研究的问题是

!!!!
-\Delta u=f \quad \text { in } \Omega
\label{3.1}\end{equation}

其中$f=f(\mathbf{x})$是一个给定的函数，符号$\Delta$表示二维的L a算子。方程\ref{3.1}是一个椭圆的、线性的、非均质的（如果$f \neq 0$）二阶方程。我们称方程\ref{3.1}为泊松方程的强表述。我们还记得，在$f=0$的情况下，方程\ref{3.1}被称为Laplace方程。

在物理学上，$u$可以表示由于施加强度等于$f$的力而导致的弹性膜的垂直位移，或者由于密度为$f$的电荷导致的电势分布。

为了获得唯一的解决方案，必须在方程\ref{3.1}中加入合适的边界条件，也就是说，我们需要关于方程的解$u$在域边界$\partial \Omega$的信息。例如，边界上的位移$u$的值可以被赋予

!!!!
u=g \quad \text { on } \partial \Omega
$$

其中$g$是一个给定的函数，在这种情况下，我们将谈论一个Dirichlet问题。其中$g=0$的情况被说成是同质性的。

或者，可以对$u$的法向导数值进行强加

!!!!
\nabla u \cdot \mathbf{n}=\frac{\partial u}{\partial n}=h \quad \text { on } \partial \Omega
$$

n是$\partial \Omega$上的外向单位法向量，$h$是一个指定函数。相关问题被称为Neumann问题，在膜问题的情况下，对应于在膜本身的边界施加牵引力。再一次，$h=0$的情况被说成是同质的。

最后，不同类型的条件可以分配给计算域$\Omega$边界的不同部分。例如，假设$\partial \Omega=\Gamma_{D} \cup \Gamma_{N}$与$\stackrel{0}{\Gamma}_{D} \cap \stackrel{\circ}{\Gamma}_{N}=\emptyset$，可以施加以下条件。

!!!!
\begin{cases}u=g & \text { on } \Gamma_{D} \\ \frac{\partial u}{\partial n}=h & \text { on } \Gamma_{N}\end{cases}
$$

符号$\Gamma^{\circ}$已被用来表示$\Gamma$的内部。在这种情况下，相关问题被说成是混合问题。



\subsection{一维Poisson equation}

我们的第一步是介绍一个简单的一维边界值问题的弱表述。

\subsubsection{Homogeneous Dirichlet problem}

让我们考虑一维区间$\Omega=(0,1)$中的同质Dirichlet问题

!!!!
\begin{cases}-u^{\prime \prime}(x)=f(x), & 0<x<1 \\ u(0)=0, & u(1)=0\end{cases}
\label{3.2}\end{equation}

例如，这个问题制约着张力等于1的弹性弦的平衡配置，固定在端点，处于小位移配置中，并受到强度为$f$的横向力。作用在弦的$(0, x)$段上的总力为

!!!!
F(x)=\int_{0}^{x} f(t) d t
$$

函数$u$描述了琴弦相对于静止位置的垂直位移$u=0$ 。

强表述\ref{3.2}在一般情况下是不充分的。因此，有必要采用一种替代的表述，以减少未知解$u$所需的推导阶数。我们从二阶微分问题转移到积分形式的一阶问题，这被称为微分问题的弱表述。

为此，我们对\ref{3.2}进行了一连串的形式转换，在这个阶段不必担心其中出现的所有操作是否被允许。我们首先用方程\ref{3.2}乘以一个(到目前为止是任意的)测试函数$v$并在区间$(0,1)$上进行积分。

!!!!
-u^{\prime \prime} v=f v \Rightarrow-\int_{0}^{1} u^{\prime \prime} v d x=\int_{0}^{1} f v d x
$$

我们对第一个积分进行分项积分，目的是消除第二个导数，以便对解决方案施加一个较低的规则性。我们发现

!!!!
-\int_{0}^{1} u^{\prime \prime} v d x=\int_{0}^{1} u^{\prime} v^{\prime} d x-\left[u^{\prime} v\right]_{0}^{1}
$$

由于$u$在边界上是已知的，我们可以只考虑在区间端点为0的测试函数，因此边界项的贡献消失了。这样一来，方程变成

!!!!
\int_{0}^{1} u^{\prime} v^{\prime} d x=\int_{0}^{1} f v d x
\label{3.3}\end{equation}

因此，测试函数空间$V$必须是这样的：如果$v \in V$，则$v(0)=v(1)=0$ 。请注意，求解$u$，在边界处为0，并且具有与测试函数相同的规则性要求，也将在同一空间$V$中寻找。

还需要明确空间$V$必须满足的规律性要求，这样所有引入的操作才有意义。显然，如果$u$和$v$属于$C^{1}([0,1])$，我们就会有$u^{\prime}, v^{\prime} \in C^{0}([0,1])$，因此出现在\ref{1.3}左侧的积分就有意义。然而，物理解可能不是连续可微的：因此我们必须要求一个较低的规律性。此外，即使在$f \in C^{0}([0,1])$时，也不能保证该问题在空间中承认有解

!!!!
V=\left\{v \in C^{1}([0,1]): v(0)=v(1)=0\right\}
$$

事实上，当提供标量乘积时

!!!!
[u, v]_{1}=\int_{0}^{1} u^{\prime} v^{\prime} d x
$$

这个空间并不完整，也就是说，并非所有在$V$中取值的Cauchy序列都收敛到$V$中的一个元素。 

我们回顾一下函数空间$\mathrm{L}^{p}$的定义，其$p$-次幂是Lebesgue可积分的。对于$1 \leq p<\infty$，这些定义如下：

!!!!
\mathrm{L}^{p}(0,1)=\left\{v:(0,1) \mapsto \mathbb{R} \text { such that } \quad\|v\|_{L^{p}(0,1)}=\left(\int_{0}^{1}|v(x)|^{p} d x\right)^{1 / p}<+\infty\right\}
$$

为了使积分$\int_{0}^{1} u^{\prime} v^{\prime} d x$得到很好的定义，对$u^{\prime}$和$v^{\prime}$的最低要求是，乘积$u^{\prime} v^{\prime}$位于$\mathrm{L}^{1}(0,1)$中。为此，以下属性成立。这个结果是Cauchy-Schwarz 不等式： $(v, w)_{\mathrm{L}^{2}(\Omega)} \leq\|v\|_{\mathrm{L}^{2}(\Omega)}\|w\|_{\mathrm{L}^{2}(\Omega)}$的直接结果。

!!!!
\left|\int_{0}^{1} \varphi(x) \psi(x) d x\right| \leq\|\varphi\|_{\mathrm{L}^{2}(0,1)}\|\psi\|_{\mathrm{L}^{2}(0,1)}
$$

其中

!!!!
\|\varphi\|_{\mathrm{L}^{2}(0,1)}=\sqrt{\int_{\Omega}|\varphi(x)|^{2} d x}
$$

是$\varphi$在$\mathrm{L}^{2}(0,1)$中的规范。由于$\|\varphi\|_{\mathrm{L}^{2}(0,1)},\|\psi\|_{\mathrm{L}^{2}(0,1)}<\infty$的假设，这证明也存在$\varphi \psi$的（有限的）积分。

为了使\ref{3.3}中出现的积分有意义，函数以及它们的导数必须是可平方整数。因此，我们定义Sobolev空间

!!!!
\mathrm{H}^{1}(0,1)=\left\{v \in \mathrm{L}^{2}(0,1): v^{\prime} \in \mathrm{L}^{2}(0,1)\right\}
$$

必须在分布的意义上解释导数。然后我们选择以下$V$的子空间作为$\mathrm{H}^{1}(0,1)

!!!!
\mathrm{H}_{0}^{1}(0,1)=\left\{v \in \mathrm{H}^{1}(0,1): v(0)=v(1)=0\right\}
$$

由$\mathrm{H}^{1}(0,1)$的函数构成，这些函数在区间的端点为0。如果我们假设$f \in \mathrm{L}^{2}(0,1)$，\ref{3.3}的右手边的积分也是合理的。那么问题\ref{3.2}就被简化为以下问题

!!!!
\text { find } u \in V=\mathrm{H}_{0}^{1}(0,1): \int_{0}^{1} u^{\prime} v^{\prime} d x=\int_{0}^{1} f v d x \quad \forall v \in V
\label{3.4}\end{equation}



$\mathrm{H}^{\mathrm{I}}(0,1)$的函数不一定是传统意义上的可微，也就是$\mathrm{H}^{1}(0,1) \not \subset C^{1}([0,1])$ 。例如，在区间$(0,1)$的一个分区上片状连续的函数，其导数在分区的所有端点上不匹配，属于$\mathrm{H}^{\mathrm{I}}(0,1)$，但不属于$C^{\mathrm{l}}([0,1])$ 。因此，也要考虑前面例子中的连续但不可微的解。


下面，我们来证明，弱问题\ref{3.4}被证明等价于一个变分问题\ref{3.5}:

首先从residual问题开始:

!!!!
\text { find } u \in V:\left\{\begin{array}{l}
J(u)=\min _{v \in V}(v) \quad \text { with } \\
J(v)=\frac{1}{2} \int_{0}^{1}\left(v^{\prime}\right)^{2} d x-\int_{0}^{1} f v d x,
\end{array}\right.
\label{3.5}\end{equation}

\textbf{证明}：假设$u$是变量问题\ref{3.5}的一个解。那么，设定$v=u+\delta w$与$\delta \in \mathbb{R}$，我们可以得出

!!!!
J(u) \leq J(u+\delta w) \quad \forall w \in V
$$

函数$\psi(\delta)=J(u+\delta w)$是$\delta$的二次函数，最小值达到$\delta=0$ 。因此，

!!!!
\left.\psi^{\prime}(\delta)\right|_{\delta=0}=\left.\frac{\partial J(u+\delta w)}{\partial \delta}\right|_{\delta=0}=0
$$

根据导数的定义，我们有

!!!!
\frac{\partial J(u+\delta w)}{\partial \delta}=\lim _{\delta \rightarrow 0} \frac{J(u+\delta w)-J(u)}{\delta} \quad \forall w \in V
$$

让我们考虑$J(u+\delta w)$ ：

!!!!
\begin{aligned}
J(u+\delta w) &=\frac{1}{2} \int_{0}^{1}\left[(u+\delta w)^{\prime}\right]^{2} d x-\int_{0}^{1} f(u+\delta w) d x \\
&=\frac{1}{2} \int_{0}^{1}\left[u^{\prime 2}+\delta^{2} w^{\prime 2}+2 \delta u^{\prime} w^{\prime}\right] d x-\int_{0}^{1} f u d x-\int_{0}^{1} f \delta w d x \\
&=J(u)+\frac{1}{2} \int_{0}^{1}\left[\delta^{2} w^{\prime 2}+2 \delta u^{\prime} w^{\prime}\right] d x-\int_{0}^{1} f \delta w d x
\end{aligned}
$$

因此：

!!!!
\frac{J(u+\delta w)-J(u)}{\delta}=\frac{1}{2} \int_{0}^{1}\left[\delta w^{\prime 2}+2 u^{\prime} w^{\prime}\right] d x-\int_{0}^{1} f w d x
$$

传递到$\delta \rightarrow 0$的极限，并设定为0，我们得到

!!!!
\int_{0}^{1} u^{\prime} w^{\prime} d x-\int_{0}^{1} f w d x=0 \quad \forall w \in V
$$

也就是说，$u$满足弱问题\ref{3.3}。

\textbf{反过来说}，如果$u$是\ref{3.3}的解，通过设定$v=\delta w$，特别的，我们可以看到

!!!!
\int_{0}^{1} u^{\prime} \delta w^{\prime} d x-\int_{0}^{1} f \delta w d x=0
$$

则

!!!!
\begin{aligned}
J(u+\delta w)=\frac{1}{2} \int_{0}^{1}\left[(u+\delta w)^{\prime}\right]^{2} d x-\int_{0}^{1} f(u+\delta w) d x \\
= \frac{1}{2} \int_{0}^{1} u^{\prime 2} d x-\int_{0}^{1} f u d x+\int_{0}^{1} u^{\prime} \delta w^{\prime} d x-\int_{0}^{1} f \delta w d x+\frac{1}{2} \int_{0}^{1} \delta^{2} w^{\prime 2} d x \\
=J(u)+\frac{1}{2} \int_{0}^{1} \delta^{2} w^{\prime 2} d x
\end{aligned}
$$

自

!!!!
\frac{1}{2} \int_{0}^{1} \delta^{2} w^{\prime 2} d x \geq 0 \quad \forall w \in V, \forall \delta \in \mathbb{R}
$$

我们推断出

!!!!
J(u) \leq J(v) \quad \forall v \in V
$$

即$u$也满足变量问题\ref{3.3}。

备注（虚功原理）： 让我们再次考虑研究由固定在端点上并受到强度$f$的强迫项的弦所承担的构型的问题，由方程\ref{3.3}描述。我们用$v$表示弦从平衡位置的可接受位移（即端点的空位移） $u$ 。等式\ref{1.4}表示内力和外力对位移所做的功是相等的 $v$ ，这只不过是力学的虚功原理。此外，由于在我们的例子中存在一个势（事实上，\ref{3.4}中定义的$J(w)$表达了与系统的配置$w$相对应的全局势能），虚功原理规定，平衡配置所允许的任何位移都会引起系统势能的增加。在这个意义上，定理\ref{1.5}指出，弱解也是势能最小的一个。

至此，我们仅仅通过一个1维的小例子就证明了弱解的存在且唯一性。它与物理的虚功原理和数学的优化问题均有紧密的联系，且可以互相转化。

\subsubsection{Non-homogeneous Dirichlet problem}

在非均质情况下，\ref{3.3}中的边界条件被替换为

!!!!
u(0)=g_{0}, \quad u(1)=g_{1}
$$

$g_{0}$和$g_{1}$是两个分配值。

我们可以通过注意到如果$u$是非均质问题的解，那么函数$\stackrel{\circ}{u}=u-\left[(1-x) g_{0}+x g_{1}\right]$是相应的均质问题\ref{3.3}的解来还原到均质情况。函数$R_{g}=(1-x) g_{0}+x g_{1}$被称为边界数据的提升（或延伸，或延长）。

\subsubsection{Neumann Problem}

现在让我们考虑以下Neumann问题

!!!!
\begin{cases}-u^{\prime \prime}+\sigma u=f, & 0<x<1 \\ u^{\prime}(0)=h_{0}, & u^{\prime}(1)=h_{1}\end{cases}
\label{3.6}\end{equation}

$\sigma$是一个正函数，$h_{0}, h_{1}$是两个实数。我们注意到，在$\sigma=0$的情况下，这个问题的解不会是唯一的，它被定义到一个加性常数。通过应用Dirichlet问题的相同程序，即用测试函数$v$乘以方程，在区间$(0,1)$上积分并应用部分积分公式，我们得到方程

!!!!
\int_{0}^{1} u^{\prime} v^{\prime} d x+\int_{0}^{1} \sigma u v d x-\left[u^{\prime} v\right]_{0}^{1}=\int_{0}^{1} f v d x
$$

让我们假设$f \in \mathrm{L}^{2}(0,1)$和$\sigma \in \mathrm{L}^{\infty}(0,1)$ ，即$\sigma$是$(0,1)$上的有界函数。边界项从Neumann条件中是已知的。另一方面，在这种情况下，未知数$u$在边界上是不知道的，因此不需要强制要求$v$在边界上为0。因此，Neumann问题的弱表述是：找到$u \in \mathrm{H}^{1}(0,1)$，使得

!!!!
\int_{0}^{1} u^{\prime} v^{\prime} d x+\int_{0}^{1} \sigma u v d x=\int_{0}^{1} f v d x+h_{1} v(1)-h_{0} v(0) \quad \forall v \in \mathrm{H}^{1}(0,1)
$$

在同质情况下$h_{0}=h_{1}=0$，弱问题的特征是与Dirichlet情况相同的方程，但测试函数的空间$V$现在是$\mathrm{H}^{1}(0,1)$而不是$\mathrm{H}_{0}^{1}(0,1)$ 。

\subsubsection{Mixed homogeneous problem}

类似的考虑适用于混合同质问题，即当我们在一个端点有一个同质的Dirichlet条件，在另一个端点有一个同质的Neumann条件。

!!!!
\begin{cases}-u^{\prime \prime}+\sigma u=f, & 0<x<1 \\ u(0)=0, & u^{\prime}(1)=0\end{cases}
\label{3.7}\end{equation}

在这种情况下，必须要求测试函数在$x=0$为null。设置 $\Gamma_{D}=$ $\{0\}$ 并定义

!!!!
\mathrm{H}_{\Gamma_{D}}^{1}(0,1)=\left\{v \in \mathrm{H}^{1}(0,1): v(0)=0\right\}
$$

问题\ref{3.7}的弱表述是：找到$u \in \mathrm{H}_{\Gamma_{D}}^{1}(0,1)$，以便

!!!!
\int_{0}^{1} u^{\prime} v^{\prime} d x+\int_{0}^{1} \sigma u v d x=\int_{0}^{1} f v d x \quad \forall v \in \mathrm{H}_{\Gamma_{D}}^{1}(0,1)
$$

与$f \in \mathrm{L}^{2}(0,1)$和$\sigma \in \mathrm{L}^{\infty}(0,1)$ 。该公式再次与同质Dirichlet问题相同，但寻找解的空间改变了。

\subsubsection{Mixed (or Robin) boundary conditions}

最后，考虑以下问题

!!!!
\begin{cases}-u^{\prime \prime}+\sigma u=f, & 0<x<1 \\ u(0)=0, & u^{\prime}(1)+\gamma u(1)=r\end{cases}
\label{3.8}\end{equation}

其中$\gamma>0$和$r$是两个指定常数。

同样在这种情况下，我们将使用在$x=0$处为null的测试函数，$u$的值因此是已知的。与Neumann情况相反，$x=1$的边界项，由部分积分得出，不再提供一个已知量，而是一个与未知量$u$成比例的项。事实上，我们有


!!!!
-\left[u^{\prime} v\right]_{0}^{1}=-r v(1)+\gamma u(1) v(1)
$$

因此，弱的表述是：找到$u \in \mathrm{H}_{\Gamma_{D}}^{1}(0,1)$，使得

!!!!
\int_{0}^{1} u^{\prime} v^{\prime} d x+\int_{0}^{1} \sigma u v d x+\gamma u(1) v(1)=\int_{0}^{1} f v d x+r v(1) \quad \forall v \in \mathrm{H}_{\Gamma_{D}}^{1}(0,1)
$$

一个边界条件是$u$的值和它的第一个导数的值之间的线性组合，称为罗宾（或牛顿，或第三类）条件。

\subsection{2D Poisson problem }

在本节中，我们考虑在二维情况下与泊松方程相关的边界值问题。

\subsubsection{The homogeneous Dirichlet problem}

问题在于找到$u$，使得

!!!!
\begin{cases}-\Delta u=f & \text { in } \Omega \\ u=0 & \text { on } \partial \Omega\end{cases}
\label{3.9}\end{equation}

其中$\Omega \subset \mathbb{R}^{2}$是一个边界为$\partial \Omega$的有界域。我们以类似于一维情况的方式进行。通过将\ref{3.9}中的微分方程乘以一个任意函数$v$并在$\Omega$上积分，我们发现

!!!!
-\int_{\Omega} \Delta u v d \Omega=\int_{\Omega} f v d \Omega
$$

在这一点上，有必要应用一维积分公式的多维类似物。这可以通过应用`divergence
(Gauss) theorem`得到，即

!!!!
\int_{\Omega} \operatorname{div}(\mathbf{a}) d \Omega=\int_{\partial \Omega} \mathbf{a} \cdot \mathbf{n} d \gamma
\label{3.10}\end{equation}

$\mathbf{a}(\mathbf{x})=\left(a_{1}(\mathbf{x}), a_{2}(\mathbf{x})\right)^{T}$是一个足够规则的矢量值函数，$\mathbf{n}(\mathbf{x})=$ $\left(n_{1}(\mathbf{x}), n_{2}(\mathbf{x})\right)^{T}$是$\partial \Omega$上的外向单位法向量。如果我们将\ref{3.10}首先应用于函数$\mathbf{a}=(\varphi \psi, 0)^{T}$，然后应用于$\mathbf{a}=(0, \varphi \psi)^{T}$，我们可以得到以下关系

!!!!
\int_{\Omega} \frac{\partial \varphi}{\partial x_{i}} \psi d \Omega=-\int_{\Omega} \varphi \frac{\partial \psi}{\partial x_{i}} d \Omega+\int_{\partial \Omega} \varphi \psi n_{i} d \gamma, \quad i=1,2
\label{3.11}\end{equation}

还请注意，如果我们取$\mathbf{a}=\mathbf{b} \varphi$，其中$\mathbf{b}$和$\varphi$分别是一个矢量和一个标量场，那么\ref{3.10}就会得到

!!!!
\int_{\Omega} \varphi \operatorname{div} \mathbf{b} d \Omega=-\int_{\Omega} \mathbf{b} \cdot \nabla \varphi d \Omega+\int_{\partial \Omega} \mathbf{b} \cdot \mathbf{n} \varphi d \gamma
\label{3.12}\end{equation}

这被称为`发散算子的格林公式`。

我们利用\ref{3.11}，考虑到$\Delta u=\operatorname{div} \nabla u=\sum_{i=1}^{2} \frac{\partial}{\partial x_{i}}\left(\frac{\partial u}{\partial x_{i}}\right)$ 这一事实。假设所有的积分都有意义，我们发现

!!!!
\begin{aligned}
-\int_{\Omega} \Delta u v d \Omega &=-\sum_{i=1}^{2} \int_{\Omega} \frac{\partial}{\partial x_{i}}\left(\frac{\partial u}{\partial x_{i}}\right) v d \Omega \\
&=\sum_{i=1}^{2} \int_{\Omega} \frac{\partial u}{\partial x_{i}} \frac{\partial v}{\partial x_{i}} d \Omega-\sum_{i=1}^{2} \int_{\partial \Omega} \frac{\partial u}{\partial x_{i}} v n_{i} d \gamma \\
&=\int_{\Omega} \sum_{i=1}^{2} \frac{\partial u}{\partial x_{i}} \frac{\partial v}{\partial x_{i}} d \Omega-\int_{\partial \Omega}\left(\sum_{i=1}^{2} \frac{\partial u}{\partial x_{i}} n_{i}\right) v d \gamma
\end{aligned}
\label{3.13}\end{equation}

我们得到以下关系，称为`拉普拉斯的格林公式`。

!!!!
-\int_{\Omega} \Delta u v d \Omega=\int_{\Omega} \nabla u \cdot \nabla v d \Omega-\int_{\partial \Omega} \frac{\partial u}{\partial n} v d \gamma
\label{3.14}\end{equation}

与一维情况类似，同质Dirichlet问题将导致边界项消失。

考虑到这一点，我们得到问题\ref{3.9}的以下弱表述

!!!!
\text { find } \mathrm{u} \in \mathrm{H}_{0}^{1}(\Omega): \int_{\Omega} \nabla u \cdot \nabla v d \Omega=\int_{\Omega} f v d \Omega \quad \forall v \in \mathrm{H}_{0}^{1}(\Omega)
\label{3.15}\end{equation}

$f$是$\mathrm{L}^{2}(\Omega)$的一个函数，并设置有

!!!!
\begin{aligned}
&\mathrm{H}^{1}(\Omega)=\left\{v: \Omega \rightarrow \mathbb{R} \text { such that } v \in \mathrm{L}^{2}(\Omega), \frac{\partial v}{\partial x_{i}} \in \mathrm{L}^{2}(\Omega), i=1,2\right\} \\
&\mathrm{H}_{0}^{1}(\Omega)=\left\{v \in \mathrm{H}^{1}(\Omega): v=0 \text { on } \partial \Omega\right\}
\end{aligned}
$$

必须在分布的意义上理解导数，在traces的意义上理解$v=0$对$\partial \Omega$的条件。特别是，我们观察到，如果$u, v \in \mathrm{H}_{0}^{1}(\Omega)$，那么$\nabla u, \nabla v \in\left[\mathrm{L}^{2}(\Omega)\right]^{2}$，从而$\nabla u \cdot \nabla v \in \mathrm{L}^{1}(\Omega)$。后面的属性是通过应用以下不等式得到的

!!!!
\left|\int_{\Omega} \nabla u \cdot \nabla v d \Omega\right| \leq\|\nabla u\|_{\mathrm{L}^{2}(\Omega)}\|\nabla v\|_{\mathrm{L}^{2}(\Omega)}
$$

这是Cauchy-Schwarz不等式的直接结果。

因此，出现在\ref{3.15}左侧的积分是完全有意义的，出现在右侧的也是如此。

与一维情况类似，在二维情况下也可以证明问题\ref{3.15}等同于以下变分问题

!!!!
\text { find } u \in V:\left\{\begin{array}{l}
J(u)=\inf _{v \in V} J(v), \text { with } \\
J(v)=\frac{1}{2} \int_{\Omega}|\nabla v|^{2} d \Omega-\int_{\Omega} f v d \Omega
\end{array}\right.
$$

已设置 $V=\mathrm{H}_{0}^{1}(\Omega)$ 。

我们可以通过引入以下形式，以更紧凑的方式重写弱的表述\ref{3.15}

!!!!
a: V \times V \rightarrow \mathbb{R}, \quad a(u, v)=\int_{\Omega} \nabla u \cdot \nabla v d \Omega
$$

和以下功能

!!!!
F: V \rightarrow \mathbb{R}, \quad F(v)=\int_{\Omega} f v d \Omega
$$


因此，问题\ref{3.15}变成了：

!!!!
\text { find } u \in V: \quad a(u, v)=F(v) \quad \forall v \in V \text {. }
$$

我们注意到，$a(\cdot, \cdot)$是一个双线性形式（即对其两个参数的线性），而$F$是一个线性函数。那么

!!!!
|F(v)| \leq\|f\|_{\mathrm{L}^{2}(\Omega)}\|v\|_{\mathrm{L}^{2}(\Omega)} \leq\|f\|_{\mathrm{L}^{2}(\Omega)}\|v\|_{\mathrm{H}^{1}(\Omega)}
$$

因此，$F$也是有界的。它的规范被$\|F\|_{V^{\prime}} \leq\|f\|_{\mathrm{L}^{2}(\Omega)}$所约束。因此，$F$属于$V^{\prime}$，即$V$的对偶空间，即定义在$V$上的线性和连续函数的集合。

\subsubsection{在分布的意义上，Dirichlet问题的弱形式和强形式之间的等效性}

我们想证明问题\ref{3.9}的方程实际上被弱解所满足，尽管只是在分布的意义上。

为此，我们考虑弱表述\ref{3.15}。现在让$\mathscr{D}(\Omega)$成为$\Omega$中无限可微且具有紧凑支持的函数空间。我们回顾一下，$\mathscr{D}(\Omega) \subset \mathrm{H}_{0}^{1}(\Omega)$ 。因此，通过在\ref{1.15}中选择$v=\varphi \in \mathscr{D}(\Omega)$，我们有

!!!!
\int_{\Omega} \nabla u \cdot \nabla \varphi d \Omega=\int_{\Omega} f \varphi d \Omega \quad \forall \varphi \in \mathscr{D}(\Omega)
\label{3.16}\end{equation}

通过对\ref{3.16}的左手边应用格林公式\ref{3.14}，我们发现

!!!!
-\int_{\Omega} \Delta u \varphi d \Omega+\int_{\partial \Omega} \frac{\partial u}{\partial n} \varphi d \gamma=\int_{\Omega} f \varphi d \Omega \quad \forall \varphi \in \mathscr{D}(\Omega)
$$

其中的积分要通过二元性来理解，也就是说

!!!!
\begin{aligned}
-\int_{\Omega} \Delta u \varphi d \Omega &=\mathscr{D}^{\prime}(\Omega)\langle-\Delta u, \varphi\rangle_{\mathscr{D}(\Omega)} \\
\int_{\partial \Omega} \frac{\partial u}{\partial n} \varphi d \gamma &=\mathscr{D}^{\prime}(\partial \Omega)\left\langle\frac{\partial u}{\partial n}, \varphi\right\rangle_{\mathscr{D}(\partial \Omega)}
\end{aligned}
$$

由于$\varphi \in \mathscr{D}(\Omega)$，边界积分为空，所以

!!!!
\mathscr{D}^{\prime}(\Omega)\langle-\Delta u-f, \varphi\rangle_{\mathscr{D}(\Omega)}=0 \quad \forall \varphi \in \mathscr{D}(\Omega),
$$

这相当于说$-\Delta u-f$是null分布，也就是

!!!!
-\Delta u=f \quad \text { in } \mathscr{D}^{\prime}(\Omega) .
$$

因此，微分方程\ref{3.9}得到了验证，只要我们在分布的意义上理解导数，并且我们不是在点的意义上，而是在分布的意义上解释$-\Delta u$和$f$之间的相等（因此在$\Omega$中几乎无处不在）。最后，$u$在边界上消失的事实（在trace的意义上）是$u$在$\mathrm{H}_{0}^{1}(\Omega)$中的直接结果。

\subsubsection{mixed, non homogeneous条件}

我们现在要解决的问题如下

!!!!
\begin{cases}-\Delta u=f & \text { in } \Omega \\ u=g & \text { on } \Gamma_{D} \\ \frac{\partial u}{\partial n}=\phi & \text { on } \Gamma_{N}\end{cases}
\label{3.17}\end{equation}

其中$\Gamma_{D}$和$\Gamma_{N}$产生一个$\partial \Omega$的分区，也就是$\Gamma_{D} \cup \Gamma_{N}=\partial \Omega, \stackrel{\circ}{\Gamma_{D}} \cap \Gamma_{N}=\emptyset$。

在Neumann问题的情况下，其中$\Gamma_{D}=\emptyset$ ，数据$f$和$\phi$必须验证以下兼容条件

!!!!
-\int_{\partial \Omega} \phi d \gamma=\int_{\Omega} f d \Omega
\label{3.18}\end{equation}

以使问题有一个解决方案。条件\ref{3.18}是通过对\ref{3.17}中的微分方程进行积分并应用发散定理\ref{3.10}推导出来的

!!!!
-\int_{\Omega} \Delta u d \Omega=-\int_{\Omega} \operatorname{div}(\nabla u) d \Omega=-\int_{\partial \Omega} \frac{\partial u}{\partial n} d \gamma
$$

此外，我们注意到，在Neumann问题的情况下，解只定义到一个加性常数。为了具有唯一性，例如，在$\Omega$中找到一个具有零平均的函数就足够了。

现在让我们假设$\Gamma_{D} \neq \emptyset$，以确保强问题的解的唯一性，而不考虑数据的兼容性条件。我们还假设$f \in \mathrm{L}^{2}(\Omega), g \in \mathrm{H}^{1 / 2}\left(\Gamma_{D}\right)$和$\phi \in \mathrm{L}^{2}\left(\Gamma_{N}\right)$，用$\mathrm{H}^{1 / 2}\left(\Gamma_{D}\right)$表示$L^{2}\left(\Gamma_{D}\right)$的函数空间，它是$\mathrm{H}^{1}(\Omega)$的函数的迹。

根据格林公式\ref{3.14}，我们从\ref{3.17}得到

!!!!
\int_{\Omega} \nabla u \cdot \nabla v d \Omega-\int_{\partial \Omega} \frac{\partial u}{\partial n} v d \gamma=\int_{\Omega} f v d \Omega
\label{3.19}\end{equation}



我们回顾一下，$\partial u / \partial n=\phi$ for $\Gamma_{N}$，通过利用积分的可加性，\ref{3.19}变为

!!!!
\int_{\Omega} \nabla u \cdot \nabla v d \Omega-\int_{\Gamma_{D}} \frac{\partial u}{\partial n} v d \gamma-\int_{\Gamma_{N}} \phi v d \gamma=\int_{\Omega} f v d \Omega
\label{3.20}\end{equation}

通过强迫test函数$v$在$\Gamma_{D}$上消失，\ref{3.20} 中出现的第一个边界积分消失。因此，混合问题有如下弱表述

!!!!
\text { find } u \in V_{g}: \quad \int_{\Omega} \nabla u \cdot \nabla v d \Omega=\int_{\Omega} f v d \Omega+\int_{\Gamma_{N}} \phi v d \gamma \quad \forall v \in V,
\label{3.21}\end{equation}

用$V$表示的空间

!!!!
V=\mathrm{H}_{\Gamma_{D}}^{1}(\Omega)=\left\{v \in \mathrm{H}^{1}(\Omega):\left.v\right|_{\Gamma_{D}}=0\right\},
$$

并设置了

!!!!
V_{g}=\left\{v \in \mathrm{H}^{1}(\Omega):\left.v\right|_{\Gamma_{D}}=g\right\}
$$

\ref{3.21}的表述并不令人满意，不仅是因为空间的选择是 "不对称的"$\left(v \in V\right.$，而$\left.u \in V_{g}\right)$，主要是因为$V_{g}$是一个affine流形，但不是$\mathrm{H}^{1}(\Omega)$的子空间（事实上，$V_{g}$元素的线性组合并不仍然是$V_{g}$的元素）。

然后，我们假设知道一个函数$R_{g}$，称为`lifting of the boundary data`，从而

!!!!
R_{g} \in \mathrm{H}^{1}(\Omega),\left.\quad R_{g}\right|_{\Gamma_{D}}=g
$$

此外，我们假设这种提升是连续的，也就是

!!!!
\exists C>0:\left\|R_{g}\right\|_{\mathrm{H}^{1}(\Omega)} \leq C\|g\|_{\mathrm{H}^{1 / 2}\left(\Gamma_{D}\right)} \forall g \in \mathrm{H}^{1 / 2}\left(\Gamma_{D}\right)
$$

我们设定$\stackrel{\circ}{u}=u-R_{g}$，我们首先观察到$\left.\dot{u}\right|_{\Gamma_{D}}=\left.u\right|_{\Gamma_{D}}-\left.R_{g}\right|_{\Gamma_{D}}=0$ ，也就是$\stackrel{\circ}{u} \in \mathrm{H}_{\Gamma_{D}}^{1}(\Omega)$ 。此外，由于$\nabla u=\nabla \stackrel{\circ}{u}+\nabla R_{g}$，问题\ref{1.21}成为

!!!!
\text { find } \stackrel{\circ}{u} \in \mathrm{H}_{\Gamma_{D}}^{1}(\Omega): \quad a(\dot{u}, v)=F(v) \quad \forall v \in \mathrm{H}_{\Gamma_{D}}^{1}(\Omega)
\label{3.22}\end{equation}

定义了双线性形式$a(\cdot, \cdot)$，而线性函数$F$现在的形式是

!!!!
F(v)=\int_{\Omega} f v d \Omega+\int_{\Gamma_{N}} \phi v d \gamma-\int_{\Omega} \nabla R_{g} \cdot \nabla v d \Omega
$$

现在问题是对称的，因为寻求（新）未知解的空间与测试函数空间相吻合。

Dirichlet条件被称为基本条件，因为它们是在设定问题的函数空间中明确施加的。

而Neumann条件则被说成是自然条件，因为它们是由问题的解隐含地满足的。这种处理方式的差异对近似问题有重要影响。

备注: 将问题还原为 "对称 "形式，可以在数值求解时得到一个具有对称矩阵的线性系统（例如通过有限元方法）。

备注: 建立一个具有任意形式的边界函数的提升$R_{g}$可能会变成一个问题。在数值逼近的背景下，这样的任务比较简单，一般来说，我们可以建立一个函数的逼近的提升$g$。

\subsubsection{在分布的意义上，Neumann问题的弱形式和强形式之间的等效性}

让我们考虑非均质的Neumann问题

!!!!
\begin{cases}-\Delta u+\sigma u=f & \text { in } \Omega \\ \frac{\partial u}{\partial n}=\phi & \text { on } \partial \Omega\end{cases}
$$

其中$\sigma$是一个正常数，或者更一般地说，一个函数$\sigma \in \mathrm{L}^{\infty}(\Omega)$，使得$\sigma(\mathbf{x}) \geq \alpha_{0}$ 在$\Omega$中，对于一个精心选择的常数$\alpha_{0}>0$。我们还假设 $f \in \mathrm{L}^{2}(\Omega)$ 和 $\phi \in \mathrm{L}^{2}(\partial \Omega)$ 。可以得出以下弱表述:

!!!!
\begin{aligned}
&\text { find } u \in \mathrm{H}^{1}(\Omega): \\
&\int_{\Omega} \nabla u \cdot \nabla v d \Omega+\int_{\Omega} \sigma u v d \Omega=\int_{\Omega} f v d \Omega+\int_{\partial \Omega} \phi v d \gamma \quad \forall v \in \mathrm{H}^{1}(\Omega) .
\end{aligned}
\label{3.23}\end{equation}

通过采取$v=\varphi \in \mathscr{D}(\Omega)$并通过部分反积分，我们得到

!!!!
\mathscr{D}^{\prime}(\Omega)\langle-\Delta u+\sigma u-f, \varphi\rangle_{\mathscr{D}(\Omega)}=0 \quad \forall \varphi \in \mathscr{D}(\Omega)
$$

因此

!!!!
-\Delta u+\sigma u=f \quad \text { in } \mathscr{D}^{\prime}(\Omega)
$$

即

!!!!
-\Delta u+\sigma u-f=0 \quad \text { a.e. in } \Omega
\label{3.24}\end{equation}

在$u \in C^{2}(\Omega)$的情况下，格林公式\ref{3.14}在\ref{3.23}中的应用导致了

!!!!
\int_{\Omega}(-\Delta u+\sigma u-f) v d \Omega+\int_{\partial \Omega}\left(\frac{\partial u}{\partial n}-\phi\right) v=0 \quad \forall v \in \mathrm{H}^{1}(\Omega)
\label{3.25}\end{equation}

因此，根据\ref{3.24},

!!!!
\frac{\partial u}{\partial n}=\phi \quad \text { on } \partial \Omega
$$

在\ref{3.23}的解$u$只在$\mathrm{H}^{1}(\Omega)$中的情况下，可以使用广义格林公式，即存在一个唯一的线性连续函数$g \in\left(\mathrm{H}^{1 / 2}(\partial \Omega)\right)^{\prime}$（称为广义法向导），它在空间$\mathrm{H}^{1 / 2}(\partial \Omega)$上运行并满足以下条件

!!!!
\int_{\Omega} \nabla u \cdot \nabla v d \Omega=\langle-\Delta u, v\rangle+\ll g, v \gg \quad \forall v \in \mathrm{H}^{1}(\Omega)
$$

我们用$<\cdot, \cdot>$表示$\mathrm{H}^{1}(\Omega)$和其对偶之间的配对，用$\ll \cdot, \cdot \gg$表示$\mathrm{H}^{1 / 2}(\partial \Omega)$和其对偶之间的配对。显然，如果$u$具有足够的规律性，$g$与$u$的经典正态导数相吻合。为了简单起见，我们在本章的其余部分使用广义法向导的符号$\partial u / \partial n$。因此我们得到，对于$v \in \mathrm{H}^{1}(\Omega)$来说

!!!!
\langle-\Delta u+\sigma u-f, v\rangle+\ll \partial u / \partial n-\phi, v \gg=0
$$

使用\ref{3.24}，我们最后得出结论：

!!!!
\ll \partial u / \partial n-\phi, v \gg=0 \quad \forall v \in \mathrm{H}^{1}(\Omega)
$$

因此，$\partial u / \partial n=\phi$ a.e.对$\partial \Omega$。

\subsection{More general elliptic problems}

现在让我们来考虑这个问题

!!!!
\left\{\begin{array}{lll}
-\operatorname{div}(\mu \nabla u)+\sigma u=f & \text { in } \Omega \\
u=g & & \text { on } \Gamma_{D} \\
\mu \frac{\partial u}{\partial n}=\phi & & \text { on } \Gamma_{N}
\end{array}\right.
\label{3.26}\end{equation}

其中 $\Gamma_{D} \cup \Gamma_{N}=\partial \Omega$ 与 $\stackrel{\circ}{\Gamma}_{D} \cap \stackrel{\circ}{\Gamma_{N}}=\emptyset$ .我们将假设 $f \in \mathrm{L}^{2}(\Omega), \mu, \sigma \in$ $\mathrm{L}^{\infty}(\Omega)$ 。此外，我们假设有一个$\mu_{0}>0$，使得$\mu(\mathbf{x}) \geq \mu_{0}$和$\sigma(\mathbf{x}) \geq 0$ a.e.在$\Omega$。只有在$\sigma=0$的情况下，我们才会要求$\Gamma_{D}$是不空的，以防止解失去唯一性。最后，我们将假设$g$和$\phi$是$\partial \Omega$上足够有规律的函数，例如$g \in \mathrm{H}^{1 / 2}\left(\Gamma_{D}\right)$和$\phi \in \mathrm{L}^{2}\left(\Gamma_{N}\right)

同样在这种情况下，我们通过将方程乘以测试函数$v$和在域$\Omega$上进行积分（再一次正式地）来进行。

!!!!
\int_{\Omega}[-\operatorname{div}(\mu \nabla u)+\sigma u] v d \Omega=\int_{\Omega} f v d \Omega
$$

通过应用格林公式，我们得到

!!!!
\int_{\Omega} \mu \nabla u \cdot \nabla v d \Omega+\int_{\Omega} \sigma u v d \Omega-\int_{\partial \Omega} \mu \frac{\partial u}{\partial n} v d \gamma=\int_{\Omega} f v d \Omega
$$

这也可以改写为

!!!!
\int_{\Omega} \mu \nabla u \cdot \nabla v d \Omega+\int_{\Omega} \sigma u v d \Omega-\int_{\Gamma_{D}} \mu \frac{\partial u}{\partial n} v d \gamma=\int_{\Omega} f v d \Omega+\int_{\Gamma_{N}} \mu \frac{\partial u}{\partial n} v d \gamma
$$

函数$\mu \partial u / \partial n$被称为与算子$-\operatorname{div}(\mu \nabla u)$相关的$u$的正态导数。在$\Gamma_{D}$上，我们规定测试函数$v$为空，而在$\Gamma_{N}$上，我们规定正态导数等于$\phi$ 。我们得到

!!!!
\int_{\Omega} \mu \nabla u \cdot \nabla v d \Omega+\int_{\Omega} \sigma u v d \Omega=\int_{\Omega} f v d \Omega+\int_{\Gamma_{N}} \phi v d \gamma
$$

用$R_{g}$表示$g$的提升，我们设定 $\stackrel{\circ}{u}=u-R_{g}$。因此，问题\ref{3.26}的弱表述是

!!!!
\begin{aligned}
&\text { find }  \stackrel{\circ}{u} \in \mathrm{H}_{\Gamma_{D}}^{1}(\Omega): \\
&\qquad \int_{\Omega} \mu \nabla  \stackrel{\circ}{u} \cdot \nabla v d \Omega+\int_{\Omega} \sigma \stackrel{\circ}{u} v d \Omega= \\
&\int_{\Omega} f v d \Omega-\int \mu \nabla R_{g} \cdot \nabla v d \Omega-\int_{\Omega} \sigma R_{g} v d \Omega+\int_{\Gamma_{N}} \phi v d \gamma \quad \forall v \in \mathrm{H}_{\Gamma_{D}}^{1}(\Omega) .
\end{aligned}
\label{3.27}\end{equation}

我们定义双线性形式

!!!!
a: V \times V \rightarrow \mathbb{R}, \quad a(\stackrel{\circ}{u}, v)=\int_{\Omega} \mu \nabla \stackrel{\circ}{u} \cdot \nabla v d \Omega+\int_{\Omega} \sigma \stackrel{\circ}{u} v d \Omega
\label{3.28}\end{equation}

以及线性和连续的函数

!!!!
F: V \rightarrow \mathbb{R}, F(v)=-a\left(R_{g}, v\right)+\int_{\Omega} f v d \Omega+\int_{\Gamma_{N}} \phi v d \gamma
\label{3.29}\end{equation}

那么前面的问题可以改写为

!!!!
\text { find } \stackrel{\circ}{u} \in \mathrm{H}_{\Gamma_{D}}^{1}(\Omega): \quad a(\stackrel{\circ}{u}, v)=F(v) \quad \forall v \in \mathrm{H}_{\Gamma_{D}}^{1}(\Omega)
\label{3.30}\end{equation}

一个比\ref{3.26}更普遍的问题如下

!!!!
\begin{cases}L u=f & \text { in } \Omega \\ u=g & \text { on } \Gamma_{D} \\ \frac{\partial u}{\partial n_{L}}=\phi & \text { on } \Gamma_{N}\end{cases}
\label{3.31}\end{equation}

其中，像往常一样，$\Gamma_{D} \cup \Gamma_{N}=\partial \Omega, \stackrel{\circ}{\Gamma}_{D} \cap \stackrel{\circ}{\Gamma_{N}}=\emptyset$ ，并定义了

!!!!
L u=-\sum_{i, j=1}^{2} \frac{\partial}{\partial x_{i}}\left(a_{i j} \frac{\partial u}{\partial x_{j}}\right)+\sigma u
\label{3.32}\end{equation}

系数 $a_{i j}$ 是定义在 $\Omega$ 上的函数。其导数

!!!!
\frac{\partial u}{\partial n_{L}}=\sum_{i, j=1}^{2} a_{i j} \frac{\partial u}{\partial x_{j}} n_{i}
\label{3.33}\end{equation}

被称为与算子$u$相关的$L$的法向导数（它与$L u=-\Delta u$时的法向导数重合）。

让我们假设$\sigma(\mathbf{x}) \in \mathrm{L}^{\infty}(\Omega)$，并且存在一个$\alpha_{0}>0$，使得$\sigma(\mathbf{x}) \geq \alpha_{0}$ a.e.在$\Omega$。此外，让我们假设系数$a_{i j}: \bar{\Omega} \rightarrow \mathbb{R}$是连续函数$\forall i, j=1,2$ ，并且存在一个正常数$\alpha$，使得

!!!!
\forall \boldsymbol{\xi}=\left(\xi_{1}, \xi_{2}\right)^{T} \in \mathbb{R}^{2} \quad \sum_{i, j=1}^{2} a_{i j}(\mathbf{x}) \xi_{i} \xi_{j} \geq \alpha \sum_{i=1}^{2} \xi_{i}^{2} \quad \text { a.e. in } \Omega
\label{3.34}\end{equation}

在这种情况下，弱表述仍然与\ref{3.30}相同，函数$F$仍然是\ref{3.29}中引入的那个，而

!!!!
a(u, v)=\int_{\Omega}\left(\sum_{i, j=1}^{2} a_{i j} \frac{\partial u}{\partial x_{j}} \frac{\partial v}{\partial x_{i}}+\sigma u v\right) d \Omega
\label{3.36}\end{equation}

可以证明，在系数\ref{3.34}的椭圆性假设下，这个双线性形式是连续和强制的。这些特性将在分析问题\ref{3.30}的良好解决性时加以利用。


备注：（罗宾条件）在整个边界上执行罗宾边界条件的情况下，例如

!!!!
\mu \frac{\partial u}{\partial n}+\gamma u=0 \quad \text { on } \partial \Omega
$$

需要更加谨慎。在这种情况下，该问题的弱形式为

!!!!
\text { find } u \in H^{1}(\Omega): a(u, v)=\int_{\Omega} f v d \Omega \quad \forall v \in H^{1}(\Omega)
$$

其中 $a(u, v)=\int_{\Omega} \mu \nabla u \cdot \nabla v d \Omega+\int_{\Omega} \gamma u v d \Omega$ .如果 $\gamma<0$ ，这个双线性形式是不具有强制性的。对这个问题的分析可以通过Peetre-Tartar法则等方式进行，见 [EG04] 。

\subsubsection{存在性和唯一性}

以下基本结果成立：

![](https://cdn.mathpix.com/snip/images/J0ArZTLj3e5mw4eNwDeUEQD_XPNIHy4iLOWDn0UjdLg.original.fullsize.png)

!!!!
\text { find } u \in V: \quad a(u, v)=F(v) \quad \forall v \in V
\label{3.35}\end{equation}

证明：这基于两个经典的函数分析结果：Riesz表示定理（见第2章定理2.1）和Banach封闭范围定理。有兴趣的读者可以参考，例如，[QV94，第5章]。

因此，Lax-Milgram定理确保了椭圆问题的弱表述是良好的，只要关于形式$a(\cdot, \cdot)$和函数$F(\cdot)$的假设成立。从这个定理引申出几个结果。我们在下面的推论中报告其中一个最重要的结果。

![](https://cdn.mathpix.com/cropped/10058ab4e7f0c5bd6fe5bcd4db204623-054.jpg?height=204&width=720&top_left_y=116&top_left_x=97)

证明。只要在\ref{3.37} 中选择$v=u$，然后利用双线性形式$a(\cdot, \cdot)$的矫捷性就可以了。事实上，我们有

!!!!
\alpha\|u\|_{V}^{2} \leq a(u, u)=F(u)
$$

另一方面，由于$F$是线性和连续的，所以它也是有界的，并且上界

!!!!
|F(u)| \leq\|F\|_{V^{\prime}}\|u\|_{V}
$$

成立，因此要求如下。

备注3.6： 如果双线性形式$a(\cdot, \cdot)$另外是对称的，即

!!!!
a(u, v)=a(v, u) \quad \forall u, v \in V,
$$

那么(3.37)等同于下面的变分问题

!!!!
\left\{\begin{array}{l}
\text { find } u \in V: \quad J(u)=\min _{v \in V} J(v) \\
\text { with } J(v)=\frac{1}{2} a(v, v)-F(v)
\end{array}\right.
\label{3.36}\end{equation}

\subsection{Adjoint operator and adjoint problem}

在本节中，我们将介绍希尔伯特空间中给定算子的对偶概念，以及给定边界值问题的对偶问题。然后我们将展示如何获得对偶问题，以及相关的边界条件。例如，在为Galerkin方法建立先验和后验的误差估计时，以及在解决最优控制问题时，给定微分问题的对偶问题起着基本作用。

设$V$为希尔伯特空间，具有标量积$(\cdot, \cdot)_{V}$和规范$\|\cdot\|_{V}$，设$V^{\prime}$为其对偶空间。让$a: V \times V \rightarrow \mathbb{R}$是一个连续的、强制性的双线性形式，让$A: V \rightarrow V^{\prime}$是其相关的椭圆算子，即$A \in \mathscr{L}\left(V, V^{\prime}\right)$ ，

!!!!
{ }_{V^{\prime}}\langle A v, w\rangle_{V}=a(v, w) \quad \forall v, w \in V
$$

让$a^{*}: V \times V \rightarrow \mathbb{R}$为双线性形式，定义为

!!!!
a^{*}(w, v)=a(v, w) \quad \forall v, w \in V,
\label{3.37}\end{equation}

并考虑与形式$A^{*}: V \rightarrow V^{\prime}$相关的算子$a^{*}(\cdot, \cdot)$，也就是

!!!!
{ }_{V^{\prime}}\left\langle A^{*} w, v\right\rangle_{V}=a^{*}(w, v) \quad \forall v, w \in V
$$

由于\ref{3.37}，我们有以下关系，被称为拉格朗日特性

!!!!
{ }_{V^{\prime}}\left\langle A^{*} w, v\right\rangle_{V}={ }_{V^{\prime}}\langle A v, w\rangle_{V} \quad \forall v, w \in V
\label{3.38}\end{equation}

请注意，这正是在希尔伯特空间和其对偶之间作用的给定算子的对偶定义$A$的基础上的等式。我们应该指出这个对偶算子$A^{\prime}$ 。然而，我们更愿意用$A^{*}$来表示它，因为后者的符号在椭圆边界值问题的背景下更习惯于使用。

如果$a(\cdot, \cdot)$是一个对称形式，$a^{*}(\cdot, \cdot)$与$a(\cdot, \cdot)$重合，$A^{*}$与$A$ 重合。在这种情况下，$A$被说成是`self-adjoint`; 如果$A A^{*}=A^{*} A$ ，则被说成是`normal`。

自然，身份算子 $I$ 是self-adjoint的$\left(I=I^{*}\right)$ ，而如果一个算子是self-adjoint的，那么它也是normal。

下面列举了作为前述定义的结果的对偶运算符的一些属性。

- $A$是线性和连续的，那么$A^{*}$也是，也就是$A^{*} \in \mathscr{L}\left(V, V^{\prime}\right)$ 。

- $\left\|A^{*}\right\|_{\mathscr{L}\left(\mathscr{V}, \mathscr{V}^{\prime}\right)}=\|A\|_{\mathscr{L}\left(\mathscr{V}, \mathscr{V}^{\prime}\right)}$ 

- $(A+B)^{*}=A^{*}+B^{*}$ ;

- $(A B)^{*}=B^{*} A^{*}

- $\left(A^{*}\right)^{*}=A

- $\left(A^{-1}\right)^{*}=\left(A^{*}\right)^{-1}$（如果$A$是可逆的）。

- $(\alpha A)^{*}=\alpha A^{*}$ $\forall \alpha \in \mathbb{R}$ .

当我们需要找到一个给定（原始）问题的对偶问题时，我们将使用`拉格朗日特性`来描述对偶问题的微分方程以及其边界条件。

我们提供一个这样的例子，从一个简单的一维扩散传输方程开始，由同质的罗宾-Dirichlet边界条件完成

!!!!
\begin{cases}A v=-v^{\prime \prime}+v^{\prime}=f, & x \in I=(0,1), \\ v^{\prime}(0)+\beta v(0)=0, & v(1)=0\end{cases}
\label{3.39}\end{equation}

假设$\beta$不变。请注意，这个问题的弱形式是

!!!!
\text { find } u \in V \text { such that } a(u, v)=\int_{0}^{1} f v d x \quad \forall v \in V,
$$

其中,

!!!!
V=\left\{v \in H^{1}(0,1): v(1)=0\right\}
$$

!!!!
a: V \times V \rightarrow \mathbb{R}, a(u, v)=\int_{0}^{1}\left(u^{\prime}-u\right) v^{\prime} d x-(\beta+1) u(0) v(0)
$$

由\ref{3.37}我们得到， $\forall v, w \in V$ 

!!!!
\begin{aligned}
a^{*}(w, v)=a(v, w) &=\int_{0}^{1}\left(v^{\prime}-v\right) w^{\prime} d x-(\beta+1) v(0) w(0) \\
&=-\int_{0}^{1} v\left(w^{\prime \prime}+w^{\prime}\right) d x+\left[v w^{\prime}\right]_{0}^{1}-(\beta+1) v(0) w(0) \\
&=\int_{0}^{1}\left(-w^{\prime \prime}-w^{\prime}\right) v d x-\left[w^{\prime}(0)+(\beta+1) w(0)\right] v(0)
\end{aligned}
$$

由于定义\ref{3.37}必须成立，我们将有

!!!!
A^{*} w=-w^{\prime \prime}-w^{\prime} \quad \text { in } \mathscr{D}^{\prime}(0,1)
$$

此外，由于$v(0)$是任意的，$w$将需要满足边界条件

!!!!
\left[w^{\prime}+(\beta+1) w\right](0)=0, \quad w(1)=0
$$

我们注意到，对偶问题的传输场与原始问题的传输场方向相反。此外，原始问题的同质Robin-Dirichlet边界条件\ref{3.39}对应于对偶问题的性质完全相同的条件。

对问题\ref{3.39}所说明的程序显然可以扩展到多维情况。在表$3.1$中，我们提供了一个带有边界条件的几个微分算子的列表，以及它们相应的带有相关边界条件的对偶算子。(关于表中出现的函数，假定所考虑的微分算子的所有必要的规律性都是定义良好的。) 我们特别注意到，给定类型的原始条件不一定对应相同类型的对偶条件，对于非self-adjoint的算子，原始问题的保守（或非保守）表述对应于对偶问题的非保守（或保守）表述。

![](https://cdn.mathpix.com/snip/images/jBHGnBv8j0rw1vKhUjTc6jlSUU7YyOIJye7qFbZlKgo.original.fullsize.png)

\subsubsection{The nonlinear case}

将上一节的分析扩展到非线性情况并不那么直接。为简单起见，我们考虑一维问题

!!!!
\left\{\begin{array}{l}
A(v) v=-v^{\prime \prime}+v v^{\prime}=f, \quad x \in I=(0,1) \\
v(0)=v(1)=0
\end{array}\right.
\label{3.44}\end{equation}



用$A(v)$表示的运算符

!!!!
A(v) \cdot=-\frac{d^{2}}{d x^{2}}+v \frac{d}{d x}
$$

拉格朗日特性\ref{3.38}现在被概括为

!!!!
{ }_{V^{\prime}}\langle A(v) u, w\rangle_{V}={ }_{V}\left\langle u, A^{*}(v) w\right\rangle_{V^{\prime}}
\label{3.46}\end{equation}

对于每个 $u \in D(A)$和$w \in D\left(A^{*}\right), D(A)$ 是 $A$ 的域，即在$x=0$和$x=1$处为空的 $C^{2}$ 类函数的集合，而 $D\left(A^{*}\right)$是对偶算子 $A^{*}$ 的域，其属性将通过施加\ref{3.46}来确定。从这样的特性出发，让我们看看对于问题\ref{3.44}，我们可以得到哪一个对偶算子$A^{*}$和哪一个对偶边界条件。通过对扩散项进行两次积分，对一阶的传输项进行一次积分，我们可以得到

!!!!
\begin{aligned}
{ }_{V^{\prime}}\langle A(v) u, w\rangle_{V} &=-\int_{0}^{1} u^{\prime \prime} w d x+\int_{0}^{1} v u^{\prime} w d x \\
&=\int_{0}^{1} u^{\prime} w^{\prime} d x-\left.u^{\prime} w\right|_{0} ^{1}-\int_{0}^{1}(v w)^{\prime} u d x+\left.v u w\right|_{0} ^{1} \\
&=-\int_{0}^{1} u w^{\prime \prime} d x+\left.u w^{\prime}\right|_{0} ^{1}-\left.u^{\prime} w\right|_{0} ^{1}-\int_{0}^{1}(v w)^{\prime} u d x+\left.v u w\right|_{0} ^{1} .
\end{aligned}
\label{3.47}\end{equation}

让我们分别分析边界项，使两个端点的贡献明确。为了保证\ref{3.46}，我们必须有

$u(1) w^{\prime}(1)-u(0) w^{\prime}(0)-u^{\prime}(1) w(1)+u^{\prime}(0) w(0)+v(1) u(1) w(1)-v(0) u(0) w(0)=0

对于每个$u$和$v \in D(A)$。我们注意到，$u$属于$D(A)$这一事实允许我们忽略前两个和的消失，因此我们最终会有

!!!!
-u^{\prime}(1) w(1)+u^{\prime}(0) w(0)=0
$$

由于这种关系对每个$u \in D(A)$都必须成立，我们必须为对偶算子选择同质的Dirichlet条件，即

!!!!
w(0)=w(1)=0
\label{3.48}\end{equation}

回归到\ref{3.47}，我们就可以得到

!!!!
\begin{aligned}
{ }_{V^{\prime}}\langle A(v) u, w\rangle_{V} &=-\int_{0}^{1} u^{\prime \prime} w d x+\int_{0}^{1} v u^{\prime} w d x \\
&=-\int_{0}^{1} u w^{\prime \prime} d x-\int_{0}^{1}(v w)^{\prime} u d x={ }_{V}\left\langle u, A^{*}(v) w\right\rangle_{V^{\prime}}
\end{aligned}
\label{3.49}\end{equation}

因此，\ref{3.49}中定义的原始算子$A^{*}$的对偶算子$A$读作

!!!!
A^{*}(v) \cdot=-\frac{d^{2} \cdot}{d x^{2}}+\frac{d}{d x} v
$$

而对偶边界条件由\ref{3.48}提供。最后，我们注意到对偶问题总是线性的，尽管我们是从一个非线性的原始问题开始的。

关于微分和对偶问题分析的更多细节，我们请读者参考，例如， [Mar95] 。

\subsection{Exercises}

1.证明如果双线性形式是coercive的和对称的，弱问题\ref{3.35}等同于变异问题\ref{3.36}。

[解：让$u \in V$是弱问题的解，让$w$是$V$的一个一般元素。由于双线性和形式的对称性，我们发现

!!!!
\begin{aligned}
J(u+w) &=\frac{1}{2}[a(u, u)+2 a(u, w)+a(w, w)]-[F(u)+F(w)] \\
&=J(u)+[a(u, w)-F(w)]+\frac{1}{2} a(w, w)=J(u)+{ }_{2} a(w, w) .
\end{aligned}
$$

由于矫捷性，我们得到$J(u+w) \geq J(u)+(\alpha / 2)\|w\|_{V}^{2}$ ，即$\forall v \in V$ 与$v=u, J(v)>J(u)$ 。反之，如果$u$是$J$的最小值，那么通过写极值条件$\lim _{\delta \rightarrow 0}(J(u+\delta v)-J(u)) / \delta=0$，我们可以发现\ref{3.35}。

2.证明在文中列出的关于系数的假设下，双线性形式\ref{3.36}是连续的和coercive的。

[解：双线性形式显然是连续的。由于假设\ref{3.34}和$\sigma \in \mathrm{L}^{\infty}(\Omega)$在$\Omega$中是正的这一事实，它也是coercive的，因为

!!!!
a(v, v) \geq \alpha|v|_{\mathrm{H}^{1}(\Omega)}^{2}+\alpha_{0}\|v\|_{\mathrm{L}^{2}(\Omega)}^{2} \geq \min \left(\alpha, \alpha_{0}\right)\|v\|_{V}^{2} \quad \forall v \in V
$$

我们指出，如果$V=\mathrm{H}^{1}(\Omega)$，那么条件$\alpha_{0}>0$对于双线性形式是强制性的。在$V=\mathrm{H}_{0}^{1}(\Omega)$的情况下，只要$\alpha_{0}>-\alpha / C_{\Omega}^{2}, C_{\Omega}$是介入Poincaré不等式的常数$(\mathrm{see}$ \ref{2.13}）。在这种情况下，$\|\cdot\|_{\mathrm{H}^{1}(\Omega)}$和$|\cdot|_{\mathrm{H}^{1}(\Omega)}$之间的等价关系确实可以被利用。见第二章的性质$2.5$]。

3.设$V=\mathrm{H}_{0}^{1}(0,1)$ ，并取$a: V \times V \rightarrow \mathbb{R}$和$F: V \rightarrow \mathbb{R}$以下述方式定义。

!!!!
F(v)=\int_{0}^{1}(-1-4 x) v(x) d x, \quad a(u, v)=\int_{0}^{1}(1+x) u^{\prime}(x) v^{\prime}(x) d x
$$

证明问题：找到$u \in V$，使$a(u, v)=F(v) \forall v \in V$，承认有一个唯一的解决方案。此外，验证该解与$u(x)=x^{2}-x$相吻合。

[解：可以很容易地证明，双线性形式在$V$中是连续的和coercive的。然后，由于$F$是一个线性连续函数，根据Lax-Milgram定理，我们可以得出结论，在$V$存在一个唯一的解决方案。我们验证后者确实是$u(x)=x^{2}-x$。后者的函数肯定属于$V$（因为它是连续的和可微的，并且这样的$u(0)=u(1)=0$）。此外，从关系上看

!!!!
\int_{0}^{1}(1+x) u^{\prime}(x) v^{\prime}(x) d x=-\int_{0}^{1}\left((1+x) u^{\prime}(x)\right)^{\prime} v(x) d x=\int_{0}^{1}(-1-4 x) v(x) d x
$$

有效的$\forall v \in V$，我们推断，为了使$u$成为一个解决方案，我们必须在$(0,1)$的几乎所有地方有$((1+x) u^{\prime}(x))^{\prime}=1+4 x$ 。这样的属性对提议的u也是成立的。

4.找到问题的弱表述

!!!!
\begin{cases}\Delta^{2} u=f & \text { in } \Omega \\ u=0 & \text { on } \partial \Omega \\ \frac{\partial u}{\partial n}=0 & \text { on } \partial \Omega\end{cases}
$$

$\Omega \subset \mathbb{R}^{2}$是一个有界的开放集，有规则的边界$\partial \Omega, \Delta^{2} \cdot=\Delta \Delta \cdot$是$b i-$拉普拉斯算子和$f \in \mathrm{L}^{2}(\Omega)$一个分配函数。

[解：通过对双拉子算子两次应用格林公式得到的弱表述是

!!!!
\text { find } u \in \mathrm{H}_{0}^{2}(\Omega): \int_{\Omega} \Delta u \Delta v d \Omega=\int_{\Omega} f v d \Omega \quad \forall v \in \mathrm{H}_{0}^{2}(\Omega) \text {, }
$$

其中$\mathrm{H}_{0}^{2}(\Omega)=\left\{v \in \mathrm{H}^{2}(\Omega): v=0, \partial v / \partial n=0\right.$对$\left.\partial \Omega\right\}$.

对于练习四中定义的希尔伯特空间$\mathrm{H}_{0}^{2}(\Omega)$的每个函数$v$，可以证明定义为$|v|_{\mathrm{H}^{2}(\Omega)}=\left(\int_{\Omega}|\Delta v|^{2} d \Omega\right)^{1 / 2}$的半规范$|\cdot|_{\mathrm{H}^{2}(\Omega)}$实际上等同于规范$\|\cdot\|_{\mathrm{H}^{2}(\Omega)}$ 。利用这种性质，证明问题(3.50)有唯一的解。

[解决方案：让我们设定$V=\mathrm{H}_{0}^{2}(\Omega)$ 。那么

!!!!
a(u, v)=\int_{\Omega} \Delta u \Delta v d \Omega \quad \text { and } F(v)=\int_{\Omega} f v d \Omega
$$

分别是来自$V \times V \rightarrow \mathbb{R}$的一个双线性形式和一个线性连续函数。为了证明存在性和唯一性，只需援引Lax-Milgram法则，因为双线性形式是强制性的和连续的。事实上，由于规范和半规范之间的等价关系，存在两个正常数$\alpha$和$M$，使得

!!!!
\left.a(u, u)=|u|_{V}^{2} \geq \alpha\|u\|_{V}^{2}, \quad|a(u, v)| \leq M\|u\|_{V}\|v\|_{V} \cdot\right]
$$

6.写出四阶问题的弱表述

!!!!
\begin{cases}-\operatorname{div}(\mu \nabla u)+\Delta^{2} u+\sigma u=0 & \text { in } \Omega \\ u=0 & \text { on } \partial \Omega \\ \partial u \\ \partial n & \text { on } \partial \Omega\end{cases}
$$

通过引入适当的函数空间，知道$\Omega \subset \mathbb{R}^{2}$是一个有边界的开放集，有规则的边界$\partial \Omega$，$\mu(\mathbf{x})$和$\sigma(\mathbf{x})$是定义在$\Omega$的已知函数。

[解：与前面两个练习一样，假设系数$\mu$和$\sigma$位于$\left.\mathrm{L}^{\infty}(\Omega) .\right]$中。

7.设$\Omega \subset \mathbb{R}^{2}$是一个具有光滑边界的域$\partial \Omega=\Gamma_{D} \cup \Gamma_{N}$和$\stackrel{\circ}{\Gamma}_{D} \cap \stackrel{\circ}{\Gamma}_{N}=\emptyset$ 。通过引入适当的函数空间，找到以下线性弹性问题的弱表述

!!!!
\begin{cases}-\sum_{j=1}^{2} \frac{\partial}{\partial x_{j}} \sigma_{i j}(\mathbf{u})=f_{i} \quad \text { in } \Omega, \quad i=1,2 \\ u_{i}=0 & \text { on } \Gamma_{D}, \quad i=1,2 \\ \sum_{j=1}^{2} \sigma_{i j}(\mathbf{u}) n_{j}=g_{i} \quad & \text { on } \Gamma_{N}, \quad i=1,2\end{cases}
\label{3.51}\end{equation}

像往常一样，用$\mathbf{n}=\left(n_{1}, n_{2}\right)^{T}$表示对$\partial \Omega$的外向单位法向量，用$\mathbf{u}=\left(u_{1}, u_{2}\right)^{T}$表示未知向量，用$\mathbf{f}=\left(f_{1}, f_{2}\right)^{T}$和$\mathbf{g}=\left(g_{1}, g_{2}\right)^{T}$表示两个指定向量函数。此外，它已被设定为$i, j=1,2$ 。

!!!!
\sigma_{i j}(\mathbf{u})=\lambda \operatorname{div}(\mathbf{u}) \delta_{i j}+2 \mu \varepsilon_{i j}(\mathbf{u}), \quad \varepsilon_{i j}(\mathbf{u})=\frac{1}{2}\left(\frac{\partial u_{i}}{\partial x_{j}}+\frac{\partial u_{j}}{\partial x_{i}}\right)
$$

$\lambda$和$\mu$是两个正常数，$\delta_{i j}$是克罗内克符号。系统\ref{3.51}允许描述一个同质和各向同性的弹性体的位移$\mathbf{u}$，在密度为$\mathbf{f}$的外力和分布在$\Gamma_{N}$上强度为$\mathbf{g}$的表面电荷的作用下，该弹性体在其平衡位置上占据$\Omega$区域（见图3.4）。

[解：通过观察$\sigma_{i j}=\sigma_{j i}$和使用以下格林公式，可以找到\ref{3.51}的弱表述

!!!!
\begin{aligned}
\sum_{i, j=1}^{2} \int_{\Omega} \sigma_{i j}(\mathbf{u}) \varepsilon_{i j}(\mathbf{v}) d \Omega &=\sum_{i, j=1}^{2} \int_{\partial \Omega} \sigma_{i j}(\mathbf{u}) n_{j} v_{i} d \gamma \\
&-\sum_{i, j=1}^{2} \int_{\Omega} \frac{\partial \sigma_{i j}(\mathbf{u})}{\partial x_{j}} v_{i} d \Omega
\end{aligned}
$$



![](https://cdn.mathpix.com/cropped/10058ab4e7f0c5bd6fe5bcd4db204623-062.jpg?height=204&width=310&top_left_y=164&top_left_x=300)

图3.4.一个受到外部电荷作用的部分约束的物体

假设$\mathbf{v} \in V=\left(\mathrm{H}_{\Gamma_{D}}^{1}(\Omega)\right)^{2}$（对$i=1,2$有分量$v_{i} \in \mathrm{H}_{\Gamma_{D}}^{1}(\Omega)$的向量函数空间），弱表述为

!!!!
\text { find } \mathbf{u} \in V \text { such that } a(\mathbf{u}, \mathbf{v})=F(\mathbf{v}) \forall \mathbf{v} \in V,
\label{3.52}\end{equation}


与

!!!!
\begin{gathered}
a(\mathbf{u}, \mathbf{v})=\int_{\Omega} \lambda \operatorname{div}(\mathbf{u}) \operatorname{div}(\mathbf{v}) d \Omega+2 \mu \sum_{i, j=1}^{2} \int \varepsilon_{i j}(\mathbf{u}) \varepsilon_{i j}(\mathbf{v}) d \Omega \\
F(\mathbf{v})=\int_{\Omega} \mathbf{f} \cdot \mathbf{v} d \Omega+\int_{\Gamma_{N}} \mathbf{g} \cdot \mathbf{v} d \gamma
\end{gathered}
$$

为了使积分有意义，只要要求$\mathbf{f} \in\left(\mathrm{L}^{2}(\Omega)\right)^{2}$和$\left.\mathbf{g} \in\left(\mathrm{L}^{2}\left(\Gamma_{N}\right)\right)^{2} .\right]$就够了。

8.通过应用Lax-Milgram定理，证明弱式\ref{3.52}的解存在，并且在数据的规律性的适当条件下是唯一的，并知道以下Korn不等式成立。

!!!!
\exists C_{0}>0: \sum_{i, j=1}^{2} \int_{\Omega} \varepsilon_{i j}(\mathbf{v}) \varepsilon_{i j}(\mathbf{v}) d \Omega \geq C_{0}\|\mathbf{v}\|_{V}^{2} \quad \forall \mathbf{v} \in V
$$

[解：考虑前面练习的解中所介绍的弱式。\ref{3.52}中定义的双线性形式是连续的，并且由于科恩不等式也是强制性的。  $F$是一个线性和连续的函数；因此，根据Lax-Milgram定理，解决方案存在并且是唯一的。]

\section{The Galerkin finite element method for elliptic problems}

在这一章中，我们通过介绍Galerkin方法来描述上一章中考虑的椭圆边界值问题的数值解法。然后，我们将有限元方法作为一个特殊案例进行说明。后者将在后面的章节中进一步发展。

\subsection{Approximation via the Galerkin method}


正如在第$3.2$章中所看到的，在域$\Omega \subset \mathbb{R}^{d}, d=1,2,3$上的通用椭圆问题集的弱表述，可以写成以下方式

!!!!
\text { find } u \in V: \quad a(u, v)=F(v) \quad \forall v \in V,
\label{4.1}\end{equation}

$V$是一个适当的希尔伯特空间，$\mathrm{H}^{1}(\Omega), a(\cdot, \cdot)$的子空间是来自$V \times V$的连续和coercive的双线性形式，$\mathbb{R}, F(\cdot)$是来自$V$的连续线性函数。在这样的假设下，$3.4 .1$节的Lax-Milgram Lemma保证了解的存在性和唯一性。

设$V_{h}$是一个空间族，它取决于一个正参数$h$，从而

!!!!
V_{h} \subset V, \quad \operatorname{dim} V_{h}=N_{h}<\infty \quad \forall h>0
$$

该近似问题的形式为

!!!!
\text { find } u_{h} \in V_{h}: \quad a\left(u_{h}, v_{h}\right)=F\left(v_{h}\right) \quad \forall v_{h} \in V_{h}
\label{4.2}\end{equation}

并被称为Galerkin问题。用$\left\{\varphi_{j}, j=1,2, \ldots, N_{h}\right\}$表示$V_{h}$的一个基，只要\ref{4.2}对该基的每个函数进行验证即可，因为空间$V_{h}$中的所有函数都是$\varphi_{j}$ 的线性组合。然后我们将要求

!!!!
a\left(u_{h}, \varphi_{i}\right)=F\left(\varphi_{i}\right), \quad i=1,2, \ldots, N_{h}
\label{4.3}\end{equation}

很明显，由于$u_{h} \in V_{h}$,

!!!!
u_{h}(\mathbf{x})=\sum_{j=1}^{N_{h}} u_{j} \varphi_{j}(\mathbf{x})
$$

其中$u_{j}, j=1, \ldots, N_{h}$，是未知系数。然后方程\ref{4.3}变为

!!!!
\sum_{j=1}^{N_{h}} u_{j} a\left(\varphi_{j}, \varphi_{i}\right)=F\left(\varphi_{i}\right), \quad i=1,2, \ldots, N_{h}
\label{4.4}\end{equation}

我们用A表示矩阵（称为刚度矩阵），其元素为

!!!!
a_{i j}=a\left(\varphi_{j}, \varphi_{i}\right)
$$

并用$\mathbf{f}$表示有分量$f_{i}=F\left(\varphi_{i}\right)$的向量。如果我们用$\mathbf{u}$表示具有未知系数的分量的向量$u_{j}$ ,\ref{4.4}则相当于线性系统

!!!!
\mathrm{A} \mathbf{u}=\mathbf{f}
\label{4.5}\end{equation}

我们指出了刚度矩阵的一些特征，这些特征与为$V_{h}$选择的基础无关，但完全取决于被逼近的弱问题的属性。而其他特性，如条件数或稀疏性结构，则取决于所研究的基，因此在专门讨论具体数值方法的章节中讨论。例如，由小支持度的函数形成的基是有吸引力的，因为其指数与支持度为空交点的基函数相关的所有元素$a_{i j}$将是空的。更一般地说，从计算的角度来看，$V_{h}$的最方便的选择将是那些需要适度计算的矩阵元素以及源项$\mathbf{f}$。

定理4.1.与的Galerkin离散化相关的椭圆问题，其双线性形式是coercive性的，矩阵A是正定的。

证明。我们回顾一下，如果一个矩阵$\mathrm{B} \in \mathbb{R}^{n \times n}$被认为是正定的，如果

!!!!
\mathbf{v}^{T} \mathrm{~B} \mathbf{v} \geq 0 \quad \forall \mathbf{v} \in \mathbb{R}^{n} \quad \text { and also } \mathbf{v}^{T} \mathrm{~B} \mathbf{v}=0 \Leftrightarrow \mathbf{v}=\mathbf{0}
\label{4.6}\end{equation}

函件

!!!!
\mathbf{v}=\left(v_{i}\right) \in \mathbb{R}^{N_{h}} \leftrightarrow \quad v_{h}(x)=\sum_{j=1}^{N_{h}} v_{j} \phi_{j} \in V_{h}
\label{4.7}\end{equation}

定义了空间$\mathbb{R}^{N_{h}}$和$V_{h}$之间的双射。给出$\mathbb{R}^{N_{h}}$的一般向量$\mathbf{v}=\left(v_{i}\right)$，由于形式$a(\cdot, \cdot)$的双线性和矫捷性，我们得到

!!!!
\begin{aligned}
\mathbf{v}^{T} \mathrm{~A} \mathbf{v} &=\sum_{j=1}^{N_{h}} \sum_{i=1}^{N_{h}} v_{i} a_{i j} v_{j}=\sum_{j=1}^{N_{h}} \sum_{i=1}^{N_{h}} v_{i} a\left(\varphi_{j}, \varphi_{i}\right) v_{j} \\
&=\sum_{j=1}^{N_{h}} \sum_{i=1}^{N_{h}} a\left(v_{j} \varphi_{j}, v_{i} \varphi_{i}\right)=a\left(\sum_{j=1}^{N_{h}} v_{j} \varphi_{j}, \sum_{i=1}^{N_{h}} v_{i} \varphi_{i}\right) \\
&=a\left(v_{h}, v_{h}\right) \geq \alpha\left\|v_{h}\right\|_{V}^{2} \geq 0
\end{aligned}
$$

此外，如果$\mathbf{v}^{T} \mathrm{~A} \mathbf{v}=0$，那么根据我们刚刚得到的，$\left\|v_{h}\right\|_{V}^{2}=0$也是如此，即$v_{h}=0$，所以$\mathbf{v}=\mathbf{0}$。因此，由于\ref{4.6}中的两个条件得到满足，该主张得到了证明。

此外，可以证明以下属性（见练习4）。

Property 4.1. The matrix A is symmetric if and only if the bilinear form $a(\cdot, \cdot)$ is symmetric.

例如，在具有Dirichlet\ref{3.18}或混合\ref{3.27}边界条件的泊松问题中，矩阵$\mathrm{A}$是对称和正定的。这样一个系统的数值解可以用直接方法（如Cholesky factorization）和迭代方法（如共轭梯度法）有效地进行（见第7章和例如[QSS07，第4章]）。

\subsection{Analysis of the Galerkin method}

在本节中，我们旨在研究Galerkin方法，特别是验证其三个基本属性。

- 离散解的存在性和唯一性 $u_{h}$ 。

- 离散解的稳定性 $u_{h}$ 。

- $u_{h}$到问题\ref{4.1}的精确解$u$的收敛性，如$h \rightarrow 0$ 。

\subsubsection{Existence and uniqueness}

第3.4.1节所述的Lax-Milgram定理对任何希尔伯特空间都是成立的，因此对空间$V_{h}$尤其如此，因为后者是希尔伯特空间的封闭子空间。3.4.1节所述的Lax-Milgram定理对任何希尔伯特空间都成立，因此特别适用于空间$V_{h}$，因为后者是希尔伯特空间$V$的一个封闭子空间。此外，双线性形式$a(\cdot, \cdot)$和函数$F(\cdot)$与变分问题\ref{4.1}中相同。因此，该定理所要求的假设得到了满足。下面的结果随之而来。

![](https://cdn.mathpix.com/cropped/10058ab4e7f0c5bd6fe5bcd4db204623-066.jpg?height=63&width=702&top_left_y=119&top_left_x=107)

不过，在不使用Lax-Milgram推论的情况下，提供这个推论的建设性证明还是很有启发的。正如我们所看到的，事实上，Galerkin问题\ref{4.2}等同于线性系统\ref{4.5}。证明一个问题的存在性和唯一性意味着自动证明另一个问题的存在性和唯一性。因此，我们的注意力集中在线性系统\ref{4.5}上。

矩阵$\mathrm{A}$是可逆的，因为系统$\mathrm{A} \mathbf{u}=\mathbf{0}$的唯一解是相同的空解。这马上就从$\mathrm{A}$是正定的这一事实引出。因此，线性系统\ref{4.5}有一个唯一的解，因此其相应的Galerkin问题也有一个唯一的解。

\subsubsection{Stability}

推论$3.1$使我们能够提供以下稳定性结果。

![](https://cdn.mathpix.com/cropped/10058ab4e7f0c5bd6fe5bcd4db204623-066.jpg?height=165&width=720&top_left_y=566&top_left_x=95)

该方法的稳定性保证了离散解的$\operatorname{norm}\left\|u_{h}\right\|_{V}$在$h$趋于零的情况下保持有界，均匀地与$h$有关。等价地，它保证$\left\|u_{h}-w_{h}\right\|_{V} \leq \frac{1}{\alpha}\|F-G\|_{V^{\prime}}, u_{h}$和$w_{h}$是对应于两个不同数据$F$和$G$的数字解。

\subsubsection{Convergence}

我们现在要证明，当$h$趋于零时，Galerkin问题的弱解收敛于弱问题\ref{4.1}的解。因此，通过取一个足够小的$h$，将有可能通过Galerkin解$u_{h}$如愿以偿地近似精确解$u$。

让我们首先证明以下一致性属性。

![](https://cdn.mathpix.com/cropped/10058ab4e7f0c5bd6fe5bcd4db204623-066.jpg?height=129&width=722&top_left_y=1095&top_left_x=97)

!!!!
a\left(u-u_{h}, v_{h}\right)=0 \quad \forall v_{h} \in V_{h}
\label{4.8}\end{equation}



![](https://cdn.mathpix.com/cropped/10058ab4e7f0c5bd6fe5bcd4db204623-067.jpg?height=251&width=366&top_left_y=112&top_left_x=272)

图4.1.Galerkin正交性的几何解释

证明。由于$V_{h} \subset V$，精确解$u$对每个元素$v=v_{h} \in V_{h}$都满足弱问题\ref{4.1}，因此我们有

!!!!
a\left(u, v_{h}\right)=F\left(v_{h}\right) \quad \forall v_{h} \in V_{h} .
\label{4.9}\end{equation}

从\ref{4.9}中并列减去\ref{4.2}，我们可以得到

!!!!
a\left(u, v_{h}\right)-a\left(u_{h}, v_{h}\right)=0 \quad \forall v_{h} \in V_{h},
$$

由于形式的双线性$a(\cdot, \cdot)$，要求由此而来。

让我们指出，\ref{4.9} 与 \ref{4.10} 中给出的强一致性定义相吻合。

如果$a(\cdot, \cdot)$是对称的，\ref{4.8} 被解释为关于标量积$a(\cdot, \cdot)$的正交条件，即近似误差$u-u_{h}$和子空间$V_{h}$之间的关系。借用欧几里得的术语，Galerkin方法的解$u_{h}$被认为是精确解$u$在$V_{h}$上的正交投影。在$V_{h}, v_{h}$的所有元素中，与精确解$u$的距离最小的是能量准则，即由标量积$a(\cdot, \cdot)$引起的下列准则。

!!!!
\left\|u-u_{h}\right\|_{a}=\sqrt{a\left(u-u_{h}, u-u_{h}\right)}
$$

备注4.1.Galerkin方法的几何解释只有在形式$a(\cdot, \cdot)$是对称的情况下才有意义。然而，在双线性形式不对称的情况下，这并不影响该方法的通用性或其一致性属性。

现在让我们考虑当双线性形式的两个参数都等于$u-u_{h}$时的取值。如果$v_{h}$是$V_{h}$的一个任意元素，我们得到


!!!!
a\left(u-u_{h}, u-u_{h}\right)=a\left(u-u_{h}, u-v_{h}\right)+a\left(u-u_{h}, v_{h}-u_{h}\right)
$$

根据\ref{4.8}，最后一项为空，因为$v_{h}-u_{h} \in V_{h}$。此外

!!!!
\left|a\left(u-u_{h}, u-v_{h}\right)\right| \leq M\left\|u-u_{h}\right\|_{V}\left\|u-v_{h}\right\|_{V}
$$

已经利用了双线性形式的连续性。另一方面，根据$a(\cdot, \cdot)$的矫捷性，可以看出

!!!!
a\left(u-u_{h}, u-u_{h}\right) \geq \alpha\left\|u-u_{h}\right\|_{V}^{2}
$$

因此，我们有

!!!!
\left\|u-u_{h}\right\|_{V} \leq \frac{M}{\alpha}\left\|u-v_{h}\right\|_{V} \quad \forall v_{h} \in V_{h} .
\label{4.10}\end{equation}

这种不等式对所有的函数$v_{h} \in V_{h}$都成立，因此我们发现

!!!!
\left\|u-u_{h}\right\|_{V} \leq \frac{M}{\alpha} \inf _{w_{h} \in V_{h}}\left\|u-w_{h}\right\|_{V}
\label{4.11}\end{equation}

Galerkin方法的这一基本属性被称为Céa Lemma。

那么很明显，为了使方法收敛，只要要求对于$h$趋于零，空间$V_{h}$趋于饱和整个空间$V$即可。准确地说，它必须变成

!!!!
\lim _{h \rightarrow 0} \inf _{v_{h} \in V_{h}}\left\|v-v_{h}\right\|_{V}=0 \quad \forall v \in V
$$

在这种情况下，Galerkin方法是收敛的，可以写为

!!!!
\lim _{h \rightarrow 0}\left\|u-u_{h}\right\|_{V}=0
$$

因此，空间$V_{h}$必须被仔细选择，以保证饱和特性\ref{4.11}。一旦这一要求得到满足，收敛性在任何情况下都将得到验证，与$u$的外观无关；反之，离散解收敛到精确解的速度，即相对于$h$的误差衰减顺序，一般来说将取决于$V_{h}$的选择和$u$的规则性（见定理4.3）。

备注4.2。很明显，$\inf _{v_{h} \in V_{h}}\left\|u-v_{h}\right\|_{V} \leq\left\|u-u_{h}\right\|_{V}$ 。因此，根据\ref{4.10}，如果$\frac{M}{\alpha}$的阶数为1，由于Galerkin方法引起的误差可以与$V_{h}$中$u$的最佳近似误差相鉴别。在任何情况下，相对于$h$，两个误差都有相同的无穷小阶。

备注4.3。在$a(\cdot, \cdot)$是一个对称的双线性形式，同时也是连续的和coercive的情况下，那么\ref{4.10}可以改进如下（见练习5 )

!!!!
\left\|u-u_{h}\right\|_{V} \leq \sqrt{\frac{M}{\alpha}} \inf _{w_{h} \in V_{h}}\left\|u-w_{h}\right\|_{V}
\label{4.12}\end{equation}



\section{ $4.3$ 一维情况下的有限元方法}。

让我们假设$\Omega$是一个区间$(a, b)$ 。本节的目标是创建依赖于参数$h$的空间$\mathrm{H}^{\mathrm{l}}(a, b)$的近似值。为此，我们在$N+1$子区间$K_{j}=\left(x_{j-1}, x_{j}\right)$中引入了$\mathscr{T}_{h}$的分区，也称为元素，其宽度为$h_{j}=x_{j}-x_{j-1}$，有

!!!!
a=x_{0}<x_{1}<\ldots<x_{N}<x_{N+1}=b
\label{4.13}\end{equation}

并设置 $h=\max _{j} h_{j}$ 。

由于$\mathrm{H}^{1}(a, b)$的函数是$[a, b]$上的连续函数，我们可以构建以下空间族

!!!!
X_{h}^{r}=\left\{v_{h} \in C^{0}(\bar{\Omega}):\left.v_{h}\right|_{K_{j}} \in \mathbb{P}_{r} \forall K_{j} \in \mathscr{T}_{h}\right\}, \quad r=1,2, \ldots
\label{4.14}\end{equation}

用$\mathbb{P}_{r}$表示度数低于或等于$r$的变量$x$的多项式空间。空间$X_{h}^{r}$都是$\mathrm{H}^{1}(a, b)$的子空间，因为它们是由可微函数构成的，但最多只有有限的几个点（分区$\mathscr{T}_{h}$的顶点$x_{i}$）。它们代表了空间$V_{h}$的可能选择，只要边界条件被适当纳入。事实上，$X_{h}^{r}$的函数是局部（元素）多项式，这将使刚度矩阵易于计算。

我们现在必须为$\left\{\varphi_{i}\right\}$空间选择一个基础$X_{h}^{r}$。通过在第4.1节中暴露出来的情况，很方便的是，通用基函数$\varphi_{i}$的支持是非空的。通用基函数$\varphi_{i}$的支持只与基的其他函数的支持有非空的交集。这样一来，刚度矩阵的许多元素将是空的。同样方便的是，基是拉格朗日的：在这种情况下，通用函数$v_{h} \in X_{h}^{r}$在基本身的展开系数将是$v_{h}$在精心选择的点上的值，我们称之为节点，正如我们将看到的，它们通常构成$\mathscr{T}_{h}$顶点的超集。这并不妨碍使用非拉格朗日基，特别是在其分层版本中（正如我们将在后面看到的）。我们现在提供一些空间$X_{h}^{1}$和$X_{h}^{2}$的基数的例子。

\subsection{The space $X_{h}^{1}$ }。

这个空间是由$\mathscr{T}_{h}$的$(a, b)$分区上的连续和片状线性函数构成的，其形式为\ref{4.13}。由于只有一条直线可以通过两个不同的点，而且$X_{h}^{1}$的函数是连续的，这个空间的函数的自由度，即为唯一地定义函数本身而必须分配的值，将等于分区的顶点数量$N+2$。因此，在这种情况下，节点和顶点是重合的。因此，在分配了$N+2$基础函数$\varphi_{i}, i=0, \ldots, N+1$之后，整个空间$X_{h}^{1}$将被完全定义。特征拉格朗日基函数的特点是以下属性

!!!!
\varphi_{i} \in X_{h}^{1} \quad \text { such that } \quad \varphi_{i}\left(x_{j}\right)=\delta_{i j}, \quad i, j=0,1, \ldots, N+1
$$

$\delta_{i j}$是克朗克三角洲。因此，函数$\varphi_{i}$是片状线性的，在$x_{i}$处等于1，在分区的其余节点处等于0（见图4.2）。其表达式为

![](https://cdn.mathpix.com/cropped/10058ab4e7f0c5bd6fe5bcd4db204623-070.jpg?height=198&width=386&top_left_y=111&top_left_x=279)

图4.2.与节点$x_{i}$相关的$X_{h}^{1}$的基函数

由以下公式给出。

!!!!
\varphi_{i}(x)= \begin{cases}\frac{x-x_{i-1}}{x_{i}-x_{i-1}} & \text { for } x_{i-1} \leq x \leq x_{i} \\ \frac{x_{i+1}-x}{x_{i+1}-x_{i}} & \text { for } x_{i} \leq x \leq x_{i+1} \\ 0 & \text { otherwise. }\end{cases}
\label{4.15}\end{equation}

显然，$\varphi_{i}$的支持是区间$\left[x_{i-1}, x_{i}\right]$和$\left[x_{i}, x_{i+1}\right]$的结合，如果$i \neq 0$或$i \neq N+1$（对于$i=0$或$i=N+1$，支持将分别限于区间$\left[x_{0}, x_{1}\right]$或$\left[x_{N}, x_{N+1}\right]$ ）。因此，支持度与$\varphi_{i}$重叠的基函数只有$\varphi_{i-1}$和$\varphi_{i+1}$（当然还有$\left.\varphi_{i}\right)$ 。因此，如果$j \notin\{i-1, i, i+1\}$，刚度矩阵是三对角的，$a_{i j}=0$ 。

如表达式\ref{4.15} 所示，定义在每个区间$\left[x_{i}, x_{i+1}\right]$上的两个基函数$\varphi_{i}$和$\varphi_{i+1}$基本上没有变化地重复自己，最多是一个与区间本身长度相关的缩放因子。在实践中，两个基函数$\varphi_{i}$和$\varphi_{i+1}$可以通过转换在参考区间（通常是$[0,1]$区间）上一次性建立的两个基函数$\widehat{\varphi}_{0}$和$\widehat{\varphi}_{1}$而得到。

为此，只需利用这样一个事实：$(a, b)$的分区的一般区间$\left[x_{i}, x_{i+1}\right]$可以从区间$[0,1]$开始通过线性变换$\phi:[0,1] \rightarrow\left[x_{i}, x_{i+1}\right]$得到，定义为

!!!!
x=\phi(\xi)=x_{i}+\xi\left(x_{i+1}-x_{i}\right)
\label{4.16}\end{equation}

如果我们在$\widehat{\varphi}_{0}$和$\widehat{\varphi}_{1}$上定义两个基函数$[0,1]$为

!!!!
\widehat{\varphi}_{0}(\xi)=1-\xi, \quad \widehat{\varphi}_{1}(\xi)=\xi
$$

在$\varphi_{i}$和$\varphi_{i+1}$上的基函数$\left[x_{i}, x_{i+1}\right]$将简单地被赋予

!!!!
\varphi_{i}(x)=\widehat{\varphi}_{0}(\xi(x)), \quad \varphi_{i+1}(x)=\widehat{\varphi}_{1}(\xi(x))
$$

自$\xi(x)=\left(x-x_{i}\right) /\left(x_{i+1}-x_{i}\right)$以来（见图4.3和4.4）。

在考虑多个维度的问题时，这种着手方式（在参考元素上定义基础，然后在特定元素上进行转换）将具有根本的重要性。

![](https://cdn.mathpix.com/cropped/10058ab4e7f0c5bd6fe5bcd4db204623-071.jpg?height=186&width=512&top_left_y=118&top_left_x=202)

图4.3.$\left[x_{i}, x_{i+1}\right]$中的基函数$\varphi_{i}$和参考元素上的相应基函数$\widehat{\varphi}_{0}$。
 ![](https://cdn.mathpix.com/cropped/10058ab4e7f0c5bd6fe5bcd4db204623-071.jpg?height=182&width=510&top_left_y=387&top_left_x=202)

图4.4.$\left[x_{i}, x_{i+1}\right]$中的基函数$\varphi_{i+1}$和参考元素上的相应基函数$\widehat{\varphi}_{1}$。

\subsection{The space $X_{h}^{2}$ }。

$X_{h}^{2}$的函数是$\mathscr{T}_{h}$每个区间上2度的片状多项式，因此，一旦它们在每个区间$K_{j}$的三个不同点上的取值被指定，它们就被确定了。为了保证$X_{h}^{2}$的函数的连续性，其中两个点将是$\mathscr{T}_{h}$的一般区间的端点，第三个点将是后者的中点。因此，空间$X_{h}^{2}$的自由度是在组成分区$\mathscr{T}_{h}$的区间的端点和它们的中点上取的$v_{h}$的值。我们对从$x_{0}=a$到$x_{2 N+2}=b ;$的节点进行排序，使中点对应于奇数指数的节点，端点对应于偶数指数的节点（关于其他编号，请参考练习6）。

与之前的情况完全一样，$X_{h}^{2}$的拉格朗日基础是由函数形成的

!!!!
\varphi_{i} \in X_{h}^{2} \quad \text { such that } \quad \varphi_{i}\left(x_{j}\right)=\delta_{i j}, \quad i, j=0,1, \ldots, 2 N+2
$$

因此，这些都是片状二次函数，在与之相关的节点处等于1，在其余节点处为空。下面是与分区中的区间端点相关的通用基础函数的明确表达。

!!!!
\varphi_{i}(x)= \begin{cases}\frac{\left(x-x_{i-1}\right)\left(x-x_{i-2}\right)}{\left(x_{i}-x_{i-1}\right)\left(x_{i}-x_{i-2}\right)} & \text { if } x_{i-2} \leq x \leq x_{i} \\ \frac{\left(x_{i+1}-x\right)\left(x_{i+2}-x\right)}{\left(x_{i+1}-x_{i}\right)\left(x_{i+2}-x_{i}\right)} & \text { if } x_{i} \leq x \leq x_{i+2} \\ 0 & \text { otherwise. }\end{cases}
$$

对于区间的中点，我们有

!!!!
(i \text { odd }) \quad \varphi_{i}(x)= \begin{cases}\frac{\left(x_{i+1}-x\right)\left(x-x_{i-1}\right)}{\left(x_{i+1}-x_{i}\right)\left(x_{i}-x_{i-1}\right)} & \text { if } x_{i-1} \leq x \leq x_{i+1} \\ 0 & \text { otherwise }\end{cases}
$$

例子见图$4.5$。

与线性有限元的情况一样，为了描述基，只需提供参考区间$[0,1]$上的基函数表达式，然后通过\ref{4.16}对后者进行转换。我们有

!!!!
\widehat{\varphi}_{0}(\xi)=(1-\xi)(1-2 \xi), \quad \widehat{\varphi}_{1}(\xi)=4(1-\xi) \xi, \quad \widehat{\varphi}_{2}(\xi)=\xi(2 \xi-1)
$$

我们在图4.5中表示这些函数。请注意，相对于节点$\varphi_{2 i+1}$的通用基函数$x_{2 i+1}$有一个支持，与中点所属的元素重合。由于其特殊的形式，它被称为气泡函数。

如前所述，我们还可以引入其他非拉格朗日基。一个特别有趣的是由三个函数构建的（局部）基数

!!!!
\widehat{\psi}_{0}(\xi)=1-\xi, \quad \widehat{\psi}_{1}(\xi)=\xi, \quad \widehat{\psi}_{2}(\xi)=(1-\xi) \xi
$$

这种基础被称为分层的，因为为了构建$X_{h}^{2}$的基础，它利用了低维空间$X_{h}^{1}$的基函数。从计算的角度来看，如果在问题的逼近过程中决定
 ![](https://cdn.mathpix.com/cropped/10058ab4e7f0c5bd6fe5bcd4db204623-072.jpg?height=210&width=712&top_left_y=966&top_left_x=99)

图4.5.$X_{h}^{2}$的基函数（在左边）和参考区间上的相应函数（在右边）只在局部增加，即只对这些元素增加插值的程度（即如果打算执行所谓的程度上的适应性，或$p$型的适应性）。

拉格朗日多项式在结构上是线性独立的。然而，在一般情况下，这样的属性必须得到验证，以确保所选多项式的集合是有效的基础。在函数$\widehat{\psi}_{0}, \widehat{\psi}_{1}$和$\widehat{\psi}_{2}$的情况下，我们必须验证以下几点

!!!!
\text { if } \alpha_{0} \widehat{\psi}_{0}(\xi)+\alpha_{1} \widehat{\psi}_{1}(\xi)+\alpha_{2} \widehat{\psi}_{2}(\xi)=0 \forall \xi, \quad \text { then } \quad \alpha_{0}=\alpha_{1}=\alpha_{2}=0
$$

事实上，该方程

!!!!
\alpha_{0} \widehat{\psi}_{0}(\xi)+\alpha_{1} \widehat{\psi}_{1}(\xi)+\alpha_{2} \widehat{\psi}_{2}(\xi)=\alpha_{0}+\xi\left(\alpha_{1}-\alpha_{0}+\alpha_{2}\right)-\alpha_{2} \xi^{2}=0
$$

意味着$\alpha_{0}=0, \alpha_{2}=0$，因此$\alpha_{1}=0$ 。我们注意到，在2度的有限元的情况下，刚度矩阵将是五边形的。

通过以同样的方式进行，将有可能生成具有任意正整数$r:$的$X_{h}^{r}$的基数。然而，我们指出，随着多项式度数的增加，自由度的数量增加，解线性系统\ref{4.5}的计算成本也会增加。此外，从多项式插值理论中得到的一个众所周知的事实是，使用高度数与等距节点分布相结合会导致越来越不稳定的近似，尽管理论上的精度会提高。谱元近似提供了一个成功的补救办法，使用精心选择的节点（来自高斯正交的节点），可以产生具有任意高精确度的近似。为此，见第10章。

\subsubsection{The approximation with linear finite elements}

我们现在研究如何对以下问题进行近似。

!!!!
\begin{cases}-u^{\prime \prime}+\sigma u=f, & a<x<b \\ u(a)=0, & u(b)=0\end{cases}
$$

正如我们在前一章中所看到的，其弱表述是

!!!!
\text { find } u \in \mathrm{H}_{0}^{1}(a, b): \int_{a}^{b} u^{\prime} v^{\prime} d x+\int_{a}^{b} \sigma u v d x=\int_{a}^{b} f v d x \quad \forall v \in \mathrm{H}_{0}^{1}(a, b)
$$

正如我们在\ref{4.13}中所做的那样，我们引入了$\mathscr{T}_{h}$的$(0,1)$在$N+1$子区间的分解，并使用线性有限元。因此，我们引入空间

!!!!
V_{h}=\left\{v_{h} \in X_{h}^{1}: v_{h}(a)=v_{h}(b)=0\right\}
\label{4.17}\end{equation}

即在边界消失的片状线性函数的空间（图4.6中已经介绍了这种空间的函数）。这是$\mathrm{H}_{0}^{1}(a, b)$的一个子空间。

![](https://cdn.mathpix.com/cropped/10058ab4e7f0c5bd6fe5bcd4db204623-074.jpg?height=222&width=485&top_left_y=113&top_left_x=211)

图4.6.$V_{h}$的函数实例

因此，相应的有限元问题由以下公式给出

!!!!
\text { find } u_{h} \in V_{h}: \int_{a}^{b} u_{h}^{\prime} v_{h}^{\prime} d x+\int_{a}^{b} \sigma u_{h} v_{h} d x=\int_{a}^{b} f v_{h} d x \quad \forall v_{h} \in V_{h}
\label{4.18}\end{equation}

我们用\ref{4.15}中定义的帽子函数集作为$X_{h}^{1}$的基础，只考虑指数$1 \leq i \leq N$。通过将$u_{h}$表示为这种函数$u_{h}(x)=\sum_{i=1}^{N} u_{i} \varphi_{i}(x)$的线性组合，并规定\ref{4.18}对$V_{h}$的基的每个元素都满足，我们得到一个$N$的方程系统

!!!!
\mathrm{A} \mathbf{u}=\mathbf{f}
\label{4.19}\end{equation}

其中

!!!!
\begin{aligned}
&\mathrm{A}=\left[a_{i j}\right], \quad a_{i j}=\int_{a}^{b} \varphi_{j}^{\prime} \varphi_{i}^{\prime} d x+\int_{a}^{b} \sigma \varphi_{j} \varphi_{i} d x ; \\
&\mathbf{u}=\left[u_{i}\right] ; \quad \mathbf{f}=\left[f_{i}\right], \quad f_{i}=\int_{a}^{b} f \varphi_{i} d x
\end{aligned}
$$

注意 $u_{i}=u_{h}\left(x_{i}\right), 1 \leq i \leq N$ ，即有限元的未知数是有限元解的节点值 $u_{h}$ 。

为了找到数值解$u_{h}$，现在只需解决线性系统\ref{4.19}。

在线性有限元的情况下，刚度矩阵$\mathrm{A}$不仅是稀疏的，而且结果是三对角的。为了计算其元素，我们进行如下操作。正如我们所看到的，没有必要直接对单个区间的基函数进行操作，而只需参考定义在参考区间上的基函数：然后就可以适当地转换出现在$\mathrm{A}$的系数定义中的积分。

硬度矩阵的一般非空元素由以下公式给出

!!!!
a_{i j}=\int_{a}^{b}\left(\varphi_{i}^{\prime} \varphi_{j}^{\prime}+\sigma \varphi_{i} \varphi_{j}\right) d x=\int_{x_{i-1}}^{x_{i}}\left(\varphi_{i}^{\prime} \varphi_{j}^{\prime}+\sigma \varphi_{i} \varphi_{j}\right) d x+\int_{x_{i}}^{x_{i+1}}\left(\varphi_{i}^{\prime} \varphi_{j}^{\prime}+\sigma \varphi_{i} \varphi_{j}\right) d x
$$

让我们通过假设$j=i-1$来考虑第一个和。显然，通过坐标变换\ref{4.16}，我们可以将其改写为

!!!!
\begin{aligned}
&\int_{x_{i-1}}^{x_{i}}\left(\varphi_{i}^{\prime} \varphi_{i-1}^{\prime}+\sigma \varphi_{i} \varphi_{i-1}\right) d x= \\
&\int_{0}^{1}\left[\varphi_{i}^{\prime}(x(\xi)) \varphi_{i-1}^{\prime}(x(\xi))+\sigma(x(\xi)) \varphi_{i}(x(\xi)) \varphi_{i-1}(x(\xi))\right] h_{i} d \xi
\end{aligned}
$$

已注意到$d x=d\left(x_{i-1}+\xi h_{i}\right)=h_{i} d \xi$.另一方面，$\varphi_{i}(x(\xi))=\widehat{\varphi}_{1}(\xi)$和$\varphi_{i-1}(x(\xi))=\widehat{\varphi}_{0}(\xi)$ 。我们还注意到

!!!!
\frac{d}{d x} \varphi_{i}(x(\xi))=\frac{d \xi}{d x} \widehat{\varphi}_{1}^{\prime}(\xi)=\frac{1}{h_{i}} \widehat{\varphi}_{1}^{\prime}(\xi)
$$

同样地，我们发现$\varphi_{i-1}^{\prime}(x(\xi))=\left(1 / h_{i}\right) \widehat{\varphi}_{0}^{\prime}(\xi)$ 。因此，元素$a_{i, i-1}$变为

!!!!
a_{i, i-1}=\int_{0}^{1}\left(\frac{1}{h_{i}} \widehat{\varphi}_{1}^{\prime}(\xi) \widehat{\varphi}_{0}^{\prime}(\xi)+\sigma \widehat{\varphi}_{1}(\xi) \widehat{\varphi}_{0}(\xi) h_{i}\right) d \xi
$$

这种表达方式的优点在于，在恒定系数的情况下，矩阵A中出现的所有积分都可以一劳永逸地计算出来。我们将在多维的情况下看到，这种方法在可变系数的情况下也保持其重要性。

\subsubsection{Interpolation operator and interpolation error}

让我们设定$I=(a, b)$。对于每个$v \in C^{0}(\bar{I})$，我们把$v$在$X_{h}^{1}$空间中的插值称为，由分区$\mathscr{T}_{h}$决定，函数$\Pi_{h}^{1} v$使

!!!!
\Pi_{h}^{1} v\left(x_{i}\right)=v\left(x_{i}\right) \quad \forall x_{i} \text { node of the partition, } i=0, \ldots, N+1
$$

通过使用空间$\left\{\varphi_{i}\right\}$的拉格朗日基础$X_{h}^{1}$，内插剂可以用以下方式表示

!!!!
\Pi_{h}^{1} v(x)=\sum_{i=0}^{N+1} v\left(x_{i}\right) \varphi_{i}(x)
$$

因此，当$v$和$X_{h}^{1}$的基础已知时，$v$的内插很容易计算。将函数$\Pi_{h}^{1}: C^{0}(\bar{I}) \mapsto X_{h}^{1}$映射到其内插值$\Pi_{h}^{1} v$的算子$\Pi_{h}^{1}: C^{0}(\bar{I}) \mapsto X_{h}^{1}$被称为内插算子。

类似地，我们可以定义运算符 $\Pi_{h}^{r}: C^{0}(\bar{I}) \mapsto X_{h}^{r}$ ，对于所有 $r \geq 1$ 。用$\Pi_{K_{j}}^{r}$表示局部插值算子，将函数$v$映射到多项式$\Pi_{K_{j}}^{r} v \in \mathbb{P}_{r}\left(K_{j}\right)$，在元素$r+1$的节点上插值$v$，我们定义$\Pi_{h}^{r} v$ 为

!!!!
\Pi_{h}^{r} v \in X_{h}^{r}:\left.\quad \Pi_{h}^{r} v\right|_{K_{j}}=\Pi_{K_{j}}^{r}\left(\left.v\right|_{K_{j}}\right) \quad \forall K_{j} \in \mathscr{T}_{h}
\label{4.20}\end{equation}

定理4.2。设$v \in \mathrm{H}^{r+1}(I)$，为$r \geq 1$，设$\Pi_{h}^{r} v \in X_{h}^{r}$为其插值的

!!!!
\begin{aligned}
&\left|v-\Pi_{h}^{r} v\right|_{\mathrm{H}^{k}(I)} \leq C_{k, r} h^{r+1-k}|v|_{\mathrm{H}^{r+1}(I)} \quad \text { for } k=0,1 \\
&\text { The constants } C_{k, r} \text { are independent of } v \text { and } h . \text { We recall that } \mathrm{H}^{0}(I)=\mathrm{L}^{2}(I) \text { and } \\
&\text { that }|\cdot|_{\mathrm{H}^{0}(I)}=\|\cdot\|_{\mathrm{L}^{2}(I)}
\end{aligned}
$$

证明。我们为$r=1$的情况证明\ref{4.21}，并为更一般的情况参考[QV94, Chap 3]或[Cia78]。我们首先观察到，如果$v \in H^{r+1}(I)$，那么$v \in C^{r}(I)$ 。特别是，对于$r=1, v \in C^{1}(I)$ .让我们设定$e=v-\Pi_{h}^{1} v$ 。由于$e\left(x_{j}\right)=0$ 对于每个节点$x_{j}$ ，罗尔定理允许得出结论，存在一些$\xi_{j} \in K_{j}=\left(x_{j-1}, x_{j}\right)$ ，与$j=1, \ldots, N+1$ ，对于这些节点我们有$e^{\prime}\left(\xi_{j}\right)=0$ 。

$\Pi_{h}^{1} v$是每个区间$K_{j}$中的线性函数，我们可以得到

!!!!
e^{\prime}(x)=\int_{\xi_{j}}^{x} e^{\prime \prime}(s) d s=\int_{\xi_{j}}^{x} v^{\prime \prime}(s) d s \quad \text { for } x \in K_{j}
$$

由此我们可以推导出

!!!!
\left|e^{\prime}(x)\right| \leq \int_{x_{j-1}}^{x_{j}}\left|v^{\prime \prime}(s)\right| d s \quad \text { for } x \in K_{j}
$$

现在，通过使用考奇-施瓦茨不等式，我们可以得到

!!!!
\left|e^{\prime}(x)\right| \leq\left(\int_{x_{j-1}}^{x_{j}} 1^{2} d s\right)^{1 / 2}\left(\int_{x_{j-1}}^{x_{j}}\left|v^{\prime \prime}(s)\right|^{2} d s\right)^{1 / 2} \leq h^{1 / 2}\left(\int_{x_{j-1}}^{x_{j}}\left|v^{\prime \prime}(s)\right|^{2} d s\right)^{1 / 2}
\label{4.22}\end{equation}

因此。

!!!!
\int_{x_{j-1}}^{x_{j}}\left|e^{\prime}(x)\right|^{2} d x \leq h^{2} \int_{x_{j-1}}^{x_{j}}\left|v^{\prime \prime}(s)\right|^{2} d s
\label{4.23}\end{equation}

注意到对于每个$e(x)$，可以得到$x \in K_{j}$的上界。

!!!!
e(x)=\int_{x_{j-1}}^{x} e^{\prime}(s) d s
$$

因此，通过应用不等式\ref{4.22}。

!!!!
|e(x)| \leq \int_{x_{j-1}}^{x_{j}}\left|e^{\prime}(s)\right| d s \leq h^{3 / 2}\left(\int_{x_{j-1}}^{x_{j}}\left|v^{\prime \prime}(s)\right|^{2} d s\right)^{1 / 2}
$$

因此。


!!!!
\int_{x_{j-1}}^{x_{j}}|e(x)|^{2} d x \leq h^{4} \int_{x_{j-1}}^{x_{j}}\left|v^{\prime \prime}(s)\right|^{2} d s
\label{4.24}\end{equation}

通过对\ref{4.23}和\ref{4.24}中从1到$N+1$的指数进行求和，我们得到不等式

!!!!
\left(\int_{a}^{b}\left|e^{\prime}(x)\right|^{2} d x\right)^{1 / 2} \leq h\left(\int_{a}^{b}\left|v^{\prime \prime}(x)\right|^{2} d x\right)^{1 / 2}
$$

和

!!!!
\left(\int_{a}^{b}|e(x)|^{2} d x\right)^{1 / 2} \leq h^{2}\left(\int_{a}^{b}\left|v^{\prime \prime}(x)\right|^{2} d x\right)^{1 / 2}
$$

分别对应于\ref{4.21}和$r=1$的期望估计值，其中$C_{k, 1}=1$和$k=0,1$。

\subsection{Estimate of finite element error in $\mathrm{H}^{1}$ norm}。

由于结果\ref{4.21}，我们可以得到有限元方法的近似误差的估计。

Theorem 4.3. Let $u \in V$ be the exact solution of the variational problem \ref{4.1} (in our case $\Omega=I=(a, b))$ and $u_{h}$ its approximate solution via the finite element method of degree $r$, i.e. the solution of problem \ref{4.2} where $V_{h}=X_{h}^{r} \cap V$. Moreover, let $u \in \mathrm{H}^{p+1}(I)$, for a suitable $p$ such that $r \leq p$. Then the following inequality, also called a priori error estimate, holds

!!!!
\left\|u-u_{h}\right\|_{V} \leq \frac{M}{\alpha} C h^{r}|u|_{\mathrm{H}^{r+1}(I)}
\label{4.25}\end{equation}

C being a constant independent of $u$ and $h$.


证明。从\ref{4.10}中，通过设置$w_{h}=\Pi_{h}^{r} u$，我们得到

!!!!
\left\|u-u_{h}\right\|_{V} \leq \frac{M}{\alpha}\left\|u-\Pi_{h}^{r} u\right\|_{V}
$$

现在可以通过插值误差估计\ref{4.21}对$k=1$的右手边进行约束，从这一点上看，主张是可以得到的。

从后一个定理可以看出，为了提高精度，可以采取两种不同的策略：减少$h$，即细化网格，或者增加$r$，即使用更高程度的有限元。然而，后一种策略只有在解$u$足够规则的情况下才有意义：事实上，从\ref{4.25}我们可以立即推断出，如果$u \in V \cap \mathrm{H}^{p+1}(I)$，$r$的最大值是$r=p$。高于$p$的值不能确保更好的收敛率：因此，如果解不是很规则，使用高阶有限元是不方便的，因为更大的计算成本不能通过改善收敛来补偿。一个有趣的情况是，当解只具有最小规则性时 $(p=0)$ 。从关系\ref{4.10}和\ref{4.11}中我们得到，无论如何都有收敛，但估计\ref{4.25}不再有效。那么就不可能说当$h$减少时，误差的规范$V$如何趋向于零。我们在表$4.1$中总结了这些情况。

表4.1.在不同的解的规则性和有限元的度数$r$下，有限元方法的收敛顺序相对于$h$。我们在每一栏中都强调了对应于多项式度数的 "最佳 "选择的结果。

\begin{tabular}{llcccc}。
\Hline $r$ & $u \in \mathrm{H}^{1}(I)$ & $u \in \mathrm{H}^{2}(I)$ & $u \in \mathrm{H}^{3}(I)$ & $u \in \mathrm{H}^{4}(I)$ & $u \in \mathrm{H}^{5}(I)$ Hline $r$ & $u \in \mathrm{H}^{1}(I)$ & $u \in \mathrm{H}^{2}(I)$ & $u \in \mathrm{H}^{3}(I)$ & $u \in \mathrm{H}^{4}(I)$ & $u \in \mathrm{H}^{5}(I)$。
\1 & converges & $h^{1}$ & $h^{1}$ & $h^{1}$ & $h^{1}$（1）。
2 & converges & $h^{1}$ & $h^{2}$ & $h^{2}$ & $h^{2}$ （2 & converges & $h^{1}$ & $h^{2}$ & $h^{2}$）。
3 & converges & $h^{1}$ & $h^{2}$ & $h^{3}$ & $h^{3}$ （4 & converges & $h^{1}$ & $h^{2}$）。
4 & converges & $h^{1}$ & $h^{2}$ & $h^{3}$ & $h^{4}$ （4个汇聚点）。
\hline
\end{tabular}

一般来说，我们可以说：如果$u \in \mathrm{H}^{p+1}(I)$，对于给定的$p>0$，那么存在一个独立于$u$和$h$的常数$C$，使得

!!!!
\left\|u-u_{h}\right\|_{\mathrm{H}^{1}(I)} \leq C h^{s}|u|_{\mathrm{H}^{s+1}(I)}, \quad s=\min \{r, p\}
\label{4.26}\end{equation}

\subsection{Finite elements, simplices and barycentric coordinates}

在介绍$2 \mathrm{D}$和$3 \mathrm{D}$领域的有限元空间之前，我们可以尝试提供一个有限元的正式定义。

\subsubsection{An abstract definition of finite element in the Lagrangian case}

从我们考虑的例子中，我们可以推断出，在一般情况下，即独立于维度的情况下，有三个成分可以用来描述有限元的特征。

- 元素的定义域$K$。在一维情况下，它是一个区间；在二维情况下，它一般是一个三角形，但也可以是一个四边形；在三维情况下，它可以是一个四面体、一个棱镜或一个六面体。

- 一个定义在$K$上的维数$\Pi_{r}$的多项式空间和$\Pi_{r}$的基数$\left\{\varphi_{j}\right\}_{j=1}^{N_{r}}$。在单维情况下，$\Pi_{r}$已在第1节中介绍。  $4.3$ 和 $N_{r}=r+1$ 。对于多维的情况，见第4.4.2节。4.4.2;

- 一组$\Sigma=\left\{\gamma_{i}: \Pi_{r} \rightarrow \mathbb{R}\right\}_{i=1}^{N_{r}}$关于$\Pi_{r}$的函数，满足$\gamma_{i}\left(\varphi_{j}\right)=\delta_{i j}, \delta_{i j}$是克朗克德尔塔。这些函数允许唯一地识别多项式$p \in \Pi_{r}$的扩展系数$\left\{\alpha_{j}\right\}_{j=1}^{N_{r}}$，相对于所选的基础，$p(x)=\sum_{j=1}^{N_{r}} \alpha_{j} \varphi_{j}(x)$。事实上，我们有 $\alpha_{i}=\gamma_{i}(p), i=1, \ldots, N_{r}$ 。这些系数被称为有限元的自由度。

在拉格朗日有限元的情况下，选择的基础是由拉格朗日多项式提供的，自由度$\alpha_{i}$等于多项式$p$在$K$的某一点$\mathbf{a}_{i}$所取的值，称为节点，即我们有$\alpha_{i}=p\left(\mathbf{a}_{i}\right), i=1, \ldots, N_{r}$ 。然后我们可以略微滥用符号，设定$\Sigma=\left\{\mathbf{a}_{j}\right\}_{j=1}^{N_{r}}$，因为知道了节点的位置，我们就可以找到自由度（但是请注意，这不是一般的真实情况，只考虑前面介绍的层次基础的情况）。在其余部分，我们将专门提到拉格朗日有限元的情况。

在构建拉格朗日有限元时，节点的选择不是任意的。事实上，在一个给定的集合上进行插值的问题$K$可能是不好提出的。由于这个原因，下面的定义证明是有用的。

在这种情况下，三重$\left(K, \Sigma, \Pi_{r}\right)$被称为拉格朗日有限元。在拉格朗日有限元的情况下，一般通过引用唯一的多项式空间来回忆该元素：因此之前介绍的线性有限元被称为$\mathbb{P}_{1}$，二次元的$\mathbb{P}_{2}$，等等。

正如我们在$1 \mathrm{D}$案例中所看到的，对于基于使用局部$\mathbb{P}_{1}$和$\mathbb{P}_{2}$多项式空间的有限元，从参考元$\widehat{K}$开始定义有限元是很方便的；通常这就是区间$(0,1)$。在二维情况下，它将是顶点为$(0,0),(1,0)$和$(0,1)$的直角三角形（当使用三角形元素时）。(任意维度的情况见第4.4.2节。)因此，通过变换$\phi$，我们转移到定义在$K$的有限元。因此，这个变换涉及到整个有限元。更确切地说，我们观察到，如果$\left(\widehat{K}, \widehat{\Sigma}, \widehat{\Pi}_{r}\right)$是一个拉格朗日有限元，$\phi: \widehat{K} \rightarrow \mathbb{R}^{d}$是一个连续和注入的映射，并且我们定义了

!!!!
K=\phi(\widehat{K}), \quad P_{r}=\left\{p: K \rightarrow \mathbb{R}: p \circ \phi \in \widehat{\Pi}_{r}\right\}, \quad \Sigma=\phi(\widehat{\Sigma})
$$

则$\left(K, \Sigma, P_{r}\right)$仍被说成是拉格朗日有限元。定义在三角形和四面体上的多项式空间可以被介绍如下。

![](https://cdn.mathpix.com/cropped/10058ab4e7f0c5bd6fe5bcd4db204623-080.jpg?height=201&width=334&top_left_y=118&top_left_x=200)

图4.7.$\mathbb{R}^{d}, d=1,2,3$中的单元单线图

\subsubsection{Simplexes}

如果$\left\{\mathbf{N}_{0}, \ldots, \mathbf{N}_{d}\right\}$是$d+1$在$\mathbb{R}^{d}, d \geq 1$中的点，并且向量$\left\{\mathbf{N}_{1}-\mathbf{N}_{0}, \ldots, \mathbf{N}_{d}-\mathbf{N}_{0}\right\}$是线性独立的，那么$\left\{\mathbf{N}_{0}, \ldots, \mathbf{N}_{d}\right\}$的凸壳被称为单轴，而$\left\{\mathbf{N}_{0}, \ldots, \mathbf{N}_{d}\right\}$区域称为单轴的顶点。$\mathbb{R}^{d}$的标准单线是集合

!!!!
\hat{K}_{d}=\left\{\mathbf{x} \in \mathbb{R}^{d}: x_{i} \geq 0,1 \leq i \leq d, \sum_{i=1}^{d} x_{i} \leq 1\right\}
\label{4.27}\end{equation}

它是$\mathbb{R}^{1}$中的一个单位间隔，$\mathbb{R}^{d}$中的一个单位三角形，$\mathbb{R}^{d}$中的一个单位四面体（见图4.7）。其顶点的排列方式是：除了第i个顶点等于1之外，$\mathbf{N}_{i}$的直角坐标全部为空。在$d$维单线上，多项式的空间$\mathbb{P}_{r}$定义如下

!!!!
\mathbb{P}_{r}=\left\{p(\mathbf{x})=\sum_{0 \leq i_{1}, \ldots, i_{d} \atop i_{1}+\cdots+i_{d} \leq d} a_{i_{1} \ldots i_{d}} x_{1}^{i_{1}} \ldots x_{d}^{i_{d}}, \quad a_{i_{1} \ldots i_{d}} \in \mathbb{R}\right\}
\label{4.28}\end{equation}

那么

!!!!
N_{r}=\operatorname{dim} \mathbb{P}_{r}=\left(\begin{array}{c}
r+d \\
r
\end{array}\right)=\frac{1}{d !} \prod_{k=1}^{d}(r+k)
\label{4.29}\end{equation}

\subsubsection{Barycentric coordinates}

对于$K$中的一个给定的单线$\mathbb{R}^{d}$（见第4.5.1节），有时考虑一个替代笛卡尔坐标的坐标框架是很方便的，即百里中心坐标。后者是$d+1$函数，$\left\{\lambda_{0}, \ldots, \lambda_{d}\right\}$ ，定义如下

!!!!
\lambda_{i}: \mathbb{R}^{d} \rightarrow \mathbb{R}, \lambda_{i}(\mathbf{x})=1-\frac{\left(\mathbf{x}-\mathbf{N}_{i}\right) \cdot \mathbf{n}_{i}}{\left(\mathbf{N}_{j}-\mathbf{N}_{i}\right) \cdot \mathbf{n}_{i}}, \quad 0 \leq i \leq d
\label{4.30}\end{equation}

对于每一个$i=0, \ldots, d$，让$F_{i}$表示$K$与$\mathbf{N}_{i} ; F_{i}$相对的面，如果$d=1$实际上是一个顶点，如果$d=2$是一条边，如果$d=3$是一个三角形。在\ref{4.30}, \mathbf{n}_{i}$中表示对$F_{i}$的外向法线，而$\mathbf{N}_{j}$是属于$F_{i}$的一个任意顶点。然而，$\lambda_{i}$的定义与选择$F_{i}$的哪个顶点无关。
 ![](https://cdn.mathpix.com/cropped/10058ab4e7f0c5bd6fe5bcd4db204623-081.jpg?height=174&width=440&top_left_y=117&top_left_x=228)

图4.8.点$\mathbf{P}$的重心坐标$\lambda_{i}$是单数$K_{i}$（其顶点为$\mathbf{P}$和$\left.\left\{\mathbf{N}_{j}, j \neq i\right\}\right)$）的尺寸与给定单数$K$（左边是三角形，右边是四面体）的尺寸之间的比率$\frac{\left|K_{i}\right|}{K_{K}}$。有阴影的单数是$K_{0}$。

重心坐标具有几何学意义。事实上，对于属于$K$的每一个点$\mathbf{P}$，其arycentric坐标$\lambda_{i}, 0 \leq i \leq d$，代表的是顶点为$\mathbf{P}$的单线$K_{i}$和位于顶点$\mathbf{N}_{i}$对面的面$F_{i}$的顶点的度量与$K$的度量之间的比率。见图4.8。

备注4.4。让我们考虑单元单数$\hat{K}_{d}$，其顶点$\left\{\hat{\mathbf{N}}_{\mathbf{0}}, \ldots, \hat{\mathbf{N}}_{\mathbf{d}}\right\}$的排序方式是：除了$x_{i}$等于1外，$\hat{\mathbf{N}}_{\mathbf{i}}$的所有直角坐标均为空。那么

!!!!
\lambda_{i}(\mathbf{x})=x_{i}, \quad 1 \leq i \leq d, \quad \lambda_{0}(\mathbf{x})=1-\sum_{i=1}^{d} \lambda_{i}(\mathbf{x})
\label{4.31}\end{equation}

因此，重心坐标$\lambda_{i}$是一个仿射函数，在$\mathbf{N}_{i}$处等于1，在与$\mathbf{N}_{i}$相对的面$F_{i}$上消失。

在一般单线上$K$中$\mathbb{R}^{d}$，满足以下分割的统一性属性

!!!!
0 \leq \lambda_{i}(\mathbf{x}) \leq 1, \quad \sum_{i=0}^{d} \lambda_{i}(\mathbf{x})=1 \quad \forall \mathbf{x} \in K
\label{4.27}\end{equation}

因此，一个属于$\mathbf{P}$内部的点$K$的所有arycentric坐标都是正的。当我们需要检查一个给定的点属于$2 \mathrm{D}$中的哪个三角形或$3 \mathrm{D}$中的哪个四面体时，这个属性就很有用，这种情况在使用拉格朗日导数（见第17.7.2节）或计算合适的量（通量、流线等）作为有限元计算的后处理时发生。

一个显著的性质是，$K$的重心的所有重心坐标都等于$(d+1)^{-1}$ 。另一个显著的属性是

!!!!
\varphi_{i}=\lambda_{i}, \quad 0 \leq i \leq d
\label{4.33}\end{equation}

其中$\left\{\varphi_{i}, 0 \leq i \leq d\right\}$是简单x$K$上的特征拉格朗日函数，度数为$r=1$，即

!!!!
\varphi_{i} \in \mathbb{P}_{1}\left(K_{d}\right), \quad \varphi_{i}\left(\mathbf{N}_{j}\right)=\delta_{i j}, \quad 0 \leq j \leq d
\label{4.34}\end{equation}

(对于$r=2$来说，上述特征\ref{4.33}不再成立，但是特征拉格朗日函数$\left\{\varphi_{i}\right\}$仍然可以用巴里中心坐标$\left\{\lambda_{i}\right\}$表示如下。

!!!!
\begin{cases}\varphi_{i}=\lambda_{i}\left(2 \lambda_{i}-1\right), & 0 \leq i \leq d \\ \varphi_{d+i+j}=4 \lambda_{i} \lambda_{j}, & 0 \leq i<j \leq d\end{cases}
\label{4.35}\end{equation}

对于$0 \leq i \leq d, \varphi_{i}$是与顶点$\mathbf{N}_{i}$相关的特征拉格朗日函数，而对于$0 \leq i<j \leq d, \varphi_{d+i+j}$是与边的中点相关的特征拉格朗日函数，其端点是顶点$\mathbf{N}_{i}$和$\mathbf{N}_{j}$（见图4.10，中间）。

前面的特征证明了用于$\lambda_{i}$的 "坐标 "这一名称的合理性。事实上，如果$\mathbf{P}$是单轴$K$的一个一般点，它的直角坐标$\left\{x_{j}^{(P)}, 1 \leq\right.!!!!j \leq d\}$可以用重心坐标$\left\{\lambda_{i}^{(P)}, 0 \leq i \leq d\right\}$来表示如下

!!!!
x_{j}^{(P)}=\sum_{i=0}^{d} \lambda_{i}^{(P)} x_{j}^{(i)}, 1 \leq j \leq d
\label{4.36}\end{equation}

其中$\left\{x_{j}^{(i)}, 1 \leq j \leq d\right\}$表示单线$\mathbf{N}_{i}$的第i个顶点的直角坐标$K$ 。

\subsection{The finite element method in the multi-dimensional case}

在本节中，我们将之前介绍的针对一维问题的有限元方法扩展到多维区域的边界值问题的情况。我们还将特别提到单线的情况。在任何情况下，所提出的许多结果都可以立即推广到更一般的有限元（例如，见[QV94]）。

为了简单起见，我们通常会考虑具有多边形形状的域$\Omega \subset \mathbb{R}^{2}$和用不重叠的三角形表示其覆盖的网格（或格子）$\mathscr{T}_{h}$。由于这个原因，$\mathscr{T}_{h}$也被称为三角化。关于通用网格$\mathscr{T}_{h}$的基本特征的更详细描述，我们参考第六章。这样一来，离散的领域

!!!!
\Omega_{h}=i n t\left(\bigcup_{K \in \mathscr{T}_{h}} K\right)
$$

由$\mathscr{T}_{h}$的三角形联合体的内部部分代表，与$\Omega$完全吻合。我们记得，我们用$\operatorname{int}(A)$表示集合$A$的内部部分，即通过排除$A$的边界得到的区域。事实上，我们不会分析由于用有限元网格对非多边形域进行逼近而产生的误差（见图4.9）。有兴趣的读者可以参考，例如， [Cia78] 或 [SF73] 。因此，从现在开始，我们将采用符号$\Omega$来不加区分地表示计算域和它的(可选)近似值。
 ![](https://cdn.mathpix.com/cropped/10058ab4e7f0c5bd6fe5bcd4db204623-083.jpg?height=214&width=722&top_left_y=112&top_left_x=95)

图4.9.非多边形域的三角划分。网格诱导出域$\Omega_{h}$的近似值$\Omega$，从而$\lim _{h \rightarrow 0} \operatorname{meas}\left(\Omega-\Omega_{h}\right)=0

同样在多维情况下，参数$h$与网格的间距有关。设定了$h_{K}=\operatorname{diam}(K)$，对于每个$K \in \mathscr{T}_{h}$，其中$\operatorname{diam}(K)=\max _{x, y \in K}|x-y|$是元素$K$的直径，我们定义$h=\max _{K \in \mathscr{T}_{h}} h_{K}$。此外，我们将规定网格满足以下规则性条件。让$\rho_{K}$是刻在三角形$K$中的圆的直径（也称为$K$的球度）；如果对于一个合适的$\delta>0$，条件是$\left\{\mathscr{T}_{h}, h>0\right\}$的网格族被称为是有规律的

!!!!
\frac{h_{K}}{\rho_{K}} \leq \delta \quad \forall K \in \mathscr{T}_{h}
\label{4.37}\end{equation}

被验证了。我们观察到，条件\ref{4.37}立即排除了非常变形（即拉伸）的三角形，因此可以选择使用各向异性的计算网格。

另一方面，各向异性网格经常被用于存在边界层的流体动力学问题中。参见备注4.6，特别是参考文献[AFG 00, DV02, FMP04]。关于在二维域上生成网格的其他细节在第 $6$ 章中提供。

我们用$\mathbb{P}_{r}$表示全局度数小于或等于$r$的多项式空间，对于$r=1,2, \ldots$根据一般公式\ref{4.28}我们发现

!!!!
\begin{aligned}
&\mathbb{P}_{1}=\left\{p\left(x_{1}, x_{2}\right)=a+b x_{1}+c x_{2}, \text { with } a, b, c \in \mathbb{R}\right\} \\
&\mathbb{P}_{2}=\left\{p\left(x_{1}, x_{2}\right)=a+b x_{1}+c x_{2}+d x_{1} x_{2}+e x_{1}^{2}+f x_{2}^{2}, \text { with } a, b, c, d, e, f \in \mathbb{R}\right\}, \\
&\vdots \\
&\mathbb{P}_{r}=\left\{p\left(x_{1}, x_{2}\right)=\sum_{i, j \geq 0, i+j \leq r} a_{i j} x_{1}^{i} x_{2}^{j}, \text { with } a_{i j} \in \mathbb{R}\right\}
\end{aligned}
$$

根据\ref{4.29}，空间$\mathbb{P}_{r}$的维度为$(r+1)(r+2) / 2$ 。例如，结果是$\operatorname{dim} \mathbb{P}_{1}=3, \operatorname{dim} \mathbb{P}_{2}=6$和$\operatorname{dim} \mathbb{P}_{3}=10$，因此在网格$\mathscr{T}_{h}$的每个元素上，只要已知其在3、6、10个适当选择的节点上的值，通用函数$v_{h}$就是定义良好的（见图4.10）。线性$(r=1)$、二次$(r=2)$和三次$(r=3)$多项式在三维单纯线上的节点如图$4.11$所示。
 ![](https://cdn.mathpix.com/cropped/10058ab4e7f0c5bd6fe5bcd4db204623-084.jpg?height=134&width=480&top_left_y=110&top_left_x=216)

图4.10.三角形上的线性$(r=1$, 左$)$, 二次$(r=2$, 中]和立方$(r=3$, 右$)$多项式的节点。这样的结点集是无解的

![](https://cdn.mathpix.com/cropped/10058ab4e7f0c5bd6fe5bcd4db204623-084.jpg?height=137&width=170&top_left_y=330&top_left_x=166)

![](https://cdn.mathpix.com/cropped/10058ab4e7f0c5bd6fe5bcd4db204623-084.jpg?height=137&width=174&top_left_y=330&top_left_x=365)
 ![](https://cdn.mathpix.com/cropped/10058ab4e7f0c5bd6fe5bcd4db204623-084.jpg?height=138&width=580&top_left_y=328&top_left_x=166nomials on a tetrahedron (only those on visible faces are shown)

\subsubsection{Finite element solution of the Poisson problem}

我们介绍一下有限元的空间

!!!!
X_{h}^{r}=\left\{v_{h} \in C^{0}(\bar{\Omega}):\left.v_{h}\right|_{K} \in \mathbb{P}_{r} \forall K \in \mathscr{T}_{h}\right\}, \quad r=1,2, \ldots
\label{4.38}\end{equation}


即全局连续函数的空间，这些函数是三角化的单个三角形（元素）上的度数的多项式 $r$ 。

此外，我们定义

!!!!
\dot{X}_{h}^{r}=\left\{v_{h} \in X_{h}^{r}:\left.v_{h}\right|_{\partial \Omega}=0\right\}
\label{4.39}\end{equation}

空间$X_{h}^{r}$和$X_{h}^{r}$适合于$\mathrm{H}^{1}(\Omega)$，即$\mathrm{H}_{0}^{1}(\Omega)$的近似，这要归功于以下属性（其证明见，例如，[QV94]）。

属性4.2。一个函数$v$属于$\mathrm{H}^{1}(\Omega)$的一个充分条件是
 $v \in C^{0}(\bar{\Omega})$和$v \in \mathrm{H}^{1}(K) \forall K \in \mathscr{T}_{h}$ 。

在设定了$V_{h}=X_{i}^{r}$之后，我们可以在同质情况下（即与$g=0$）引入以下有限元问题，用于逼近具有迪里希特边界条件\ref{3.2} 的泊松问题\ref{3.1} 。

!!!!
\text { find } u_{h} \in V_{h}: \int_{\Omega} \nabla u_{h} \cdot \nabla v_{h} d \Omega=\int_{\Omega} f v_{h} d \Omega \quad \forall v_{h} \in V_{h}
\label{4.40}\end{equation}

与一维情况一样，每个函数$v_{h} \in V_{h}$的特征是唯一的，它在节点$\mathbf{N}_{i}$和网格$i=1, \ldots, N_{h}$的取值（不包括

![](https://cdn.mathpix.com/cropped/10058ab4e7f0c5bd6fe5bcd4db204623-085.jpg?height=208&width=379&top_left_y=109&top_left_x=261)

图4.12.空间$\varphi_{j}$的基函数$X_{h}^{1}$及其支持度

边界节点，其中$v_{h}=0$）；因此，空间$V_{h}$中的一个基可以是特征拉格朗日函数$\varphi_{j} \in V_{h}, j=1, \ldots, N_{h}$的集合，从而

!!!!
\varphi_{j}\left(\mathbf{N}_{i}\right)=\delta_{i j}=\left\{\begin{array}{ll}
0 & i \neq j \\
1 & i=j
\end{array}, \quad i, j=1, \ldots, N_{h}\right.
\label{4.41}\end{equation}

特别是，如果$r=1$，节点是元素的顶点，除了那些属于$\Omega$边界的顶点，而通用函数$\varphi_{j}$在每个三角形上是线性的，在节点$\mathbf{N}_{j}$处等于1，在三角形的所有其他节点上等于0（见图4.12）。

一个通用函数$v_{h} \in V_{h}$可以通过$V_{h}$的基础函数的线性组合来表达，方法如下

!!!!
v_{h}(\mathbf{x})=\sum_{i=1}^{N_{h}} v_{i} \varphi_{i}(\mathbf{x}) \quad \forall \mathbf{x} \in \Omega, \text { with } v_{i}=v_{h}\left(\mathbf{N}_{i}\right)
\label{4.42}\end{equation}

通过$u_{h}!!!!\sum_{j=1}^{N_{h}} u_{j} \varphi_{j}(\mathbf{x})$，用$u_{j}=u_{h}\left(\mathbf{N}_{j}\right)$的基础$\left\{\varphi_{j}\right\}$来表达离散解$u_{h}$，并规定它对基础本身的每个函数进行验证\ref{4.40}，我们发现以下在$N_{h}$未知数$u_{j}$的线性方程组，等同于问题\ref{4.40}。

!!!!
\sum_{j=1}^{N_{h}} u_{j} \int_{\Omega} \nabla \varphi_{j} \cdot \nabla \varphi_{i} d \Omega=\int_{\Omega} f \varphi_{i} d \Omega, \quad i=1, \ldots, N_{h}
\label{4.43}\end{equation}

硬度矩阵的尺寸为$N_{h} \times N_{h}$，定义为

!!!!
\mathrm{A}=\left[a_{i j}\right] \quad \text { with } \quad a_{i j}=\int_{\Omega} \nabla \varphi_{j} \cdot \nabla \varphi_{i} d \Omega
\label{4.44}\end{equation}

此外，我们还引入了一些矢量

!!!!
\mathbf{u}=\left[u_{j}\right] \quad \text { with } \quad u_{j}=u_{h}\left(\mathbf{N}_{j}\right), \quad \mathbf{f}=\left[f_{i}\right] \quad \text { with } \quad f_{i}=\int_{\Omega} f \varphi_{i} d \Omega
\label{4.45}\end{equation}

然后，线性系统\ref{4.43}可以写为

!!!!
\mathrm{A} \mathbf{u}=\mathbf{f}
\label{4.46}\end{equation}

如同在一维情况下，未知数是有限元解决方案的节点值。很明显，由于基数为$\varphi_{i}$的通用函数的支持只由节点为$\mathbf{N}_{i}$的三角形构成，所以$\mathrm{A}$是一个稀疏的矩阵。特别是，$\mathrm{A}$的非空元素的数量是$N_{h}$的数量，因为只有当$\mathbf{N}_{j}$和$\mathbf{N}_{i}$是同一个三角形的节点时，$a_{i j}$才与零不同。A不一定有明确的结构（如带状），因为这将取决于节点的编号方式。

现在让我们考虑由方程$(3.1)-(3.2)$表示的非均质迪里切问题的情况。我们在上一章中已经看到，在任何情况下我们都可以通过边界基准的提升（也称为扩展或延长）来求助于同质情况。在相应的离散问题中，我们通过以下方式建立一个对边界基准的精心选择的近似的提升。

我们用$N_{h}$表示网格的内部节点$\mathscr{T}_{h}$，用$N_{h}^{t}$表示总数，包括边界节点，为了简单起见，我们将假设边界节点是最后编号的。边界节点的集合将由$\left\{\mathbf{N}_{i}, i=N_{h}+1, \ldots, N_{h}^{t}\right\}$构成。边界基准$g$的可能近似值$g_{h}$可以通过在$\partial \Omega$上的函数$X_{h}^{r}$的跟踪函数所形成的空间上插值$g$而得到。这可以写成与边界节点相关的$X_{h}^{r}$的基础函数的迹线的线性组合

!!!!
g_{h}(\mathbf{x})=\sum_{i=N_{h}+1}^{N_{h}^{t}} g\left(\mathbf{N}_{i}\right) \varphi_{i}(\mathbf{x}) \quad \forall \mathbf{x} \in \partial \Omega
\label{4.47}\end{equation}

其提升$R_{g_{h}} \in X_{h}^{r}$的构建方式如下

!!!!
R_{g_{h}}(\mathbf{x})=\sum_{i=N_{h}+1}^{N_{h}^{t}} g\left(\mathbf{N}_{i}\right) \varphi_{i}(\mathbf{x}) \quad \forall \mathbf{x} \in \Omega
\label{4.48}\end{equation}

在图$4.13$中，我们提供了一个可能解除非均质Dirichlet边界基准（$3.2$）的例子，在$g$具有非常数值的情况下。这样，泊松问题的有限元表述就变成了。

找到 $\stackrel{\circ}{u}_{h} \in V_{h}$ 。

!!!!
\int_{\Omega} \nabla \stackrel{u}_{h} \cdot \nabla v_{h} d \Omega=\int_{\Omega} f v_{h} d \Omega-\int_{\Omega} \nabla R_{g_{h}} \cdot \nabla v_{h} d \Omega \quad \forall v_{h} \in V_{h}
\label{4.49}\end{equation}

然后，近似解将由 $u_{h}=\stackrel{\circ}{u}_{h}+R_{g_{h}}$ 提供。

请注意，我们采用的特殊提升方式允许对\ref{4.49}进行以下代数解释

!!!!
\mathrm{A} \mathbf{u}=\mathbf{f}-\mathrm{B} \mathbf{g}
$$

其中$\mathrm{A}$和$\mathbf{f}$的定义与\ref{4.44}和\ref{4.45}相同，现在有$u_{j}=\stackrel{\circ}{u}_{h}\left(\mathbf{N}_{j}\right)$。在设定了$N_{h}^{b}=N_{h}^{t}-N_{h}$（这是边界节点的数量）之后，向量$\mathbf{g} \in \mathbb{R}^{N_{h}^{b}}$和

![](https://cdn.mathpix.com/cropped/10058ab4e7f0c5bd6fe5bcd4db204623-087.jpg?height=239&width=543&top_left_y=112&top_left_x=183)

图4.13.非均质Dirichlet边界基准$u=g, g$的提升实例是可变的

矩阵$\mathrm{B} \in \mathbb{R}^{N_{h} \times N_{h}^{b}}$分别有以下成分

!!!!
\begin{aligned}
&g_{i}=g\left(\mathbf{N}_{i+N_{h}}\right), \quad i=1, \ldots, N_{h}^{b} \\
&b_{i j}=\int_{\Omega} \nabla \varphi_{j+N_{h}} \cdot \nabla \varphi_{i} d \Omega, \quad i=1, \ldots, N_{h}, j=1, \ldots, N_{h}^{b}
\end{aligned}
$$

备注4.5。矩阵$A$和$B$都是稀疏的。一个有效的程序将只存储它们的非空元素。(关于稀疏矩阵的可能存储格式的描述，请参见[Saa96]，以及第8章）。)特别是，由于我们采用了特殊的提升方式，在矩阵$\mathrm{B}$中，所有对应于边界节点的非相邻节点的线都将是空的。(如果存在一个它们都属于的元素$K \in \mathscr{T}_{h}$，就说两个网格节点是相邻的)。

\subsubsection{Conditioning of the stiffness matrix}

我们已经看到，与Galerkin问题相关的刚度矩阵$\mathrm{A}=\left[a\left(\varphi_{j}, \varphi_{i}\right)\right]$，因此，特别是与有限元方法相关的刚度矩阵是正定的；此外，如果双线性形式$a(\cdot, \cdot)$是对称的，$\mathrm{A}$就是对称的。

对于一个对称的正定矩阵，它的条件数相对于规范$\|\cdot\|_{2}$而言，由以下公式给出

!!!!
K_{2}(\mathrm{~A})=\frac{\lambda_{\max }(\mathrm{A})}{\lambda_{\min }(\mathrm{A})}
$$

$\lambda_{\max }(\mathrm{A})$和$\lambda_{\min }(\mathrm{A})$分别是$\mathrm{A}$的最大和最小特征值。

可以证明，无论是在一维还是多维的情况下，以下关系对刚度矩阵都是成立的

!!!!
K_{2}(\mathrm{~A})=\mathrm{Ch}^{-2}
\label{4.50}\end{equation}

其中$C$是一个独立于参数$h$的常数，但取决于正在使用的有限元的程度。为了证明\ref{4.50}，我们回顾一下，矩阵A的特征值验证了以下关系

!!!!
\mathrm{A} \mathbf{v}=\lambda_{h} \mathbf{v}
$$

$\mathbf{v}$是对应于特征值$\lambda_{h}$的一个特征向量。让$v_{h}$成为空间$V_{h}$的函数，其节点值是$\mathbf{v}$的分量$v_{i}$，见\ref{4.7}。我们假设$a(\cdot, \cdot)$是对称的，所以$\mathrm{A}$是对称的，其特征值是实数和正数。那么我们有

!!!!
\lambda_{h}=\frac{(\mathrm{Av}, \mathbf{v})}{|\mathbf{v}|^{2}}=\frac{a\left(v_{h}, v_{h}\right)}{|\mathbf{v}|^{2}}
\label{4.51}\end{equation}

其中$|\cdot|$是欧几里得向量规范。我们假设网格族$\left\{\mathscr{T}_{h}, h>0\right\}$是规则的（即满足\ref{4.37}），而且是准不均匀的，即存在一个常数$\tau>0$与

!!!!
\min _{K \in \mathscr{T}_{h}} h_{K} \geq \tau h \quad \forall h>0
$$

现在我们观察到，在对$\mathscr{T}_{h}$所做的假设下，以下反不等式成立（关于证明，请参考[QV94] ）。

!!!!
\exists C_{I}>0 \quad: \quad \forall v_{h} \in V_{h}, \quad\left\|\nabla v_{h}\right\|_{\mathrm{L}^{2}(\Omega)} \leq C_{I} h^{-1}\left\|v_{h}\right\|_{\mathrm{L}^{2}(\Omega)}
\label{4.52}\end{equation}

常数$C_{I}$与$h$无关。我们现在可以证明，存在两个常数$C_{1}, C_{2}>0$，这样，对于\ref{4.7}中的每个$v_{h} \in V_{h}$，我们有

!!!!
C_{1} h^{d}|\mathbf{v}|^{2} \leq\left\|v_{h}\right\|_{\mathrm{L}^{2}(\Omega)}^{2} \leq C_{2} h^{d}|\mathbf{v}|^{2}
\label{4.53}\end{equation}

$d$ 是空间维度，$d=1,2,3$ 。对于一般情况下的证明，我们参考命题6.3.1。  [QV94] .我们在此仅限于证明一维情况下的第二个不等式$(d=1)$ 和线性有限元。事实上，在每个元素上$K_{i}=\left[x_{i-1}, x_{i}\right]$ ，我们有

!!!!
\int_{K_{i}} v_{h}^{2}(x) d x=\int_{K_{i}}\left(v_{i-1} \varphi_{i-1}(x)+v_{i} \varphi_{i}(x)\right)^{2} d x
$$

与$\varphi_{i-1}$和$\varphi_{i}$根据\ref{4.15}定义。然后，直接计算表明

!!!!
\int_{K_{i}} v_{h}^{2}(x) d x \leq 2\left(v_{i-1}^{2} \int_{K_{i}} \varphi_{i-1}^{2}(x) d x+v_{i}^{2} \int_{K_{i}} \varphi_{i}^{2}(x) d x\right)=\frac{2}{3} h_{i}\left(v_{i-1}^{2}+v_{i}^{2}\right)
$$

与 $h_{i}=x_{i}-x_{i-1}$ 。不等式

!!!!
\left\|v_{h}\right\|_{\mathrm{L}^{2}(\Omega)}^{2} \leq C h|\mathbf{v}|^{2}
$$

与$C=4 / 3$，可以通过简单的加和区间$K$来找到，并观察到每个节点的贡献$v_{i}$被计算了两次。

另一方面，从\ref{4.51}我们得到，由于双线性形式的连续性和矫捷性 $a(\cdot, \cdot)$ 。

!!!!
\alpha \frac{\left\|v_{h}\right\|_{\mathrm{H}^{1}(\Omega)}^{2}}{|\mathbf{v}|^{2}} \leq \lambda_{h} \leq M \frac{\left\|v_{h}\right\|_{\mathrm{H}^{1}(\Omega)}^{2}}{|\mathbf{v}|^{2}}
$$

$M$和$\alpha$分别是连续性和矫顽力常数。现在，$\left\|v_{h}\right\|_{\mathrm{H}^{1}(\Omega)}^{2} \geq!!!!\left\|v_{h}\right\|_{\mathrm{L}^{2}(\Omega)}^{2}$由$\mathrm{H}^{1}(\Omega)$中的准则定义，而$\left\|v_{h}\right\|_{\mathrm{H}^{1}(\Omega)} \leq C_{3} h^{-1}\left\|v_{h}\right\|_{\mathrm{L}^{2}(\Omega)}$（对于一个精心选择的常数$\left.C_{3}>0\right)$，由于\ref{4.52}。因此，通过使用不等式\ref{4.53}，我们得到

!!!!
\alpha C_{1} h^{d} \leq \lambda_{h} \leq M C_{3}^{2} C_{2} h^{-2} h^{d}
$$

因此，我们有

!!!!
\frac{\lambda_{\max }(\mathrm{A})}{\lambda_{\min }(\mathrm{A})} \leq \frac{M C_{3}^{2} C_{2}}{\alpha C_{1}} h^{-2}
$$

也就是\ref{4.50}。

当网格大小$h$减小时，刚度矩阵的条件数会增加，因此相关系统变得越来越没有条件。特别是，如果线性系统\ref{4.46}的基准点$\mathbf{f}$受到扰动$\delta \mathbf{f}$（即受到误差的影响），后者又以扰动$\delta \mathbf{u} ;$影响解，那么可以证明，如果矩阵$\mathrm{A}$上没有扰动。

!!!!
\frac{|\delta \mathbf{u}|}{|\mathbf{u}|} \leq K_{2}(\mathrm{~A}) \frac{|\delta \mathbf{f}|}{|\mathbf{f}|}
$$

很明显，调节数越高，解决方案受数据扰动的影响就越大。(另一方面，注意到后者总是受到由计算机引入的不可避免的舍入误差造成的数据扰动的影响）。)

作为一个进一步的例子，我们可以研究条件是如何影响求解方法的。例如，考虑使用共轭梯度法（见第7章）来解决线性系统\ref{4.46}。然后迭代构建一个近似解的序列$\mathbf{u}^{(k)}$，收敛到精确解$\mathbf{u}$ 。具体来说，我们有

!!!!
\left\|\mathbf{u}^{(k)}-\mathbf{u}\right\|_{\mathrm{A}} \leq 2\left(\frac{\sqrt{K_{2}(\mathrm{~A})}-1}{\sqrt{K_{2}(\mathrm{~A})}+1}\right)^{k}\left\|\mathbf{u}^{(0)}-\mathbf{u}\right\|_{\mathrm{A}}
$$

用$\|\mathbf{v}\|_{\mathrm{A}}=\sqrt{\mathbf{v}^{T} \mathrm{~A} \mathbf{v}}$表示一般向量$\mathbf{v} \in!!!!\mathbb{R}^{N_{h}}$的所谓 "A-norm"。如果我们定义

!!!!
\rho=\frac{\sqrt{K_{2}(\mathrm{~A})}-1}{\sqrt{K_{2}(\mathrm{~A})}+1}
$$

这个量给出了方法收敛率的概念：$\rho$越接近0，方法收敛越快，而$\rho$越接近1，收敛就越慢。事实上，根据\ref{4.50}，通过减少$h$，人们希望越精确，系统的条件就越差，因此其解决方案就越有 "问题"。

这就要求对系统进行预处理，即必须找到一个可逆矩阵P，称为（左）预处理器，以便

!!!!
K_{2}\left(\mathrm{P}^{-1} \mathrm{~A}\right) \ll K_{2}(\mathrm{~A})
$$

然后将迭代方法应用于以$\mathrm{P}$为前提条件的系统，即$\mathrm{P}^{-1} \mathrm{~A} \mathbf{x}=!!!!P^{-1} \mathbf{b}$（见第七章）。

\subsubsection{Estimate of the approximation error in the energy norm}

与一维情况类似，对于每个$v \in C^{0}(\bar{\Omega})$，我们定义$v$在$X_{h}^{1}$空间的插值，由网格$\mathscr{T}_{h}$决定，函数$\Pi_{h}^{1} v$使得

!!!!
\Pi_{h}^{1} v\left(\mathbf{N}_{i}\right)=v\left(\mathbf{N}_{i}\right) \quad \text { for each node } \mathbf{N}_{i} \text { of } \mathscr{T}_{h}, i=1, \ldots, N_{h}
$$

如果$\left\{\varphi_{i}\right\}$是空间$X_{h}^{1}$的拉格朗日基础，那么

!!!!
\Pi_{h}^{1} v(\mathbf{x})=\sum_{i=1}^{N_{h}} v\left(\mathbf{N}_{i}\right) \varphi_{i}(\mathbf{x})
$$

算子$\Pi_{h}^{1}: C^{0}(\bar{\Omega}) \rightarrow X_{h}^{1}$，将连续函数$v$的内插值$\Pi_{h}^{1} v$联系起来，称为内插算子。

同样，我们可以定义一个算子$\Pi_{h}^{r}: C^{0}(\bar{\Omega}) \rightarrow X_{h}^{r}$ ，对于每个整数$r \geq 1$ 用$\Pi_{K}^{r}$表示与连续函数$v$的多项式$\Pi_{K}^{r} v \in \mathbb{P}_{r}(K)$相关的局部插值算子，在元素的自由度$K \in \mathscr{T}_{h}$中插值$v$，我们规定

!!!!
\Pi_{h}^{r} v \in X_{h}^{r}:\left.\quad \Pi_{h}^{r} v\right|_{K}=\Pi_{K}^{r}\left(\left.v\right|_{K}\right) \quad \forall K \in \mathscr{T}_{h}
\label{4.54}\end{equation}

从现在开始，我们将假设$\mathscr{T}_{h}$属于$\Omega$的一个规则网格族。

为了得到近似误差的估计$\left\|u-u_{h}\right\|_{V}$，我们遵循与定理$4.3$中用于一维情况的类似程序。第一步是为插值误差推导出一个合适的估计。为此，我们将从每个三角形的几何参数$K$，即其直径$h_{K}$和球度$\rho_{K}$开始获得有用信息。此外，我们将利用参考三角形$\widehat{K}$和一般三角形$K$之间的仿射和可逆变换$F_{K}: \widehat{K} \rightarrow K$（见图4.14）。这种映射由$F_{K}(\hat{\mathbf{x}})=B_{K} \hat{\mathbf{x}}+\mathbf{b}_{K}$定义，与$B_{K} \in \mathbb{R}^{2 \times 2}$和$\mathbf{b}_{K} \in \mathbb{R}^{2}$，并满足关系$F_{K}(\widehat{K})=K$。我们回顾一下，参考三角形$\widehat{K}$的选择不是唯一的。

我们将需要一些初步的结果。

![](https://cdn.mathpix.com/cropped/10058ab4e7f0c5bd6fe5bcd4db204623-090.jpg?height=149&width=364&top_left_y=1049&top_left_x=273)

图4.14.参考三角形$\widehat{K}$和一般三角形$K$之间的映射$F_{K}$证明。由于$C^{m}(K) \subset \mathrm{H}^{m}(K)$是密集的，对于每个$m \geq 0$，我们可以限制自己去证明$C^{m}(K)$的函数的前两个不等式，然后通过密度将结果扩展到$\mathrm{H}^{m}(K)$的函数。因此，余数中的导数必须是经典意义上的。我们回顾一下

!!!!
|\hat{v}|_{\mathrm{H}^{m}(\widehat{K})}=\left(\sum_{|\alpha|=m} \int_{\widehat{K}}\left|D^{\alpha} \hat{v}\right|^{2} d \hat{\mathbf{x}}\right)^{1 / 2}
$$

参考第$2.3$章关于导数的定义$D^{\alpha}$ 。通过使用复合函数微分的连锁规则，我们得到

!!!!
\left\|D^{\alpha} \hat{v}\right\|_{L^{2}(\widehat{K})} \leq C\left\|B_{K}\right\|^{m} \sum_{|\boldsymbol{\beta}|=m}\left\|\left(D^{\beta} v\right) \circ F_{K}\right\|_{\mathrm{L}^{2}(\widehat{K})}
$$

那么

!!!!
\left\|D^{\alpha} \hat{v}\right\|_{L^{2}(\widehat{K})} \leq C\left\|B_{K}\right\|^{m}\left|\operatorname{det} B_{K}\right|^{-\frac{1}{2}}\left\|D^{\alpha} v\right\|_{L^{2}(K)}
$$

在对多指数$\boldsymbol{\alpha}$进行求和之后，不等式\ref{4.55}就会出现，因为$|\boldsymbol{\alpha}|=m$。结果\ref{4.56}可以通过类似的方式进行证明。

Lemma $4.3$ (Estimates for the norms $\left\|\boldsymbol{B}_{\boldsymbol{K}}\right\|$ and $\left.\left\|\boldsymbol{B}_{\boldsymbol{K}}^{-1}\right\|\right) .$ We have the following upper bounds:

!!!!
\left\|B_{K}\right\| \leq \frac{h_{K}}{\hat{\rho}}
\label{4.58}\end{equation}

!!!!
\left\|B_{K}^{-1}\right\| \leq \frac{\hat{h}}{\rho_{K}}
\label{4.59}\end{equation}

$\hat{h}$ and $\hat{\rho}$ being the diameter and the sphericity of the reference triangle $\widehat{K}$.


证明。由于\ref{4.57}，我们有

!!!!
\left\|B_{K}\right\|=\frac{1}{\hat{\rho}} \sup _{\boldsymbol{\xi} \in \mathbb{R}^{2},|\boldsymbol{\xi}|=\hat{\rho}}\left|B_{K} \boldsymbol{\xi}\right|
$$

对于每个$\boldsymbol{\xi}$，与$|\boldsymbol{\xi}|=\hat{\rho}$，我们可以找到两个点$\hat{\mathbf{x}}$和$\hat{\mathbf{y}} \in \widehat{K}$，以便$\hat{\mathbf{x}}-\hat{\mathbf{y}}=\boldsymbol{\xi}$ 。由于$B_{K} \boldsymbol{\xi}=F_{K}(\hat{\mathbf{x}})-F_{K}(\hat{\mathbf{y}})$，我们有$\left|B_{K} \boldsymbol{\xi}\right| \leq h_{K}$，即\ref{4.58}。通过类似的程序可以得出结果\ref{4.59}。

我们现在需要的是在$\mathrm{H}^{m}(\widehat{K})$中对$\left(v-\Pi_{K}^{r} v\right) \circ F_{K}$的seminorm的估计，对于$\mathrm{H}^{m}(K)$的每个函数$v$。在其余部分，我们用$\left[\Pi_{K}^{r} v\right]^{-}$表示插值$\Pi_{K}^{r} v \circ F_{K}$。$K$的节点是$\mathbf{N}_{i}^{K}=F_{K}\left(\widehat{\mathbf{N}}_{i}\right), \widehat{\mathbf{N}}_{i}$是$\widehat{K}$的节点，类似地，定义在$\widehat{K}$上的基函数$\hat{\varphi}_{i}$由关系$\hat{\varphi}_{i}=\varphi_{i}^{K} \circ F_{K}$决定，用$\varphi_{i}^{K}$表示与元素$K$相关的基函数。因此。

!!!!
\left[\Pi_{K}^{r} v\right]^{-}=\Pi_{K}^{r} v \circ F_{K}=\sum_{i=1}^{M_{K}} v\left(\mathbf{N}_{i}^{K}\right) \varphi_{i}^{K} \circ F_{K}=\sum_{i=1}^{M_{K}} v\left(F_{K}\left(\widehat{\mathbf{N}}_{i}\right)\right) \hat{\varphi}_{i}=\Pi_{\widehat{K}}^{r} \hat{v}
$$

$M_{K}$是$K$上与学位$r$有关的节点数。那么

!!!!
\left|\left(v-\Pi_{K}^{r} v\right) \circ F_{K}\right|_{\mathrm{H}^{m}(\hat{K})}=\left|\hat{v}-\Pi_{\hat{K}}^{r} \hat{v}\right|_{\mathrm{H}^{m}(\widehat{K})}
\label{4.60}\end{equation}

为了估计前面等式的右边，我们首先证明以下结果。

Lemma $4.4$ (Bramble-Hilbert Lemma). Let $\widehat{L}: \mathrm{H}^{r+1}(\widehat{K}) \rightarrow \mathrm{H}^{m}(\widehat{K})$, with $m \geq 0$ and $r \geq 0$, be a linear and continuous transformation such that

!!!!
\widehat{L}(\hat{p})=0 \quad \forall \hat{p} \in \mathbb{P}_{r}(\widehat{K})
\label{4.61}\end{equation}

Then, for each $\hat{v} \in \mathrm{H}^{r+1}(\widehat{K})$, we have

!!!!
|\widehat{L}(\hat{v})|_{\mathrm{H}^{m}(\widehat{K})} \leq\|\widehat{L}\|_{\mathscr{L}\left(\mathrm{H}^{r+1}(\widehat{K}), \mathrm{H}^{m}(\widehat{K})\right)} \inf _{\hat{p} \in \mathbb{P}_{r}(\widehat{K})}\|\hat{v}+\hat{p}\|_{\mathrm{H}^{r+1}(\widehat{K})}
\label{4.62}\end{equation}

where $\mathscr{L}\left(\mathrm{H}^{r+1}(\widehat{K}), \mathrm{H}^{m}(\widehat{K})\right)$ denotes the space of linear and continuous transformations $l: \mathrm{H}^{r+1}(\widehat{K}) \rightarrow \mathrm{H}^{m}(\widehat{K})$, normed by

!!!!
\|l\|_{\mathscr{L}\left(\mathrm{H}^{r+1}(\widehat{K}), \mathrm{H}^{m}(\widehat{K})\right)}=\sup _{v \in \mathrm{H}^{r+1}(\widehat{K}), v \neq 0} \frac{\|l(v)\|_{\left.\mathrm{H}^{m}(\widehat{K})\right)}}{\|v\|_{\mathrm{H}^{r+1}(\widehat{K})}}
\label{4.63}\end{equation}



证明。让$\hat{v} \in \mathrm{H}^{r+1}(\widehat{K})$ .对于每个$\hat{p} \in \mathbb{P}_{r}(\widehat{K})$，由于\ref{4.61}和规范的定义\ref{4.63}，我们得到

!!!!
|\widehat{L}(\hat{v})|_{\mathrm{H}^{m}(\widehat{K})}=|\widehat{L}(\hat{v}+\hat{p})|_{\mathrm{H}^{m}(\widehat{K})} \leq\|\widehat{L}\|_{\mathscr{L}\left(\mathrm{H}^{r+1}(\widehat{K}), \mathrm{H}^{m}(\widehat{K})\right)}\|\hat{v}+\hat{p}\|_{\mathrm{H}^{r+1}(\widehat{K})}
$$

然后，由于$\hat{p}$是任意的，\ref{4.62}可以推导出来。下面的结果（其证明在[QV94，第3章]中给出）提供了最后一个必要的工具，以获得我们正在寻求的插值误差的估计。

Lemma $4.5$ (Deny-Lions Lemma). For each $r \geq 0$ there exists a constant $C=$ $C(r, \widehat{K})$ such that

!!!!
\inf _{\hat{p} \in \mathbb{P}_{r}}\|\hat{v}+\hat{p}\|_{\mathrm{H}^{r+1}(\widehat{K})} \leq C|\hat{v}|_{\mathrm{H}^{r+1}(\widehat{K})} \quad \forall \hat{v} \in \mathrm{H}^{r+1}(\widehat{K})
\label{4.64}\end{equation}


作为前面两个定理的结果，我们可以提供以下内容

Corollary 4.3. Let $\widehat{L}: \mathrm{H}^{r+1}(\widehat{K}) \rightarrow \mathrm{H}^{m}(\widehat{K})$, with $m \geq 0$ and $r \geq 0$, be a linear and continuous transformation such that $\widehat{L}(\hat{p})=0 \forall \hat{p} \in \mathbb{P}_{r}(\widehat{K}) .$ Then there exists a constant $C=C(r, \widehat{K})$ such that, for each $\hat{v} \in \mathrm{H}^{r+1}(\widehat{K})$, we have


!!!!
|\widehat{L}(\hat{v})|_{\mathrm{H}^{m}(\widehat{K})} \leq C\|\widehat{L}\|_{\mathscr{L}}\left(\mathrm{H}^{r+1}(\widehat{K}), \mathrm{H}^{m}(\widehat{K})\right)|\hat{v}|_{\mathrm{H}^{r+1}(\widehat{K})}
\label{4.65}\end{equation}

我们现在能够证明插值误差估计。

Theorem $4.4$ (Local estimate of the interpolation error). Let $r \geq 1$ and $0 \leq$ $m \leq r+1$. Then there exists a constant $C=C(r, m, \widehat{K})>0$ such that

!!!!
\left|v-\Pi_{K}^{r} v\right|_{\mathrm{H}^{m}(K)} \leq C \frac{h_{K}^{r+1}}{\rho_{K}^{m}}|v|_{\mathrm{H}^{r+1}(K)} \quad \forall v \in \mathrm{H}^{r+1}(K)
\label{4.66}\end{equation}


证明。从属性$2.3$我们首先推导出$\mathrm{H}^{r+1}(K) \subset C^{0}(K)$，对于$r \geq 1$。因此，插值算子$\Pi_{K}^{r}$的结果是在$\mathrm{H}^{r+1}(K)$中定义良好。通过依次使用\ref{4.56},\ref{4.60},\ref{4.59}和\ref{4.65}，我们有

!!!!
\begin{aligned}
\left|v-\Pi_{K}^{r} v\right|_{\mathrm{H}^{m}(K)} & \leq C_{1}\left\|B_{K}^{-1}\right\|^{m}\left|\operatorname{det} B_{K}\right|^{\frac{1}{2}}\left|\hat{v}-\Pi_{\widehat{K}}^{r} \hat{v}\right|_{\mathrm{H}^{m}(\widehat{K})} \\
& \leq C_{1} \frac{\hat{h}^{m}}{\rho_{K}^{m}}\left|\operatorname{det} B_{K}\right|^{\frac{1}{2}}\left|\hat{v}-\Pi_{\widehat{K}}^{r} \hat{v}\right|_{\mathrm{H}^{m}(\widehat{K})} \\
& \leq C_{2} \frac{\hat{h}^{m}}{\rho_{K}^{m}}\left|\operatorname{det} B_{K}\right|^{\frac{1}{2}}\|\widehat{L}\|_{\mathscr{L}\left(\mathrm{H}^{r+1}(\widehat{\mathcal{K}}), \mathrm{H}^{m}(\hat{K})\right)}|\hat{v}|_{\mathrm{H}^{r+1}(\widehat{K})} \\
&=C_{3} \frac{1}{\rho_{K}^{m}}\left|\operatorname{det} B_{K}\right|^{\frac{1}{2}}|\hat{v}|_{\mathrm{H}^{r+1}(\hat{K})}
\end{aligned}
$$

其中$C_{1}=C_{1}(m), C_{2}=C_{2}(r, m, \widehat{K})$和$C_{3}=C_{3}(r, m, \widehat{K})$是适当选择的常数，都与$h$无关。我们注意到，在确定$\widehat{L}$与算子$I-\Pi_{\widehat{K}}^{r}$，与$\left(I-\Pi_{\widehat{K}}^{r}\right) \hat{p}=0$，为$\hat{p} \in \mathbb{P}_{r}(\widehat{K})$时已经应用了结果\ref{4.65}。此外，数量$\hat{h}^{m}$和算子$\widehat{L}$的法线已经包含在常数$C_{3}$中。在这一点上，通过应用\ref{4.55}和\ref{4.58}，我们得到\ref{4.66}，即

!!!!
\left|v-\Pi_{K}^{r} v\right|_{\mathrm{H}^{m}(K)} \leq C_{4} \frac{1}{\rho_{K}^{m}}\left\|B_{K}\right\|^{r+1}|v|_{\mathrm{H}^{r+1}(K)} \leq C_{5} \frac{h_{K}^{r+1}}{\rho_{K}^{m}}|v|_{\mathrm{H}^{r+1}(K)}
\label{4.67}\end{equation}

$C_{4}=C_{4}(r, m, \widehat{K})$和$C_{5}=C_{5}(r, m, \widehat{K})$是两个精心选择的常数。由\ref{4.58}产生的、与参考元素的球度有关的量$\hat{\rho}^{r+1}$已直接包含在常数$C_{5}$中。

最后，我们可以证明插值误差的全局估计。

!!!!
\begin{aligned}
&\text { Theorem } 4.5 \text { (Global estimate for the interpolation error). Let } m=0,1 \text { and } \\
&r \geq 1 . \text { There exists a constant } C=C(r, m, \widehat{K})>0 \text { such that } \\
&\qquad\left|v-\Pi_{h}^{r} v\right|_{\mathrm{H}^{m}(\Omega)} \leq C\left(\sum_{K \in \mathscr{T} h} h_{K}^{2(r+1-m)}|v|_{\mathrm{H}^{r+1}(K)}^{2}\right)^{1 / 2} \quad \forall v \in \mathrm{H}^{r+1}(\Omega) . \\
&\text { In particular, we obtain } \\
&\qquad\left|v-\Pi_{h}^{r} v\right|_{\mathrm{H}^{m}(\Omega)} \leq C h^{r+1-m}|v|_{\mathrm{H}^{r+1}(\Omega)} \quad \forall v \in \mathrm{H}^{r+1}(\Omega)
\end{aligned}
$$

Theorem $4.5$ (Global estimate for the interpolation error). Let $m=0,1$ and $r \geq 1 .$ There exists a constant $C=C(r, m, \widehat{K})>0$ such that

!!!!
\left|v-\Pi_{h}^{r} v\right|_{\mathrm{H}^{m}(\Omega)} \leq C\left(\sum_{K \in \mathscr{T}_{h}} h_{K}^{2(r+1-m)}|v|_{\mathrm{H}^{r+1}(K)}^{2}\right)^{1 / 2} \quad \forall v \in \mathrm{H}^{r+1}(\Omega)
\label{4.68}\end{equation}

In particular, we obtain

!!!!
\left|v-\Pi_{h}^{r} v\right|_{\mathrm{H}^{m}(\Omega)} \leq C h^{r+1-m}|v|_{\mathrm{H}^{r+1}(\Omega)} \quad \forall v \in \mathrm{H}^{r+1}(\Omega)
\label{4.69}\end{equation}


证明。由于\ref{4.66}和规律性条件\ref{4.37}，我们有

!!!!
\begin{aligned}
\left|v-\Pi_{h}^{r} v\right|_{\mathrm{H}^{m}(\Omega)}^{2} &=\sum_{K \in \mathscr{T}_{h}}\left|v-\Pi_{K}^{r} v\right|_{\mathrm{H}^{m}(K)}^{2} \\
& \leq C_{1} \sum_{K \in \mathscr{T}_{h}}\left(\frac{h_{K}^{r+1}}{\rho_{K}^{m}}\right)^{2}|v|_{\mathrm{H}^{r+1}(K)}^{2} \\
&=C_{1} \sum_{K \in \mathscr{T}_{h}}\left(\frac{h_{K}}{\rho_{K}}\right)^{2 m} h_{K}^{2(r+1-m)}|v|_{\mathrm{H}^{r+1}(K)}^{2} \\
& \leq C_{1} \delta^{2 m} \sum_{K \in \mathscr{T}_{h}} h_{K}^{2(r+1-m)}|v|_{\mathrm{H}^{r+1}(K)}^{2}
\end{aligned}
$$

即\ref{4.68}，有$C_{1}=C_{1}(r, m, \widehat{K})$和$C=C_{1} \delta^{2 m}$ .\ref{4.69}的情况下，由于$h_{K} \leq h$，对于每个$K \in \mathscr{T}_{h}$，以及对于每个整数$p \geq 0

!!!!
|v|_{\mathrm{H}^{p}(\Omega)}=\left(\sum_{K \in \mathscr{T}_{h}}|v|_{\mathrm{H}^{p}(K)}^{2}\right)^{1 / 2}
$$

在$m=0$的情况下，网格的规则性对于获得估计值\ref{4.69}是不需要的。对于$m=1$来说，这不再是真的。事实上，给定一个三角形 $K$ 和一个函数 $v \in \mathrm{H}^{r+1}(K)$ ，与 $r \geq 1$ ，以下不等式成立 [QV94] 。

!!!!
\left|v-\Pi_{h}^{r} v\right|_{\mathrm{H}^{m}(K)} \leq \tilde{C} \frac{h_{K}^{r+1}}{\rho_{K}^{m}}|v|_{\mathrm{H}^{r+1}(K)}, \quad m=0,1
$$

$\tilde{C}$与$v$和$\mathscr{T}_{h}$无关。因此，在$m=1$为规则网格族的情况下，我们通过设定$C=\delta \tilde{C}, \delta$为\ref{4.37}中出现的常数，得到\ref{4.69}。另一方面，可以通过考虑以下特殊情况来证明对规则性条件的需求：对于每个$C>0$，可以构建一个（非规则）网格，对于该网格，不等式\ref{4.69}不成立，正如我们将在以下与$r=1$有关的例子中证明的那样。

例4.1.考虑图4.15所示的三角形$K_{l}$，其顶点$(0,0)$，$(1,0),(0.5, l)$，与$l \leq \frac{\sqrt{3}}{2}$，以及函数$v\left(x_{1}, x_{2}\right)=x_{1}^{2}$ 。显然，$v \in \mathrm{H}^{2}\left(K_{l}\right)$，其在$K_{l}$上的线性插值由$\Pi_{h}^{1} v\left(x_{1}, x_{2}\right)=x_{1}-(4 l)^{-1} x_{2}$给出。由于在这种情况下$h_{K_{l}}=1$，不等式\ref{4.69}，适用于单个三角形$K_{l}$，将产生

!!!!
\left|v-\Pi_{h}^{1} v\right|_{\mathrm{H}^{1}\left(K_{l}\right)} \leq C|v|_{\mathrm{H}^{2}\left(K_{l}\right)}
\label{4.70}\end{equation}

现在让我们考虑当$l$趋于零时，即三角形被挤压时，比率$\eta_{l}=\frac{\left|v-\Pi_{h}^{1} v\right|_{\mathrm{H}^{1}\left(K_{l}\right)}}{|v|_{\mathrm{H}^{2}\left(K_{l}\right)}}$的行为。我们注意到，允许$l$趋于零相当于违反了规则性条件\ref{4.37}，因为对于足够小的$l, h_{K_{l}}=1$的值来说。同时，用$p_{K_{l}}$表示$K_{l}$的周长，用$\left|K_{l}\right|$表示元素$K_{l}$的表面，$K_{l}$的球形度

!!!!
\rho_{K_{l}}=\frac{4\left|K_{l}\right|}{p_{K_{l}}}=\frac{2 l}{1+\sqrt{1+4 l^{2}}}
!!!!
 ![](https://cdn.mathpix.com/cropped/10058ab4e7f0c5bd6fe5bcd4db204623-095.jpg?height=318&width=682&top_left_y=860&top_left_x=109)

图4.15.三角形$K_{l}$（左）和关系$\left|v-\Pi_{h}^{1} v\right|_{\mathrm{H}^{1}\left(K_{l}\right)} /|v|_{\mathrm{H}^{2}\left(K_{l}\right)}$作为$l$（右）的函数的行为趋于零。我们有

!!!!
\eta_{l} \geq \frac{\left\|\partial_{x_{2}}\left(v-\Pi_{h}^{1} v\right)\right\|_{\mathrm{L}^{2}\left(K_{l}\right)}}{|v|_{\mathrm{H}^{2}\left(K_{l}\right)}}=\left(\frac{\int_{K_{l}}\left(\frac{1}{4 l}\right)^{2} d \mathbf{x}}{2 l}\right)^{\frac{1}{2}}=\frac{1}{8 l}
$$

因此$\lim _{l \rightarrow 0} \eta_{l}=+\infty$（见图4.15）。因此，不可能存在一个常数$C$，独立于$\mathscr{T}_{h}$，对它来说\ref{4.70}成立。

关于插值误差估计的定理立即为我们提供了Galerkin方法的近似误差估计。其证明与一维情况下的定理$4.3$类似。事实上，只要应用\ref{4.10}和定理$4.5$（针对$m=1$），就可以得到以下误差估计。

定理4.6。设$\left\{\mathscr{T}_{h}\right\}_{h>0}$是域的一个规则三角化族$\Omega$ .设$u \in V$为变分问题\ref{4.1}的精确解，$u_{h}$为它的
度的有限元方法的近似解$r$ 。如果$u \in \mathrm{H}^{r+1}(\Omega)$ ,则以下先验误差估计成立。

!!!!
\left\|u-u_{h}\right\|_{\mathrm{H}^{1}(\Omega)} \leq \frac{M}{\alpha} C\left(\sum_{K \in \mathscr{T}_{h}} h_{K}^{2 r}|u|_{\mathrm{H}^{r+1}(K)}^{2}\right)^{1 / 2}
\label{4.71}\end{equation}

!!!!
\left\|u-u_{h}\right\|_{\mathrm{H}^{1}(\Omega)} \leq \frac{M}{\alpha} C h^{r}|u|_{\mathrm{H}^{r+1}(\Omega)}
\label{4.72}\end{equation}

C being a constant independent of $h$ and $u$.

同样在多维的情况下，为了提高精确度，可以采取两种不同的策略。

1. 减少$h$，即细化网格。

2. 增加$r$，即使用更高程度的有限元。

然而，只有当解$u$足够规则时，才能采用后一种方法。一般来说，我们可以说，如果$u \in C^{0}(\bar{\Omega}) \cap \mathrm{H}^{p+1}(\Omega)$为某个$p>0$，那么

!!!!
\left\|u-u_{h}\right\|_{\mathrm{H}^{1}(\Omega)} \leq C h^{s}|u|_{\mathrm{H}^{s+1}(\Omega)}, \quad s=\min \{r, p\},
\label{4.73}\end{equation}

正如在一维情况下已经观察到的（见\ref{4.26}）。注意，$u$连续的充分条件是$p>\frac{d}{2}-1$（$d$是问题的空间维度，$d=1,2,3$）。此外，有可能证明最大规范的误差估计。例如，如果$r=1$，我们有

!!!!
\left\|u-u_{h}\right\|_{L^{\infty}(\Omega)} \leq C h^{2}|\log h||u|_{W^{2, \infty}(\Omega)}
$$

其中$C$是独立于$h$的正常数，右边最后一项是$u$在Sobolev空间$W^{2, \infty}(\Omega)$中的半规则（见2.5节）。关于这个和其他$W^{k, \infty}(\Omega)$的误差估计的证明，见，例如，[Cia78]和[BS94] 。

备注4.6（各向异性网格的情况）。在各向异性网格的情况下，插值误差估计\ref{4.66}（以及随之而来的离散化误差估计）可以被推广。然而，在这种情况下，\ref{4.66} 的左项采用了更复杂的表达方式：事实上，由于其方向性，这些估计必须考虑到来自与单个三角形相关的特征方向的信息，这些信息取代了集中在seminorm $|v|_{\mathrm{H}^{r+1}(K)}$ 中的 "全局 "信息。有兴趣的读者可以参考 [Ape99, FP01] 。此外，我们参考图$4.18$和$13.21$中各向异性网格的例子。

\subsection{Estimate of approximation error in $\mathrm{L}^{2}$ norm}。

不等式\ref{4.72}提供了能量准则中近似误差的估计。类似地，有可能得到$\mathrm{L}^{2}$准则中的误差估计。由于后一准则比前一准则弱，我们必须期望在$h$方面有更高的收敛率。

Lemma 4.6 (Elliptic regularity). Consider the homogeneous Dirichlet problem

!!!!
\begin{cases}-\Delta w=g & \text { in } \Omega \\ w=0 & \text { on } \partial \Omega\end{cases}
!!!!
with $g \in \mathrm{L}^{2}(\Omega)$. If $\partial \Omega$ is sufficiently regular (for instance, if $\partial \Omega$ is a curve of class $C^{2}$, or else if $\Omega$ is a convex polygon), then $w \in \mathrm{H}^{2}(\Omega)$, and moreover there exists a constant $C>0$ such that

!!!!
\|w\|_{\mathrm{H}^{2}(\Omega)} \leq C\|g\|_{\mathrm{L}^{2}(\Omega)}
\label{4.74}\end{equation}

证明见，例如，[Bre86, Gri11]。

Theorem 4.7. Let $u \in V$ be the exact solution of the variational problem \ref{4.1} and $u_{h}$ its approximate solution obtained with the finite element method of degree r. Moreover, let $u \in C^{0}(\bar{\Omega}) \cap \mathrm{H}^{p+1}(\Omega)$ for a given $p>0 .$ Then, the following a priori error estimate in the norm of $\mathrm{L}^{2}(\Omega)$ holds

!!!!
\left\|u-u_{h}\right\|_{\mathrm{L}^{2}(\Omega)} \leq C h^{s+1}|u|_{\mathrm{H}^{s+1}(\Omega)}, \quad s=\min \{r, p\}
\label{4.75}\end{equation}

C being a constant independent of $h$ and $u$.


证明。我们将仅限于证明泊松问题\ref{3.13} 的这一结果，该问题的弱表述在\ref{3.18} 中给出。让$e_{h}=u-u_{h}$为近似误差，并考虑以下辅助泊松问题（称为邻接问题，见第3.5节），其源项由误差函数$e_{h}$给出。

!!!!
\begin{cases}-\Delta \phi=e_{h} & \text { in } \Omega \\ \phi=0 & \text { on } \partial \Omega\end{cases}
\label{4.76}\end{equation}

其弱表述为

!!!!
\text { find } \phi \in V: \quad a(\phi, v)=\int_{\Omega} e_{h} v d \Omega \quad \forall v \in V
\label{4.77}\end{equation}

与$V=\mathrm{H}_{0}^{1}(\Omega)$。以$v=e_{h}(\in V)$，我们有

!!!!
\left\|e_{h}\right\|_{\mathrm{L}^{2}(\Omega)}^{2}=a\left(\phi, e_{h}\right)
$$

由于双线性形式是对称的，根据Galerkin正交性\ref{4.8}，我们有

!!!!
a\left(e_{h}, \phi_{h}\right)=a\left(\phi_{h}, e_{h}\right)=0 \quad \forall \phi_{h} \in V_{h}
$$

由此可见，

!!!!
\left\|e_{h}\right\|_{\mathrm{L}^{2}(\Omega)}^{2}=a\left(\phi, e_{h}\right)=a\left(\phi-\phi_{h}, e_{h}\right)
\label{4.78}\end{equation}

现在，取$\phi_{h}=\Pi_{h}^{1} \phi$，将考奇-施瓦茨不等式应用于双线性形式$a(\cdot, \cdot)$并使用插值误差估计\ref{4.69}，我们得到

!!!!
\left\|e_{h}\right\|_{\mathrm{L}^{2}(\Omega)}^{2} \leq\left|e_{h}\right|_{\mathrm{H}^{1}(\Omega)}\left|\phi-\phi_{h}\right|_{\mathrm{H}^{1}(\Omega)} \leq\left|e_{h}\right|_{\mathrm{H}^{1}(\Omega)} C h|\phi|_{\mathrm{H}^{2}(\Omega)}
\label{4.79}\end{equation}

注意插值算子$\Pi_{h}^{1}$可以应用于$\phi$，因为，$\phi \in \mathrm{H}^{2}(\Omega)$由于定理$4.6$，因此，特别是$\phi \in C^{0}(\bar{\Omega})$ ，由于第二章中的属性$2.3$。通过将定理$4.6$应用于邻接问题\ref{4.76}，我们得到不等式

!!!!
|\phi|_{\mathrm{H}^{2}(\Omega)} \leq C\left\|e_{h}\right\|_{\mathrm{L}^{2}(\Omega)}
\label{4.80}\end{equation}

应用于\ref{4.79}，最终提供了

!!!!
\left\|e_{h}\right\|_{\mathrm{L}^{2}(\Omega)} \leq C h\left|e_{h}\right|_{\mathrm{H}^{1}(\Omega)}
$$

其中$C$占了到目前为止出现的所有常数。现在利用能量准则的误差估计\ref{4.72}，我们得到\ref{4.75}。

让我们把刚才为泊松问题证明的结果推广到用有限元逼近的一般椭圆边界值问题的情况，对于这种情况，能量准则中的逼近误差估计如\ref{4.72}成立，并且类似于Lemma$4.6$的椭圆正则属性成立。特别是，让我们考虑双线性形式$a(\cdot, \cdot)$不一定对称的情况。让$u$成为问题的精确解

!!!!
\text { find } u \in V: \quad a(u, v)=(f, v) \quad \forall v \in V,
\label{4.81}\end{equation}

和$u_{h}$Galerkin问题的解决方案

!!!!
\text { find } u_{h} \in V_{h}: \quad a\left(u_{h}, v_{h}\right)=\left(f, v_{h}\right) \quad \forall v_{h} \in V_{h} .
$$

最后，假设误差估计\ref{4.72}成立，让我们考虑以下问题，我们将其称为\ref{4.81}的邻接问题：对于每个$g \in \mathrm{L}^{2}(\Omega)$ 。

!!!!
\text { find } \phi=\phi(g) \in V: \quad a^{*}(\phi, v)=(g, v) \quad \forall v \in V,
\label{4.82}\end{equation}

其中我们定义了 $(\operatorname{see}(3.40)) a^{*}: V \times V \rightarrow \mathbb{R}$ 。

显然，如果$a$是对称的，那么这两个问题是重合的，例如在问题\ref{4.77}的情况下可以看到。

让我们假设对于原始问题\ref{4.81}的解$u$，椭圆正则性结果成立；然后可以验证同样的结果对邻接问题\ref{4.82}有效，也就是

!!!!
\exists C>0: \quad\|\phi(g)\|_{\mathrm{H}^{2}(\Omega)} \leq C\|g\|_{\mathrm{L}^{2}(\Omega)} \quad \forall g \in \mathrm{L}^{2}(\Omega)
$$

特别是，对于多边形和凸域上的具有Dirichlet或Neumann（但不是混合）数据的一般椭圆问题来说，这是真的 $\Omega$ [Gri11] 。现在我们选择$g=e_{h}$，为简单起见，表示$\phi=\phi\left(e_{h}\right)$ 。此外，既然选择了$v=e_{h}$，我们有

!!!!
\left\|e_{h}\right\|_{\mathrm{L}^{2}(\Omega)}^{2}=a\left(e_{h}, \phi\right)
$$

由于邻接问题的椭圆规律性$\phi \in \mathrm{H}^{2}(\Omega)$，以及$\|\phi\|_{\mathrm{H}^{2}(\Omega)} \leq!!!!C\left\|e_{h}\right\|_{\mathrm{L}^{2}(\Omega)}$由于Galerkin的正交性，我们有

!!!!
\begin{aligned}
\left\|e_{h}\right\|_{\mathrm{L}^{2}(\Omega)}^{2} &=a\left(e_{h}, \phi\right)=a\left(e_{h}, \phi-\Pi_{h}^{1} \phi\right) \\
& \leq C_{1}\left\|e_{h}\right\|_{\mathrm{H}^{1}(\Omega)}\left\|\phi-\Pi_{h}^{1} \phi\right\|_{\mathrm{H}^{1}(\Omega)} \\
& \leq C_{2}\left\|e_{h}\right\|_{\mathrm{H}^{1}(\Omega)} h\|\phi\|_{\mathrm{H}^{2}(\Omega)} \\
& \leq C_{3}\left\|e_{h}\right\|_{\mathrm{H}^{1}(\Omega)} h\left\|e_{h}\right\|_{\mathrm{L}^{2}(\Omega)}
\end{aligned}
$$

其中我们利用了形式的连续性$a(\cdot, \cdot)$和估计\ref{4.72}。因此

!!!!
\left\|e_{h}\right\|_{\mathrm{L}^{2}(\Omega)} \leq C_{3} h\left\|e_{h}\right\|_{\mathrm{H}^{1}(\Omega)}
$$

从中可以得出\ref{4.75}，使用$\mathrm{H}^{1}(\Omega)$中的误差估计\ref{4.73}。

![](https://cdn.mathpix.com/cropped/10058ab4e7f0c5bd6fe5bcd4db204623-100.jpg?height=379&width=531&top_left_y=124&top_left_x=185)

图4.16.例$4.2$中报告的问题的解决，线性（实线）和二次（蚀刻线）有限元在$h$准则下的误差行为（无横线）和在$\mathrm{L}^{2}(\Omega)$准则下的行为（有横线）。

备注4.7。上面说明的技术，取决于使用邻接问题来估计离散化误差的$\mathrm{L}^{2}$-norm，在文献中被称为Aubin-Nitsche技巧[Aub67, Nit68]。关于如何确定一个给定问题的邻接点的几个例子将在本节中介绍。  $3.5$ .

例4.2.我们考虑$-\Delta u+u=f$中的模型问题$\Omega=(0,1)^{2}$与$u=g$在$\partial \Omega$上。假设选择源项 $f$ 和函数 $g$ ，使问题的精确解为 $u(x, y)=\sin (2 \pi x) \cos (2 \pi y)$ 。我们用Galerkin方法解决这样的问题，在均匀网格上用1度和2度的有限元素，步长为$h$ 。图$4.16$显示了当网格尺寸$h$减小时的误差行为，包括在规范$\mathrm{L}^{2}(\Omega)$和$\mathrm{H}^{1}(\Omega)$中。通过检查图中线条的斜率可以看出，如果使用线性有限元（实线），使用$\mathrm{L}^{2}$规范（交叉线）时，误差的减少是二次的，而使用二次有限元（刻线）时，误差是三次的。

关于$\mathrm{H}^{1}$规范（没有交叉的线），相反，相对于线性有限元（实线），erorr有线性的减少，而当使用二次有限元（刻线）时，有二次的减少。图$4.17$显示了用线性（左）和二次（右）有限元得到的网格大小$1 / 8$上的解。

\subsection{Grid adaptivity}

在定理$4.6$和$4.7$中，我们得出了一些有限元近似误差的先验估计。
 ![](https://cdn.mathpix.com/cropped/10058ab4e7f0c5bd6fe5bcd4db204623-101.jpg?height=226&width=704&top_left_y=158&top_left_x=106)

图4.17.在网格大小为$1 / 8$的均匀网格上，使用分片线性（左）和分片二次（右）有限元计算的解决方案

由于参数$h$是有限元边的最大长度，如果我们参考\ref{4.72}，我们可能会想到处细化网格，希望能减少误差$\left\|u-u_{h}\right\|_{\mathrm{H}^{1}(\Omega)}$ 。然而，参考\ref{4.71}更为方便，其中的上界是涉及每个元素上的解半形$|u|_{\mathrm{H}^{r+1}(K)}$和局部网格大小$h_{K}$的元素贡献之和。

事实上，为了有一个高效的网格，使获得所需精度的元素数量最小化，我们可以在每个元素上等分误差 $K \in \mathscr{T}_{h}$ 。特别是，我们希望得到

!!!!
h_{K}^{r}|u|_{\mathrm{H}^{r+1}(K)} \simeq \eta \quad \forall K \in \mathscr{T}_{h}
$$

其中$\eta$是一个精心选择的常数，只取决于所需的精度和网格的元素数量。

来自$|u|_{\mathrm{H}^{r+1}(K)}$的较大贡献（由于$\left.u\right|_{K}$更明显的可变性）将需要通过较小的局部网格大小$h_{K}$或更高的多项式程度$r$来平衡。在第一种情况下，我们将谈论网格的$h$-adaptivity，在第二种情况下是$p$-adaptivity（其中$p$代表 "多项式"）。在本章的剩余部分，我们将只关注第一种技术。然而，对于更适合于多项式自适应的误差估计的分析，我们参考第10章。

到目前为止所做的评论虽然正确，但由于解$u$不知道，所以变成了没什么用处。因此，我们可以根据不同的策略来进行。第一个是使用先验误差估计\ref{4.71}，用一个精心选择的近似值代替精确解$u$，在每个单一元素上容易计算。在这种情况下，我们谈论的是先验适应性。

第二种方法是基于使用后验误差估计，能够将近似误差与近似数值解的行为联系起来$u_{h}$，在数值解出问题后知道。在这种情况下，最佳的计算网格将通过一个迭代过程来构建，在这个过程中，解决方案、误差估计和计算网格的修改被重新计算，直到达到要求的精度。在这种情况下，我们谈论的是后验适应性。先验和后验的适应性策略并不相互排斥，实际上它们可以共存。例如，在通过先验适应性产生了一个合适的起始网格后，可以通过后验分析进一步完善后者。

\subsubsection{A priori adaptivity based on derivatives reconstruction}

一个先验的适应性技术是基于估计\ref{4.71}，其中$u$的导数在每个元素上被仔细近似，目的是估计$u$的局部半形。为此，使用了一个近似解$u_{h^{*}}$，在暂定网格上计算，步长为$h^{*}$，$h^{*}$足够大，以便计算便宜，但不能太大，以免在导数的近似中产生过多的误差，影响整个程序的效果。

我们举例说明线性有限元的算法，在这种情况下，\ref{4.71}的形式为

!!!!
\left\|u-u_{h}\right\|_{\mathrm{H}^{1}(\Omega)} \leq C\left(\sum_{K \in \mathscr{T}_{h}} h_{K}^{2}|u|_{\mathrm{H}^{2}(K)}^{2}\right)^{\frac{1}{2}}
\label{4.83}\end{equation}

( $C$说明了双线性形式的连续性和矫顽力常数)。我们的目标是最终在网格$\mathscr{T}_{h}$上解决我们的问题，保证\ref{4.83}的右手边低于预定的公差$\varepsilon>0$。让我们假设我们已经计算了一个解决方案，例如$u_{h^{*}}$，在初步网格$\mathscr{T}_{h^{*}}$上有$N^{*}$个三角形。我们用$u_{h^{*}}$来近似计算$u$的二阶导数，这些二阶导数介入了半规则$|u|_{\mathrm{H}^{2}(K)}$的定义。由于$u_{h^{*}}$在$\Omega$中没有任何连续的二次导数，因此有必要采用适当的重建技术。对于网格的每个节点$\mathbf{N}_{i}$，我们认为共享$\mathbf{N}_{i}$的元素的集合（补丁）$K_{\mathbf{N}_{i}}$是一个节点（即形成$\varphi_{i}$支持的元素集合，见图4.12）。然后我们通过最小化找到平面$\pi_{i}^{j}(\mathbf{x})=\mathbf{a}_{i}^{j} \cdot \mathbf{x}+b_{i}^{j}$。

!!!!
\int_{K_{\mathbf{N}}_{i}}\left|\pi_{i}^{j}(\mathbf{x})-\frac{\partial u_{h^{*}}}{\partial x_{j}}(\mathbf{x})\right|^{2} d \mathbf{x}, \quad j=1,2
\label{4.84}\end{equation}


解决系数$\mathbf{a}_{i}^{j}$和$b_{i}^{j}$的两方程系统。这可以被看作是局部投影阶段。因此，我们建立一个梯度$\mathbf{g}_{h^{*}} \in\left(X_{h^{*}}^{1}\right)^{2}$的片状线性近似$\nabla u_{h^{*}}$，定义为

!!!!
\left[\mathbf{g}_{h^{*}}(\mathbf{x})\right]^{j}=\sum_{i} \pi_{i}^{j}\left(\mathbf{x}_{i}\right) \varphi_{i}(\mathbf{x}), \quad j=1,2,
\label{4.85}\end{equation}

其中总和跨越了网格的所有节点$\mathbf{N}_{i}$。一旦梯度被重建，我们可以用两种不同的方式进行，这取决于我们想要得到的二阶导数的重建类型。我们首先回顾一下，与函数$u$相关的Hessian矩阵由$\mathbf{D}^{2}(u)=\nabla(\nabla u)$定义，也就是

!!!!
\left[\mathbf{D}^{2}(u)\right]_{i, j}=\frac{\partial^{2} u}{\partial x_{i} \partial x_{j}}, \quad i, j=1,2
$$

通过对每个$K^{*} \in \mathscr{T}_{h^{*}}$设定，可以得到后者的片状常数近似值

!!!!
\left.\mathbf{D}_{h}^{2}\right|_{K^{*}}=\left.\frac{1}{2}\left(\nabla \mathbf{g}_{h^{*}}+\left(\nabla \mathbf{g}_{h^{*}}\right)^{T}\right)\right|_{K^{*}}
\label{4.86}\end{equation}

注意使用梯度的对称形式，这对Hessian对称性是必要的。

如果人们对Hessian的片状线性重建感兴趣，那么由\ref{4.84}和\ref{4.85}定义的相同的投影技术可以直接应用于重建的$\mathbf{g}_{h^{*}}$，然后通过\ref{4.86}对称以这种方式得到的矩阵。无论如何，我们现在能够在$\mathscr{T}_{h^{*}}$的一般三角形$K^{*}$上计算出$|u|_{\mathrm{H}^{2}\left(K^{*}\right)}$的近似值，这个近似值显然将与重构的$\mathbf{D}_{h}^{2}$相联系。

从\ref{4.83}我们推断，为了获得误差小于或等于预定公差$\varepsilon$的近似解$u_{h}$，我们必须构建一个新的网格$\mathscr{T}_{h}^{n e w}$，使得

!!!!
\sum_{K \in \mathscr{T}_{h}^{n e w}} h_{K}^{2}|u|_{\mathrm{H}^{2}(K)}^{2} \simeq \sum_{K \in \mathscr{T}_{h}^{n e w}} h_{K}^{2} \sum_{i, j=1}^{2}\left\|\left[\mathbf{D}_{h}^{2}\right]_{i j}\right\|_{\mathrm{L}^{2}(K)}^{2} \leq\left(\frac{\varepsilon}{C}\right)^{2}
$$

理想情况下，我们希望误差在新网格的每个元素$K$上都是平等分布的。

一个可能的适应程序包括通过适当地划分$N^{*}$的$K^{*}$的所有三角形来生成新的网格，对于这些三角形我们有

!!!!
\eta_{K^{*}}^{2}=h_{K^{*}}^{2} \sum_{i, j=1}^{2}\left\|\left[\mathbf{D}_{h}^{2}\right]_{i j}\right\|_{\mathrm{L}^{2}\left(K^{*}\right)}^{2}>\frac{1}{N^{*}}\left(\frac{\varepsilon}{C}\right)^{2}
\label{4.87}\end{equation}

这种方法可以说是一种细化，因为它只是为了建立一个比初始网格更细的网格，但它显然不允许完全满足等分条件。

更复杂的算法还允许在存在三角形的情况下解除网格的定义，对于这些三角形，不等式\ref{4.87}的验证符号是$\ll$（即远小于），而不是$>.$。然而，解除定义的程序比细化程序更难实现。因此，人们通常倾向于从头开始构建新的网格（这个程序被称为remeshing）。为此，在误差估计的基础上，引入了以下间距函数$H$（每个元素上的常数）。

!!!!
\left.H\right|_{K^{*}}=\frac{\varepsilon}{C \sqrt{N^{*}}\left(\sum_{i, j=1}^{2}\left\|\left[\mathbf{D}_{h}^{2}\right]_{i j}\right\|_{\mathrm{L}^{2}(K)}^{2}\right)^{1 / 2}\left|u_{h^{*}}\right|_{\mathrm{H}^{2}\left(K^{*}\right)}} \quad \forall K^{*} \in \mathscr{T}_{h^{*}}
\label{4.88}\end{equation}

并通过应用章节$6$中说明的网格生成算法之一来构建适应的网格。适应算法通常要求函数$H$在每个三角形上是连续和线性的。在这种情况下，我们可以再次求助于局部投影，如\ref{4.84}中的投影。

然后可以对在新网格上计算的解重复进行适应，直到不等式\ref{4.87}在所有的元素上都被倒置。
 ![](https://cdn.mathpix.com/cropped/10058ab4e7f0c5bd6fe5bcd4db204623-104.jpg?height=294&width=720&top_left_y=112&top_left_x=96)

图4.18.例$u$的函数（左）和第三个适应的网格（右）。

备注4.8。在不等式\ref{4.83}中出现的$C$常数可以通过对已知函数应用相同的不等式来估计（因此可以计算出精确的误差）。一个不需要明确知道$C$的替代方法包括实现平均分配误差的若干$N^{*}$的先验固定元素的网格。在这种情况下，通过设置$\varepsilon$和$C$为1，在 \ref{4.88}中计算出的$H$的值被重新缩放，乘以一个常数，这样新的网格就有一个先验固定元素的数量$N^{*}$。

例4.3.我们考虑域$u\left(x_{1}, x_{2}\right)=10 x_{1}^{3}+x_{2}^{3}+\tan ^{-1}\left(10^{-4} /\left(\sin \left(5 x_{2}\right)-\right.\right.!!!!\left.2 x_{1}\right)$上的函数$\Omega=(-1,1)^{2}$，该函数在曲线$x_{1}=0.5 \sin \left(x_{2}\right)$上有很强的梯度，从左边的图$4.18$可以看出。从一个由50个三角形构成的初始结构网格开始，使用由$u$的Hessian引导的自适应程序，经过3次迭代，我们得到了图$4.18$（右）中的网格，由3843个元素组成。大多数三角形位于函数跳变的附近：事实上，虽然在离跳变足够远的区域内，少数中大的表面三角形是描述$u$的必要条件，但$u$在不连续情况下的突然变化需要使用小的三角形，即减少离散化的网格大小。此外，我们注意到图4.18中网格的各向异性，可以看到有一些元素的形状相对于等边三角形（典型的各向异性网格）来说是非常舒展的。这种网格是通过将估计器\ref{4.87}推广到各向异性的情况下得到的。这个想法主要是为了利用由组件$\left[\mathbf{D}_{h}^{2}\right]_{i j}$单独提供的信息，而不是通过$\mathrm{L}^{2}\left(K^{*}\right)$准则 "混合 "它们。通过在各向同性的情况下使用相同的适应程序（即\ref{4.87}中的估计器），我们将在3次迭代后得到一个由10535个元素组成的适应网格。

\subsubsection{A posteriori adaptivity}

上一节描述的程序可能并不令人满意，因为从$u_{h^{*}}$开始重新构建$u$的导数时，往往会出现不容易量化的误差。一个激进的替代方案是采用对误差的后验估计。后者不利用先验估计\ref{4.71}（以及由此产生的未知解$u$的任何近似导数）。相反，它们是作为可计算量的函数得到的，通常基于近似解的所谓残差。

让我们考虑问题\ref{4.1}和它的Galerkin近似\ref{4.2}。我们定义残差$R \in V^{\prime}$为

!!!!
\langle R, v\rangle=F(v)-a\left(u_{h}, v\right) \quad \forall v \in V,
\label{4.89}\end{equation}

就是说

!!!!
\langle R, v\rangle=a\left(u-u_{h}, v\right) \quad \forall v \in V
\label{4.90}\end{equation}

那么

!!!!
\alpha\left\|u-u_{h}\right\|_{V} \leq\|R\|_{V^{\prime}} \leq M\left\|u-u_{h}\right\|_{V}
\label{4.91}\end{equation}


事实上，利用\ref{4.90}和$a(\cdot, \cdot)$的连续性,

!!!!
\|R\|_{V^{\prime}}=\sup _{v \in V} \frac{\langle R, v\rangle}{\|v\|_{V}} \leq M\left\|u-u_{h}\right\|_{V}
$$

另一方面，在\ref{4.90}中取$v=u-u_{h}$，并使用$a(\cdot, \cdot)$的矫捷性。

!!!!
\begin{aligned}
\alpha\left\|u-u_{h}\right\|_{V}^{2} & \leq a\left(u-u_{h}, u-u_{h}\right)=\left\langle R, u-u_{h}\right\rangle \\
& \leq\|R\|_{V^{\prime}}\left\|u-u_{h}\right\|_{V}
\end{aligned}
$$

因此，\ref{4.91}的第一个不等式。

现在我们的目标是用有限元三角化的每个元素$R$上的可计算量来表达$K$。为了便于说明，让我们考虑泊松问题\ref{3.13}作为一个例子。它的弱表述由\ref{3.18}给出，而它的近似使用有限元由\ref{4.40}描述，其中$V_{h}$是\ref{4.39}中定义的空间$X_{h}^{r}$。在这种特定情况下，$V=H_{0}^{1}(\Omega), V^{\prime}=H^{-1}(\Omega), \alpha=M=1$ 。利用Galerkin正交性，加上\ref{4.90}和\ref{4.89}，对于每个$v \in H_{0}^{1}(\Omega)$和每个$v_{h} \in V_{h}$，我们有

!!!!
\begin{aligned}
\langle R, v\rangle &=\int_{\Omega} \nabla\left(u-u_{h}\right) \cdot \nabla v d \Omega=\int_{\Omega} \nabla\left(u-u_{h}\right) \cdot \nabla\left(v-v_{h}\right) d \Omega \\
&=\int_{\Omega} f\left(v-v_{h}\right) d \Omega-\int_{\Omega} \nabla u_{h} \cdot \nabla\left(v-v_{h}\right) d \Omega \\
&=\int_{\Omega} f\left(v-v_{h}\right) d \Omega+\sum_{K \in \mathscr{T}} \int_{K} \Delta u_{h}\left(v-v_{h}\right) d \Omega-\sum_{K \in \mathscr{T}_{h}} \int_{\partial K} \frac{\partial u_{h}}{\partial n}\left(v-v_{h}\right) d \gamma \\
&=\sum_{K \in \mathscr{T}_{h}} \int_{K}\left(f+\Delta u_{h}\right)\left(v-v_{h}\right) d \Omega-\sum_{K \in \mathscr{T}_{h}} \int_{\partial K} \frac{\partial u_{h}}{\partial n}\left(v-v_{h}\right) d \gamma
\end{aligned}
\label{4.92}\end{equation}

我们观察到，所有的局部积分都有意义。

用$e$表示一般三角形$K$的一个边，我们定义$u_{h}$通过内边$e$的法向导数的跳跃量为

!!!!
\left[\frac{\partial u_{h}}{\partial n}\right]_{e}=\left.\nabla u_{h}\right|_{K_{1}} \cdot \mathbf{n}_{1}+\left.\nabla u_{h}\right|_{K_{2}} \cdot \mathbf{n}_{2}=\left(\left.\nabla u_{h}\right|_{K_{1}}-\left.\nabla u_{h}\right|_{K_{2}}\right) \cdot \mathbf{n}_{1}
\label{4.93}\end{equation}

其中$K_{1}$和$K_{2}$是共享边$e$的两个三角形，其法线出射单位向量分别由$\mathbf{n}_{1}$和$\mathbf{n}_{2}$给出，与$\mathbf{n}_{1}=-\mathbf{n}_{2}$（见图 4.19）。为了将这种定义扩展到边界边，我们引入了所谓的广义跳跃，由以下公式给出

!!!!
\left[\frac{\partial u_{h}}{\partial n}\right]= \begin{cases}{\left[\frac{\partial u_{h}}{\partial n}\right]_{e}} & \text { for } e \in \mathscr{E}_{h} \\ 0 & \text { for } e \in \partial \Omega\end{cases}
\label{4.94}\end{equation}

其中$\mathscr{E}_{h}$表示网格内侧的集合。我们注意到，在线性有限元的情况下，\ref{4.94}确定了一个定义在网格所有边上的片状常数函数 $\mathscr{T}_{h}$ 。此外，在问题(3.13)以不一定是Dirichlet类型的边界条件完成的情况下，\ref{4.94}的定义可以被适当地修改。

感谢\ref{4.94}，因此我们可以写出

!!!!
\begin{aligned}
&-\sum_{K \in \mathscr{T}_{h}} \int_{\partial K} \frac{\partial u_{h}}{\partial n}\left(v-v_{h}\right) d \gamma=-\sum_{K \in \mathscr{T}} \sum_{e \in \partial K} \int_{e} \frac{\partial u_{h}}{\partial n}\left(v-v_{h}\right) d \gamma \\
&=-\sum_{K \in \mathscr{T}_{h}} \sum_{e \in \partial K} \frac{1}{2} \int_{e}\left[\frac{\partial u_{h}}{\partial n}\right]\left(v-v_{h}\right) d \gamma=-\frac{1}{2} \sum_{K \in \mathscr{T}_{h}} \int_{\partial K}\left[\frac{\partial u_{h}}{\partial n}\right]\left(v-v_{h}\right) d \gamma
\end{aligned}
\label{4.95}\end{equation}

其中因子$1 / 2$考虑到网格的每个内侧$e$是由两个元素共享的事实。此外，由于$v-v_{h}=0$在边界上，在\ref{4.94}中我们可以在$e \in \partial \Omega$的存在下指定任何不同于零的值，因为\ref{4.95}中与边界边相关的项在任何情况下都是空的。

现在在\ref{4.92}中插入\ref{4.95}并应用考奇-施瓦茨不等式，我们

![](https://cdn.mathpix.com/cropped/10058ab4e7f0c5bd6fe5bcd4db204623-106.jpg?height=163&width=223&top_left_y=1014&top_left_x=345)

图4.19.通过内侧$u_{h}$的法向导数的跳跃定义中涉及的三角形得到

!!!!
\begin{aligned}
\langle R, v\rangle \leq \sum_{K \in \mathscr{T}_{h}}\left\{\left\|f+\Delta u_{h}\right\|_{\mathrm{L}^{2}(K)}\left\|v-v_{h}\right\|_{\mathrm{L}^{2}(K)}\right.\\
&\left.+\frac{1}{2}\left\|\left[\frac{\partial u_{h}}{\partial n}\right]\right\|_{\mathrm{L}^{2}(\partial K)}\left\|v-v_{h}\right\|_{\mathrm{L}^{2}(\partial K)}\right\}
\end{aligned}
\label{4.96}\end{equation}

现在我们寻找$v_{h} \in V_{h}$，它允许将$v-v_{h}$的规范表达为$v$的一个精心选择的规范的函数。此外，我们希望这个规范是 "局部的"，即在包含$K$的$\widetilde{K}$区域内计算，但尽可能少。如果$v$是连续的，我们可以把$v_{h}$作为$v$的拉格朗日内插，并使用之前引用的对$K$的内插误差估计。不幸的是，在我们的案例中$v \in \mathrm{H}^{1}(\Omega)$不一定是连续的。然而，如果$\mathscr{T}_{h}$是一个规则的网格，我们可以引入所谓的Clément插值算子$\mathscr{R}_{h}: \mathrm{H}^{1}(\Omega) \rightarrow V_{h}$，在线性有限元的情况下，定义如下

!!!!
\mathscr{R}_{h} v(\mathbf{x})=\sum_{\mathbf{N}_{j}}\left(P_{j} v\right)\left(\mathbf{N}_{j}\right) \varphi_{j}(\mathbf{x}) \quad \forall v \in \mathrm{H}^{1}(\Omega)
\label{4.97}\end{equation}

其中$P_{j} v$表示$v$的局部$L^{2}$投影。更确切地说，它是一个定义在共享节点$\mathbf{N}_{j}$的网格元素的补丁$K_{\mathbf{N}_{j}}$上的线性函数（见图4.20），它由以下关系确定

!!!!
\int_{K_{\mathrm{N}}_{j}}\left(P_{j} v-v\right) \psi d \mathbf{x}=0 \quad \text { for } \psi=1, x_{1}, x_{2}
$$

像往常一样，$\varphi_{j}$是被检查的有限元空间的特征拉格朗日基函数。

对于每个$v \in \mathrm{H}^{1}(\Omega)$和每个$K \in \mathscr{T}_{h}$，以下不等式成立（见，例如，[BG98, BS94, Clé75]）。

!!!!
\begin{aligned}
&\left\|v-\mathscr{R}_{h} v\right\|_{\mathrm{L}^{2}(K)} \leq C_{1} h_{K}|v|_{\mathrm{H}^{1}(\widetilde{K})}, \\
&\left\|v-\mathscr{R}_{h} v\right\|_{\mathrm{L}^{2}(\partial K)} \leq C_{2} h_{K}^{\frac{1}{2}}\|v\|_{\mathrm{H}^{1}(\widetilde{K})},
\end{aligned}
$$

其中$C_{1}$和$C_{2}$是两个正常数，取决于三角形元素的最小角度，而$\widetilde{K}=\left\{K_{j} \in \mathscr{T}_{h}: K_{j} \cap K \neq \emptyset\right\}$代表$K$与所有与之共享一条边或一个顶点的三角形的结合（见图4.20）。
 ![](https://cdn.mathpix.com/cropped/10058ab4e7f0c5bd6fe5bcd4db204623-107.jpg?height=142&width=510&top_left_y=1014&top_left_x=201)

图4.20.与$K$至少有一个网格节点的元素集合$\widetilde{K}$（左），以及共享节点$\mathbf{N}_{j}$的元素集合$K_{\mathbf{N}_{j}}$（中和右）。 对于$\mathscr{R}_{h} v$，我们可以使用局部斯科特-张插值算子，见[BS94, Sect. 4.8] 。其余的证明也将类似地进行。

通过在\ref{4.96}中选择$v_{h}=\mathscr{R}_{h} v$，设置$C=\max \left(C_{1}, C_{2}\right)$并使用离散的考奇-施瓦茨不等式，我们得到

!!!!
\begin{aligned}
\langle R, v\rangle & \leq C \sum_{K \in \mathscr{T}_{h}} \rho_{K}\left(u_{h}\right)\|v\|_{\mathrm{H}^{1}(\widetilde{K})} \\
& \leq C\left(\sum_{K \in \mathscr{T}_{h}}\left[\rho_{K}\left(u_{h}\right)\right]^{2}\right)^{\frac{1}{2}}\left(\sum_{K \in \mathscr{T}_{h}}\|v\|_{\mathrm{H}^{1}(\widetilde{K})}^{2}\right)^{\frac{1}{2}}
\end{aligned}
$$

我们用

!!!!
\rho_{K}\left(u_{h}\right)=h_{K}\left\|f+\Delta u_{h}\right\|_{\mathrm{L}^{2}(K)}+\frac{1}{2} h_{K}^{\frac{1}{2}}\left\|\left[\frac{\partial u_{h}}{\partial n}\right]\right\|_{\mathrm{L}^{2}(\partial K)}
\label{4.98}\end{equation}

所谓的局部残留，由内部残留$\left\|f+\Delta u_{h}\right\|_{\mathrm{L}^{2}(K)}$和边界残留$\left\|\left[\frac{\partial u_{h}}{\partial n}\right]\right\|_{\mathrm{L}^{2}(\partial K)}$构成。

我们现在观察到，由于$\mathscr{T}_{h}$是有规律的，$\widetilde{K}$中的元素数量必然被一个独立于$h$的正整数所限制，我们用$n$表示。因此。

!!!!
\|v\|_{H^{1}(\Omega)} \leq\left(\sum_{K \in \mathscr{T}_{h}}\|v\|_{\mathrm{H}^{1}(\widetilde{K})}^{2}\right)^{\frac{1}{2}} \leq \sqrt{n}\|v\|_{\mathrm{H}^{1}(\Omega)}
$$

因为Poincaré不等式\ref{2.13}。

!!!!
\|v\|_{H^{1}(\Omega)} \leq C\|v\|_{H_{0}^{1}(\Omega)}, \quad C=\sqrt{1+C_{\Omega}^{2}}
$$

(见属性$2.5$的证明)，因此

!!!!
\|R\|_{H^{-1}(\Omega)}=\sup _{v \in H_{0}^{1}(\Omega)} \frac{\langle R, v\rangle}{\|v\|_{H_{0}^{1}(\Omega)}} \leq C \sqrt{n}\left(\sum_{k \in \mathscr{T}_{h}}\left[\rho_{k}\left(u_{h}\right)\right]^{2}\right)^{\frac{1}{2}}
$$

由于\ref{4.91}的第一个不等式（以及$\alpha=1$在当前情况下的事实），我们得出以下基于残差的后验误差估计的结论

!!!!
\left\|u-u_{h}\right\|_{\mathrm{H}^{1}(\Omega)} \leq C \sqrt{n}\left(\sum_{K \in \mathscr{T}_{h}}\left[\rho_{K}\left(u_{h}\right)\right]^{2}\right)^{\frac{1}{2}}
$$

表4.2.与初始网格和前六个适应性网格相关的心数、相对误差和归一化估计器

\BEGIN{TABULARY}{CCCC}（开始）。
\hline iteration & $\mathscr{N}_{h}$ & $\left\|u-u_{h}\right\|_{\mathrm{H}^{1}(\Omega)} /\left\|u_{h}\right\|_{\mathrm{H}^{1}(\Omega)}$ & $\eta /\left\|u_{h}\right\|_{\mathrm{H}^{1}(\Omega)}$ 迭代。

1 & 645 & $0.3229$ & $3.2467$ 1 & 645 & $0.3229$ & $3.2467$ 2 & 1540 & $0.3229$ & $3.2467$ 2.



5 & 17753 & $0.0232$ & $0.2888$ （$0.2888$）。
6 & 35850 & $0.0163$ & $0.1955$ 6 & 35850
\hline
\end{tabular}

注意$\rho_{K}\left(u_{h}\right)$是一个有效的可计算量，是基准点$f$、几何参数$h_{K}$和计算出的解$u_{h}$的函数。这个分析中最微妙的一点是对常数$C$和$n$的不定期的估计。

例如，可以使用后验估计\ref{4.99}来保证

!!!!
\frac{1}{2} \varepsilon \leq \frac{\left\|u-u_{h}\right\|_{\mathrm{H}^{1}(\Omega)}}{\left\|u_{h}\right\|_{\mathrm{H}^{1}(\Omega)}} \leq \frac{3}{2} \varepsilon
\label{4.100}\end{equation}

$\varepsilon>0$是一个预先确定的公差。为此，通过图4.21所示的迭代程序，我们可以将网格$\mathscr{T}_{h}$局部变细变粗，直到对于每个$K$，都满足以下局部不等式

!!!!
\frac{1}{4} \frac{\varepsilon^{2}}{N}\left\|u_{h}\right\|_{\mathrm{H}^{1}(\Omega)}^{2} \leq\left[\rho_{K}\left(u_{h}\right)\right]^{2} \leq \frac{9}{4} \frac{\varepsilon^{2}}{N}\left\|u_{h}\right\|_{\mathrm{H}^{1}(\Omega)}^{2}
\label{4.101}\end{equation}

用$N$表示网格的元素数$\mathscr{T}_{h}$ 。这就保证了全局不等式\ref{4.100}得到满足，直到常数 $C \sqrt{n}$ 的贡献为止。另外，我们可以构建一个精心选择的网格间距函数$H$，类似于在第4.6.1节所做的。4.6.1.

当然，图$4.21$中报告的流程图也可用于与\ref{4.40}不同的边界值问题。

\subsubsection{Numerical examples of adaptivity}

我们在两个简单的微分问题上说明了网格适应性的概念。为此，我们采用了图4.21中报告的迭代程序，尽管我们将只限于细化阶段。粗化过程的实现比较困难：事实上，最常用的软件只允许细化初始网格，因此有必要将后者选择为适当的粗化。

最后，对于所报告的两个例子，离散化误差的参考估计器由\ref{4.99}的右边项表示。

![](https://cdn.mathpix.com/cropped/10058ab4e7f0c5bd6fe5bcd4db204623-110.jpg?height=726&width=577&top_left_y=113&top_left_x=165)

图4.21.迭代网格适应程序的例子

\section{First example}

让我们考虑 $\Omega=(-1,1)^{2}$ 中的问题 $-\Delta u=f$ ，在整个边界上有同质的迪里切条件 $\partial \Omega$ 。此外，我们选择了一个强制项 $f$ ，使得精确解为 $u\left(x_{1}, x_{2}\right)=\sin \left(\pi x_{1}\right) \sin \left(\pi x_{2}\right) \exp \left(10 x_{1}\right)$ 。我们从一个由324个元素组成的统一的初始网格开始适应性程序，公差为 $\varepsilon=0.2$ 。迭代程序在7次迭代后收敛。我们在图$4.22$中报告了初始网格和以这种方式获得的三个适应性网格，而表$4.2$总结了网格的元素数$\mathscr{A}_{h}$、相对误差$\left\|u-u_{h}\right\|_{\mathrm{H}^{1}(\Omega)} /\left\|u_{h}\right\|_{\mathrm{H}^{1}(\Omega)}$以及初始网格和前六个适应性网格的归一化估计器$\eta /\left\|u_{h}\right\|_{\mathrm{H}^{1}(\Omega)}$。

图$4.22$中的网格对所选择的适应性程序的可靠性提供了定性反馈：正如预期的那样，三角形倾向于集中在这些区域中
 ![](https://cdn.mathpix.com/cropped/10058ab4e7f0c5bd6fe5bcd4db204623-111.jpg?height=674&width=694&top_left_y=118&top_left_x=108)

图4.22.初始网格（左上）和在第二次（右上）、第三次（左下）和第五次（右下）迭代时通过选择图4.21的自适应程序调整的三个网格

其中$u$达到了极值。另一方面，表$4.2$中的数值也允许进行定量分析：当迭代次数增加时，相对误差和归一化估计值都会逐渐减少。然而，我们可以注意到相对于固定公差$\varepsilon$而言，平均高估了约$10-11$倍。这并不罕见，基本上可以解释为不等式\ref{4.100}和\ref{4.101}中的常数$C \sqrt{n}$被忽略了（即设置为1）。很明显，这样的选择实际上导致需要一个公差$\widetilde{\varepsilon}=\varepsilon /(C \sqrt{n})$，因此只有在我们有$C \sqrt{n} \sim 1$的情况下才会与原来的$\varepsilon$相吻合。更精确的程序，考虑到常数$C \sqrt{n}$，在任何情况下都可以从[BDR92, EJ88]中提供的（理论和数值）分析开始，例如。

\section{Second example}

让我们考虑$-\Delta u=0$在$\Omega=\left\{\mathbf{x}=r(\cos \theta, \sin \theta)^{T}, r \in(0,1), \quad \theta \in\right.!!!!\left.\left(0, \frac{3}{4} \pi\right)\right\}$中的问题，$u$分配在$\Omega$的边界上，因此$u(r, \theta)=r^{4 / 3} \sin \left(\frac{4}{3} \theta\right)$是
 ![](https://cdn.mathpix.com/cropped/10058ab4e7f0c5bd6fe5bcd4db204623-112.jpg?height=278&width=710&top_left_y=115&top_left_x=100)

图4.23.初始网格（左）和第二十次调整后的网格（右）。

![](https://cdn.mathpix.com/cropped/10058ab4e7f0c5bd6fe5bcd4db204623-112.jpg?height=277&width=350&top_left_y=495&top_left_x=100)
 ![](https://cdn.mathpix.com/cropped/10058ab4e7f0c5bd6fe5bcd4db204623-112.jpg?height=278&width=708&top_left_y=494&top_left_x=100tieth adapted grid (right)

准确的解决方案。这个函数在原点附近具有低规则性。假设我们通过Galerkin方法，在图4.23左边的准均匀网格上使用线性有限元对该问题进行近似，该网格由138个三角形组成。图$u_{h}$左边的隔离线的变形表明，以这种方式得到的解在原点附近是相当不准确的。我们现在使用估计器\ref{4.99}来生成一个适应的网格，它更适合于$u$的近似。通过遵循如图$4.21$所示的适应性程序，我们在20步之后得到了右图$4.23$中由859个三角形组成的网格。如右图$4.24$，与相应的离散解相关的隔离线表示更高的规则性，这证明了解的质量有所提高。作为比较，为了得到一个具有相同精度$\varepsilon$的解决方案，相对于误差的规范$H^{1}$（要求在均匀网格上等于$\left.0.01\right)$），需要2208个三角形。

\subsection{A posteriori error estimates in $\mathbf{L}^{2}$ norm}。

除了\ref{4.99}之外，还可以推导出$\mathrm{L}^{2}$准则下的误差的后验估计。为此，我们将再次求助于在第4.5.4节中使用的Aubin-Nitsche的对偶性技术。4.5.4节中使用的奥宾-尼采的对偶技术，特别是我们将考虑与泊松问题\ref{3.13}相关的邻接问题\ref{4.76}。此外，我们将假设域$\Omega$足够规则（例如，一个凸多边形），以保证定理$4.6$中所述的椭圆规则性结果\ref{4.74}为真。

此外，我们将利用以下与应用于函数$\Pi_{h}^{r}$的算子$v \in \mathrm{H}^{2}(\Omega)$相关的插值误差的局部估计。

!!!!
\left\|v-\Pi_{h}^{r} v\right\|_{\mathrm{L}^{2}(\partial K)} \leq \widetilde{C}_{1} h_{K}^{\frac{3}{2}}|v|_{\mathrm{H}^{2}(K)}
\label{4.102}\end{equation}

(见[BS94]或[Cia78]），以及

!!!!
\left\|v-\Pi_{h}^{r} v\right\|_{\mathrm{L}^{2}(K)} \leq \widetilde{C}_{2} h_{K}^{2}|v|_{\mathrm{H}^{2}(K)}
\label{4.103}\end{equation}

后面的不等式由\ref{4.67}得到。

从邻接问题\ref{4.76}开始，利用Galerkin正交性\ref{4.8}，我们有，对于每个$\phi_{h} \in V_{h}$ 。

!!!!
\left\|e_{h}\right\|_{\mathrm{L}^{2}(\Omega)}^{2}=\sum_{K \in \mathscr{T}_{h}} \int_{K} f\left(\phi-\phi_{h}\right) d \Omega-\sum_{K \in \mathscr{T}_{h}} \int_{K} \nabla u_{h} \cdot \nabla\left(\phi-\phi_{h}\right) d \Omega
$$

通过部分反积分，我们得到

!!!!
\left\|e_{h}\right\|_{\mathrm{L}^{2}(\Omega)}^{2}=\sum_{K \in \mathscr{T}_{h}} \int_{K}\left(f+\Delta u_{h}\right)\left(\phi-\phi_{h}\right) d \Omega-\sum_{K \in \mathscr{T}_{h}} \int_{\partial K} \frac{\partial u_{h}}{\partial n}\left(\phi-\phi_{h}\right) d \gamma
$$

使用$u_{h}$的法线导数跨越三角形边缘的广义跳跃的定义\ref{4.94}，并设定$\phi_{h}=\Pi_{h}^{r} \phi$，我们有

!!!!
\begin{aligned}
\left\|e_{h}\right\|_{\mathrm{L}^{2}(\Omega)}^{2}=& \sum_{K \in \mathscr{T}_{h}}\left[\int_{K}\left(f+\Delta u_{h}\right)\left(\phi-\Pi_{h}^{r} \phi\right) d \Omega\right.\\
&\left.-\frac{1}{2} \int_{\partial K}\left[\frac{\partial u_{h}}{\partial n}\right]\left(\phi-\Pi_{h}^{r} \phi\right) d \gamma\right]
\end{aligned}
\label{4.104}\end{equation}

我们分别估计右手边的两个项。通过使用考奇-施瓦茨不等式和\ref{4.103}，可以看出

!!!!
\begin{aligned}
\left|\int_{K}\left(f+\Delta u_{h}\right)\left(\phi-\Pi_{h}^{r} \phi\right) d \Omega\right| & \leq\left\|f+\Delta u_{h}\right\|_{\mathrm{L}^{2}(K)}\left\|\phi-\Pi_{h}^{r} \phi\right\|_{\mathrm{L}^{2}(K)} \\
& \leq \widetilde{C}_{2} h_{K}^{2}\left\|f+\Delta u_{h}\right\|_{\mathrm{L}^{2}(K)}|\phi|_{\mathrm{H}^{2}(K)}
\end{aligned}
\label{4.105}\end{equation}

此外，由于\ref{4.102}，我们可以得到

!!!!
\begin{aligned}
\left|\int_{\partial K}\left[\frac{\partial u_{h}}{\partial n}\right]\left(\phi-\Pi_{h}^{r} \phi\right) d \gamma\right| & \leq\left\|\left[\frac{\partial u_{h}}{\partial n}\right]\right\|_{L^{2}(\partial K)}\left\|\phi-\Pi_{h}^{r} \phi\right\|_{L^{2}(\partial K)} \\
& \leq \widetilde{C}_{1} h_{K}^{\frac{3}{2}}\left\|\left[\frac{\partial u_{h}}{\partial n}\right]\right\|_{L^{2}(\partial K)}|\phi|_{\mathrm{H}^{2}(K)}
\end{aligned}
\label{4.106}\end{equation}

现在将\ref{4.105}和\ref{4.106}插入\ref{4.104}中，并应用离散的Cauchy-Schwarz不等式，我们有

!!!!
\begin{aligned}
\left\|e_{h}\right\|_{\mathrm{L}^{2}(\Omega)}^{2} \leq C \sum_{K \in \mathscr{T}_{h}} h_{K} \rho_{K}\left(u_{h}\right)|\phi|_{\mathrm{H}^{2}(K)} & \leq C \sqrt{\sum_{K \in \mathscr{T}_{h}}\left[h_{K} \rho_{K}\left(u_{h}\right)\right]^{2}}|\phi|_{\mathrm{H}^{2}(\Omega)} \\
& \leq C \sqrt{\sum_{K \in \mathscr{T}_{h}}\left[h_{K} \rho_{K}\left(u_{h}\right)\right]^{2}}\left\|e_{h}\right\|_{\mathrm{L}^{2}(\Omega)}
\end{aligned}
$$

与$C=\max \left(\widetilde{C}_{1}, \widetilde{C}_{2}\right)$，在引入了符号\ref{4.98}并在最后一个不等式中利用了椭圆规律性属性\ref{4.80}。然后我们可以得出以下结论

!!!!
\left\|u-u_{h}\right\|_{\mathrm{L}^{2}(\Omega)} \leq C\left(\sum_{K \in \mathscr{T}_{h}} h_{K}^{2}\left[\rho_{K}\left(u_{h}\right)\right]^{2}\right)^{\frac{1}{2}}
\label{4.107}\end{equation}

$C>0$是一个独立于$h$的常数。

备注4.9。在工程中最广泛的后验估计中，我们引用了Zienkiewicz和Zhu在线性弹性问题的有限元近似背景下提出的估计器，因为它的简单性和计算的有效性 [ZZ87] 。这个估计器的基本思想非常简单。假设我们想控制与模型问题\ref{3.13} 的有限元近似相关的离散化误差的能量 $\operatorname{norm}\left(\int_{\Omega}\left|\nabla u-\nabla u_{h}\right|^{2} d \Omega\right)^{1 / 2}$ 。这个估计器用通过离散解的适当后处理得到的相应重构取代了后一准则中的精确梯度$\nabla u$。多年来，文献中提出了几种构建梯度的 "配方"$\nabla u$（例如，见[ZZ92, Rod94, PWY90, LW94, NZ04, BMMP06]）。第4.6.1节中说明的同样的程序导致4.6.1节中说明的导致\ref{4.85}中定义的重建的$\mathbf{g}_{h^{*}}$的相同程序可以用于此目的。因此，在选择了$G_{R}\left(u_{h}\right)$的重建后，Zienkiewicz和Zhu-type估计器由数量$\eta=\left(\int_{\Omega}\left|G_{R}\left(u_{h}\right)-\nabla u_{h}\right|^{2} d \Omega\right)^{1 / 2}$表示。显然，$G_{R}\left(u_{h}\right)$的每个新定义都对应着一个新的误差估计器。由于这个原因，具有这种结构的后验误差估计器通常被称为基于恢复的。

\subsubsection{A posteriori estimates of a functional of the error}

在上一节中，邻接问题\ref{4.76} 是以纯粹的形式使用的，因为代表其强制项的误差$e_{h}$是未知的。存在着另一个同样基于邻接问题的误差后验估计系列，相反，它明确地使用后者提供的信息（例如，见[Ran99]）。在这种情况下，对误差$J$的合适函数$e_{h}$提供估计，而不是对$e_{h}$的合适准则。当我们想为物理相关的量提供重要的误差估计时，这种特权就显得特别有用，例如，浸在液体中的物体的阻力或阻力，浓度的平均值，应变，变形，通量等。为此，对函数$J$进行适当的选择就可以了。这种类型的适应性被称为目标导向。为了说明这种新的范式，让我们仍然参考泊松问题\ref{3.13} ，并假设我们想控制一个给定的函数$J: H_{0}^{1}(\Omega) \rightarrow \mathbb{R}$的解的误差 $u$ 。让我们考虑相应的邻接问题的以下弱表述

!!!!
\text { find } \phi \in V: \quad \int_{\Omega} \nabla \phi \cdot \nabla w d \Omega=J(w) \quad \forall w \in V
\label{4.108}\end{equation}

与$V=\mathrm{H}_{0}^{1}(\Omega)$ 。通过使用Galerkin的正交性，并按上一节的方法进行，我们发现

!!!!
\begin{aligned}
J\left(e_{h}\right)=& \int_{\Omega} \nabla e_{h} \cdot \nabla \phi d \Omega=\sum_{K \in \mathscr{T}_{h}}\left[\int_{K}\left(f+\Delta u_{h}\right)\left(\phi-\phi_{h}\right) d \Omega\right.\\
&\left.-\frac{1}{2} \int_{\partial K}\left[\frac{\partial u_{h}}{\partial n}\right]\left(\phi-\phi_{h}\right) d \gamma\right],
\end{aligned}
\label{4.109}\end{equation}

其中$\phi_{h} \in V_{h}$通常是$\phi$的方便内插。通过对每个元素$K$使用Cauchy-Schwarz不等式，我们得到

!!!!
\begin{aligned}
\left|J\left(e_{h}\right)\right| &=\left|\int_{\Omega} \nabla e_{h} \cdot \nabla \phi d \Omega\right| \\
& \leq \sum_{K \in \mathscr{T}_{h}}\left(\left\|f+\Delta u_{h}\right\|_{\mathrm{L}^{2}(K)}\left\|\phi-\phi_{h}\right\|_{\mathrm{L}^{2}(K)}+\frac{1}{2}\left\|\left[\frac{\partial u_{h}}{\partial n}\right]\right\|_{\mathrm{L}^{2}(\partial K)}\left\|\phi-\phi_{h}\right\|_{\mathrm{L}^{2}(\partial K)}\right) \\
& \leq \sum_{K \in \mathscr{T}_{h}}\left[\rho_{K}\left(u_{h}\right) \max \left(\frac{1}{h_{K}}\left\|\phi-\phi_{h}\right\|_{\mathrm{L}^{2}(K)}, \frac{1}{h_{K}^{1 / 2}}\left\|\phi-\phi_{h}\right\|_{\mathrm{L}^{2}(\partial K)}\right)\right]
\end{aligned}
$$

$\rho_{K}\left(u_{h}\right)$是根据\ref{4.98} 定义的。我们现在介绍所谓的局部权重

!!!!
\omega_{K}(\phi)=\max \left(\frac{1}{h_{K}}\left\|\phi-\phi_{h}\right\|_{L^{2}(K)}, \frac{1}{h_{K}^{1 / 2}}\left\|\phi-\phi_{h}\right\|_{L^{2}(\partial K)}\right)
\label{4.110}\end{equation}

因此。

!!!!
\left|J\left(e_{h}\right)\right| \leq \sum_{K \in \mathscr{T}_{h}} \rho_{K}\left(u_{h}\right) \omega_{K}(\phi)
\label{4.111}\end{equation}

我们可以观察到，与第$4.6 .2$和$4.6 .4$节中介绍的残差型估计不同，\ref{4.111）不仅取决于离散解$u_{h}$，而且取决于解$4.6 .4$。  $4.6 .2$和$4.6 .4$中介绍的不同，估计\ref{4.111）不仅取决于离散解$u_{h}$，也取决于对偶问题的解$\phi$。特别是，在考虑了局部估计器$\rho_{K}\left(u_{h}\right) \omega_{K}(\phi)$之后，我们可以说，虽然残差$\rho_{K}\left(u_{h}\right)$衡量了离散解如何近似于所考察的微分问题，但权重$\omega_{K}(\phi)$考虑了这种信息如何作为所选函数的效果在域中传播。因此，对于不同的函数$J$的选择，即对于邻接问题\ref{4.108）的强制项的选择，即使我们从同一个微分问题开始，得到的网格也是不同的（更多细节，我们参考例13.12）。

此外，为了使估计\ref{4.111）有效，我们用合适的内插误差估计代替\ref{4.110）中的规范$\left\|\phi-\phi_{h}\right\|_{\mathrm{L}^{2}(K)}$和$\left\|\phi-\phi_{h}\right\|_{\mathrm{L}^{2}(\partial K)}$，选择$\phi_{h}$作为对偶解$\phi$的合适内插剂。

我们指出两个特殊情况。在\ref{4.108）中选择$J(w)=\int_{\Omega} w e_{h} d \Omega$，我们将再次找到$\mathrm{L}^{2}$离散化误差的估计值\ref{4.107），当然，前提是我们能保证在Lemma 4.6中陈述的椭圆规则性结果\ref{4.74} 是真实的。相反，如果我们对控制$e_{h}$在$\Omega$的某一点$\mathbf{x}$感兴趣，实际上只需将$J$定义为$J(w)=w^{\prime}\left\langle\delta_{\mathbf{x}}, w\right\rangle_{W}$，其中$W=\mathrm{H}_{0}^{1}(\Omega) \cap C^{0}(\bar{\Omega})$和$\delta_{\mathbf{x}}$是迪拉克在$\mathbf{x}$的三角函数（见第二章）。

备注4.10。本节的事后分析，以及前面几节的事后分析。4.6.2和4.6.4节的事后分析，可以扩展到更复杂的微分问题的情况，例如传输和扩散问题，以及更一般的边界条件（见例13.12）。这个过程基本上是一样的。变化的是局部残差\ref{4.98} 和广义跳变\ref{4.94} 的定义。事实上，虽然$\rho_{K}\left(u_{h}\right)$直接取决于所研究问题的微分公式，但$\left[\partial u_{h} / \partial n\right]$将需要考虑到边界上的条件。

对于到目前为止所提供的适应性技术的彻底描述，以及对其他可能的适应性技术的介绍，我们请读者参考[Ver96, Ran99, AO00]。

\subsection{练习}。

1. Heat transfer in a thin rod.

让我们考虑一个长度为$L$的细棒，在端点$x=0$处有温度$t_{0}$，在另一个端点$x=L$处有绝缘。我们假设杆的横截面有恒定的面积等于$A$，$A$的周长是$p$ 。那么杆子在一般点$x \in(0, L)$的温度$t$满足以下混合边界值问题。

!!!!
\begin{cases}-k A t^{\prime \prime}+\sigma p t=0, & x \in(0, L) \\ t(0)=t_{0}, & t^{\prime}(L)=0\end{cases}
\label{4.112}\end{equation}

用$k$表示导热系数，用$\sigma$表示对流传递系数。

验证这个问题的精确解是

!!!!
t(x)=t_{0} \frac{\cosh [m(L-x)]}{\cosh (m L)}
$$

与$m=\sqrt{\sigma p / k A}$ 。写出\ref{4.112}的弱表述，然后写出其Galerkin-finite element近似。说明$\mathrm{H}_{0}^{1}(0, L)$的近似误差如何取决于参数$k, \sigma, p$和$t_{0}$ 。

最后，使用均匀网格上的线性和二次有限元解决这个问题，然后评估近似误差。

2.两个平行板之间流体的温度。

我们考虑位于两个水平平行板之间的粘性流体，其距离为$2 H$ 。假设温度为 $t_{\text {sup }}$ 的上层板相对于温度为 $t_{i n f}$ 的下层板以 $U$ 的相对速度移动。在这种情况下，流体的温度$t:(0,2 H) \rightarrow \mathbb{R}$满足以下迪里希勒问题。

!!!!
\begin{cases}-\frac{d^{2} t}{d y^{2}}=\alpha(H-y)^{2}, & y \in(0,2 H) \\ t(0)=t_{i n f}, & t(2 H)=t_{s u p}\end{cases}
$$

其中$\alpha=\frac{4 U^{2} \mu}{H^{4} k}, k$为热导系数，$\mu$为流体的粘度。求精确解$t(y)$，然后写出弱公式和Galerkin有限元公式。

[解：准确的解是

!!!!
\left.t(y)=-\frac{\alpha}{12}(H-y)^{4}+\frac{t_{i n f}-t_{s u p}}{2 H}(H-y)+\frac{t_{i n f}+t_{s u p}}{2}+\frac{\alpha H^{4}}{12} .\right]
$$

3.绳子的变形。

让我们考虑一个张力$T$和单位长度的绳子，固定在两端。函数$u(x)$，测量绳子受到强度为$w$的横向电荷时的垂直位移，满足以下迪里希特问题。

!!!!
\begin{cases}-u^{\prime \prime}+\frac{k}{T} u=\frac{w}{T} & \text { in }(0,1) \\ u(0)=0, & u(1)=0\end{cases}
$$

用$k$表示绳子的弹性系数。写出弱公式和Galerkin-有限元公式。

4.证明属性 $4.1$ 。

[解：只要观察到$\left.a_{i j}=a\left(\varphi_{j}, \varphi_{i}\right) \forall i, j .\right]$就够了。

5.证明\ref{4.12}。
 ![](https://cdn.mathpix.com/cropped/10058ab4e7f0c5bd6fe5bcd4db204623-118.jpg?height=334&width=688&top_left_y=118&top_left_x=113)

图4.25.左图：Galerkin有限元矩阵的稀疏模式，与一维泊松问题的二次有限元的10元离散化有关。未知数的编号与练习6中的解释相同。右图：$\mathrm{L}$和$A$的U因子的模式。请注意，由于填充的原因，非空有限元的数量从矩阵中的81个增加到因子中的141个

[解：由于形式是对称的，可以重复备注$3.2$中的程序，注意到解$u_{h}$对每个$v_{h} \in V_{h}$都满足$a\left(u_{h}, v_{h}\right)=a\left(u, v_{h}\right)$。因此，我们推断$u_{h}$最小化了$J\left(v_{h}\right)=a\left(v_{h}, v_{h}\right)-2 a\left(u, v_{h}\right)$，因此也最小化了$J^{*}\left(v_{h}\right)=J\left(v_{h}\right)+a(u, u)=a\left(u-v_{h}, u-v_{h}\right)$（由于双线性形式的对称性，最后一个平等是可能的）。在另一方面。

!!!!
\sqrt{\alpha}\left\|u-v_{h}\right\|_{V} \leq \sqrt{a\left(u-v_{h}, u-v_{h}\right)} \leq \sqrt{M}\left\|u-v_{h}\right\|_{V}
$$

因此得到了预期的结果] 。

6.给定一个区间$(a, b)$划分为$N+1$个子区间，假设首先对单个子区间的端点进行编号，然后对其中点进行编号。这种标记是否比$4.3$节中介绍的标记更方便或更不方便？  $4.3$中介绍的用有限元离散化泊松问题的方法更方便还是不方便？假设用因子化方法解决线性系统。

[解：得到的矩阵仍然只有五条对角线与零不同，因为使用第4节中提出的编号得到的矩阵。4.3.然而，它具有更高的带宽。因此，在对其进行因子化的情况下，它将受到更大的填充，如图4.25所示。]

7.考虑以下一维边界值问题。

!!!!
\begin{cases}-\left(\alpha u^{\prime}\right)^{\prime}+\gamma u=f, & 0<x<1 \\ u=0 & \text { at } x=0 \\ \alpha u^{\prime}+\delta u=0 & \text { at } x=1\end{cases}
$$

其中$\alpha=\alpha(x), \gamma=\gamma(x), f=f(x)$是指定的函数，有$0 \leq \gamma(x) \leq \gamma_{1}$和$0<\alpha_{0} \leq \alpha(x) \leq \alpha_{1} \forall x \in[0,1]$ ，而$\delta \in \mathbb{R}$ 。此外，假设$f \in \mathrm{L}^{2}(0,1)$ 写出问题的弱表述，指定适当的函数空间和对数据的假设，以保证解决方案的存在和唯一性。假设用线性有限元法找到一个近似解 $u_{h}$ 。关于$u_{h} ?$的存在性、稳定性和准确性，可以说什么呢[解：我们寻求$u \in V=\left\{v \in \mathrm{H}^{1}(0,1): v(0)=0\right\}$，以便$a(u, v)=F(v)!!!!\forall v \in V$，其中

!!!!
a(u, v)=\int_{0}^{1} \alpha u^{\prime} v^{\prime} d x+\int_{0}^{1} \gamma u v d x+\delta u(1) v(1), \quad F(v)=\int_{0}^{1} f v d x
$$

如果拉克斯-米尔格拉姆（Lax-Milgram）定理的假设成立，弱问题的解的存在性和唯一性就得到了保证。形式$a(\cdot, \cdot)$是连续的，因为我们有

!!!!
|a(u, v)| \leq 2 \max \left(\alpha_{1}, \gamma_{1}\right)\|u\|_{V}\|v\|_{V}+|\delta||v(1)||u(1)|,
$$

考虑到$u(1)=\int_{0}^{1} u^{\prime} d x$，我们从中可以得到

!!!!
|a(u, v)| \leq M\|u\|_{V}\|v\|_{V} \quad \text { with } M=3 \max \left(\alpha_{1}, \gamma_{1},|\delta|\right) .
$$

如果$\delta \geq 0$，我们有矫顽力，因为在这种情况下我们发现

!!!!
a(u, u) \geq \alpha_{0}\left\|u^{\prime}\right\|_{\mathrm{L}^{2}(0,1)}^{2}+u^{2}(1) \delta \geq \alpha_{0}\left\|u^{\prime}\right\|_{\mathrm{L}^{2}(0,1)}^{2}
$$

为了找到$\|\cdot\|_{V}$中的不等式，援引Poincaré不等式$(2.13)$，只需证明

!!!!
\frac{1}{1+C_{\Omega}^{2}}\|u\|_{V}^{2} \leq\left\|u^{\prime}\right\|_{\mathrm{L}^{2}(0,1)}^{2}
$$

然后得出结论：

!!!!
a(u, u) \geq \alpha^{*}\|u\|_{V}^{2} \quad \text { with } \alpha^{*}=\frac{\alpha_{0}}{1+C_{\Omega}^{2}}
$$

$F$是一个线性和连续的函数，这一事实可以立即得到验证。有限元方法是一种Galerkin方法，$V_{h}=\left\{v_{h} \in X_{h}^{1}: v_{h}(0)=0\right\}$ 。因此，由于推论$4.1,4.2$，我们推断出解$u_{h}$存在并且是唯一的。从估计\ref{4.72}我们进一步推断，由于$r=1$，以$V$的规范测量的误差将线性地趋于零，相对于$h .]$而言。

8.考虑以下二维边界值问题。

!!!!
\left\{\begin{array}{lll}
-\operatorname{div}(\alpha \nabla u)+\gamma u=f & \text { in } \Omega \subset \mathbb{R}^{2} \\
u=0 & & \text { on } \Gamma_{D} \\
\alpha \nabla u \cdot \mathbf{n}=0 & & \text { on } \Gamma_{N}
\end{array}\right.
$$

$\Omega$是一个有边界的开放域，有规则的边界$\partial \Omega=\Gamma_{D} \cup \Gamma_{N}$，有$\stackrel{\circ}{\Gamma_{D}} \cap \stackrel{\circ}{\Gamma_{N}}=\emptyset$和单位外向法线$\mathbf{n} ; \alpha \in \mathrm{L}^{\infty}(\Omega), \gamma \in \mathrm{L}^{\infty}(\Omega)$，和$f \in \mathrm{L}^{2}(\Omega)$是三个分配函数，在$\gamma(\mathbf{x}) \geq 0$和$0<\alpha_{0} \leq \alpha(\mathbf{x})$中为等值。

分析弱解的存在性和唯一性以及用Galerkin方法得到的解的稳定性。假设 $u \in \mathrm{H}^{4}(\Omega)$ .使用哪种多项式的度数会比较方便?

[解：弱问题包括找到$u \in V=\mathrm{H}_{\Gamma_{D}}^{1}$，使$a(u, v)=!!!!F(v) \forall v \in V$ ，其中

!!!!
a(u, v)=\int_{\Omega} \alpha \nabla u \nabla v d \Omega+\int_{\Omega} \gamma u v d \Omega, \quad F(v)=\int_{\Omega} f v d \Omega
$$

双线性形式是连续的；事实上

!!!!
\begin{aligned}
|a(u, v)| & \leq \int_{\Omega} \alpha|\nabla u||\nabla v| d \Omega+\int_{\Omega}|\gamma||u||v| d \Omega \\
& \leq\|\alpha\|_{L^{\infty}(\Omega)}\|\nabla u\|_{L^{2}(\Omega)}\|\nabla v\|_{L^{2}(\Omega)}+\|\gamma\|_{L^{\infty}(\Omega)}\|u\|_{L^{2}(\Omega)}\|v\|_{L^{2}(\Omega)} \\
& \leq M\|u\|_{V}\|v\|_{V}
\end{aligned}
$$

已取 $M=2 \max \left\{\|\alpha\|_{L^{\infty}(\Omega)},\|\gamma\|_{L^{\infty}(\Omega)}\right\}$ 。此外，它是coercive的（见练习七的解答），coercive常数由$\alpha^{*}=\frac{\alpha_{0}}{1+C_{\Omega}^{2}}$给出。由于$F$是一个线性和有界函数，由于Lax-Milgram法则，弱解存在并且是唯一的。就Galerkin方法而言，我们引入$V_{h}$的一个有限维度的子空间$V$。然后存在一个Galerkin问题的唯一解$u_{h}$：找到$u_{h} \in V_{h}$，使$a\left(u_{h}, v_{h}\right)=F\left(v_{h}\right) \forall v_{h} \in V_{h}$ 。此外，根据推论$4.2$我们有稳定性。至于最佳多项式度数$r$的选择，只需注意到\ref{4.26}中出现的指数$s$是$r$和$p=3$之间的最小值。因此，使用度数$3 .]$的元素将很方便。

有限元代码的基本步骤可以归纳为以下几点。

(a) 输入数据。

(b) 建立网格$\mathscr{T}_{h}=\{K\}$ 。

(c) 建立局部矩阵 $A_{K}$ 和右手边元素 $f_{K}$ 。

(d) 将全局矩阵$A$和源项的矩阵$\mathbf{f} ;$组合起来

(e) 解决线性系统 $A \mathbf{u}=\mathbf{f}$ 。

(f) 对结果进行后处理。

假设我们使用线性有限元，考虑图4.26中的元素补丁。

a) 参照步骤(c)和(d)，明确写出矩阵$T_{K}$，允许通过$T_{K}^{T} A_{K} T_{K}$这种变换从局部矩阵$A_{K}$传递到整体矩阵$A$。$T_{K}$的尺寸是多少？

b) 与图4.26中的元素斑块相关的矩阵$A$的稀疏模式是什么？

![](https://cdn.mathpix.com/cropped/10058ab4e7f0c5bd6fe5bcd4db204623-121.jpg?height=219&width=261&top_left_y=116&top_left_x=326)

图4.26.用于组装全局矩阵的元素补丁$A

c) 将矩阵A的元素明确写成本地矩阵元素的函数 $A_{K}$ 。

d) 在一般网格$\mathscr{T}_{h}$有$\mathrm{N}_{\mathrm{V}}$个顶点和$\mathrm{N}_{\mathrm{T}}$个三角形的情况下，在线性和二次有限元的情况下，全局矩阵$A$分别有多少维？

关于这个问题的更详尽的处理，我们可以参考第 $12$ 章。

9.用拉格朗日特性\ref{3.42} 来证明表$3.1$中总结的结果。

\section{Parabolic equations}

在这一章中，我们考虑的抛物线方程形式为

!!!!
\frac{\partial u}{\partial t}+L u=f, \quad \mathbf{x} \in \Omega, t>0
\label{5.1}\end{equation}

其中$\Omega$是$\mathbb{R}^{d}, d=1,2,3, f=f(\mathbf{x}, t)$的一个域，是一个给定的函数，$L=L(\mathbf{x})$是作用于未知数$u=u(\mathbf{x}, t)$的通用椭圆算子。当只对一个有界的时间间隔求解时，例如对$0<t<T$，$Q_{T}=\Omega \times(0, T)$区域被称为空间$\mathbb{R}^{d} \times \mathbb{R}^{+}$中的圆柱体（见图5.1）。在$T=+\infty, Q=\{(\mathbf{x}, t):!!!!\mathbf{x} \in \Omega, t>0\}$的情况下，将是一个无限的圆柱体。

方程\ref{5.1} 必须通过指定一个初始条件来完成

!!!!
u(\mathbf{x}, 0)=u_{0}(\mathbf{x}), \quad \mathbf{x} \in \Omega
\label{5.2}\end{equation}

![](https://cdn.mathpix.com/cropped/10058ab4e7f0c5bd6fe5bcd4db204623-122.jpg?height=274&width=334&top_left_y=842&top_left_x=294)

图5.1.缸体$Q_{T}=\Omega \times(0, T), \Omega \subset \mathbb{R}^{2}

连同边界条件，可以采取以下形式。

!!!!
\begin{array}{lrl}
u(\mathbf{x}, t)=\varphi(\mathbf{x}, t), & \mathbf{x} & \in \Gamma_{D} \text { and } t>0 \\
\frac{\partial u(\mathbf{x}, t)}{\partial n}=\psi(\mathbf{x}, t), & & \mathbf{x} \in \Gamma_{N} \text { and } t>0
\end{array}
\label{5.3}\end{equation}

其中$u_{0}, \varphi$和$\psi$是给定的函数，$\left\{\Gamma_{D}, \Gamma_{N}\right\}$提供一个边界分区，即$\Gamma_{D} \cup \Gamma_{N}=\partial \Omega, \stackrel{\circ}{\Gamma_{D}} \cap \stackrel{\circ}{\Gamma_{N}}=\emptyset$ 。由于明显的原因，$\Gamma_{D}$被称为迪里希特边界，$\Gamma_{N}$为诺伊曼边界。

在一维的情况下，这个问题。

!!!!
\begin{aligned}
&\frac{\partial u}{\partial t}-v \frac{\partial^{2} u}{\partial x^{2}}=f, \quad 0<x<d, \quad t>0 \\
&u(x, 0)=u_{0}(x), \quad 0<x<d \\
&u(0, t)=u(d, t)=0, \quad t>0
\end{aligned}
\label{5.4}\end{equation}

描述了长度为$d$的金属棒在$x$点和时间$t$的温度$u(x, t)$的变化，其热导率为$v$，其端点保持在零度的恒温下。函数$u_{0}$描述了初始温度，而$f$表示棒子产生的热量（每单位长度）。由于这个原因，\ref{5.4} 被称为热方程。对于一个特殊的案例，见第一章的例$1.5$ 。

\subsection{Weak formulation and its approximation}

为了数值解决\ref{5.1}-\ref{5.3}问题，我们将引入一个弱公式，就像我们处理椭圆问题那样。

我们通过对每个$t>0$的微分方程乘以测试函数$v=v(\mathbf{x})$并对$\Omega$进行积分来正式进行。我们设定$V=\mathrm{H}_{\Gamma_{D}}^{1}(\Omega)$（见$\left.(3.26)\right)$，对于每个$t>0$我们寻求$u(t) \in V$，以便

!!!!
\int_{\Omega} \frac{\partial u(t)}{\partial t} v d \Omega+a(u(t), v)=\int_{\Omega} f(t) v d \Omega \quad \forall v \in V
\label{5.5}\end{equation}

其中$u(0)=u_{0}, a(\cdot, \cdot)$是与椭圆算子$L$相关的双线性形式，为简单起见，我们假定$\varphi=0$和$\psi=0$。在$\varphi \neq 0$和$\psi \neq 0$的情况下，\ref{5.5}的修改留给读者。

问题\ref{5.5}的解的存在性和唯一性的充分条件是，以下假设成立。

双线性形式$a(\cdot, \cdot)$是连续的和弱强制性的，也就是

!!!!
\exists \lambda \geq 0, \exists \alpha>0: \quad a(v, v)+\lambda\|v\|_{\mathrm{L}^{2}(\Omega)}^{2} \geq \alpha\|v\|_{V}^{2} \quad \forall v \in V
$$

对$\lambda=0$来说，产生了标准的矫捷性定义。此外，我们要求$u_{0} \in \mathrm{L}^{2}(\Omega)$和$f \in \mathrm{L}^{2}(Q)$ 。然后，问题\ref{5.5} 有一个唯一的解决方案$u \in \mathrm{L}^{2}\left(\mathbb{R}^{+} ; V\right) \cap C^{0}\left(\mathbb{R}^{+} ; \mathrm{L}^{2}(\Omega)\right)$ ，其中$V=\mathrm{H}_{\Gamma_{D}}^{1}(\Omega)$ 是唯一的。

关于这些函数空间的定义，见第2.7节。关于证明，见[QV94，第11.1.1节]。

下一节将提供一些对解$u$的先验估计。

我们现在考虑问题\ref{5.5} 的Galerkin近似：对于每个$t>0$，找到$u_{h}(t) \in V_{h}$，以便

!!!!
\int_{\Omega} \frac{\partial u_{h}(t)}{\partial t} v_{h} d \Omega+a\left(u_{h}(t), v_{h}\right)=\int_{\Omega} f(t) v_{h} d \Omega \quad \forall v_{h} \in V_{h}
\label{5.6}\end{equation}

与$u_{h}(0)=u_{0 h}$，其中$V_{h} \subset V$是一个合适的有限维空间，$u_{0 h}$是$V_{h}$空间中$u_{0}$的方便近似。这样的问题被称为\ref{5.5} 的半离散化，因为时间变量还没有被离散化。

为了提供\ref{5.6}的代数解释，我们为$V_{h}$引入了一个基$\left\{\varphi_{j}\right\}$（正如我们在前几章所做的那样），我们观察到，为了被子空间的所有函数所满足，\ref{5.6}对于基函数来说足以被验证。此外，由于对于每个$t>0$，Galerkin问题的解也属于子空间，我们将有

!!!!
u_{h}(\mathbf{x}, t)=\sum_{j=1}^{N_{h}} u_{j}(t) \varphi_{j}(\mathbf{x})
$$

其中系数$\left\{u_{j}(t)\right\}$代表问题\ref{5.6}的未知数

用$\dot{u}_{j}(t)$表示函数$u_{j}(t)$关于时间的导数，\ref{5.6}成为

!!!!
\int_{\Omega} \sum_{j=1}^{N_{h}} \dot{u}_{j}(t) \varphi_{j} \varphi_{i} d \Omega+a\left(\sum_{j=1}^{N_{h}} u_{j}(t) \varphi_{j}, \varphi_{i}\right)=\int_{\Omega} f(t) \phi_{i} d \Omega, \quad i=1,2, \ldots, N_{h}
$$

就是说

!!!!
\sum_{j=1}^{N_{h}} \dot{u}_{j}(t) \underbrace{\int_{\Omega} \varphi_{j} \varphi_{i} d \Omega}_{m_{i j}}+\sum_{j=1}^{N_{h}} u_{j}(t) \underbrace{a\left(\varphi_{j}, \varphi_{i}\right)}_{a_{i j}}=\underbrace{\int_{\Omega} f(t) \phi_{i} d \Omega}_{f_{i}(t)}, \quad i=1,2, \ldots, N_{h}
\label{5.7}\end{equation!!!!}

如果我们定义未知数向量$\mathbf{u}=\left(u_{1}(t), u_{2}(t), \ldots, u_{N_{h}}(t)\right)^{T}$，质量$m a-$三者$\mathrm{M}=\left[m_{i j}\right]$，刚度矩阵$\mathrm{A}=\left[a_{i j}\right]$和右手向量$\mathbf{f}=!!!!\left(f_{1}(t), f_{2}(t), \ldots, f_{N_{h}}(t)\right)^{T}$，系统\ref{5.7} 可以以矩阵形式重写为

!!!!
\mathbf{M \dot { u }}(t)+\mathbf{A u}(t)=\mathbf{f}(t)
$$

对于这个ODE系统的数值解，有许多有限差分方法。例如，见[QSS07，第11章]。这里我们只考虑所谓的$\theta$方法。后者通过简单的差分商离散时间导数，并用时间$t^{k}$和时间$t^{k+1}$的线性组合代替其他项，取决于实参$\theta(0 \leq \theta \leq 1)$。

!!!!
\mathrm{M} \frac{\mathbf{u}^{k+1}-\mathbf{u}^{k}}{\Delta t}+\mathrm{A}\left[\theta \mathbf{u}^{k+1}+(1-\theta) \mathbf{u}^{k}\right]=\theta \mathbf{f}^{k+1}+(1-\theta) \mathbf{f}^{k}
\label{5.8}\end{equation}

通常，实正参数$\Delta t=t^{k+1}-t^{k}, k=0,1, \ldots$，表示离散化步骤（这里假定为常数），而上标$k$表示所考虑的量是指时间$t^{k}$。让我们看看\ref{5.8}:$的一些特殊情况

- 对于$\theta=0$我们得到正向欧拉（或显式欧拉）方法

!!!!
\mathrm{M} \frac{\mathbf{u}^{k+1}-\mathbf{u}^{k}}{\Delta t}+\mathrm{A} \mathbf{u}^{k}=\mathbf{f}^{k}
$$

对于$\Delta t$来说，其准确度为1阶。

- 对于$\theta=1$，我们有后向欧拉（或隐式欧拉）方法

!!!!
\mathrm{M} \frac{\mathbf{u}^{k+1}-\mathbf{u}^{k}}{\Delta t}+\mathrm{A} \mathbf{u}^{k+1}=\mathbf{f}^{k+1}
$$

关于$\Delta t$也是一阶的。

- 对于$\theta=1 / 2$，我们有Crank-Nicolson（或梯形）方法

!!!!
\mathrm{M} \frac{\mathbf{u}^{k+1}-\mathbf{u}^{k}}{\Delta t}+\frac{1}{2} \mathrm{~A}\left(\mathbf{u}^{k+1}+\mathbf{u}^{k}\right)=\frac{1}{2}\left(\mathbf{f}^{k+1}+\mathbf{f}^{k}\right)
$$

在$\Delta t$中是二阶的。（更准确地说，$\theta=1 / 2$是我们获得二阶方法的唯一数值）。

让我们考虑两个极端的情况，$\theta=0$和$\theta=1$ 。对于这两种情况，我们得到一个线性方程组：如果$\theta=0$，要解决的系统有矩阵$\frac{\mathrm{M}}{\Delta t}$，在第二种情况下，它有矩阵$\frac{M}{\Delta t}+A$ 。我们观察到，M矩阵是可逆的，是正定的（见练习1）。

在$\theta=0$的情况下，如果我们使$\mathrm{M}$成为对角线，我们实际上是将系统解耦。这个操作是通过所谓的质量矩阵的凑合来进行的（见第13.5节）。然而，这个方案不是无条件稳定的（见第5.4节），在$V_{h}$是有限元的子空间的情况下，我们有以下稳定条件（见第$5.4$节）。

!!!!
\exists c>0: \Delta t \leq c h^{2} \quad \forall h>0
$$

所以$\Delta t$的选择不能与$h$无关。

在$\theta>0$的情况下，系统将具有$K \mathbf{u}^{k+1}=\mathbf{g}$的形式，其中$\mathbf{g}$是源项，$\mathrm{K}=\frac{\mathrm{M}}{\Delta t}+\theta \mathrm{A}$ 。然而，这样的矩阵在时间上是不变的（算子$L$，因此矩阵A是独立于时间的）；如果空间网状结构不改变，那么它可以在过程开始时被一次性地分解。由于$\mathrm{M}$是对称的，如果$\mathrm{A}$也是对称的，与系统相关的$\mathrm{K}$矩阵
 ![](https://cdn.mathpix.com/cropped/10058ab4e7f0c5bd6fe5bcd4db204623-126.jpg?height=246&width=712&top_left_y=113&top_left_x=102)

图5.2.例$5.1$问题的热方程解法

也将是对称的。因此，我们可以使用，例如，Cholesky分解法，$\mathrm{K}=\mathrm{H} \mathrm{H}^{T}, \mathrm{H}$是下三角。因此，在每个时间步骤中，我们将不得不解决$N_{h}$未知数的两个三角形系统。

!!!!
\begin{aligned}
&\mathrm{Hy}=\mathbf{g} \\
&\mathrm{H}^{T} \mathbf{u}^{k+1}=\mathbf{y}
\end{aligned}
$$

(见第7章和[QSS07，第3章]）。)

例5.1.让我们假设在图$5.2$（左）的域$\Omega \subset \mathbb{R}^{2}$上求解热方程$\frac{\partial u}{\partial t}-0.1 \Delta u=0$，它是半径为$0.5$、中心为$(-0.5,0)$的两个圆的联合。我们在整个边界上指定迪里希特条件，对$u(\mathbf{x}, t)=1$上的点采取$x_{1} \geq 0$和$u(\mathbf{x}, t)=0$，如果$x_{1}<0$的初始条件为$u(\mathbf{x}, 0)=1$，其他地方为空。在图$5.2$中，我们报告了在时间$t=1$得到的解。我们在空间上使用了线性有限元，在时间上使用了隐式欧拉方法$\Delta t=0.01$ 。可以看出，根据边界条件，初始不连续性已经被规范化。

\subsection{A priori estimates}

让我们考虑问题\ref{5.5} ；因为相应的方程必须对每个$v \in V$都成立，所以设置$v=u(t)$（$t$是给定的）是合法的，问题本身的解，产生了

!!!!
\int_{\Omega} \frac{\partial u(t)}{\partial t} u(t) d \Omega+a(u(t), u(t))=\int_{\Omega} f(t) u(t) d \Omega \quad \forall t>0
\label{5.9}\end{equation}

考虑到各个条款，我们有

!!!!
\int_{\Omega} \frac{\partial u(t)}{\partial t} u(t) d \Omega=\frac{1}{2} \frac{\partial}{\partial t} \int_{\Omega}|u(t)|^{2} d \Omega=\frac{1}{2} \frac{\partial}{\partial t}\|u(t)\|_{L^{2}(\Omega)}^{2}
\label{5.10}\end{equation}

如果我们为简单起见，假设双线性形式是coercive的（coercive常数等于$\alpha$），我们得到

!!!!
a(u(t), u(t)) \geq \alpha\|u(t)\|_{V}^{2}
$$

而由于考奇-施瓦茨不等式，我们发现

!!!!
(f(t), u(t)) \leq\|f(t)\|_{\mathrm{L}^{2}(\Omega)}\|u(t)\|_{\mathrm{L}^{2}(\Omega)}
\label{5.11}\end{equation}

在其余部分，我们将经常使用杨氏不等式

!!!!
\forall a, b \in \mathbb{R}, \quad a b \leq \varepsilon a^{2}+\frac{1}{4 \varepsilon} b^{2} \quad \forall \varepsilon>0
\label{5.12}\end{equation}

这是从基本的不等式降下来的

!!!!
\left(\sqrt{\varepsilon} a-\frac{1}{2 \sqrt{\varepsilon}} b\right)^{2} \geq 0
$$

首先使用Poincaré的不等式\ref{2.13}和杨氏不等式，我们得到

!!!!
\begin{aligned}
\frac{1}{2} \frac{d}{d t}\|u(t)\|_{L^{2}(\Omega)}^{2}+\alpha\|\nabla u(t)\|_{L^{2}(\Omega)}^{2} & \leq\|f(t)\|_{L^{2}(\Omega)}\|u(t)\|_{L^{2}(\Omega)} \\
& \leq \frac{C_{\Omega}^{2}}{2 \alpha}\|f(t)\|_{L^{2}(\Omega)}^{2}+\frac{\alpha}{2}\|\nabla u(t)\|_{L^{2}(\Omega)}^{2}
\end{aligned}
\label{5.13}\end{equation}

然后，通过时间积分，我们得到，对于所有$t>0$ ,

!!!!
\|u(t)\|_{L^{2}(\Omega)}^{2}+\alpha \int_{0}^{t}\|\nabla u(s)\|_{L^{2}(\Omega)}^{2} d s \leq\left\|u_{0}\right\|_{L^{2}(\Omega)}^{2}+\frac{C_{\Omega}^{2}}{\alpha} \int_{0}^{t}\|f(s)\|_{L^{2}(\Omega)}^{2} d s
\label{5.14}\end{equation}

这是一个先验的能量估计。不同种类的先验估计可以通过以下方式获得。请注意

!!!!
\frac{1}{2} \frac{d}{d t}\|u(t)\|_{L^{2}(\Omega)}^{2}=\|u(t)\|_{L^{2}(\Omega)} \frac{d}{d t}\|u(t)\|_{L^{2}(\Omega)}
$$

然后从\ref{5.9} ，使用\ref{5.10} 和\ref{5.11} 我们得到（仍然使用Poincaré不等式

!!!!
\begin{aligned}
&\|u(t)\|_{L^{2}(\Omega)} \frac{d}{d t}\|u(t)\|_{L^{2}(\Omega)}+\frac{\alpha}{C_{\Omega}}\|u(t)\|_{L^{2}(\Omega)}\|\nabla u(t)\|_{L^{2}(\Omega)} \\
&\leq\|f(t)\|_{L^{2}(\Omega)}\|u(t)\|_{L^{2}(\Omega)}, \quad t>0
\end{aligned}
$$

如果$\|u(t)\|_{L^{2}(\Omega)} \neq 0$（否则我们应该以不同的方式进行，尽管最后的结果仍然是真实的），我们可以除以$\|u(t)\|_{L^{2}(\Omega)}$并在时间上进行整合，得到

!!!!
\|u(t)\|_{L^{2}(\Omega)} \leq\left\|u_{0}\right\|_{L^{2}(\Omega)}+\int_{0}^{t}\|f(s)\|_{L^{2}(\Omega)} d s, \quad t>0
\label{5.15}\end{equation}

这是一个进一步的先验估计。

现在让我们使用\ref{5.13} 中的第一个不等式，并在时间上进行积分，得到

!!!!
\begin{aligned}
&\|u(t)\|_{L^{2}(\Omega)}^{2}+2 \alpha \int_{0}^{t}\|\nabla u(s)\|^{2} d s \\
&\quad \leq\left\|u_{0}\right\|_{L^{2}(\Omega)}^{2}+2 \int_{0}^{t}\|f(s)\|_{L^{2}(\Omega)}\|u(s)\|_{L^{2}(\Omega)} d s \\
&\quad \leq\left\|u_{0}\right\|_{L^{2}(\Omega)}^{2}+2 \int_{0}^{t}\|f(s)\|_{L^{2}(\Omega)} \cdot\left(\left\|u_{0}\right\|_{L^{2}(\Omega)}^{2}+\int_{0}^{s}\|f(\tau)\|_{L^{2}(\Omega)} d \tau\right) d s
\end{aligned}
$$


!!!!
\begin{aligned}
&=\left\|u_{0}\right\|_{L^{2}(\Omega)}^{2}+2 \int_{0}^{t}\|f(s)\|_{L^{2}(\Omega)}\left\|u_{0}\right\|_{L^{2}(\Omega)}+2 \int_{0}^{t}\|f(s)\|_{L^{2}(\Omega)} \int_{0}^{s}\|f(\tau)\|_{L^{2}(\Omega)} d \tau \\
&=\left(\left\|u_{0}\right\|_{L^{2}(\Omega)}+\int_{0}^{t}\|f(s)\| d s\right)^{2}
\end{aligned}
\label{5.16}\end{equation}



后面的平等是在注意到以下几点后得出的

!!!!
\|f(s)\|_{L^{2}(\Omega)} \int_{0}^{s}\|f(\tau)\|_{L^{2}(\Omega)} d \tau=\frac{d}{d s}\left(\int_{0}^{s}\|f(\tau)\|_{L^{2}(\Omega)} d \tau\right)^{2}
$$

因此，我们以额外的先验估计作为结论

!!!!
\begin{aligned}
&\left(\|u(t)\|_{L^{2}(\Omega)}^{2}+2 \alpha \int_{0}^{t}\|\nabla u(s)\|_{L^{2}(\Omega)}^{2} d s\right)^{\frac{1}{2}} \\
&\leq\left\|u_{0}\right\|_{L^{2}(\Omega)}+\int_{0}^{t}\|f(s)\|_{L^{2}(\Omega)} d s, \quad t>0
\end{aligned}
\label{5.17}\end{equation}

我们已经看到，我们可以为问题\ref{5.5}制定Galerkin问题\ref{5.6}，并且后者在合适的假设下，承认有唯一的解。与我们对问题\ref{5.5}所做的类似，我们可以证明问题\ref{5.6}的解的以下先验（稳定性）估计。

!!!!
\begin{aligned}
\left\|u_{h}(t)\right\|_{L^{2}(\Omega)}^{2}+\alpha \int_{0}^{t} \| & \nabla u_{h}(s) \|_{L^{2}(\Omega)}^{2} d s \\
& \leq\left\|u_{0 h}\right\|_{L^{2}(\Omega)}^{2}+\frac{C_{\Omega}^{2}}{\alpha} \int_{0}^{t}\|f(s)\|_{L^{2}(\Omega)}^{2} d s, \quad t>0
\end{aligned}
\label{5.18}\end{equation}

对于它的证明，我们可以对每一个$t>0, v_{h}=u_{h}(t)$，像我们得到\ref{5.13}那样进行。然后，通过回顾初始数据是$u_{h}(0)=u_{0 h}$，我们可以推导出\ref{5.15}和\ref{5.17}的下列离散对应关系。

!!!!
\left\|u_{h}(t)\right\|_{L^{2}(\Omega)} \leq\left\|u_{0 h}(t)\right\|_{L^{2}(\Omega)}+\int_{0}^{t}\|f(s)\|_{L^{2}(\Omega)} d s, \quad t>0
\label{5.19}\end{equation}

和

!!!!
\begin{aligned}
&\left(\left\|u_{h}(t)\right\|_{L^{2}(\Omega)}^{2}+2 \alpha \int_{0}^{t}\left\|\nabla u_{h}(s)\right\|_{L^{2}(\Omega)}^{2} d s\right)^{\frac{1}{2}} \\
&\leq\left\|u_{0 h}\right\|_{L^{2}(\Omega)}+\int_{0}^{t}\|f(s)\|_{L^{2}(\Omega)} d s, \quad t>0
\end{aligned}
\label{5.20}\end{equation}



\subsection{Convergence analysis of the semi-discrete problem}

让我们考虑问题\ref{5.5} 和它的近似值\ref{5.6} 。我们想证明$u_{h}$在合适的规范下向$u$收敛。

根据矫顽力假设，我们可以写出

!!!!
\begin{aligned}
\alpha\left\|\left(u-u_{h}\right)(t)\right\|_{\mathrm{H}^{1}(\Omega)}^{2} \leq & a\left(\left(u-u_{h}\right)(t),\left(u-u_{h}\right)(t)\right) \\
=& a\left(\left(u-u_{h}\right)(t),\left(u-v_{h}\right)(t)\right) \\
&+a\left(\left(u-u_{h}\right)(t),\left(v_{h}-u_{h}\right)(t)\right) \quad \forall v_{h}: v_{h}(t) \in V_{h}, \forall t>0 .
\end{aligned}
$$

为了清楚起见，我们抑制了来自$t$的依赖关系。通过从方程\ref{5.5}中减去方程\ref{5.6}并设定$w_{h}=v_{h}-u_{h}$，我们有

!!!!
\left(\frac{\partial\left(u-u_{h}\right)}{\partial t}, w_{h}\right)+a\left(u-u_{h}, w_{h}\right)=0
$$

其中$(v, w)=\int_{\Omega} v w$是$L^{2}(\Omega)$的标量乘积。那么

!!!!
\alpha\left\|u-u_{h}\right\|_{\mathrm{H}^{1}(\Omega)}^{2} \leq a\left(u-u_{h}, u-v_{h}\right)-\left(\frac{\partial\left(u-u_{h}\right)}{\partial t}, w_{h}\right)
\label{5.21}\end{equation}

我们分别分析两个右手边的条款。

- 利用形式的连续性$a(\cdot, \cdot)$和杨氏不等式，我们得到

!!!!
\begin{array}{r}
a\left(u-u_{h}, u-v_{h}\right) \leq M\left\|u-u_{h}\right\|_{\mathrm{H}^{1}(\Omega)}\left\|u-v_{h}\right\|_{\mathrm{H}^{1}(\Omega)} \\
\leq \frac{\alpha}{2}\left\|u-u_{h}\right\|_{\mathrm{H}^{1}(\Omega)}^{2}+\frac{M^{2}}{2 \alpha}\left\|u-v_{h}\right\|_{\mathrm{H}^{1}(\Omega)}^{2}
\end{array}
\label{5.22}\end{equation}


- 将$w_{h}$写成$w_{h}=\left(v_{h}-u\right)+\left(u-u_{h}\right)$的形式，我们可以得到

!!!!
-\left(\frac{\partial\left(u-u_{h}\right)}{\partial t}, w_{h}\right)=\left(\frac{\partial\left(u-u_{h}\right)}{\partial t}, u-v_{h}\right)-\frac{1}{2} \frac{d}{d t}\left\|u-u_{h}\right\|_{\mathrm{L}^{2}(\Omega)}^{2}
$$

将这两个结果替换到\ref{5.21}中，我们可以得到

!!!!
\frac{1}{2} \frac{d}{d t}\left\|u-u_{h}\right\|_{\mathrm{L}^{2}(\Omega)}^{2}+\frac{\alpha}{2}\left\|u-u_{h}\right\|_{\mathrm{H}^{1}(\Omega)}^{2} \leq \frac{M^{2}}{2 \alpha}\left\|u-v_{h}\right\|_{\mathrm{H}^{1}(\Omega)}^{2}+\left(\frac{\partial\left(u-u_{h}\right)}{\partial t}, u-v_{h}\right)
$$

两边都乘以2，在0和$t$之间进行时间积分，我们发现

!!!!
\begin{aligned}
&\left\|\left(u-u_{h}\right)(t)\right\|_{\mathrm{L}^{2}(\Omega)}^{2}+\alpha \int_{0}^{t}\left\|\left(u-u_{h}\right)(s)\right\|_{\mathrm{H}^{1}(\Omega)}^{2} d s \leq\left\|\left(u-u_{h}\right)(0)\right\|_{\mathrm{L}^{2}(\Omega)}^{2} \\
&+\frac{M^{2}}{\alpha} \int_{0}^{t}\left\|\left(u-v_{h}\right)(s)\right\|_{\mathrm{H}^{1}(\Omega)}^{2} d s+2 \int_{0}^{t}\left(\frac{\partial}{\partial s}\left(u-u_{h}\right)(s),\left(u-v_{h}\right)(s)\right) d s
\end{aligned}
\label{5.23}\end{equation}

通过部分积分并使用杨氏不等式，我们得到

!!!!
\begin{aligned}
&\int_{0}^{t}\left(\frac{\partial}{\partial s}\left(u-u_{h}\right)(s),\left(u-v_{h}\right)(s)\right) d s=-\int_{0}^{t}\left(\left(u-u_{h}\right)(s), \frac{\partial}{\partial s}\left(\left(u-v_{h}\right)(s)\right)\right) d s \\
&\quad+\left(\left(u-u_{h}\right)(t),\left(u-v_{h}\right)(t)\right)-\left(\left(u-u_{h}\right)(0),\left(u-v_{h}\right)(0)\right) \\
&\leq \int_{0}^{t}\left\|\left(u-u_{h}\right)(s)\right\|_{\mathrm{L}^{2}(\Omega)}\left\|\frac{\partial\left(\left(u-v_{h}\right)(s)\right)}{\partial s}\right\|_{\mathrm{L}^{2}(\Omega)} d s+\frac{1}{4}\left\|\left(u-u_{h}\right)(t)\right\|_{\mathrm{L}^{2}(\Omega)}^{2} \\
&\quad+\left\|\left(u-v_{h}\right)(t)\right\|_{\mathrm{L}^{2}(\Omega)}^{2}+\frac{1}{2}\left\|\left(u-u_{h}\right)(0)\right\|_{\mathrm{L}^{2}(\Omega)}^{2}+\frac{1}{2}\left\|u(0)-v_{h}(0)\right\|_{\mathrm{L}^{2}(\Omega)}^{2}
\end{aligned}
$$

从\ref{5.23} 中，我们因此得到

!!!!
\begin{aligned}
&\frac{1}{2}\left\|\left(u-u_{h}\right)(t)\right\|_{\mathrm{L}^{2}(\Omega)}^{2}+\alpha \int_{0}^{t}\left\|\left(u-u_{h}\right)(s)\right\|_{\mathrm{H}^{1}(\Omega)}^{2} d s \\
&\quad \leq 2 \int_{0}^{t}\left\|\left(u-u_{h}\right)(s)\right\|_{\mathrm{L}^{2}(\Omega)}\left\|\frac{\partial\left(\left(u-v_{h}\right)(s)\right)}{\partial s}\right\|_{\mathrm{L}^{2}(\Omega)} d s \\
&\quad+2\left\|\left(u-v_{h}\right)(t)\right\|_{\mathrm{L}^{2}(\Omega)}^{2}+\left\|u(0)-v_{h}(0)\right\|_{\mathrm{L}^{2}(\Omega)}^{2}
\end{aligned}
\label{5.24}\end{equation}

现在我们假设$V_{h}$是度数为$r$的有限元空间，更确切地说，是$V_{h}=\left\{v_{h} \in X_{h}^{r}:\left.v_{h}\right|_{\Gamma_{D}}=0\right\}$，让我们在每个$t, v_{h}(t)=\Pi_{h}^{r} u(t)$选择$u(t)$在$V_{h}$的插值（参见\ref{4.20}）。由于\ref{4.69}，假设$u$是足够规则的，我们有。

!!!!
h\left\|u(t)-\Pi_{h}^{r} u(t)\right\|_{\mathrm{H}^{1}(\Omega)}+\left\|u(t)-\Pi_{h}^{r} u(t)\right\|_{\mathrm{L}^{2}(\Omega)} \leq C_{2} h^{r+1}|u(t)|_{\mathrm{H}^{r+1}(\Omega)}
$$

让我们考虑并从上面约束不等式 \ref{5.24} 右手边的一些和。

!!!!
\begin{aligned}
&E_{1}=2\left\|\left(u-u_{h}\right)(0)\right\|_{\mathrm{L}^{2}(\Omega)}^{2} \leq C_{1} h^{2 r}\left|u_{0}\right|_{\mathrm{H}^{r}(\Omega)}^{2} . \\
&E_{2}=\frac{M^{2}}{\alpha} \int_{0}^{t}\left\|u(s)-v_{h}(s)\right\|_{\mathrm{H}^{1}(\Omega)}^{2} d s \leq C_{2} h^{2 r} \int_{0}^{t}|u(s)|_{\mathrm{H}^{r+1}(\Omega)}^{2} d s \\
&E_{3}=2\left\|u(t)-v_{h}(t)\right\|_{\mathrm{L}^{2}(\Omega)}^{2} \leq C_{3} h^{2 r}|u(t)|_{\mathrm{H}^{r}(\Omega)}^{2} \\
&E_{4}=\left\|u(0)-v_{h}(0)\right\|_{L^{2}(\Omega)}^{2} \leq C_{4} h^{2 r}|u(0)|_{H^{r}(\Omega)}^{2}
\end{aligned}
$$

因此。

!!!!
E_{1}+E_{2}+E_{3}+E_{4} \leq C h^{2 r} N(u)
$$

其中$N(u)$是一个取决于$u$和$\frac{\partial u}{\partial t}$的合适的函数，而$C$是一个合适的正常数。最后

!!!!
E_{5}(s)=\left\|\frac{\partial\left(u(s)-v_{h}(s)\right)}{\partial s}\right\|_{\mathrm{L}^{2}(\Omega)} \leq C_{5} h^{r}\left|\frac{\partial u(s)}{\partial s}\right|_{H^{r}(\Omega)}
$$

这样一来，从\ref{5.24}中我们得到了不等式

!!!!
\begin{aligned}
\left\|\left(u-u_{h}\right)(t)\right\|_{\mathrm{L}^{2}(\Omega)}^{2}+2 \alpha & \int_{0}^{t}\left\|\left(u-u_{h}\right)(s)\right\|_{\mathrm{H}^{1}(\Omega)}^{2} d s \\
\leq & C h^{2 r} N(u)+4 C_{5} h^{r} \int_{0}^{t}\left|\frac{\partial u(s)}{\partial s}\right|_{H^{r}(\Omega)}\left\|\left(u-u_{h}\right)(s)\right\|_{\mathrm{L}^{2}(\Omega)} d s .
\end{aligned}
$$

应用Gronwall法则（法则$2.2 ii$），我们得到先验误差估计值

!!!!
\begin{aligned}
&\left\{\left\|\left(u-u_{h}\right)(t)\right\|_{\mathrm{L}^{2}(\Omega)}^{2}+2 \alpha \int_{0}^{t}\left\|u-u_{h}\right\|_{\mathrm{H}^{1}(\Omega)}^{2}\right\}^{1 / 2} \\
&\leq \bar{C} h^{r}\left(\sqrt{N(u)}+\int_{0}^{t}\left|\frac{\partial u(s)}{\partial s}\right|_{H^{r}(\Omega)} d s\right)
\end{aligned}
\label{5.25}\end{equation}


对于一个合适的正常数 $\bar{C}$ 和所有 $t>0$ 。

另一个不使用格隆沃尔法则的证明可以按以下方式进行。如果我们从\ref{5.6}中减去\ref{5.5}，并设定$E_{h}=u-u_{h}$，我们得到（$E_{h}$对$t$的依赖性可以理解）。

!!!!
\left(\frac{\partial E_{h}}{\partial t}, v_{h}\right)+a\left(E_{h}, v_{h}\right)=0 \quad \forall v_{h} \in V_{h}, \quad \forall t>0
$$

如果为简单起见，我们假设$a(\cdot, \cdot)$是对称的，我们可以定义正交投影算子

!!!!
\Pi_{1, h}^{r}: V \rightarrow V_{h}: \forall w \in V, a\left(\Pi_{1, h}^{r} w-w, v_{h}\right)=0 \quad \forall v_{h} \in V_{h}
\label{5.26}\end{equation}

使用第三章中看到的结果，我们可以证明（见[QV94，第3.5节]），存在一个常数$C>0$，这样，$\forall w \in V \cap H^{r+1}(\Omega)$ 。

!!!!
\left\|\Pi_{1, h}^{r} w-w\right\|_{\mathrm{H}^{1}(\Omega)}+h^{-1}\left\|\Pi_{1, h}^{r} w-w\right\|_{\mathrm{L}^{2}(\Omega)} \leq C h^{p}|w|_{\mathrm{H}^{p+1}(\Omega)}, 0 \leq p \leq r
\label{5.27}\end{equation}

然后我们设定

!!!!
E_{h}=\sigma_{h}+e_{h}=\left(u-\Pi_{1, h}^{r} u\right)+\left(\Pi_{1, h}^{r} u-u_{h}\right)
\label{5.28}\end{equation}

请注意，正交投影误差$\sigma_{h}$可以通过不等式\ref{5.27}来约束，并且$e_{h}$是子空间$V_{h}$的一个元素。那么

!!!!
\left(\frac{\partial e_{h}}{\partial t}, v_{h}\right)+a\left(e_{h}, v_{h}\right)=-\left(\frac{\partial \sigma_{h}}{\partial t}, v_{h}\right)-a\left(\sigma_{h}, v_{h}\right) \quad \forall v_{h} \in V_{h}, \quad \forall t>0
$$

如果我们在每一个$t>0, v_{h}=e_{h}(t)$，并像在第$5.2$节中所做的那样进行，推导出半离散解$u_{h}$的先验估计。  $5.2$推导出半离散解$u_{h}$的先验估计，我们得到

!!!!
\begin{aligned}
\frac{1}{2} \frac{d}{d t}\left\|e_{h}(t)\right\|_{L^{2}(\Omega)}^{2} &+\alpha\left\|\nabla e_{h}(t)\right\|_{L^{2}(\Omega)}^{2} \\
& \leq\left|a\left(\sigma_{h}(t), e_{h}(t)\right)\right|+\left|\left(\frac{\partial}{\partial t} \sigma_{h}(t), e_{h}(t)\right)\right|
\end{aligned}
\label{5.29}\end{equation}

利用双线性形式的连续性$a(\cdot, \cdot)$（$M$是连续性常数）和杨氏不等式\ref{5.12}，我们得到

!!!!
\left|a\left(\sigma_{h}(t), e_{h}(t)\right)\right| \leq \frac{\alpha}{4}\left\|\nabla e_{h}(t)\right\|_{L^{2}(\Omega)}^{2}+\frac{M^{2}}{\alpha}\left\|\nabla \sigma_{h}(t)\right\|_{L^{2}(\Omega)}^{2}
$$

此外，利用Poincaré不等式和杨氏不等式，可以看出

!!!!
\begin{aligned}
\left|\left(\frac{\partial}{\partial t} \sigma_{h}(t), e_{h}(t)\right)\right| & \leq\left\|\frac{\partial}{\partial t} \sigma_{h}(t)\right\|_{L^{2}(\Omega)} C_{\Omega}\left\|\nabla e_{h}(t)\right\|_{L^{2}(\Omega)} \\
& \leq \frac{\alpha}{4}\left\|\nabla e_{h}(t)\right\|_{L^{2}(\Omega)}^{2}+\frac{C_{\Omega}^{2}}{\alpha}\left\|\frac{\partial}{\partial t} \sigma_{h}(t)\right\|_{L^{2}(\Omega)}^{2}
\end{aligned}
$$

使用\ref{5.29}中的这些界限，我们在对$t$进行积分后，得到:

!!!!
\begin{aligned}
&\left\|e_{h}(t)\right\|_{L^{2}(\Omega)}^{2}+\alpha \int_{0}^{t}\left\|\nabla e_{h}(t)\right\|_{L^{2}(\Omega)}^{2} d s \\
&\leq\left\|e_{h}(0)\right\|_{L^{2}(\Omega)}^{2}+\frac{2 M^{2}}{\alpha} \int_{0}^{t}\left\|\nabla \sigma_{h}(s)\right\|_{L^{2}(\Omega)}^{2} d s+\frac{2 C_{\Omega}^{2}}{\alpha} \int_{0}^{t}\left\|\frac{\partial}{\partial t} \sigma_{h}(s)\right\|_{L^{2}(\Omega)}^{2} d s, \quad t>0
\end{aligned}
$$

在这一点上，我们可以使用\ref{5.27}来约束右手边的误差。

!!!!
\begin{aligned}
&\left\|\nabla \sigma_{h}(t)\right\|_{L^{2}(\Omega)} \leq C h^{r}|u(t)|_{H^{r+1}(\Omega)} \\
&\left\|\frac{\partial}{\partial t} \sigma_{h}(t)\right\|_{L^{2}(\Omega)}=\left\|\left(\frac{\partial u}{\partial t}-\Pi_{1, h}^{r} \frac{\partial u}{\partial t}\right)(t)\right\|_{L^{2}(\Omega)} \leq C h^{r}\left|\frac{\partial u(t)}{\partial t}\right|_{H^{r}(\Omega)}
\end{aligned}
$$

最后，请注意，$\left\|e_{h}(0)\right\|_{L^{2}(\Omega)} \leq C h^{r}\left|u_{0}\right|_{H^{r}(\Omega)}$，仍然使用\ref{5.27} 。因为，对于任何规范$\|\cdot\|$ ,

!!!!
\left\|u-u_{h}\right\| \leq\left\|\sigma_{h}\right\|+\left\|e_{h}\right\|
$$

(由于$5.28$，利用前面的估计，我们可以得出结论，存在一个独立于$t$和$h$的常数$C>0$，使得

!!!!
\begin{aligned}
\left\{\left\|u(t)-u_{h}(t)\right\|_{L^{2}(\Omega)}^{2}+\alpha \int_{0}^{t}\left\|\nabla u(s)-\nabla u_{h}(s)\right\|_{L^{2}(\Omega)}^{2} d s\right\}^{1 / 2} \\
& \leq C h^{r}\left\{\left|u_{0}\right|_{H^{r}(\Omega)}^{2}+\int_{0}^{t}|u(s)|_{H^{r+1}(\Omega)}^{2} d s+\int_{0}^{t}\left|\frac{\partial u(s)}{\partial s}\right|_{H^{r+1}(\Omega)}^{2} d s\right\}^{1 / 2}
\end{aligned}
$$

进一步的误差估计被证明，例如在[QV94，第11章]。

\subsection{Stability analysis of $\theta$ -method}。

我们现在分析一下完全离散化问题的稳定性。

将$\theta$方法应用于Galerkin问题\ref{5.6} ，我们得到

!!!!
\begin{aligned}
\left(\frac{u_{h}^{k+1}-u_{h}^{k}}{\Delta t}, v_{h}\right)+a\left(\theta u_{h}^{k+1}+(1-\theta) u_{h}^{k}, v_{h}\right) \\
=\theta F^{k+1}\left(v_{h}\right)+(1-\theta) F^{k}\left(v_{h}\right) \quad \forall v_{h} \in V_{h},
\end{aligned}
\label{5.30}\end{equation}

对于每个$k \geq 0$，$u_{h}^{0}=u_{0 h} ; F^{k}$表示函数在时间$t^{k}$被评估。我们将限于$F=0$的情况，开始考虑隐式欧拉方法$(\theta=1)$的情况，即

!!!!
\left(\frac{u_{h}^{k+1}-u_{h}^{k}}{\Delta t}, v_{h}\right)+a\left(u_{h}^{k+1}, v_{h}\right)=0 \quad \forall v_{h} \in V_{h}
$$

通过选择$v_{h}=u_{h}^{k+1}$，我们得到

!!!!
\left(u_{h}^{k+1}, u_{h}^{k+1}\right)+\Delta t a\left(u_{h}^{k+1}, u_{h}^{k+1}\right)=\left(u_{h}^{k}, u_{h}^{k+1}\right)
\label{5.31}\end{equation}

通过利用以下不等式

!!!!
a\left(u_{h}^{k+1}, u_{h}^{k+1}\right) \geq \alpha\left\|u_{h}^{k+1}\right\|_{V}^{2}, \quad\left(u_{h}^{k}, u_{h}^{k+1}\right) \leq \frac{1}{2}\left\|u_{h}^{k}\right\|_{\mathrm{L}^{2}(\Omega)}^{2}+\frac{1}{2}\left\|u_{h}^{k+1}\right\|_{\mathrm{L}^{2}(\Omega)}^{2}
$$

前者来自双线性形式的矫捷性$a(\cdot, \cdot)$，后者来自考奇-施瓦茨和杨氏不等式，我们得到

!!!!
\left\|u_{h}^{k+1}\right\|_{\mathrm{L}^{2}(\Omega)}^{2}+2 \alpha \Delta t\left\|u_{h}^{k+1}\right\|_{V}^{2} \leq\left\|u_{h}^{k}\right\|_{\mathrm{L}^{2}(\Omega)}^{2}
$$

通过对$k$从0到$n-1$的求和，我们推导出

!!!!
\left\|u_{h}^{n}\right\|_{\mathrm{L}^{2}(\Omega)}^{2}+2 \alpha \Delta t \sum_{k=0}^{n-1}\left\|u_{h}^{k+1}\right\|_{V}^{2} \leq\left\|u_{0 h}\right\|_{\mathrm{L}^{2}(\Omega)}^{2}
$$

观察到$\left\|u_{h}^{k+1}\right\|_{V} \geq\left\|u_{h}^{k+1}\right\|_{\mathrm{L}^{2}(\Omega)}$，我们从\ref{5.31} 中推导出，对于每个给定的$\Delta t>0$来说

!!!!
\lim _{k \rightarrow \infty}\left\|u_{h}^{k}\right\|_{\mathrm{L}^{2}(\Omega)}=0
$$

即后向欧拉方法是绝对稳定的，不受任何时间步长的限制 $\Delta t$ 。

当$f \neq 0$，使用离散的Gronwall法则（见$2.7$节），可以用类似的方式证明，即

!!!!
\left\|u_{h}^{n}\right\|_{\mathrm{L}^{2}(\Omega)}^{2}+2 \alpha \Delta t \sum_{k=1}^{n}\left\|u_{h}^{k}\right\|_{V}^{2} \leq C\left(t^{n}\right)\left(\left\|u_{0 h}\right\|_{\mathrm{L}^{2}(\Omega)}^{2}+\sum_{k=1}^{n} \Delta t\left\|f^{k}\right\|_{\mathrm{L}^{2}(\Omega)}^{2}\right)
\label{5.32}\end{equation}

这种关系与\ref{5.20}相似，只要积分$\int_{0}^{t} \cdot d s$由时间步长$\Delta t$[QSS07]的复合数值积分公式近似。

在分析$\theta$是0和1之间的任意参数的一般情况之前，我们介绍以下定义。

我们说标量$\lambda$是双线性形式$a(\cdot, \cdot): V \times V \mapsto \mathbb{R}$的特征值，$w \in V$是其相应的特征函数，如果结果是

!!!!
a(w, v)=\lambda(w, v) \quad \forall v \in V
\label{5.33}\end{equation}

如果双线性形式$a(\cdot, \cdot)$是对称的和强制性的，它有正的、实数的特征值，形成一个无限的序列；此外，它的特征函数构成空间$V$的基础。

$a(\cdot, \cdot)$的特征值和特征函数可以通过找到满足以下条件的一对$\lambda_{h} \in \mathbb{R}$和$w_{h} \in V_{h}$来近似计算

!!!!
a\left(w_{h}, v_{h}\right)=\lambda_{h}\left(w_{h}, v_{h}\right) \quad \forall v_{h} \in V_{h} .
$$

从代数的角度来看，问题\ref{5.33} 可以表述为

!!!!
\mathrm{Aw}=\lambda_{h} \mathrm{M} \mathbf{w}
$$

其中$A$是刚度矩阵，$M$是质量矩阵。因此，我们要处理的是一个广义的特征值问题。

这样的特征值都是正数，并且$N_{h}$的数量$\left(N_{h}\right.$像往常一样是子空间$V_{h}$的维数）；在将它们按升序排列后，$\lambda_{h}^{1} \leq \lambda_{h}^{2} \leq \ldots \leq \lambda_{h}^{N_{h}}$我们有

!!!!
\lambda_{h}^{N_{h}} \rightarrow \infty \quad \text { for } N_{h} \rightarrow \infty
$$

此外，相应的特征函数构成了子空间$V_{h}$的基础，并且可以被选择为相对于$\mathrm{L}^{2}(\Omega)$的标量积而言的正态。这意味着，用$w_{h}^{i}$表示对应于特征值$\lambda_{h}^{i}$的特征函数，我们有$\left(w_{h}^{i}, w_{h}^{j}\right)=\delta_{i j} \quad \forall i, j=1, \ldots, N_{h}$。因此，每个函数$v_{h} \in V_{h}$可以表示如下

!!!!
v_{h}(\mathbf{x})=\sum_{j=1}^{N_{h}} v_{j} w_{h}^{j}(\mathbf{x})
$$

并且，由于特征函数的正交性。

!!!!
\left\|v_{h}\right\|_{\mathrm{L}^{2}(\Omega)}^{2}=\sum_{j=1}^{N_{h}} v_{j}^{2}
\label{5.34}\end{equation}

让我们考虑一个任意的$\theta \in[0,1]$，并让我们局限于双线性形式$a(\cdot, \cdot)$是对称的情况（否则，尽管最后的稳定性结果一般都成立，但下面的证明将不起作用，因为特征函数不一定形成一个基）。由于$u_{h}^{k} \in V_{h}$，我们可以写出

!!!!
u_{h}^{k}(\mathbf{x})=\sum_{j=1}^{N_{h}} u_{j}^{k} w_{h}^{j}(\mathbf{x})
$$

我们观察到，在这个模态扩展中，$u_{j}^{k}$不再代表$u_{h}^{k}$的结点值。如果我们现在将$F=0$设为\ref{5.30}，并取$v_{h}=w_{h}^{i}$，我们发现

!!!!
\frac{1}{\Delta t} \sum_{j=1}^{N_{h}}\left[u_{j}^{k+1}-u_{j}^{k}\right]\left(w_{h}^{j}, w_{h}^{i}\right)+\sum_{j=1}^{N_{h}}\left[\theta u_{j}^{k+1}+(1-\theta) u_{j}^{k}\right] a\left(w_{h}^{j}, w_{h}^{i}\right)=0
$$

对于每一个$i=1, \ldots, N_{h}$。对于每一对 $i, j=1, \ldots, N_{h}$ 我们有

!!!!
a\left(w_{h}^{j}, w_{h}^{i}\right)=\lambda_{h}^{j}\left(w_{h}^{j}, w_{h}^{i}\right)=\lambda_{h}^{j} \delta_{i j}=\lambda_{h}^{i}
$$

因此，对于每个$i=1, \ldots, N_{h}$,

!!!!
\frac{u_{i}^{k+1}-u_{i}^{k}}{\Delta t}+\left[\theta u_{i}^{k+1}+(1-\theta) u_{i}^{k}\right] \lambda_{h}^{i}=0
$$

现在求解$u_{i}^{k+1}$，我们发现

!!!!
u_{i}^{k+1}=u_{i}^{k} \frac{1-(1-\theta) \lambda_{h}^{i} \Delta t}{1+\theta \lambda_{h}^{i} \Delta t}
$$

回顾\ref{5.34} ，我们可以得出结论，为了使方法绝对稳定，我们必须施加不等式

!!!!
\left|\frac{1-(1-\theta) \lambda_{h}^{i} \Delta t}{1+\theta \lambda_{h}^{i} \Delta t}\right|<1
$$

就是说

!!!!
-1-\theta \lambda_{h}^{i} \Delta t<1-(1-\theta) \lambda_{h}^{i} \Delta t<1+\theta \lambda_{h}^{i} \Delta t
$$

因此。

!!!!
-\frac{2}{\lambda_{h}^{i} \Delta t}-\theta<\theta-1<\theta
$$

第二个不等式总是被验证的，而第一个不等式可以改写为

!!!!
2 \theta-1>-\frac{2}{\lambda_{h}^{i} \Delta t}
$$

如果 $\theta \geq 1 / 2$ ，左手边是非负的，而右手边是负的，所以不等式对每个 $\Delta t$ 都成立。相反，如果 $\theta<1 / 2$ ，只有在以下情况下才满足不等式（因此该方法是稳定的）： 

!!!!
\Delta t<\frac{2}{(1-2 \theta) \lambda_{h}^{i}}
\label{5.35}\end{equation}

由于这种关系必须对双线性形式的所有特征值$\lambda_{h}^{i}$成立，因此只需要求它对其中最大的特征值成立就足够了，我们假定它是$\lambda_{h}^{N_{h}}$。总结一下，我们有。

- 如果$\theta \geq 1 / 2$，$\theta$-方法是无条件绝对稳定的，即对每个$\Delta t$都是绝对稳定的。

- 如果$\theta<1 / 2$，$\theta$-方法只对$\Delta t \leq \frac{2}{(1-2 \theta) \lambda_{h}^{N_{h}}}$绝对稳定。

由于特征值的定义\ref{5.33} 和$a(\cdot, \cdot)$的连续性属性，我们推导出

!!!!
\lambda_{h}^{N_{h}}=\frac{a\left(w_{N_{h}}, w_{N_{h}}\right)}{\left\|w_{N_{h}}\right\|_{\mathrm{L}^{2}(\Omega)}^{2}} \leq \frac{M\left\|w_{N_{h}}\right\|_{V}^{2}}{\left\|w_{N_{h}}\right\|_{\mathrm{L}^{2}(\Omega)}^{2}} \leq M\left(1+C^{2} h^{-2}\right)
$$

后一步中出现的常数$C>0$来自于以下反不等式

!!!!
\exists C>0:\left\|\nabla v_{h}\right\|_{\mathrm{L}^{2}(\Omega)} \leq C h^{-1}\left\|v_{h}\right\|_{\mathrm{L}^{2}(\Omega)} \quad \forall v_{h} \in V_{h},
$$

关于其证明，我们请参考[QV94，第3章]。

因此，对于$h$足够小，$\lambda_{h}^{N_{h}} \leq C h^{-2}$ 。事实上，我们可以证明，$\lambda_{h}^{N_{h}}$确实是$h^{-2}$的阶数，也就是

!!!!
\lambda_{h}^{N_{h}}=\max _{i} \lambda_{h}^{i} \simeq c h^{-2}
$$

考虑到这一点，我们得到，对于$\theta<1 / 2$，只有在以下情况下，方法才是绝对稳定的

!!!!
\Delta t \leq C(\theta) h^{2}
\label{5.36}\end{equation}

其中 $C(\theta)$ 表示一个取决于 $\theta$ 的正常数。后面的关系意味着对于$\theta<1 / 2, \Delta t$不能任意选择，而是与$h$的选择相联系。

\subsection{Convergence analysis of $\theta$ -method}。

我们可以证明以下收敛定理

Theorem 5.1. Under the hypothesis that $u_{0}, f$ and the exact solution are sufficiently regular, the following a priori error estimate holds: $\forall n \geq 1$,

!!!!
\left\|u\left(t^{n}\right)-u_{h}^{n}\right\|_{\mathrm{L}^{2}(\Omega)}^{2}+2 \alpha \Delta t \sum_{k=1}^{n}\left\|u\left(t^{k}\right)-u_{h}^{k}\right\|_{V}^{2} \leq C\left(u_{0}, f, u\right)\left(\Delta t^{p(\theta)}+h^{2 r}\right)
$$

where $p(\theta)=2$ if $\theta \neq 1 / 2, p(1 / 2)=4$ and $C$ depends on its arguments but not on $h$ and $\Delta t$.

证明。证明是通过比较完全离散化问题\ref{5.30} 和半离散化问题\ref{5.6} 的解，使用稳定性结果\ref{5.32} 以及时间离散化的截断误差的衰减率进行的。为了简单起见，我们将仅限于考虑后向欧拉方法（对应于$\theta=1$）。

!!!!
\frac{1}{\Delta t}\left(u_{h}^{k+1}-u_{h}^{k}, v_{h}\right)+a\left(u_{h}^{k+1}, v_{h}\right)=\left(f^{k+1}, v_{h}\right) \quad \forall v_{h} \in V_{h}
\label{5.37}\end{equation}

我们请读者参考[QV94]，第11.3.1节，了解一般情况下的证明。

设$\Pi_{1, h}^{r}$为\ref{5.26}中介绍的正交投影算子。那么

!!!!
\left\|u\left(t^{k}\right)-u_{h}^{k}\right\|_{\mathrm{L}^{2}(\Omega)} \leq\left\|u\left(t^{k}\right)-\Pi_{1, h}^{r} u\left(t^{k}\right)\right\|_{\mathrm{L}^{2}(\Omega)}+\left\|\Pi_{1, h}^{r} u\left(t^{k}\right)-u_{h}^{k}\right\|_{\mathrm{L}^{2}(\Omega)}
\label{5.38}\end{equation}

第一个项可以参照\ref{5.27}来估计。为了分析第二项，在 $\varepsilon_{h}^{k}=u_{h}^{k}-\Pi_{1, h}^{r} u\left(t^{k}\right)$ ，我们得到

!!!!
\frac{1}{\Delta t}\left(\varepsilon_{h}^{k+1}-\varepsilon_{h}^{k}, v_{h}\right)+a\left(\varepsilon_{h}^{k+1}, v_{h}\right)=\left(\delta^{k+1}, v_{h}\right) \quad \forall v_{h} \in V_{h}
\label{5.39}\end{equation}

已设定。

!!!!
\left(\delta^{k+1}, v_{h}\right)=\left(f^{k+1}, v_{h}\right)-\frac{1}{\Delta t}\left(\Pi_{1, h}^{r}\left(u\left(t^{k+1}\right)-u\left(t^{k}\right)\right), v_{h}\right)-a\left(u\left(t^{k+1}\right), v_{h}\right)
\label{5.40}\end{equation}

并在最后一个和上利用了算子$\Pi_{1, h}^{r}$的正交性\ref{5.26} 。序列$\left\{\varepsilon_{h}^{k}, k=0,1 \ldots\right\}$满足问题\ref{5.39} ，这与\ref{5.37} 相似（只要我们取$\delta^{k+1}$而不是$f^{k+1}$）。通过调整稳定性估计\ref{5.32} ，我们得到，对于每个$n \geq 1$ 。

!!!!
\left\|\varepsilon_{h}^{n}\right\|_{\mathrm{L}^{2}(\Omega)}^{2}+2 \alpha \Delta t \sum_{k=1}^{n}\left\|\varepsilon_{h}^{k}\right\|_{V}^{2} \leq C\left(t^{n}\right)\left(\left\|\varepsilon_{h}^{0}\right\|_{\mathrm{L}^{2}(\Omega)}^{2}+\sum_{k=1}^{n} \Delta t\left\|\delta^{k}\right\|_{\mathrm{L}^{2}(\Omega)}^{2}\right)
\label{5.41}\end{equation}

与初始时间水平相关的准则很容易被估计：例如，如果$u_{0 h}=\Pi_{h}^{r} u_{0}$是$u_{0}$的有限元插值，通过适当使用估计值\ref{4.69和5.27），我们得到


!!!!
\begin{aligned}
\left\|\varepsilon_{h}^{0}\right\|_{\mathrm{L}^{2}(\Omega)} &=\left\|u_{0 h}-\Pi_{1, h}^{r} u_{0}\right\|_{\mathrm{L}^{2}(\Omega)} \\
& \leq\left\|\Pi_{h}^{r} u_{0}-u_{0}\right\|_{\mathrm{L}^{2}(\Omega)}+\left\|u_{0}-\Pi_{1, h}^{r} u_{0}\right\|_{\mathrm{L}^{2}(\Omega)} \leq C h^{r}\left|u_{0}\right|_{\mathrm{H}^{r}(\Omega)}
\end{aligned}
\label{5.42}\end{equation}

现在让我们把重点放在估计规范$\left\|\delta^{k}\right\|_{\mathrm{L}^{2}(\Omega)}$上。感谢 \ref{5.5} ,

!!!!
\left(f^{k+1}, v_{h}\right)-a\left(u\left(t^{k+1}\right), v_{h}\right)=\left(\frac{\partial u\left(t^{k+1}\right)}{\partial t}, v_{h}\right)
$$

这使得我们可以将\ref{5.40}改写为

!!!!
\begin{gathered}
\left(\delta^{k+1}, v_{h}\right)=\left(\frac{\partial u\left(t^{k+1}\right)}{\partial t}, v_{h}\right)-\frac{1}{\Delta t}\left(\Pi_{1, h}^{r}\left(u\left(t^{k+1}\right)-u\left(t^{k}\right)\right), v_{h}\right) \\
=\left(\frac{\partial u\left(t^{k+1}\right)}{\partial t}-\frac{u\left(t^{k+1}\right)-u\left(t^{k}\right)}{\Delta t}, v_{h}\right)+\left(\left(I-\Pi_{1, h}^{r}\right)\left(\frac{u\left(t^{k+1}\right)-u\left(t^{k}\right)}{\Delta t}\right), v_{h}\right)
\end{gathered}
\label{5.43}\end{equation}

使用泰勒公式，以积分形式计算余下的部分，我们有

!!!!
\frac{\partial u\left(t^{k+1}\right)}{\partial t}-\frac{u\left(t^{k+1}\right)-u\left(t^{k}\right)}{\Delta t}=\frac{1}{\Delta t} \int_{t^{k}}^{t^{k+1}}\left(s-t^{k}\right) \frac{\partial^{2} u}{\partial s^{2}}(s) d s
\label{5.44}\end{equation}

对函数$u$提出了关于时间变量的适当的规律性要求。现在使用微积分的基本定理，并利用投影算子$\Pi_{1, h}^{r}$和时间导数之间的交换性，我们得到

!!!!
\left(I-\Pi_{1, h}^{r}\right)\left(u\left(t^{k+1}\right)-u\left(t^{k}\right)\right)=\int_{t^{k}}^{t^{k+1}}\left(I-\Pi_{1, h}^{r}\right)\left(\frac{\partial u}{\partial s}\right)(s) d s
\label{5.45}\end{equation}

通过在\ref{5.43} 中选择$v_{h}=\delta^{k+1}$，由于\ref{5.44}和\ref{5.45}，我们可以推导出以下上界

!!!!
\begin{aligned}
&\left\|\delta^{k+1}\right\|_{L^{2}(\Omega)} \\
&\leq\left\|\frac{1}{\Delta t} \int_{t^{k}}^{t^{k+1}}\left(s-t^{k}\right) \frac{\partial^{2} u}{\partial s^{2}}(s) d s\right\|_{L^{2}(\Omega)}+\left\|\frac{1}{\Delta t} \int_{t^{k}}^{t^{k+1}}\left(I-\Pi_{1, h}^{r}\right)\left(\frac{\partial u}{\partial s}\right)(s) d s\right\|_{L^{2}(\Omega)} \\
&\leq \int_{t^{k}}^{t^{k+1}}\left\|\frac{\partial^{2} u}{\partial s^{2}}(s)\right\|_{L^{2}(\Omega)} d s+\frac{1}{\Delta s} \int_{t^{k}}^{t^{k+1}}\left\|\left(I-\Pi_{1, h}^{r}\right)\left(\frac{\partial u}{\partial s}\right)(s)\right\|_{L^{2}(\Omega)} d s
\end{aligned}
\label{5.46}\end{equation}

通过回到稳定性估计\ref{5.41}，并利用\ref{5.42}和具有适当比例的指数的估计\ref{5.46}，我们有

!!!!
\begin{aligned}
\left\|\varepsilon_{h}^{n}\right\|_{\mathrm{L}^{2}(\Omega)}^{2} & \leq C\left(t^{n}\right)\left(h^{2 r}\left|u_{0}\right|_{\mathrm{H}^{\prime}(\Omega)}^{2}+\sum_{k=1}^{n} \Delta t\left[\left(\int_{t^{k-1}}^{t^{k}}\left\|\frac{\partial^{2} u}{\partial s^{2}}(s)\right\|_{\mathrm{L}^{2}(\Omega)} d s\right)^{2}\right.\right.\\
&\left.\left.+\frac{1}{\Delta t^{2}}\left(\int_{t^{k-1}}^{t^{k}}\left\|\left(I-\Pi_{1, h}^{r}\right)\left(\frac{\partial u}{\partial s}\right)(s)\right\|_{\mathrm{L}^{2}(\Omega)} d s\right)^{2}\right]\right)
\end{aligned}
$$

然后，利用考奇-施瓦茨不等式和投影算子\ref{5.27}的估计$\Pi_{1, h}^{r}$，我们得到

!!!!
\begin{gathered}
\left\|\varepsilon_{h}^{n}\right\|_{\mathrm{L}^{2}(\Omega)}^{2} \leq C\left(t^{n}\right)\left(h^{2 r}\left|u_{0}\right|_{\mathrm{H}^{r}(\Omega)}^{2}+\sum_{k=1}^{n} \Delta t\left[\Delta t \int_{t^{k-1}}^{t^{k}}\left\|\frac{\partial^{2} u}{\partial s^{2}}(s)\right\|_{\mathrm{L}^{2}(\Omega)}^{2} d s\right.\right. \\
\left.\left.+\frac{1}{\Delta t^{2}}\left(\int_{t^{k-1}}^{t^{k}} h^{r}\left|\frac{\partial u}{\partial s}(s)\right|_{\mathrm{H}^{r}(\Omega)} d s\right)^{2}\right]\right)
\end{gathered}
$$



!!!!
\begin{gathered}
\leq C\left(t^{n}\right)\left(h^{2 r}\left|u_{0}\right|_{\mathrm{H}^{r}(\Omega)}^{2}+\Delta t^{2} \sum_{k=1}^{n} \int_{t^{k-1}}^{t^{k}}\left\|\frac{\partial^{2} u}{\partial s^{2}}(s)\right\|_{\mathrm{L}^{2}(\Omega)}^{2} d s\right. \\
\left.+\frac{1}{\Delta t} h^{2 r} \sum_{k=1}^{n} \Delta t \int_{t^{k-1}}^{t^{k}}\left|\frac{\partial u}{\partial s}(s)\right|_{\mathrm{H}^{r}(\Omega)}^{2} d s\right)
\end{gathered}
\label{5.47}\end{equation}

现在使用 \ref{5.38} 和估计 \ref{5.27} 可以得到结果。

更多的稳定性和收敛性估计可以在 [Tho84] 中找到。

\subsection{Exercises}

1.验证\ref{5.7} 中引入的质量矩阵M是正定的。

2.证明方程\ref{5.4} 的伪谱近似的稳定性条件\ref{10.42} （用$(-1,1)$替换区间$(0,1)$后）。

[解决方案：按照第$5.4$节对有限元情况的处理方式进行，并使用定理$10.2$和10.3给出的属性。  $5.4$中对有限元情况的处理，并使用定理$10.2$和10.3中给出的属性。]

3.考虑一下这个问题。

!!!!
\begin{cases}\frac{\partial u}{\partial t}-\frac{\partial}{\partial x}\left(\alpha \frac{\partial u}{\partial x}\right)-\beta u=0 & \text { in } Q_{T}=(0,1) \times(0, \infty) \\ u=u_{0} & \text { for } x \in(0,1), t=0 \\ u=\eta & \text { for } x=0, t>0 \\ \alpha \frac{\partial u}{\partial x}+\gamma u=0 & \text { for } x=1, t>0\end{cases}
$$

其中$\alpha=\alpha(x), u_{0}=u_{0}(x)$是给定的函数和$\beta, \gamma, \eta \in \mathbb{R}$（有正$\beta$）。

a) 证明改变$\gamma$的弱解的存在性和唯一性，提供对系数的适当限制和对函数$\alpha$和$u_{0}$的适当正则性假设。

b) 采用Galerkinfinite element方法对问题进行空间半微分化，并进行其稳定性和收敛性分析。

c) 在$\gamma=0$的情况下，用显式欧拉方法对同一问题进行时间上的近似，并进行其稳定性分析。4.考虑以下问题：找到$u(x, t), 0 \leq x \leq 1, t \geq 0$，使得

!!!!
\begin{cases}\frac{\partial u}{\partial t}+\frac{\partial v}{\partial x}=0, & 0<x<1, t>0 \\ v+\alpha(x) \frac{\partial u}{\partial x}-\gamma(x) u=0, & 0<x<1, t>0 \\ v(1, t)=\beta(t), u(0, t)=0, & t>0 \\ u(x, 0)=u_{0}(x), & 0<x<1\end{cases}
$$

其中$\alpha, \gamma, \beta, u_{0}$为给定函数。

a) 介绍一个基于$x$中二度有限元和隐式欧拉方法的时间近似，并证明其稳定性。

b) 误差将如何表现为参数$h$和$\Delta t$的函数？

c) 提出一种方法，从$v$的近似值开始，提供$u$的近似值以及其近似误差。

5.考虑以下（扩散-传输-反应）的初始边界值问题：找到$u:(0,1) \times(0, T) \rightarrow \mathbb{R}$，以便

!!!!
\begin{cases}\frac{\partial u}{\partial t}-\frac{\partial}{\partial x}\left(\alpha \frac{\partial u}{\partial x}\right)+\frac{\partial}{\partial x}(\beta u)+\gamma u=0, & 0<x<1,0<t<T \\ u=0 & \text { for } x=0,0<t<T \\ \alpha \frac{\partial u}{\partial x}+\delta u=0 & \text { for } x=1,0<t<T \\ u(x, 0)=u_{0}(x), & 0<x<1, t=0\end{cases}
$$

其中$\alpha=\alpha(x), \beta=\beta(x), \gamma=\gamma(x), \delta=\delta(x), u_{0}=u_{0}(x), x \in[0,1]$为给定函数。

a) 写出其弱的表述。

b) 除了假说之外。

!!!!
\begin{aligned}
&\text { a. } \quad \exists \beta_{0}, \alpha_{0}, \alpha_{1}>0: \forall x \in(0,1) \alpha_{1} \geq \alpha(x) \geq \alpha_{0}, \beta(x) \leq \beta_{0}, \\
&\text { b. } \quad \frac{1}{2} \beta^{\prime}(x)+\gamma(x) \geq 0 \quad \forall x \in(0,1)
\end{aligned}
$$

提供关于数据的更多可能的假设，从而使问题得到很好的解决。此外，给出解的先验估计。用非均质Dirichlet数据$u=g$处理同一问题$x=0$和$0<t<T$ 。

c) 考虑基于线性有限元方法的半微分化并证明其稳定性。

d) 最后，提供一个完全离散化，其中时间导数使用隐式欧拉方案进行近似，并证明其稳定性。6.考虑热方程

!!!!
\left\{\begin{array}{lc}
\frac{\partial u}{\partial t}-\frac{\partial^{2} u}{\partial x^{2}}=0, & -1<x<1, t>0 \\
u(x, 0)=u_{0}(x), & -1<x<1 \\
u(-1, t)=u(1, t)=0, & t>0
\end{array}\right.
$$

并通过空间上的G-NI方法和时间上的后向欧拉有限差分法对其进行近似。然后进行稳定性分析。

7.考虑以下四阶初始边界值问题：找到$u: \Omega \times(0, T) \rightarrow \mathbb{R}$，使得

!!!!
\begin{cases}\frac{\partial u}{\partial t}-\operatorname{div}(\mu \nabla u)+\Delta^{2} u+\sigma u=0 & \text { in } \Omega \times(0, T) \\ u(\mathbf{x}, 0)=u_{0} & \text { in } \Omega, \\ \frac{\partial u}{\partial n}=u=0 & \text { on } \Sigma_{T}=\partial \Omega \times(0, T)\end{cases}
$$

其中$\Omega \subset \mathbb{R}^{2}$是具有 "规则 "边界的有界开域$\partial \Omega, \Delta^{2}=\Delta \Delta$是双谐波算子，$\mu(\mathbf{x}), \sigma(\mathbf{x})$和$u_{0}(\mathbf{x})$是定义于$\Omega$的已知函数。已知的是

!!!!
\sqrt{\int_{\Omega}|\Delta u|^{2} \mathrm{~d} \Omega} \simeq\|u\|_{\mathrm{H}^{2}(\Omega)} \quad \forall u \in \mathrm{H}_{0}^{2}(\Omega)
$$

即两个规范$\|u\|_{\mathrm{H}^{2}(\Omega)}$和$\|\Delta u\|_{\mathrm{L}^{2}(\Omega)}$在空间上是等同的。

!!!!
\mathrm{H}_{0}^{2}(\Omega)=\left\{u \in \mathrm{H}^{2}(\Omega): u=\partial u / \partial n=0 \text { on } \partial \Omega\right\}
\label{5.48}\end{equation}

a) 写出它的弱表述，并验证解决方案的存在和唯一性，对数据制定适当的规律性假设。

b) 考虑基于三角形有限元素的半微分化，并提供这种元素为充分解决给定问题而必须具有的最小程度。(使用以下属性(例如，见[QV94])：如果$\mathscr{T}_{h}$是$\Omega$的规则三角形，并且$v_{h \mid K}$是每个$K \in \mathscr{T}_{h}$的多项式，那么$v_{h} \in \mathrm{H}^{2}(\Omega)$当且仅当$v_{h} \in C^{1}(\bar{\Omega})$，即$v_{h}$ 及其第一导数是连续穿过$\mathscr{T}_{h}$ 的元素界面。)第六章

产生$1 \mathrm{D}$和$2 \mathrm{D}$网格

正如我们所看到的，解决偏微分方程的有限元方法需要对计算域进行 "三角化"，即用较简单的几何实体（例如，二维的三角形或四角形，三维的四面体、棱柱体或六面体）对域进行分割，这些实体被称为元素，它们验证了一些条件。类似的分区是其他近似方法的基础，如有限体积法（见第九章）和谱元法（见第十章）。所有元素的集合就是所谓的计算网格（或者，简单地说，网格，或者网状）。

在本章中，为了简单起见，我们着重介绍了一维和二维领域的主要划分技术，并不追求完整。如有必要，我们将请读者查阅相关的专业文献。我们将只处理多边形域的情况；对于具有弯曲边界的计算域，感兴趣的读者可以参考 [Cia78] , [BS94] , $v$ 。为$2 \mathrm{D}$案例所揭示的技术可以扩展到三维域。

\subsection{Grid generation in 1D}

假设计算域$\Omega$是一个区间$(a, b)$ 。在子区间中最基本的分区是步骤$h$为常数的分区。在选择了元素的数量之后，比如$N$，我们设定$h=\frac{b-a}{N}$，并引入点$x_{i}=x_{0}+i h$，其中$x_{0}=a$和$i=0, \ldots, N$。这样的点$\left\{x_{i}\right\}$被称为 "顶点"，与二维的情况相类似，它们实际上是三角形的顶点，其联合体覆盖域$\Omega$。这样得到的分区被称为网格。后者是均匀的，因为它是由相同长度的元素组成的。

在更普遍的情况下，我们将使用非均匀网格，可能是根据一个给定的规律生成的。在可能的不同程序中，我们举例说明一个相当普遍的程序。让我们指定一个严格的正函数$\mathscr{H}:[a, b] \rightarrow \mathbb{R}^{+}$，称为间距函数，让我们考虑生成一个具有$N+1$顶点$x_{i}$的区间$[a, b]$分区的问题。值$\mathscr{H}(x)$代表对应于点$x$的所需间距。例如，如果$\mathscr{H}=h$（常数），与$h=(b-a) / M$为一个给定的整数$M$，我们正好落在前面的均匀网格的情况，与$N=M$。更一般地说，我们计算$\mathscr{N}=\int_{a}^{b} \mathscr{H}^{-1}(x) d x$并设定$N=\max (1,[\mathscr{N}])$，其中$[\mathscr{N}]$表示$\mathscr{N}$的整数部分，即小于或等于$\mathscr{N}$的最大正数。请注意，所产生的网格将至少有一个元素。然后我们设定$\kappa=\frac{N}{\mathscr{N}}$，并寻找$x_{i}$这样的点

!!!!
\kappa \int_{a}^{x_{i}} \mathscr{H}^{-1}(x) d x=i
$$

为$i=0, \ldots, N$。常数$\kappa$是一个正的修正系数，其值尽可能地接近1，其目的是保证$N$确实是一个整数。事实上，对于一个给定的$\mathscr{H}$，$N$的元素数本身就是问题的一个未知数。相反，$\mathscr{H}^{-1}$函数定义了一个密度函数：$\mathscr{H}^{-1}$的数值越大，对应的节点越密集，反之，$\mathscr{H}^{-1}$的数值越小，对应的节点越稀疏。

显然，如果我们希望构建一个具有给定数量$N$元素的网格，以及在$[a, b]$上的给定变化，只需重新规范间距函数，使相应密度的$(a, b)$上的积分正好等于$N$。在任何情况下，为了计算点$x_{i}$，引入以下考奇问题是有用的

!!!!
y^{\prime}(x)=\kappa \mathscr{H}^{-1}(x), x \in(a, b), \text { with } y(a)=0
$$

然后，点$x_{i}$将由关系$y\left(x_{i}\right)=i$定义，为$i=1, \ldots, N-1$。然后，将自动得出 $x_{0}=a$ 和 $x_{N}=b$ 。然后，我们将能够使用数字求解方法，为$j \in\{1, \ldots, N-1\}$的每个值找到函数$f_{j}(x)=y(x)-j$的根（例如，见[QSS07]）。

除了相当普遍之外，这个程序可以很容易地扩展到二维域的弯曲边界上的顶点的生成，正如我们将在第二节看到的那样。  $6.4 .2$ .

在$\mathscr{H}$在区间$(a, b)$内没有表现出过度的变化的情况下，我们也可以使用一个简化的程序，包括计算一组初步点$\tilde{x}_{i}$，对于$i=0, \ldots, N$，定义如下。

设置$\tilde{x}_{0}=a$并定义$\tilde{x_{i}}=\tilde{x}_{i-1}+\mathscr{H}\left(\tilde{x}_{i-1}\right), i=1,2, \ldots$ ，直到找到$M$这个值，使$\tilde{x}_{M} \geq b$和$\tilde{x}_{M-1}<b

2. 如果 $\tilde{x}_{M}-b \leq b-\tilde{x}_{M-1}$ 设置 $N=M$ ，否则定义 $N=M-1$ 。

然后，通过设置最终的顶点集，可以得到

!!!!
x_{i}=x_{i-1}+k \mathscr{H}\left(\tilde{x}_{i-1}\right), \quad i=1, \ldots, N,
$$

与 $x_{0}=a$ 和 $k=\left(b-x_{N-1}\right) /\left(x_{N}-x_{N-1}\right)$ 。

MATLAB程序Mesh_1d允许在一个端点为a和$b$的区间上构建网格，其步长在宏H中指定，使用之前的简化算法。例如，用下面的MATLAB命令。

$a=0 ; b=1 ; H=0.1 '

协调 $=$ mesh_1d $(a, b, H)$ 。

我们在$[0,1]$上创建一个均匀的网格，有10个子间隔，步长为$h=0.1$ 。
 ![](https://cdn.mathpix.com/cropped/10058ab4e7f0c5bd6fe5bcd4db204623-144.jpg?height=266&width=700&top_left_y=116&top_left_x=105)

图6.1.左边是与函数$\mathrm{x}$'相关的网格步长（在$\mathrm{x}$-轴上）的行为，右边是与函数$\mathrm{H}=$'$1 *(x<3)+.05 *(x>5)+.05^{\prime}$相关的行为。该图还报告了相应的顶点分布情况

设置$H=^{\prime} 1 /(\exp (4 * x)+2)^{\prime}$，我们得到一个在接近区间的第二个端点时变得更细的网格，而对于$\mathrm{H}=^{\prime} .1 *(\mathrm{x}<.3)+.05 *(\mathrm{x}>.5)+.05^{\prime}$，我们得到一个具有不连续变化步长的网格（见图6.1）。

![](https://cdn.mathpix.com/cropped/10058ab4e7f0c5bd6fe5bcd4db204623-144.jpg?height=513&width=726&top_left_y=587&top_left_x=92)

我们指出，在$\mathscr{H}$由误差估计确定的情况下，程序1将允许执行网格适应性。

我们现在要解决的是为二维领域构建网格的问题。

\subsection{Grid of a polygonal domain}

给定一个在$\mathbb{R}^{2}$中的有界多边形域$\Omega$，我们可以将其与$\Omega$中的多边形$K$的网格（或分区）联系起来，以便

!!!!
\bar{\Omega}=\bigcup_{K \in \mathscr{T}_{h}} K
$$

其中$\bar{\Omega}$是$\Omega$的封闭，并且

- $\stackrel{\circ}{K} \neq \emptyset \forall K \in \mathscr{T}_{h}

- $K_{1} \cap K_{2}=\emptyset$对于每个$K_{1}, K_{2} \in \mathscr{T}_{h}$，如$K_{1} \neq K_{2}

- 如果$F=K_{1} \cap K_{2} \neq \emptyset$与$K_{1}, K_{2} \in \mathscr{T}_{h}$和$K_{1} \neq K_{2}$ ，那么$F$要么是整条边，要么是网格的一个顶点。

- 用$h_{K}$表示每个$K \in \mathscr{T}_{h}$的$K$的直径，我们定义$h=\max _{K \in \mathscr{T}_{h}} h_{K}$。

我们用$\stackrel{\circ}{K}=K \backslash \partial K$表示$K$的内部。网格$\mathscr{T}_{h}$也被称为网格，有时也被称为$\bar{\Omega}$的三角化（广义的）。

前两个条件对网格的约束是显而易见的：特别是，第二个条件要求给定两个不同的元素，它们的内部不能重叠。第三个条件将可接受的三角形限制为所谓的符合条件的三角形。为了说明这个概念，我们在图$6.2$中表示一个符合（左）和不符合（右）的三角形。在其余部分，我们将只考虑符合要求的三角形。然而，存在着非常特殊的有限元近似方法，在本书中没有考虑，它们使用不符合条件的网格，即不满足第三个条件的网格。因此，这些方法更加灵活，至少在计算网格的选择方面是如此。除其他外，它们允许由不同性质的元素构成的网格的耦合，例如三角形、四边形以及更普遍的$2 \mathrm{D}$的多边形和三维的多面体。例如，这就是所谓的虚拟元素 [Bre15] 或模拟有限差分 [BLM14] 的情况。

第四个条件将参数$h$与$\mathscr{T}_{h}$元素的最大直径联系起来。

由于与第四章中回顾的内插误差理论有关的原因，我们将只考虑规则三角形$\mathscr{T}_{h}$，即对每个元素$K \in$来说，都是有规律的。
 ![](https://cdn.mathpix.com/cropped/10058ab4e7f0c5bd6fe5bcd4db204623-145.jpg?height=206&width=548&top_left_y=990&top_left_x=183)

图6.2.符合要求（左）和不符合要求（右）的网格实例
 ![](https://cdn.mathpix.com/cropped/10058ab4e7f0c5bd6fe5bcd4db204623-146.jpg?height=240&width=514&top_left_y=112&top_left_x=201)

图6.3.三角形（左）和四边形元素（右）的直径和球形度

$\mathscr{T}_{h}$，直径$h_{K}$和球度$\rho_{K}$（即内切圆的直径）之间的比率小于一个给定的常数。更确切地说，这些网格满足属性\ref{4.37} 。图$6.3$说明了三角形或四边形元素的直径和球度的含义。

在实际应用中，人们习惯于区分结构化网格和$u n-$结构化网格。结构化网格基本上使用四角形元素，其特点是对与给定节点相邻的顶点（或与给定元素相邻的元素）的访问是直接的。事实上，可以在网格的顶点和整数对$(i, j), i=1, \ldots, N_{i}, \quad j=1, \ldots, N_{j}$之间建立一种双射关系，这样，给定节点的指数$(i, j)$，相邻的四个顶点与指数$(i-1, j),(i+1, j)$、$(i, j-1)$和$(i, j+1)$对应。因此，顶点的总数是$N_{i} N_{j}$ 。在网格的元素和对$(I, J), I=$ $1, \ldots, N_{i}-1, \quad J=1, \ldots, N_{j}-1$之间可以建立类似的联系。此外，可以直接确定每个元素对应的顶点，而不必明确记忆连接矩阵（后者是为每个元素提供其顶点编号的矩阵）。图$6.4$（左）说明了这种情况。

在计算机代码中，成对的指数通常被一个单一的整数所取代，该整数与上述的指数有双向的关联。例如，对于顶点的编号，我们可以选择将整数$k=i+(j-1) N_{i}$与每对$(i, j)$相关联，反之，我们将顶点$k$与指数$i=\left((k-1) \bmod N_{i}\right)+1$和$j=\left((k-1) \operatorname{div} N_{i}\right)+1$唯一关联，其中mod和div表示整除的余数和商数。

在非结构化网格中，网格中的一个元素和它的顶点之间的关联必须明确地存储在连接矩阵中。

为结构化网格开发的代码可以从网格的 "结构 "中获益，对于同等数量的元素，通常会产生更有效的算法，无论是在内存方面还是在计算时间方面，都比非结构化网格上的类似方案要好。相比之下，非结构化网格提供了更大的灵活性，既可以对复杂形状的领域进行三角化，也可以对网格进行局部细化/减化。图$6.4$（右）显示了一个非结构化网格的例子，其间距已经适应了所研究的具体问题。使用结构化的网格将更难获得这种局部细化的效果。

非结构化的二维网格一般由三角形构成，尽管也有可能出现四角形的非结构化网格。

\subsection{Generation of structured grids}

在任意形状的域$\Omega$上生成结构化网格的最基本想法是在正方形$\widehat{\Omega}=!!!![0,1] \times[0,1]$（我们称之为参考正方形）和$\bar{\Omega}$之间找到一个规则和可逆的映射$\mathscr{M}$。请注意，该map必须在边界之前是有规律的（这个要求在某些情况下可以放宽）。我们通过在参考广场上生成一个均匀的--比如说--网状结构，然后我们使用映射$\mathscr{M}$将$\widehat{\Omega}$中的顶点坐标转换为$\bar{\Omega}$中的相应顶点坐标。

这个程序有不同的方面需要谨慎考虑。

1.寻找map$\mathscr{M}$往往是困难的。此外，这样的map也不是唯一的。一般来说，后者最好是尽可能的有规律。

2.在$\Omega$中，参考广场的均匀网格通常不能提供一个最佳的网格。事实上，我们通常希望控制顶点在$\Omega$中的分布，一般来说，这只能通过在参考广场上生成非均匀网格来实现，其间距既取决于$\Omega$中所期望的间距，也取决于所选择的map$\mathscr{M}$。

3.即使映射是有规律的（例如$C^{1}$类），在$\Omega$中产生的网格元素也不一定是可接受的，因为后者不是$\mathscr{M}$中相应元素的图像。例如，如果我们希望得到$\left(\mathbb{Q}_{1}\right)$中的片状双线性$\left(\mathbb{Q}_{1}\right)$有限元，后者的边缘需要与直角坐标轴平行，而网格$\mathbb{Q}_{1}$在参考方格上的图像会产生
 ![](https://cdn.mathpix.com/cropped/10058ab4e7f0c5bd6fe5bcd4db204623-147.jpg?height=282&width=648&top_left_y=870&top_left_x=130)

图6.4.(左) $(I, J)$ -结构化网格中元素顶点的编号。(右图）在机翼外部区域的非结构化三角形网格，适用于提高给定流动条件下的数值解的精度
 ![](https://cdn.mathpix.com/cropped/10058ab4e7f0c5bd6fe5bcd4db204623-148.jpg?height=234&width=678&top_left_y=114&top_left_x=118)

图6.5.结构化网格的构建：左手边是边界上map的识别；右手边是对应于将参考广场统一划分为$24 \times 24$元素的网格

如果映射是非线性的，那么$\Omega$中的弧形边缘是非线性的。换句话说，该映射只对$\widehat{\Omega}$的网格的顶点有效，而不是对边缘有效。

构建map$\mathscr{M}$的一个选择是使用将在第10章中说明的无限插值\ref{10.3} 。然而，这种方法并不总是容易适用。因此，我们将在其余部分说明一种更通用的方法，我们将把它应用于一个具体的例子，并参考具体的文献[TWM85, TSW99]以获得更多的例子和细节。

假设我们有一个域$\Omega$，其边界可以分为四个连续的部分$\Gamma_{1}, \ldots, \Gamma_{4}$，如图$6.5$所示，是一个特别简单的域。此外，假设我们可以通过四条参数曲线$\mathbf{g}_{1}, \ldots, \mathbf{g}_{4}$来描述$\partial \Omega$的这些部分，如图所示，参数$s$在每条曲线上的变化在0和1之间。这种构造使我们能够在参考方的边和域的边界之间建立一个双射图。事实上，我们将把每条曲线与正方形的相应边联系起来，如图 $6.5$ 所示。我们现在需要了解如何将这个映射扩展到整个 $\widehat{\Omega}$ 。

备注6.1。请注意，曲线$\mathbf{g}_{i}, i=1, \ldots, 4$，通常在$(0,1)$的所有地方都是不可微分的，但在$\frac{d \mathrm{~g}_{i}}{d s}$未定义的地方可以表现出有限数量的 "角"。例如，在图$6.5$中，曲线$\mathbf{g}_{2}$在黑色小方块标记的 "角 "处不可微分。

构建map$\mathscr{M}: \hat{\mathbf{x}}=(\widehat{x}, \hat{y}) \mapsto \mathbf{x}(x, y)$的一个选择包括解决$\widehat{\Omega}$中的以下椭圆系统。

!!!!
-\frac{\partial^{2} \mathbf{x}}{\partial \widehat{x}^{2}}-\frac{\partial^{2} \mathbf{x}}{\partial \widehat{y}^{2}}=0 \quad \text { in } \widehat{\Omega}=(0,1)^{2}
\label{6.1}\end{equation}

具有边界条件

!!!!
\begin{array}{ll}
\mathbf{x}(\widehat{x}, 0)=\mathbf{g}_{1}(\widehat{x}), \mathbf{x}(\widehat{x}, 1)=\mathbf{g}_{3}(\widehat{x}), & \widehat{x} \in(0,1), \\
\mathbf{x}(1, \hat{y})=\mathbf{g}_{2}(\widehat{y}), \mathbf{x}(0, \hat{y})=\mathbf{g}_{4}(\widehat{y}), & \widehat{y} \in(0,1) .
\end{array}
$$



![](https://cdn.mathpix.com/cropped/10058ab4e7f0c5bd6fe5bcd4db204623-149.jpg?height=260&width=287&top_left_y=123&top_left_x=319)

图6.6.非凸域的三角划分。通过解决椭圆问题\ref{6.1} 得到的边界图和网格的识别

参考方格中的网格顶点可以转化为$\Omega$中的网格顶点。请注意，问题\ref{6.1}的解决通常是通过数值方法来实现的，例如通过有限差分（或有限元）方案。此外，为了适当地遵守$\Omega$边界的几何形状，有必要确保在每个 "边缘 "生成一个顶点。在图$6.5$（右）中，我们说明了这种方法对图$6.5$（左）中领域的结果。可以注意到，如果我们想在边缘有更多的顶点分布，那么对应于参考方块的规则划分的网格就不是特别令人满意。

此外，上面描述的方法不适用于非凸域。事实上，让我们考虑图$6.6$，其中我们显示了一个$L$形状的域，以及相应的边界分区，以及通过从参考域的规则分区开始求解问题\ref{6.1} 而得到的网格。很明显，这样的网格是不可接受的。

为了解决这样的问题，我们可以通过几种（并不相互排斥）方式进行。

- 我们在 $\widehat{\Omega}$ 中使用了一个非均匀网格，它考虑了 $\Omega$ 的几何特征。

- 我们使用不同的map$\mathscr{M}$，例如，通过解决以下新的微分问题而不是\ref{6.1}得到的。

!!!!
-\alpha \frac{\partial^{2} \mathbf{x}}{\partial \widehat{x}^{2}}-\beta \frac{\partial^{2} \mathbf{x}}{\partial \widehat{y}^{2}}+\gamma \mathbf{x}=\mathbf{f} \quad \text { in } \widehat{\Omega}
$$

其中$\alpha>0, \beta>0, \gamma \geq 0$和$\mathbf{f}$是$\widehat{x}$和$\widehat{y}$的合适函数。它们的选择取决于$\Omega$的几何形状，并且是为了控制顶点的分布。

- 我们将$\Omega$划分为子域，分别进行三角化。这种技术通常被称为块状结构的网格生成。如果我们希望全局网格是符合要求的，我们就需要非常注意如何分配不同子域之间界面边界上的顶点数量。当子域的数量非常多时，这个问题会变得非常复杂。上述类型的方法被称为网格生成的椭圆方案，因为它们是基于椭圆方程的求解，如 \ref{6.1} 和 \ref{6.2} 。

有兴趣的读者请参考上述引用的专业文献。

\subsection{Generation of non-structured grids}

这里我们将考虑用三角形元素生成非结构化网格。用于此目的的两种主要算法是Delaunay三角法和前进锋技术。

\subsubsection{Delaunay triangulation}

一组$n$的$\mathbb{R}^{2}$点的三角剖分，如果每个三角形所围成的圆盘不包含任何顶点，那么它就是德劳内三角剖分（见图6.7）。

德劳内三角法具有以下特性。

1.给定一组点，德劳内三角图是唯一的，除了$M$点（与$M>3$）位于一个圆上的特定情况。

2.在所有可能的三角形中，德劳内三角形是使网格三角形的最小角度最大化的三角形（这被称为最大-最小规则性属性）。

3.由三角形的联合体组成的集合是包围给定点集合的最小表面的凸图（称为凸壳）。

第三个属性使得Delaunay算法无法适用于非凸域，至少在其原始形式下是如此。

然而，存在一种变体，叫做受限德劳内三角法（$C D T)$），它允许先验地固定一组要生成的网格边：产生的网格必然将这些边与一些三角形联系起来。特别是，我们可以先验地规定那些定义网格边界的边。
 ![](https://cdn.mathpix.com/cropped/10058ab4e7f0c5bd6fe5bcd4db204623-150.jpg?height=204&width=686&top_left_y=925&top_left_x=115)

图6.7.左边是三角形凸域上Delaunay网格的一个例子。可以很容易地验证，每个三角形所包围的圆不包括网格的任何顶点。右手边是一个不满足Delaunay条件的网格细节：事实上，顶点$P$落在三角形$K$的圆周内 为了更好地说明CDT的概念，我们事先说明以下定义：给定两点$P_{1}$和$P_{2}$，如果线段$P_{1} P_{2}$不经过任何一条边界边（或者，更一般地说，我们想预先固定的边），我们将说这两个点是相互可见的。一个受限的德劳内三角剖分满足以下属性：每个三角形$K$所围成的圆的内部不包含从内部点到$K$的任何可见顶点。

再次，可以证明这样的三角剖分是唯一的，并且满足maxmin规则性。因此，CDT不是一个合适的Delaunay三角图，因为它的一些三角形可能包含属于初始集合的顶点。在任何情况下，顶点都只是在集合中指定的原始顶点，而没有进一步的顶点被添加。然而，有两种变体是可能的：顺应德劳内三角法和顺应约束德劳内三角法（或CCDT）。前者是一种三角形，其中每个三角形都是德劳内三角形，但每条要固定的边可以进一步细分为子段；在这种情况下，可以添加新的顶点以获得更短的段。额外的顶点通常是必要的，以保证最大-最小德劳内属性，同时确保每个规定的边被正确表示。第二种变体代表的是三角形是受限德劳内类型的三角形。同样在这种情况下，我们可以增加额外的顶点，而且要固定的边不能被划分成更小的段。然而，在后一种情况下，我们的目的不是为了保证保留边，而是为了提高三角形的质量。

在现有的生成Delaunay网格或其变体的软件中，Triangle[She]可以生成Delaunay三角形，并可选择以三角形的最大和最小角度来调节所生成网格的规则性。几何图形以图形的形式给Triangle输入，称为平面直线图（PSLG）。这种编码写在扩展名为.poly的输入文件中：后者基本上包含顶点和边的列表，但也可以包括几何体中存在的空洞或凹陷的信息。

下面报告了一个.poly文件的样本。

![](https://cdn.mathpix.com/cropped/10058ab4e7f0c5bd6fe5bcd4db204623-151.jpg?height=369&width=573&top_left_y=848&top_left_x=91)



![](https://cdn.mathpix.com/cropped/10058ab4e7f0c5bd6fe5bcd4db204623-152.jpg?height=158&width=362&top_left_y=116&top_left_x=96)

上面的例子说明了一个几何体，代表一个有方形孔的正方形。文件的第一部分列出了顶点，而第二部分定义了要固定的边。第一行声明八个顶点将被跟随，网格的空间维度是两个（我们在$\mathbb{R}^{2}$），没有其他属性与顶点相关联，每个点上都定义了一个边界标记。这些属性代表了与网格节点有关的可能的物理属性，如导电性和粘性值等。边界标记是整数值的标志，可以在计算代码中用来在不同的顶点分配合适的边界条件。下面几行显示了八个顶点，以及它们的分水岭和坐标，后面是边界标记值，在本例中为零。第二部分的第一行声明接下来有五个边，在每个边上将指定一个边界标记的值。然后，五个边界面相继出现，由它们各自的端点和边界标记的值来指定。在文件的最后一节，通过指定中心坐标来定义一个孔，在最后一行，前面是孔的渐进式编号（在这种情况下，限于1）。

与这个几何体相关的受限德劳内网格，比如box.poly，可以通过命令获得

参数-p声明输入文件是.poly，而选项-c防止删除凹面，因为没有这个选项通常会发生。事实上，这个选项强制对PSLG图形的凸壳进行三角化。其结果将是创建三个文件，即box.1.poly, box.1.节点和box.1.ele。第一个文件包含产生的三角剖分的边的描述，第二个文件包含节点描述，后者定义了生成元素的连接性。为了简洁起见，我们将不详细描述这三个文件的格式。最后，我们指出，在这个例子中，将这三个文件的名称与它们各自的扩展名分开的数值（1），起到了迭代计数器的作用。三角形确实可以一次又一次地连续完善或修改产生的三角形。产生的三角图在图$6.8$中描述。

一个附属于Triangle的软件，叫做Show Me，可以将Triangle的输出可视化。例如，图$6.8$（左）是通过以下命令得到的

\section{showme box}

为了得到一个受限的保角三角图，我们必须指定三角命令与其他参数，如$-\mathrm{q},-\mathrm{a}$或$-\mathrm{u}$ 。第一个参数是对最小角度的约束，第二个参数则是对曲面的最大值的固定。
 ![](https://cdn.mathpix.com/cropped/10058ab4e7f0c5bd6fe5bcd4db204623-153.jpg?height=242&width=516&top_left_y=113&top_left_x=199)

图6.8.带方孔的正方形的德劳内三角图。左边是CDT，右边是CCDT

而第三种是强迫三角形的尺寸，通常是通过用户必须提供的一个外部函数。例如，通过命令

三角形 - PCQ20盒

我们得到了图$6.8$（右）中报告的受约束的符合Delaunay三角图，其特点是最小角度为$20^{\circ}$ 。最后，通过进一步指定选项-D，可以得到符合要求的Delaunay三角图。图6.9是一个更复杂的例子。该命令使用了

三角形-pca0.01q30 naca

将最小角度固定为$30^{\circ}$，将生成的三角形的最大表面固定为$0.01$ 。最初的PSLG文件naca.poly通过65个顶点、同样多的边和一个空腔来描述几何体。最终的网格由711个顶点、1283个元素和边界上的137条边组成。

我们可以参考广泛的在线文档和Triangle的详细帮助，了解软件的几个进一步的使用选项。

![](https://cdn.mathpix.com/cropped/10058ab4e7f0c5bd6fe5bcd4db204623-153.jpg?height=290&width=435&top_left_y=905&top_left_x=239)

图 6.9.naca 4415机翼的Delaunay三角图 回到Delaunay网格的属性，Delaunay三角图不允许控制生成元素的长宽比（最大边和最小边），这正是因为上述的max-min属性。另一方面，在某些情况下，在给定的方向上生成 "拉伸 "的三角形是有用的，例如，如果我们想正确地表示边界层。为此，我们开发了被称为广义Delaunay三角法的算法，其中对圆周三角形的条件由对被检查的三角形所包围的椭圆的类似条件来代替。这样，通过对每个椭圆的轴的长度和方向进行适当的规定，我们可以生成在所需方向上伸展的元素。

目前最常用的Delaunay网格生成算法是增量的，也就是说，它们通过每次增加一个顶点来生成一系列Delaunay网格。因此，有必要找到按照所需网格间距提供新顶点的程序，并在以这种方式生成的网格结果不令人满意时立即停止这种程序。关于进一步的细节，可以参考[GB98]和[TSW99，第16章]等。关于受限Delaunay三角形的几何特性的详细描述，包括$\mathbb{R}^{2}$和$\mathbb{R}^{3}$的领域，可以在[BE92]中找到。

\subsubsection{Advancing front technique}

我们粗略地描述了另一种广泛使用的用于生成非结构化网格的技术，即前进锋技术。一个必要的成分是对要生成的网格元素的期望间距的了解。让我们假设一个间距函数$\mathscr{H}$，定义在$\bar{\Omega}$上，为$\bar{\Omega}$的每个点$P$提供该点所需的网格尺寸，例如，通过必须在$P$附近生成的元素的直径$h_{K}$。如果我们想控制生成元素的形状方面，$\mathscr{H}$将有一个更复杂的形状。事实上，它将是一个正定的对称张量，即$\mathscr{H}: \Omega \rightarrow \mathbb{R}^{2 \times 2}$，这样，对于域的每个点$P$，$\mathscr{H}$的（垂直的）特征向量]表示需要在$P$附近生成的三角形的最大和最小拉伸方向，而特征值（更确切地说，是特征值逆的平方根），则是两个相应间距的特征（见[GB98]）。在其余部分，我们将只考虑$\mathscr{H}$是一个标量函数的情况。

要执行的第一个操作是沿域边界生成顶点。我们假设$\partial \Omega$被描述为参数化曲线$\mathbf{g}_{i}(s)$、$i=1, \ldots N$的结合体，例如花键或多边形分割。为了简单起见，我们假设，对于每条曲线，参数$s$在0和1之间变化。如果我们希望沿曲线$\mathbf{g}_{i}$生成$N_{i}+1$的顶点，只需为$s$的所有值创建一个顶点，对于这些值，函数

!!!!
f_{i}(s)=\int_{0}^{s} \mathscr{H}^{-1}\left(\mathbf{g}_{i}(\tau)\right)\left|\frac{d \mathbf{g}_{i}}{d s}(\tau)\right| d \tau
$$


![](https://cdn.mathpix.com/cropped/10058ab4e7f0c5bd6fe5bcd4db204623-155.jpg?height=280&width=616&top_left_y=110&top_left_x=146)

图6.10.前面的推进。领域中先前被三角化的部分已被遮蔽

取整数值。更确切地说，沿曲线$s_{i}^{(j)}$生成的节点的曲线坐标$\mathbf{g}_{i}$满足以下关系

!!!!
f_{i}\left(s_{i}^{(j)}\right)=j, \quad j=0, \cdots, N_{i} \text { with the constraints } s_{i}^{(0)}=0, s_{i}^{\left(N_{i}\right)}=1
$$

这个过程与第6.1节中描述的过程类似。请注意，$\left|\frac{d \mathrm{~g}_{i}}{d s}\right|$项占了曲线的内在度量。

完成了这一点，就可以开始推进前面的过程。后者由一个数据结构描述，该结构包含定义$\Omega$中已经被三角化的部分和尚未被三角化的部分之间边界的边的列表。在这个过程的开始，前面包含边界边。

在网格生成的过程中，前面的每一个边都可以用来创建一个新的元素，它是通过将所选择的边与网格的一个新的或以前存在的顶点连接起来而构建的。选择使用现有的顶点还是创建一个新的顶点取决于几个因素，其中包括将被生成的元素的尺寸和形状与间距函数$\mathscr{H}$提供的元素之间的兼容性。此外，新的元素必须不与正面的任何一侧相交。

一旦新元素被生成，它的新边将被 "添加 "到前面，这样后者就描述了被三角化和非三角化部分之间的新边界，而初始边将从数据列表中删除。这样，在生成过程中，正面将从已经三角化的区域向尚未三角化的区域发展（见图6.10）。

因此，一般的前进前线算法包括以下步骤。

1. 定义要被三角化的域的边界。

2. 通过一条符合边界的片状线性曲线来初始化前沿。

3. 使用某种标准选择要从前面去除的一面（通常选择最短的一面，可以提供质量好的网格）。

4. 对于边，例如$A B$，这样选择：a) 选择 "候选 "顶点$C$，即域内的点，其与$A B$的距离由期望的间隔函数$\mathscr{H}$规定。

b) 在$C^{\prime}$的合适邻域中寻找前面已经存在的点$C$ 。如果搜索成功，$C^{\prime}$成为新的候选点$C$ 。继续搜索。

c) 确定三角形$A B C$是否与前面的某个其他边相交。如果是，从正面选择一个新的候选点，并从步骤4.b)开始返回。

5. 将新的点$C$、新的边和新的三角形$A B C$添加到相应的列表中。

6. 擦除前面的边$A B$，并添加新的边。

7. 如果前面是不空的，从点$3$继续。

很明显，如果我们希望计算成本是生成元素数量的线性函数，就有必要使上述操作尽可能地独立于我们正在生成的网格的维数，特别是独立于前进锋的维数。这样的目标并不简单，特别是由于诸如控制新三角形的交点，或者寻找靠近通用点的前沿顶点等操作，都是跨越整个前沿的。为此我们参考专业文献，特别是参考[1.x]的第14和17章。[TSW99] 的第14和17章。

正如之前在算法描述中指出的，生成网格的质量取决于选择生成新三角形的前边的程序。特别是，一个经常采用的技术包括选择长度最小的边：直观地说，这也允许满足非统一的间距要求，而不会有需要更密集的节点分布的区域被更粗的间距相关的三角形覆盖的风险。图6.11是一个通过这种技术得到的网格例子，与选择$\mathscr{H}\left(x_{1}, x_{2}\right)=!!!!e^{4 \sin \left(8 \pi x_{1}\right)} e^{-2 x_{2}}$相对应。

通过实施适当的技巧和数据结构，推进算法提供了一个网格，其间距与要求的网格一致，计算时间几乎与生成元素的数量成正比。

推进前沿技术也可用于生成四边形网格。

\subsection{Regularization techniques}

一旦网格被生成，为了提高其规则性，可能需要进行后处理。一些方法允许通过改善三角形形状的操作来改变网格。特别是，我们将研究修改拓扑学特征（通过对角线交换）或几何学特征（通过节点位移）的规则化技术。

![](https://cdn.mathpix.com/cropped/10058ab4e7f0c5bd6fe5bcd4db204623-157.jpg?height=358&width=365&top_left_y=119&top_left_x=271)

图6.11.前进的技术。非均匀间距的例子

a)

b)

图6.12.通过两个相邻元素形成的凸四边形中的对角线交换得到的两种配置。这两种配置是根据最优性标准来比较的

\subsubsection{Diagonal swap}

对角线的交换是一种允许修改网格拓扑结构而不改变其顶点位置和数量的技术。这种技术是基于这样一个事实：一个四边形可以以两种不同的方式被细分为几个共用边的三角形（见图6.12）。

一般来说，对角线交换是通过遵循一个给定的优化标准来提高非结构化网格的质量。例如，假设目标是避免角度过大，如两个对角之和大于$\pi$时。在这种情况下，交换对角线就可以解决这个问题。

一个可能的对角线交换算法的一般方案是通过在元素水平上定义最优性标准而得到的，在适当的非负函数$S: K \rightarrow \mathbb{R}^{+} \cup\{0\}$的形式下，当$K$具有 "最优 "的形状和尺寸时，其值为0。例如，我们可以使用

!!!!
S(K)=\left|\frac{|K|}{\sum_{i=1}^{3}\left|e_{i}^{K}\right|^{2}}-\frac{\sqrt{3}}{12}\right|
\label{6.2}\end{equation}

其中$|K|$表示$K, e_{i}^{K}$代表$K$的一般边的大小，$\left|e_{i}^{K}\right|$是其长度。使用这个函数，我们享有接近于等边的三角形的特权，对于这些三角形，$S(K)=0$ 。因此，我们一般会得到一个尽可能规则的网格，它不考虑间距的问题。参照图$6.12$，算法将按以下方式进行。

1. 循环0：将交换方的计数器设置为零：交换 $=0$ 。

2. 横跨当前网格的所有内部边$e$。

3. 如果与$e$相邻的两个三角形形成一个凸四边形。

a) 计算$G=S^{2}\left(K_{1}\right)+S^{2}\left(K_{2}\right)-\left[S^{2}\left(K_{1}^{*}\right)+S^{2}\left(K_{2}^{*}\right)\right]$。

b) 如果$G \geq \tau$，而$\tau>0$是预定的，那么执行对角线交换（因此修改当前网格）并设置$\operatorname{swap}=$交换$+1$。

4. 如果$s w a p>0$从周期0开始返回。否则，该程序终止。

可以很容易地验证，这个算法必然在有限的步骤中终止，因为对于每个对角线的交换，正量$\sum_{K} S^{2}(K)$，其中总和扩展到当前网格的所有三角形，被有限的量$G$减少（注意，尽管网格被修改，在每个对角线的交换，元素和边数保持不变）。

备注6.2。在元素层面构建最优性函数$S$并不总是一个好的选择。例如，基于现有的数据结构，$S$也可以与节点或网格的边相关联。

对角线交换技术也是一种广泛使用的Delaunay三角法的算法（Lawson算法）的基础。确实可以证明，从凸域的任何三角化开始，相应的Delaunay三角化（我们记得，它是唯一的）可以通过有限的对角线交换得到。此外，为此目的的必要交换的最大数量可以预先确定，并且是网格顶点数量的函数。通过对算法的适当修改，该技术（和收敛结果）可以扩展到受限的Delaunay三角计算。我们参考专门的文献，例如[GB98]，以了解细节。

\subsubsection{Node displacement}

另一种提高网格质量的方法是在不修改其拓扑结构的情况下移动其点。让我们考虑一个内部顶点$P$和由包含它的网格元素的联合构成的多边形$\mathscr{K}_{P}$。集合$\mathscr{K}_{P}$通常被称为与$P$相关的 "补丁"，在第4.6节中已经考虑过。4.6.对于一个例子，见图4.20，右边。一种正则化技术，称为拉普拉斯正则化，或称巴里中心化，包括将$P$移动到$\mathscr{K}_{P}$的重心，也就是计算其新位置$\mathbf{x}_{P}$，如下所示。

!!!!
\mathbf{x}_{P}=\left|\mathscr{K}_{P}\right|^{-1} \int_{\mathscr{K}_{P}} \mathbf{x} d \mathbf{x}
$$

(见图6.13)。这个过程显然会在网格的所有内部顶点上进行迭代，并重复多次。在收敛的情况下，最终的网格是一个最小化的数量

!!!!
\sum_{P} \int_{\mathscr{K}_{P}}\left(\mathbf{x}_{P}-\mathbf{x}\right)^{2} d \mathbf{x}
$$

其中和被扩展到网格的所有内部顶点。这种程序的名称来源于谐波函数（拉普拉斯核中的函数）的已知属性，即在域的某一点上取值等于包含该点的封闭曲线上的平均值。

最终的网格一般取决于顶点的位移顺序，一个接一个。此外，请注意，这个程序可以提供一个非

![](https://cdn.mathpix.com/cropped/10058ab4e7f0c5bd6fe5bcd4db204623-159.jpg?height=216&width=509&top_left_y=580&top_left_x=202)

图6.13.一个点到凸多边形$\mathscr{K}_{P}$的重心的位移，该凸多边形由包含$P$的元素联合组成

如果$\mathscr{K}_{P}$是一个凹形的多边形，则是可接受的网格，因为$\mathbf{x}_{P}$可以从多边形中掉出来。我们提出一个适用于一般元素补丁的程序的扩展。考虑图6.14，它显示了一个凹形补丁$\mathscr{K}_{P}$ 。我们将$\mathscr{C}_{P}$定义为$\mathscr{K}_{P}$中对$\mathscr{K}_{P}$的所有边界点 "可见 "的位置，即$\mathscr{C}_{P}=\left\{A \in \mathscr{K}_{P}: A B \subset \mathscr{K}_{P}, \forall B \in \partial \mathscr{K}_{P}\right\}$；注意，$\mathscr{C}_{P}$总是凸的。正则化算法的修改包括将$P$不放在$\mathscr{K}_{P}$的重心，而是放在$\mathscr{C}_{P}$的重心，如图6.14所示。显然，在凸斑块的情况下，我们有$\mathscr{C}_{P}=\mathscr{K}_{P}$ 。集合$\mathscr{C}_{P}$可以通过使用合适的算法以高效的计算方式构建，其描述超出了本书的范围。

另一个选择是将顶点移到$\mathscr{K}_{P}$（或$\mathscr{C}_{P}$在凹面补丁的情况下）边界的重心，也就是说，设置

!!!!
\mathbf{x}_{P}=\left|\partial \mathscr{K}_{P}\right|^{-1} \int_{\partial \mathscr{K}_{P}} \mathbf{x} d \mathbf{x}
$$


![](https://cdn.mathpix.com/cropped/10058ab4e7f0c5bd6fe5bcd4db204623-160.jpg?height=218&width=498&top_left_y=110&top_left_x=210)

图6.14.拉普拉斯正则化算法对凹形斑块的修改。左手边是初始补丁；右手边是由于正则化而进行的修改。我们对凹陷的多边形$\mathscr{C}_{P}$进行了阴影处理。

![](https://cdn.mathpix.com/cropped/10058ab4e7f0c5bd6fe5bcd4db204623-160.jpg?height=277&width=280&top_left_y=431&top_left_x=149)
 ![](https://cdn.mathpix.com/cropped/10058ab4e7f0c5bd6fe5bcd4db204623-160.jpg?height=278&width=614&top_left_y=430&top_left_x=148)

这相当于最小化顶点$P$和形成补丁边界的两侧之间距离的平方。

还有一种技术，经常出现在文献中，包括将每个内部顶点移到属于相关补丁的顶点的重心，即通过计算每个内部顶点的新位置$P$。

!!!!
\mathbf{x}_{P}=\left(\sum_{N \in \mathscr{K}_{P} \atop N \neq P} \mathbf{x}_{N}\right) /\left(\sum_{N \in \mathscr{\mathscr { X }}_{P} \atop N \neq P} 1\right)
$$

其中总和被扩展到属于补丁的所有顶点$N$。尽管是最简单的方法，但后者经常产生不好的结果，特别是当补丁内顶点的分布非常不规则时。此外，将其扩展到凹形斑块也比较困难。因此，前面的两个程序是比较好的。在图$6.15$中，我们介绍了一个连续应用上述两种正则化技术的例子。请注意，这里介绍的正则化算法倾向于统一网格，因此可以防止其变厚或变粗，例如由于网格适应性程序，如第四章中描述的那些。 然而，有可能修改它们以考虑到非统一的间距。例如，可以使用加权中心化，即通过设置

!!!!
\mathbf{x}_{P}=\left(\int_{\mathscr{K}_{P}} \mu(\mathbf{x}) d \mathbf{x}\right)^{-1} \int_{\mathscr{K}_{P}} \mu(\mathbf{x}) \mathbf{x} d \mathbf{x}
$$

其中严格正的权重函数$\mu$取决于网格间距函数。在非均匀间距的情况下，$\mu$将在网格必须更细的区域采取更大的数值。例如，当选择$\mu=\mathscr{H}^{-1}$时，产生的网格（大约）最小化了

!!!!
\sum_{P} \int_{\mathscr{K}_{P}}\left[\mathscr{H}^{-1}(\mathbf{x})\left(\mathbf{x}_{P}-\mathbf{x}\right)\right]^{2} d \mathbf{x}
$$

其中，和被扩展到内部顶点。

同样关于对角线交换程序，我们可以在评估 "最佳 "配置时考虑到间距，例如通过适当地改变 \ref{6.3} 中的函数 $S(K)$ 的定义。第七章

\section{Algorithms for the solution of linear systems}

本章是对用于解决线性代数方程组的一些基本算法的快速和初级介绍。对于更全面的介绍，我们建议读者参考，例如，[QSS07，Chaps.3和4 $]$ , [Saa96] 和 [vdV03]。

在$m$未知数中的$n$线性方程组是一组代数关系，其形式为

!!!!
\sum_{j=1}^{n} a_{i j} x_{j}=b_{i}, \quad i=1, \ldots, m
\label{7.1}\end{equation}

$x_{j}$为未知数，$a_{i j}$为系统的系数，$b_{i}$为给定数。系统\ref{7.1}更常见的写法是矩阵形式

!!!!
\mathrm{Ax}=\mathbf{b}
\label{7.2}\end{equation}

用$\mathrm{A}=\left(a_{i j}\right) \in \mathbb{R}^{m \times n}$表示系数矩阵，$\mathbf{b}=\left(b_{i}\right) \in \mathbb{R}^{m}$是右手向量，$\mathbf{x}=\left(x_{i}\right) \in \mathbb{R}^{n}$是未知向量。我们把\ref{7.2}的任何$n$-tuple的值$x_{i}$验证\ref{7.1}的解决方案称为。

在下面的章节中，我们将回顾在$m=n$的情况下求解\ref{7.2} 的一些数值技术；显然，我们将假设$\mathrm{A}$是非奇异的，即$\operatorname{det}(\mathrm{A}) \neq 0$ 。如果数值方法能在有限次数的运算中得到系统的解，则称为直接方法；如果需要（理论上）无限次的运算，则称为迭代方法。

\subsection{Direct methods}

线性系统的解可以通过高斯消除法（GEM）找到，其中初始系统$A \mathbf{x}=\mathbf{b}$在$n$步中被还原为形式为$\mathrm{A}^{(n)} \mathbf{x}=\mathbf{b}^{(n)}$的等效系统（即具有相同的解），其中$\mathrm{A}^{(n)}=\mathrm{U}$是一个非星形上三角矩阵，$\mathbf{b}^{(n)}$是一个新源项。通过下面的后向替换算法，可以用$n^{2}$次的计算成本来解决后一系统。

!!!!
\begin{aligned}
x_{n} &=\frac{b_{n}^{(n)}}{u_{n n}} \\
x_{i} &=\frac{1}{u_{i i}}\left(b_{i}^{(n)}-\sum_{j=i+1}^{n} u_{i j} x_{j}\right), \quad i=n-1, \ldots, 1
\end{aligned}
\label{7.3}\end{equation}

用$\mathrm{A}^{(1)} \mathbf{x}=\mathbf{b}^{(1)}$表示原始系统，GEM的第k步是通过以下公式实现的。

!!!!
\begin{aligned}
&m_{i k}=\frac{a_{i k}^{(k)}}{a_{k k}^{(k)}}, \quad i=k+1, \ldots, n \\
&a_{i j}^{(k+1)}=a_{i j}^{(k)}-m_{i k} a_{k j}^{(k)}, \quad i, j=k+1, \ldots, n \\
&b_{i}^{(k+1)}=b_{i}^{(k)}-m_{i k} b_{k}^{(k)}, \quad i=k+1, \ldots, n .
\end{aligned}
\label{7.4}\end{equation}

我们注意到，这样一来，元素$a_{i j}^{(k+1)}$与$j=k$和$i=k+1, \ldots, n$是空的。元素$m_{i k}$被称为乘数，而分母$a_{k k}^{(k)}$被称为枢轴元素。显然，只有当所有的枢轴元素都是非空时，才能实现GEM。例如，对于对称正定矩阵和严格的对角线主导矩阵，就会出现这种情况。一般来说，有必要采用枢轴法，即交换$\mathrm{A}^{(k)}$的行（和/或列），以确保$a_{k k}^{(k)}$元素为非空。

为了完成高斯消元，我们需要$2(n-1) n(n+1) / 3+n(n-1)$个flops，我们必须加上$n^{2}$个flops，以通过后向替代法解决上三角系统$U \mathbf{x}=\mathbf{b}^{(n)}$。因此，大约需要$\left(2 n^{3} / 3+2 n^{2}\right)$个flops来通过GEM解决线性系统。更简单地说，通过忽略$n$中的低阶项，可以说高斯消除过程需要$2 n^{3} / 3$flops。

GEM相当于对矩阵$\mathrm{A}$进行因式分解，即把$\mathrm{A}$改写为两个矩阵的积$\mathrm{LU}$。矩阵$\mathrm{U}$，上三角，与消除过程结束时得到的矩阵$\mathrm{A}^{(n)}$相吻合。矩阵$\mathrm{L}$是下三角，其对角线元素等于1，而位于剩余下三角部分的元素等于乘数。

一旦矩阵$L$和$U$是已知的，初始线性系统的解决方案只是涉及两个三角系统的（连续）解决方案

!!!!
\mathbf{L} \mathbf{y}=\mathbf{b}, \quad \mathbf{U} \mathbf{x}=\mathbf{y}
$$

很明显，因式分解过程的计算成本与GEM所要求的计算成本相同。这种重新解释的优点是显而易见的：由于$\mathrm{L}$和$\mathrm{U}$只取决于A，而不取决于已知项，同样的因式分解可以用来解决具有相同矩阵A，但具有可变已知项b的不同线性系统（例如考虑用隐式方法对线性抛物线问题进行离散化，在每个时间步长中，必须解决具有相同矩阵，但具有不同常数项的系统）。因此，由于计算成本集中在消除过程中，当我们想解决具有相同矩阵的几个线性系统时，我们可以通过这种方式大大减少操作的数量。

如果$\mathrm{A}$是一个正无限的对称矩阵，那么LU因子化可以很方便地进行专业化。事实上，只存在一个对角线上有正元素的上三角矩阵$\mathrm{H}$，使得

!!!!
\mathrm{A}=\mathrm{H}^{\mathrm{T}} \mathrm{H}
\label{7.5}\end{equation}

方程\ref{7.5} 是所谓的Cholesky因式分解。$h_{i j}$的元素$\mathrm{H}^{T}$由以下公式给出。  $h_{11}=\sqrt{a_{11}}$和，对于$i=2, \ldots, n$ :

!!!!
\begin{aligned}
&h_{i j}=\left(a_{i j}-\sum_{k=1}^{j-1} h_{i k} h_{j k}\right) / h_{j j}, \quad j=1, \ldots, i-1 \\
&h_{i i}=\left(a_{i i}-\sum_{k=1}^{i-1} h_{i k}^{2}\right)^{1 / 2}
\end{aligned}
$$

这个算法只需要大约$n^{3} / 3$个flops，也就是说，它节省了大约两倍于LU分解的计算时间和大约一半的内存。

现在让我们考虑一个线性系统的特殊情况，该系统的非正交三对角矩阵A的形式为

!!!!
\mathrm{A}=\left[\begin{array}{cccc}
a_{1} & c_{1} & & 0 \\
b_{2} & a_{2} & \ddots & \\
& \ddots & & c_{n-1} \\
0 & & b_{n} & a_{n}
\end{array}\right]
$$

在这种情况下，$\mathrm{L}$和$\mathrm{U}$的LU因子化的矩阵$\mathrm{A}$是二对角矩阵，其类型为

!!!!
\mathrm{L}=\left[\begin{array}{cccc}
1 & & & 0 \\
\beta_{2} & 1 & & \\
& \ddots & \ddots & \\
0 & & \beta_{n} & 1
\end{array}\right], \quad \mathrm{U}=\left[\begin{array}{cccc}
\alpha_{1} & c_{1} & & 0 \\
& \alpha_{2} & \ddots & \\
& & \ddots & c_{n-1} \\
0 & & & \alpha_{n}
\end{array}\right]
$$

未知系数$\alpha_{i}$和$\beta_{i}$可以通过以下公式轻松计算出来。

!!!!
\alpha_{1}=a_{1}, \quad \beta_{i}=\frac{b_{i}}{\alpha_{i-1}}, \quad \alpha_{i}=a_{i}-\beta_{i} c_{i-1}, i=2, \ldots, n
$$

这种算法被命名为Thomas算法，可以被看作是一种特殊的无枢轴的LU因子化。

\subsection{Iterative methods}

迭代方法旨在构建一个线性系统的解$\mathbf{x}$，作为向量序列$\left\{\mathbf{x}^{(n)}\right\}$的极限。为了获得该序列的单个元素，需要计算系统的残差$\mathbf{r}^{(n)}=\mathbf{b}-A \mathbf{x}^{(n)}$。在矩阵是完整的且阶数为$n$的情况下，迭代方法的计算成本为每次迭代$n^{2}$次的运算。这种成本必须与直接方法所需的大约$2 n^{3} / 3$次操作进行比较。因此，只有当达到收敛所需的迭代次数（在给定的公差范围内）与$n$无关或以亚线性方式依赖于$n$时，迭代方法才能与直接方法竞争。

一旦矩阵是稀疏的，在选择迭代方法和直接方法时的其他考虑因素就会介入。

\subsubsection{Classical iterative methods}

构建迭代方法的一般策略是基于加法分解，称为分裂，从形式为$\mathrm{A}$的矩阵开始，其中$\mathrm{P}$和$\mathrm{N}$是两个合适的矩阵，$\mathrm{P}$是非星形的。由于其余部分将变得明显的原因，$\mathrm{P}$也被称为预处理矩阵或预处理器。

准确地说，给定$\mathbf{x}^{(0)}$，我们通过解决新的系统得到$\mathbf{x}^{(k)}$的$k \geq 1$。

!!!!
\mathbf{P x}^{(k+1)}=\mathbf{N} \mathbf{x}^{(k)}+\mathbf{b}, \quad k \geq 0
\label{7.6}\end{equation}

或者，等同于。

!!!!
\mathbf{x}^{(k+1)}=\mathbf{B} \mathbf{x}^{(k)}+\mathbf{P}^{-1} \mathbf{b}, \quad k \geq 0
\label{7.7}\end{equation}

用$\mathrm{B}=\mathrm{P}^{-1} \mathrm{~N}$表示了迭代矩阵。

我们对可收敛的迭代方法感兴趣，即对于每个初始向量$\lim _{k \rightarrow \infty} \mathbf{e}^{(k)}=\mathbf{0}$的选择，用$\mathbf{e}^{(k)}=\mathbf{x}^{(k)}-\mathbf{x}$表示误差。通过递归论证，我们发现

!!!!
\mathbf{e}^{(k)}=\mathrm{B}^{k} \mathbf{e}^{(0)}, \quad \forall k=0,1, \ldots
\label{7.8}\end{equation}

因此可以得出结论，当且仅当$\rho(\mathrm{B})<1, \rho(\mathrm{B})$为迭代矩阵$\mathrm{B}$的谱半径，即$\mathrm{B}$的特征值的最大模数时，形式\ref{7.6} 的迭代方法是收敛的。方程\ref{7.6}也可以用以下形式表述

!!!!
\mathbf{x}^{(k+1)}=\mathbf{x}^{(k)}+\mathbf{P}^{-1} \mathbf{r}^{(k)}
\label{7.9}\end{equation}

表示的是

!!!!
\mathbf{r}^{(k)}=\mathbf{b}-\mathrm{A} \mathbf{x}^{(k)}
\label{7.10}\end{equation}

在步骤$k$的残值。因此，方程\ref{7.9} 表达了这样一个事实：为了更新步骤$k+1$的解决方案，有必要解决一个带有矩阵$\mathrm{P}$的线性系统。因此，除了非奇异性之外，如果我们想防止方案的整体成本过度增加，P必须是可逆的，计算成本很低（显然，在$\mathrm{P}$等于$\mathrm{A}$和$\mathrm{N}=0$的极限情况下，方法\ref{7.9}仅在一次迭代中收敛，但以直接方法为代价）。

现在让我们看看如何利用后一种形式来加速迭代方法\ref{7.6}的收敛。我们用

!!!!
\mathrm{R}_{\mathrm{P}}=\mathrm{I}-\mathrm{P}^{-1} \mathrm{~A}
$$

是与方法\ref{7.9} 相关的迭代矩阵。方程\ref{7.9}可以通过引入一个合适的松弛(或加速)参数来进行概括 $\alpha$ 。这样，我们就得到了静止的Richardson方法（或者，简单地说，Richardson方法），其形式为

!!!!
\mathbf{x}^{(k+1)}=\mathbf{x}^{(k)}+\alpha \mathrm{P}^{-1} \mathbf{r}^{(k)}, \quad k \geq 0
\label{7.11}\end{equation}

更一般地说，假设$\alpha$依赖于迭代指数，我们得到非稳态的理查德森方法，由以下公式给出

!!!!
\mathbf{x}^{(k+1)}=\mathbf{x}^{(k)}+\alpha_{k} \mathrm{P}^{-1} \mathbf{r}^{(k)}, \quad k \geq 0
\label{7.12}\end{equation}

如果我们设定$\alpha=1$，我们可以恢复两种经典的迭代方法：如果$\mathrm{P}=\mathrm{D}(\mathrm{A})$（$A$的对角线部分），雅可比方法，如果$\mathrm{P}=\mathrm{L}(\mathrm{A})$（$A$的下三角部分），高斯-赛德尔方法。

这种方法在步骤$\mathrm{k}$的迭代矩阵为

!!!!
\mathrm{R}\left(\alpha_{k}\right)=\mathrm{I}-\alpha_{k} \mathrm{P}^{-1} \mathrm{~A}
$$

(注意，后者取决于$k$）。)在$\mathrm{P}=\mathrm{I}$的情况下，所研究的方法将被称为非预设条件。

我们可以把\ref{7.12}(因此也包括\ref{7.11})改写成一个更有计算价值的形式。事实上，在设定了$\mathbf{z}^{(k)}=\mathrm{P}^{-1} \mathbf{r}^{(k)}$（所谓的预设残差）后，我们有$\mathbf{x}^{(k+1)}=\mathbf{x}^{(k)}+\alpha_{k} \mathbf{z}^{(k)}$和$\mathbf{r}^{(k+1)}=\mathbf{b}-\mathrm{A} \mathbf{x}^{(k+1)}=\mathbf{r}^{(k)}-\alpha_{k} \mathrm{~A} \mathbf{z}^{(k)}$ 。总而言之，在步骤$k+1$的非稳态理查德森方法需要以下操作。

!!!!
\text { solving the linear system } \mathrm{P} \mathbf{z}^{(k)}=\mathbf{r}^{(k)} \text {, }
$$

计算加速参数 $\alpha_{k}$ 。

!!!!
\text { updating the solution } \mathbf{x}^{(k+1)}=\mathbf{x}^{(k)}+\alpha_{k} \mathbf{z}^{(k)} \text {, }
$$

!!!!
\text { updating the residue } \mathbf{r}^{(k+1)}=\mathbf{r}^{(k)}-\alpha_{k} \mathbf{A} \mathbf{z}^{(k)} \text {. }
\label{7.13}\end{equation}

就静止的理查德森方法的收敛性而言（对于该方法$\alpha_{k}=\alpha$ ，对于每个$k \geq 0$ ），以下结果成立。


Property 7.1. If $\mathrm{P}$ is a non-singular matrix, the stationary Richardson method (7.11) is convergent if and only if

!!!!
\frac{2 \operatorname{Re} \lambda_{i}}{\alpha\left|\lambda_{i}\right|^{2}}>1 \quad \forall i=1, \ldots, n
\label{7.14}\end{equation}

$\lambda_{i}$ being the eigenvalues of $\mathrm{P}^{-1} \mathrm{~A}$.
Moreover, if we suppose that $\mathrm{P}^{-1}$ A has positive real eigenvalues, ordered in such a way that $\lambda_{1} \geq \lambda_{2} \geq \ldots \geq \lambda_{n}>0$, then the stationary Richardson method $(7.11)$ converges if and only if $0<\alpha<2 / \lambda_{1}$. Having set

!!!!
\alpha_{o p t}=\frac{2}{\lambda_{1}+\lambda_{n}}
\label{7.15}\end{equation}

the spectral radius of the iteration matrix $\mathrm{R}_{\alpha}$ is minimal if $\alpha=\alpha_{o p t}$, with


!!!!
\rho_{o p t}=\min _{\alpha}\left[\rho\left(\mathrm{R}_{\alpha}\right)\right]=\frac{\lambda_{1}-\lambda_{n}}{\lambda_{1}+\lambda_{n}}
\label{7.16}\end{equation}

如果$\mathrm{P}$和$\mathrm{A}$都是对称和正定的，可以证明Richardson方法相对于向量规范$\|\cdot\|_{2}$和$\|\cdot\|_{\mathrm{A}}$而言是单调收敛的。我们回顾一下，$\|\mathbf{v}\|_{2}=\left(\sum_{i=1}^{n} v_{i}^{2}\right)^{1 / 2}$和$\|\mathbf{v}\|_{\mathrm{A}}=\left(\sum_{i, j=1}^{n} v_{i} a_{i j} v_{j}\right)^{1 / 2}$.

在这种情况下，由于\ref{7.16}，我们可以将$\rho_{o p t}$与第1节中介绍的条件数联系起来。  $4.5 .2$以如下方式联系起来。

!!!!
\rho_{o p t}=\frac{K_{2}\left(\mathrm{P}^{-1} \mathrm{~A}\right)-1}{K_{2}\left(\mathrm{P}^{-1} \mathrm{~A}\right)+1}, \quad \alpha_{o p t}=\frac{2\left\|\mathrm{~A}^{-1} \mathrm{P}\right\|_{2}}{K_{2}\left(\mathrm{P}^{-1} \mathrm{~A}\right)+1}
\label{7.17}\end{equation}

因此，Richardson方法中预处理程序$\mathrm{P}$的选择的重要性显而易见。我们参考[QSS07]的第4章，了解一些预处理程序的例子。

\subsubsection{Gradient and conjugate gradient methods}

加速参数$\alpha$的最佳表达式，在\ref{7.15} 中指出，原来没有什么实际用途，因为它需要知道矩阵$\mathrm{P}^{-1} \mathrm{~A}$的最大和最小特征值。在正定对称矩阵的特殊情况下，有可能以动态方式评估最佳加速参数，即作为方法本身在步骤$k$中计算的数量的函数，正如我们在下面显示的那样。

首先，我们观察到，在$\mathrm{A}$是对称正定矩阵的情况下，解系统\ref{7.2} 等同于找到二次形式的最小值$\mathbf{x} \in \mathbb{R}^{n}$。

!!!!
\Phi(\mathbf{y})=\frac{1}{2} \mathbf{y}^{T} \mathrm{~A} \mathbf{y}-\mathbf{y}^{T} \mathbf{b}
$$

称为系统的能量\ref{7.2} 。

因此，问题被简化为从一个点$\mathbf{x}^{(0)} \in \mathbb{R}^{n}$开始确定$\Phi$的最小点$\mathbf{x}$，并因此选择合适的方向，以尽快接近解$\mathbf{x}$。连接$\mathbf{x}^{(0)}$和$\mathbf{x}$的最佳方向显然是先验的：因此我们必须从$\mathbf{x}^{(0)}$沿着另一个方向$\mathbf{d}^{(0)}$移动，并在后者上固定一个新点$\mathbf{x}^{(1)}$，然后重复这个程序直到收敛。

在通用步骤$k$，我们将确定$\mathbf{x}^{(k+1)}$为

!!!!
\mathbf{x}^{(k+1)}=\mathbf{x}^{(k)}+\alpha_{k} \mathbf{d}^{(k)}
\label{7.18}\end{equation}

$\alpha_{k}$是固定沿$\mathbf{d}^{(k)}$步长的数值。最自然的想法是将$\Phi$的最大增幅作为下坡方向，由$\mathbf{r}^{(k)}=-\nabla \Phi\left(\mathbf{x}^{(k)}\right)$给出，这导致了梯度或最陡峭的下降方法。

后者导致以下算法：给定$\mathbf{x}^{(0)} \in \mathbb{R}^{n}$，并设定$\mathbf{r}^{(0)}=!!!!\mathbf{b}-\mathbf{A} \mathbf{x}^{(0)}$，对于$k=0,1, \ldots$，直到收敛，我们计算出

!!!!
\begin{aligned}
&\alpha_{k}=\frac{\mathbf{r}^{(k)^{T}} \mathbf{r}^{(k)}}{\mathbf{r}^{(k)^{T}} \mathrm{Ar}^{(k)}} \\
&\mathbf{x}^{(k+1)}=\mathbf{x}^{(k)}+\alpha_{k} \mathbf{r}^{(k)} \\
&\mathbf{r}^{(k+1)}=\mathbf{r}^{(k)}-\alpha_{k} \mathrm{~A} \mathbf{r}^{(k)}
\end{aligned}
$$

它的预设版本有以下形式：给定$\mathbf{x}^{(0)} \in \mathbb{R}^{n}$，并设定$\mathbf{r}^{(0)}=b-\mathbf{A} \mathbf{x}^{(0)}, \mathbf{z}^{(0)}=P^{-1} \mathbf{r}^{(0)}$，对于$k=0,1, \ldots$，直到收敛，我们计算一下

!!!!
\begin{aligned}
&\alpha_{k}=\frac{\mathbf{z}^{(k)^{T}} \mathbf{r}^{(k)}}{\mathbf{z}^{(k)^{T}} \mathbf{A} \mathbf{z}^{(k)}} \\
&\mathbf{x}^{(k+1)}=\mathbf{x}^{(k)}+\alpha_{k} \mathbf{z}^{(k)} \\
&\mathbf{r}^{(k+1)}=\mathbf{r}^{(k)}-\alpha_{k} \mathbf{A} \mathbf{z}^{(k)} \\
&P \mathbf{z}^{(k+1)}=\mathbf{r}^{(k+1)}
\end{aligned}
$$

就血统法的收敛特性而言，以下结果成立

Theorem 7.1. If A is symmetric and positive definite, the gradient method converges for each value of the initial datum $\mathbf{x}^{(0)}$ and

!!!!
\left\|\mathbf{e}^{(k+1)}\right\|_{\mathrm{A}} \leq \frac{K_{2}(\mathrm{~A})-1}{K_{2}(\mathrm{~A})+1}\left\|\mathbf{e}^{(k)}\right\|_{\mathrm{A}}, \quad k=0,1, \ldots
\label{7.19}\end{equation}

where $\|\cdot\|_{\mathrm{A}}$ is the previously defined energy norm.

只要我们假设$K_{2}$(A)被$K_{2}\left(\mathrm{P}^{-1} \mathrm{~A}\right)$取代，类似的结果在预设梯度法的情况下也成立，$P$也是对称和正定的。

一个更有效的替代方法是使用共轭梯度法，其中下降方向不再与剩余物的方向重合。特别是，在设定了$\mathbf{p}^{(0)}=\mathbf{r}^{(0)}$之后，我们寻求的是以下形式的方向

!!!!
\mathbf{p}^{(k+1)}=\mathbf{r}^{(k+1)}-\beta_{k} \mathbf{p}^{(k)}, \quad k=0,1, \ldots
\label{7.20}\end{equation}

其中参数$\beta_{k} \in \mathbb{R}$将被确定，以便

!!!!
\left(\mathrm{Ap}^{(j)}\right)^{T} \mathbf{p}^{(k+1)}=0, \quad j=0,1, \ldots, k .
\label{7.21}\end{equation}

这种类型的方向被称为A-正交（或A-共轭）。在预设条件的情况下，方法的形式是：给定$\mathbf{x}^{(0)} \in \mathbb{R}^{n}$，设置$\mathbf{r}^{(0)}=\mathbf{b}-\mathbf{A} \mathbf{x}^{(0)}$、$\mathbf{z}^{(0)}=\mathrm{P}^{-1} \mathbf{r}^{(0)}$和$\mathbf{p}^{(0)}=\mathbf{z}^{(0)}$，$k$的第1次迭代，与$k=0,1 \ldots$，是

!!!!
\begin{aligned}
&\alpha_{k}=\frac{\mathbf{p}^{(k)^{T}} \mathbf{r}^{(k)}}{\left(\mathrm{A} \mathbf{p}^{(k)}\right)^{T} \mathbf{p}^{(k)}} \\
&\mathbf{x}^{(k+1)}=\mathbf{x}^{(k)}+\alpha_{k} \mathbf{p}^{(k)} \\
&\mathbf{r}^{(k+1)}=\mathbf{r}^{(k)}-\alpha_{k} \mathrm{~A} \mathbf{p}^{(k)}, \\
&\mathrm{P} \mathbf{z}^{(k+1)}=\mathbf{r}^{(k+1)} \\
&\beta_{k}=\frac{\left(\mathrm{A} \mathbf{p}^{(k)}\right)^{T} \mathbf{z}^{(k+1)}}{\mathbf{p}^{(k)^{T}} \mathrm{Ap}^{(k)}}, \\
&\mathbf{p}^{(k+1)}=\mathbf{z}^{(k+1)}-\beta_{k} \mathbf{p}^{(k)} .
\end{aligned}
$$

参数$\alpha_{k}$的选择是为了保证误差$\left\|\mathbf{e}^{(k+1)}\right\|_{\mathrm{A}}$沿下降方向$\mathbf{p}^{(k)}$最小。相反，参数$\beta_{k}$的选择是为了使新的方向$\mathbf{p}^{(k+1)}$与$\mathbf{p}^{(k)}$，即$\left(\mathrm{Ap}^{(k)}\right)^{T} \mathbf{p}^{(k+1)}=0$有A共轭。事实上，可以证明（由于归纳原则），如果后一种关系被验证，那么相对于\ref{7.21}中的所有关系也被验证。关于该方法的完整论证，见例如 [QSS07, Chap. 4] 或 [Saa96] 。

可以证明，共轭梯度法在精确算术中最多只需$n$步就能收敛，并且

!!!!
\left\|\mathbf{e}^{(k)}\right\|_{\mathrm{A}} \leq \frac{2 c^{k}}{1+c^{2 k}}\left\|\mathbf{e}^{(0)}\right\|_{\mathrm{A}}
\label{7.22}\end{equation}

与

!!!!
c=\frac{\sqrt{K_{2}\left(\mathrm{P}^{-1} \mathrm{~A}\right)}-1}{\sqrt{K_{2}\left(\mathrm{P}^{-1} \mathrm{~A}\right)}+1}
\label{7.23}\end{equation}

在没有舍入误差的情况下，CG方法因此可以被看作是一种直接方法，因为它在有限的操作次数后就会终止。

另一方面，对于大维度的矩阵，它通常作为一种迭代方法来应用，一旦误差估计值（例如相对残差）小于一个给定的公差，就会立即停止。

由于\ref{7.23}，误差的减少系数对矩阵条件数的依赖性比梯度法的更有利（由于存在$\left.K_{2}\left(P^{-1} \mathrm{~A}\right)\right)$的平方根。

可以注意到，对于预设条件的共轭梯度方法，收敛所需的迭代次数（在规定的容限内）与$\frac{1}{2} \sqrt{K_{2}\left(P^{-1} A\right)}$成正比，相对于预设条件梯度方法的$\frac{1}{2} K_{2}\left(P^{-1} A\right)$，这是一个明显的改进。当然，PCG方法每次迭代的成本更高，包括CPU时间和存储。

\subsubsection{Krylov subspace methods}

在矩阵$\mathrm{A}$不对称的情况下，梯度方法的一般化导致了所谓的Krylov方法。值得注意的例子是GMRES方法和共轭大梯度方法BiCG，以及其稳定版本BiCGSTAB方法。有兴趣的读者可以参考[QSS07, Chap. 4], [Saa96]和[vdV03]。

这里我们简要回顾一下GMRES（广义最小残差）方法。我们首先用\ref{7.13}重温了Richardson方法$\mathrm{P}=\mathrm{I}$；$k$第1步的残差可以通过以下方式与初始残差联系起来

!!!!
\mathbf{r}^{(k)}=\prod_{j=0}^{k-1}\left(\mathrm{I}-\alpha_{j} \mathrm{~A}\right) \mathbf{r}^{(0)}=p_{k}(\mathrm{~A}) \mathbf{r}^{(0)}
\label{7.24}\end{equation}

其中$p_{k}$ (A)是A的多项式，度数为$k$ 。如果我们引入空间

!!!!
K_{m}(\mathrm{~A} ; \mathbf{v})=\operatorname{span}\left\{\mathbf{v}, \mathrm{Av}, \ldots, \mathrm{A}^{m-1} \mathbf{v}\right\}
\label{7.25}\end{equation}

由\ref{7.24} 可知，$\mathbf{r}^{(k)} \in K_{k+1}\left(\mathrm{~A} ; \mathbf{r}^{(0)}\right)$ 。在\ref{7.25}中定义的空间被称为与矩阵$A$和向量$\mathbf{v}$相关的阶$m$的Krylov子空间。它是$\mathbb{R}^{n}$的一个子空间，可以写成$\mathbf{u}=p_{m-1}(\mathrm{~A}) \mathbf{v}$ ，其中$p_{m-1}$是程度为$\leq m-1$的A的多项式。

同样地，理查德森方法的第$k$次迭代可以表示如下

!!!!
\mathbf{x}^{(k)}=\mathbf{x}^{(0)}+\sum_{j=0}^{k-1} \alpha_{j} \mathbf{r}^{(j)}
$$

因此，$\mathbf{x}^{(k)}$属于空间

!!!!
W_{k}=\left\{\mathbf{v}=\mathbf{x}^{(0)}+\mathbf{y}, \mathbf{y} \in K_{k}\left(\mathrm{~A} ; \mathbf{r}^{(0)}\right)\right\}
\label{7.26}\end{equation}

还请注意，$\sum_{j=0}^{k-1} \alpha_{j} \mathbf{r}^{(j)}$是一个度数小于$k-1$的A项多项式。因此，在非先决条件的理查德森方法中，我们要在空间$W_{k}$中寻找$\mathbf{x}$的近似解。更一般地说，我们可以设计出一些方法来寻找以下形式的近似解

!!!!
\mathbf{x}^{(k)}=\mathbf{x}^{(0)}+q_{k-1}(\mathrm{~A}) \mathbf{r}^{(0)}
\label{7.27}\end{equation}

其中$q_{k-1}$是以这样的方式选择的多项式，即$\mathbf{x}^{(k)}$在$W_{k}$中是$\mathbf{x}$的最佳近似值，这个意义必须精确。寻找\ref{7.27}形式的解决方案的方法被称为Krylov方法。

关于Krylov子空间迭代的第一个问题是$K_{m}(\mathrm{~A} ; \mathbf{v})$的维度是否随着阶数$m$的增长而增加。下面提供一个部分答案。

属性7.2。设$\mathrm{A} \in \mathbb{R}^{n \times n}$和$\mathbf{v} \in \mathbb{R}^{n}$ .Krylov子空间$K_{m}(\mathrm{~A} ; \mathbf{v})$具有二-

如果$m$相对于A的度数等于$\mathbf{v}$，则用deg $_{\mathrm{A}}(\mathbf{v})$ 表示。

不小于$m ;$，$\mathbf{v}$的度数被定义为一个单数的最小度数。

A中的非空多项式$p$，对其而言，$p(\mathrm{~A}) \mathbf{v}=\mathbf{0}$是指

因此，$K_{m}(\mathrm{~A} ; \mathbf{v})$的维度等于$m$和$\mathbf{v}$相对于$\mathrm{A}$的最小值，因此，Krylov子空间的维度是$m$的非递减函数。由于Cayley-Hamilton定理，$\mathbf{v}$的度数不能大于$n$（见[QSS07, Sect. 1.7]）。

例7.1.考虑$4 \times 4$矩阵$\mathrm{A}=\operatorname{tridiag}_{4}(-1,2,-1)$ 。向量$\mathbf{v}=$ $[1,1,1,1]^{T}$相对于A有2度，因为$p_{2}(\mathrm{~A}) \mathbf{v}=\mathbf{0}$与$p_{2}(\mathrm{~A})=\mathrm{I}_{4}-3 \mathrm{~A}+\mathrm{A}^{2}$( $\mathrm{I}_{4}$是$4 \times 4$的身份矩阵$)$ ，而没有1度的单项多项式$p_{1}$，对于$p_{1}(\mathrm{~A}) \mathbf{v}=\mathbf{0}$ 。因此，从$K_{2}(\mathrm{~A} ; \mathbf{v})$开始的所有Krylov子空间的维度都等于$2$ 。矢量$\mathbf{w}=[1,1,-1,1]^{T}$相对于$\mathrm{A}$具有4度。

对于一个固定的$m$，可以用所谓的Arnoldi算法计算出$K_{m}(\mathrm{~A} ; \mathbf{v})$的正态基。

设置$\mathbf{v}_{1}=\mathbf{v} /\|\mathbf{v}\|_{2}$，该方法使用Gram-Schmidt程序为$K_{m}\left(\mathrm{~A} ; \mathbf{v}_{1}\right)$生成一个正交基$\left\{\mathbf{v}_{i}\right\}$（见[QSS07, Sect. 3.4.3]）。对于$k=1, \ldots, m$，Arnoldi算法的计算结果是

!!!!
\begin{array}{ll}
h_{i k} & =\mathbf{v}_{i}^{T} \mathrm{~A} \mathbf{v}_{k}, & i=1,2, \ldots, k \\
\mathbf{w}_{k} & =\mathrm{A} \mathbf{v}_{k}-\sum_{i=1}^{k} h_{i k} \mathbf{v}_{i}, & h_{k+1, k}=\left\|\mathbf{w}_{k}\right\|_{2} .
\end{array}
\label{7.28}\end{equation}

如果$\mathbf{w}_{k}=\mathbf{0}$进程终止，在这种情况下，我们说算法发生了故障；否则，我们设置$\mathbf{v}_{k+1}=\mathbf{w}_{k} /\left\|\mathbf{w}_{k}\right\|_{2}$，算法重新启动，将$k$递增1。

可以证明，如果该方法在步骤$m$终止，那么向量$\mathbf{v}_{1}, \ldots, \mathbf{v}_{m}$构成$K_{m}(\mathrm{~A} ; \mathbf{v})$的一个基础。在这种情况下，如果我们用$\mathrm{V}_{m} \in \mathbb{R}^{n \times m}$表示其列是向量$\mathbf{v}_{i}$的矩阵，我们有

!!!!
\mathrm{V}_{m}^{T} \mathrm{AV}_{m}=\mathrm{H}_{m}, \quad \mathrm{~V}_{m+1}^{T} \mathrm{AV}_{m}=\widehat{\mathrm{H}}_{m}
\label{7.29}\end{equation}

其中$\widehat{\mathrm{H}}_{m} \in \mathbb{R}^{(m+1) \times m}$是上海森堡矩阵，其条目$h_{i j}$由\ref{7.28} 给出，而$\mathrm{H}_{m} \in \mathbb{R}^{m \times m}$是$\widehat{\mathrm{H}}_{m}$对前$m$行和$m$列的限制。

该算法在中间步骤 $k<m$ 终止，如果$\operatorname{deg}_{\mathrm{A}}\left(\mathbf{v}_{1}\right)=k$ 。至于程序的稳定性，所有对Gram-Schmidt方法有效的考虑都成立。对于\ref{7.28}的更有效和稳定的计算变体，我们参考[Saa96]。

我们现在准备用Krylov方法来解决线性系统\ref{7.2} 。我们在$\mathbf{x}^{(k)}$的形式下寻找迭代\ref{7.27}；对于给定的$\mathbf{r}^{(0)}, \mathbf{x}^{(k)}$是在$W_{k}$中唯一的元素，它满足与$\mathbf{x}$的最小距离标准。选择$\mathbf{x}^{(k)}$的标准正是Krylov方法的显著特征。

最自然的想法是寻找$\mathbf{x}^{(k)} \in W_{k}$作为最小化误差的欧氏规范的向量。然而，这种方法在实践中并不可行，因为$\mathbf{x}^{(k)}$将取决于（未知的）解决方案$\mathbf{x}$ 。可以采用两种替代策略。

1. 计算$\mathbf{x}^{(k)} \in W_{k}$，强制要求残差$\mathbf{r}^{(k)}$与$K_{k}\left(\mathrm{~A} ; \mathbf{r}^{(0)}\right)$中的任何矢量正交，即，我们寻找$\mathbf{x}^{(k)} \in W_{k}$，以便

!!!!
\mathbf{v}^{T}\left(\mathbf{b}-\mathbf{A} \mathbf{x}^{(k)}\right)=0 \quad \forall \mathbf{v} \in K_{k}\left(\mathrm{~A} ; \mathbf{r}^{(0)}\right)
\label{7.30}\end{equation}

2. 通过最小化残差$\mathbf{x}^{(k)} \in W_{k}$的欧氏规范来计算$\left\|\mathbf{r}^{(k)}\right\|_{2}$ ，即。

!!!!
\left\|\mathbf{b}-\mathrm{A} \mathbf{x}^{(k)}\right\|_{2}=\min _{\mathbf{v} \in W_{k}}\|\mathbf{b}-\mathrm{A} \mathbf{v}\|_{2}
\label{7.31}\end{equation}

替代方案1导致Arnoldi方法（更常见的是FOM，全正交化方法），而替代方案2产生GMRES（广义最小残差）方法。

我们将假设已经进行了阿诺尔迪算法的$k$步，因此$K_{k}\left(\mathrm{~A} ; \mathbf{r}^{(0)}\right)$的正态基已经生成，并存储到矩阵$V_{k}$的列向量中，与$\mathbf{v}_{1}=\mathbf{r}^{(0)} /\left\|\mathbf{r}^{(0)}\right\|_{2}$ 。在这种情况下，新的迭代$\mathbf{x}^{(k)}$总是可以被写成

!!!!
\mathbf{x}^{(k)}=\mathbf{x}^{(0)}+\mathrm{V}_{k} \mathbf{z}^{(k)},
\label{7.32}\end{equation}

其中$\mathbf{z}^{(k)}$必须根据我们将要指定的合适标准来选择。因此，我们有

!!!!
\mathbf{r}^{(k)}=\mathbf{r}^{(0)}-\mathrm{A} \mathrm{V}_{k} \mathbf{z}^{(k)}
\label{7.33}\end{equation}

由于$\mathbf{r}^{(0)}=\mathbf{v}_{1}\left\|\mathbf{r}^{(0)}\right\|_{2}$，并使用\ref{7.29}，关系\ref{7.33}变为

!!!!
\mathbf{r}^{(k)}=\mathrm{V}_{k+1}\left(\left\|\mathbf{r}^{(0)}\right\|_{2} \mathbf{e}_{1}-\widehat{\mathrm{H}}_{k} \mathbf{z}^{(k)}\right)
\label{7.34}\end{equation}

其中$\mathbf{e}_{1}$是$\mathbb{R}^{k+1}$的典范基础的第一个向量。因此，在GMRES方法中，步骤$k$的解可以通过\ref{7.32} 计算出来，条件是

!!!!
\mathbf{z}^{(k)} \text { minimizes }\|\| \mathbf{r}^{(0)}\left\|_{2} \mathbf{e}_{1}-\widehat{\mathbf{H}}_{k} \mathbf{z}^{(k)}\right\|_{2}
\label{7.35}\end{equation}

(我们注意到，出现在\ref{7.34}中的矩阵$\mathrm{V}_{k+1}$并不改变$\|\cdot\|_{2}$的值，因为它是正交的）。)

与CG方法类似，GMRES方法也享有有限终止特性，即它最多在$n$迭代后终止，产生精确解（以精确算术计算）。事实上，第k次迭代使Krylov子空间中的残差最小 $K_{k}$ 。由于每一个子空间都包含在下一个子空间中，所以残差是单调下降的。经过$n$次迭代，其中$n$是矩阵$A$的大小，Krylov空间$K_{n}$是$\mathbb{R}^{n}$的全部，因此GMRES方法到达了精确解。过早的停止是由于Arnoldi的正则化算法的崩溃。更确切地说，我们有以下结果。

属性7.3.GMRES方法在步骤$\mathrm{m}$处发生故障（有

然而，我们的想法是，经过少量的迭代（相对于$n$而言），向量$\mathbf{x}^{(k)}$已经是精确解的良好近似。这一点被我们在本节后面描述的收敛结果所证实。

为了提高GMRES算法的效率，有必要设计一个停止标准，不需要在每一步明确评估残差。这是有可能的，只要适当地解决带有上海森堡矩阵$\mathrm{H}_{k}$的线性系统。

在实践中，\ref{7.29} 中的矩阵$\widehat{\mathrm{H}}_{k}$被转化为一个上三角矩阵$\mathrm{R}_{k} \in \mathbb{R}^{(k+1) \times k}$，其中$r_{k+1, k}=0$和$\mathrm{Q}_{k}^{T} \mathrm{R}_{k}=\widehat{\mathrm{H}}_{k}$是作为$k$吉文斯旋转的产物得到的矩阵。然后，由于$\mathrm{Q}_{k}$是正交的，最小化\||$\mathbf{r}^{(0)}\left\|_{2} \mathbf{e}_{1}-\widehat{\mathrm{H}}_{k} \mathbf{z}^{(k)}\right\|_{2}$相当于最小化$\left\|\mathbf{f}_{k}-\mathrm{R}_{k} \mathbf{z}^{(k)}\right\|_{2}$，其中$\mathbf{f}_{k}=!!!!\mathrm{Q}_{k}\left\|\mathbf{r}^{(0)}\right\|_{2} \mathbf{e}_{1}$ 。也可以证明，$k+1$的第1个分量$\mathbf{f}_{k}$的绝对值是$k$第1步的残差的欧几里得规范。

与FOM一样，GMRES方法需要很高的计算量和大量的内存，除非在几次迭代后出现收敛。为此，该算法有两个变体，一个名为GMRES$(m)$，基于$m$步后的重启，以$\mathbf{x}(m)$作为初始猜测；另一个名为Quasi-GMRES或QGMRES，基于停止Arnoldi正交化过程。值得注意的是，这两种方法并不享有属性 $7.3$ 。

GMRES的收敛分析并不简单，我们在此只报告一些基本结果。如果$A$是正定的，即它的对称部分$A_{S}$有正的特征值，那么$k$的第1个残差会根据以下约束减少

!!!!
\left\|\mathbf{r}^{(k)}\right\|_{2} \leq \sin ^{k}(\beta)\left\|\mathbf{r}^{(0)}\right\|_{2},
\label{7.36}\end{equation}

其中 $\cos (\beta)=\lambda_{\min }\left(L_{S}\right) /\|L\|$ 与 $\beta \in[0, \pi / 2)$ 。此外，GMRES $(m)$ 对所有 $m \geq 1$ 都收敛。为了获得对步骤$k \geq 1$的残差的约束，让我们假设矩阵$A$是可对角化的

!!!!
A=T \Lambda T^{-1}
$$

其中$\Lambda$是特征值$\left\{\lambda_{j}\right\}_{j=1, \ldots, n}$的对角线矩阵，$T=\left[\boldsymbol{\omega}^{1}, \ldots, \boldsymbol{\omega}^{n}\right]$是矩阵，其列是$A$的右侧特征矢量。在这些假设下，GMRES的$k$步之后的残差规范满足以下条件

!!!!
\left\|\mathbf{r}^{(k)}\right\| \leq K_{2}(T) \delta\left\|\mathbf{r}^{(0)}\right\|
$$

其中$K_{2}(T)=\|T\|_{2}\left\|T^{-1}\right\|_{2}$是$T$的条件编号，而

!!!!
\delta=\min _{p \in \mathbb{P}_{k}, p(0)=1} \max _{1 \leq i \leq k}\left|p\left(\lambda_{i}\right)\right|
$$

此外，假设初始残差由第一个$m$特征向量很好地表示，即$\mathbf{r}^{0}=\sum_{j=1}^{m} \alpha_{j} \boldsymbol{\omega}^{j}+\mathbf{e}$，$\|\mathbf{e}\|$与$\left\|\sum_{j=1}^{m} \alpha_{j} \boldsymbol{\omega}^{j}\right\|$相比很小，并假设如果某个复数$\boldsymbol{\omega}^{j}$出现在前面的和中，那么其共轭$\bar{\omega}^{j}$也出现。那么

!!!!
\begin{gathered}
\left\|\mathbf{r}^{(k)}\right\| \leq K_{2}(T) c_{k}\|\mathbf{e}\| \\
c_{k}=\max _{p>k} \prod_{j=1}^{k}\left|\frac{\lambda_{p}-\lambda_{j}}{\lambda_{j}}\right|
\end{gathered}
$$

很多时候，$c_{k}$是一阶；因此，只要$\kappa_{2}(T)$不是太大，GMRES的$k$步将残差准则减少到$\|\mathbf{e}\|$的阶。

一般来说，正如前面的估计所强调的那样，仅有特征值信息是不够的，还需要有特征系统的信息。如果特征系统是正交的，就像正常矩阵一样，那么$K_{2}(T)=1$ ，特征值保留了所有关于收敛的信息。否则，$\left\|\mathbf{r}^{(k)}\right\|$的上界可以用谱和伪谱信息以及$A$的所谓值域来提供。

!!!!
\mathscr{F}(A)=\left\{\mathbf{v}^{*} A \mathbf{v} \mid\|\mathbf{v}\|=1\right\}
$$

如果$0 \notin \mathscr{F}(A)$，那么估计\ref{7.36} 可以通过用$\operatorname{dist}(0, \mathscr{F}(A))$取代$\lambda_{\min }\left(A_{S}\right)$来改进。

关于GMRES和GMRES$(m)$的收敛性的广泛讨论可以在[Saa96]、[Emb99]、[Emb03]和[vdV03]中找到。

当然，GMRES方法也可以在预设条件的系统中实现。我们在此提供一个带有左预处理的GMRES方法的实现 $P$ 。

\section{Preconditioned GMRES (PGMRES) Method}

初始化

!!!!
\mathbf{x}^{(0)}, P \mathbf{r}^{(0)}=\mathbf{f}-A \mathbf{x}^{(0)}, \beta=\left\|\mathbf{r}^{(0)}\right\|_{2}, \mathbf{x}^{(1)}=\mathbf{r}^{(0)} / \beta
$$

迭代

!!!!
\begin{aligned}
&\text { For } j=1, \ldots, k \text { Do } \\
&\text { Compute } P \mathbf{w}^{(j)}=A \mathbf{x}^{(j)} \\
&\text { For } i=1, \ldots, j \text { Do } \\
&\qquad \begin{array}{l}
g_{i j}=\left(\mathbf{x}^{(i)}\right)^{T} \mathbf{w}^{(j)} \\
\mathbf{w}^{(j)}=\mathbf{w}^{(j)}-g_{i j} \mathbf{x}_{i} \\
\text { End Do } \\
g_{j+1, j}=\left\|\mathbf{w}^{(j)}\right\|_{2} \\
\text { (if } \left.g_{j+1, j}=0 \operatorname{set} k=j \text { and Goto }(1)\right) \\
\mathbf{x}^{(j+1)}=\mathbf{w}^{(j)} / g_{j+1, j} \\
\text { End Do } \\
V_{k}=\left[\mathbf{x}^{(1)}, \ldots, \mathbf{x}^{(k)}\right], \hat{H}_{k}=\left\{g_{i j}\right\}, 1 \leq j \leq k, 1 \leq i \leq j+1 ; \\
\text { (1) Compute } \mathbf{z}^{(k)}, \text { the minimizer of }\left\|\beta \mathbf{e}_{1}-\hat{H}_{k} \mathbf{z}\right\| \\
\operatorname{Set} \mathbf{x}^{(k)}=\mathbf{x}^{(0)}+V_{k} \mathbf{z}^{(k)}
\end{array}
\end{aligned}
\label{7.37}\end{equation}

更一般地说，正如Saad(1996)所提出的，在第$k$次迭代时可以使用一个可变的前置条件$P_{k}$，产生所谓的$f$lexible GMRES方法。这在那些没有明确给出前置条件，而是隐式定义的情况下特别有趣，例如，作为牛顿迭代中的近似雅各布，或者通过内迭代过程的几个步骤（见第17章）。另一种有意义的情况是领域分解预处理（Schwarz或Schur类型），其中预处理步骤涉及子域中的一个或几个局部解的子步骤（见第19章）。

关于GMRES的实际实现、其与FOM的关系、如何重启GMRES以及GMRES的Householder版本的几个考虑可以在 [Saa96] 找到。备注7.1（投影方法）。用$Y_{k}$和$L_{k}$表示$m$的两个通用$\mathbb{R}^{n}$维子空间，我们称投影法为在步骤$k$生成近似解$\mathbf{x}^{(k)}$的过程，强制要求$\mathbf{x}^{(k)} \in Y_{k}$和残差$\mathbf{r}^{(k)}=\mathbf{b}-\mathbf{A} \mathbf{x}^{(k)}$是正交的。如果$Y_{k}=L_{k}$，则表示投影过程是正交的，否则是斜的（见[Saa96]）。

克里洛夫方法是投影方法。例如，Arnoldi方法是一种正交投影方法，其中$L_{k}=Y_{k}=K_{k}\left(\mathrm{~A} ; \mathbf{r}^{(0)}\right)$ ，而GMRES方法是一种斜向投影方法，其中$Y_{k}=K_{k}\left(\mathrm{~A} ; \mathbf{r}^{(0)}\right)$ 和 $L_{k}=\mathrm{A} Y_{k}$ 。值得注意的是，前几节介绍的一些经典方法都属于这一类。例如，高斯-赛德尔方法是一种正交投影方法，在第$k$步$K_{k}\left(\mathrm{~A} ; \mathbf{r}^{(0)}\right)=\operatorname{span}\left\{\mathbf{e}_{k}\right\}$，有$k=1, \ldots, n$。投影步骤从1到$n$循环进行，直到收敛。

\subsubsection{The Multigrid method}

几何多网格（MG）方法是一种迭代算法，通过利用一个或几个额外的更粗的网格来解决与某一网格相关的代数系统。为了简单起见，我们只描述双网格算法的情况。因此，我们假设\ref{7.2}代表代数系统，例如，由（细）网格$\mathscr{T}_{h}$上的边界值问题的有限元近似所产生。为了清楚起见，我们可以将\ref{7.2}重写为

!!!!
A_{h} \mathbf{u}_{h}=\mathbf{b}_{h}
\label{7.38}\end{equation}

其中，像往常一样，$h=\max _{k \in \mathscr{T}_{h}} \operatorname{diam}(K), A_{h}$是刚度$\mathrm{FE}$矩阵，$\mathbf{b}_{h}$是右手边，$\mathbf{u}_{h}$是节点值的向量。让$\mathscr{T}_{H}$代表一个粗略的网格，这样$\mathscr{T}_{h}$可以被视为$\mathscr{T}_{H}$的细化，例如，这样$\mathscr{T}_{h}$的顶点就可以从$\mathscr{T}_{H}$的边上得到中点。在这种情况下，$h=H / 2$ .

MG算法在这两个网格上的一般迭代包括：。

1. 预平滑步骤。

使用迭代算法（如Jacobi，或Gauss-Seidel，或Richardson）在细网格上进行$m_{1}(\geq 1)$迭代。

!!!!
\mathbf{u}_{h}^{(l)}=S_{h}\left(\mathbf{u}_{h}^{(l-1)}, \mathbf{b}_{h}\right) \quad l=1, \ldots, m_{1}
$$

为一个合适的 $\mathbf{u}_{h}^{(0)}$ 。

2. 残留物计算。

!!!!
\mathbf{r}_{h}=\mathbf{b}_{h}-A_{h} \mathbf{u}_{h}^{\left(m_{1}\right)}
$$

3.对粗略网格的限制。

!!!!
\mathbf{r}_{H}=I_{h}^{H} \mathbf{r}_{h}
$$

其中$I_{h}^{H}: \mathbb{R}^{N_{h}} \rightarrow \mathbb{R}^{N_{H}}$是细到粗的算子，$N_{h}$是细网格问题的未知数，$N_{H}$是粗网格问题的未知数；4.粗网格问题的解决。

!!!!
A_{H} \mathbf{e}_{H}=\mathbf{r}_{H}
$$

其中$A_{H}$是与$\mathrm{FE}$粗网格上的离散化相关的刚度矩阵$\mathscr{T}_{H}$ 。

5.粗略的网格校正。

!!!!
\mathbf{u}_{h}^{\left(m_{1}+1\right)}=\mathbf{u}_{h}^{\left(m_{1}\right)}+I_{H}^{h} \mathbf{e}_{H}
$$

其中$I_{H}^{h}: \mathbb{R}^{N_{H}} \rightarrow \mathbb{R}^{N_{h}}$是一个从粗到细的算子。

6.后期平滑步骤。

在精细网格上进行$m_{2}(\geq 1)$次迭代。

!!!!
\mathbf{u}_{h}^{(l)}=S_{h}\left(\mathbf{u}_{h}^{(l-1)}, \mathbf{b}_{h}\right) \quad l=m_{1}+1, \ldots, m_{1}+m_{2}+1
$$

两个网格间的运算符（即矩阵）通常是相互邻接的。

让$V_{h}$是与$\mathscr{T}_{h}, V_{H}$相关的有限元空间，与$\mathscr{T}_{H}$相关的有限元空间。对于每一个$\mathbf{w} \in \mathbb{R}^{N_{H}}$，让$w_{H}=\sum_{i=1}^{N_{H}} w_{i} \varphi_{i}^{H}$成为$V_{H}$中相应的FE函数。同样，对于每个 $\mathbf{v} \in \mathbb{R}^{N_{h}}$ ，让 $v_{h}=\sum_{j=1}^{N_{h}} v_{j} \varphi_{j}^{h}$ 成为 $V_{h}($ 中相应的 $\mathrm{FE}$ 函数，见 \ref{4.7} 。这里 $\varphi_{i}^{h}$ （resp. $\left.\varphi_{j}^{H}\right)$ ）表示 $V_{h}$ （resp. $\left.V_{H}\right)$ ）中的拉格朗日基础函数。让$\mathscr{I}_{H}^{h}: V_{H} \rightarrow V_{h}$成为对应于$I_{H}^{h}$的算子，也就是

!!!!
\mathscr{I}_{H}^{h} w_{H}=v_{h} \quad \text { iff } \quad I_{H}^{h} \mathbf{w}=\mathbf{v}
$$

通常情况下，$\mathscr{I}_{H}^{h}$是自然注入，在这个意义上说，就是

!!!!
\mathscr{I}_{H}^{h} w_{H}=w_{H} \quad \forall w_{H} \in V_{H} .
$$

这意味着它们的节点值 $\left(\mathscr{I}_{H}^{h} w_{H}\right)\left(\mathbf{N}_{j}^{h}\right)=w_{H}\left(\mathbf{N}_{j}^{h}\right)$ 在 $\mathscr{T}_{h}$ 的所有节点 $\mathbf{N}_{j}^{h}$ 上是相同的。因此，$I_{H}^{h}$的条目是$\left(I_{H}^{h}\right)_{i j}=\varphi_{i}^{H}\left(\mathbf{N}_{j}^{h}\right), j=1, \ldots, N_{h}, i=\cdots, N_{H}$ 。算子$I_{h}^{H}$是$I_{H}^{h}$的加权转置，也就是

!!!!
\left(I_{h}^{H} \mathbf{v}, \mathbf{w}\right)_{H}=\left(\mathbf{v}, I_{H}^{h} \mathbf{w}\right)_{h} \quad \forall \mathbf{v} \in \mathbb{R}^{N_{h}}, \forall \mathbf{w} \in \mathbb{R}^{N_{H}}
$$

其中，我们引入了权重（依赖于网格）的内积。

!!!!
\begin{aligned}
&(\mathbf{v}, \mathbf{w})_{h}=h^{2} \sum_{j=1}^{N_{h}} v_{j} w_{j} \quad \forall \mathbf{v}, \mathbf{w} \in \mathbb{R}^{N_{h}}, \\
&(\mathbf{x}, \mathbf{y})_{H}=H^{2} \sum_{i=1}^{N_{H}} x_{i} y_{i} \quad \forall \mathbf{x}, \mathbf{y} \in \mathbb{R}^{N_{H}} .
\end{aligned}
$$

一个简单的代数计算表明，

!!!!
\left(I_{h}^{H}\right)_{i j}=\frac{h^{2}}{H^{2}}\left(I_{H}^{h}\right)_{j i}, \quad i=1, \ldots, N_{H}, j=\ldots, N_{h}
$$

就是说

!!!!
I_{h}^{H}=\frac{h^{2}}{H^{2}}\left(I_{H}^{h}\right)^{T}
$$

我们所描述的是一个双网格的V型循环算法。事实上，这个算法的一个步骤的图像表示，其中细的是高层次的，而粗的是低层次的，看起来像一个 "V"'工作流程。

这种迭代算法可与以下迭代矩阵相关联

!!!!
M G=S_{h}^{m_{2}}\left(I_{h}-I_{H}^{h}\left(A_{H}\right)^{-1} I_{h}^{H} A_{h}\right) S_{h}^{m_{1}}
\label{7.39}\end{equation}

其中$I_{h} \in \mathbb{R}^{N_{h} \times N_{h}}$是身份矩阵，$S_{h}$是平滑迭代矩阵（例如，精细网格上的Richardson矩阵$R_{P}$或$R\left(\alpha_{k}\right)$）。

双网格V型循环算法的收敛分析，以及带有V型或W型循环的更一般的多网格情况的收敛分析，例如，在[Hac]中进行，对于有限元离散化，在[BS94]中进行。第八章

有限元编程的要素

在这一章中，我们更深入地关注与将有限元方法转化为计算机代码有关的若干方面。这个实施过程可能隐藏着一些隐患。除了给定的编程语言的语法要求外，对高计算效率的需求导致了一个通常不是在理论介绍中所看到的直接翻译的实现。效率取决于许多因素，包括使用的语言和工作的架构 $^{1}$ 。个人经验可以起到与从教科书中学习一样的根本作用。此外，尽管花时间寻找代码中的错误或更有效的数据结构有时看起来是在浪费时间，但它（几乎）从来不是。出于这个原因，我们希望将本章作为一种 "指南"，供读者自己进行试验，而不是传统意义上的要学习的章节。

关于本章风格的最后说明。这里遵循的方法是提供一般的指导方针：显然，每个问题都有具体的特征，可以通过谨慎的方式利用这些特征来实现更有效的实施。

\subsection{Working steps of a finite element code}

一个有限元计算的执行在逻辑上可以分成四个工作步骤（图8.1）。

1.预处理。这一步包括设置问题并对其计算域进行编码，正如第四章中所看到的，这需要构建网格（或网格）。一般来说，抛开琐碎的情况（例如在一维），构建一个适当的网格是一个相当大的数字问题。

${ }^{1}$ 目前，涉及科学计算的工程应用是在具有数百或数千个中央处理器单元（CPU）或图形处理器单元（GPU）的并行架构上运行的，这需要特定的编码技术。这个话题已经超出了本书的范围。


![](https://cdn.mathpix.com/cropped/10058ab4e7f0c5bd6fe5bcd4db204623-180.jpg?height=432&width=547&top_left_y=113&top_left_x=183)

图8.1.有限元代码的工作步骤

这方面的特殊技术已经被开发出来。一般来说，这种操作是由求解器中的专用程序或模块来完成的，最近在与CAD（计算机辅助设计）软件的接口和对接方面做了大量工作。第6章是专门讨论网格生成的基本技术。

2.2.组装。在这个阶段，我们构建 "功能 "数据结构，从由网格和用户选择的所需的有限元类型获得的 "几何 "数据开始。此外，根据我们要解决的问题和边界条件，我们计算与离散化相关的刚度矩阵（见第4章和第13章）。在非稳态问题中，当矩阵取决于时间时，这一操作可能需要包含在时间推进的循环中（例如，非线性问题的线性化，见第5章和第17章）。严格来说，术语 "装配 "是指线性系统矩阵的构建，从在参考元素上进行的局部计算转移到全局计算，以确定与离散化问题相关的矩阵。图$8.2$总结了在准备代数系统的组装阶段的不同操作。

3 .代数系统的解。任何有限元计算的解决方案的核心都是由线性系统的解表示的。如前所述，这将最终成为一个时间循环（基于隐式离散化方法）的一部分，或由非线性问题的线性化产生的迭代循环。求解方法的选择通常是由用户决定的。由于这个原因，用户了解所研究的问题是非常重要的，因为

![](https://cdn.mathpix.com/cropped/10058ab4e7f0c5bd6fe5bcd4db204623-181.jpg?height=563&width=671&top_left_y=113&top_left_x=124)

图8.2.装配的方案。几何和拓扑信息（顶表），适当地存储，描述了网格。通过对参考元素的映射，我们计算离散化矩阵$A$和项$\mathbf{b}$，首先逐个元素进行（局部计算），然后，通过利用积分操作的可加性，我们更新全局矩阵。代表矩阵中每个元素的符号是通过用于定义网格中每个元素的符号的重叠而得到的。最后，我们实现了边界条件，理想情况下，消除了具有相关迪里希条件的自由度，得到了最终结构 $A$ 和 $\mathbf{b}$ 。正如我们将看到的，该操作通常以不同的方式实现

我们在第四章中已经看到，这对矩阵的结构有影响（例如，对称性和积极性）；另一方面，她/他应该了解可用的方法，以执行最佳选择（这很少是默认的）。这就是为什么在第7章中我们回顾了用于解决线性系统的数值方法的主要特性。

现在，有许多非常有效的计算库用于解决各种类型的线性系统，因此，在编码阶段的趋势是通常包括这些库，而不是从头开始实施。其中，我们提醒PetSC（见[Pet]）、UMFPACK [UMF] 和TriLinos [Tri] 。

4.4.后处理。由于有限元代码产生的数值数据量可能很大，为了呈现简洁的、可用的结果，通常需要进行后处理。然而，这可能不是一个简单的任务。特别是，对于微分量的事后计算，不计后果的后处理（例如，从位移得到应力，从速度得到通量或涡度，等等......）会带来不可接受的开销误差。

由于网格生成技术已在第6章中讨论过，我们在第7章中看到了解决线性系统的算法，因此本章的主要重点将放在装配阶段（第8.4节）。

在处理这个问题之前，在第$8.2$节中，我们将处理正交公式的数值计算。  $8.2$我们将处理积分数值计算的正交公式，而稀疏矩阵存储将在第8.3节讨论。

就后处理步骤而言，我们参考具体的文献，并回顾上面使用的技术已经在第四章中介绍过，用于计算后验估计。

最终，第1节。  $8.6$将讨论一个完整的例子。

\subsubsection{The code in a nutshell}

今天有许多编程语言和环境，其特点是具有不同的理念和目标。当面对一个数值方法的实施时，有必要在这方面做出深思熟虑的选择。在构建原型的最有用的编程环境中，Matlab无疑是一个优秀的工具，尽管和所有的解释语言一样，它在计算效率方面比较弱。另一个针对通过有限元方法解决$2 \mathrm{D}$中微分问题的环境是FreeFem++（见www.freefem.org）。这个环境包括上述所有四个阶段的单一软件包（免费且可在不同操作系统下使用）。它特别吸引人的语法减少了编码和理论表述之间的差距，使前者大大接近后者。这种操作有一个明显的 "教育 "优点，那就是对非微不足道的问题也能快速产生模拟。然而，计算成本和实施需要扩展语法的新策略的难度，在实际感兴趣的情况下可能是不利的。在[FSV12]中，几个已解决的例子和问题是用FreeFem++解决的。

在编译的编程语言中，Fortran（特别是Fortran 77）是传统上在数值领域取得最大成功的语言，因为它能生成非常高效的可执行代码。最近，面向对象编程理念所固有的抽象功能被证明非常适用于有限元编程。由意义深远的数学工具所实现的抽象水平似乎在面向对象编程的抽象中找到了一个很好的对应物，它是基于用户对数据类型的设计（而不是像程序化编程中的操作）和它们的多态性（见例如[LL00, Str00]）。然而，这种抽象的计算成本有时会降低人们对理论上有吸引力的编程风格的兴趣。后者对于科学问题来说往往是操作上的弱点，在那里计算效率（几乎）总是至关重要的。这就需要开发更复杂的编程技术（例如表达式模板），以避免在代码执行过程中与抽象对象的解释相关的成本变得过于沉重（见例如[Vel95, Fur97, Pru06, DV09]）。因此，除了Fortran，像$\mathrm{C}++$这样的语言（作为C语言的面向对象的改进而诞生）如今在科学领域越来越频繁；其中，我们记得FEniCS OpenFOAM和LifeV.

在下面介绍的代码摘录中，我们将参考 $\mathrm{C}++$ 。对代码（为简单起见，我们以后称之为 "程序"）的准确检查需要一些 $\mathrm{C}++$ 的基本知识，为此我们参考了 [LL00] 。然而，由于我们想把这一章作为自主实验的基础，因此掌握$\mathrm{C}++$的语法对理解文本并不重要；对于可能喜欢不同语言的读者来说，稍微熟悉一下其基本语法就足够了。

\subsection{Numerical computation of integrals}

有限元公式中的积分的有效数值计算通常是通过正交公式进行的。关于数值正交的介绍，我们可以参考基本的数值分析教科书（例如[QSS07]）。在此，我们只需回顾一下，一个通用的正交公式的形式为

!!!!
\int_{K} f(\mathbf{x}) d \mathbf{x} \approx \sum_{i q=1}^{n q n} f\left(\mathbf{x}_{i q}\right) w_{i q}
\label{8.1}\end{equation}

其中$K$表示我们积分的区域（通常是有限元网格的一个元素），$n q n$是所选公式的正交节点数，$\mathbf{x}_{i q}$是正交节点的坐标，$w_{i q}$是权重。通常情况下，公式的准确性和计算成本随着正交节点数量的增加而增长。正如我们将在第10章的章节中看到的那样。  $10.2 .2$和$10.2 .3$中，在相同节点数下保证最佳精度的公式是高斯公式。

积分的计算通常是通过适当的变量变化在参考元素上进行的（其中基函数的表达是已知的）（第4.3节）。

让我们用$\hat{x}_{i}$和$x_{i}$（对于$\left.i=1, \ldots, d\right)$，分别表示参考元素$\hat{K}$和一般元素$K$上的坐标。然后，在参考空间中的积分将需要了解将参考元素$\hat{K}$映射到元素$K$上的几何变换$J_{K}(\hat{\mathbf{x}})$的雅各布矩阵$F_{K}$（见图4.14）。

!!!!
J_{K}(\hat{\mathbf{x}})=\left[\frac{\partial x_{i}}{\partial \hat{x}_{j}}(\hat{\mathbf{x}})\right]_{i, j=1}^{d}
$$

然后我们有

!!!!
\int_{K} f(\mathbf{x}) d \mathbf{x}=\int_{\hat{K}} \hat{f}(\hat{\mathbf{x}})\left|\operatorname{det} J_{K}(\hat{\mathbf{x}})\right| d \hat{\mathbf{x}} \approx \sum_{q} \hat{f}\left(\hat{\mathbf{x}}_{q}\right)\left|\operatorname{det} J_{K}\left(\hat{\mathbf{x}}_{q}\right)\right| \hat{w}_{q}
$$

其中$\hat{f}=f \circ F_{K}$，和$\hat{w}_{q}$是参考元素上的权重。在涉及导数的积分情况下，用$\widehat{J}_{K}(\mathbf{x})$表示与$F_{K}^{-1}$相关的雅各布矩阵，即

!!!!
\widehat{J}_{K}(\mathbf{x})=\left[\frac{\partial \hat{x}_{i}}{\partial x_{j}}(\mathbf{x})\right]_{i, j=1}^{d}
$$

我们有，对于$j=1, \ldots, d$,

!!!!
\frac{\partial f}{\partial x_{i}}(\mathbf{x})=\sum_{j=1}^{d} \frac{\partial \hat{f}}{\partial \widehat{x}_{j}}(\hat{\mathbf{x}}) \frac{\partial \widehat{x}_{j}}{\partial x_{i}}(\mathbf{x}), \quad \nabla_{x} f(\mathbf{x})=\left[\widehat{J}_{K}(\mathbf{x})\right]^{T} \nabla_{\widehat{x}} \widehat{f}(\hat{\mathbf{x}})
$$

我们可以证明

!!!!
\left[\widehat{J_{K}}(\mathbf{x})\right]^{T}=\frac{1}{\operatorname{det} J_{K}(\hat{\mathbf{x}})} J_{K}^{\operatorname{cof}}(\hat{\mathbf{x}})
$$

$J_{K}^{c o f}(\hat{\mathbf{x}})$是$J_{K}(\hat{\mathbf{x}})$元素的辅助因子矩阵，即（在二维的情况下）。

!!!!
J_{K}^{c o f}(\hat{\mathbf{x}})=\left[\begin{array}{cc}
\frac{\partial x_{2}}{\partial \hat{x}_{2}}(\hat{\mathbf{x}}) & -\frac{\partial x_{2}}{\partial \hat{x}_{1}}(\hat{\mathbf{x}}) \\
-\frac{\partial x_{1}}{\partial \hat{x}_{2}}(\hat{\mathbf{x}}) & \frac{\partial x_{1}}{\partial \hat{x}_{1}}(\hat{\mathbf{x}})
\end{array}\right]
$$

因此，函数$f$的梯度可以用参考空间中的变量来表示如下

!!!!
\nabla_{x} f(\mathbf{x})=\frac{1}{\operatorname{det} J_{K}(\hat{\mathbf{x}})} J_{K}^{c o f}(\hat{\mathbf{x}}) \nabla_{\hat{x}} \hat{f}(\hat{\mathbf{x}})
$$

用$\alpha$和$\beta$表示两个通用基函数的指数，因此可以计算出刚度矩阵的典型元素如下。

!!!!
\begin{aligned}
&\int_{K} \nabla_{x} \varphi_{\alpha}(\mathbf{x}) \nabla_{x} \varphi_{\beta}(\mathbf{x}) d \mathbf{x}= \\
&\int\left(J_{K}^{c o f}(\hat{\mathbf{x}}) \nabla_{\hat{x}} \hat{\varphi}_{\alpha}(\hat{\mathbf{x}})\right)\left(J_{K}^{\operatorname{cof}}(\hat{\mathbf{x}}) \nabla_{\hat{x}} \hat{\varphi}_{\beta}(\hat{\mathbf{x}})\right) \frac{1}{\left|\operatorname{det} J_{K}(\hat{\mathbf{x}})\right|} d \hat{\mathbf{x}} \simeq \\
&\hat{K}_{q}\left[\frac{\hat{w}_{q}}{\left|\operatorname{det} J_{K}\left(\hat{\mathbf{x}}_{q}\right)\right|} \sum_{j=1}^{d}\left(\sum_{l=1}^{d}\left[J_{K}^{c o f}\left(\hat{\mathbf{x}}_{q}\right)\right]_{j l} \frac{\partial \hat{\varphi}_{\alpha}}{\partial \hat{x}_{l}}\left(\hat{\mathbf{x}}_{q}\right)\right)\left(\sum_{m=1}^{d}\left[J_{K}^{\operatorname{cof}}\left(\hat{\mathbf{x}}_{q}\right)\right]_{j m} \frac{\partial \hat{\varphi}_{\beta}}{\partial \hat{x}_{m}}\left(\hat{\mathbf{x}}_{q}\right)\right)\right]
\end{aligned}
\label{8.2}\end{equation}

请注意，如果$J_{K}$是$2 \mathrm{D}$中的一个三角形或矩形（三维中的四面体或平行四边形），没有弯曲的边界，则矩阵$J_{K}^{c o f}$在元素$K$上是常数。

编码正交公式的类存储正交节点及其相关权重。在有效积分计算中，我们将获得实际计算所需的映射信息，这取决于$K$的几何图形。正交公式的选择回应了两种（相互冲突的）需求。

1.一方面，准确度越高，积分误差越小，最终影响数值计算的整体质量；基于准确度概念的正交规则的适当选择，可能使数值积分误差消失。我们对微分算子具有常数（或多项式）系数的问题进行控制。

2.另一方面，更大数量的$n q n$节点和增加装配的计算成本对于获得精度的提高是必要的。

这两种需求的适当综合，显然取决于我们要解决的问题的要求，以及执行计算的准确性和速度规格。

\subsubsection{Numerical integration using barycentric coordinates}

单轴上积分的数值评估（一维的区间，$2 \mathrm{D}$中的三角形，$3 \mathrm{D}$中的四面体）可以从使用章节中介绍的重心坐标中受益。4.4.3.首先，我们观察到以下精确的积分公式是成立的（见，例如，[Aki94，第9章]或[Hug00，第3章]）。

在$1 \mathrm{D}

!!!!
\int_{\widehat{K}_{1}} \lambda_{0}^{a} \lambda_{1}^{b} d \omega=\frac{a ! b !}{(a+b+1) !} \operatorname{lenght}\left(\widehat{K}_{1}\right)
$$

在$2 \mathrm{D}

!!!!
\int_{\widehat{K}_{2}} \lambda_{0}^{a} \lambda_{1}^{b} \lambda_{2}^{c} d \omega=\frac{a ! b ! c !}{(a+b+c+2) !} 2 \operatorname{Area}\left(\widehat{K}_{2}\right)
$$

在$3 \mathrm{D}

!!!!
\int_{\widehat{K}_{3}} \lambda_{0}^{a} \lambda_{1}^{b} \lambda_{2}^{c} \lambda_{3}^{d} d \omega=\frac{a ! b ! c ! d !}{(a+b+c+d+3) !} 6 \operatorname{Vol}\left(\widehat{K}_{3}\right)
$$

更为普遍的是。

!!!!
\int_{\hat{K}_{d}}^{d} \prod_{i=0}^{d_{i}}^{n_{i}} d \omega=\frac{\prod_{i=0}^{d} n_{i} !}{\left(\sum_{i=0}^{d} n_{i}+d\right) !} d !\left|\hat{K}_{d}\right|
\label{8.3}\end{equation}

其中$\hat{K}_{d}$是一个d维的标准单线，$\left|\hat{K}_{d}\right|$表示其度量，$\left\{n_{i}, 0 \leq i \leq\right.!!!!d\}$是一组非负整数。

这些公式在处理边界值问题的有限元近似时非常有用，用于精确计算特征拉格朗日基函数中的多项式积分。

为了举例说明，表$8.1$显示了一些流行的二维正交公式的权重和结点。表$8.2$给出了一些四面体的公式。这些公式是对称的：我们必须考虑所有可能的重心坐标的排列组合来获得完整的节点列表。
 ![](https://cdn.mathpix.com/cropped/10058ab4e7f0c5bd6fe5bcd4db204623-186.jpg?height=198&width=522&top_left_y=128&top_left_x=186)

图8.3.点$P$的重心坐标$\lambda_{i}$表示顶点为$P$的四面体和与$N_{i}$相对的面的顶点的体积之比（在右图中，我们对顶点为$P, N_{1}, N_{2}, N_{3}$的四面体进行了阴影，与$N_{0}$的四面体的总体积相比

表8.1.三角形上的正交公式的节点和权重。节点是通过它们的重心坐标表示的。权重不考虑参考元素的度量（在这种情况下等于$1 / 2$）。

\begin{tabular}{ccccccc}
\hline $n q n$ & multicolumn{3}{c}{ barycentric coordinates $\lambda_{j}$ } & $1 / 3$ & 1 & $w_{j}$ & $r$ 。
\1 & $1 / 3$ & $1 / 3$ & 0 & 3 & 1 & 1 （3 & 1 & 1）。
3 & 1 & 0 & $1 / 3$ & 3 & $1 / 3$ & 1 （3 & 1 & 0
3 & $2 / 3$ & $1 / 3$ & $1 / 3$ & 1 & $-0.5625$ & 2 （2）。
4 & $1 / 3$ & $1 / 3$ & $0.2$ & 3 & $0.52083$ & `4
& $0.6$ & $0.2$ & $0.10903900907$ & 6 & $1 / 6$ & 2 （1）。
6 & $0.65902762237$ & $0.23193336855$ & $0.09157621351$ & 3 & $0.10995174366$ & 3 （6）。
6 & $0.81684757298$ & $0.09157621351$ & $0.44594849092$ & 3 & $0.22338158968$ & 6
& $0.10810301817$ & $0.44594849092$ & $0.3$ & 1 （1）。
\hline
\end{tabular}

表8.2.四面体上正交公式的节点和权重。节点用其重心坐标表示。权重不考虑参考元素的量度（在这种情况下等于$1 / 6$）。

\BEGIN{TABULARY}{CCCCCC}{BEGIN{TABULARY}.
\hline $n q n$ & & multicolumn{2}{c}{ barycentric coordinates $\lambda_{j}$ } & & $m$ & $w_{j}$ & $r$ 㱮行
\1 & $1 / 4$ & $1 / 4$ & $1 / 4$ & $1 / 4$ & 1 & 1 & 1 （1）。
4 & $0.58541020$ & $0.13819660$ & $0.13819660$ & $0.13819660$ & 4 & $1 / 4$ & 2 （2）。
5 & $1 / 4$ & $1 / 4$ & $1 / 4$ & $1 / 4$ & 1 & $-16 / 20$ & 3 （1）。
& $1 / 2$ & $1 / 6$ & $1 / 6$ & $1 / 6$ & 4 & $9 / 20$ & ``````。
\hline
\end{tabular}

为了方便读者，我们在节点总数$n q n$旁边写上了每个正交节点的倍数$m$，也就是由排列组合产生的节点数。我们还提供了准确度$r$，即最大的正整数$r$，对于它，所有度数为$\leq r$的多项式都被手头的正交公式准确整合。让我们看两个简单的例子。假设我们想计算

!!!!
I=\int_{K} f(\mathbf{x}) d \mathbf{x}=\int_{\widehat{K}} \widehat{f}(\widehat{\mathbf{x}})|J|(\widehat{\mathbf{x}}) d \widehat{\mathbf{x}}
$$

使用表格第一行的权重和节点，我们可以得到

!!!!
I \simeq \frac{1}{2} \widehat{f}\left(\frac{1}{3}, \frac{1}{3}\right) J\left(\frac{1}{3}, \frac{1}{3}\right)=\operatorname{Area}(K) f(\overline{\mathbf{x}})
$$

其中系数$1 / 2$代表参考元素的面积，$\bar{x}$是对应于三角形重心的重心坐标$\lambda_{1}=\lambda_{2}=\lambda_{3}=1 / 3$的结点。相应的公式是著名的复合中点公式。

为了使用第二行的公式，我们注意到$m=3$ ，因此我们确实有3个正交节点，其arycentric坐标通过循环互换得到。

!!!!
\left(\lambda_{0}=1, \lambda_{1}=0, \lambda_{2}=0\right),\left(\lambda_{0}=0, \lambda_{1}=1, \lambda_{2}=0\right),\left(\lambda_{0}=0, \lambda_{1}=0, \lambda_{2}=1\right)
$$

因此，对于每个三角形$K$，我们可以得到

!!!!
\begin{aligned}
\int_{K} f(\mathbf{x}) d \mathbf{x} & \simeq \frac{1}{2} \frac{1}{3}[\widehat{f}(0,0)|\operatorname{det} J(0,0)|+\widehat{f}(1,0)|\operatorname{det} J(1,0)|+\widehat{f}(0,1)|\operatorname{det} J(0,1)|] \\
&=\operatorname{Area}(K) \sum_{i=0}^{2} \frac{1}{3} f\left(\mathbf{N}_{i}\right)
\end{aligned}
$$

$\mathbf{N}_{0}, \mathbf{N}_{1}, \mathbf{N}_{2}$是三角形$K$的顶点，分别对应于arycentric坐标$(0,0),(1,0)$和$(0,1)$。因此，相应的公式可以得到复合梯形公式。这两个公式的精确程度都等于$1$ 。

其他用于计算不同有限元积分的正交公式可以在 [Hug00] , [Str71] , [FSV12] 中找到。

备注8.1.当使用四边形或棱柱形元素时，正交公式的节点和权重可以作为一维区间的高斯正交公式的张量乘积得到，见第10.2节（还有[CHQZ06] ）。

\subsection{Storage of sparse matrices}

正如第四章中所看到的，有限元矩阵是稀疏的。非空元素的分布由矩阵的所谓稀疏模式（也叫图）来保留。这种模式取决于计算网格、有限元类型和采用的节点编号。因此，一个矩阵的有效存储包括根据模式给出的定位来存储其非空元素。不同微分问题的离散化共享相同的计算网格和相同类型的有限元，导致矩阵具有相同的图形。因此，在面向对象的编程逻辑中，将图的存储（可以成为由用户定义的 "数据类型"，即一个类）与每个矩阵的值的存储分开是很有用的。这样，一个矩阵可以被看作是一个存储其数值的数据结构，同时还有一个指向与其相关的图的指针。指针只存储图形在内存中的位置，因此占用的内存量最小。因此，不同的矩阵可以共享相同的图形，而不需要对图案进行无用的重复存储。

在实践中，有几种技术可以有效地存储稀疏矩阵，即非空元素的位置和值。在这个时候，我们应该注意到，在这种情况下，形容词 "高效 "不仅指可以实现较低的内存占用率，而且还指每个元素访问内存的速度。一个需要尽可能少的内存浪费的存储格式，在访问所需的值时可能会比较慢。事实上，在通过访问存储图形的数据结构找到内存中的位置后，通常会获得较高的存储紧凑性。需要的中间通道越多，对所需元素的访问时间就越长。正是为了找到正确的折衷方案的需要，文献中提出了不同的存储技术，具有不同的特权。对这些技术的回顾，以及许多评论和意见，可以在[FSV12]中找到，例如附录A。在这里，我们只是回顾了一种广泛使用的稀疏方阵的存储格式，即CSR（Compact Sparse Row）格式。

我们用$n$表示要存储的矩阵的大小，用$n z$表示其非空元素的数量。在CSR格式中，一个矩阵由三个向量标识。其中两个向量$R$和$C$具有整数值，构成所谓的模式，即矩阵的稀疏度图，这取决于网格和有限元空间；第三个向量$A$包含矩阵的非零条目。更确切地说，A的大小为$n z$，它以行的顺序存储条目。向量$C$的大小为$n z$，也是如此。条目 $C(k)$ 包含条目 $A(k)$ 的列。最后，向量$R$的大小为$n$，包含指向向量$C$的指针，表示每一行的开始。换句话说，$R(k)$包含向量$J($和$A)$的位置，矩阵的第$k$行开始。为了更具体，我们在一个例子上说明（见图8.4），其中$n=5$和$n z=17$ .

!!!!
A=\left[\begin{array}{lllll}
0 & 1 & 2 & 3 & 4 \\
a & 0 & f & 0 & g \\
0 & b & k & m & 0 \\
h & l & c & 0 & r \\
0 & n & 0 & d & p \\
i & 0 & s & q & e
\end{array}\right] \quad \begin{aligned}
&0 \\
&1 \\
&2 \\
&3 \\
&4
\end{aligned}
$$

我们指出，矩阵和向量中的行和列的编号从0开始，遵循$\mathrm{C}++\operatorname{syntax}$ 。

图8.4中报告了以CSR格式表示该矩阵的向量。这里，向量中不同的背景颜色指的是矩阵的不同行，线条将向量$R$的指针连接到其他向量中的相应条目。这样，如果我们想检索一个非零条目$-$，例如，在

![](https://cdn.mathpix.com/cropped/10058ab4e7f0c5bd6fe5bcd4db204623-189.jpg?height=424&width=432&top_left_y=112&top_left_x=241)

图8.4.代表矩阵A的CSR格式的向量

第二行$-$我们从位置$R(1)$开始（因为$\mathrm{C}++$的编号），通过条目$R(2)-1$，因为$R(2)$指向第三行的开始。条目 $A(R(1), \ldots, R(2)-1)$ 是第二行的数值，其对应的列在 $C(R(1), \ldots, R(2)-1)$ 。通过这种方式，对矩阵进行逐行访问相对容易，而逐列访问则比较麻烦。列间格式CSC（Compressed Sparse Colum）也是这样制定的。在一些库中，一种更紧凑的格式被称为修正稀疏行（MSR），用于方形矩阵。在[FSV12]中，后一种格式被扩展到可以同时容纳行式和列式矩阵访问，计算成本相同。

\section{ $8.4$ Assembly}。

装配是导致构建与离散化问题相关的矩阵的不同操作序列。为了做到这一点，我们需要两类信息。

1.几何图形，通常包含在网格文件中。

2.功能，相对于通过有限元表示的解决方案。

在图$8.5$中，我们报告了可能的参考几何图形及其局部顶点的编号。四面体代表$3 \mathrm{D}$第四章中考虑的三角形元素的延伸。棱形元素在$3 \mathrm{D}$中扩展了2D中的四边形几何元素，这将在第十章中介绍，例如，见[Hug00，第三章]，以获得完整的描述。
 ![](https://cdn.mathpix.com/cropped/10058ab4e7f0c5bd6fe5bcd4db204623-190.jpg?height=316&width=506&top_left_y=252&top_left_x=205)

图8.5.LifeV中可用的一些参考元素的说明，节点的（常规）局部编号

经过适当编码的几何和功能信息被用来构建离散化问题的矩阵。与拉格朗日有限元定义中看似自然的做法相反，矩阵是通过元素的循环排列而不是节点构建的。这种面向元素的方法与面向节点的方法相反，其原因主要是与计算效率问题有关。与节点相关的基函数的分析表达在共享该节点的每个元素上都是不同的。在计算积分之前，有必要在节点上进行循环，检测每个元素的适当基函数的分析表达。因此，在进行积分计算之前，我们必须在节点上进行循环，为每个不同的元素找到适当的基函数的分析表达。就代码而言，这意味着周期的主体必须充满条件性分支，即在汇编周期内的if...then...elseif...then...else...类型的指令。这些操作在计算方面是 "昂贵的"，特别是如果它们位于一个周期内（因此要执行几次），从编译阶段需要大量的微观汇编指令来扩展一个条件性分支，与任何其他指令相比，这一点很明显，例如，见[HVZ97] 。正如我们将看到的，通过利用集成的可加性，面向元素的方法允许以一种聪明的方式绕过这个障碍。特别是（见第4章），问题矩阵的构建可以在网格元素的循环中分两个概念性步骤进行。

1.构建矩阵和右手边，离散化手头元素上的微分算子（局部矩阵和矢量）。

2.通过利用积分操作的可加性，更新全局矩阵和右手边。

对这个问题也存在着不同的方法：在某些情况下，不构建矩阵，而是在它与一个向量相乘时直接计算其效果，就像用迭代方法解决线性系统时发生的那样；由于篇幅原因，这里我们处理的是更标准的方法。

如前所述，局部矩阵的构造是通过对参考元素$\widehat{K}$进行积分，使用合适的正交公式进行的。一旦构建了矩阵和已知项，就可以施加边界条件；特别是，施加Dirichlet条件不一定需要第3.2.2和4.5节中的技术。3.2.2和4.5节中所看到的技术，即在构建了升力之后去除与这些条件相关的自由度。

这应该可以解释为什么组装是一个复杂的阶段。在下面的章节中，我们将讨论上述方面，但由于篇幅的原因，讨论的细节不多。首先，我们将讨论几何（第8.4.1节）和功能（第8.4.2节）信息编码的数据结构。参考元素和当前元素之间的几何映射的计算提供了引入等参数元素的机会（第8.4.3节）。第8.4.4节讨论了局部矩阵和已知项的有效计算以及它们在构建全局系统中的使用。最后，在第8.4.4节中，我们将讨论如何在全局系统中使用局部矩阵和已知项。  $8.4 .5$中，我们将提到边界基准点提升的实施技术。

\subsubsection{Coding geometrical information}

就数据结构而言，网格可以被看作是一个几何元素和拓扑信息的集合。前者可以通过聚合定义点（即零维几何元素）、边（一维几何元素）、面（二维）和最后的体（三维）的类来构建。

从编码这些几何实体的基类开始，网格将是一个收集这些元素的类。事实上，几何结构应该由以下元素来补充。

拓扑信息可以用来描述网格中的元素，即节点之间的连接性，与后者的常规编号相比。图8.5说明了LifeV中可能的元素的惯例；为了有效地 "访问 "网格中的元素，我们还可以在每个给定的元素上添加相邻元素的信息。

2. 允许在边界上定位自由度的具体信息；这简化了对边界条件规定的处理；注意，我们通常为每个边界几何元素关联一个指标，随后将与特定的边界条件关联。从参考几何类开始，我们根据第8.4.3节中处理的可能的映射，检索出当前的几何元素。例如，程序2给出了一个建立在四面体基本参考形状上的线性（仿生）四面体类的一部分，并给出了相关自由度的一些功能信息。

目前，网格文件的格式还没有标准。每个网格生成器都有自己的格式。通常情况下，我们希望这样的文件包含顶点坐标，将顶点与几何元素相关联的连接，以及边界元素的列表，以及用于定义边界条件的相应指标。而作为边界条件的数据的函数，一般都是单独分配的。

备注8.2.多物理或多模型问题正在成为科学计算的一个相关组成部分：例如，想想流体与结构的相互作用问题，或者耦合问题，其中完整的(和计算成本较高的)微分模型只用于特定的兴趣区域，并在其余区域与较简单的模型耦合。这些应用以及更普遍的开发并行计算算法的需要，促使了通过域分解解决微分问题的技术的发展（见第19章和更全面的介绍[QV99, TW05]）。在这种情况下，产生的网格是子域网格的集合，同时还有子域界面的拓扑信息。然而，在本章中，我们将只提到单域问题。

\subsubsection{Coding of functional information}

正如在第四章中所看到的，基函数被定义在一个参考元素上。例如，对于四面体来说，这个元素与单位单线相吻合（见图8.5）。参考元素的编码基本上包括指向用于确定基函数及其导数的函数的指针。

在程序3中，我们报告了用于定义四面体上的线性有限元的函数。为了节省篇幅，我们只提供了第一个基函数的第一个导数的代码。

![](https://cdn.mathpix.com/cropped/10058ab4e7f0c5bd6fe5bcd4db204623-193.jpg?height=283&width=722&top_left_y=358&top_left_x=94)

一旦参考元素被实例化，功能信息将可用于解决方案的表示以及参考元素和当前元素之间的几何映射的定义，我们将在下一节解释。

在定义了几何元素和我们要使用的有限元素的类型后，我们现在能够构建问题的自由度。这意味着为每个网格元素分配位于该元素上的自由度的编号和局部矩阵的模式；后者通常是完整的，尽管它可能总是包含空元素。

\subsubsection{Mapping between reference and physical element}

在第四章中，我们看到写基函数、正交公式以及因此计算相对于参考元素的积分是多么方便。因此，研究一些实际的方法来构造和编码这样的坐标变化可能是有趣的。关于进一步的细节，我们参考 [Hug00] 。现在让我们限制自己考虑三角形和四面体元素的情况。

第一种类型的坐标变换是仿生变换。基本上，$\hat{\mathbf{x}}$和$\mathbf{x}$之间的映射可以通过矩阵$B$和矢量$\mathbf{c}$表示（见第4.5.3节和图8.6）。

!!!!
\mathbf{x}=B \hat{\mathbf{x}}+\mathbf{c}
$$

这样，我们琐碎地得到，$J=B$（每个元素上的常数）。如果网格生成器生成的节点分布是正确的，$J$的行列式总是

![](https://cdn.mathpix.com/cropped/10058ab4e7f0c5bd6fe5bcd4db204623-194.jpg?height=350&width=548&top_left_y=112&top_left_x=182)

图8.6.参考四面体与当前四面体之间的映射。上面的映射是仿生的，下面的映射是二次的。

正，这就保证了不存在退化的情况（例如，四面体的四个顶点在同一个平面上），并且在对应于映射的节点中不存在不正确的排列组合。$B$和$\mathbf{c}$的表达式可以从那些节点坐标中得到。事实上，让我们假设参考四面体的节点，当地编号为$1,2,3,4$，分别对应于网格中编号为$i, k, l, m$的节点。

我们就有了。

!!!!
\left\{\begin{array}{lll}
x_{i}=c_{1} & y_{i}=c_{2} & y_{i}=c_{3} \\
x_{k}=b_{11}+x_{i} & y_{k}=b_{12}+y_{i} & z_{k}=b_{13}+y_{i} \\
x_{l}=b_{21}+x_{i} & y_{l}=b_{22}+y_{i} & z_{l}=b_{23}+y_{i} \\
x_{m}=b_{31}+x_{i} & y_{m}=b_{32}+y_{i} & z_{m}=b_{33}+y_{i}
\end{array}\right.
\label{8.5}\end{equation}

由此我们可以得到$B$和$\mathbf{c}$的表达式。

然而，存在一种更有效的方法来表示这种转换：作为元素的线性，它可以通过线性拉格朗日有限元的基函数来表示。事实上，我们可以这样写。

!!!!
x=\sum_{j=0}^{3} X_{j} \widehat{\varphi}_{j}(\widehat{x}, \hat{y}, \widehat{z}), y=\sum_{j=0}^{3} Y_{j} \widehat{\varphi}_{j}(\widehat{x}, \widehat{y}, \widehat{z}), z=\sum_{j=0}^{3} Z_{j} \widehat{\varphi}_{j}(\widehat{x}, \widehat{y}, \widehat{z})
\label{8.6}\end{equation}

变换的雅各布矩阵的元素立即被计算出来。

!!!!
J=\left[\begin{array}{cc}
\sum_{j=1}^{4} X_{j} \frac{\partial \widehat{\varphi}_{j}}{\partial \widehat{x}} & \sum_{j=1}^{4} X_{j} \frac{\partial \widehat{\varphi}_{j}}{\partial \widehat{y}} & \sum_{j=1}^{4} X_{j} \frac{\partial \widehat{\varphi}_{j}}{\partial \widehat{z}} \\
\sum_{j=1}^{4} Y_{j} \frac{\partial \widehat{\varphi}_{j}}{\partial \widehat{x}} & \sum_{j=1}^{4} Y_{j} \frac{\partial \widehat{\varphi}_{j}}{\partial \widehat{y}} & \sum_{j=1}^{4} Y_{j} \frac{\partial \widehat{\varphi}_{j}}{\partial \widehat{z}} \\
\sum_{j=1}^{4} Z_{j} \frac{\partial \widehat{\varphi}_{j}}{\partial \widehat{x}} & \sum_{j=1}^{4} Z_{j} \frac{\partial \widehat{\varphi}_{j}}{\partial \widehat{y}} & \sum_{j=1}^{4} Z_{j} \frac{\partial \widehat{\varphi}_{j}}{\partial \widehat{z}}
\end{array}\right]
\label{8.7}\end{equation}



![](https://cdn.mathpix.com/cropped/10058ab4e7f0c5bd6fe5bcd4db204623-195.jpg?height=399&width=390&top_left_y=111&top_left_x=263)

图8.7.参考四边形和当前元素之间的映射：仿生（上），等参数（中），混合（下）。后者由5个节点构成，以便对单边的节点进行双曲线转换。

当在拉格朗日有限元中，相同的基函数被用于定义几何映射时，我们说我们是在处理等参量元素（见图8.6和8.7）。在目前的情况下，这是选择线性有限元和仿生几何变换的结果。当我们采用大于1度的有限元时，我们可以考虑两类映射。

- 仿生有限元：在这种情况下，几何变换仍然由仿生变换\ref{8.6} 描述，尽管相对于解决方案的函数信息由更高程度的二次函数描述；离散域$\Omega_{h}$的边界，在这种情况下，仍然是多边形（多面体）。

- 等参数有限元：几何变换由用于表示解决方案的相同基函数描述；因此，物理空间$O x y z$中的元素一般会有弯曲的边。

从四面体参考元素开始的四维映射的定义允许例如创建四面体的四维几何元素，在程序 $4$ 中报告的QuadraticTetra类中编码。

i =

![](https://cdn.mathpix.com/cropped/10058ab4e7f0c5bd6fe5bcd4db204623-196.jpg?height=138&width=723&top_left_y=112&top_left_x=95)

在确定了参考元素的类型和几何映射之后，就可以构建 "当前 "元素的集合。当前元素可以按照程序 $5$ 进行编码。

![](https://cdn.mathpix.com/cropped/10058ab4e7f0c5bd6fe5bcd4db204623-196.jpg?height=878&width=733&top_left_y=357&top_left_x=93)

可以看出，该类包含与参考元素、生成它的几何映射以及用于计算积分的正交公式有关的信息。

特别是，\ref{8.7} 在编码阶段被证明是非常有效的，我们在程序 $6$ 中报告了这一点。雅各布的计算是在积分计算所需的正交节点进行的（第8.2节）。
 ![](https://cdn.mathpix.com/cropped/10058ab4e7f0c5bd6fe5bcd4db204623-197.jpg?height=542&width=722&top_left_y=284&top_left_x=94)

在四边形和棱柱形元素的情况下，前面的几个概念可以被扩展，例如参考双线性或双二次方映射。然而，保证映射是可逆的是比较困难的：关于更多的细节，见 [FSV12] 。

在有些情况下，使用不同坐标的不同程度的有限元是很方便的。这可以使用四边形结构的网格，我们可以在其中构建一个元素，一边是双二次多项式，其余一边是双线性多项式。在对几何映射进行等参数编码的情况下，这就导致了拥有例如三条直边和一条弯边的四边形元素。为此，我们指出[Hug00，第4章]，报告了四边形元素的 "增量 "实现，从一个四节点的双线性设置开始，通过其他自由度来充实，直到双曲线9节点元素。

\subsubsection{Construction of local and global systems}

这个阶段是构建微分算子离散化的核心。作为一个例子，让我们以程序7中的代码为例，它构建了椭圆微分方程的离散化 $-\mu \triangle u+\sigma u=f$ 。

整个操作是在网格aMesh的所有元素上循环衔接的。在将基本矩阵和向量设置为零后，这些结构被逐步填充，首先是刚度（扩散）算子的离散化，然后是质量算子（反应）。源子程序处理局部右手边的向量。组装子程序处理全局矩阵中的计算更新，如前面图8.2所示。

在这个阶段，为了避免使用循环内的条件分支检查自由度是否在边界上，我们忽略了边界条件。
 ![](https://cdn.mathpix.com/cropped/10058ab4e7f0c5bd6fe5bcd4db204623-198.jpg?height=482&width=714&top_left_y=462&top_left_x=102)

让我们详细看看局部计算和全局更新的可能实现。

\section{Computation of the local matrices}

程序8报告了扩散算子的局部矩阵和线性系统的右手边的计算的实现。

特别是，我们首先集合对角线贡献，然后集合局部矩阵的对角线外贡献，从而在正交节点上循环。循环操作的 "核心 "是：指令

![](https://cdn.mathpix.com/cropped/10058ab4e7f0c5bd6fe5bcd4db204623-199.jpg?height=23&width=188&top_left_y=154&top_left_x=107)

逐步更新本地矩阵的$i, j$项：在调用随后的子程序mass()时，反应算子的贡献将被添加到先前计算的贡献中。

我们以类似的方式在源头上进行已知项的本地向量的计算。

![](https://cdn.mathpix.com/cropped/10058ab4e7f0c5bd6fe5bcd4db204623-199.jpg?height=913&width=723&top_left_y=327&top_left_x=95)



![](https://cdn.mathpix.com/cropped/10058ab4e7f0c5bd6fe5bcd4db204623-200.jpg?height=682&width=720&top_left_y=114&top_left_x=95)

\section{Update of the global matrix}

程序9包含从局部矩阵开始的全局矩阵的更新。关键的一点是确定构成当前元素的节点的位置，我们刚刚在全局矩阵中计算了局部矩阵。这个操作是通过查找dof.localToGlobal表来完成的，其中包含这种类型的操作。

对于右手边的更新，我们进行类似的操作。显然，积分的可加性要求通过添加不同的贡献来进行操作：这解释了向量更新中的$+=$（对应于$V[i g]=V[i g]+\operatorname{vec}(i)$和M.setmatinc中的类似术语，它代表了集合矩阵的增量。

![](https://cdn.mathpix.com/cropped/10058ab4e7f0c5bd6fe5bcd4db204623-200.jpg?height=139&width=726&top_left_y=1101&top_left_x=94)



![](https://cdn.mathpix.com/cropped/10058ab4e7f0c5bd6fe5bcd4db204623-201.jpg?height=688&width=694&top_left_y=137&top_left_x=97)

\subsubsection{Boundary conditions prescription}

高效存储稀疏矩阵的需求必须由访问和操作矩阵本身的需求来补偿，正如我们之前注意到的CSR格式，例如在设置边界条件的阶段。在有限元代码中，矩阵的装配通常是不考虑边界条件的，这样就不会在装配过程中引入条件性分支。然后通过修改代数系统来引入边界条件。强加诺伊曼和罗宾型条件基本上转化为计算合适的边界积分（或者，在一维情况下，计算在边界上的值）。例如，程序10实现了对函数Bcb中规定的诺伊曼型条件的表面积分的计算。该积分需要一个合适的正交公式，允许更新已知项b。结构bdLocalToGlobal允许在全局右手边转移具有诺伊曼自由度的每个边界元素的信息。
 ![](https://cdn.mathpix.com/cropped/10058ab4e7f0c5bd6fe5bcd4db204623-202.jpg?height=976&width=738&top_left_y=118&top_left_x=82)

处理Dirichlet（基本）边界条件更为复杂（见图8.2）。这种操作有多种策略，其中一些在 [FSV12] 中进行了处理。理论所规定的最连贯的方法包括从装配过程中得到的系统中删除与狄氏边界条件相关的节点的行和列，从而通过使用我们想要施加的狄氏基准的值来修正已知项。

事实上，这与通过为有限元选择的度数的片状多项式函数提升边界基准的操作相吻合，其支持仅限于三角形中唯一面向边界的元素层（见第4.5.1节的图$4.13$）。

这种处理方式的优点是将问题的维度减少到有效的自由度数，然而它的实际执行却有问题。事实上，对于$1 D$问题，由于自由度的自然排序，要去除的可选行和列总是第一个和最后一个，而对于多维问题，其实施涉及到消除行和列，其编号可能是任意的，这是一个难以有效处理的操作。还必须注意的是，这种操作会大大改变矩阵的模式，如果我们想在几个矩阵中共享后者以节省内存，这可能会很不方便。出于这个原因，我们倾向于将强加在给定节点$k_{D}$上的迪里希特条件视为$u_{k_{D}}=g_{k_{D}}$形式的方程，取代原系统的第$k_{D}$行。为了避免修改矩阵模式，这种替换必须通过湮灭对角线外的行元素来插入，除了对角线元素，它被设置为1，而右手边的相应条目被设置为$g_{k_{D}}$。

这个操作只需要对矩阵进行逐行访问，CSR格式在这方面特别有效。

\subsection{Integration in time}

在不同的时间积分方法中，我们在前几章分析了$\theta$方法，并指出了其他一些方法，特别是LifeV中实现的BDF（后向差分公式）方法。这些方法的介绍可以在 [QSS07] 中找到。我们在此回顾一下它们的一些基本方面。

给出常微分方程系统。

!!!!
M \frac{d \mathbf{u}}{d t}=\mathbf{f}-A \mathbf{u}
$$

和相关的初始基准$\mathbf{u}(t=0)=\mathbf{u}_{0}$，BDF方法是一个隐含的多步骤方法，其形式为

!!!!
\frac{\alpha_{0}}{\Delta t} M \mathbf{U}^{n+1}+A \mathbf{U}^{n+1}=\mathbf{f}^{n+1}+\sum_{j=1}^{p} \frac{\alpha_{j}}{\Delta t} \mathbf{U}^{n+1-j}
\label{8.8}\end{equation}

为合适的$p \geq 1$，其中系数的确定是为了。

!!!!
\left.\frac{\partial \mathbf{U}}{\partial t}\right|_{t=t^{n+1}}=\frac{\alpha_{0}}{\Delta t} \mathbf{U}^{n+1}-\sum_{j=1}^{p} \frac{\alpha_{j}}{\Delta t} \mathbf{U}^{n+1-j}+\mathscr{O}\left(\Delta t^{p}\right)
$$

表8.3.BDF方法的系数$\alpha_{i}$和时间外推法的系数$\beta_{i}$。

\begin{tabular}{cccccccc}。
\hline $p$ & $\alpha_{0}$ & $\alpha_{1}$ & $\alpha_{2}$ & $\alpha_{3}$ & $\beta_{0}$ & $\beta_{1}$ & $\beta_{2}$ （$\beta_{2}$）。

2 & $3 / 2$ & 2 & $-1 / 2$ & $-$ & 2 & $-1$ & $-$ （$-$）。
3 & $11 / 6$ & 3 & $-3 / 2$ & $1 / 3$ & 3 & $-3$ & 1 （1）。
\hline
\end{tabular}

这里，$\Delta t>0$是时间步长，$t^{n}=n \Delta t$ ，$\mathbf{U}^{n}$代表$\mathbf{U}$在时间$t^{n}$ 。在表$8.3$（左边）中，我们报告了$p=1$（隐式欧拉方法）的系数，$2,3$ 。

如果矩阵$A$是$\mathbf{u}$的函数，即当问题\ref{8.8}是非线性的时候，BDF方法由于是隐式的，成本会非常高，因为它们在每个时间步骤都需要解决$\mathbf{U}^{n+1}$中的非线性代数系统。

!!!!
\frac{\alpha_{0}}{\Delta t} M \mathbf{U}^{n+1}+A\left(\mathbf{U}^{n+1}\right) \mathbf{U}^{n+1}=\mathbf{f}^{n+1}+\sum_{j=1}^{p} \frac{\alpha_{j}}{\Delta t} \mathbf{U}^{n+1-j}
$$

一个可能的折衷办法是，在不改用完全显式方法（其稳定性一般不令人满意）的情况下，大大降低计算成本，即解决线性系统

!!!!
\frac{\alpha_{0}}{\Delta t} M \mathbf{U}^{n+1}+A\left(\mathbf{U}^{*}\right) \mathbf{U}^{n+1}=\mathbf{f}^{n+1}+\sum_{j=1}^{p} \frac{\alpha_{j}}{\Delta t} \mathbf{U}^{n+1-j}
$$

其中$\mathbf{U}^{*}$使用前面步骤中已知的解决方案近似于$\mathbf{U}^{n+1}$。我们基本上设定

!!!!
\mathbf{U}^{*}=\sum_{j=0}^{p} \beta_{j} \mathbf{U}^{n-j}=\mathbf{U}^{n+1}+\mathscr{O}\left(\Delta t^{p}\right)
$$

为合适的 "外推 "系数 $\beta_{j}$ 。目的是降低计算成本，同时不大幅降低隐式方案的绝对稳定区域和时间推进方案的整体精度。表 $8.3$ 报告了这些系数 $\beta_{j}$ 。

在这一点上，$\mathrm{BDF}$时间积分器的编码可以使用一个专门的类来进行，在程序11中报告，其成员是。

1.阶数$p$的指标，也说明了向量$\alpha$和$\beta$的尺寸；2.向量$\boldsymbol{\alpha}$和$\boldsymbol{\beta}$ 。

3. 通过对齐向量$\mathbf{U}^{n}, \mathbf{U}^{n-1}, \ldots \mathbf{U}^{n+1-p}$给出的未知数矩阵。每个向量的大小，即这种矩阵的行数（有$p$列）被存储在大小索引中。

在集合了矩阵$A$和$M$后，将通过计算矩阵$\frac{\alpha_{0}}{\Delta t} M+A$、右手边$\mathbf{f}^{n+1}+\sum_{j=1}^{p} \frac{\alpha_{j}}{\Delta t} \mathbf{U}^{n+1-j}$和解决系统\ref{8.8} 来执行时间推进方案。特别是，在程序11中提出的实施方案中，函数time der通过访问向量$\alpha$和未知数矩阵来计算项$\sum_{j=1}^{p} \frac{\alpha_{j}}{\Delta t} \mathbf{U}^{n+1-j}$。如果问题是非线性的，我们可以通过函数extrap()来访问向量$\boldsymbol{\beta}$。

在计算出新的时间步长的解决方案后，未知数矩阵必须 "为其腾出空间"，将其所有列向右移动，这样第一列就是刚刚计算出的解决方案。这个操作是由函数shift right来完成的，它基本上是将倒数第二列的未知数复制到最后一列，将倒数第三列复制到倒数第二列，以此类推，直到计算出的解被完全存储。

![](https://cdn.mathpix.com/cropped/10058ab4e7f0c5bd6fe5bcd4db204623-205.jpg?height=908&width=726&top_left_y=333&top_left_x=92)



![](https://cdn.mathpix.com/cropped/10058ab4e7f0c5bd6fe5bcd4db204623-206.jpg?height=613&width=706&top_left_y=114&top_left_x=108)

\subsection{A complete example}

在本章的最后，我们列出了一个为解决抛物线扩散-反应问题而编写的程序。

!!!!
\begin{cases}\frac{\partial u}{\partial t}-\mu(t) \Delta u+\sigma(t) u=f, & \mathbf{x} \in \Omega, \quad 0<t \leq 10 \\ u=g_{1}, & \mathbf{x} \in \Gamma_{10} \cup \Gamma_{11}, \quad 0<t \leq 10 \\ u=g_{2}, & \mathbf{x} \in \Gamma_{20} \cup \Gamma_{21}, \quad 0<t \leq 10 \\ \nabla u \cdot \mathbf{n}=0, & \mathbf{x} \in \Gamma_{50}, \quad 0<t \leq 10 \\ u=u_{0}, & \mathbf{x} \in \Omega, \quad t=0\end{cases}
$$

其中$\Omega$是一个立方域，$\partial \Omega=\Gamma_{10} \cup \Gamma_{11} \cup \Gamma_{20} \cup \Gamma_{21} \cup \Gamma_{50}$ 。准确地说，各个边界部分的数字代码是：。

!!!!
\begin{aligned}
&\Gamma_{20}: x=0,0<y<1,0<z<1 \\
&\Gamma_{21}: x=0,(y=0,0<z<1) \cup(y=1,0<z<1) \\
&\cup \cup(z=0,0<y<1) \cup(z=0,0<y<1)
\end{aligned}
$$



!!!!
\begin{aligned}
&\Gamma_{10}: x=1,0<y<1,0<z<1 \\
&\Gamma_{11}: x=1,(y=0,0<z<1) \cup(y=1,0<z<1) \\
&\qquad \cup(z=0,0<y<1) \cup(z=0,0<y<1) ; \\
&\Gamma_{50}: \partial \Omega \backslash\left\{\Gamma_{20} \cup \Gamma_{21} \cup \Gamma_{10} \cup \Gamma_{11}\right\} .
\end{aligned}
$$

特别是，$\mu(t)=t^{2}, \sigma(t)=2, g_{1}(x, y, z, t)=g_{2}(x, y, z, t)=t^{2}+x^{2}, u_{0}(x, y, z)=0$ ，$f=2 t+2 x^{2}$ 。精确解正是$t^{2}+x^{2}$，测试是在6007个元素的立方网格上进行的，有二次仿生四面体，总共有9247个自由度。时间步长为$\Delta t=0.5$ ，$\mathrm{BDF}$方案的顺序为3。

程序12包含了这个例子的主要程序（最初是基于库LifeV），并加入了评论以帮助阅读，尽管显然不是所有的东西都能通过阅读前面的章节就能立即明白。与本章的设计精神相一致，我们邀请读者尝试编写自己的代码或运行LifeV、FEniCS或OpenFOAM等库的教程。

![](https://cdn.mathpix.com/cropped/10058ab4e7f0c5bd6fe5bcd4db204623-207.jpg?height=148&width=714&top_left_y=492&top_left_x=95)

![](https://cdn.mathpix.com/cropped/10058ab4e7f0c5bd6fe5bcd4db204623-207.jpg?height=583&width=644&top_left_y=633&top_left_x=119)

// 用于时间积分的参数的定义

![](https://cdn.mathpix.com/cropped/10058ab4e7f0c5bd6fe5bcd4db204623-209.jpg?height=1122&width=642&top_left_y=116&top_left_x=118)



![](https://cdn.mathpix.com/cropped/10058ab4e7f0c5bd6fe5bcd4db204623-210.jpg?height=1125&width=586&top_left_y=111&top_left_x=149)



![](https://cdn.mathpix.com/cropped/10058ab4e7f0c5bd6fe5bcd4db204623-211.jpg?height=773&width=723&top_left_y=137&top_left_x=95)

这就是我们在运行代码后得到的结果

![](https://cdn.mathpix.com/cropped/10058ab4e7f0c5bd6fe5bcd4db204623-211.jpg?height=212&width=327&top_left_y=960&top_left_x=97)

请注意，这些误差将完全归因于线性系统的解：由于准确的解是一个时间和空间上的抛物线函数，选择2度的有限元和3阶的BDF方案保证了离散化误差是非空的。图$8.8$说明了Medit的可视化结果。

![](https://cdn.mathpix.com/cropped/10058ab4e7f0c5bd6fe5bcd4db204623-212.jpg?height=314&width=635&top_left_y=197&top_left_x=139)

图8.8.5个（左）和20个（右）时间步骤后的模拟结果



\section{The finite volume method}

有限体积法是一种非常流行的对守恒形式的偏微分问题进行空间离散化的方法。对于该方法的深入介绍，我们建议阅读专著 [LeV02a] , [Wes01] 和 [Tor09] 。

作为描述方法和说明其主要特点的范例，让我们考虑以下标量方程

!!!!
\frac{\partial u}{\partial t}+\operatorname{div}(\mathbf{F}(u))=s(u), \quad \mathbf{x} \in \Omega, t>0
\label{9.1}\end{equation}

其中$u:(\mathbf{x}, t) \rightarrow \mathbb{R}$表示未知数，$\mathbf{x} \in \Omega \subset \mathbb{R}^{d}(d=1,2,3), \mathbf{F}$是一个给定的矢量函数，线性或非线性，称为通量，$s$是一个给定的源函数。如果通量$\mathbf{F}$包含取决于$u$的一阶导数的项，则微分问题是二阶问题。微分方程\ref{9.1}必须由$t=0$的初始条件$u(\mathbf{x}, 0)=u_{0}(\mathbf{x}), \mathbf{x} \in \Omega$以及合适的边界条件来完成，如果问题\ref{9.1} 是二阶问题，则在整个边界$\partial \Omega$上，如果是一阶问题，则只在$\partial \Omega$的一个子集$\partial \Omega^{i n}$（流入边界）。正如我们将在第16章看到的（见$16.1$节和第16.4节），这种类型的微分方程被称为守恒定律。

第13章将讨论的扩散-传输方程、第$14-16$章的纯传输方程以及第5章所研究的抛物线方程，都可以被视为\ref{9.1}的特例。事实上，所有从物理守恒定律衍生出来的偏微分方程都可以用守恒形式表示。

通常情况下，有限体积法对以守恒形式书写的方程进行操作，如 \ref{9.1} 。

通过一些额外的努力，我们显然可以考虑矢量情况，其中未知数$\mathbf{u}$和源$\mathbf{s}$是具有$p$分量的矢量函数，而通量$\mathbf{F}$现在是具有维度$p \times d$的张量。特别是，纳维-斯托克斯方程和欧拉方程的可压缩流，将在本节中考虑。  $16.4$可以用保守的形式重写。第17.11节将讨论用于实际应用的自由表面不可压缩流的有限体积近似。

![](https://cdn.mathpix.com/cropped/10058ab4e7f0c5bd6fe5bcd4db204623-214.jpg?height=250&width=528&top_left_y=115&top_left_x=147)

图9.1.在$2 \mathrm{D}$（左）和三维（右）中的一个控制体积

\subsection{Some basic principles}

对\ref{9.1}进行有限体积离散化的第一步是确定一组直径小于$h$的多面体$\Omega_{i} \subset \Omega$，称为控制体积（或控制单元），$i=1, \ldots, M$，这样$\cup_{i} \bar{\Omega}_{i}=\bar{\Omega}$（为简单起见，我们将假设域$\Omega$为多边形，否则$\cup_{i} \bar{\Omega}_{i}$将是其近似值）。控制体的例子见图9.1。我们将进一步假设单元格是成对不相交的，这是最常用的情况，尽管这种限制在原则上不是本方法所要求的。

方程\ref{9.1} 在每个$\Omega_{i}$上进行积分；利用发散定理，我们得到常微分方程系统

!!!!
\frac{\partial}{\partial t} \int_{\Omega_{i}} u d \Omega+\int_{\partial \Omega_{i}} \mathbf{F}(u) \cdot \mathbf{n}_{i} d \gamma=\int_{\Omega_{i}} s(u) d \Omega, \quad i=1, \ldots, M
\label{9.2}\end{equation}

我们用$\mathbf{n}_{i}$表示$\partial \Omega_{i}$的单位外向法线。在二维空间中，让我们用$L_{i}$表示$\Omega_{i}$的直边数（在图中为$\left.9.1 L_{i}=5\right)$），用$\mathbf{n}_{i j}, j=!!!!1, \ldots, L_{i}$表示$\partial \Omega_{i}$的边上的（恒定）外向单位法向量 。那么\ref{9.2} 可以改写为

!!!!
\frac{\partial}{\partial t} \int_{\Omega_{i}} u d \Omega+\sum_{j=1}^{L_{i}} \int_{l_{i j}} \mathbf{F}(u) \cdot \mathbf{n}_{i j} d \gamma=\int_{\Omega_{i}} s(u) d \Omega, \quad i=1, \ldots, M
\label{9.3}\end{equation}

有几个问题必须要解决。

- 控制体积应具有何种几何形状。

- 如何在每个控制量中表示未知数$u$，即哪些是它的自由度，它们应该放在哪里。

- 如何对（体积和表面）积分进行近似计算。

- 如何表示每一侧的通量$\mathbf{F}(u)$，作为与该侧相邻的控制体积上的未知值$u$的函数。

对于控制体的构建，我们通常从域的三角化$\mathscr{T}_{h}$开始，将其转化为称为元素的多边形，例如$\left\{K_{m}\right\}$，同类的多边形。通常情况下

![](https://cdn.mathpix.com/cropped/10058ab4e7f0c5bd6fe5bcd4db204623-215.jpg?height=327&width=262&top_left_y=112&top_left_x=324)

图9.2.块状结构网的一个例子

在$2 \mathrm{D}$中是三角形或四边形，在$3 \mathrm{D}$中是四面体或六面体，正如我们在第四章使用有限元时看到的。网格可以是结构化的，也可以是块状结构的（有不相连接的或重叠的块），或者是非结构化的。结构化网格一般以形状相对简单的域为界，以使整个域或其细分的每个块都能被映射为矩形或立方体。在图$9.2$中，我们在一艘游艇的附属物表面显示了一个块状结构网格。

一旦领域被三角化，我们有两种可能性。

在所谓的单元中心法中，$\left\{K_{m}\right\}$的元素$\mathscr{T}_{h}$直接充当控制体。因此，未知数与每个元素上的一个内部点相关联，通常是称为节点的arycenter。然而，这种表面上自然的控制体的选择有一个缺点：由于$\Omega$的边界上没有节点，施加边界条件将需要特殊的行动，这一点我们将在后面研究。为了解决这种不便，我们可以在$\mathscr{T}_{h}$的元素周围构建控制体，在那里我们将放置未知数。这就产生了所谓的以顶点为中心的方案。

有时，在有多个未知数的多场问题中，两种技术同时使用，将不同的未知数放在不同的节点上。在这种情况下，我们会说使用了交错网格；我们将在第17.11节介绍一个显著的例子，专门讨论纳维-斯托克斯方程的离散化。

图$9.3$中报告了一个结构化四边形网格上的基本例子，我们还显示了以单元为中心和以顶点为中心方案的控制体积。后者是由方块定义的

!!!!
\Omega_{i}^{V}=\left\{\mathbf{x} \in \Omega:\left\|\mathbf{x}-\mathbf{x}_{i}\right\|_{\infty}<h / 2\right\}, \quad \Omega_{i}=\Omega_{i}^{V} \cap \Omega,
\label{9.4}\end{equation}

其中$\left\{\mathbf{x}_{i}\right\}$是初始网格$\mathscr{T}_{h}$的方块$\left\{K_{m}\right\}$的顶点，在这种情况下与控制体的节点重合，$h$是元素边缘的均匀长度。

这两种选择并没有穷尽实践中遇到的选择。有时，变量被放置在网格$\mathscr{T}_{h}$的每个边（或面）上，而

![](https://cdn.mathpix.com/cropped/10058ab4e7f0c5bd6fe5bcd4db204623-216.jpg?height=197&width=525&top_left_y=113&top_left_x=200)

图 9.3.控制体积（灰色）由边长为$\Omega$的方形域$h$的方形有限元分割产生。左：以单元为中心的情况。右：以顶点为中心的情况

相应的控制量是由与边（或面）相邻的$\mathscr{T}_{h}$的元素形成的。

一般来说，有限体积方法很容易实现：离散化单元可以选择非常一般的形式，解决方案通常被假定为每个控制体积中的常数函数，诺伊曼边界条件以自然的方式施加，问题的表述本身就表达了量的局部保守 $\int_{\Omega_{i}} u d \Omega$ 。潜在的缺点是绘制高阶方案的客观困难，需要处理基本（Dirichlet）边界条件，特别是对于以单元为中心的方法；最后，数学分析不如Galerkin方法简单，因为直接应用前者的变分技术并不直接。

然而，应该提到的是，一些特殊的有限体积近似实例可以从第12章将介绍的不连续Galerkin方法开始恢复。例如，见 [EGH00] , [Riv08] 。

\subsection{Construction of control volumes for vertex-centered schemes}

在原始三角形$\mathscr{T}_{h}$由$2 \mathrm{D}$中的三角形非结构元素或$3 \mathrm{D}$中的四面体元素组成的情况下，围绕$\mathscr{T}_{h}$的顶点构造控制体并不简单。原则上，我们可以选择包含顶点$\mathbf{x}_{i}$的所有元素的集合作为控制体$\Omega_{i}$。然而，这将产生具有非空交点的控制卷，这是一种允许的，但不是理想的情况。

因此，我们可以利用一些几何学的概念。例如，让我们考虑一个有界多边形域$\Omega \subset \mathbb{R}^{2}$，让$\left\{\mathbf{x}_{i}\right\}_{i \in \mathscr{P}}$是$\bar{\Omega}$的一组点，我们称之为节点。这里$\mathscr{P}$表示一组索引。这些点通常是我们打算提供解的近似值的地方 $u$ 。我们给每个节点关联多边形

!!!!
\Omega_{i}^{V}=\left\{\mathbf{x} \in \mathbb{R}^{2}:\left|\mathbf{x}-\mathbf{x}_{i}\right|<\left|\mathbf{x}-\mathbf{x}_{j}\right| \forall j \in \mathscr{P}, j \neq i\right\}
\label{9.4}\end{equation}

与$i \in \mathscr{P}$。与$\left\{\Omega_{i}^{V}, i \in \mathscr{P}\right\}$相关的点集$\left\{\mathbf{x}_{i}\right\}_{i \in \mathscr{P}} ; \Omega_{i}^{V}$被称为第i个Voronoi多边形，该集合被称为Voronoi图，或Voronoi镶嵌图。对于

![](https://cdn.mathpix.com/cropped/10058ab4e7f0c5bd6fe5bcd4db204623-217.jpg?height=197&width=380&top_left_y=110&top_left_x=274)

图9.4.沃罗诺伊图

一个例子见图9.4。这样得到的多边形是凸的，但不一定是有界的（例如考虑与边界相邻的多边形）。它们的顶点被称为Voronoi顶点；当一个顶点是三个Voronoi多边形的交汇点时，就被称为规则顶点，而当它至少被四个多边形共享时，就被称为退化顶点。一个只有规则顶点的Voronoi图又被称为规则图。

在这一点上，我们可以将上一节中介绍的控制量$\Omega_{i}$定义为

!!!!
\Omega_{i}=\Omega_{i}^{V} \cap \Omega, \quad i \in \mathscr{P}
\label{9.5}\end{equation}

对于每个$i \in \mathscr{P}$，我们用$\mathscr{P}_{i}$表示与$\mathbf{x}_{i}$相邻的节点的索引集，也就是说。

!!!!
\mathscr{P}_{i}=\left\{j \in \mathscr{P} \backslash\{i\}: \partial \Omega_{i} \cap \partial \Omega_{j} \neq \emptyset\right\}
$$

此外，我们用$l_{i j}=\partial \Omega_{i} \cap \partial \Omega_{j}, j \in \mathscr{P}_{i}$表示，$\Omega_{i}$的边界有一条边被相邻的控制体共享，用$m_{i j}$表示其长度。如果Voronoi图是规则的，我们有$m_{i j}>0$ 。在这种情况下，如果我们将每个节点$\mathbf{x}_{i}$与$\mathscr{P}_{i}$的节点连接起来，就会得到$\Omega$的三角化，与节点的凸壳的德劳内三角化（见6.4.1节）相吻合。如果Voronoi方块中存在退化顶点，从这个过程中我们仍然可以得到Delaunay三角图，只要我们对围绕退化顶点构造的多边形$\Omega_{i}$进行适当的三角化。显然，如果$\Omega$是凸的，上述过程直接提供了$\Omega$的德劳内三角剖分，例如，见图9.5。反过程也是可能的，注意到Voronoi图的顶点对应于![](https://cdn.mathpix.com/cropped/10058ab4e7f0c5bd6fe5bcd4db204623-217.jpg?height=200&width=508&top_left_y=976&top_left_x=197)的中心。
 ![](https://cdn.mathpix.com/cropped/10058ab4e7f0c5bd6fe5bcd4db204623-217.jpg?height=200&width=508&top_left_y=976&top_left_x=197)

图9.5.从Voronoi图（左）得到的Delaunay三角图（右）。圆点表示节点$\left\{\mathbf{x}_{i}\right\}_{i \in \mathscr{P}}$ 。
 ![](https://cdn.mathpix.com/cropped/10058ab4e7f0c5bd6fe5bcd4db204623-218.jpg?height=186&width=516&top_left_y=116&top_left_x=196)

图9.6.从德劳内三角图（左）开始得到的Voronoi图（右）。

圆周上的三角形（圆心）是相应的德劳内三角的圆周。三角形的轴线因此形成了棋盘的边。因此，后者代表了与给定的Delaunay三角形相关的一组可能的控制体（例如，见图9.6）。

Voronoi图和Delaunay三角图是相互对等的。Voronoi顶点与Delaunay三角图的元素（三角形）一一对应，反之，Delaunay顶点与细分的多边形对应，因此与结点对应。

有两个有趣的属性值得强调。第一个是锐角三角$K$的圆心位于$K$的封闭范围内。因此，如果德劳内三角图没有钝角，相应的沃罗伊图的顶点都包含在$\bar{\Omega}$中。其次，如果我们用$\mathbf{v}_{i}, i=1,2,3$表示非钝角三角形$K$的顶点，用$\Omega_{i, K}=\Omega_{i} \cap K$表示控制体积$\Omega_{i}$包含在$K$中的部分，那么我们在$K$和$\Omega_{i, K}$的度量之间有以下不等式

!!!!
\frac{1}{4}|K| \leq\left|\Omega_{i, K}\right| \leq \frac{1}{2}|K|, \quad i=1,2,3
\label{9.6}\end{equation}

除了基于Voronoi图的构造之外，还有一个不需要Delaunay三角图的方法，那就是从$\mathscr{T}_{h}$的三角图开始，该三角图由包括钝角在内的任何类型的三角形组成。如果$K$是$\mathscr{T}_{h}$的一般三角形，顶点为$\mathbf{v}_{i}, i=1,2,3$，我们现在定义

!!!!
\Omega_{i, K}=\left\{\mathbf{x} \in K: \lambda_{j}(\mathbf{x})<\lambda_{i}(\mathbf{x}), j \neq i\right\}
$$

其中$\lambda_{j}$是$K$的重心坐标（其定义见$4.4 .3$节）。图9.7中显示了一个例子。在这一点上，控制体积可以按以下方式定义

!!!!
\Omega_{i}=\operatorname{int}\left(\bigcup_{\left\{K: \mathbf{v}_{i} \in \partial K\right\}} \bar{\Omega}_{i, K}\right), \quad i \in \mathscr{P}
$$

其中int $(\mathscr{D})$ 表示封闭集 $\mathscr{D}$ 的内部。族$\left\{\Omega_{i}, i \in \mathscr{P}\right\}$定义了所谓的中值对偶网格（有时也被称为唐纳德图）。见图$9.8$为例。因此，我们可以把$l_{i j}, m_{i j}$和$\mathscr{P}_{i}$这些量定义为Voronoi图。现在，元素$l_{i j}$不一定是直线段。

![](https://cdn.mathpix.com/cropped/10058ab4e7f0c5bd6fe5bcd4db204623-219.jpg?height=187&width=254&top_left_y=109&top_left_x=333)

图9.7.一个三角形$K$，其重心$\mathbf{G}=\frac{1}{3}\left(\mathbf{v}_{1}+\mathbf{v}_{2}+\mathbf{v}_{3}\right)$，以及多边形$\Omega_{i, K}$。
 ![](https://cdn.mathpix.com/cropped/10058ab4e7f0c5bd6fe5bcd4db204623-219.jpg?height=184&width=536&top_left_y=346&top_left_x=196)

图9.8.域的三角化（左）和中位双网格，或唐纳德图（右）。

\subsection{Discretization of a diffusion-transport-reaction problem}

为了举例，让我们考虑方程式\ref{9.1}，其中

!!!!
\mathbf{F}(u)=-\mu \nabla u+\mathbf{b} u, \quad s(u)=f-\sigma u .
\label{9.7}\end{equation}

这是一个以守恒形式写成的时间依赖性扩散-传输-反应方程，类似于第13章开头描述的方程。函数$f, \mu, \sigma$和$\mathbf{b}$已经给出，并且满足第13章开头的假设。与问题\ref{13.1} 的情况一样，为简单起见，我们将假设$u$满足一个同质的迪里希特边界条件，$u=0$在$\partial \Omega$。让我们假设$\Omega$被一个Voronoi图分割，并考虑相应的Delaunay三角图（图9.5中提供了一个实例）。下面的内容实际上可以扩展到其他类型的有限体积；为此，只需考虑内部索引的集合，$\mathscr{P}_{i n t}=\left\{i \in \mathscr{P}: \mathbf{x}_{i} \in \Omega\right\}$ ，因为$u$在边界上消失了。像我们在\ref{9.3}中所做的那样，对控制体$\Omega_{i}$上的分配方程进行积分，并使用发散定理，我们发现

!!!!
\frac{\partial}{\partial t} \int_{\Omega_{i}} u d \Omega+\sum_{j=1}^{L_{i}} \int_{l_{i j}}\left(-\mu \frac{\partial u}{\partial \mathbf{n}_{i j}}+\mathbf{b} \cdot \mathbf{n}_{i j} u\right) d \gamma=\int_{\Omega_{i}}(f-\sigma u) d \Omega, \quad i \in \mathscr{P}_{i n t}
\label{9.8}\end{equation}

为了近似线积分，一个典型的策略包括使用分片常数来近似函数$\mu$和$\mathbf{b} \cdot \mathbf{n}_{i j}$，并且精确地

!!!!
\left.\mu\right|_{l_{i j}} \simeq \mu_{i j}=\text { const }>0,\left.\quad \mathbf{b} \cdot \mathbf{n}_{i j}\right|_{l_{i j}} \simeq b_{i j}=\text { const }
\label{9.9}\end{equation}



![](https://cdn.mathpix.com/cropped/10058ab4e7f0c5bd6fe5bcd4db204623-220.jpg?height=205&width=347&top_left_y=118&top_left_x=286)

图9.9.该段$l_{i j}$。

这样的常数既可以代表段$l_{i j}$中点的相应函数值，也可以代表同一侧的平均值，即

!!!!
\mu_{i j}=\frac{1}{m_{i j}} \int_{l_{i j}} \mu d \gamma, \quad b_{i j}=\frac{1}{m_{i j}} \int_{l_{i j}} \mathbf{b} \cdot \mathbf{n}_{i j} d \gamma
$$

就正常的导数而言，一种选择是使用增量比率来接近它们，类型为

!!!!
\frac{\partial u}{\partial \mathbf{n}_{i j}} \simeq \frac{u\left(\mathbf{x}_{j}\right)-u\left(\mathbf{x}_{i}\right)}{\left|\mathbf{x}_{j}-\mathbf{x}_{i}\right|}
$$

(例如，见图9.9）。)如果$u$在连接$\mathbf{x}_{i}$和$\mathbf{x}_{j}$的段上是线性的，那么这个公式是精确的。最后，关于$u$在$l_{i j}$上的积分的近似，我们用一个线性凸组合得到的常数来代替$\left.u\right|_{l_{i j}}$，即

!!!!
\left.u\right|_{l_{i j}} \simeq \rho_{i j} u\left(\mathbf{x}_{i}\right)+\left(1-\rho_{i j}\right) u\left(\mathbf{x}_{j}\right)
$$

与$\rho_{i j} \in[0,1]$一个有待定义的参数。使用前面的近似值，用$u_{i}$表示未知值$u\left(\mathbf{x}_{i}\right)$的近似值，我们可以从\ref{9.8} 中得出以下近似方程

!!!!
\begin{aligned}
m_{i} \frac{d u_{i}}{d t} &+\sum_{j=1}^{L_{i}} m_{i j}\left\{-\mu_{i j} \frac{u_{j}-u_{i}}{\delta_{i j}}+b_{i j}\left[\rho_{i j} u_{i}+\left(1-\rho_{i j}\right) u_{j}\right]\right\} \\
&+m_{i} \sigma_{i} u_{i}=m_{i} f_{i}, \quad i \in \mathscr{P}
\end{aligned}
\label{9.10}\end{equation}

用$m_{i}$表示$\Omega_{i}$的度量，用$\sigma_{i}$和$f_{i}$表示$\sigma$和$f$在$\mathbf{x}_{i}$的值，用$\delta_{i j}$表示$\mathbf{x}_{i}$与$\mathbf{x}_{j}$之间的距离。请注意，\ref{9.10}可以写成以下形式

!!!!
m_{i} \frac{d u_{i}}{d t}+\sum_{j=1}^{L_{i}} m_{i j} H_{i j}\left(u_{i}, u_{j}\right)+m_{i} \sigma_{i} u_{i}=m_{i} f_{i}
\label{9.11}\end{equation}

其中$H_{i j}$是所谓的数值通量，代表通过边$l_{i j}$的通量的近似贡献。数值通量的概念在双曲方程的有限差分方案中也是相关的，我们将在第14章\ref{14.3节）和第16章\ref{16.3节）中看到。数值通量的一些特征也转化为方案属性。例如，要有一个保守的方案，就必须有$H_{i j}\left(u_{i}, u_{j}\right)=-H_{j i}\left(u_{j}, u_{i}\right)$ 。

\subsection{Analysis of the finite volume approximation}

方程组\ref{9.10}可以通过以下方式以离散变量问题的形式重写。对于每个$i=1, \ldots, M$，第i个方程乘以一个实数$v_{i}$，然后通过对指数$i$求和，我们得到

!!!!
\begin{aligned}
\sum_{i=1}^{M} m_{i} v_{i} \frac{d u_{i}}{d t} &+\sum_{i=1}^{M} v_{i} \sum_{j=1}^{L_{i}} m_{i j}\left\{-\mu_{i j} \frac{u_{j}-u_{i}}{\delta_{i j}}+b_{i j}\left[\rho_{i j} u_{i}+\left(1-\rho_{i j}\right) u_{j}\right]\right\} \\
&+\sum_{i=1}^{M} m_{i} \sigma_{i} v_{i} u_{i}=\sum_{i=1}^{M} m_{i} v_{i} f_{i}
\end{aligned}
\label{9.12}\end{equation}

现在让我们用$V_{h}$来表示相对于德劳内三角剖分$\mathscr{T}_{h}$的片断-线性连续函数空间，这些函数在边界$\partial \Omega$处消失（见\ref{4.17} ）。从一组值$v_{i}$中，我们可以统一地重建一个函数$v_{h} \in V_{h}$，该函数在节点$\mathbf{x}_{i}$处插值，即（见\ref{4.7}。

!!!!
v_{h} \in V_{h}: v_{h}\left(\mathbf{x}_{i}\right)=v_{i}, \quad i=1, \ldots, \dot{M}
$$

以类似的方式，让$u_{h} \in V_{h}$是插值$u_{i}$于$\mathbf{x}_{i}$的函数。然后，\ref{9.12}被等效地改写为以下的离散变量形式：对于每个$t>0$，找到$u_{h}=u_{h}(t) \in V_{h}$，以便

!!!!
\left(\frac{\partial}{\partial t} u_{h}, v_{h}\right)_{h}+a_{h}\left(u_{h}, v_{h}\right)=\left(f, v_{h}\right)_{h} \quad \forall v_{h} \in V_{h}
\label{9.13}\end{equation}

引入了内部标量积$\left(w_{h}, v_{h}\right)_{h}=\sum_{i=1}^{M} m_{i} v_{i} w_{i}$，并用$a_{h}\left(u_{h}, v_{h}\right)$表示出现在\ref{9.12}左手边的双线性形式。因此，我们将有限体积近似解释为分配问题的广义Galerkin方法的一个特殊情况（见第10.4.1节，特别是\ref{10.47} ）。就线性组合的系数$\rho_{i j}$的选择而言，一种选择是使用$\rho_{i j}=1 / 2$，这相当于为对流项使用中心型的有限差分。正如我们将在第14章中看到的，当所谓的局部佩克莱特数时，这种策略是足够的

!!!!
\mathbb{P e}_{i j}=\frac{b_{i j} \delta_{i j}}{\mu_{i j}}
$$

(见\ref{13.22} ）对每一对$i, j$都小于1。如果不是这样，就需要更谨慎地选择凸组合的系数$\rho_{i j}$。一般来说，$\rho_{i j}=$ $\varphi\left(\mathbb{P e}_{i j}\right)$ ，其中$\varphi$是局部佩克莱特数的函数，其值在$[0,1]$中，可按以下方式选择：如果$\varphi(z)=1 / 2[\operatorname{sign}(z)+1]$给出一个上风类型的稳定化，而选择$\varphi(z)=1-\left(1-z /\left(e^{z}-1\right)\right) / z$我们将得到一个指数拟合类型的稳定化。(类似的稳定化将在第1节中使用。  $13.6$将在扩散-传输方程的有限差分近似的背景下使用类似的稳定化）。)通过这种选择，我们可以证明双线性形式$a_{h}(\cdot, \cdot)$是$V_{h}$-椭圆形的，均匀地关于$h$，在通常的假设下，问题的系数满足正性条件$1 / 2 \operatorname{div}(\mathbf{b})+\sigma \geq \beta_{0}=$ const $\geq 0$ 。

准确地说，在这种情况下，进一步假设$\mu \geq \mu_{0}=$的内容是$>0$。

!!!!
a_{h}\left(v_{h}, v_{h}\right) \geq \mu_{0}\left|v_{h}\right|_{\mathrm{H}^{1}(\Omega)}^{2}+\beta_{0}\left(v_{h}, v_{h}\right)_{h}
$$

此外，由于$\left(v_{h}, v_{h}\right)_{h}$与$V_{h}$的函数的精确$\mathrm{L}^{2}$标量积$\left(v_{h}, v_{h}\right)$均匀等价，这确保了问题\ref{9.13} 的稳定性。最后，该方法对于$h$来说是线性收敛的。具体来说

!!!!
\left\|u-u_{h}\right\|_{\mathrm{H}^{1}(\Omega)} \leq C h\left(\|u\|_{\mathrm{H}^{2}(\Omega)}+|\nabla f|_{\mathrm{L}^{\infty}(\Omega)}\right)
$$

的假设下，右边的规范是有界的。关于证明，请参见例如 [KA00] 。我们建议对该方法的其他属性的分析也参考该方法，如单调性和守恒。

\subsection{Implementation of boundary conditions}

如前所述，所研究的微分问题必须由合适的边界条件来完成。对于一个以守恒形式书写的问题，自然的边界条件是施加通量，即

!!!!
\mathbf{F}(u) \cdot \mathbf{n}=h \quad \text { on } \Gamma_{N} \subset \partial \Omega
$$

为了在有限体积的框架内实现它们，只需作用于与边界两侧有关的数值通量，施加

!!!!
H_{i k}=H\left(u_{i}, u_{k}\right)=h\left(\mathbf{x}_{i k}\right) \quad \text { if } l_{i k} \subset \Gamma_{N}
$$

其中$\mathbf{x}_{i k}$是$l_{i k}$的一个合适点（通常是中点）。

另一方面，基本（Dirichlet）条件的形式为

!!!!
u=g \quad \text { on } \Gamma_{D} \subset \partial \Omega
$$

在以顶点为中心的方案中可以立即实现，因为只需为位于$\Gamma_{D}$上的节点添加相应的方程。如前所述，对于以单元为中心的方案来说，这个问题更为复杂，因为在这种情况下，边界上没有节点。一个选择是以弱的方式施加条件，与我们将在第15.3.1节中说明的方式类似，尽管是在不同的背景下。这是一个适当修改边上的数值通量的问题，施加

!!!!
H_{i k}=H\left(u_{i}, g\left(\mathbf{x}_{i k}\right)\right) \quad \text { if } l_{i k} \subset \Gamma_{D}
$$



![](https://cdn.mathpix.com/cropped/10058ab4e7f0c5bd6fe5bcd4db204623-223.jpg?height=180&width=221&top_left_y=115&top_left_x=346)

图9.10.为了实现边界条件，计算了属于Dirichlet边界的$l_{i k}$边上的数值通量

图$9.10$说明了邻近边界的以细胞为中心的控制体的情况。

然而，在实践中，以单元为中心的有限体积的Dirichlet边界条件通常是用所谓的幽灵节点来实现的。对于边界上的每一条边$l_{i k}$，我们产生额外的节点，在域的外部，相应的边界值被分配给它。通过这种方式，数值通量的计算在形式上对边界两侧也是一样的。

\section{Spectral methods}

正如我们在第四章中所看到的，当我们使用有限元方法对边界值问题进行近似时，收敛顺序无论如何都会受到所使用的多项式程度的限制，在解非常规则的情况下也是如此。在这一章中，我们将介绍谱系方法，对于这些方法，收敛率只受问题解的规则性的限制（对于分析解是指数级的）。对于详细的分析，我们参考[CHQZ06, CHQZ07, Fun92, BM92]。

\subsection{The spectral Galerkin method for elliptic problems}

区别于经典的 "单域 "版本的有限元方法的主要特征是，后者在计算域上使用全局多项式$\Omega$，而不是分片多项式。在谱元方法中，这一点不再是真的。

对于每个正整数$N$，我们用$\mathbb{Q}_{N}$表示实系数的多项式空间，其度数小于或等于$N$，关于每个变量。因此，在一维中，我们将用以下方式表示

!!!!
\mathbb{Q}_{N}(I)=\left\{v(x)=\sum_{k=0}^{N} a_{k} x^{k}, \quad a_{k} \in \mathbb{R}\right\}
\label{10.1}\end{equation}

度数为$\leq N$的多项式在区间$I \subset \mathbb{R}$上的空间，而在二维上。

!!!!
\mathbb{Q}_{N}(\Omega)=\left\{v(\mathbf{x})=\sum_{k, m=0}^{N} a_{k m} x_{1}^{k} x_{2}^{m}, \quad a_{k m} \in \mathbb{R}\right\}
\label{10.2}\end{equation}

将表示同一空间，但在开放集$\Omega \subset \mathbb{R}^{2}$上。我们注意到，虽然在一维$\mathbb{Q}_{N}=\mathbb{P}_{N}$中，在多个维度上，这并不发生。特别是，$\operatorname{dim} \mathbb{Q}_{N}=$ $(N+1)^{2}$ ，而正如在第4.4.1节中已经看到的那样，$\operatorname{dim} \mathbb{Q}_{N}=!!!!(N+1)^{2}$是一个开放空间。4.4.1, $\operatorname{dim} \mathbb{P}_{N}=(N+1)(N+2) / 2$ .

假设我们想对一个椭圆问题的解$u$进行近似计算，该问题采用了变分公式\ref{4.1} 。


![](https://cdn.mathpix.com/cropped/10058ab4e7f0c5bd6fe5bcd4db204623-225.jpg?height=144&width=326&top_left_y=112&top_left_x=293)

图10.1.谱系法可接受的（左）和不可接受的（右）迪里希勒边界 SM

使用光谱Galerkin方法$(\mathrm{SM})$，空间$V$将被空间$V_{N} \subset \mathbb{Q}_{N}$所近似，近似解将因此由$u_{N}$表示。特别是，如果我们假设$V$是$\mathrm{H}_{\Gamma_{D}}^{1}(\Omega)$（在$(3.27)), V_{N}$中定义的空间将表示$\mathbb{Q}_{N}$的多项式集合，这些多项式在规定有迪里切条件的$\Gamma_{D}$边界部分消失，即

!!!!
V_{N}=\left\{v_{N} \in \mathbb{Q}_{N}:\left.\quad v_{N}\right|_{\Gamma_{D}}=0\right\}
$$

很明显，$V_{N} \subset V$ .因此，光谱Galerkin方法SM将在子空间$V_{N}$上制定。然而，在$V_{N}$的定义中存在一个问题：在多维情况下，确实不可能（在一般情况下）要求多项式$v_{N}$只在$\Omega$的边界的任意部分消失。例如，如果$\Omega$是正方形$(-1,1)^{2}$，就不可能构造一个只在边界边的一部分上消失而在整个边上都消失的多项式（见图10.1）。这并不妨碍一个多项式在正方形的整条边或所有边上消失而不一定在$\Omega$的整体上为空（例如，$v_{2}(\mathbf{x})=\left(1-x_{1}^{2}\right)\left(1-x_{2}^{2}\right)$只在$\Omega$的边界为空）。

由于这个原因，在二维情况下，我们把注意力限制在正方形域（或者，更一般地说，通过适当的变换，可还原为参考正方形$\widehat{\Omega}=(-1,1)^{2}\right)$的域，我们假设边界的部分$\Gamma_{D}$是由该域的一个或多个边的结合形成。

然而，频谱方法可以扩展到由四边形$\Omega_{k}$组成的域$\Omega$的情况，每个四边形都可以通过可逆变换$\varphi_{k}: \widehat{\Omega} \rightarrow \Omega_{k}$还原为参考正方形$\widehat{\Omega}$（见图10.2），导致所谓的频谱元素方法$(S E M)$，这是由A.T. Patera [Pat84]提出。很明显，在这种情况下，可以要求解在四边形边的结合部所给定的边界部分上消失，但自然不会在边的部分上消失（见图10.2）。在SEM情况下，离散空间有如下形式

!!!!
V_{N}^{C}=\left\{v_{N} \in C^{0}(\bar{\Omega}):\left.v_{N}\right|_{\Omega_{k}} \circ \varphi_{k} \in \mathbb{Q}_{N}(\widehat{\Omega})\right\}
$$

例10.1. 一个特别重要的二维映射是转折性插值（称为戈登-霍尔变换以及库恩斯补丁）。在这种情况下，映射$\varphi_{k}$被表示为可逆映射$\boldsymbol{\pi}_{k}^{(i)}:(-1,1) \rightarrow!!!!\Gamma_{i}$的函数（对于定义计算域$\left.i=1, \ldots, 4\right)$的四边的$\Omega_{k}$而言（见

![](https://cdn.mathpix.com/cropped/10058ab4e7f0c5bd6fe5bcd4db204623-226.jpg?height=242&width=367&top_left_y=115&top_left_x=273)

图10.2. SEM的解域和可接受的边界条件的分解

图10.3 该转换的形式如下

!!!!
\begin{aligned}
\varphi_{k}(\xi, \eta)=& \frac{1-\eta}{2} \pi_{k}^{1}(\xi)+\frac{1+\eta}{2} \pi_{k}^{3}(\xi) \\
&+\frac{1-\xi}{2}\left[\boldsymbol{\pi}_{k}^{4}(\eta)-\frac{1+\eta}{2} \pi_{k}^{4}(1)-\frac{1-\eta}{2} \pi_{k}^{4}(-1)\right] \\
&+\frac{1+\xi}{2}\left[\boldsymbol{\pi}_{k}^{2}(\eta)-\frac{1+\eta}{2} \pi_{k}^{2}(1)-\frac{1-\eta}{2} \pi_{k}^{2}(-1)\right]
\end{aligned}
\label{10.3}\end{equation}

因此，变换式插值允许考虑以非直边的域为特征的计算域 $\Omega$ 。关于更多的变换例子，见 [CHQZ07] 。

使用Galerkin频谱法（SM）对问题\ref{4.1} 进行近似，其结果如下

!!!!
\text { find } u_{N} \in V_{N}: \quad a\left(u_{N}, v_{N}\right)=F\left(v_{N}\right) \quad \forall v_{N} \in V_{N},
\label{10.4}\end{equation}

而光谱元素一（SEM）将是

!!!!
\text { find } u_{N} \in V_{N}^{C}: \quad a_{C}\left(u_{N}, v_{N}\right)=F_{C}\left(v_{N}\right) \quad \forall v_{N} \in V_{N}^{C},
$$

![](https://cdn.mathpix.com/cropped/10058ab4e7f0c5bd6fe5bcd4db204623-226.jpg?height=202&width=429&top_left_y=998&top_left_x=247)

图10.3.变换$\varphi_{k}$的情况下，变换无限插值，其中

!!!!
a_{C}\left(u_{N}, v_{N}\right)=\sum_{k} a_{\Omega_{k}}\left(u_{N}, v_{N}\right), \quad F_{C}\left(v_{N}\right)=\sum_{k} F_{\Omega_{k}}\left(v_{N}\right)
$$

$a_{\Omega_{k}}(\cdot, \cdot)$和$F_{\Omega_{k}}(\cdot)$是$a(\cdot, \cdot)$和$F(\cdot)$对$\Omega_{k}$ 的限制。

由于这些方法代表了Galerkin方法的一个特殊实例\ref{4.2}，因此在第1节中的分析仍然成立，特别是存在性、稳定性和收敛性结果。  $4.2$中的分析仍然有效，特别是可以应用存在性、唯一性、稳定性和收敛性结果。

此外，可以证明，对于SM和SEM谱系方法，以下先验误差估计是成立的。

与有限元方法的情况相反，即使假设多项式的度数$N$是固定的，解的更大规律性也会导致收敛率的增加。特别是，如果$u$是分析性的，频谱法的收敛顺序就会变得超过代数，即指数式：更确切地说。

!!!!
\exists \gamma>0: \quad\left\|u-u_{N}\right\|_{\mathrm{H}^{1}(\Omega)} \leq C \exp (-\gamma N)
$$

另外，在$u$具有有限正则性的情况下，仍有可能从谱法中获得精确解的正则性所允许的最大收敛率：这是谱法相对于有限元的一个明显优势。

经典谱系方法的主要局限性（在二维或三维）是它们只能处理简单的几何图形：矩形或四边形，它们可以通过可逆变换映射到一个正方形。然而，如前所述，它们可以通过SEM扩展到域是由四边形的联合体给出的情况，可能还有弯曲的边。

经典频谱方法的另一个缺点是，相关的刚度矩阵$\mathrm{A}$在一维情况下是完整的，或者无论如何比高维的有限元的刚度矩阵稀疏得多，因为这种方法的基函数有全局（而不是局部）支持，见第1节。  $10.2$ 和 $10.3$ 。相关方程组的求解成本通常更高。

最后，不能低估计算右手边刚度矩阵元素所需的计算成本，因为我们正在处理高次多项式。我们将在下一节通过使用精心选择的高斯数值积分来解决这个问题。

备注10.1.在本章末尾的第  $10.5$在本章的最后，我们将提供一维问题的SEM的代数式。特别是，我们将介绍复合多项式空间$V_{N}^{C}$的基函数。

备注10.2.SEM公式与$p$版本的有限元方法没有太大区别。在这两种情况下，子域$\Omega_{k}$的数量是固定的，而多项式的局部度数（在有限元的情况下称为$N$）是局部增加的，以便提高数值逼近的精度。关于进一步的细节，我们请感兴趣的读者参考[CHQZ07, Sch98]。

\subsection{Orthogonal polynomials and Gaussian numerical integration}

在本节中，我们介绍了允许构建高斯型数值积分公式的数学成分。如前所述，这种公式是伪谱系方法的基础，也是利用数值积分公式的谱系元素方法的基础。

\subsubsection{Orthogonal Legendre polynomials}

让我们考虑一个函数$f:(-1,1) \rightarrow \mathbb{R}$ 。我们记得，空间$\mathrm{L}^{2}(-1,1)$的定义是（见第2.3.1节）。

!!!!
\mathrm{L}^{2}(-1,1)=\left\{f:(-1,1) \rightarrow \mathbb{R}:\|f\|_{\mathrm{L}^{2}(-1,1)}=\left(\int_{-1}^{1} f^{2}(x) d x\right)^{1 / 2}<\infty\right\}
$$

其标量乘积由以下公式给出

!!!!
(f, g)=\int_{-1}^{1} f(x) g(x) d x
$$

正交的Legendre多项式$L_{k} \in \mathbb{P}_{k}$，对于$k=0,1, \ldots$来说，构成了一个序列，对于这个序列来说，满足以下正交性属性

!!!!
\left(L_{k}, L_{m}\right)= \begin{cases}0 & \text { if } m \neq k \\ \left(k+\frac{1}{2}\right)^{-1} & \text { if } m=k\end{cases}
$$

它们是线性独立的，构成了$\mathrm{L}^{2}(-1,1)$的基础。因此，每个函数$f \in \mathrm{L}^{2}(-1,1)$都可以接受序列展开

!!!!
f(x)=\sum_{k=0}^{\infty} \widehat{f}_{k} L_{k}(x)
\label{10.5}\end{equation}

被称为Legendre系列。这是对$f$的一种模态表示。通过利用Legendre多项式的正交性，可以很容易地计算出Legendre系数$\widehat{f}_{k}$。事实上，我们有

!!!!
\begin{aligned}
\left(f, L_{k}\right)=\int_{-1}^{1} f(x) L_{k}(x) d x=\int_{-1}^{1}\left(\sum_{i=0}^{\infty} \widehat{f}_{i} L_{i}(x) L_{k}(x)\right) d x \\
&=\sum_{i=0}^{\infty}\left(\int_{-1}^{1} L_{i}(x) L_{k}(x) d x\right) \widehat{f}_{i}=\widehat{f}_{k}\left\|L_{k}\right\|_{\mathrm{L}^{2}(-1,1)}^{2}
\end{aligned}
$$

因此

!!!!
\widehat{f_{k}}=\left(f, L_{k}\right) /\left\|L_{k}\right\|_{\mathrm{L}^{2}(-1,1)}^{2}=\left(k+\frac{1}{2}\right) \int_{-1}^{1} f(x) L_{k}(x) d x
\label{10.6}\end{equation}

从这一点上，所谓的帕尔塞瓦特性立即降生了

!!!!
\|f\|_{\mathrm{L}^{2}(-1,1)}^{2}=\sum_{k=0}^{\infty}\left(\widehat{f}_{k}\right)^{2}\left\|L_{k}\right\|_{\mathrm{L}^{2}(-1,1)}^{2}
$$

有可能通过以下三期关系递归地计算Legendre多项式。

!!!!
\begin{aligned}
&L_{0}=1, \quad L_{1}=x \\
&L_{k+1}=\frac{2 k+1}{k+1} x L_{k}-\frac{k}{k+1} L_{k-1}, \quad k=1,2, \ldots
\end{aligned}
$$

(在图10.4中，画出了多项式$L_{k}$与$k=2, \ldots, 5$的图形）。)任何$f \in \mathrm{L}^{2}(-1,1)$的Legendre级数在$\mathrm{L}^{2}(-1,1)$准则下收敛到$f$。用以下方式表示

!!!!
f_{N}(x)=\sum_{k=0}^{N} \widehat{f}_{k} L_{k}(x)
$$

$N$的Legendre数列的第1次截断$f$ ，这意味着

!!!!
\lim _{N \rightarrow \infty}\left\|f-f_{N}\right\|_{\mathrm{L}^{2}(-1,1)}=0
\label{10.7}\end{equation}

就是说

!!!!
\lim _{N \rightarrow \infty}\left\|\sum_{k=N+1}^{\infty} \widehat{f}_{k} L_{k}\right\|_{\mathrm{L}^{2}(-1,1)}=0
$$

由于Parseval特性，我们可以得出

!!!!
\left\|f-f_{N}\right\|_{\mathrm{L}^{2}(-1,1)}^{2}=\sum_{k=N+1}^{\infty}\left(\widehat{f}_{k}\right)^{2}\left\|L_{k}\right\|_{\mathrm{L}^{2}(-1,1)}^{2}=\sum_{k=N+1}^{\infty} \frac{\left(\widehat{f}_{k}\right)^{2}}{k+\frac{1}{2}}
$$



![](https://cdn.mathpix.com/cropped/10058ab4e7f0c5bd6fe5bcd4db204623-230.jpg?height=344&width=475&top_left_y=126&top_left_x=222)

图10.4.度数为$k=2,3,4,5$的 Legendre多项式

因此，条件\ref{10.7}相当于

!!!!
\lim _{N \rightarrow \infty} \sum_{k=N+1}^{\infty} \frac{\left(\widehat{f}_{k}\right)^{2}}{k+\frac{1}{2}}=0
$$

此外，可以证明，如果$f \in \mathrm{H}^{s}(-1,1)$，对于某些$s \geq 1$，那么有可能找到一个合适的常数$C_{s}>0$，与$N$无关，这样就可以

!!!!
\left\|f-f_{N}\right\|_{\mathrm{L}^{2}(-1,1)} \leq C_{s}\left(\frac{1}{N}\right)^{s}\left\|f^{(s)}\right\|_{\mathrm{L}^{2}(-1,1)}
\label{10.8}\end{equation}

也就是说，我们有$s$的收敛性，相对于$1 / N$而言。

在这一点上，我们可以证明$f_{N}$是$f$对$\mathbb{Q}_{N}$的正交投影，相对于$\mathrm{L}^{2}(-1,1)$的标量积，即

!!!!
\left(f-f_{N}, p\right)=0 \quad \forall p \in \mathbb{Q}_{N}
\label{10.9}\end{equation}

首先我们注意到，

!!!!
\left(f-f_{N}, L_{m}\right)=\left(\sum_{k=N+1}^{\infty} \widehat{f}_{k} L_{k}, L_{m}\right)=\sum_{k=N+1}^{\infty} \widehat{f}_{k}\left(L_{k}, L_{m}\right)
$$

由于多项式$L_{k}$与$0 \leq k \leq N$构成了空间$\mathbb{Q}_{N}$的基，每个多项式$p \in \mathbb{Q}_{N}$都可以相对于这个基展开。由于正交性，方程\ref{10.8}不注意$m \leq N,\left(L_{k}, L_{m}\right)=0 \quad \forall k \geq N+1$。

特别是，从\ref{10.8}可以看出，$f_{N}$是使$f$与$\mathbb{Q}_{N}$的距离最小的函数，也就是

!!!!
\left\|f-f_{N}\right\|_{\mathrm{L}^{2}(-1,1)} \leq\|f-p\|_{\mathrm{L}^{2}(-1,1)} \quad \forall p \in \mathbb{Q}_{N}
$$

为此，我们首先要观察到的是

!!!!
\left\|f-f_{N}\right\|_{\mathrm{L}^{2}(-1,1)}^{2}=\left(f-f_{N}, f-f_{N}\right)=\left(f-f_{N}, f-p\right)+\left(f-f_{N}, p-f_{N}\right)
$$

对于每个$p \in \mathbb{Q}_{N}$和$\left(f-f_{N}, p-f_{N}\right)=0$的正交属性\ref{10.8}。因此。

!!!!
\left\|f-f_{N}\right\|_{\mathrm{L}^{2}(-1,1)}^{2}=\left(f-f_{N}, f-p\right) \quad \forall p \in \mathbb{Q}_{N}
$$

由此，应用考奇-施瓦茨不等式，我们可以得到

!!!!
\left\|f-f_{N}\right\|_{\mathrm{L}^{2}(-1,1)}^{2} \leq\left\|f-f_{N}\right\|_{\mathrm{L}^{2}(-1,1)}\|f-p\|_{\mathrm{L}^{2}(-1,1)} \quad \forall p \in \mathbb{Q}_{N}
$$

即\ref{10.9} 。

\subsubsection{Gaussian integration}

高斯积分公式是那些在固定正交节点数的情况下允许获得最高精确度的公式（见[QSS07] ）。后者是最高的整数$r$，使所有度数小于或等于$r$的多项式都能通过手头的公式精确积分。我们将首先介绍区间$(-1,1)$上的此类公式，然后将其扩展到一般区间的情况。

我们用$N$表示节点的数量。我们把Gauss-Legendre正交节点称为Legendre多项式$\left\{\bar{x}_{1}, \ldots, \bar{x}_{N}\right\}$的零点。在有这样一组节点的情况下，我们将考虑以下正交公式（称为Gauss-Legendre的内插）。

!!!!
I_{N-1}^{G L} f=\int_{-1}^{1} \Pi_{N-1}^{G L} f(x) d x
\label{10.10}\end{equation}

$\Pi_{N-1}^{G L} f$是在节点$\bar{x}_{1}, \ldots, \bar{x}_{N}$插值$f$的度数的多项式 我们用$\bar{\psi}_{k} \in \mathbb{Q}_{N-1}, k=1, \ldots, N$表示，与Gauss-Legendre节点相关的特征拉格朗日多项式。

!!!!
\bar{\psi}_{k}\left(\bar{x}_{j}\right)=\delta_{k j}, \quad j=1, \ldots, N
$$

然后正交公式\ref{10.10} 有以下表达方式

!!!!
\int_{-1}^{1} f(x) d x \simeq I_{N-1}^{G L} f=\sum_{k=1}^{N} \bar{\alpha}_{k} f\left(\bar{x}_{k}\right), \quad \text { with } \bar{\alpha}_{k}=\int_{-1}^{1} \bar{\psi}_{k}(x) d x
$$

并被称为高斯-雷根德正交公式（GL）。

为了找到节点$\bar{t}_{k}$和权重$\bar{\delta}_{k}$，描述通用区间$[a, b]$上的这种公式的特点，只需参考以下关系即可

!!!!
\bar{t}_{k}=\frac{b-a}{2} \bar{x}_{k}+\frac{a+b}{2}
$$

而对于后者，可以很容易地验证，即

!!!!
\bar{\delta}_{k}=\frac{b-a}{2} \bar{\alpha}_{k}
$$

这些公式的精确性程度等于$2 N-1$（并且是具有$N-1$节点的公式的最大可能）。这意味着

!!!!
\int_{a}^{b} f(x) d x=\sum_{k=1}^{N} \bar{\delta}_{k} f\left(\bar{t}_{k}\right) \quad \forall f \in \mathbb{Q}_{2 N-1}
$$

\subsubsection{Gauss-Legendre-Lobatto formulae}

Gauss-Legendre积分公式的一个特点是所有正交节点都在积分区间内部。在微分问题的情况下，这使得在区间的端点上施加边界条件成为问题。

为了克服这种困难，引入了所谓的Gauss-Lobatto公式，特别是Gauss-Legendre-Lobatto（GLL）公式。在这里，相对于区间$(-1,1)$的节点由区间的端点本身和度数为$N$的Legendre多项式的最大和最小点表示，即由多项式$L_{N}$的一阶导数的零点表示。

我们用$\left\{x_{0}=-1, x_{1}, \ldots, x_{N-1}, x_{N}=1\right\}$表示这种节点。因此，我们有

!!!!
L_{N}^{\prime}\left(x_{i}\right)=0, \quad \text { for } i=1, \ldots, N-1
\label{10.11}\end{equation}

(在本章中，符号"'"表示相对于$x$的导数) 。让$\psi_{i}$成为相应的特征多项式，即

!!!!
\psi_{i} \in \mathbb{Q}_{N}: \quad \psi_{i}\left(x_{j}\right)=\delta_{i j}, \quad 0 \leq i, j \leq N
\label{10.12}\end{equation}

其分析表达式为

!!!!
\psi_{i}(x)=\frac{-1}{N(N+1)} \frac{\left(1-x^{2}\right) L_{N}^{\prime}(x)}{\left(x-x_{i}\right) L_{N}\left(x_{i}\right)}, \quad i=0, \ldots, N
\label{10.13}\end{equation}

(见图$10.5$中特征多项式$\psi_{i}$的图形，$i=0, \ldots, 4$中$N=4$的情况）。)这些函数$\psi_{i}(x)$是与第4.3节中介绍的有限元的拉格朗日基础函数$\left\{\varphi_{i}\right\}$相对应的。4.3.给定一个函数$f \in$ $C^{0}([-1,1])$，它在GLL节点的插值多项式$\Pi_{N}^{G L L} f \in \mathbb{Q}_{N}$由以下关系确定

!!!!
\Pi_{N}^{G L L} f\left(x_{i}\right)=f\left(x_{i}\right), \quad 0 \leq i \leq N
\label{10.14}\end{equation}

它的表达方式如下

!!!!
\Pi_{N}^{G L L} f(x)=\sum_{i=0}^{N} f\left(x_{i}\right) \psi_{i}(x)
\label{10.15}\end{equation}



![](https://cdn.mathpix.com/cropped/10058ab4e7f0c5bd6fe5bcd4db204623-233.jpg?height=317&width=436&top_left_y=126&top_left_x=240)

图10.5.与Gauss-Legendre-Lobatto结点相对应的4度特征多项式$\psi_{i}, i=0, \ldots, 4$。

可以证明，由于节点$\left\{x_{i}\right\}$的非均匀分布，当$N \rightarrow \infty$时，$\Pi_{N}^{G L L} f$会向$f$收敛。此外，以下误差估计得到满足：如果$f \in \mathrm{H}^{s}(-1,1)$ ，对于某些$s \geq 1$ 。

!!!!
\left\|f-\Pi_{N}^{G L L} f\right\|_{\mathrm{L}^{2}(-1,1)} \leq C_{s}\left(\frac{1}{N}\right)^{s}\left\|f^{(s)}\right\|_{\mathrm{L}^{2}(-1,1)}
\label{10.16}\end{equation}

其中$C_{s}$是一个取决于$s$但不取决于$N$的常数。更一般地说（见[CHQZ06] ）。

!!!!
\left\|f-\Pi_{N}^{G L L} f\right\|_{\mathrm{H}^{k}(-1,1)} \leq C_{s}\left(\frac{1}{N}\right)^{s-k}\|f\|_{\mathrm{H}^{s}(-1,1)}, \quad s \geq 1, k=0,1
\label{10.17}\end{equation}

在图$10.6$（左）中，我们显示了两个不同函数的插值误差的收敛曲线。

通过使用$\Pi_{N}^{G L L} f$而不是$\Pi_{N-1}^{G L L} f$，我们可以定义以下高斯-雷根德-洛巴托（GLL）积分公式，以替代\ref{10.10}

!!!!
I_{N}^{G L L} f=\int_{-1}^{1} \Pi_{N}^{G L L} f(x) d x=\sum_{k=0}^{N} \alpha_{k} f\left(x_{x}\right)
\label{10.18}\end{equation}

新的权重是$\alpha_{i}=\int_{-1}^{1} \psi_{i}(x) d x$，采取以下表达方式

!!!!
\alpha_{i}=\frac{2}{N(N+1)} \frac{1}{L_{N}^{2}\left(x_{i}\right)}
\label{10.19}\end{equation}

GLL公式的准确度等于$2 N-1$，也就是说它能准确地整合所有度数为$\leq 2 N-1$的多项式。

!!!!
\int_{-1}^{1} f(x) d x=I_{N}^{G L L} f \quad \forall f \in \mathbb{Q}_{2 N-1}
\label{10.20}\end{equation}


![](https://cdn.mathpix.com/cropped/10058ab4e7f0c5bd6fe5bcd4db204623-234.jpg?height=236&width=712&top_left_y=117&top_left_x=100)

图 10.6.两个函数$f_{1}(x)=\cos (4 \pi x)$（bullet）和$f_{2}(x)=!!!!4 \cos (4 x) \exp (\sin (4 x))(\mathbf{w})$在区间$(-1,1)$上的插值（左）和积分（右）误差的行为与度数$N$的函数关系

这是使用$N+1$节点时可获得的最大度数，其中2个节点是先验分配的。此外，使用插值估计\ref{10.16} ，可以证明以下积分误差估计：如果$f \in \mathrm{H}^{s}(-1,1)$ ，用$s \geq 1$ 。

!!!!
\left|\int_{-1}^{1} f(x) d x-I_{N}^{G L L} f\right| \leq C_{s}\left(\frac{1}{N}\right)^{s}\left\|f^{(s)}\right\|_{L^{2}(-1,1)}
$$

其中$C_{s}$与$N$无关，但一般来说可以取决于$s$ 。这意味着函数$f$越规则，积分公式的收敛顺序就越高。在图$10.6$（右）中，我们报告了两个不同函数（与左图中考虑的函数相同）的积分误差。

如果我们现在考虑一个通用区间$(a, b)$而不是$(-1,1)$，$(a, b)$中的节点和权重采取以下表达方式

!!!!
t_{k}=\frac{b-a}{2} x_{k}+\frac{a+b}{2}, \quad \delta_{k}=\frac{b-a}{2} \alpha_{k} .
$$

公式\ref{10.20} 概括如下

!!!!
\int_{a}^{b} f(x) d x \simeq \sum_{k=0}^{N} \delta_{k} f\left(t_{k}\right)
\label{10.21}\end{equation}

精确性和准确性的属性保持不变。

\subsection{ 一维的G-NI方法}。

让我们考虑以下具有同质Dirichlet数据的一维椭圆问题

!!!!
\begin{cases}L u=-\left(\mu u^{\prime}\right)^{\prime}+\sigma u=f, & -1<x<1 \\ u(-1)=0, & u(1)=0\end{cases}
\label{10.22}\end{equation}

$\mu(x) \geq \mu_{0}>0$ 和 $\sigma(x) \geq 0$ ，以便有一个相关的双线性形式，在 $\mathrm{H}_{0}^{1}(-1,1)$ 中是强制性的。

频谱Galerkin法（SM）被写为

!!!!
\text { find } u_{N} \in V_{N}: \int_{-1}^{1} \mu u_{N}^{\prime} v_{N}^{\prime} d x+\int_{-1}^{1} \sigma u_{N} v_{N} d x=\int_{-1}^{1} f v_{N} d x \quad \forall v_{N} \in V_{N}
\label{10.23}\end{equation}

与

!!!!
V_{N}=\left\{v_{N} \in \mathbb{Q}_{N}: v_{N}(-1)=v_{N}(1)=0\right\}
\label{10.24}\end{equation}

G-NI（Galerkin with Numerical Integration）方法是通过GLL积分公式对\ref{10.23} 中的积分进行逼近而得到的。这相当于用离散的GLL标量积（对于连续函数）代替$(f, g)$中的标量积$\mathrm{L}^{2}(-1,1)$。

!!!!
(f, g)_{N}=\sum_{i=0}^{N} \alpha_{i} f\left(x_{i}\right) g\left(x_{i}\right)
\label{10.25}\end{equation}

其中$x_{i}$和$\alpha_{i}$是根据\ref{10.11}和\ref{10.19}定义。因此，$\mathrm{G}$ -NI方法被写为

!!!!
\text { find } u_{N}^{*} \in V_{N}:\left(\mu u_{N}^{*}, v_{N}^{\prime}\right)_{N}+\left(\sigma u_{N}^{*}, v_{N}\right)_{N}=\left(f, v_{N}\right)_{N} \quad \forall v_{N} \in V_{N}
\label{10.26}\end{equation}

由于数值积分，一般来说$u_{N}^{*} \neq u_{N}$，即SM和G-NI方法的解并不重合。

然而，由于精确性属性\ref{10.20} ，我们将有

!!!!
(f, g)_{N}=(f, g) \quad \forall f, g: \quad f g \in \mathbb{Q}_{2 N-1} .
\label{10.27}\end{equation}

如果我们考虑在\ref{10.22} \mu$是一个常数和$\sigma=0$的特殊情况下，G-NI问题变成了

!!!!
\mu\left(u_{N}^{* \prime}, v_{N}^{\prime}\right)_{N}=\left(f, v_{N}\right)_{N}
\label{10.28}\end{equation}

在一些非常特殊的情况下，光谱法和G-NI法是重合的。例如，这就是\ref{10.28}的情况，其中$f$是一个最多等于$N-1$度的多项式。由于精确性关系\ref{10.27}，很容易验证这两种方法是重合的。

推广到具有不同边界条件（诺伊曼或混合）的更复杂的微分公式的情况，G-NI问题被写为

!!!!
\text { find } u_{N}^{*} \in V_{N}: \quad a_{N}\left(u_{N}^{*}, v_{N}\right)=F_{N}\left(v_{N}\right) \quad \forall v_{N} \in V_{N}
\label{10.29}\end{equation}

其中$a_{N}(\cdot, \cdot)$和$F_{N}(\cdot)$是从双线性形式$a(\cdot, \cdot)$和光谱Galerkin问题的已知项$F(\cdot)$开始，通过用GLL积分公式代替精确积分得到的。  $V_{N}$是度数为$N$的多项式空间，这些多项式在边界点（如果有的话）上消失，在这些边界点上施加了迪里切特条件。请注意，由于双线性形式$a_{N}(\cdot, \cdot)$和函数$F_{N}(\cdot)$不再是与初始问题相关的，我们得到的不再是Galerkin近似方法，相关的理论结果不能被应用（特别是Céa定理，见定理4.1）。

一般来说，从Galerkin方法衍生出来的方法，无论是光谱法还是有限元法，其中数值积分代替了精确积分，将被称为广义Galerkin方法 $(G G)$ 。对于相应的分析，我们将求助于Strang定理（见第10.4.1节，也见[Cia78, QV94]）。

\subsubsection{Algebraic interpretation of the G-NI method}

第10.2.3节中介绍的函数$\psi_{i}$和$i=1,2, \ldots, N-1$构成了空间$V_{N}$的基础，因为它们在$x_{0}=-1$和$x_{N}=1$中均为空。因此，我们可以为G-NI问题\ref{10.29}的解$u_{N}^{*}$提供结点表示法

!!!!
u_{N}^{*}(x)=\sum_{i=1}^{N-1} u_{N}^{*}\left(x_{i}\right) \psi_{i}(x)
$$

与有限元方法相类似，这意味着我们将问题的未知数与$u_{N}^{*}$在节点$x_{i}$（现在与Gauss-Legendre-Lobatto节点重合）处的取值相识别。此外，为了使问题\ref{10.29} 对每个$v_{N} \in V_{N}$都得到验证，只要对每个基函数$\psi_{i}$都得到验证即可。因此，我们将有

!!!!
\sum_{j=1}^{N-1} u_{N}^{*}\left(x_{j}\right) a_{N}\left(\psi_{j}, \psi_{i}\right)=F_{N}\left(\psi_{i}\right), \quad i=1,2, \ldots, N-1
$$

我们可以改写为

!!!!
\sum_{j=1}^{N-1} a_{i j} u_{N}^{*}\left(x_{j}\right)=f_{i}, \quad i=1,2, \ldots, N-1
$$

也就是说，以矩阵形式。

!!!!
\mathrm{Au}_{N}^{*}=\mathbf{f}
\label{10.30}\end{equation}

其中

!!!!
\mathrm{A}=\left(a_{i j}\right) \text { with } \quad a_{i j}=a_{N}\left(\psi_{j}, \psi_{i}\right), \quad \mathbf{f}=\left(f_{i}\right) \quad \text { with } \quad f_{i}=F_{N}\left(\psi_{i}\right),
$$

而其中$\mathbf{u}_{N}^{*}$表示未知系数的向量$u_{N}^{*}\left(x_{j}\right)$ ，为$j=1, \ldots, N-1$。在问题\ref{10.26} 的特殊情况下，我们将得到

!!!!
a_{i j}=\left(\mu \psi_{j}^{\prime}, \psi_{i}^{\prime}\right)_{N}+\alpha_{i} \sigma\left(x_{i}\right) \delta_{i j}, \quad f_{i}=\left(f, \psi_{i}\right)_{N}=\alpha_{i} f\left(x_{i}\right)
$$

对于每个 $i, j=1, \ldots, N-1$ 。由于扩散项的存在，$1 \mathrm{D}$中的矩阵是完整的。事实上，反应项只对对角线有贡献。在更多维度上，矩阵$A$有一个块状结构，对角线块是满的。见图10.7。
 ![](https://cdn.mathpix.com/cropped/10058ab4e7f0c5bd6fe5bcd4db204623-237.jpg?height=332&width=680&top_left_y=118&top_left_x=114)

图10.7.G-NI方法的矩阵$A$的模式，$2 D$（左）和$3 D$（右）情况。  $\mathrm{nz}$表示矩阵中非空元素的数量

在 $2 \mathrm{D}$ 和 $3 \mathrm{D}$ 中报告与矩阵 $A$ 有关的模式。最后，我们观察到，在没有数字积分结果的情况下，我们得到的条件数一般来说要大得多，即$O\left(N^{4}\right)$ 。此外，矩阵 $A$ 被证明是无条件的，条件数为 $O\left(N^{3}\right)$ 。因此，对于系统\ref{10.30}的求解，特别是在$2 \mathrm{D}$和$3 \mathrm{D}$中，采用适当的预处理迭代方法是很方便的。通过选择与同一双线性形式$a(\cdot, \cdot)$和GLL节点相关的线性有限元矩阵作为预处理，我们得到一个预处理矩阵，其条件与$N$（[CHQZ06]）无关。在图$10.8$的顶部，我们报告了矩阵$A$的条件数（作为$N$的函数）和用不同的预处理矩阵对$A$进行预处理得到的矩阵：$A$的对角线矩阵] 的对角线矩阵，通过不完全Cholesky分解从$A$得到的矩阵，使用线性有限元通过复合梯形公式近似积分得到的矩阵，最后是来自有限元的精确矩阵。

![](https://cdn.mathpix.com/cropped/10058ab4e7f0c5bd6fe5bcd4db204623-237.jpg?height=242&width=351&top_left_y=934&top_left_x=100)
 ![](https://cdn.mathpix.com/cropped/10058ab4e7f0c5bd6fe5bcd4db204623-237.jpg?height=242&width=712&top_left_y=934&top_left_x=100tioners At the bottom of Fig. $10.8$ we report the number of necessary iterations for the conjugate gradient method to converge in the different cases.

\subsubsection{Conditioning of the stiffness matrix in the G-NI method}

我们寻求G-NI方法的刚度矩阵$\lambda^{N}$的特征值$A$的估计。

!!!!
A \mathbf{u}=\lambda^{N} \mathbf{u}
$$

在简单的二阶导数算子的情况下，我们有$A=\left(a_{i j}\right)$ ，其中$a_{i j}=$ $\left(\psi_{j}^{\prime}, \psi_{i}^{\prime}\right)_{N}=\left(\psi_{j}^{\prime}, \psi_{i}^{\prime}\right), \psi_{j}$是与节点$j$相关的第1个特征拉格朗日函数。那么。

!!!!
\lambda^{N}=\frac{\mathbf{u}^{T} A \mathbf{u}}{\mathbf{u}^{T} \mathbf{u}}=\frac{\left\|u_{x}^{N}\right\|_{\mathrm{L}^{2}(-1,1)}^{2}}{\mathbf{u}^{T} \mathbf{u}}
\label{10.31}\end{equation}

$u^{N} \in V_{N}$是在\ref{10.24}中定义的空间$V_{N}$的唯一多项式，满足$u^{N}\left(x_{j}\right)=u_{j}$，为$j=1, \ldots, N-1$，其中$\mathbf{u}=\left(u_{j}\right)$ 。通过设置

!!!!
u_{j}=\int_{-1}^{x_{j}} u_{x}^{N}(s) d s
$$

由于考奇-施瓦茨不等式，我们得到的约束是

!!!!
\left|u_{j}\right| \leq\left(\int_{-1}^{x_{j}}\left|\left(u^{N}\right)^{\prime}(s)\right|^{2} d s\right)^{1 / 2}\left(\int_{-1}^{x_{j}} d s\right)^{1 / 2} \leq \sqrt{2}\left\|\left(u^{N}\right)^{\prime}\right\|_{\mathbf{L}^{2}(-1,1)}
$$

因此

!!!!
\mathbf{u}^{T} \mathbf{u}=\sum_{j=1}^{N-1} u_{j}^{2} \leq 2(N-1)\left\|\left(u^{N}\right)^{\prime}\right\|_{\mathrm{L}^{2}(-1,1)}^{2}
$$

感谢\ref{10.31}，它提供了下限

!!!!
\lambda^{N} \geq \frac{1}{2(N-1)}
\label{10.32}\end{equation}

$\lambda^{N}$的上界可以通过回顾以下关于代数的反不等式而得到（见[CHQZ06]，第5.4.1节）。

!!!!
\forall p \in V_{N}, \quad\left\|p^{\prime}\right\|_{\mathrm{L}^{2}(-1,1)} \leq \sqrt{2} N\left(\int_{-1}^{1} \frac{p^{2}(x)}{1-x^{2}} d x\right)^{1 / 2}
\label{10.33}\end{equation}

那么

!!!!
\left\|\left(u^{N}\right)^{\prime}\right\|_{\mathrm{L}^{2}(-1,1)}^{2} \leq 2 N^{2} \int_{-1}^{1} \frac{\left[u^{N}(x)\right]^{2}}{1-x^{2}} d x=2 N^{2} \sum_{j=1}^{N-1} \frac{\left[u^{N}\left(x_{j}\right)\right]^{2}}{1-x_{j}^{2}} \alpha_{j}
\label{10.34}\end{equation}

其中我们使用GLL积分公式的精确性（见\ref{10.20}) ，如$\left[u^{N}\right]^{2} /\left(1-x^{2}\right) \in \mathbb{P}_{2 N-2}$ 。由于对于系数$\alpha_{j}$，以下渐进估计成立。  $\alpha_{j} /\left(1-x_{j}^{2}\right) \leq C$ ，对于独立于$N$的合适常数$C$，我们可以得出结论，由于\ref{10.31}和\ref{10.34}，即

!!!!
\lambda^{N} \leq 2 C N^{2}
\label{10.35}\end{equation}

最后可以证明，就有关$N$的渐进行为而言，\ref{10.32}和\ref{10.35}两个估计都是最佳的。

\subsubsection{Equivalence between G-NI and collocation methods}

我们想证明G-NI方法可以被解释为一种拼合方法，即只在计算区间的选定点施加微分方程。让我们再次考虑同质Dirichlet问题 \ref{10.22} ，其相关的G-NI问题被写成这样的形式 \ref{10.26} 。

我们想通过部分方程\ref{10.26} 进行反积分，但为了做到这一点，我们必须首先将离散标量积改写为积分。让$\Pi_{N}^{G L L}: C^{0}([-1,1]) \mapsto!!!!\mathbb{Q}_{N}$为第10.2.3节中介绍的插值算子，它将一个连续函数映射到Gauss-LegendreLobatto节点处的相应插值多项式。

由于GLL积分公式只在积分节点使用函数的值，而且函数和它的G-NI插值在那里重合，我们有

!!!!
\sum_{i=0}^{N} \alpha_{i} f\left(x_{i}\right)=\sum_{i=0}^{N} \alpha_{i} \Pi_{N}^{G L L} f\left(x_{i}\right)=\int_{-1}^{1} \Pi_{N}^{G L L} f(x) d x
$$

其中后一个等式从\ref{10.20} 下降，因为$\Pi_{N}^{G L L} f$正好被整合，是一个度数为$N$的多项式。

因此，在两个函数之一是严格小于$\mathrm{L}^{2}(-1,1)$度的多项式的情况下，离散标量积成为$\mathrm{L}^{2}(-1,1)$的标量积，即

!!!!
(f, g)_{N}=\left(\Pi_{N}^{G L L} f, g\right)_{N}=\left(\Pi_{N}^{G L L} f, g\right) \quad \forall g \in \mathbb{Q}_{N-1}
\label{10.36}\end{equation}

在这种情况下，的确，$\Pi_{N}^{G L L} f \in \mathbb{Q}_{N},\left(\Pi_{N}^{G L L} f\right) g \in \mathbb{Q}_{2 N-1}$，因此积分是精确计算的。对准确的积分进行分次积分，我们得到$^{1}

!!!!
\begin{aligned}
\left(\mu u_{N}^{\prime}, v_{N}^{\prime}\right)_{N} &=\left(\Pi_{N}^{G L L}\left(\mu u_{N}^{\prime}\right), v_{N}^{\prime}\right)_{N}=\left(\Pi_{N}^{G L L}\left(\mu u_{N}^{\prime}\right), v_{N}^{\prime}\right) \\
&=-\left(\left[\Pi_{N}^{G L L}\left(\mu u_{N}^{\prime}\right)\right]^{\prime}, v_{N}\right)_{+}\left[\Pi_{N}^{G L L}\left(\mu u_{N}^{\prime}\right) v_{N}\right]_{-1}^{1} \\
&=-\left(\left[\Pi_{N}^{G L L}\left(\mu u_{N}^{\prime}\right)\right]^{\prime}, v_{N}\right)_{N}
\end{aligned}
$$

其中最后一个等式成立，因为$v_{N}$在边界消失，出现在标量乘积中的项产生一个总度等于$2 N-1$的多项式。

${ }^{1}$ 从现在开始，为了简化符号，我们将用$u_{N}$来表示G-NI的解决方案（而不是

$\left.u_{N}^{*}\right)$ ，因为不再有将其与谱系解混淆的风险。在这一点上，我们可以将G-NI问题重写如下

!!!!
\text { find } u_{N} \in V_{N}:\left(L_{N} u_{N}, v_{N}\right)_{N}=\left(f, v_{N}\right)_{N} \quad \forall v_{N} \in V_{N},
\label{10.37}\end{equation}

其中我们定义了

!!!!
L_{N} u_{N}=-\left[\Pi_{N}^{G L L}\left(\mu u_{N}^{\prime}\right)\right]^{\prime}+\sigma u_{N}
\label{10.38}\end{equation}

通过规定\ref{10.37} 对每个基函数$\psi_{i}$有效，我们得到

!!!!
\left(L_{N} u_{N}, \psi_{i}\right)_{N}=\left(f, \psi_{i}\right)_{N}, \quad i=1,2, \ldots, N-1
$$

现在我们检查一下$i$-次方程。第一个项是

!!!!
\begin{aligned}
-\left(\left[\Pi_{N}^{G L L}\left(\mu u_{N}^{\prime}\right)\right]^{\prime}, \psi_{i}\right)_{N} &=-\sum_{j=0}^{N} \alpha_{j}\left[\Pi_{N}^{G L L}\left(\mu u_{N}^{\prime}\right)\right]^{\prime}\left(x_{j}\right) \psi_{i}\left(x_{j}\right) \\
&=-\alpha_{i}\left[\Pi_{N}^{G L L}\left(\mu u_{N}^{\prime}\right)\right]^{\prime}\left(x_{i}\right)
\end{aligned}
$$

因为 $\psi_{i}\left(x_{j}\right)=\delta_{i j}$ 。类似地，对于第二项，我们有

!!!!
\left(\sigma u_{N}, \psi_{i}\right)_{N}=\sum_{j=0}^{N} \alpha_{j} \sigma\left(x_{j}\right) u_{N}\left(x_{j}\right) \psi_{i}\left(x_{j}\right)=\alpha_{i} \sigma\left(x_{i}\right) u_{N}\left(x_{i}\right)
$$

最后，右手边变成

!!!!
\left(f, \psi_{i}\right)_{N}=\sum_{j=0}^{N} \alpha_{j} f\left(x_{j}\right) \psi_{i}\left(x_{j}\right)=\alpha_{i .} f\left(x_{i}\right)
$$

用$\alpha_{i}$除以这样找到的方程，我们得到以下G-NI问题的等价表述

!!!!
\begin{cases}L_{N} u_{N}\left(x_{i}\right)=f\left(x_{i}\right), & i=1,2, \ldots, N-1 \\ u_{N}\left(x_{0}\right)=0, & u_{N}\left(x_{N}\right)=0\end{cases}
\label{10.39}\end{equation}

这被称为拼合问题，因为它相当于在内部节点$x_{i}$放置指定的微分方程（用$\left.L_{N}\right)$近似算子$L$后，在边界节点满足边界条件。

我们现在介绍一个连续函数$\Phi$的内插导数$D_{N}(\Phi)$，它是根据\ref{10.14} 定义的内插多项式$\Pi_{N}^{G L L} \Phi$的导数，也就是说。

!!!!
D_{N}(\Phi)=D\left[\Pi_{N}^{G L L} \Phi\right]
\label{10.40}\end{equation}

$D$是精确微分的符号。如果我们考虑微分算子$L$并将所有导数替换为相应的插值导数，我们会得到一个新的算子，称为伪谱算子$L_{N}$，它与\ref{10.38} 中定义的算子相吻合。由此可见，这里介绍的G-NI方法是一种广义的Galerkin方法，也可以解释为一种直接对问题的微分部分进行操作的同位法，类似于有限差分的情况。在这个意义上，有限差分可以被认为是G-NI方法的一个不太精确的版本，因为导数是使用少量节点值的公式来逼近的。

如果最初的操作者是

!!!!
L u=\left(-\mu u^{\prime}\right)^{\prime}+(b u)^{\prime}+\sigma u
$$

那么相应的伪谱系算子将是

!!!!
L_{N} u_{N}=-D_{N}\left(\mu u_{N}^{\prime}\right)+D_{N}\left(b u_{N}\right)+\sigma u_{N}
\label{10.41}\end{equation}

如果问题\ref{10.22}的边界条件是诺伊曼类型的。

!!!!
\left(\mu u^{\prime}\right)(-1)=g_{-}, \quad\left(\mu u^{\prime}\right)(1)=g_{+},
$$

谱加勒金法的表述如下

!!!!
\begin{aligned}
&\text { find } u_{N} \in \mathbb{Q}_{N}: \int_{-1}^{1} \mu u_{N}^{\prime} v_{N}^{\prime} d x+\int_{-1}^{1} \sigma u_{N} v_{N} d x= \\
&\int_{-1}^{1} f v_{N} d x+g_{+} v_{N}(1)-g_{-} v_{N}(-1) \quad \forall v_{N} \in \mathbb{Q}_{N}
\end{aligned}
$$

而G-NI方法将成为

!!!!
\begin{aligned}
&\text { find } u_{N} \in \mathbb{Q}_{N} \quad:\left(\mu u_{N}^{\prime}, v_{N}^{\prime}\right)_{N}+\left(\sigma u_{N}, v_{N}\right)_{N}= \\
&\left(f, v_{N}\right)_{N}+g_{+} v_{N}(1)-g_{-} v_{N}(-1) \quad \forall v_{N} \in \mathbb{Q}_{N}
\end{aligned}
$$

它作为一种搭配方法的解释是：找到$u_{N} \in \mathbb{Q}_{N}$，以便

!!!!
\begin{aligned}
&L_{N} u_{N}\left(x_{i}\right)=f\left(x_{i}\right), \quad i=1, \ldots, N-1 \\
&\left(L_{N} u_{N}\left(x_{0}\right)-f\left(x_{0}\right)\right)-\frac{1}{\alpha_{0}}\left(\left(\mu u_{N}^{\prime}\right)(-1)-g_{-}\right)=0 \\
&\left(L_{N} u_{N}\left(x_{N}\right)-f\left(x_{N}\right)\right)+\frac{1}{\alpha_{N}}\left(\left(\mu u_{N}^{\prime}\right)(1)-g_{+}\right)=0
\end{aligned}
$$

其中$L_{N}$定义于\ref{10.38} 。请注意，在边界节点上，诺伊曼条件得到满足，直到方程残差$L_{N} u_{N}-f$乘以GLL公式的系数，这是一个关于$1 / N$的2阶无穷小。

在图$10.9$中（取自[CHQZ06]），我们报告了$\mathrm{H}^{1}(-1,1)$中的误差（左）和差值$\left(\mu u_{N}^{\prime}\right)(\pm 1)-g_{\pm}$的绝对值（右），这可以被视为在满足诺伊曼边界条件时的误差，对于不同的$N$值。当$N$增加时，这两个误差都呈指数级衰减。此外，我们报告
 ![](https://cdn.mathpix.com/cropped/10058ab4e7f0c5bd6fe5bcd4db204623-242.jpg?height=236&width=704&top_left_y=116&top_left_x=108)

图10.9.在$\mathrm{H}^{1}(-1,1)$中的误差（左）和改变$N$时对诺伊曼基准的误差（右）。

使用程度为$r=1,2,3$的Galerkin有限元近似得到的误差。

最后，观察插值导数\ref{10.40}可以通过矩阵$\mathrm{D} \in \mathbb{R}^{(N+1) \times(N+1)}$来表示，称为插值导数矩阵，与任何节点值$\mathbf{v} \in \mathbb{R}^{N+1}$的向量$v_{i}=\Phi\left(x_{i}\right), i=0, \ldots, N$相关联，向量$\mathbf{w}=\mathrm{D} \mathbf{v}$的成分是多项式$D_{N}(\Phi)$的节点值即$w_{i}=\left(D_{N}(\Phi)\right)\left(x_{i}\right), i=0, \ldots, N$。$\mathrm{D}$的元素是（见[CHQZ06] ）。

!!!!
D_{i j}=\psi_{j}^{\prime}\left(x_{i}\right)= \begin{cases}\frac{L_{N}\left(x_{i}\right)}{L_{N}\left(x_{j}\right)} \frac{1}{x_{i}-x_{j}}, & i, j=0, \ldots, N, i \neq j \\ -\frac{(N+1) N}{4}, & i=j=0, \\ \frac{(N+1) N}{4}, & i=j=N \\ 0 & \text { otherwise }\end{cases}
$$

其中$d_{0}=d_{N}=2$和$d_{j}=1$为$j=1, \ldots, N-1

\subsubsection{G-NI for parabolic equations}

当我们考虑时间依赖性问题时，光谱G-NI方法可用于空间近似。对于时间导数的离散化，我们可以应用有限差分方案。在这一节中，我们考虑一个具体的例子，即第5.1节中介绍的$\theta$方法。

应用于定义在空间区间$-1<x<1$上的同质迪里希特问题\ref{5.4} 的G-NI空间离散化的$\theta$方法，其表述如下。

对于每个$k \geq 0$，找到$u_{N}^{k} \in V_{N}=\left\{v_{N} \in \mathbb{Q}_{N}: v_{N}(-1)=v_{N}(1)=0\right\}$，以便

!!!!
\begin{aligned}
&\left(\frac{u_{N}^{k+1}-u_{N}^{k}}{\Delta t}, v_{N}\right)_{N}+a_{N}\left(\theta u_{N}^{k+1}+(1-\theta) u_{N}^{k}, v_{N}\right) \\
&=\theta\left(f^{k+1}, v_{N}\right)_{N}+(1-\theta)\left(f^{k}, v_{N}\right)_{N} \quad \forall v_{N} \in V_{N}
\end{aligned}
$$

其中$u_{N}^{0}=u_{0, N} \in V_{N}$是$u_{0}$的一个方便的近似值（例如，\ref{10.14} 中引入的内插子$\Pi_{N}^{G L L} u_{0}$）。通常，$(\cdot, \cdot)_{N}$表示使用Gauss-Legendre-Lobatto（GLL）数值积分公式得到的离散标量积，而$a_{N}(\cdot, \cdot)$是通过用上述数值积分公式代替精确积分得到的双线性形式$a(\cdot, \cdot)$的近似。通过像我们在第1节中所做的那样进行。  [在这种情况下，如果$\theta \geq \frac{1}{2}$，$\theta<\frac{1}{2}$方法是无条件稳定的，而对于$\theta<\frac{1}{2}$，绝对稳定性的充分条件是

!!!!
\Delta t \leq C(\theta) N^{-4}
\label{10.42}\end{equation}

事实上，证明可以通过重复我们先前在有限元近似情况下的相同步骤来检查。特别是，我们定义了双线性形式$a_{N}(\cdot, \cdot)$的特征值-特征函数对$\left(\lambda_{j}, w_{N}^{j}\right)$，对于每个$j=1, \ldots, N-1$，通过关系

!!!!
w_{N}^{j} \in V_{N}: a_{N}\left(w_{N}^{j}, v_{N}\right)=\lambda_{j}\left(w_{N}^{j}, v_{N}\right) \quad \forall v_{N} \in V_{N}
$$

因此

!!!!
\lambda_{j}=\frac{a_{N}\left(w_{N}^{j}, w_{N}^{j}\right)}{\left\|w_{N}^{j}\right\|_{N}^{2}}
$$

利用双线性形式的连续性$a_{N}(\cdot, \cdot)$，我们发现

!!!!
\lambda_{j} \leq \frac{M\left\|w_{N}^{j}\right\|_{\mathrm{H}^{1}(-1,1)}^{2}}{\left\|w_{N}^{j}\right\|_{N}^{2}}
$$

我们现在回忆一下以下代数多项式的反不等式 ( [CHQZ06] )

!!!!
\exists C_{I}>0:\left\|v_{N}^{\prime}\right\|_{\mathrm{L}^{2}(-1,1)}^{2} \leq C_{I}\left\|v_{N}\right\|_{\mathrm{L}^{2}(-1,1)}^{2} \quad \forall v_{N} \in \mathbb{Q}_{N}
$$

那么

!!!!
\lambda_{j} \leq \frac{C_{I}^{2} M N^{4}\left\|w_{N}^{j}\right\|_{\mathrm{L}^{2}(-1,1)}^{2}}{\left\|w_{N}^{j}\right\|_{N}^{2}}
$$

回顾一下等价属性\ref{10.54} ，我们得出结论，即

!!!!
\lambda_{j} \leq 3 C_{I}^{2} M N^{4} \quad \forall j=1, \ldots, N-1 .
$$

现在用稳定条件\ref{5.35}（用$\lambda_{j}$代替有限元特征值$\left\{\lambda_{h}^{i}\right\}$）得到不等式\ref{10.42} 。此外，对于$n \geq 1$和$\Omega=(-1,1)$，我们有以下收敛估计。

!!!!
\begin{array}{r}
\left\|u\left(t^{n}\right)-u_{N}^{n}\right\|_{\mathrm{L}^{2}(\Omega)} \leq \widetilde{C}\left(t^{n}\right)\left[N ^ { - r } \left(\left|u_{0}\right|_{\mathrm{H}^{r}(\Omega)}+\int_{0}^{t^{n}}\left|\frac{\partial u}{\partial t}(s)\right|_{\mathrm{H}^{r}(\Omega)} d s\right.\right. \\
\left.\left.+\left|u\left(t^{n}\right)\right|_{\mathrm{H}^{r}(\Omega)}\right)+\Delta t \int_{0}^{t^{n}}\left\|\frac{\partial^{2} u}{\partial t^{2}}(s)\right\|_{\mathrm{L}^{2}(\Omega)} d s\right]
\end{array}
$$

关于证明，请参考[CHQZ06，第7章]。

\subsection{Generalization to the two-dimensional case}

让我们考虑把单位平方$\Omega=(-1,1)^{2}$作为一个域。由于$\Omega$是一维区间$(-1,1)$的张量积，所以很自然地选择节点为

!!!!
\mathbf{x}_{i j}=\left(x_{i}, x_{j}\right), \quad i, j=0, \ldots, N
$$

其坐标都与一维GLL节点$x_{i}$重合，而我们将相应的一维权重的乘积作为权重。

!!!!
\alpha_{i j}=\alpha_{i} \alpha_{j}, \quad i, j=0, \ldots, N
$$

因此，二维的Gauss-Legendre-Lobatto（GLL）积分公式被定义为

!!!!
\int_{\Omega} f(\mathbf{x}) d \mathbf{x} \simeq \sum_{i, j=0}^{N} \alpha_{i j} f\left(\mathbf{x}_{i j}\right)
$$

而离散标量乘积由以下公式给出

!!!!
(f, g)_{N}=\sum_{i, j=0}^{N} \alpha_{i j} f\left(\mathbf{x}_{i j}\right) g\left(\mathbf{x}_{i j}\right)
\label{10.43}\end{equation}

与一维情况类似，可以证明，只要积分函数是最多为$2 N-1$度的多项式，积分公式\ref{10.43} 就是精确的。特别是，这意味着

!!!!
(f, g)_{N}=(f, g) \quad \forall f, g \text { such that } f g \in \mathbb{Q}_{2 N-1}
$$

在这一节中，对于每个$N, \mathbb{Q}_{N}$表示度数小于或等于$N$的多项式的空间，关于每个变量，在\ref{10.2}中介绍。

我们现在考虑作为一个例子，问题是

!!!!
\begin{cases}L u=-\operatorname{div}(\mu \nabla u)+\sigma u=f & \text { in } \Omega=(-1,1)^{2} \\ u=0 & \text { on } \partial \Omega\end{cases}
$$

通过假设$\mu(\mathbf{x}) \geq \mu_{0}>0$和$\sigma(\mathbf{x}) \geq 0$，相应的双线性形式在$\mathrm{H}_{0}^{1}(\Omega)$中是胁迫的。其G-NI近似值为

!!!!
\text { find } u_{N} \in V_{N}: \quad a_{N}\left(u_{N}, v_{N}\right)=F_{N}\left(v_{N}\right) \quad \forall v_{N} \in V_{N},
$$

其中

!!!!
\begin{aligned}
&V_{N}=\left\{v \in \mathbb{Q}_{N}:\left.v\right|_{\partial \Omega}=0\right\} \\
&a_{N}(u, v)=(\mu \nabla u, \nabla v)_{N}+(\sigma u, v)_{N}
\end{aligned}
$$

和

!!!!
F_{N}\left(v_{N}\right)=\left(f, v_{N}\right)_{N} .
$$

如一维情况所示，在更高的维度上，G-NI公式也等同于一个拼合方法，其中算子$L$被$L_{N}$取代，该伪谱算子通过用相应的内插导数\ref{10.40}来逼近每个导数获得。

在谱元方法的情况下，我们将需要对每个元素的GLL数值积分公式进行概括 $\Omega_{k}$ 。这可以通过变换$\varphi_{k}: \Omega \rightarrow \Omega_{k}$来实现（见图10.2）。事实上，我们首先可以在通用元素$\Omega_{k}$上生成GLL节点，通过设置

!!!!
\mathbf{x}_{i j}^{(k)}=\boldsymbol{\varphi}_{k}\left(\mathbf{x}_{i j}\right), \quad i, j=0, \ldots, N
$$

然后定义相应的权重

!!!!
\alpha_{i j}^{(k)}=\alpha_{i j}\left|\operatorname{det} J_{k}\right|=\alpha_{i j} \frac{\left|\Omega_{k}\right|}{4}, \quad i, j=0, \ldots, N
$$

用$J_{k}$表示变换$\varphi_{k}$的雅各布，用$\left|\Omega_{k}\right|$表示$\Omega_{k}$的尺度。因此，$\Omega_{k}$上的GLL积分公式成为

!!!!
\int_{\Omega_{k}} f(\mathbf{x}) d \mathbf{x} \simeq I_{N, k}^{G L L}(f)=\sum_{i, j=0}^{N} \alpha_{i j}^{(k)} f\left(\mathbf{x}_{i j}^{(k)}\right)
\label{10.44}\end{equation}

带高斯数值积分的谱元公式，我们将用SEM-NI表示，即成为

!!!!
\text { find } u_{N} \in V_{N}^{C}: \quad a_{C, N}\left(u_{N}, v_{N}\right)=F_{C, N}\left(v_{N}\right) \quad \forall v_{N} \in V_{N}^{C} .
\label{10.45}\end{equation}

我们已经设定了

!!!!
a_{C, N}\left(u_{N}, v_{N}\right)=\sum_{k} a_{\Omega_{k}, N}\left(u_{N}, v_{N}\right)
$$

其中$a_{\Omega_{k}, N}\left(u_{N}, v_{N}\right)$是$a_{\Omega_{k}}\left(u_{N}, v_{N}\right)$的近似值，通过$\Omega_{k}$ \ref{10.44}中的GLL数值积分公式对$\Omega_{k}$上以双线性形式出现的每个积分进行近似得到。术语$F_{C, N}$的定义与此类似，正是$F_{C, N}\left(v_{N}\right)=\sum_{k} F_{\Omega_{k}, N}\left(v_{N}\right)$ ，其中$F_{\Omega_{k}, N}$又是通过对每个$k$用公式$I_{N, k}^{G L L}\left(f v_{N}\right)$替换$\int_{\Omega_{k}} f v_{N} d \mathbf{x}$而得到。

备注10.3。图$10.10$相当形象地总结了到目前为止引起的不同近似方案的起源。在有限差分的情况下，我们用$L_{\Delta}$表示通过应用于$L$定义中出现的各种导数的有限差分方案对算子进行离散化。

\subsubsection{Convergence of the G-NI method}

正如在一维情况下观察到的那样，G-NI方法可以被认为是一种广义的Galerkin方法。对于后者，收敛性的分析是基于以下的一般结果。

定理$\mathbf{1 0 . 1}$ （Strang）。考虑问题

!!!!
\text { find } u \in V: \quad a(u, v)=F(v) \quad \forall v \in V
\label{10.46}\end{equation}

其中$V$是一个希尔伯特空间，其规范$\|\cdot\|_{V}, F \in V^{\prime}$是$V$上的线性和有界函数，$a(\cdot, \cdot): V \times V \rightarrow \mathbb{R}$是$V$上的双线性、连续和胁迫形式8 。(1.)

考虑\ref{10.46} 的近似值，可以通过以下广义的Galerkin问题来表述（1）（1.

!!!!
\text { find } u_{h} \in V_{h}: \quad a_{h}\left(u_{h}, v_{h}\right)=F_{h}\left(v_{h}\right) \quad \forall v_{h} \in V_{h},
\label{10.47}\end{equation}


$\left\{V_{h}, h>0\right\}$是$V$的一个有限维子空间族。

我们假设离散双线性形式$a_{h}(\cdot, \cdot)$在$V_{h} \times V_{h}$上是连续的，在$V_{h}$上是均匀强制的，即（1）。

$\exists \alpha^{*}>0$ 独立于h，从而$a_{h}\left(v_{h}, v_{h}\right) \geq \alpha^{*}\left\|v_{h}\right\|_{V}^{2} \quad \forall v_{h} \in V_{h}$ .

此外，我们假设$F_{h}$是$V_{h}$上的一个线性和有界函数。那么。

1.问题$u_{h}$存在唯一解\ref{10.47} 。

2.这种解决方案连续地取决于数据，即我们有

!!!!
\left\|u_{h}\right\|_{V} \leq \frac{1}{\alpha^{*}} \sup _{v_{h} \in V_{h} \backslash\{0\}} \frac{F_{h}\left(v_{h}\right)}{\left\|v_{h}\right\|_{V}}
$$

3.最后，以下先验误差估计成立

!!!!
\begin{aligned}
\left\|u-u_{h}\right\|_{V} \leq & \inf _{w_{h} \in V_{h}}\left\{\left(1+\frac{M}{\alpha^{*}}\right)\left\|u-w_{h}\right\|_{V}\right.\\
&\left.+\frac{1}{\alpha^{*}} \sup _{v_{h} \in V_{h} \backslash\{0\}} \frac{\left|a\left(w_{h}, v_{h}\right)-a_{h}\left(w_{h}, v_{h}\right)\right|}{\left\|v_{h}\right\|_{V}}\right\} \\
&+\frac{1}{\alpha^{*}} \sup _{v_{h} \in V_{h} \backslash\{0\}} \frac{\left|F\left(v_{h}\right)-F_{h}\left(v_{h}\right)\right|}{\left\|v_{h}\right\|_{V}}
\end{aligned}
\label{10.48}\end{equation}

$M$ 是双线性形式的连续性常数 $a(\cdot, \cdot)$ 。

证明。问题\ref{10.47}的Lax-Milgram定理的假设得到满足，所以这种问题的解存在并且是唯一的。此外。

!!!!
\left\|u_{h}\right\|_{V} \leq \frac{1}{\alpha^{*}}\left\|F_{h}\right\|_{V_{h}^{\prime}}
$$

$\left\|F_{h}\right\|_{V_{h}^{\prime}}=\sup _{v_{h} \in V_{h} \backslash\{0\}} \frac{F_{h}\left(v_{h}\right)}{\left\|v_{h}\right\|_{V}}$是$V_{h}$的对偶空间$V_{h}^{\prime}$的规范。

![](https://cdn.mathpix.com/cropped/10058ab4e7f0c5bd6fe5bcd4db204623-247.jpg?height=784&width=716&top_left_y=115&top_left_x=97)

图10.10.本书中涉及的主要数值方法的参考框架

现在我们来证明误差不等式 \ref{10.48} 。让$w_{h}$是子空间$V_{h}$的任何函数。设定 $\sigma_{h}=u_{h}-w_{h} \in V_{h}$ ，我们有。

!!!!
\begin{aligned}
\alpha^{*}\left\|\sigma_{h}\right\|_{V}^{2} & \leq a_{h}\left(\sigma_{h}, \sigma_{h}\right) \quad\left[\text { by the coercivity of } a_{h}\right] \\
&=a_{h}\left(u_{h}, \sigma_{h}\right)-a_{h}\left(w_{h}, \sigma_{h}\right) \\
&=F_{h}\left(\sigma_{h}\right)-a_{h}\left(w_{h}, \sigma_{h}\right) \quad[\text { thanks to }(\ref{10.47})] \\
&=F_{h}\left(\sigma_{h}\right)-F\left(\sigma_{h}\right)+F\left(\sigma_{h}\right)-a_{h}\left(w_{h}, \sigma_{h}\right) \\
&=\left[F_{h}\left(\sigma_{h}\right)-F\left(\sigma_{h}\right)\right]+a\left(u, \sigma_{h}\right)-a_{h}\left(w_{h}, \sigma_{h}\right) \quad[\text { thanks to }(\ref{10.46})] \\
&=\left[F_{h}\left(\sigma_{h}\right)-F\left(\sigma_{h}\right)\right]+a\left(u-w_{h}, \sigma_{h}\right)+\left[a\left(w_{h}, \sigma_{h}\right)-a_{h}\left(w_{h}, \sigma_{h}\right)\right]
\end{aligned}
\label{10.49}\end{equation}

如果$\sigma_{h} \neq 0$ ,\ref{10.49}可以除以$\alpha^{*}\left\|\sigma_{h}\right\|_{V}$，得到

!!!!
\begin{gathered}
\left\|\sigma_{h}\right\|_{V} \leq \frac{1}{\alpha^{*}}\left\{\frac{\left|a\left(u-w_{h}, \sigma_{h}\right)\right|}{\left\|\sigma_{h}\right\|_{V}}+\frac{\left|a\left(w_{h}, \sigma_{h}\right)-a_{h}\left(w_{h}, \sigma_{h}\right)\right|}{\left\|\sigma_{h}\right\|_{V}}\right. \\
\left.+\frac{\left|F_{h}\left(\sigma_{h}\right)-F\left(\sigma_{h}\right)\right|}{\left\|\sigma_{h}\right\|_{V}}\right\} \\
+\frac{1}{\alpha^{*}}\left\{M\left\|u-w_{h}\right\|_{V}+\sup _{v_{h} \in V_{h} \backslash\{0\}} \frac{\left|a\left(w_{h}, v_{h}\right)-a_{h}\left(w_{h}, v_{h}\right)\right|}{\left\|v_{h}\right\|_{V}}\right. \\
\left.+\sup _{v_{h} \in V_{h} \backslash\{0\}} \frac{\left|F_{h}\left(v_{h}\right)-F\left(v_{h}\right)\right|}{\left\|v_{h}\right\|_{V}}\right\} \quad[\text { by the continuity of } a]
\end{gathered}
$$

如果$\sigma_{h}=0$这样的不等式仍然有效（它指出0小于正项之和），尽管证明破裂了。

我们现在可以估计\ref{10.46} 的解$u$和\ref{10.47} 的解$u_{h}$之间的误差。由于$u-u_{h}=\left(u-w_{h}\right)-\sigma_{h}$，我们得到

!!!!
\begin{gathered}
\left\|u-u_{h}\right\|_{V} \leq\left\|u-w_{h}\right\|_{V}+\left\|\sigma_{h}\right\|_{V} \leq\left\|u-w_{h}\right\|_{V} \\
+\frac{1}{\alpha^{*}}\left\{M\left\|u-w_{h}\right\|_{V}+\sup _{v_{h} \in V_{h} \backslash\{0\}} \frac{\left|a\left(w_{h}, v_{h}\right)-a_{h}\left(w_{h}, v_{h}\right)\right|}{\left\|v_{h}\right\|_{V}}\right. \\
\left.+\quad \sup _{v_{h} \in V_{h} \backslash\{0\}} \frac{\left|F_{h}\left(v_{h}\right)-F\left(v_{h}\right)\right|}{\left\|v_{h}\right\|_{V}}\right\} \\
=\left(1+\frac{M}{\alpha^{*}}\right)\left\|u-w_{h}\right\|_{V}+\frac{1}{\alpha^{*}} \sup _{v_{h} \in V_{h} \backslash\{0\}} \frac{\left|a\left(w_{h}, v_{h}\right)-a_{h}\left(w_{h}, v_{h}\right)\right|}{\left\|v_{h}\right\|_{V}} \\
+\frac{1}{\alpha^{*}} \sup _{v_{h} \in V_{h} \backslash\{0\}} \frac{\left|F_{h}\left(v_{h}\right)-F\left(v_{h}\right)\right|}{\left\|v_{h}\right\|_{V}} .
\end{gathered}
$$

如果前面的不等式在$\forall w_{h} \in V_{h}$中成立，那么在$w_{h}$中变化时取下限时也成立。因此，我们得到\ref{10.48} 。

通过观察不等式\ref{10.48} 的右侧，我们可以认识到对近似误差$u-u_{h}:$的三个不同贡献，第一个是最佳近似误差，第二个是使用离散双线性形式$a_{h}(\cdot, \cdot)$对双线性形式$a(\cdot, \cdot)$进行近似所产生的误差，第三个是由离散线性函数$F_{h}(\cdot)$对线性函数$F(\cdot)$的近似所产生的误差。

备注10.4。如果在前面的证明中，我们选择$w_{h}=u_{h}^{*}, u_{h}^{*}$作为Galerkin问题的解

!!!!
u_{h}^{*} \in V_{h}: a\left(u_{h}^{*}, v_{h}\right)=F\left(v_{h}\right) \quad \forall v_{h} \in V_{h}
$$

那么由于\ref{10.46},\ref{4.1}，$a\left(u-w_{h}, \sigma_{h}\right)$项为空。因此，可以得到以下估计，替代\ref{10.48}的做法

!!!!
\begin{aligned}
\left\|u-u_{h}\right\|_{V} \leq\left\|u-u_{h}^{*}\right\|_{V} \\
&+\frac{1}{\alpha^{*}} \sup _{v_{h} \in V_{h} \backslash\{0\}} \frac{\left|a\left(u_{h}^{*}, v_{h}\right)-a_{h}\left(u_{h}^{*}, v_{h}\right)\right|}{\left\|v_{h}\right\|_{V}} \\
&+\frac{1}{\alpha^{*}} \sup _{v_{h} \in V_{h} \backslash\{0\}} \frac{\left|F\left(v_{h}\right)-F_{h}\left(v_{h}\right)\right|}{\left\|v_{h}\right\|_{V}} .
\end{aligned}
$$

后者强调了这样一个事实：由于广义的Galerkin法而产生的误差可以被Galerkin法的误差加上使用数值积分计算所引起的误差所约束，而这两种方法$a(\cdot, \cdot)$和$F(\cdot)$ 。

我们现在要将斯特朗定理应用于G-NI方法，以验证其收敛性。为了简单起见，我们将只考虑一维的情况。显然，$V_{h}$将被$V_{N}, u_{h}$替换为$u_{N}, v_{h}$，被$v_{N}$替换为$w_{h}$。

首先，我们开始计算GLL数字积分公式的误差

!!!!
E\left(g, v_{N}\right)=\left(g, v_{N}\right)-\left(g, v_{N}\right)_{N}
$$

$g$和$v_{N}$分别是一个通用连续函数和$\mathbb{Q}_{N}$的通用多项式。通过引入根据\ref{10.14} 定义的插值多项式$\Pi_{N}^{G L L} g$，我们可以得到

!!!!
\begin{aligned}
E\left(g, v_{N}\right)=&\left(g, v_{N}\right)-\left(\Pi_{N}^{G L L} g, v_{N}\right)_{N} \\
=&{\left(g, v_{N}\right)-\left(\Pi_{N-1}^{G L L} g, v_{N}\right)+\underbrace{(\overbrace{\Pi_{N-1}^{G L L}}^{\in \mathbb{Q}_{N-1}}}_{\in \mathbb{Q}}, \overbrace{v_{N}}^{\in \mathbb{Q}_{N}})}_{=} &\left(g, v_{N}\right)-\left(\Pi_{N-1}^{G L L} g, v_{N}\right) \\
&+\left(\Pi_{N-1}^{G L L} g, v_{N}\right)_{N}-\left(\Pi_{N}^{G L L} g, v_{N}\right)_{N}[\text { by }(\ref{10.27})] \\
=&\left(g-\Pi_{N-1}^{G L L} g, v_{N}\right)+\left(\Pi_{N-1}^{G L L} g-\Pi_{N}^{G L L} g, v_{N}\right)_{N}
\end{aligned}
\label{10.50}\end{equation}

右手边的第一个和可以用考奇-施瓦茨不等式从上面进行约束，如下所示

!!!!
\left|\left(g-\Pi_{N-1}^{G L L} g, v_{N}\right)\right| \leq\left\|g-\Pi_{N-1}^{G L L} g\right\|_{L^{2}(-1,1)}\left\|v_{N}\right\|_{L^{2}(-1,1)}
\label{10.51}\end{equation}

为了找到第二个和的上界，我们必须首先介绍以下两个公设，关于其证明，我们参考 [CHQZ06] 。

Lemma 10.2. The discrete scalar product $(\cdot, \cdot)_{N}$ defined in (10.25) is a scalar product on $\mathbb{Q}_{N}$ and, as such, it satisfies the Cauchy-Schwarz inequality

!!!!
\left|(\varphi, \psi)_{N}\right| \leq\|\varphi\|_{N}\|\psi\|_{N}
\label{10.52}\end{equation}

where the discrete norm $\|\cdot\|_{N}$ is given by


!!!!
\|\varphi\|_{N}=\sqrt{(\varphi, \varphi)_{N}} \quad \forall \varphi \in \mathbb{Q}_{N}
\label{10.53}\end{equation}


Lemma 10.3. The "continuous" norm of $\mathrm{L}^{2}(-1,1)$ and the "discrete" norm $\|\cdot\|_{N}$ defined in (10.53) verify the inequalities

!!!!
\left\|v_{N}\right\|_{\mathrm{L}^{2}(-1,1)} \leq\left\|v_{N}\right\|_{N} \leq \sqrt{3}\left\|v_{N}\right\|_{\mathrm{L}^{2}(-1,1)} \quad \forall v_{N} \in \mathbb{Q}_{N},
\label{10.54}\end{equation}

hence they are uniformly equivalent on $\mathbb{Q}_{N}$.



首先使用\ref{10.53} ，然后使用\ref{10.54} ，我们得到

!!!!
\begin{aligned}
&\left|\left(\Pi_{N-1}^{G L L} g-\Pi_{N}^{G L L} g, v_{N}\right)_{N}\right| \leq\left\|\Pi_{N-1}^{G L L} g-\Pi_{N}^{G L L} g\right\|_{N}\left\|v_{N}\right\|_{N} \\
&\quad \leq 3\left[\left\|\Pi_{N-1}^{G L L} g-g\right\|_{L^{2}(-1,1)}+\left\|\Pi_{N}^{G L L} g-g\right\|_{L^{2}(-1,1)}\right]\left\|v_{N}\right\|_{L^{2}(-1,1)}
\end{aligned}
$$

使用这种不等式和\ref{10.51} ，从\ref{10.50}中我们可以得到以下的上界

!!!!
\left|E\left(g, v_{N}\right)\right| \leq\left[4\left\|\Pi_{N-1}^{G L L} g-g\right\|_{L^{2}(-1,1)}+3\left\|\Pi_{N}^{G L L} g-g\right\|_{L^{2}(-1,1)}\right]\left\|v_{N}\right\|_{L^{2}(-1,1)}
$$

使用插值估计\ref{10.17} ，我们可以得出

!!!!
\left|E\left(g, v_{N}\right)\right| \leq C\left[\left(\frac{1}{N-1}\right)^{s}+\left(\frac{1}{N}\right)^{s}\right]\|g\|_{\mathrm{H}^{s}(-1,1)}\left\|v_{N}\right\|_{\mathrm{L}^{2}(-1,1)}
\label{10.55}\end{equation}

只要$g \in \mathrm{H}^{s}(-1,1)$ ，对于某些$s \geq 1$ 。最后，对于每个$N \geq 2,1 /(N-1) \leq!!!!2 / N$，高斯-雷根德-洛巴托的积分误差结果被约束为

!!!!
\left|E\left(g, v_{N}\right)\right| \leq C\left(\frac{1}{N}\right)^{s}\|g\|_{\mathrm{H}^{s}(-1,1)}\left\|v_{N}\right\|_{L^{2}(-1,1)}
$$

对于每个$g \in \mathrm{H}^{s}(-1,1)$和每个多项式$v_{N} \in \mathbb{Q}_{N}$ .

在这一点上，我们已经准备好评估介入\ref{10.48} 的各种贡献。我们预计，这种分析将在对所研究的微分问题引入适当的简化假设的情况下进行。我们从最简单的项开始，即与函数$F$相关的项，假设考虑一个具有同质Dirichlet边界条件的问题，以获得$F\left(v_{N}\right)=\left(f, v_{N}\right)$和$F_{N}\left(v_{N}\right)=\left(f, v_{N}\right)_{N}$。只要$f \in \mathrm{H}^{s}(-1,1)$为某个$s \geq 1$，那么。

!!!!
\begin{aligned}
&\sup _{v_{N} \in V_{N} \backslash\{0\}} \frac{\left|F\left(v_{N}\right)-F_{N}\left(v_{N}\right)\right|}{\left\|v_{N}\right\|_{V}}=\sup _{v_{N} \in V_{N} \backslash\{0\}} \frac{\left|\left(f, v_{N}\right)-\left(f, v_{N}\right)_{N}\right|}{\left\|v_{N}\right\|_{V}} \\
&=\sup _{v_{N} \in V_{N} \backslash\{0\}} \frac{\left|E\left(f, v_{N}\right)\right|}{\left\|v_{N}\right\|_{V}} \leq \sup _{v_{N} \in V_{N} \backslash\{0\}} \frac{C\left(\frac{1}{N}\right)^{s}\|f\|_{\mathrm{H}^{s}(-1,1)}\left\|v_{N}\right\|_{\mathrm{L}^{2}(-1,1)}}{\left\|v_{N}\right\|_{V}} \\
&\leq C\left(\frac{1}{N}\right)\|f\|_{\mathrm{H}^{s}(-1,1)}
\end{aligned}
\label{10.56}\end{equation}

利用关系\ref{10.55} ，用$\mathrm{L}^{2}(-1,1)$中的规范来约束$\mathrm{H}^{S}(-1,1)$。

至于由双线性形式的近似产生的贡献。

!!!!
\sup _{v_{N} \in V_{N} \backslash\{0\}} \frac{\left|a\left(w_{N}, v_{N}\right)-a_{N}\left(w_{N}, v_{N}\right)\right|}{\left\|v_{N}\right\|_{V}}
$$

我们不能在不参考特定微分问题的情况下明确地评估它。然后我们选择一维扩散-反应问题\ref{10.22} 作为例子，并假设$\mu$和$\sigma$是常数。顺便说一下，这样的问题满足同质的迪里切特边界条件，这与推导估计值\ref{10.56} 的要求一致。在这种情况下，相关的双线性形式是

!!!!
a(u, v)=\left(\mu u^{\prime}, v^{\prime}\right)+(\sigma u, v)
$$

而其G-NI的近似值为

!!!!
a_{N}(u, v)=\left(\mu u^{\prime}, v^{\prime}\right)_{N}+(\sigma u, v)_{N}
$$

然后我们必须评估

!!!!
a\left(w_{N}, v_{N}\right)-a_{N}\left(w_{N}, v_{N}\right)=\left(\mu w_{N}^{\prime}, v_{N}^{\prime}\right)-\left(\mu w_{N}^{\prime}, v_{N}^{\prime}\right)_{N}+\left(\sigma w_{N}, v_{N}\right)-\left(\sigma w_{N}, v_{N}\right)_{N}
$$

由于$w_{N}^{\prime} v_{N}^{\prime} \in \mathbb{Q}_{2 N-2}$，如果我们假设$\mu$是常数，那么积$\mu w_{N}^{\prime} v_{N}^{\prime}$正好被GLL积分公式积分，也就是$\left(\mu w_{N}^{\prime}, v_{N}^{\prime}\right)-\left(\mu w_{N}^{\prime}, v_{N}^{\prime}\right)_{N}=0$。我们现在观察到

!!!!
\left(\sigma w_{N}, v_{N}\right)-\left(\sigma w_{N}, v_{N}\right)_{N}=E\left(\sigma w_{N}, v_{N}\right)=E\left(\sigma\left(w_{N}-u\right), v_{N}\right)+E\left(\sigma u, v_{N}\right)
$$

因此，利用\ref{10.55}，我们可以得到

!!!!
\left|E\left(\sigma\left(w_{N}-u\right), v_{N}\right)\right| \leq C\left(\frac{1}{N}\right)\left\|\sigma\left(w_{N}-u\right)\right\|_{\mathrm{H}^{1}(-1,1)}\left\|v_{N}\right\|_{L^{2}(-1,1)}
$$



!!!!
\left|E\left(\sigma u, v_{N}\right)\right| \leq C\left(\frac{1}{N}\right)^{s}\|\sigma u\|_{\mathrm{H}^{s}(-1,1)}\left\|v_{N}\right\|_{\mathrm{L}^{2}(-1,1)}
$$

另一方面，由于$\sigma$也是常数，设定$w_{N}=\Pi_{N}^{G L L} u$并使用\ref{10.17} ，我们得到

!!!!
\left\|\sigma\left(w_{N}-u\right)\right\|_{\mathrm{H}^{1}(-1,1)} \leq C\left\|u-\Pi_{N}^{G L L} u\right\|_{\mathrm{H}^{1}(-1,1)} \leq C\left(\frac{1}{N}\right)^{s-1}\|u\|_{\mathrm{H}^{s}(-1,1)}
$$

因此。

!!!!
\sup _{v_{N} \in V_{N} \backslash\{0\}} \frac{\left|a\left(w_{N}, v_{N}\right)-a_{N}\left(w_{N}, v_{N}\right)\right|}{\left\|v_{N}\right\|_{V}} \leq C^{*}\left(\frac{1}{N}\right)^{s}\|u\|_{\mathrm{H}^{s}(-1,1)}
\label{10.57}\end{equation}

我们仍然需要估计\ref{10.48} 的第一个和。在选择了$w_{N}=\Pi_{N}^{G L L} u$并再次利用\ref{10.17} 后，我们得到

!!!!
\left\|u-w_{N}\right\|_{V}=\left\|u-\Pi_{N}^{G L L} u\right\|_{\mathrm{H}^{1}(-1,1)} \leq C\left(\frac{1}{N}\right)^{s}\|u\|_{\mathrm{H}^{s+1}(-1,1)}
\label{10.58}\end{equation}

只要$u \in \mathrm{H}^{s+1}(-1,1)$ ，对于一个合适的$s \geq 1$ 。最后，由于\ref{10.56}、\ref{10.57}和\ref{10.58}，从\ref{10.48}应用于问题\ref{10.22}的G-NI近似，并在前面的假设下，我们发现以下误差估计

!!!!
\left\|u-u_{N}\right\|_{\mathrm{H}^{1}(-1,1)} \leq C\left(\frac{1}{N}\right)^{s}\left(\|f\|_{\mathrm{H}^{s}(-1,1)}+\|u\|_{\mathrm{H}^{s+1}(-1,1)}\right)
$$

刚刚对模型问题\ref{10.22} 进行的收敛性分析可以推广到更复杂的微分问题和不同边界条件的情况（有一些技术困难）。

例10.2（取决于参数的规则性问题）。让我们考虑下面这个（微不足道但有启发性的）问题

!!!!
\begin{cases}-u^{\prime \prime}=0, & x \in(0,1] \\ -u^{\prime \prime}=-\alpha(\alpha-1)(x-1)^{\alpha-2}, & x \in(1,2) \\ u(0)=0, & u(2)=1\end{cases}
$$

与 $\alpha \in \mathbb{N}$ 。精确解在$(0,1)$中为空，在$x \in(1,2)$中等于$(x-1)^{\alpha}$。因此，它属于 $\mathrm{H}^{\alpha}(0,2)$ ，但不属于 $\mathrm{H}^{\alpha+1}(0,2)$ 。我们在表$10.1$中报告了三个不同的$\alpha$值时，使用G-NI方法对$\mathrm{H}^{1}(0,2)$准则的误差行为。可以看出，当正则性增加时，光谱方法相对于$N$的收敛顺序也会增加，正如理论所言。在同一个表格中，我们报告了使用线性有限元得到的结果（这次$N$表示元素的数量）。在这两种情况下，有限元方法的收敛顺序仍然是线性的。表10.1.G-NI谱法在不同的多项式度数$N$和解规整性指数下的误差行为（左）。线性有限元方法在不同间隔数$N$和解的规则性指数下的误差行为（右）。

\begin{tabular}{cccc}。
\Hline $N$ & $\alpha=2$ & $\alpha=3$ & $\alpha=4$ \hline $N$ & $\alpha=2$ & $\alpha=3$ & $\alpha=4$ \hline
\4 & $0.5931$ & $0.2502$ & $0.2041$ 4 & $0.5931$ & $0.2502$ & $0.2041$。

16 & $0.1566$ & $0.0154$ & $7.5529 \cdot 10^{-4}$ （16）。
32 & $0.0792$ & $0.0039$ & $6.7934 \cdot 10^{-5}$ （32）。
\hline
\end{tabular}

\begin{tabular}{ccc}}。



16 & $0.1312$ & $0.1467$ （16）。
32 & $0.0745$ & $0.0801$ （32）。
\hline
\end{tabular}
 ![](https://cdn.mathpix.com/cropped/10058ab4e7f0c5bd6fe5bcd4db204623-253.jpg?height=214&width=718&top_left_y=364&top_left_x=96)

图10.11.例$10.3$中问题的网格（左）和用谱系有限元方法得到的解孤立线（右）。

例10.3。让我们来看看第4.6.3节中说明的第二个例子。4.6.3节中说明的第二个例子，这次使用的是谱元法。让我们考虑将域划分为四个8度的谱元，如图10.11左侧所示。得到的解（图10.11，左）在原点附近没有表现出任何不准确，与没有网格适应性的情况下使用有限元得到的解相反（与图4.24，左）。

\subsection{G-NI and SEM-NI methods for a one-dimensional model problem}

让我们考虑一维扩散-反应问题

!!!!
-\left[\left(1+x^{2}\right) u^{\prime}(x)\right]^{\prime}+\cos \left(x^{2}\right) u(x)=f(x), \quad x \in(-1,1),
\label{10.59}\end{equation}

连同混合型边界条件

!!!!
u(-1)=0, \quad u^{\prime}(1)=1
$$

本节的目的是详细讨论如何制定G-NI和SEMNI的近似值。对于前者，我们还将提供相应的矩阵表述以及稳定性分析。

\subsubsection{The G-NI method}

问题\ref{10.59}的弱表述是：。

!!!!
\text { find } \quad u \in V: a(u, v)=F(v) \quad \forall v \in V,
$$

$V=\left\{v \in \mathrm{H}^{1}(-1,1): v(-1)=0\right\}, a: V \times V \longrightarrow \mathbb{R}$和$F: V \longrightarrow \mathbb{R}$分别是双线性形式和线性函数，定义如下

!!!!
\begin{gathered}
a(u, v)=\int_{-1}^{1}\left(1+x^{2}\right) u^{\prime}(x) v^{\prime}(x) d x+\int_{-1}^{1} \cos \left(x^{2}\right) u(x) v(x) d x \\
F(v)=\int_{-1}^{1} f(x) v(x) d x+2 v(1)
\end{gathered}
$$

谱-加勒金公式（SM）有以下形式

!!!!
\text { find } u_{N} \in V_{N} \quad \text { such that } \quad a\left(u_{N}, v_{N}\right)=F\left(v_{N}\right) \quad \forall v_{N} \in V_{N}
\label{10.60}\end{equation}

与

!!!!
V_{N}=\left\{v_{N} \in \mathbb{Q}_{N}: v_{N}(-1)=0\right\} \subset V
\label{10.61}\end{equation}

为了得到相应的G-NI公式，只要在\ref{10.60} 中用\ref{10.25} 中定义的GLL离散标量积来近似$\mathrm{L}^{2}(-1,1)$上的所有标量积即可。然后我们有

!!!!
\text { find } u_{N}^{*} \in V_{N}: a_{N}\left(u_{N}^{*}, v_{N}\right)=F_{N}\left(v_{N}\right) \quad \forall v_{N} \in V_{N} \text {, }
\label{10.62}\end{equation}

已设定

!!!!
\begin{aligned}
a_{N}(u, v) &=\left(\left(1+x^{2}\right) u^{\prime}, v^{\prime}\right)_{N}+\left(\cos \left(x^{2}\right) u, v\right)_{N} \\
&=\sum_{i=0}^{N}\left(1+x_{i}^{2}\right) u^{\prime}\left(x_{i}\right) v^{\prime}\left(x_{i}\right) \alpha_{i}+\sum_{i=1}^{N} \cos \left(x_{i}^{2}\right) u\left(x_{i}\right) v\left(x_{i}\right) \alpha_{i}
\end{aligned}
\label{10.63}\end{equation}

和

!!!!
F_{N}(v)=(f, v)_{N}+2 v(1)=\sum_{i=1}^{N} f\left(x_{i}\right) v\left(x_{i}\right) \alpha_{i}+2 v(1)
\label{10.64}\end{equation}

注意，这要求$f$是连续的。我们观察到\ref{10.63} 中最后一个和的指数$i$和\ref{10.64} 中的和的指数从1开始，而不是0，因为$v\left(x_{0}\right)=v(-1)=0$ 。此外，SM(\ref{10.60})和G-NI(\ref{10.62})的公式从来没有重合过。例如，考虑扩散项 $\left(1+x^{2}\right)\left(u_{N}^{*}\right)^{\prime} v_{N}^{\prime}:$ 这是一个度数为 $2 N$ 的多项式。由于GLL积分公式的确切度为$\mathscr{D}(\Omega)$，离散标量积\ref{10.25} 不会返回相应的连续标量积$\left(\left(1+x^{2}\right)\left(u_{N}^{*}\right)^{\prime}, v_{N}^{\prime}\right)$的确切值。

为了得到G-NI近似的矩阵表述，我们用$\psi_{i}$表示，对于$i=1, \ldots, N$，与所有GLL节点相关的特征多项式，除了分配了Dirichlet边界条件的节点，$x_{0}=-1$ 。这种多项式构成了(\ref{10.61})中引入的空间$V_{N}$的基础。这首先使我们能够将G-NI公式的解$u_{N}^{*}$写为

!!!!
u_{N}^{*}(x)=\sum_{j=1}^{N} u_{N}^{*}\left(x_{j}\right) \psi_{j}(x)
$$

其次，我们可以在\ref{10.62} 中选择 $v_{N}=\psi_{i}, i=1, \ldots, N$ ，得到

!!!!
a_{N}\left(u_{N}^{*}, \psi_{i}\right)=F_{N}\left(\psi_{i}\right), \quad i=1, \ldots, N,
$$

即

!!!!
\sum_{j=1}^{N} u_{N}^{*}\left(x_{j}\right) a_{N}\left(\psi_{j}, \psi_{i}\right)=F_{N}\left(\psi_{i}\right), \quad i=1, \ldots, N
$$

以矩阵形式。

!!!!
A \mathbf{u}_{N}^{*}=\mathbf{f}
$$

有$\mathbf{u}_{N}^{*}=\left(u_{N}^{*}\left(x_{i}\right)\right), A=\left(a_{i j}\right)$ ，其中

!!!!
\begin{aligned}
a_{i j}=a_{N}\left(\psi_{j}, \psi_{i}\right) &=\sum_{k=0}^{N}\left(1+x_{k}^{2}\right) \psi_{j}^{\prime}\left(x_{k}\right) \psi_{i}^{\prime}\left(x_{k}\right) \alpha_{k}+\sum_{k=1}^{N} \cos \left(x_{k}^{2}\right) \psi_{j}\left(x_{k}\right) \psi_{i}\left(x_{k}\right) \alpha_{k} \\
&=\sum_{k=0}^{N}\left(1+x_{k}^{2}\right) \psi_{j}^{\prime}\left(x_{k}\right) \psi_{i}^{\prime}\left(x_{k}\right) \alpha_{k}+\cos \left(x_{i}^{2}\right) \alpha_{i} \delta_{i j}
\end{aligned}
$$

和

!!!!
\begin{aligned}
\mathbf{f}=\left(f_{i}\right), \text { con } f_{i} &=F_{N}\left(\psi_{i}\right)=\left(f, \psi_{i}\right)_{N}+2 \psi_{i}(1) \\
&=\sum_{k=1}^{N} f\left(x_{k}\right) \psi_{i}\left(x_{k}\right) \alpha_{k}+2 \psi_{i}(1) \\
&= \begin{cases}\alpha_{i} f\left(x_{i}\right) & \text { for } \quad i=1, \ldots, N-1, \\
\alpha_{N} f(1)+2 & \text { for } i=N\end{cases}
\end{aligned}
$$

我们回顾一下，矩阵$A$，除了条件不好之外，由于扩散项的存在，是完整的。

最后，我们可以验证G-NI方法\ref{10.62} 可以被重新表述为一种合适的配位方法。为此，我们希望以连续形式重写离散公式\ref{10.62} ，以便通过部分反积分，即返回到初始微分算子。为了做到这一点，我们将求助于(\ref{10.15})中定义的插值算子$\Pi_{N}^{G L L}$，另外回顾一下，如果两个积分函数的乘积是度数为$\leq 2 N-1$的多项式，则离散标量乘积(\ref{10.25})与$\mathrm{L}^{2}(-1,1)$上的连续乘积相吻合（见\ref{10.36} ）。然后我们准确地重写$a_{N}\left(u_{N}^{*}, v_{N}\right)$的第一个和，忽略$*$以简化符号。由于\ref{10.36}和通过部分积分，我们有

!!!!
\begin{aligned}
&\left(\left(1+x^{2}\right) u_{N}^{\prime}, v_{N}^{\prime}\right)_{N} \\
&\quad=\left(\Pi_{N}^{G L L}\left(\left(1+x^{2}\right) u_{N}^{\prime}\right), v_{N}^{\prime}\right)_{N}=\left(\Pi_{N}^{G L L}\left(\left(1+x^{2}\right) u_{N}^{\prime}\right), v_{N}^{\prime}\right) \\
&\quad=-\left(\left[\Pi_{N}^{G L L}\left(\left(1+x^{2}\right) u_{N}^{\prime}\right)\right]^{\prime}, v_{N}\right)+\Pi_{N}^{G L L}\left(\left(1+x^{2}\right) u_{N}^{\prime}\right)(1) v_{N}(1) \\
&\quad=-\left(\left[\Pi_{N}^{G L L}\left(\left(1+x^{2}\right) u_{N}^{\prime}\right)\right]^{\prime}, v_{N}\right)_{N}+\Pi_{N}^{G L L}\left(\left(1+x^{2}\right) u_{N}^{\prime}\right)(1) v_{N}(1)
\end{aligned}
$$

因此，我们可以将\ref{10.62}重新表述为

!!!!
+\left(2-\Pi_{N}^{G L L}\left(\left(1+x^{2}\right) u_{N}^{\prime}\right)(1)\right) v_{N}(1) \quad \forall v_{N} \in V_{N}
$$

!!!!
\text { find } u_{N} \in V_{N}:\left(L_{N} u_{N}, v_{N}\right)_{N}=\left(f, v_{N}\right)_{N}
\label{10.65}\end{equation}

与

!!!!
L_{N} u_{N}=-\left[\Pi_{N}^{G L L}\left(\left(1+x^{2}\right) u_{N}^{\prime}\right)\right]^{\prime}+\cos \left(x^{2}\right) u_{N}=-D_{N}\left(\left(1+x^{2}\right) u_{N}^{\prime}\right)+\cos \left(x^{2}\right) u_{N}
$$

$D_{N}$是\ref{10.40} 中引入的插值导数。我们现在选择 \ref{10.65} $v_{N}=\psi_{i}$ 。对于 $i=1, \ldots, N-1$ ，我们有

!!!!
\begin{aligned}
&\left(L_{N} u_{N}, \psi_{i}\right)_{N}=\left(-\left[\Pi_{N}^{G L L}\left(\left(1+x^{2}\right) u_{N}^{\prime}\right)\right]^{\prime}, \psi_{i}\right)_{N}+\left(\cos \left(x^{2}\right) u_{N}, \psi_{i}\right)_{N} \\
&=-\sum_{j=1}^{N-1} \alpha_{j}\left[\Pi_{N}^{G L L}\left(\left(1+x^{2}\right) u_{N}^{\prime}\right)\right]^{\prime}\left(x_{j}\right) \psi_{i}\left(x_{j}\right)+\sum_{j=1}^{N-1} \alpha_{j} \cos \left(x_{j}^{2}\right) u_{N}\left(x_{j}\right) \psi_{i}\left(x_{j}\right) \\
&=-\alpha_{i}\left[\Pi_{N}^{G L L}\left(\left(1+x^{2}\right) u_{N}^{\prime}\right)\right]^{\prime}\left(x_{i}\right)+\alpha_{i} \cos \left(x_{i}^{2}\right) u_{N}\left(x_{i}\right)=\left(f, \psi_{i}\right)_{N} \\
&=\sum_{j=1}^{N-1} \alpha_{j} f\left(x_{j}\right) \psi_{i}\left(x_{j}\right)=\alpha_{i} f\left(x_{i}\right)
\end{aligned}
$$

即利用$L_{N}$运算符的定义，将一切除以$\alpha_{i}$ 。

!!!!
L_{N} u_{N}\left(x_{i}\right)=f\left(x_{i}\right), \quad i=1, \ldots, N-1
\label{10.66}\end{equation}

在$v_{N}=\psi_{N}$中设置了\ref{10.65}，我们得到的是

!!!!
\begin{aligned}
\left(L_{N} u_{N}, \psi_{N}\right)_{N} &=-\alpha_{N}\left[\Pi_{N}^{G L L}\left(\left(1+x^{2}\right) u_{N}^{\prime}\right)\right]^{\prime}\left(x_{N}\right)+\alpha_{N} \cos \left(x_{N}^{2}\right) u_{N}\left(x_{N}\right) \\
&=\left(f, \psi_{N}\right)_{N}+2-\Pi_{N}^{G L L}\left(\left(1+x^{2}\right) u_{N}^{\prime}\right)(1) \\
&=\alpha_{N} f\left(x_{N}\right)+2-\Pi_{N}^{G L L}\left(\left(1+x^{2}\right) u_{N}^{\prime}\right)(1)
\end{aligned}
$$

或者，全部除以$\alpha_{N}$ 。

!!!!
L_{N} u_{N}\left(x_{N}\right)=f\left(x_{N}\right)+\frac{1}{\alpha_{N}}\left(2-\Pi_{N}^{G L L}\left(\left(1+x^{2}\right) u_{N}^{\prime}\right)(1)\right)
\label{10.67}\end{equation}

因此，方程\ref{10.66}和\ref{10.67}提供了给定微分问题的所有节点（除了指定迪里希特条件的潜在边界节点）的配位，在使用算子$L$对微分算子进行近似之后。

最后，我们分析一下公式\ref{10.62}的稳定性。由于我们处理的是一个广义的Galerkin类型的方法，我们将不得不求助于Strang Lemma 10.1。这保证了对于\ref{10.62}的解$u_{N}^{*}$，估计

!!!!
\left\|u_{N}^{*}\right\|_{V} \leq \frac{1}{\alpha^{*}} \sup _{v_{N} \in V_{N} \backslash\{0\}} \frac{\left|F_{N}\left(v_{N}\right)\right|}{\left\|v_{N}\right\|_{V}}
\label{10.68}\end{equation}

成立，$\alpha^{*}$是与离散双线性形式$a_{N}(\cdot, \cdot)$相关的（均匀）矫顽常数。我们将这个结果应用于问题\ref{10.59} ，首先计算$\alpha^{*}$ 。通过利用离散规范$\|\cdot\|_{N}$的定义\ref{10.53}和等价关系\ref{10.54}，我们有

!!!!
\begin{aligned}
a_{N}\left(u_{N}, u_{N}\right) &=\left(\left(1+x^{2}\right) u_{N}^{\prime}, u_{N}^{\prime}\right)_{N}+\left(\cos \left(x^{2}\right) u_{N}, u_{N}\right)_{N} \\
& \geq\left(u_{N}^{\prime}, u_{N}^{\prime}\right)_{N}+\cos (1)\left(u_{N}, u_{N}\right)_{N}=\left\|u_{N}^{\prime}\right\|_{N}^{2}+\cos (1)\left\|u_{N}\right\|_{N}^{2} \\
& \geq\left\|u_{N}^{\prime}\right\|_{\mathrm{L}^{2}(-1,1)}^{2}+\cos (1)\left\|u_{N}\right\|_{\mathrm{L}^{2}(-1,1)}^{2} \geq \cos (1)\left\|u_{N}\right\|_{V}^{2}
\end{aligned}
$$

此外，还利用了

!!!!
\begin{aligned}
\min _{j}\left(1+x_{j}^{2}\right) & \geq \min _{x \in[-1,1]}\left(1+x^{2}\right)=1 \\
\min _{j} \cos \left(x_{j}^{2}\right) & \geq \min _{x \in[-1,1]} \cos \left(x^{2}\right)=\cos (1)
\end{aligned}
$$

这使我们可以用数值$\cos (1)$来确定$\alpha^{*}$ 。在这一点上，我们可以评估$\left|F_{N}\left(v_{N}\right)\right| /\left\|v_{N}\right\|_{V}$在\ref{10.68}的商。事实上，我们有

!!!!
\begin{aligned}
&\left|F_{N}\left(v_{N}\right)\right|=\left|\left(f, v_{N}\right)_{N}+2 v_{N}(1)\right| \leq\|f\|_{N}\left\|v_{N}\right\|_{N}+2\left|v_{N}(1)\right| \\
&\leq \sqrt{3}\|f\|_{N}\left\|v_{N}\right\|_{V}+2\left|\int_{-1}^{1} v_{N}^{\prime}(x) d x\right| \leq \sqrt{3}\|f\|_{N}\left\|v_{N}\right\|_{V}+2 \sqrt{2}\left\|v_{N}\right\|_{V}
\end{aligned}
$$

再一次使用了等价性质\ref{10.54}以及考奇-施瓦茨不等式的离散\ref{10.52} 和连续\ref{3.7} 版本。因此我们可以得出以下结论

!!!!
\frac{\left|F_{N}\left(v_{N}\right)\right|}{\left\|v_{N}\right\|_{V}} \leq \sqrt{3}\|f\|_{N}+2 \sqrt{2}
$$

即返回到稳定性估计\ref{10.68}。

!!!!
\left\|u_{N}^{*}\right\|_{V} \leq \frac{1}{\cos (1)}\left[\sqrt{3}\|f\|_{N}+2 \sqrt{2}\right] .
$$

最后，我们注意到，$\|f\|_{N} \leq 2\|f\|_{C^{0}([-1,1])} \forall f \in C^{0}([-1,1])$ 。

\subsubsection{The SEM-NI method}

从问题\ref{10.59} 开始，我们现在要考虑它的SEM-NI公式，即在每个元素中使用GLL类型的积分公式的谱元公式。此外，我们建议提供一个基础的空间，在这个空间里将实施这样的公式。

我们首先介绍一个区间$(-1,1)$在$M(\geq 2)$不相交的子区间$\Omega_{m}=\left(\bar{x}_{m-1}, \bar{x}_{m}\right)$中的划分，用$m=1, \ldots, M$表示$h_{m}=\bar{x}_{m}-\bar{x}_{m-1}$第1个区间的宽度，并设定$h=\max _{m} h_{m}$ 。问题\ref{10.59}的SEM表述形式为

!!!!
\text { find } \quad u_{N} \in V_{N}^{C}: a\left(u_{N}, v_{N}\right)=F\left(v_{N}\right) \quad \forall v_{N} \in V_{N}^{C},
\label{10.69}\end{equation}

与

!!!!
V_{N}^{C}=\left\{v_{N} \in C^{0}([-1,1]):\left.v_{N}\right|_{\Omega_{m}} \in \mathbb{Q}_{N}, \forall m=1, \ldots, M, v_{N}(-1)=0\right\}
$$

我们注意到，SEM方法的函数空间$V_{N}^{C}$失去了 "全局 "的性质，而这正是SM公式的典型特征。与有限元近似的情况类似，我们现在有片状多项式函数。通过利用分区$\left\{\Omega_{m}\right\}$，我们可以用以下方式重写公式\ref{10.69}

!!!!
\text { find } \quad u_{N} \in V_{N}^{C}: \sum_{m=1}^{M} a_{\Omega_{m}}\left(u_{N}, v_{N}\right)=\sum_{m=1}^{M} F_{\Omega_{m}}\left(v_{N}\right) \quad \forall v_{N} \in V_{N}^{C}
\label{10.70}\end{equation}

其中

!!!!
\begin{aligned}
a_{\Omega_{m}}\left(u_{N}, v_{N}\right) &=\left.a\left(u_{N}, v_{N}\right)\right|_{\Omega_{m}} \\
&=\int_{x_{m-1}}^{\bar{x}_{m}}\left(1+x^{2}\right) u_{N}^{\prime}(x) v_{N}^{\prime}(x) d x+\int_{x_{m-1}}^{\bar{x}_{m}} \cos \left(x^{2}\right) u_{N}(x) v_{N}(x) d x
\end{aligned}
$$

而

!!!!
F_{\Omega_{m}}\left(v_{N}\right)=\left.F\left(v_{N}\right)\right|_{\Omega_{m}}=\int_{x_{m-1}}^{\bar{x}_{m}} f(x) v_{N}(x) d x+2 v_{N}(1) \delta_{m M}
$$

在这一点上，SEM-NI的表述可以通过在\ref{10.70}中用离散的GLL标量积\ref{10.25}来接近连续标量积得到。

!!!!
\text { find } u_{N}^{*} \in V_{N}^{C}: \sum_{m=1}^{M} a_{N, \Omega_{m}}\left(u_{N}^{*}, v_{N}\right)=\sum_{m=1}^{M} F_{N, \Omega_{m}}\left(v_{N}\right) \quad \forall v_{N} \in V_{N}^{C},
$$

其中

!!!!
\begin{gathered}
a_{N, \Omega_{m}}(u, v)=\left(\left(1+x^{2}\right) u^{\prime}, v^{\prime}\right)_{N, \Omega_{m}}+\left(\cos \left(x^{2}\right) u, v\right)_{N, \Omega_{m}} \\
F_{N, \Omega_{m}}(v)=(f, v)_{N, \Omega_{m}}+2 v(1) \delta_{m M} \\
(u, v)_{N, \Omega_{m}}=\sum_{i=0}^{N} u\left(x_{i}^{(m)}\right) v\left(x_{i}^{(m)}\right) \alpha_{i}^{(m)}
\end{gathered}
$$

$x_{i}^{(m)}$是子区间$\Omega_{m}$的第$i$个GLL节点，$\alpha_{i}^{(m)}$是相应的积分权重。

从参考元素$\widehat{\Omega}=(-1,1)$开始（在所考察的情况下，它与问题\ref{10.59} 的域$\Omega$重合），并调用

!!!!
\varphi_{m}(\xi)=\frac{h_{m}}{2} \xi+\frac{\bar{x}_{m}+\bar{x}_{m-1}}{2}, \quad \xi \in[-1,1]
$$

从$\widehat{\Omega}$到$\Omega_{m}$的仿射图，对于$m=1, \ldots, M$，我们将得到

!!!!
x_{i}^{(m)}=\varphi_{m}\left(x_{i}\right), \quad \alpha_{i}^{(m)}=\frac{h_{m}}{2} \alpha_{i}, \quad i=0, \ldots, N
\label{10.71}\end{equation}

即$x_{i}^{(m)}$是$\varphi_{m}$的第i个GLL节点的图像，通过映射$\widehat{\Omega}$ 。

我们在每个$\Omega_{m}$上引入$\left\{\psi_{i}^{(m)}\right\}_{i=0}^{N}$的基础函数集，以便

!!!!
\psi_{i}^{(m)}(x)=\psi_{i}\left(\varphi_{m}^{-1}(x)\right) \quad \forall x \in \Omega_{m}
$$

$\psi_{i}$是\ref{10.12}和\ref{10.13}中引入的与$\widehat{\Omega}$中GLL的节点$x_{i}$相关的特征多项式。现在有了每个子区间$\Omega_{m}$的基础，我们可以把每个$\Omega_{m}$上的SEM的解$u_{N}$写为

!!!!
u_{N}(x)=\sum_{i=0}^{N} u_{i}^{(m)} \psi_{i}^{(m)}(x) \quad \forall x \in \Omega_{m}
\label{10.72}\end{equation}

其中$u_{i}^{(m)}=u_{N}\left(x_{i}^{(m)}\right)$ 。

由于我们想为空间$V_{N}^{C}$定义一个全局基础，我们首先定义与$\Omega_{m}$的内部节点相关的基函数，用于$m=1, \ldots, M$。为此，只需在$\Omega_{m}$之外，对每个基函数$\psi_{i}^{(m)}$进行琐碎的扩展，就可以得到以下结果

!!!!
\widetilde{\psi}_{i}^{(m)}(x)= \begin{cases}\psi_{i}^{(m)}(x), & x \in \Omega_{m} \\ 0, & \text { otherwise }\end{cases}
$$

总的来说，这些是$(N-1) M$函数，其行为如图10.12所示。对于$\Omega_{m}$子域的每个末端节点$\bar{x}_{m}$，以$m=1, \ldots, M-1$代替，我们定义基函数

!!!!
\psi_{m}^{*}(x)= \begin{cases}\psi_{N}^{(m)}(x), & x \in \Omega_{m} \\ \psi_{0}^{(m+1)}(x), & x \in \Omega_{m+1} \\ 0, & \text { otherwise }\end{cases}
$$

通过 "粘贴"$\psi_{N}^{(m)}$和$\psi_{0}^{(m+1)}$得到（见图10.13）。特别是，我们观察到$\psi_{0}^{*}$是不需要的，因为在$\bar{x}_{0}=-1$处分配了一个同质的迪里希特条件，而我们需要$\psi_{M}^{*}$，我们用$\psi_{N}^{(M)}$表示。因此，通过选择

![](https://cdn.mathpix.com/cropped/10058ab4e7f0c5bd6fe5bcd4db204623-260.jpg?height=164&width=603&top_left_y=113&top_left_x=153)

图10.12. 与内部节点$x_{i}^{(m)}$相关的基函数$\widetilde{\psi}_{i}^{(m)}$。

![](https://cdn.mathpix.com/cropped/10058ab4e7f0c5bd6fe5bcd4db204623-260.jpg?height=198&width=719&top_left_y=333&top_left_x=95)

图10.13. 与内部节点$\bar{x}_{m}$相关的基函数$\psi_{m}^{*}$。

如果在$\Omega$的两个端点上应用迪里希特条件，我们就会有$(M-1)$函数$\left.\psi_{m}^{*}, m=1, \ldots, M-1 .\right)$ 。

因此，我们总共有$n=(N-1) M+M$个空间的基础函数$V_{N}^{C}$。然后每个函数$u_{N} \in V_{N}^{C}$可以用以下方式表示

!!!!
u_{N}(x)=\sum_{m=1}^{M} u_{m}^{\Gamma} \psi_{m}^{*}(x)+\sum_{m=1}^{M} \sum_{i=1}^{N-1} u_{i}^{(m)} \widetilde{\psi}_{i}^{(m)}(x)
$$

与$u_{m}^{\Gamma}=u_{N}\left(\bar{x}_{m}\right)$和$u_{i}^{(m)}$一样定义于\ref{10.72} 。这样一来，迪里希特边界条件得到了尊重。

\subsection{Spectral methods on triangles and tetrahedra}

正如我们所看到的，在二维的四边形（或三维的平行四边形）上使用光谱方法是通过使用一维函数的张量积（在参考区间$[-1,1])$上）和一维的高斯数值积分公式而实现的。然而，从几年前开始，我们见证了对光谱型方法在不具有张量积结构的几何体上的使用兴趣的增长，例如，$2 \mathrm{D}$中的三角形和$3 \mathrm{D}$中的四面体、棱镜或金字塔。

我们简要介绍一下Dubiner的开创性想法[Dub91]，即引入三角形上的高阶多项式基，后来在$[\mathrm{KS} 05]$中扩展到三维的情况。
 ![](https://cdn.mathpix.com/cropped/10058ab4e7f0c5bd6fe5bcd4db204623-261.jpg?height=262&width=548&top_left_y=119&top_left_x=176)

图10.14.参考三角形$\widehat{T}$转换为参考正方形$\widehat{Q}$ 。斜线段被转换为垂直线段

我们考虑参考三角形

!!!!
\widehat{T}=\left\{\left(x_{1}, x_{2}\right) \in \mathbb{R}^{2}:-1<x_{1}, x_{2} ; x_{1}+x_{2}<0\right\}
$$

和参考平方

!!!!
\widehat{Q}=\left\{\left(\xi_{1}, \xi_{2}\right) \in \mathbb{R}^{2}:-1<\xi_{1}, \xi_{2}<1\right\}
$$

转变

!!!!
\left(x_{1}, x_{2}\right) \rightarrow\left(\xi_{1}, \xi_{2}\right), \quad \xi_{1}=2 \frac{1+x_{1}}{1-x_{2}}-1, \quad \xi_{2}=x_{2}
\label{10.73}\end{equation}

是$\widehat{T}$和$\widehat{Q}$之间的一个双射。它的逆向是由

!!!!
\left(\xi_{1}, \xi_{2}\right) \rightarrow\left(x_{1}, x_{2}\right), \quad x_{1}=\frac{1}{2}\left(1+\xi_{1}\right)\left(1-\xi_{2}\right)-1, \quad x_{2}=\xi_{2}
$$

如图10.14所示，映射$\left(x_{1}, x_{2}\right) \rightarrow\left(\xi_{1}, \xi_{2}\right)$将$\widehat{T}$中的射线从顶点$(-1,1)$发出，经过点$\left(x_{1},-1\right)$，送到方程$\xi_{1}=x_{1}$的垂直段。因此，后者在$(-1,1)$中成为单数。由于这个原因，我们称$\left(\xi_{1}, \xi_{2}\right)$为坐标为$\left(x_{1}, x_{2}\right)$的三角形的点的折叠直角坐标。我们用$\left\{J_{k}^{(\alpha, \beta)}(\xi), k \geq 0\right\}$表示雅可比多项式家族，该家族相对于权重$w(\xi)=(1-\xi)^{\alpha}(1+\xi)^{\beta}$是正交的，对于$\alpha, \beta \geq 0$。因此。

!!!!
\forall k \geq 0, \quad J_{k}^{(\alpha, \beta)} \in \mathbb{P}_{k} \quad \text { and } \quad \int_{-1}^{1} J_{k}^{(\alpha, \beta)}(\xi) J_{m}^{(\alpha, \beta)}(\xi) w(\xi) d \xi=0 \quad \forall m \neq k
\label{10.74}\end{equation}

我们观察到，对于$\alpha=\beta=0, J_{k}^{(0,0)}$与$k$-次Legendre多项式$L_{k}$重合 对于每一对整数$\mathbf{k}=\left(k_{1}, k_{2}\right)$，我们在$\widehat{Q}$上定义所谓翘曲张量基础

!!!!
\Phi_{\mathbf{k}}\left(\xi_{1}, \xi_{2}\right)=\Psi_{k_{1}}\left(\xi_{1}\right) \Psi_{k_{1}, k_{2}}\left(\xi_{2}\right)
\label{10.75}\end{equation}

与$\Psi_{k_{1}}\left(\xi_{1}\right)=J_{k_{1}}^{(0,0)}\left(\xi_{1}\right)$和$\Psi_{k_{1}, k_{2}}\left(\xi_{2}\right)=\left(1-\xi_{2}\right)^{k_{1}} J_{k_{2}}^{\left(2 k_{1}+1,0\right)}\left(\xi_{2}\right)$ 。请注意，$\Phi_{\mathbf{k}}$是$\xi_{1}$中的$k_{1}$度的多项式，$k_{1}+k_{2}$是$\xi_{2}$中的多项式。通过现在应用映射\ref}{10.73}，我们发现以下函数定义在$\widehat{T}$上

!!!!
\varphi_{\mathbf{k}}\left(x_{1}, x_{2}\right)=\Phi_{\mathbf{k}}\left(\xi_{1}, \xi_{2}\right)=J_{k_{1}}^{(0,0)}\left(2 \frac{1+x_{1}}{1-x_{2}}-1\right)\left(1-x_{2}\right)^{k_{1}} J_{k_{2}}^{\left(2 k_{1}+1,0\right)}\left(x_{2}\right)
\label{10.76}\end{equation}

这是一个在变量$x_{1}, x_{2}$中总度为$k_{1}+k_{2}$的多项式，即$\varphi_{\mathrm{k}} \in \mathbb{P}_{k_{1}+k_{2}}(\widehat{T})$ 。雅可比多项式\ref{10.74} 的正交性，对于每个$m \neq k$，可以证明

!!!!
\begin{aligned}
&\int_{\widehat{T}} \varphi_{\mathbf{k}}\left(x_{1}, x_{2}\right) \varphi_{\mathbf{m}}\left(x_{1}, x_{2}\right) d x_{1} d x_{2}=\frac{1}{2}\left(\int_{-1}^{1} J_{k_{1}}^{(0,0)}\left(\xi_{1}\right) J_{m_{1}}^{(0,0)}\left(\xi_{1}\right) d \xi_{1}\right) \\
&\quad\left(\int_{-1}^{1} J_{k_{2}}^{\left(2 k_{1}+1,0\right)}\left(\xi_{2}\right) J_{m_{2}}^{\left(2 m_{1}+1,0\right)}\left(\xi_{2}\right)\left(1-\xi_{2}\right)^{k_{1}+m_{1}+1} d \xi_{2}\right)=0
\end{aligned}
\label{10.77}\end{equation}

因此，$\left\{\varphi_{\mathrm{k}}: 0 \leq k_{1}, k_{2}, k_{1}+k_{2} \leq N\right\}$构成多项式空间$\mathbb{P}_{N}(\widehat{T})$的正交（模态）基础，其维度为$\frac{1}{2}(N+1)(N+2)$。

正交属性无疑是很方便的，因为它允许对质量矩阵进行对角化处理（见第5章）。然而，对于上述模态基础，施加边界条件（如果计算域是三角形$\widehat{T}$），以及满足元素间的连续性条件（如果使用三角元素的谱元方法）的结果是不舒服的。一个可能的补救办法是通过生成一个新的基础来适应这种基础，我们将用$\left\{\varphi_{\mathbf{k}}^{b a}\right\} ;$ba来表示边界适应。为了得到它，我们将首先用$\alpha=0$或$\left.2 k+1\right)$取代一维雅可比基$J_{k}^{(\alpha, 0)}(\xi)$，用适应的基来构成。

- 两个边界函数。  $\frac{1+\xi}{2}$ 和 $\frac{1-\xi}{2}$ 。

- $(N-1)$ 泡沫函数。  $\left(\frac{1+\xi}{2}\right)\left(\frac{1-\xi}{2}\right) J_{k-2}^{(\alpha, \beta)}(\xi), k=2, \ldots, N$ ，用于合适的固定 $\alpha, \beta \geq 1$ 。

然后像\ref{10.75}中那样使用这些一维基数来代替非适应性的雅可比多项式。这样，我们就可以找到顶点型、边缘型和气泡型函数。确切地说。

- 顶点型函数。

!!!!
\begin{array}{ll}
\Phi^{V_{1}}\left(\xi_{1}, \xi_{2}\right)=\left(\frac{1-\xi_{1}}{2}\right)\left(\frac{1-\xi_{2}}{2}\right) & \left(\text { vertex } V_{1}=(-1,-1)\right), \\
\Phi^{V_{2}}\left(\xi_{1}, \xi_{2}\right)=\left(\frac{1+\xi_{1}}{2}\right)\left(\frac{1-\xi_{2}}{2}\right) & \left(\text { vertex } V_{2}=(1,-1)\right), \\
\Phi^{V_{3}}\left(\xi_{1}, \xi_{2}\right)=\frac{1+\xi_{2}}{2} & \left(\text { vertex } V_{3}=(-1,1)\right) ;
\end{array}
$$


![](https://cdn.mathpix.com/cropped/10058ab4e7f0c5bd6fe5bcd4db204623-263.jpg?height=998&width=562&top_left_y=116&top_left_x=175)

图10.15.度数为$N=5$的基函数：正方形（从上往下第一个）和三角形（从上往下第二个）上与数值$\beta=1$和$\delta=0$相关的边界适应基；正方形（从下往上第二个）上的雅可比基$J_{k}^{(\alpha, \beta)}$对应数值$\alpha=\beta=0$（Legendre情况）；三角形（底部）上的Dubiner基函数$\left\{\Phi_{\mathbf{k}}\right\}$ -边缘型函数。

!!!!
\begin{array}{ll}
\Phi_{K_{1}}^{V_{1} V_{2}}\left(\xi_{1}, \xi_{2}\right)=\left(\frac{1-\xi_{1}}{2}\right)\left(\frac{1+\xi_{1}}{2}\right) J_{k_{1}-2}^{(\beta, \beta)}\left(\xi_{1}\right)\left(\frac{1-\xi_{2}}{2}\right)^{k_{1}}, & 2 \leq k_{1} \leq N \\
\Phi_{K_{2}}^{V_{1} V_{3}}\left(\xi_{1}, \xi_{2}\right)=\left(\frac{1-\xi_{1}}{2}\right)\left(\frac{1-\xi_{2}}{2}\right)\left(\frac{1+\xi_{2}}{2}\right) J_{k_{2}-2}^{(\beta, \beta)}\left(\xi_{2}\right), & 2 \leq k_{2} \leq N \\
\Phi_{K_{2}}^{V_{2} V_{3}}\left(\xi_{1}, \xi_{2}\right)=\left(\frac{1+\xi_{1}}{2}\right)\left(\frac{1-\xi_{2}}{2}\right)\left(\frac{1+\xi_{2}}{2}\right) J_{k_{2}-2}^{(\beta, \beta)}\left(\xi_{2}\right), & 2 \leq k_{2} \leq N
\end{array}
$$

- 泡沫型功能。

!!!!
\begin{aligned}
&\Phi_{k_{1}, k_{2}}^{\beta}\left(\xi_{1}, \xi_{2}\right)=\left(\frac{1-\xi_{1}}{2}\right)\left(\frac{1+\xi_{1}}{2}\right) J_{k_{1}-2}^{(\beta, \beta)}\left(\xi_{1}\right) \\
&\left(\frac{1-\xi_{2}}{2}\right)^{k_{1}}\left(\frac{1+\xi_{2}}{2}\right) J_{k_{2}-2}^{\left(2 k_{1}-1+\delta, \beta\right)}\left(\xi_{2}\right) \\
&2 \leq k_{1}, k_{2}, k_{1}+k_{2} \leq N
\end{aligned}
$$

尽管选择$\beta=\delta=2$可以保证气泡函数的正交性，但通常我们更倾向于选择$\beta=1, \delta=0$，它可以保证质量和刚度矩阵的良好稀疏性，以及二阶微分算子的刚度矩阵的可接受条件数。

在图10.15中，我们报告了一些对应于$\beta$和$\delta$的不同选择以及不同的度数$N$的三角形上的基数的例子。

利用这些模态基础，我们现在可以为三角形$\widehat{T}$上的边界值问题集建立一个频谱Galerkin近似法，或者在以三角形元素划分的域$\Omega$上建立一个SEM型方法。我们请感兴趣的读者参考[CHQZ06, CHQZ07, KS05]。

\subsection{ $10.7$ 练习}。

1.证明不等式 \ref{10.52} 。

2.证明属性 \ref{10.54} 。

3.写出问题的弱表述

!!!!
\left\{\begin{array}{l}
-\left((1+x) u^{\prime}(x)\right)^{\prime}+u(x)=f(x), \quad 0<x<1 \\
u(0)=\alpha, \quad u(1)=\beta
\end{array}\right.
$$

以及用G-NI方法对其进行离散化后得到的线性系统。

4.对问题进行近似分析

!!!!
\left\{\begin{array}{l}
-u^{\prime \prime}(x)+u^{\prime}(x)=x^{2}, \quad-1<x<1 \\
u(-1)=1, \quad u^{\prime}(1)=0
\end{array}\right.
$$

使用G-NI方法，并分析其稳定性和收敛性。

5.写出该问题的G-NI近似值

!!!!
\left\{\begin{array}{l}
L u(x)=-\left(\mu(x) u^{\prime}(x)\right)^{\prime}+(b(x) u(x))^{\prime}+\sigma(x) u(x)=f(x), \quad-1<x<1 \\
\mu(\pm 1) u^{\prime}(\pm 1)=0
\end{array}\right.
$$

找出数据上的条件，在这些条件下，伪频谱近似是稳定的。此外，验证以下关系是否成立。

!!!!
\begin{aligned}
&L_{N} u_{N}\left(x_{j}\right)=f\left(x_{j}\right), \quad j=1, \ldots, N-1 \\
&\mu(1) u_{N}^{\prime}(1)=\alpha_{N}\left(f-L_{N} u_{N}\right)(1) \\
&\mu(-1) u_{N}^{\prime}(-1)=-\alpha_{0}\left(f-L_{N} u_{N}\right)(-1)
\end{aligned}
$$

$L_{N}$ 是在 \ref{10.41} 中定义的伪谱算子。

6.考虑问题

!!!!
\begin{cases}-\mu \Delta u+\mathbf{b} \cdot \nabla u-\sigma u=f & \text { in } \Omega=(-1,1)^{2} \\ u(\mathbf{x})=u_{0} & \text { for } x_{1}=-1 \\ u(\mathbf{x})=u_{1} & \text { for } x_{1}=1 \\ \nabla u(\mathbf{x}) \cdot \mathbf{n}(\mathbf{x})=0 & \text { for } x_{2}=-1 \text { and } x_{2}=1\end{cases}
$$

其中$\mathbf{x}=\left(x_{1}, x_{2}\right)^{T}, \mathbf{n}$是$\Omega, \mu=\mu(\mathbf{x}), \mathbf{b}=\mathbf{b}(\mathbf{x}), \sigma=\sigma(\mathbf{x})$的外向法线，$f=f(\mathbf{x})$是分配的函数，$u_{0}, u_{1}$是给定的常数。

提供数据的充分条件以保证弱解的存在和唯一性，并给出先验估计。然后用G-NI方法对弱问题进行近似，提供其稳定性和收敛性的分析。

7.证明方程\ref{5.4} 的伪谱近似情况下的稳定性条件\ref{10.42} （用$(0,1)$代替区间$(-1,1)$）。

[解决方案：遵循与第$5.4$节中解释的有限元解决方案类似的程序，并援引定理$10.2$和10.3中报告的属性。  $5.4$中解释的有限元求解的类似程序，并援引定理$10.2$和10.3中报告的特性。]

8.考虑抛物线热方程

!!!!
\begin{cases}\frac{\partial u}{\partial t}-\frac{\partial^{2} u}{\partial x^{2}}=0, & -1<x<1, t>0 \\ u(x, 0)=u_{0}(x), & -1<x<1 \\ u(-1, t)=u(1, t)=0, & t>0\end{cases}
$$

在空间上使用G-NI方法和在时间上使用隐式欧拉方法对其进行近似，并对其稳定性进行研究。第十一章

\section{Isogeometric analysis}

等距分析--通常缩写为IGA--是一种基于所谓等距概念的PDE空间近似策略。从2005年T.J.R.Hughes和合作者[HCB05]的开创性工作开始，IGA在过去几年中得到了广泛的发展，最初的目的是恢复计算域的几何表示在PDEs的数值逼近中的核心地位。IGA的开发是为了弥补目前计算机辅助设计（CAD）程序和PDEs计算建模之间的差距（如第8.1节所述），它认识到计算域的网格划分程序确实是工程实践中的一个主要瓶颈。由于CAD系统大多采用B-splines或NURBS[dB01, PT97]的基础函数来表示计算域，IGA考虑用同样的B-splines或NURBS基础来构建PDEs的近似解的有限维空间；这种策略通常被称为基于NURBS的IGA[CHB09, HCB05]。其他更普遍或更灵活的基于花键的几何表示法，如T-花键、局部细化花键等。[BCC $^{+} 10$ , BCS10, SBV $^{+} 11$ , SLSH12, SZBN03, TSHH17], 都可以用于IGA，即使它们的开发和使用仍然不是直接的，并且代表了活跃的研究领域。

虽然IGA发展的原始驱动因素是整个设计-分析计算管道的效率与计算域的几何精度--即 "精确性"--并行，但B-splines和NURBS基函数的使用特别适合于几个PDE家族的空间逼近，这也是由于这些基函数的规则性特性。

最广泛的IGA构造是Galerkin方法框架下基于NURBS的IGA[CHB09, EBBH09, HCB05]。我们请感兴趣的读者参考例如$\left[\mathrm{ABC}^{+} 08\right.$, ABBS17, ABKF11, BBHH10, BCZH06, BHS12, BSV14, BVS $^{+} 12$, CHR07, DBH12, DCV $^{+} 16$, dFRV11, GCBH08, $\left.S D S^{+} 12, Z B G^{+} 07\right]$ 以了解计算力学问题的应用概况，这个列表远非详尽。

在这一章中，我们从B-splines和NURBS基函数和几何形状的定义、等距概念、Galerkin方法以及该方法的近似特性出发，对Galerkin方法框架下基于NURBS的IGA进行了简要概述。

\subsection{B-splines and NURBS}

B-splines和NURBS(Non Rational Uniform B-splines)--Bsplines的泛化--在CAD中被广泛使用。B-splines是一个特殊的花键函数家族--由分片多项式构成--在给定的多项式程度下具有最小的支持。

\subsubsection{B-splines basis functions}

单变量B-splines基函数是在参数域$\widehat{\Omega} \subset \mathbb{R}$上建立的，从所谓的结向量$\Xi$开始，这是参数空间$\mathbb{R}$中的一组非递减实值。具体来说，$\Xi=\left\{\widehat{\xi}_{1}, \widehat{\xi}_{2}, \ldots, \hat{\xi}_{n+p+1}\right\}$ ，其中$\widehat{\xi}_{i}$为$i=1, \ldots, n+p+1$的第1个结，$n$为组成B-splines基的基函数数，$p \geq 0$为多项式程度；以这种方式，参数域$\Omega$读为$\widehat{\Omega}=\left(\widehat{\xi}_{1}, \widehat{\xi}_{n+p+1}\right)$ 。如$\widehat{\xi}_{1} \leq \widehat{\xi}_{2} \leq \cdots \leq \hat{\xi}_{n+p+1}$ ，结可以重复，对于每个结值$m_{j} \geq 1$关联的倍数$j=1, \ldots, \tilde{n}$，对于一些$\tilde{n} \leq n+p+1$；根据惯例，每个结值的倍数是$1 \leq m_{j} \leq p+1$。特别是，我们考虑开放结向量的情况，对于这种情况，$\Xi$中第一个和最后一个结值的倍数是$m_{1}=m_{\tilde{n}}=p+1$ 。成对的结在$\widehat{\Omega}$中限定了结的跨度$\left(\widehat{\xi}_{i}, \widehat{\xi}_{i+1}\right)$，特别是对于$i=1, \ldots, n+p ;$，在结值的倍数为$m_{j} \geq 1$的情况下，构造允许结的跨度为空。对于开放的结向量，内部的结跨度为$\widehat{\Omega}$，即$\left\{\left(\widehat{\xi}_{i}, \widehat{\xi}_{i+1}\right)\right\}_{i=p+1}^{n}$，可以解释为网格元素的数量为$n_{e l}$；那么，在这种网格元素的数量、基础函数的数量和多项式程度之间有$n=n_{e l}+p$的关系。最后，我们用$\widehat{h}$表示划分$\widehat{\Omega}$的元素的特征网格尺寸。

对于一个给定的结向量$\Xi=\left\{\widehat{\xi}_{1}, \widehat{\xi}_{2}, \ldots, \widehat{\xi}_{n+p+1}\right\}$，单变量$\mathrm{B}-$花键基础函数$\widehat{N}_{i}: \widehat{\Omega} \rightarrow \mathbb{R}$，对于$i=1, \ldots, n$，是通过Cox-de Boor递归公式[PT97]建立的程度为$p$的分片多项式。

!!!!
\begin{aligned}
&\widehat{N}_{i, 0}(\xi)= \begin{cases}1 & \text { for } \xi \in\left[\widehat{\xi}_{i}, \widehat{\xi}_{i+1}\right) \\
0 & \text { otherwise }\end{cases} \\
&\widehat{N}_{i, k}(\xi)=\frac{\xi-\widehat{\xi}_{i}}{\widehat{\xi}_{i+k}-\widehat{\xi}_{i}} \widehat{N}_{i, k-1}(\xi)+\frac{\widehat{\xi}_{i+1}-\xi}{\widehat{\xi}_{i+k+1}-\widehat{\xi}_{i+i}} \widehat{N}_{i+1, k-1}(\xi) \quad \text { for } k=1, \ldots p
\end{aligned}
$$

当比率$\frac{0}{0}$出现在上述公式中时，按照惯例，它被替换为0。为了简单起见，我们把基函数$\widehat{N}_{i, p}(\xi)$简单地表示为$\widehat{N}_{i}(\xi)$，对度数$p$的依赖性可以理解。B-splines的属性是由结点向量$\Xi$唯一确定的，包括它们的数目$n$和度数$p$，以及它们的支持度和规则性，它们与结点值的倍数严格相关。特别是，每个基函数$\widehat{N}_{i}$在$p+1$结跨度中都有支持，无论其大小如何；此外，$p+1$基函数在每个结跨度（或网格元素）中都有支持。B-splines的基函数是正定的，具体来说，对于所有的$\xi \in \widehat{\Omega}$都有$\widehat{N}_{i}(\xi) \geq 0$，对于任何$i=1, \ldots, n ;$都有，此外，它们构成一个统一的分区，即对于所有的$\xi \in \widehat{\Omega}$有$\sum_{i=1}^{n} \widehat{N}_{i}(\xi) \equiv 1$。B-splines的基函数是片状多项式，因此它们在每个结点跨度（网元）中是$C^{\infty}$ -连续的，但在每个结点的倍数值上只是$C^{p-m}$ -连续的 $m \geq 1$ 。这最后一个属性在基于NURBS的IGA中被广泛利用，因为它是这些基础函数所特有的。例如，度数为 $p=1$ 的 B-splines 在 $C^{0}-$ 的每个网格元素（内部结点值）上都是连续的。度数为$p=2$的基函数，根据相关内部结值的倍数$m=2$或$m=1$，分别在整个网格元素中连续。一般来说，度数为$p$的基函数是$C^{0}-, C^{1}-, \ldots$，或$C^{p-1}-$跨网元连续的，分别取决于相关结值的倍数$m=p, p-1, \ldots, 1$。图11.1中报告了单变量B-splines基函数的例子。

通过张量积规则建立维数为$\kappa \geq 1$的双变量、三变量以及一般的多变量B-splines基础函数。结向量$\Xi^{\alpha}=\left\{\widehat{\xi}_{1} \alpha\right.$/left。$\widehat{\xi}_{2} \alpha, \ldots, \widehat{\xi}_{n_{\alpha}+p_{\alpha}+1}^{\alpha}\right\}$为每个参数方向$\alpha=1, \ldots, \kappa$定义，$n_{\alpha}$和$p_{\alpha}$为相应的基函数数量和程度；然后，单变量B-splines基函数$\widehat{N}_{i}^{\alpha}: \widehat{\Omega} \rightarrow \mathbb{R}$由每个结向量$\Xi^{\alpha}$单独建立，用于$\alpha=$ $1, \ldots, \kappa$ 。通过使用结向量的张量组合，参数域为$\widehat{\Omega}=\otimes_{\alpha=1}^{\kappa}\left(\widehat{\xi}_{1}^{\alpha}, \widehat{\xi}_{n_{\alpha}+p_{\alpha+1}}^{\alpha}\right) \subset \mathbb{R}^{\kappa}$，网格元素为$\otimes_{\alpha=1}^{\kappa}\left(\widehat{\xi}_{i_{\alpha}}^{\alpha}, \widehat{\xi}_{i_{\alpha}+1}^{\alpha}\right) \subset$ $\mathbb{R}^{\kappa}$ ，其特征网格大小用$\widehat{h}$表示。通过对一些$1 \leq i_{\alpha} \leq n_{\alpha}$和$1 \leq \alpha \leq \kappa$引入多指数$\mathbf{i}=\left(i_{1}, \ldots, i_{\kappa}\right)$，利用张量积规则建立多变量B-splines基函数$\widehat{N}_{\mathbf{i}}: \widehat{\Omega} \rightarrow \mathbb{R}$，即为

!!!!
\widehat{N}_{\mathbf{i}}(\xi)=\prod_{\alpha=1}^{\kappa} \widehat{N}_{i \alpha}^{\alpha}\left(\xi^{\alpha}\right)
$$

其中 $\xi=\left(\xi^{1}, \ldots, \xi^{\kappa}\right) \in \widehat{\Omega}$ 。多变量 $\mathrm{B}-$ 花键基础函数的总数为 $n=\prod_{\alpha=1}^{\kappa} n_{\alpha}$ ；通过假设适当的重新排序，此后放弃多指数符号，而采用标量符号，对于 $i=1, \ldots, n$ 的多变量B-splines表示为 $\widehat{N}_{i}: \widehat{\Omega} \rightarrow \mathbb{R}$ 。在这个阶段，我们简单地回顾一下，多变量B-splines的基函数是正的，并且在 $\Omega$ 中仍然形成一个统一的分区。关于这些基函数在整个网格元素边缘的支持度和规则性的特性，这些都是继承自沿每个参数方向的独立单变量基函数 $\alpha=1, \ldots, \kappa$ ，它们是由这些基函数构建的。
 ![](https://cdn.mathpix.com/cropped/10058ab4e7f0c5bd6fe5bcd4db204623-269.jpg?height=1026&width=712&top_left_y=129&top_left_x=100)

图 11.1.单变量B-splines基函数的例子；结向量$\Xi$、度数$p$、元素数$n_{e l}$、基函数数$n$和全局连续性$C^{k}$都被标明。

\subsubsection{B-splines curves, surfaces, and solids}

B-splines的几何形状是作为从参数空间$\widehat{\Omega}$的参数域$\mathbb{R}^{\kappa}\left(\widehat{\Omega} \subset \mathbb{R}^{\kappa}\right)$到物理空间$\mathbb{R}^{d}$的几何映射得到的，其中$1 \leq$ $\kappa \leq d$ 。例如，对于$\kappa=1$和$d=3$，可以得到三维的曲线，对于$\kappa=2$和$d=3$是一个表面，而对于$\kappa=d=3$是一个实体物体。除了从B-splines基函数$\left\{\widehat{N}_{i}(\xi)\right\}_{i=1}^{n}$，从结点向量$\Xi^{\alpha}$获得的$\alpha=1, \ldots, \kappa, \mathrm{B}-$花键几何体是由控制点$\left\{\mathbf{P}_{i}\right\}_{i=1}^{n} \in \mathbb{R}^{d}$，一组物理空间中的点建立的。每个控制点都与一个B-splines基函数相关。控制点根据张量积规则进行相应的排序，这种构造在 $\mathbb{R}^{d}$ 中确定了所谓的控制多边形。然后，B-splines的几何形状由几何映射$\phi: \widehat{\Omega} \rightarrow \mathbb{R}^{d}$确定，与$\phi: \xi \mapsto \mathbf{x}$相比，为

!!!!
\phi(\xi)=\sum_{i=1}^{n} \mathbf{P}_{i} \widehat{N}_{i}(\xi)
\label{11.1}\end{equation}

它定义了物理域 $\Omega$ ，确定了物理空间 $\mathbb{R}^{d}$ 中的几何图形。我们在图$11.2$和$11.3$中说明了一些B-splines几何图形的例子。

除控制点在物理空间中的位置外，B-splines几何的规则性属性继承于它们所建立的B-splines基函数的规则性。我们注意到，即使B-splines基函数只是$\Omega$连续的，也可以通过对控制点位置的特殊选择获得$C^{0}$的平滑图形表示，这被称为（高阶）几何连续性。然而，控制点位置的特定选择可能导致退化的几何连续性。

![](https://cdn.mathpix.com/cropped/10058ab4e7f0c5bd6fe5bcd4db204623-270.jpg?height=298&width=455&top_left_y=802&top_left_x=212)

图11.2.从$2 \mathrm{D}(\kappa=1$和$d=2)$中得到的B-splines曲线--由结点矢量$\Xi=\left\{\{0\}^{3}, 1 / 4,1 / 2,3 / 4,\{1\}^{3}\right\}$和控制点$\mathbf{P}_{1}=(1,0)^{T}, \mathbf{P}_{2}=(1 / 2,1)^{T}, \mathbf{P}_{3}=(0,1)^{T}, \mathbf{P}_{4}=(-3 / 4,1 / 2)^{T}, \mathbf{P}_{5}=(-1,0)^{T}$和$\mathbf{P}_{6}=(0,-1 / 4)^{I}$建立的阶梯式基函数。控制点和控制多边形以红色突出显示。

![](https://cdn.mathpix.com/cropped/10058ab4e7f0c5bd6fe5bcd4db204623-271.jpg?height=341&width=435&top_left_y=137&top_left_x=236)

图11.3.从$3 \mathrm{D}(\kappa=2$和$d=3)$的双变量B-splines基函数中得到的B-splines表面。这些是由与结点向量$\Xi^{1}=\left\{\{0\}^{2},\{1\}^{2}\right\}$和$\Xi^{2}=\left\{\{0\}^{3}, \frac{1}{2},\{1\}^{3}\right\}$相关的单变量B-splines建立的，分别具有1度和2度。控制点是$\mathbf{P}_{1}=(1,0,0)^{T}, \mathbf{P}_{2}=(1 / 2,1 / 4,0)^{T}, \mathbf{P}_{3}=(1 / 4,1 / 2,0)^{T}$，和$\mathbf{P}_{4}=(0,1,0)^{T}$，而$\mathbf{P}_{5}=(3 / 2,0,0)^{T}, \mathbf{P}_{6}=(5 / 4,3 / 4,1)^{T}, \mathbf{P}_{7}=!!!!(3 / 4,5 / 4,1)^{T}$，和$\mathbf{P}_{8}=(0,3 / 2,0)^{T}$沿参数方向$\alpha=2$。控制点和控制多边形以红色突出显示。

然而，我们在本章中不考虑这些计量表示 [PT97] 。

\subsubsection{NURBS basis functions and geometries}

基于B-splines的几何表示是灵活的，但不能准确地表示圆锥截面，这是计算机图形和设计中常用的一个广泛的几何系列，包括圆弧、圆柱形和球体。为了实现几何表现的灵活性和精确性，NURBS被引入[PT97]，如今已成为计算机图形中广泛使用的工具。

单变量NURBS基函数是通过与单变量Bsplines基$\left\{\widehat{N}_{i}(\xi)\right\}_{i=1}^{n}$（由结点向量$\Xi$建立）相关联，得到一组$n$的实数，称为权重，例如$\left\{w_{i}\right\}_{i=1}^{n} \in \mathbb{R}$。通过引入加权函数$W(\xi)=\sum_{j=1}^{n} \widehat{N}_{j}(\xi) w_{j}$，单变量NURBS基函数$\widehat{R}_{i}: \widehat{\Omega} \rightarrow \mathbb{R}$，与$\widehat{\Omega} \subset \mathbb{R}$，读作

!!!!
\widehat{R}_{i}(\xi)=\frac{\widehat{N}_{i}(\xi) w_{i}}{W(\xi)}=\frac{\widehat{N}_{i}(\xi) w_{i}}{\sum_{j=1}^{n} \widehat{N}_{j}(\xi) w_{j}} \quad \text { for } i=1, \ldots, n
$$

每个NURBS基函数都是在参数域$\Omega$中定义的片状有理函数；即使它们不是片状多项式，其度数$p$习惯上也被称为B-splines基函数的多项式度数，从
 ![](https://cdn.mathpix.com/cropped/10058ab4e7f0c5bd6fe5bcd4db204623-272.jpg?height=280&width=690&top_left_y=129&top_left_x=100)

图 11.4.单变量NURBS基函数的例子，结向量$\Xi=$ $\left\{\{0\}^{3}, 1 / 4,1 / 2,3 / 4,\{1\}^{3}\right\}$ ，度数$p=2$ ，元素数$n_{e l}=4$ ，基函数数$n=6$ ，全局$C^{1}$ -连续；NURBS权重在向量$\mathbf{w}$ 中表示

这些都是生成的。在本章中，我们将假设权重是严格的正数，即$w_{i}>0$为所有$i=1, \ldots, n$，因此NURBS的特性立即继承了生成B-splines的特性，包括规则性（连续性）特性；事实上，B-splines是NURBS的一个特殊情况，对其而言，权重都是相等的，按照惯例$w_{i}=1$为所有$i=1, \ldots, n$。图11.4中报告了一些单变量NURBS基函数的例子。

通过利用多变量B-splines基函数的张量积结构，它直接延伸到相应的权重，并通过使用适当的基函数重新排序，多变量NURBS基函数 $\widehat{R}_{i}$ : $\widehat{\Omega} \rightarrow \mathbb{R}$ ，与 $\widehat{\Omega} \subset \mathbb{R}^{\kappa}$ ，读作

!!!!
\widehat{R}_{i}(\xi)=\frac{\widehat{N}_{i}(\xi) w_{i}}{W(\xi)}=\frac{\widehat{N}_{i}(\xi) w_{i}}{\sum_{j=1}^{n} \widehat{N}_{j}(\xi) w_{j}} \quad \text { for } i=1, \ldots, n
$$

与B-splines类似，通过为每个基点$\left\{\widehat{R}_{i}(\xi)\right\}_{i=1}^{n}$关联一组控制点$\left\{\mathbf{P}_{i}\right\}_{i=1}^{n}$，一个NURBS几何体由几何映射$\phi: \widehat{\Omega} \rightarrow!!!!\mathbb{R}^{d}$决定，即W

!!!!
\phi(\xi)=\sum_{i=1}^{n} \mathbf{P}_{i} \widehat{R}_{i}(\xi)
$$

与由NURBS映射确定的物理域$\Omega$。图 $11.5$ 中显示了一个NURBS几何的例子。

在本章中，我们只考虑B-splines和NURBS的几何表示，对于这些表示$\kappa \equiv d$，即参数空间和物理空间是重合的。我们假设几何映射$\widehat{J}(\xi)=\frac{d \phi}{d \xi}(\xi)$或\ref{11.2}的Jacobian$\widehat{\Omega}$是在$\widehat{\Omega}$中定义好的，并且det$(\widehat{J}(\xi))>0$a.e.在$\widehat{\Omega}$中，集合$\{\xi \in \widehat{\Omega}: \operatorname{det}(\widehat{J}(\xi))=0\}$的度量在$\mathbb{R}^{d}$的拓扑中等于零。最后，我们假设映射\ref{11.1} 在$\widehat{\Omega}$中是可逆的，并且$\widehat{J}$的逆存在，并且在$\mathbb{R}^{d}$的每个元素中是有规律的。

![](https://cdn.mathpix.com/cropped/10058ab4e7f0c5bd6fe5bcd4db204623-273.jpg?height=347&width=285&top_left_y=138&top_left_x=311)

图11.5.NURBS曲面的例子：圆柱形外壳。控制点和控制网以红色标示。

网格；几何映射的逆向是$\phi^{-1}: \mathbf{x} \mapsto \xi$ 。几何映射\ref{11.2}也允许将特征尺寸为$\widehat{\Omega}$的参数域的网格映射到特征尺寸为$h$的物理域的网格；图11.6描述了一个例子。

![](https://cdn.mathpix.com/cropped/10058ab4e7f0c5bd6fe5bcd4db204623-273.jpg?height=303&width=520&top_left_y=876&top_left_x=197)

图 11.6.NURBS几何映射$\phi(\xi)$从参数域$\widehat{\Omega} \subset \mathbb{R}^{2}$到物理域$\Omega \subset \mathbb{R}^{2}$；物理网格是由参数网格通过$\phi(\xi)$确定。
 ![](https://cdn.mathpix.com/cropped/10058ab4e7f0c5bd6fe5bcd4db204623-274.jpg?height=620&width=692&top_left_y=129&top_left_x=101)

图 11.7.连续的$h$-细化的例子，源自于程度为$p=2$的单变量B-splines基与$n_{e l}=1$和$h_{0}=1$（左上）；连续的$h$-细化$\mathrm{B}$-splines基引起了嵌套函数空间的序列

\subsubsection{NURBS函数空间和$h p k$-refinements}。

在参数域$\widehat{\Omega}$中的NURBS基$\left\{\widehat{R}_{i}(\xi)\right\}_{i=1}^{n}$定义了一个超过$\widehat{\Omega}$的NURBS函数空间，例如$\widehat{\mathscr{N}_{h}}$，维度为$n$ 。

!!!!
\widehat{\mathscr{N}_{h}}=\operatorname{span}\left\{\widehat{R}_{i}(\xi), \quad i=1, \ldots, n\right\}
\label{11.3}\end{equation}

由于\ref{11.2}($对$\kappa=d)$的几何映射的可逆性，NURBS基函数可以在物理域$\Omega$（几何本身）中定义为$R_{i}$ : $\Omega \rightarrow \mathbb{R}$ ，其中$R_{i}(\mathbf{x})=\widehat{R}_{i}\left(\phi^{-1}(\mathbf{x})\right)$ 。因此，在物理域$\Omega \subset \mathbb{R}^{d}$上的NURBS函数空间读作

!!!!
\mathscr{N}_{h}=\operatorname{span}\left\{R_{i}(\mathbf{x}), \quad i=1, \ldots, n\right\}=\operatorname{span}\left\{\widehat{R}_{i}\left(\phi^{-1}(\mathbf{x})\right), \quad i=1, \ldots, n\right\}
\label{11.4}\end{equation}


![](https://cdn.mathpix.com/cropped/10058ab4e7f0c5bd6fe5bcd4db204623-275.jpg?height=638&width=690&top_left_y=128&top_left_x=98)

图11.8.从$p_{0}=1$度的单变量B-splines基开始的连续$p$-精化的例子（左上）；连续$p$-精化的B-splines基产生了嵌套函数空间的序列

NURBS空间可以通过三种不同的策略来充实。所谓的$h$-和$p$-细化类似于用$C^{0}$-连续拉格朗日基函数进行的细化，它是第4章和第10章中分别介绍的有限元和谱元方法的基础。然而，第三个被称为$k$的NURBS基函数的精简和特殊的基函数，对于构造规则函数空间特别有用[CHB09, HCB05]。我们在此对单变量$h p k$花样图基函数的$\mathrm{B}-$精简做一个简短的概述，而我们请读者参考$\left[\mathrm{ABC}^{+} 08\right.$ , CHR07, EBBH09, HRS08]对该主题的更全面描述。

- $h$ -细化（网格细化）。它包括在原结点向量$\Xi$中插入额外的结点，而不复制现有的结点值。每一个新结都会增加一个单位的新基函数的数量。统一的结点插入会产生统一的网格细化。图11.7中报告了一个例子。- $p$ -细化（增加多项式程度）。通过将$\Xi$中每个结值的倍数增加一个单位，B-splines基函数的多项式度$p$被增加到$p+1$；因此，基函数的数量被实际网格元素的数量增加$n_{e l}$ 。原始基函数的规则性在该程序的应用过程中被保留下来。图11.8中突出了一个例子。

- $k$ -细化。它包括在一个没有内结的结向量上，首先进行阶梯式提升，然后进行结的插入。基函数的规则性是最大的，$C^{p-1}$，在每个内部结值上，它们的数量在每个$k$精简步骤中只增加一个单位。图中描述了一个例子 $11.9$ 。

我们注意到$h$-和$p$-精简产生了丰富的NURBS函数空间序列$\mathscr{N}_{h_{1}}, \mathscr{N}_{h_{2}}, \ldots$，它们相互嵌套并与原始空间$\mathscr{N}_{h}$相连接，即$\mathscr{N}_{h} \subset \mathcal{N}_{h_{1}} \subset \mathscr{S}_{h_{2}} \subset \cdots$。相反地，$k$-Refinements提供NURBS的序列
 ![](https://cdn.mathpix.com/cropped/10058ab4e7f0c5bd6fe5bcd4db204623-276.jpg?height=616&width=694&top_left_y=539&top_left_x=100)

图11.9.三级$k$-细化的例子，应用于程度为$p=1$的单变量B-splines基的$n_{e l}=1$（左上）；$k$-细化的B-splines基不产生嵌套函数空间序列函数空间$\mathscr{N}_{h_{1}}, \mathscr{N}_{h_{2}}, \ldots$，其函数被赋予越来越多的规则性，但不互相嵌套，即$\mathscr{N}_{h} \subset \mathscr{N}_{h_{1}}, \mathscr{N}_{h} \subset \mathscr{N}_{h_{2}}, \ldots$，但$\mathscr{N}_{h_{1}} \not \subset \mathscr{N}_{h_{2}}$，等等。

细化或者说，NURBS函数空间的充实通常是作为一个起点来增强手头的几何体的表示，例如，通过移动控制点来增加更多的细节特征。如果丰富的NURBS基础也被用于$\Omega$的几何表征，那么关键的一点是在执行细化的时候要保留这种几何表征。这意味着$\Omega$必须由原始的NURBS基础$\left\{\widehat{R}_{i}(\xi)\right\}_{i=1}^{n}$和丰富的基础$\left\{\overline{\widehat{R}}_{i}(\xi)\right\}_{i=1}^{\pi}$来同样表示。具体来说，为了保留NURBS基函数丰富的几何映射，新的控制点$\left\{\bar{P}_{i}\right\}_{i=1}^{n}$和NURBS权重$\left\{\bar{w}_{i}\right\}_{i=1}^{\pi}$都必须在上下文中生成，这样，从公式\ref{11.2} 中，我们有$\phi(\xi)=\sum_{i=1}^{n} \bar{P}_{i} \widehat{R}_{i}(\xi)=\sum_{i=1}^{\pi} \bar{P}_{i} \bar{R}_{i}(\xi)

关于$h p k$-精简的概念直接延伸到多变量的NURBS基函数。

\subsubsection{Construction of NURBS geometries: an example}

我们以构建一条曲线为例，特别是一条以原点为中心，在$\mathbb{R}^{2}$中跨度为90度的弧线，并且具有平滑的扭结。我们从构建弧线开始，这个弧线随后将被 "调整 "为我们的曲线。尽管这不是构建曲线的唯一选择，但我们在此根据这一原则将其构建概括为以下步骤，图11.10中也有描述。

- 步骤1 .我们从结向量$\Xi=\left\{\{0\}^{3},\{1\}^{3}\right\}$中建立单变量B-splines基函数的度数$p=2$，以保证基函数的最小规则性；这得到了$n=3$B-splines基函数$\left\{\widehat{N}_{i}(\xi)\right\}_{i=1}^{n}$ 。相应地，我们在物理空间$\mathbb{R}^{2} n=3$中放置控制点$\mathbf{P}_{1}=(1,0)^{T}, \mathbf{P}_{2}=(1,1)^{T}$和$\mathbf{P}_{3}=(0,1)^{T}$；这将得到一条B-splines曲线，但还没有得到弧线，因为在这种结构下不能准确地表示。

- 步骤2(a).为了得到弧线，我们将非单项权重$w_{2}=\frac{1}{\sqrt{2}}$与B-splines基函数$\widehat{N}_{2}(\xi)$联系起来，从而得到一个NURBS基$\left\{\widehat{R}_{i}(\xi)\right\}_{i=1}^{3}$-步骤$2(\mathrm{~b})$。通过使用第2步的相同控制点，我们得到了横跨90度并以原点为中心的弧线；我们注意到在这种情况下$w_{2}=\arccos \left(\frac{90^{\circ}}{2}\right)$ 。

- 步骤 $3(a)$ 。由于我们需要用光滑的结点来修改弧线，我们通过在结点向量$\Xi$中插入新的结点来丰富NURBS基础$\left\{\widehat{R}_{i}(\xi)\right\}_{i=1}^{3}$，从而得到$\bar{\Xi}=$ $\left\{\{0\}^{3}, \frac{9}{21}, \frac{10}{21}, \frac{11}{21}, \frac{12}{21},\{1\}^{3}\right\}$。根据这个$h$的细化步骤，我们得到一个新的NURBS基$\left\{\bar{R}_{i}(\xi)\right\}_{i=1}^{\pi}$，其度数为$p=2, \bar{n}=7$，并且全局$C^{1}-$连续。

- 步骤3（b）。在步骤3(a)之后，生成一组新的控制点$\left\{\overline{\mathbf{P}}_{i}\right\}_{i=1}^{\pi}$，以保留弧线的几何表现。

![](https://cdn.mathpix.com/cropped/10058ab4e7f0c5bd6fe5bcd4db204623-278.jpg?height=268&width=328&top_left_y=129&top_left_x=116)

阶梯
 ![](https://cdn.mathpix.com/cropped/10058ab4e7f0c5bd6fe5bcd4db204623-278.jpg?height=568&width=688&top_left_y=130&top_left_x=136)

步骤2(b)

![](https://cdn.mathpix.com/cropped/10058ab4e7f0c5bd6fe5bcd4db204623-278.jpg?height=282&width=329&top_left_y=436&top_left_x=496)
 ![](https://cdn.mathpix.com/cropped/10058ab4e7f0c5bd6fe5bcd4db204623-278.jpg?height=594&width=684&top_left_y=436&top_left_x=140)

- 步骤4.最后，修改控制点$\bar{P}_{4}$的位置，例如修改为$\bar{P}_{4}=\left(\frac{1}{2}, \frac{1}{2}\right)^{T}$ ，以获得所需的曲线。

\subsection{The isogeometric concept}

常用的基于NURBS的IGA[CHB09, HCB05]依赖于相同的NURBS（或B-splines）基础函数，首先用于表示PDE的计算域，后来也用于建立寻求数值解的有限维试验空间。这就是所谓的等几何概念 [CHB09] 。

让我们考虑一下公式\ref{4.1}中的线性椭圆问题的弱表述。根据等几何概念，计算域$\Omega \subset \mathbb{R}^{d}$是通过NURBS基函数$-$来表示的，在大多数实际情况下--通过公式\ref{11.2}的NURBS几何映射$\phi: \Omega \rightarrow \mathbb{R}^{d}$，其中$\phi(\xi)=\sum_{i=1}^{n} \mathbf{P}_{i} \widehat{R}_{i}(\xi) ; \widehat{\Omega} \subset \mathbb{R}^{d}$称为参数域。然后，我们在参数域$\widehat{u}_{h}: \widehat{\Omega} \rightarrow \mathbb{R}$中寻找一个近似的解决方案，使得

!!!!
\widehat{u}_{h}(\xi)=\sum_{i=1}^{n} U_{i} \widehat{R}_{i}(\xi)
\label{11.5}\end{equation}

其中$\left\{U_{i}\right\}_{i=1}^{n}$是所谓的控制变量集。由于我们假设NURBS映射\ref{11.2}在$\widehat{\Omega}$中是可逆的，所以我们将计算(物理)域$u_{h}: \Omega \rightarrow \mathbb{R}$中的近似解写为

!!!!
u_{h}(\mathbf{x})=\sum_{i=1}^{n} U_{i} R_{i}(\mathbf{x})=\sum_{i=1}^{n} U_{i} \widehat{R}_{i}\left(\phi^{-1}(\mathbf{x})\right)
$$

由此可见，$\widehat{u}_{h} \in \widehat{\mathscr{N}_{h}}$，以及等价的$u_{h} \in \mathscr{N}_{h}$ ，$\widehat{\mathscr{N}_{h}}$和$\mathscr{N}_{h}$分别是公式\ref{11.3}和\ref{11.4} 的NURBS空间。由于NURBS映射\refP11.2}的可逆性，我们有$u_{h}(\mathbf{x})=\widehat{u}_{h}\left(\phi^{-1}(\mathbf{x})\right)$，其中$\widehat{u}_{h}(\xi)$经常被简单地表示为$u_{h}(\mathbf{x})

根据等距概念，NURBS空间的近似属性继承自那些已经用于表示计算域$\Omega$的NURBS基函数，其中定义了PDE的解。然而，我们注意到，只要$\overline{\mathscr{N}}_{h} \subset \mathscr{N}_{h}$，就可以在一个相对于已经用来表示$\Omega$的空间$\overline{\mathscr{N}}_{h}$丰富的NURBS空间$u_{h}$中寻求解决方案；这种丰富的空间是通过适当的$h p k$细化得到的。

我们注意到，等几何映射是相当普遍的，并不严格限于NURBS映射\ref{11.2}；事实上，其他的几何映射也可以使用，例如那些基于其他类型的样条[TSHH17]或T-样条[BCC$^{+} 10$ , SLSH12]，只要相关的基础是完整的，并且对于二阶椭圆PDE来说$H^{1}(\Omega)$ -conformal。

通过合适的基函数对试解$u_{h}$和计算域使用相同的表示的策略已经在所谓的等参数有限元方法[Cia78, Hug00]中得到了广泛的利用。然而，在这种情况下，基函数$-$让它们成为例如度数为$r$的多项式，例如$\left\{\varphi_{i}^{r}(\mathbf{x})\right\}_{i=1}^{N_{r}} \in \mathbb{P}_{r}-$由有限元近似的选择决定，或者说由有限元空间$X_{h}^{r}$\ref{4.38} 决定。然后，计算域$\bar{\Omega}$由计算网格$\Omega_{h}=\operatorname{int}\left(\cup_{K \in \mathscr{T}_{h}} K\right)$近似，打算为
 ![](https://cdn.mathpix.com/cropped/10058ab4e7f0c5bd6fe5bcd4db204623-280.jpg?height=152&width=694&top_left_y=110&top_left_x=106)

图 11.11.$\mathbb{R}^{2}$中的等参数有限元；从参考元$\widehat{K}$到网格元$K$的映射关系

非重叠网格元素$K ;$的联合，见图4.9。根据等参数的概念，每个网格元素$K \in \mathscr{T}_{h}$是通过使用多项式基础$\left\{\widehat{\varphi}_{i}^{r}(\xi)\right\}_{i=1}^{N_{r}} \in \mathbb{P}_{r}$，以公式\rfe{11.2}的形式，从参考元素中建立的。通过这种方式，如果$r \geq 2$ ，作为$\mathbb{R}^{2}$ 中的三角形的网格元素可以被赋予 "弯曲 "的边缘，以更好地接近计算域$\Omega$ 。例如，如果$r=1$，我们有$\mathbb{P}_{1}=\left\{p\left(\xi_{1}, \xi_{2}\right)=a+b \xi_{1}+c \xi_{2}\right.$，有$\left.a, b, c \in \mathbb{R}\right\}$，而对于$r=2$，我们有$\mathbb{P}_{2}=\left\{p\left(\xi_{1}, \xi_{2}\right)=a+b \xi_{1}+c \xi_{2}+d \xi_{1} \xi_{2}+e \xi_{1}^{2}+f \xi_{2}^{2}\right.$，有$a, b, c$，$d, e, f \in \mathbb{R}\}$，基函数的选择很明显。如果几何映射是基于度数为$r=1$的多项式，那么参考三角形$\widehat{K}$被映射到网格元素$K$，作为一个具有直边的三角形，根据使用基础$\phi^{1}(\xi)$的映射。相反，如果$r=2$ ，参考三角形$\widehat{K}$可以通过使用$\left\{\widehat{\varphi}_{i}^{1}(\xi)\right\}_{i=1}^{6} ;$的映射$\phi^{2}(\xi)$被映射成具有弯曲边缘（抛物线的部分）的网格元素$K$，见图11.11。事实上，第四章介绍的有限元方法是刚才介绍的等参数有限元方法的一个特殊情况，对于这种方法，每个网格元素$K$从$\widehat{K}$的几何映射是$\phi^{1}(\xi)-$，即使用基函数$\left\{\widehat{\varphi}_{i}^{1}(\xi)\right\}_{i=1}^{3} \in \mathbb{P}_{1}-$，而不管用于建立有限元空间的多项式程度$r \geq 1$ 。

我们注意到，等参数的概念也可以用在$10.1$一节和图10.2中介绍的方形网格元素的谱元方法来利用，以及用例$10.1$和图10.3中介绍的Gordon-Hall变换。

与等参数概念不同，等几何概念主要是让$\Omega$的几何表示来决定试解的基础函数。这种选择自然导致在计算PDE的解时纳入$\Omega$的精确几何表示，而等参数概念通常产生一个新的计算域$\Omega_{h}$，适合于 "分析"，它只是$\Omega$的一个近似。等参量概念的另一个显著特点是，计算域$\Omega$在一般情况下被精确地表示为一个整体；反之，在等参量概念中，几何映射产生了一组网格元素$K \in \mathscr{T}_{h}$，其结合决定了$\Omega_{h}$。

\section{ $11.3$ 基于NURBS的IGA：Galerkin方法}。

我们在第 $3$ 章中介绍的Galerkin方法框架下，简要介绍带有NURBS基函数的IGA。

\subsubsection{The Poisson problem}

式\ref{11.4} 的NURBS函数空间$\mathscr{N}_{h}$适合于根据属性$4.1$来逼近空间$H^{1}(\Omega)$ 。此外，我们定义

!!!!
\dot{\mathscr{N}}_{h}=\left\{v_{h} \in \mathscr{N}_{h}:\left.v_{h}\right|_{\partial \Omega}=0\right\}
$$

我们用$N_{h}$表示其维度，即$N_{h}=\operatorname{dim}\left(\mathscr{N}_{h}\right)$ 。例如，如果 $d=$ $1, \mathscr{\mathscr { N }}_{h}=\operatorname{span}\left\{R_{i}(x), \quad i=2, \ldots, n-1\right\}$ 通过观察单变量NURBS基函数在结值 $\xi_{1}$ 和 $\xi_{n+p+1}$ 的图像上是插值的。更一般地说，对于$d=1,2$或3，通过假设$n$NURBS基函数的适当重新排序，使$R_{i}(\mathbf{x})=0$为所有$\mathbf{x} \in \partial \Omega$的索引$i=N_{h}+1, \ldots, n$，我们可以写成$\mathscr{N}_{h}=\operatorname{span}\left\{R_{i}(\mathbf{x}), \quad i=1, \ldots, N_{h}\right\}$ 。同样，NURBS空间$\dot{\mathscr{N}}_{h}$适合用来逼近空间$H_{0}^{1}(\Omega)$。

让我们考虑在计算域$\Omega \subset \mathbb{R}^{d}$中定义的泊松问题(3.1)，对于$d=1,2,3$，在同质情况下，即$g=0$上的$\partial \Omega \subset \mathbb{R}^{d-1}$被赋予迪里希特边界条件(3.2)。在这方面，我们假设计算域$\Omega$是由空间$\mathscr{N}_{h}$的NURBS基函数通过公式\ref{11.2}的几何映射$\phi(\xi)$精确表示的；事实上，根据等几何概念，NURBS空间$\mathscr{N}_{h}$ -连同相应的控制点$\left\{\mathbf{P}_{i}\right\}_{i=1}^{n} \in \mathbb{R}^{d}-$是专门用来精确表示$\Omega$的，并且通常通过$h p k$的细化来充实其几何表示。然后，通过参考弱公式\ref{3.18} ，对于该公式的解$u \in H_{0}^{1}(\Omega)$，并通过设置$V_{h}=\mathscr{\mathscr { N }}_{h}$，我们在Galerkin方法的框架下得到基于NURBS的IGA近似问题

!!!!
\text { find } u_{h} \in V_{h}: \int_{\Omega} \nabla u_{h} \cdot \nabla v_{h} d \Omega=\int_{\Omega} f v_{h} d \Omega \quad \forall v_{h} \in V_{h} .
\label{11.6}\end{equation}

我们注意到，前面问题的近似解$u_{h}$ \ref{11.7}被改写为

!!!!
u_{h}(\mathbf{x})=\sum_{i=1}^{N_{h}} U_{i} R_{i}(\mathbf{x})
\label{11.7}\end{equation}

凭借之前介绍的NURBS基函数的重新排序。

备注11.1.NURBS基$\left\{R_{i}\right\}_{i=1}^{n}$是一个模态基，而有限元拉格朗日基则是节点式的。换句话说，如果我们假设一个控制点$\mathbf{P}_{i}$位于$\bar{\Omega}$中，那么近似解$u_{h}$在这种控制点所取的值一般不与相应的控制变量$U_{i}$重合，即$u_{h}\left(\mathbf{P}_{i}\right) \neq U_{i}$。此外，一些用于建立计算域的控制点甚至可能位于$\bar{\Omega}$之外，如图11.6所示。在这些情况下，这些点上的近似解是没有定义的。

现在让我们考虑泊松问题\ref{3.1} ，在$\partial \Omega$上有非均质的Dirichlet边界条件$(3.2)$，对其来说$g \in L^{2}(\partial \Omega)$是一个非零函数。我们再次通过提升边界基准$g$和它的离散对应物来求助于同质的情况。让我们用$\mathscr{N}_{h}^{\partial \Omega}$来表示由$\partial \Omega$上的$\mathscr{N}_{h}$的函数的跟踪函数形成的空间，顺便说一下，这仍然是一个NURBS空间。由于我们考虑的是由开放结点向量建立的NURBS基础函数，我们将$g$在$\partial \Omega$上的近似值写为

!!!!
g_{h}(\mathbf{x})=\sum_{i=N_{h}+1}^{n} G_{i} R_{i}(\mathbf{x}) \quad \forall \mathbf{x} \in \partial \Omega
$$

其中，边界处的非零基函数$\partial \Omega$被重新排序以携带索引$i=N_{h}+1, \ldots, n$，$\left\{G_{i}\right\}_{i=N_{h}+1}^{n}$是相应的控制变量集。由于$\mathscr{N}_{h} \partial \Omega$的NURBS基函数不是插值的，控制变量$\left\{G_{i}\right\}_{i=N_{h}+1}^{n}$一般不能通过对$\partial \Omega$的基准点$g$插值来确定。然而，一个非严格但有效的方法包括在控制点上 "内插 "基准点，即设置$G_{i} \approx g\left(\mathbf{P}_{i}\right)$ ，如果$\mathbf{P}_{i} \in \partial \Omega$ ，为$i=N_{h}+$ $1, \ldots, n$ [CHB09] 。另外，近似基准点$g_{h}$可以通过$L^{2}(\partial \Omega)$对$g$的投射到NURBS空间$\mathscr{N}_{h}^{\partial \Omega}$来建立。一旦建立了近似基准点$g_{h}$，它的提升$R_{g_{h}} \in \mathscr{N}_{h}$就被构建为

!!!!
R_{g_{h}}(\mathbf{x})=\sum_{i=N_{h}+1}^{n} G_{i} R_{i}(\mathbf{x}) \quad \forall \mathbf{x} \in \Omega
$$

通过设置$V_{h}=\dot{\mathscr{N}}_{h}$，基于NURBS的IGA问题的近似值为

!!!!
\text { find } \stackrel{\circ}{u}_{h} \in V_{h}: \int_{\Omega} \nabla \stackrel{\circ}{u}_{h} \cdot \nabla v_{h} d \Omega=\int_{\Omega} f v_{h} d \Omega \quad \forall v_{h} \in V_{h}
$$

与近似解$u_{h}$恢复为$u_{h}=\circ{u}_{h}+R_{g_{h}}$。

我们注意到Neumann、Robin和一般的自然边界条件（见$3.3$和$3.4$章节）被嵌入到问题的弱表述中，并以与其他Galerkin方法相同的方式处理。

备注11.2.为了计算的目的，通过IGA近似的问题在参数域$\Omega$中被重塑，这要归功于公式\ref{11.2}的NURBS几何映射$\phi(\xi)$的可逆性[CHB09]；也见图11.6。对于泊松问题\ref{11.6}，通过设置公式\ref{11.3}中的$\widehat{V}_{h}=\widehat{\mathscr{N}_{h}}$和明显的符号选择，我们得到

!!!!
\text { find } \widehat{u}_{h} \in \widehat{V}_{h}: \int_{\widehat{\Omega}}\left(\widehat{J}^{-T} \nabla \widehat{u}_{h}\right) \cdot\left(\widehat{J}^{-T} \nabla \widehat{v}_{h}\right) \widehat{j} d \widehat{\Omega}=\int_{\widehat{\Omega}} \widehat{f} \widehat{v}_{h} \widehat{j} d \widehat{\Omega} \quad \forall \widehat{v}_{h} \in \widehat{V}_{h}
\label{11.9}\end{equation}

其中$\widehat{f}=f \circ \phi, \widehat{J}: \widehat{\Omega} \rightarrow \mathbb{R}^{d \times d}$是几何映射的雅各布，$\widehat{j}=\operatorname{det}(\widehat{J})$是它的行列式，在$\widehat{\Omega} \subset \mathbb{R}^{d}$中是正的，因为在这种情况下我们假定$\kappa=d$。

\subsubsection{Algebraic aspects}

为简单起见，让我们参考泊松问题\ref{11.6}的弱式表述，在$\partial \Omega$上有同质的迪里切特边界条件。通过表达近似解$u_{h}$如公式\ref{11.7}，然后对每个测试函数$v_{h}$满足公式\ref{11.6}等于$V_{h}$的NURBS基础函数，我们有等价的问题

!!!!
\text { find }\left\{U_{j}\right\}_{j=1}^{N_{h}}: \sum_{j=1}^{N_{h}} U_{j} \int_{\Omega} \nabla R_{j} \cdot \nabla R_{i} d \Omega=\int_{\Omega} f R_{i} d \Omega \quad \forall i=1, \ldots, N_{h}
\label{11.9}\end{equation}

这就产生了一个公式\ref{4.46} 形式的线性系统，即

!!!!
A \mathbf{u}=\mathbf{f}
$$

其中刚度矩阵$A \in \mathbb{R}^{N_{h} \times N_{h}}$是这样的

!!!!
A=\left[A_{i j}\right] \quad \text { with } A_{i j}=\int_{\Omega} \nabla R_{j} \cdot \nabla R_{i} d \Omega \text {, }
\label{11.10}\end{equation}

解决方案向量$\mathbf{u} \in \mathbb{R}^{N_{h}}$包含控制变量，即$\mathbf{u}=\left[U_{j}\right]$，源$\mathbf{f} \in \mathbb{R}^{N_{h}}$向量为$\mathbf{f}=\left[f_{i}\right]$，其中$f_{i}=\int_{\Omega} f R_{i} d \Omega$为控制变量。

在计算层面，矩阵$A$和向量$f$的组合被 "拉回 "到参数域$\Omega$，如备注11.2所预期的。此外，这种计算是不精确的，使用合适的正交公式。通常，GaussLegendre正交规则[QSS07]在网格上逐个元素应用，每个参数方向使用$p+1$正交节点的经验法则。然而，更有效的正交规则，为NURBS基础函数量身定做，并利用其高阶连续跨网格边缘的特性，已经被提出，例如在 $\left[\mathrm{ACH}^{+} 12, \mathrm{HRS} 10\right]$ 。然而，我们注意到，尽管计算域$\Omega$的NURBS几何表示是精确的，但$A$和$f$的装配不是一般的；事实上，像Gauss-Legendre的正交规则允许精确评估问题的弱表述中涉及的积分，例如，公式。(\ref{11.10})--只适用于B-splines，它是片状多项式，但不适用于NURBS，它是有理函数。尽管如此，正交误差在大多数情况下并不损害基于NURBS的IGA的整体精度。事实上，它们通常可以忽略不计，或者以非常高的速度衰减，例如在每个参数方向使用$p+1$GaussLegendre正交节点时（这又是一个经验之谈）。

硬度矩阵$A$(\ref{11.10})的属性直接来自于用于构建该矩阵的NURBS基函数--如$11.1$一节所述--以及要近似的微分问题的性质。特别是，单变量的NURBS基函数在$\mathbb{R}$中是有序的；同样地，双变量和三变量的NURBS基函数也相应地拥有一个有序的结构，因为它们的构造是基于单变量基函数的张量积规则。这就推断出，NURBS网格是有结构的，所有的连接结构（如所谓的ID阵列）在NURBS基础构建时是同时确定的。由此可见，矩阵$A$是带状的。一般来说，矩阵$A$也是稀疏的；事实上。

![](https://cdn.mathpix.com/cropped/10058ab4e7f0c5bd6fe5bcd4db204623-284.jpg?height=298&width=281&top_left_y=131&top_left_x=103)

$1 D, C^{1}-$连续，$n=7$ 。
 ![](https://cdn.mathpix.com/cropped/10058ab4e7f0c5bd6fe5bcd4db204623-284.jpg?height=640&width=694&top_left_y=130&top_left_x=100)

$2 D, C^{1}-$连续，$n=49$。

![](https://cdn.mathpix.com/cropped/10058ab4e7f0c5bd6fe5bcd4db204623-284.jpg?height=323&width=289&top_left_y=467&top_left_x=510)

图 11.12.度数为$p=2$的NURBS基础函数在$1 D$、$2 D$和$3 D$中沿每个参数方向的刚度矩阵示例

通过回顾第11.1.1节的符号，如果$n_{\alpha} \gg p_{\alpha}$为$\alpha=1, \ldots, \kappa$，就会出现这种情况。在$A$的每一行中，非零项的最大数量为

!!!!
\prod_{\alpha=1}^{\kappa}\left(2 p_{\alpha}+1\right)
$$

其中$p_{\alpha}$是沿每个参数方向的多项式程度。这与NURBS基函数$-$的连续性顺序无关，即让它们是$C^{0}$或$C^{p-1}$ - 因为它们的支持度只取决于多项式的度数$p$ 。因此，对于结构化网格上的等参数有限元方法和基于NURBS的IGA来说，刚度矩阵的最大带子尺寸是相同的。

我们在图11.12中报告了一些通过NURBS基函数组装的刚度矩阵的例子。

公式\ref{11.10} 的刚度矩阵$A=\left[a\left(R_{j}, R_{i}\right)\right]$源于Galerkin方法框架下泊松问题的基于NURBS的IGA近似。
 ![](https://cdn.mathpix.com/cropped/10058ab4e7f0c5bd6fe5bcd4db204623-285.jpg?height=578&width=700&top_left_y=124&top_left_x=98)

图11.13.在$1 D$情况下，$\Omega=(0,1)$的刚度矩阵$K_{2}(A)$与Dirichlet边界条件$-$的条件数，对于带数值积分的谱元方法（SEM-NI）和$C^{p-1}$ -连续的基于NURBS的IGA在不同值$p$的精化下。SEM的自由度为$N_{h}=p / h+1$，IGA的自由度为$N_{h}=1 / h+p$，采用$C^{p-1} \mathrm{~B}$ -splines。

因此，它是正定的，因为双线性形式$a(\cdot, \cdot)$是胁迫的。此外，$A$是对称的，因为形式$a(\cdot, \cdot)$是对称的。此外，它的调节数与公式\ref{4.50}中的$K_{2}(A) \simeq C h^{-2}$一样，只要$h$"足够 "小，常数$C$取决于多项式程度$p$和NURBS基函数的连续性顺序。我们在图$11.13$中报告了一些例子来说明条件数在$h$细化下的行为。

关于在$p$细化下的条件数$K_{2}(A)$，对于$C^{p-1}$连续的NURBS基函数，这可能会随着$p$而 "快速 "增长。具体来说，对于一个$A$装配的刚度矩阵，对于一个$d$-维的问题，在$d \geq 2$中提供了以下约束$K_{2}(A) \leq C(h) p^{2 d+2} 4^{d p}$（然而这似乎并不尖锐）。特别是，与基于NURBS的IGA相关的矩阵的条件数$A$并不享有与第10.3.1节中提出的带或不带数值积分的谱元方法相同的特性，对于该方法，我们有以下几点
 ![](https://cdn.mathpix.com/cropped/10058ab4e7f0c5bd6fe5bcd4db204623-286.jpg?height=278&width=694&top_left_y=130&top_left_x=100)

图11.14.在$1 D$情况下，刚度矩阵$A-$的条件数$K_{2}(A)$与Dirichlet边界条件$-$，$\Omega=(0,1)$，在$h$精简条件下的数值积分谱元法（SEM-NI）和$C^{p-1}$在$k$精简条件下的基于NURBS的连续IGA（$h=1$和$h=1 /$ 32。SEM的自由度为$N_{h}=p / h+1$，IGA的自由度为$N_{h}=1 / h+p$，采用$C^{p-1}$B-splines。

分别为$K_{2}(A)=O\left(p^{4}\right)$和$O\left(p^{3}\right)$。我们在图$11.14$中报告了一个例子，说明在$p$-细化$1 D$情况下的条件数的行为。

\subsubsection{A priori error estimates}

我们提供了在$h$细化下的Galerkin方法框架中与基于NURBS的IGA相关的误差估计。具体来说，我们参考了第11.3.1节的泊松问题，对于这个问题，假设$u \in H_{0}^{1}(\Omega)$和$\partial \Omega$是 "足够 "规则的。

我们报告，从$\left[\mathrm{BBC}^{+} 06\right]$和[TDQ14]中得到的一个关于$H^{1}$规范的先验误差估计结果。它的证明与定理$4.3$和4.6的有限元对应物类似；然而，它使用的算子不是插值，而是NURBS子空间上合适的$L^{2}$投影器$\mathscr{N}_{h}$ 。

定理$\mathbf{1 1 . 3}$（$H^{1}$规范中的先验误差估计）。设$u \in H^{r+1}(\Omega)$，$r \geq 0$，是泊松问题的解，$u_{h} \in V_{h}$是其基于NURBS的IGA近似，使用度数为$p$且至少在$C^{k_{m i n}}$连续的NURBS空间的基函数，$k_{\min } \geq 0$。那么，在$h$-精简下的以下误差估计成立

!!!!
\left\|u-u_{h}\right\|_{H^{1}(\Omega)} \leq C h^{s}\|u\|_{H^{r+1}(\Omega)}
\label{11.11}\end{equation}

其中$s=\min \{p, r\}$和$C$是一个独立于网格大小$h$和解决方案$u$的正常数。

通过使用4.5.4节中的Aubin-Nitsche论证和有限元方法的定理$4.7$，我们可以得到以下泊松问题的$L^{2}$误差估计。定理$11.4$（$L^{2}$准则下的先验误差估计）。在定理11.3的相同假设下，以下h-精简下的误差估计成立

!!!!
\left\|u-u_{h}\right\|_{L^{2}(\Omega)} \leq C h^{s+1}\|u\|_{H^{r+1}(\Omega)}
\label{11.12}\end{equation}

其中$s=\min \{p, r\}$和$C$是一个独立于网格大小$h$和解决方案$u$的正常数。

前面的结果\ref{11.11}和\ref{11.12}表明，与基于NURBS的IGA近似相关的误差在$h$精简下分别以$\beta$或$\gamma$的顺序收敛，这只由NURBS空间的多项式程度$p$和解的规则性$u$决定。因此，收敛顺序并不取决于$\mathscr{N}_{h}$的NURBS基础函数的规则性，只要这些函数在$\Omega$中至少是$C^{0}-$连续的。此外，收敛率与通过有限元方法逼近$u$得到的收敛率相同。具体来说，如果$u \in H^{r}(\Omega)$为足够大的$r(r \geq p+1)$，那么在$h$-精简下的误差收敛率分别为$p$和$p+1$，在规范$H^{1}$和$L^{2}$。

$p$和$k$版本下的先验误差估计结果见[BBRS11] 。在此，我们仅限于回顾一下，与基于NURBS的IGA相关的误差表现与$h p$版本的有限元方法一样，即与第10章的谱元方法一样。具体来说，$p$细化下的先验误差估计值的特征与定理10.1相似；在这方面，如果PDE的精确解$u$是分析性的，那么与基于NURBS的IGA相关的误差收敛顺序超过代数，即它可以被解释为是指数级的（第10.1节）。

\subsubsection{A numerical example: the Poisson problem}

我们在此考虑解决一个简单的泊松问题，以突出基于NURBS的IGA的一些特点和特性。
 ![](https://cdn.mathpix.com/cropped/10058ab4e7f0c5bd6fe5bcd4db204623-287.jpg?height=296&width=640&top_left_y=907&top_left_x=113)

图11.15.泊松问题：计算域$\Omega$（左）和精确解$u$（右）。
 ![](https://cdn.mathpix.com/cropped/10058ab4e7f0c5bd6fe5bcd4db204623-288.jpg?height=240&width=714&top_left_y=121&top_left_x=98)

图11.16.泊松问题：$h$的序列-$\Omega$的细化网格

让我们首先考虑图11.15中的NURBS几何体，它是通过度数为$p=2$的NURBS基函数来精确表示的（这里我们使用沿两个参数方向$\alpha=$1,2的相同多项式度数的基函数）。这样的NURBS几何学定义了极坐标$\Omega=(1,2) \times(0, \pi / 2)$中的计算域$(r, \theta)$ 。

我们现在考虑具有同质Dirichlet边界条件的泊松问题\ref{3.13} 。源项$f$的选择使泊松问题在$\Omega$中的精确解为$u=\sin \left(\pi / 3\left(r^{2}-1\right)\right) \sin (4 \theta)$；使用极坐标的唯一目的是以一种紧凑的方式表示它。图$u$描述了精确解$11.15$ 。

我们通过基于NURBS的IGA来解决泊松问题，使用度数为$p=2$和3的NURBS基函数，这些基函数在$C^{p-1}$和$C^{0}-$中连续。具体来说，我们评估$H^{1}$和$L^{2}$在$h$细化下的误差，即在连续细化的网格序列上，如图11.16所示，这导致了丰富的，但嵌套的NURBS函数空间序列$\mathscr{N}_{h}$，如第11.1.4节中所述。因此，我们考虑NURBS的基础函数就像图11.1中的单变量情况所描述的那样。在图$11.17$中，我们报告了$H^{1}$和$L^{2}$在$h$精简下的错误，我们强调了从定理$11.3$和$11.4$的相应先验误差估计中预期的收敛率。我们特别指出，$H^{1}$和$L^{2}$误差的收敛率分别为$p$和$p+1$；这个结果与NURBS基函数的连续性顺序无关，让它们成为$C^{p-1}$或$C^{0}-$的连续性。然而，在给定的网格元素数量下，$N_{h}$NURBS所涉及的基函数数量比$C^{p-1}$对应的基函数大得多(因此$h$ )。因此，高阶连续NURBS$\left(C^{p-1}\right)$需要较少的自由度$N_{h}$来达到$C^{0}$基函数的相同误差水平。

\subsubsection{Eigenvalue analysis}

我们将一个特征值问题的解决作为基于NURBS的IGA、带数值积分的谱元法和标准有限元法的近似特性的进一步测试比较。让我们
 ![](https://cdn.mathpix.com/cropped/10058ab4e7f0c5bd6fe5bcd4db204623-289.jpg?height=630&width=738&top_left_y=129&top_left_x=100)

图 11.17.泊松问题：$H^{1}$和$L^{2}$-误差在$h$-细化下的行为，NURBS基函数的度数$p=2$和3是$C^{p-1}$和$C^{0}$-连续的；误差与特征网格大小$h$和自由度数$N_{h}$都被绘制出来

介绍$1 \mathrm{D}$中的特征值问题。

\begin{equation}
\text { find } \omega_{n} \in \mathbb{R} \text { and } u_{n} \in V: a\left(u_{n}, v\right)=\omega_{n}^{2} m\left(u_{n}, v\right) \quad \forall v \in V,
$$

其中$a(w, v)=\int_{0}^{1} w^{\prime} v^{\prime} d x, m(w, v)=\int_{0}^{1} w v d x$ ，和$V=H^{1}(0,1)$ ，承认有无限多的特征值$\omega_{n}^{2}$ ，其中$\omega_{n}=n \pi$ 为$n=0,1,2 \ldots \ldots$ 通过设置有限维度空间$V_{h}=\mathscr{A}_{h}$ ，公式\ref{11.4} 的NURBS空间维度为$N_{h}$ ，我们得到特征值问题的基于NURBS的IGA近似。



!!!!
\text { find } \omega_{n, h} \in \mathbb{R} \text { and } u_{n, h} \in V_{h}: a\left(u_{n, h}, v_{h}\right)=\omega_{n, h}^{2} m\left(u_{n, h}, v_{h}\right) \quad \forall v \in V_{h}
$$

近似的特征值是 $\left\{\omega_{n, h}^{2}\right\}_{n=0}^{N_{h}}$ ，我们假设它在 $\mathbb{R}$ 中是有序的（越来越多）。由于我们基于NURBS的IGA公式是一种Galerkin方法$-$，对NURBS来说是精确积分，对B-splines来说是经验法则的Gauss-Legendre正交$-$，对于这个对称的特征值问题（[Cia78, Hug00]）可以得到

!!!!
\omega_{n} \leq \omega_{n, h} \quad \forall n=0,1, \ldots, N_{h}
$$



![](https://cdn.mathpix.com/cropped/10058ab4e7f0c5bd6fe5bcd4db204623-290.jpg?height=261&width=330&top_left_y=135&top_left_x=102)

SEM-NI

![](https://cdn.mathpix.com/cropped/10058ab4e7f0c5bd6fe5bcd4db204623-290.jpg?height=281&width=329&top_left_y=427&top_left_x=103)

$C^{p-1}$ -连续的B-splines, IC

![](https://cdn.mathpix.com/cropped/10058ab4e7f0c5bd6fe5bcd4db204623-290.jpg?height=262&width=330&top_left_y=135&top_left_x=461)

FEM

![](https://cdn.mathpix.com/cropped/10058ab4e7f0c5bd6fe5bcd4db204623-290.jpg?height=286&width=331&top_left_y=428&top_left_x=460)

图11.18.在不同的$p$值下，带数值积分的谱元法（SEM-NI）、有限元法（FEM）和$C^{0}$连续的基于NURBS的IGA（带B-splines）的归一化谱。对于SEM、FEM和$C^{0}$基于NURBS的IGA，自由度数为$N_{h}=n_{e l}+p$；对于$C^{p-1}$IGA，我们改变$n_{e l}-$，产生$h=1 / n_{e l}$，对于$\Omega=(0,1)-$，$N_{h} \simeq 1024$，所有考虑中的方法，对于$p=1, \ldots, 5

对于采用非精确正交公式的方法或不享有Galerkin框架特性的方法，如第10.3节的带数值积分的谱元方法，这一特性得不到保证；事实上，当双线性形式$a(\cdot, \cdot)$和$m(\cdot, \cdot)$以近似方式计算时，后者不再是Galerkin近似方法。

我们在图$11.18$中报告了归一化的光谱，即$\frac{\omega_{n, h}}{\omega_{n}}$与$\frac{n}{N_{h}}$的比率图，其中$N_{h}$是有限维空间$V_{h}$的尺寸。我们将基于NURBS的IGA与$C^{p-1}$和$C^{0}$度数为$p=1, \ldots, 5$的B-splines基函数，以及通过相应的基于谱元法的数值积分和标准有限元法的近似方法得到的谱图进行比较。尽管经过归一化处理，我们的比较包括所有近似方法的自由度$N_{h}$，这是通过适当改变每个多项式程度$p$值的网格元素数量$n_{e l}$而获得的，这样$N_{h} \simeq 1024$。我们可以看到，使用$C^{p-1}$ 连续B-splines的IGA到目前为止提供了整个频谱的最佳近似，通过提升基函数的度数$p$来提高精度。相反，带数值积分的谱元法、标准有限元法和使用$C^{0}$连续B-splines的IGA，随着多项式度数$p$的增加，在频谱的最大部分的近似度会变差。

\section{ $11.4$ Current developments and perspectives}。

IGA如今在应用和方法学发展方面都是一个非常活跃的研究领域。对于后者，我们只提及在Galerkin方法的框架内利用B-splines和NURBS基函数的高阶连续性的特性（[CHR07, EBBH09]），这特别适用于高阶PDEs[BDQ15, TDQ14]，涉及尖锐但光滑界面的PDEs作为相场模型$\left[\mathrm{GCBH} 08, \mathrm{GHNC} 10, \mathrm{GN} 12, \mathrm{LDE}^{+} 13, \mathrm{LH} 16\right]$，以及线性波传播问题（如弹性动力学方程），对于这些问题，控制数值耗散和色散是准确模拟的关键[CHR07, CRBH06, DJQ15, HER14, HRS08]。

NURBS所保证的几何表现的 "精确性 "特别适用于计算流体动力学中涉及边界层的问题[BCZH06, HAB 11]，经历大变形的机械问题[BBHH11, $\left.\mathrm{LEB}^{+} 10\right]$，结构分析中的接触问题[LWH14]，梁和壳的分析[BBHH10, DS11, KBH $^{+} 10$ , LZZ13]，以及一般表面和几何PDEs[BDQ15, BDQ16, DQ15]。形状优化是另一个明显的例子，其中NURBS的几何表示法很容易被利用[KSWB14, NAG10, NG13, Qia10, WFC08] 。事实上，NURBS控制点和权重提供了一个直接的途径来控制计算域的形状，其中定义了PDEs；我们请读者参阅第18章关于优化问题的概述。

通过在Galerkin方法的框架内使用更有效的B-splines和NURBS基函数的正交公式，IGA逼近的计算效率和精度也得到了追求$\left[\mathrm{ACH}^{+} 12, \mathrm{HCSH} 17, \mathrm{HRS} 10,\right.$ , SHH14] 。在这方面，用于逼近PDEs的配位技术也有了显著的发展$\left[\mathrm{ABH}^{+} 10\right.$ , BLR12, GL16, MST17, RH15, SER $^{+} 13$ ] 。

除了NURBS之外，更多通用的几何表示法也被考虑到了，目前正在开发中。其中，由于T-splines[SZBNO3]的灵活性，主要用于计算机图形行业$-$的等轴测距概念，因此在使用和适应T-splines的几何表示方面做了大量的工作$\left[\mathrm{BCC}^{+} 10, \mathrm{BCS} 10\right]$。自适应IGA [DJS10, KVvdZvB14, SDS $^{+} 12$ , VGJS11] 也是一个非常活跃的研究领域，除了分层细化外，还涉及分层、截断分层和局部细化B-splines [BC13, GJS12, JKD14] 以及分层和改良T-splines [ESLT15, SLSH12, WZLH17] 的开发。

\section{Discontinuous element methods (DG and mortar)}

到目前为止，我们已经考虑了带有连续多项式函数子空间的Galerkin方法，无论是在有限元方法（第3章）还是谱元方法（第10章）中。本章讨论的是基于元素间不连续的多项式子空间的逼近技术。我们将特别介绍所谓的不连续Galerkin方法（DG）和臼齿法。我们将首先对泊松问题进行介绍，然后将其推广到扩散和传输问题的情况（见第13章）。为了保持演示的一般性，我们将考虑把计算域划分为不相交的子域，这些子域可以是有限元，也可以是谱元。

\subsection{The discontinuous Galerkin method (DG) for the Poisson problem}

让我们考虑泊松问题以及同质Dirichlet边界条件(3.13)在域$\Omega \subset \mathbb{R}^{2}$中被划分为$M$不相连的元素$\Omega_{m}$、$m=1, \ldots, M$的联合。我们希望获得一个与通常的表述不同的弱表述，作为DG方法的出发点。为了简化讨论，我们假设精确解是足够规则的，例如 $u \in H_{0}^{1}(\Omega) \cap H^{2}(\Omega)$ ，这样下面的所有操作都有意义。定义空间

!!!!
W^{0}=\left\{v \in W:\left.v\right|_{\partial \Omega}=0\right\}
$$

其中

!!!!
W=\left\{v \in L^{2}(\Omega):\left.v\right|_{\Omega_{m}} \in H^{1}\left(\Omega_{m}\right), m=1, \ldots, M\right\}
\label{12.1}\end{equation}

根据格林公式，我们有，对于每个$v \in W^{0}$ ,

!!!!
\sum_{m=1}^{M}(-\Delta u, v)_{\Omega_{m}}=\sum_{m=1}^{M}\left((\nabla u, \nabla v)_{\Omega_{m}}-\int_{\partial \Omega_{m}} v \nabla u \cdot \mathbf{n}_{m}\right)
\label{12.2}\end{equation}

其中$\mathbf{n}_{m}$是$\partial \Omega_{m}$的外向单位法线，$(\cdot, \cdot)_{\Omega_{m}}$表示$L^{2}\left(\Omega_{m}\right)$的标量积。

![](https://cdn.mathpix.com/cropped/10058ab4e7f0c5bd6fe5bcd4db204623-293.jpg?height=252&width=358&top_left_y=113&top_left_x=276)

图12.1.分隔两个相邻子域（或元素）的 "边缘 "e

称$\mathscr{E}_{\delta}$为所有内部边缘的联合体，即分离子域的界面（最外层的边缘可以忽略，因为$v$在它们上面消失），我们可以重新排列条款，得到

!!!!
-\sum_{m=1}^{M} \int_{\partial \Omega_{m}} v \nabla u \cdot \mathbf{n}_{m}=-\left.\sum_{e \in \mathscr{E}_{\delta}} \int_{e}\left(v^{+} \nabla u^{+} \cdot \mathbf{n}^{+}+v^{-} \nabla u^{-} \cdot \mathbf{n}^{-}\right)\right|_{e}
\label{12.3}\end{equation}

其中符号"'$+$"和"$-$"根据两个可能的法线方向来标记信息（例如，见图12.1）。

我们将使用以下符号来表示平均值和元素边上的跳动。

!!!!
\begin{gathered}
\{v\}=\frac{v^{+}+v^{-}}{2}, \quad[v]=v^{+} \mathbf{n}^{+}+v^{-} \mathbf{n}^{-} \\
\mathfrak{\{} \nabla w\}=\frac{(\nabla w)^{+}+(\nabla w)^{-}}{2}, \quad \llbracket \nabla w \rrbracket=(\nabla w)^{+} \cdot \mathbf{n}^{+}+(\nabla w)^{-} \cdot \mathbf{n}^{-}
\end{gathered}
$$

请注意，上述约定保证了跳跃运算符的定义不会取决于子域（元素）的编号方式。通过一点代数操作，最终可以得到

!!!!
\begin{aligned}
v^{+} \nabla u^{+} \cdot \mathbf{n}^{+}+v^{-} \nabla u^{-} \cdot \mathbf{n}^{-}=& 2[v] \cdot\{\nabla u\}-\left(v^{+} \nabla u^{-} \cdot \mathbf{n}^{+}+v^{-} \nabla u^{+} \cdot \mathbf{n}^{-}\right) \\
=& 2[v] \cdot\{\nabla u\}+2 \llbracket \nabla u \rrbracket\{v\} \\
&-\left(v^{+} \nabla u^{+} \cdot \mathbf{n}^{+}+v^{-} \nabla u^{-} \cdot \mathbf{n}^{-}\right)
\end{aligned}
$$

于是

!!!!
v^{+} \nabla u^{+} \cdot \mathbf{n}^{+}+v^{-} \nabla u^{-} \cdot \mathbf{n}^{-}=[v] \cdot\{\{\nabla u\}+\llbracket \nabla u \rrbracket\{v\} .
\label{12.4}\end{equation}

使用\ref{12.3）和\ref{12.4），从\ref{12.2）中我们得到泊松问题\ref{3.13} 的解满足。  $u \in W^{0}$ s.t.

!!!!
\sum_{m=1}^{M}(\nabla u, \nabla v)_{\Omega_{m}}-\sum_{e \in \mathscr{E}_{\delta}} \int_{e}([v] \cdot\{\mathfrak{u} \nabla u\}+\llbracket \nabla u \rrbracket\{v\})=\sum_{m=1}^{M}(f, v)_{\Omega_{m}} \quad \forall v \in W^{0}
\label{12.4}\end{equation}

现在我们引入离散空间

!!!!
W_{\delta}=\left\{v_{\delta} \in W:\left.v_{\delta}\right|_{\Omega_{m}} \in \mathbf{P}_{r}\left(\Omega_{m}\right), m=1, \ldots, M\right\}
$$

$\mathbf{P}_{r}\left(\Omega_{m}\right)$是$\Omega_{m}$上的一个 "多项式 "的空间。更确切地说，如果$\Omega_{m}$是一个单数（二维三角形或三维四面体），则$\mathbf{P}_{r}\left(\Omega_{m}\right)=\mathbb{Q}_{r} \circ F_{m}\left(\Omega_{m}\right)$是一个谱元（$2 \mathrm{D}$中的四边形，$3 \mathrm{D}$中的平行四边形，参见第十章）。这里$F_{m}$是将$\Omega_{m}$转换为单位立方体$\Omega=[-1,1]^{d}(d=2,3)$的映射。最后，让$W_{\delta}^{0}$成为$W_{\delta}$的以下子空间

!!!!
W_{\delta}^{0}=\left\{v_{\delta} \in W_{\delta}:\left.v_{\delta}\right|_{\delta \Omega}=0\right\}
$$

注意\ref{12.3）中的$\llbracket \nabla u \rrbracket\{v\}$是空的，因为如果$u \in H_{0}^{1}(\Omega) \cap H^{2}(\Omega)$，那么$\llbracket \nabla u \rrbracket=0$在每条边$e \in \mathscr{E}_{\delta}$上。这一事实以及表达式\ref{12.1}促使我们对问题\ref{3.13}进行以下DG逼近：找到满足以下条件的$u_{\delta} \in W_{\delta}^{0}$： 1.

!!!!
\begin{aligned}
\sum_{m=1}^{M}\left(\nabla u_{\delta}, \nabla v_{\delta}\right)_{\Omega_{m}}-&\left.\sum_{e \in \mathscr{E}_{\delta}} \int_{e}\left[v_{\delta}\right] \cdot\left\{\nabla u_{\delta}\right\}-\tau \sum_{e \in \mathscr{E}_{\delta}} \int_{e}\left[u_{\delta}\right] \cdot \mathfrak{\{} \nabla v_{\delta}\right\} \\
&+\sum_{e \in \mathscr{E}_{\delta}} \gamma|e|^{-1} \int_{e}\left[u_{\delta}\right] \cdot\left[v_{\delta}\right]=\sum_{m=1}^{M}\left(f, v_{\delta}\right)_{\Omega_{m}} \quad \forall v_{\delta} \in W_{\delta}^{0}
\end{aligned}
\label{12.5}\end{equation}

其中$\gamma=\gamma(r)$是一个合适的正常数（取决于局部多项式程度），$|e|$是$e \in \mathscr{E}_{\delta}$的长度，$\tau$是一个合适的固定数字。额外的新项$\tau\left[u_{\delta}\right] \cdot\left\{\left\{\nabla v_{\delta}\right\}\right.$和$\gamma|e|^{-1}\left[u_{\delta}\right] \cdot\left[v_{\delta}\right]$不会破坏强一致性（因为$[u]=0$如果$u$是精确的泊松解），除了保证更大的通用性和改进的稳定性特征。

在$70 \mathrm{~s}$末尾引入的公式\ref{12.5）被称为内部惩罚法（IP）（[Whe78, Arn82]）。在$\tau=1$的情况下，该方法保留了对称性，由此产生的公式被称为SIPG方法（对称内部罚分Galerkin）[Whe78, Arn82]。对于$\tau \neq 1$，双线性形式不再是对称的，特殊值$\tau=-1$和$\tau=0$分别导致了NIPG方法 $($ 非对称内部惩罚性Galerkin） [RWG99] 和IIPG方法（不完全内部惩罚性Galerkin） [DSW04] 。前者对任何给定的$\gamma>0$都是稳定的，而SIPG和IIPG为了达到稳定的表述，需要有足够大的惩罚参数$\gamma$ 。

在有限元逼近的背景下，已经提出了公式\ref{12.5}的几个变体。这里我们只简要介绍最经典的情况，并参考Arnold, Brezzi, Cockburn, Marini的文章[ABCM02]，以了解总体概况和对稳定性和收敛的详细研究。

第一个版本包括用以下稳定项替换\ref{12.5}左侧的最后一个项

!!!!
\sum_{e \in \mathscr{E}_{\delta}} \gamma \int_{e} r_{e}\left(\left[u_{\delta}\right]\right) \cdot r_{e}\left(\left[v_{\delta}\right]\right)
\label{12.6}\end{equation}

以上$r_{e}(\cdot)$是一个合适的扩展算子，它从一个跨越$e \in \mathscr{E}_{\delta}$的函数$\left[v_{\delta}\right]$的跳转中，生成了一个在以$e$为边的元素上具有非零支持的函数$r_{e}\left(\left[v_{\delta}\right]\right)$。详细情况见[BRM $^{+}$ 97]和[ABCM02]。

第二个变体（参见[Ste98]）用松弛的平均数取代了\ref{12.5}中的平均数$\{\nabla w\}$。

!!!!
\{\nabla w\}_{\theta}=\theta \nabla w^{+}+(1-\theta) \nabla w^{-}, \quad 0 \leq \theta \leq 1
$$

到此为止，我们已经 "强烈 "地施加了同质的迪里希特条件。为了在$\partial \Omega$上添加边界约束，比如说$u=g$，以弱的形式（"à la Nitsche" [Nit71]），因为对于类似DG的近似来说更自然，我们用$W_{\delta}$而不是$W_{\delta}^{0}$来写离散公式\ref{12.5），并在左边添加以下对边界边的贡献$e \subseteq \partial \Omega

!!!!
\begin{aligned}
-\sum_{e \subseteq \partial \Omega} \int_{e} v_{\delta} \nabla u_{\delta} \cdot \mathbf{n}-\tau \sum_{e \subseteq \partial \Omega} \int_{e}\left(u_{\delta}-g_{\delta}\right) \nabla v_{\delta} \cdot \mathbf{n} \\
&+\sum_{e \subseteq \partial \Omega} \gamma|e|^{-1} \int_{e}\left(u_{\delta}-g_{\delta}\right) v_{\delta}, \quad u_{\delta}, v_{\delta} \in W_{\delta}
\end{aligned}
$$

正常数$\gamma=\gamma(r)$与\ref{12.5}相同，而$g_{\delta}$是$g$的方便近似值。第一个项是由部分积分自然产生的，它确保了方法的强一致性，而第二个项在$\tau=1$的情况下使公式具有对称性，在$\tau=-1,0$的情况下使公式具有非对称性。最后一个项对离散解$u_{\delta}$的轨迹进行惩罚，使其 "接近 "迪里切特基准。请再次注意，这些条款并不影响方法的强一致性。

因此，施加了弱边界条件的DG公式变成：找到$u_{\delta} \in W_{\delta}$，使之成为

!!!!
\begin{aligned}
&\sum_{m=1}^{M}\left(\nabla u_{\delta}, \nabla v_{\delta}\right)_{\Omega_{m}}-\sum_{e \in \mathscr{E}_{\delta}} \int_{e}\left[v_{\delta}\right] \cdot\left\{\left\{\nabla u_{\delta}\right\}-\tau \sum_{e \in \mathscr{E}_{\delta}} \int_{e}\left[u_{\delta}\right] \cdot\left\{\left\{\nabla v_{\delta}\right\}+\sum_{e \in \mathscr{E}_{\delta}} \gamma|e|^{-1} \int_{e}\left[u_{\delta}\right] \cdot\left[v_{\delta}\right]\right.\right. \\
&-\sum_{e \subseteq \partial \Omega} \int_{e} v_{\delta} \nabla u_{\delta} \cdot \mathbf{n}-\tau \sum_{e \subseteq \partial \Omega} \int_{e} u_{\delta} \nabla v_{\delta} \cdot \mathbf{n}+\sum_{e \subseteq \partial \Omega} \gamma|e|^{-1} \int_{e} u_{\delta} v_{\delta} \\
&=\sum_{m=1}^{M}\left(f, v_{\delta}\right)_{\Omega_{m}}-\tau \sum_{e \subseteq \partial \Omega} \int_{e} g_{\delta} \nabla v_{\delta} \cdot n+\sum_{e \subseteq \partial \Omega} \gamma|e|^{-1} \int_{e} g_{\delta} v_{\delta} \quad \forall v_{\delta} \in W_{\delta}
\end{aligned}
\label{12.7}\end{equation}

我们将把后者称为DG-N方法（N代表Nitsche）。显然，如果Dirichlet基准$g$为零，右边的最后两个项就不会出现。

关于方法\ref{12.7}离散化泊松问题\ref{3.13}与同质狄里奇边界条件的准确性，让我们引入所谓的能量准则

!!!!
\left\|u_{\delta}\right\|=\left(\sum_{m=1}^{M} \int_{\Omega_{m}}\left|\nabla u_{\delta}\right|^{2}+\sum_{e \in \mathscr{E}_{\delta}} \gamma|e|^{-1} \int_{e}\left[u_{\delta}\right]^{2}+\sum_{e \subseteq \partial \Omega} \gamma|e|^{-1} \int_{e}\left|u_{\delta}\right|^{2}\right)^{1 / 2}
\label{12.8}\end{equation}

对于强加边界条件的公式\ref{12.5），最后一项是缺失的。可以证明，如果精确解足够规则，只要惩罚参数$\gamma$足够大，SIPG方法$(\tau=1)$在$L^{2}(\Omega)$准则和\ref{12.8）中都能以最佳收敛率收敛。更好的说法是，对于度数为$r$的有限元，有

!!!!
h\left\|u-u_{\delta}\right\|+\left\|u-u_{\delta}\right\|_{L^{2}(\Omega)} \leq C h^{r+1}|u|_{H^{r+1}(\Omega)}
\label{12.9}\end{equation}

其中$C$是一个适当的正数，取决于$r$（证明见[ABCM02] ，例如）。一如既往，$r$是每个元素$\Omega_{m}$上采用的多项式程度。对于非对称方法NIPG和IIPG，由于这些方案在邻接问题上不是强一致的，所以不能得到最佳的$L^{2}$估计。然而，在许多情况下，当近似度为奇数且网格足够规则时，这两种方法都表现出最佳的收敛率（见例如[OBB98] ）。

对于我们所看到的DG-N方法的所有变体，可以证明如果$u \in$ $H^{s+1}(\Omega), s \geq 1$ ，并且如果多项式程度$r$满足$r \geq s$，则可以用能量准则\ref{12.8）估计误差如下

!!!!
\left\|\left.\left|u-u_{\delta} \| \leq C\left(\frac{h}{r}\right)^{s} r^{1 / 2}\right| u\right|_{H^{s+1}(\Omega)}\right.
\label{12.10}\end{equation}

其中$C$是一个合适的正常数，不依赖于$r$ 。对于SIPG方法$(\tau=1)$和IIPG方法$(\tau=0)$，只要惩罚参数$\gamma$足够大，估计\ref{12.10} 就会成立。特别是，当精确解$u$是分析的时候，$r$的收敛性是指数级的。让我们也注意到，通过与光谱元素的已知结果相比较，\ref{12.10} 在近似度$r$方面是次优的，因为存在因子$r^{1 / 2}$。更多的细节可以在[RWG99, RWG01, HSS02, PS03]中找到，例如。

在某些特殊情况下，人们可以获得$r$的最优估计。例如，对于四边形网格的二维情况，[GS05]在假设解局部属于富集的Sobolev空间的情况下，提供了能量规范的最优估计。不同的估计，在[SW10]中被证明，没有额外的正则性假设，但在同质的Dirichlet边界条件下。

在本节的最后，我们注意到有时公式\ref{12.7）即使没有跳跃的惩罚项也是稳定的，即对内部边和外部边也选择$\gamma=0$。Rivière, Wheeler和Girault [RWG99]证明了非对称版本$(\tau=-1)$，在文献中被称为Baumann-Oden方法[OBB98]，如果近似度$r$满足$r \geq 2$，则是稳定的并提供最佳误差估计（以能量准则）。在这种情况下，我们使用$u^{I}$的特殊插值$u$，称为Morley插值，对于这种插值$\left\{\nabla_{h}\left(u-u^{I}\right)\right\}=0$在每个边上。在Brezzi和Marini的文章中[BM06]（也见[BS08]），证明了Baumann-Oden方法（其非对称化身，与$\tau=-1$）在二维三角网格中是稳定的，只要我们为每个元素的线性多项式空间添加一个气泡函数。Baumann-Oden方法在[ABM09]中被证明在向线性多项式$n-2$添加气泡时是稳定的（总是在二维中）。
 ![](https://cdn.mathpix.com/cropped/10058ab4e7f0c5bd6fe5bcd4db204623-297.jpg?height=292&width=718&top_left_y=115&top_left_x=95)

图12.2.研究方法\ref{12.5）的收敛性$\left(\tau=1, \gamma=10 r^{2}\right)$ 。左图：能量准则\ref{12.8）和$L^{2}(\Omega)$准则$(r=1$的误差，结构化三角网格）。右图：直角坐标网格序列上的双曲线和双立方体元素的能量准则误差

对于每个元素，涉及$n$ -gons（具有$n$边的多边形）的分解。最后，我们提到Burman等人[BEMS07]证明了如果$r \geq 2$的一维对称变体$(\tau=1)$不需要稳定化。

要了解更多关于DG型方法的信息，读者应该参考，例如 [Riv08] , [HW08] , [ABCM02] , [Woh01] 。

我们现在介绍一些用非连续Galerkin方法得到的关于$\Omega=(0,1)^{2}$的同质Dirichlet问题\ref{3.13} 的数值结果，其中强制项$f$是这样的，精确解为$u\left(x_{1}, x_{2}\right)=\left(x_{1}-x_{1}^{2}\right) \exp \left(3 x_{1}\right) \sin \left(2 \pi x_{2}\right)$ 。我们讨论了方法 \ref{12.5} 与 $\tau=1$ 和惩罚常数 $\gamma=10 r^{2}$ 。这样的选择确保了SIPG方法是很好的定位。然后，$\left\{\Omega_{m}\right\}$只不过是有限元（三角形），$r$是每个元素上的多项式程度。在接下来的数值实验中，$\mathscr{E}_{\delta}$因此是网格中所有内边的联合。误差是以$L^{2}(\Omega)$准则和能量准则\ref{12.8）计算的。图$12.2$（左）显示了由线性元素$(r=1)$构成的三角网格序列上计算的（归一化）误差。正如\ref{12.9}所预测的，误差在能量准则中线性趋于零，在$L^{2}(\Omega)$中四次趋于零。在图$12.2$（右图）中，我们可以读到在一连串具有双二次元$(r=2)$和双三次元$(r=3)$的直角坐标网格上计算的（归一化）误差。当$h \rightarrow 0$时，规范\ref{12.8}中的近似误差趋于零，收敛顺序等于$r$。

在谱元的框架内，我们可以从四边形中的$\Omega$分区开始，使用公式\ref{12.7），用局部GLL正交公式代替体积积分$(\cdot, \cdot)_{\Omega_{m}}$，获得DG-SEM公式；同样，在谱元的边缘上扩展的积分也是如此。

\subsection{The mortar method}

DG技术的一个替代方法是基于所谓的砂浆法，起源于谱元法（SEM）的框架中。

让我们再次考虑域$\Omega \subset \mathbb{R}^{2}$中的泊松问题\ref{3.13} ，其边界条件为同质的迪里希特。

在$\Omega$上定义一个分区，分为成对不相邻的非空的开放子区域$\Omega_{i} \subset \Omega$ ，$i=1, \ldots, M$，这样$\bar{\Omega}=\cup_{i=1}^{M} \bar{\Omega}_{i}$ 。然后让$\Gamma_{i j}=\Gamma_{j i}=\partial \Omega_{i} \cap \partial \Omega_{j}$成为$\Omega_{i}$和$\Omega_{j}, 1 \leq i \neq j \leq M$之间的界面，并定义$\Gamma=\cup_{i j} \Gamma_{i j}$为其联合体（图12.3）。

用砂浆法解决\ref{3.13} 意味着找到一个离散解$u_{\delta}$，在每个子区域$\Omega_{i}$内，是连续和多项式的（全局或局部），并且满足界面$\Gamma$上的连续性条件，称为弱或整体：即对于每个$i, j$与$1 \leq i \neq j \leq M

!!!!
\int_{\Gamma_{i j}}\left(\left.u_{\delta}\right|_{\Omega_{i}}-\left.u_{\delta}\right|_{\Omega_{j}}\right) \psi=0 \quad \forall \psi \in \tilde{\Lambda}
\label{12.11}\end{equation}

其中$\tilde{\Lambda}$是一个合适的有限维空间，取决于在$\Omega_{i}$上选择的离散化。在\ref{12.11}中加入了位于界面$\Gamma$上的某些点的强连续性约束。

请注意，方程\ref{12.11} 并不强迫解的跳变在界面上消失，但它们规定其$L^{2}$在$\tilde{\Lambda}$上的投影为零。因此，与Galerkin类型的近似所发生的情况相反（见第4章和第10章），一般来说，$u_{\delta} \notin H_{0}^{1}(\Omega)$而不是$u_{\delta} \in W$ (见\ref{12.1})) 。

为了简化讨论，让我们考虑$\Omega$在$M=2$子区域$\Omega_{1}, \Omega_{2}$中的分区，并称$\Gamma$为界面，因此$\Gamma=\Gamma_{12}=\Gamma_{21}$ 。在$\Omega_{i}, i=1,2$中，我们在三角形或四边形$T_{i, k}$中进一步定义了一个分区$\mathscr{T}_{i}=\cup_{k} T_{i, k}$，如在第1节中所解释的那样。  $6.2$ .

如果元素$T_{i, k}$是四边形，我们还要求每个$T_{i, k}$是参考元素$\widehat{T}=(-1,1)^{2}$在光滑偏射$\varphi_{i, k}$下的图像，见第10.1节。鉴于每个$\Omega_{i}$中的多项式插值度$N_{i} \geq 1$，定义

!!!!
V_{N_{i}}\left(T_{i, k}\right)=\left\{v \in C^{0}\left(\overline{T_{i, k}}\right): v \circ \varphi_{i, k} \in \mathbb{Q}_{N_{i}}(\widehat{T})\right\}
$$

其中$\mathbb{Q}_{N}(\widehat{T})$是参考元素$T$中每个变量的度数$N$多项式的空间（参见定义\ref{10.2} ）。
 ![](https://cdn.mathpix.com/cropped/10058ab4e7f0c5bd6fe5bcd4db204623-298.jpg?height=194&width=580&top_left_y=1004&top_left_x=166)

图12.3.域$\Omega$的两种可能的分区，只画了一个界面$\Gamma_{i j}$。 对于三角形分区，我们考虑的是第12节的有限元空间。  对于$4.5$，对于$i=1,2$和任何$T_{i, k} \in \mathscr{T}_{i}$的集合

!!!!
X_{\delta_{i}}\left(T_{i, k}\right)=\left\{\begin{array}{l}
\mathbb{P}_{r_{i}}\left(T_{i, k}\right) \text { for finite elements of degree } r_{i} \text { on triangles, } \\
V_{N_{i}}\left(T_{i, k}\right) \text { for spectral elements of degree } N_{i} \text { on quadrilaterals. }
\end{array}\right.
\label{12.12}\end{equation}

参数$\delta_{i}$隐含地取决于学位$\left(r_{i}\right.$或$\left.N_{i}\right)$以及$\mathscr{T}_{i}$元素的最大直径$h$ 。

由$\Omega_{i}, i=1,2$中的局部离散化引起的有限维空间，则是

!!!!
V_{i, \delta_{i}}=\left\{v_{\delta} \in C^{0}\left(\bar{\Omega}_{i}\right):\left.v_{\delta}\right|_{T_{i, k}} \in X_{\delta_{i}}\left(T_{i, k}\right), \forall T_{i, k} \in \mathscr{T}_{i}\right\}
\label{12.13}\end{equation}

和离散解$u_{\delta}$必须寻求在

!!!!
Y_{\delta}=\left\{v_{\delta} \in L^{2}(\Omega): v_{\delta}^{(i)}=v_{\delta \mid \Omega_{i}} \in V_{i, \delta_{i}}, \text { for } i=1,2\right\}
$$

由于空间$Y_{\delta}$没有保留如何在界面上匹配函数$v_{\delta}^{(i)}$的信息，我们必须引入一个满足\ref{12.11}的函数的子空间$V_{\delta} \subset Y_{\delta}$，并在$V_{\delta}$内搜索臼齿解$u_{\delta}$ 。

首先让我们观察一下，一个子域的网格和多项式程度的选择与另一个子域的选择完全无关，如图$12.4$所示。

在左边，我们有一个谱离散化，在$\Omega_{i}$中，$\bar{\Omega}_{1} \cap \Gamma$和$\bar{\Omega}_{2} \cap \Gamma$的元素边缘重合，但度数$N_{1}, N_{2}$不同（因此内插节点与正交节点也不同）。在这种情况下，我们习惯上讲的是多项式的不一致性。

中间的图$12.4$显示了离散化（通过两个空间的谱元$\Omega_{i}$），$\Omega_{1}$和$\Omega_{2}$的每个谱元的多项式程度相同，但现在$\bar{\Omega}_{1} \cap \Gamma$和$\bar{\Omega}_{2} \cap \Gamma$的谱元的边缘不重合。这样我们就出现了几何上的不一致。

最后，在图 $12.4$ 中，右图，我们在 $\Omega_{1}$ 上用谱元进行离散，在 $\Omega_{2}$ 中用三角有限元进行离散。

用$\mathscr{M}_{i}$表示由$\Omega_{i}$中选择的离散化引起的节点集。在光谱情况下，这些节点是定义在$T_{i, k}$上的Gauss-Legendre-Lobatto点的图像（见第10.2.3节）。同样的离散化在$\Gamma$上引起两个不同的节点集（不一定是不相交的），我们用$\mathscr{M}_{i}^{\Gamma}=\mathscr{M}_{i} \cap \Gamma$表示，在$\Gamma$上引起两个自由度集$\mathscr{U}_{i}^{\Gamma}$，其元素是$\mathscr{M}_{i}^{\Gamma}$节点上的函数$u_{\delta}^{(i)}$的值。

在$\Gamma$上的两组自由度中，有一组被称为钵体或主集，被挑选出来在问题的表述中发挥积极作用，这意味着其自由度是问题的基本未知数。另一个集，称为非臼齿集或从属集，表征连续性条件投射到的空间$\tilde{\Lambda}$。集合$\mathscr{U}_{1}^{\Gamma}$和$\mathscr{U}_{2}^{\Gamma}$的自由度将通过积分条件\ref{12.11} 规定的线性关系而相互依赖。

分别用$m, s \in\{1,2\}$标记主集$\mathscr{U}_{m}^{\Gamma}$和从集$\mathscr{U}_{s}^{\Gamma}$，并让$\mathscr{N}_{\text {master }}, \mathscr{N}_{\text {slave }}$为它们的心性。子标$m$和$s$传递到子域。
 ![](https://cdn.mathpix.com/cropped/10058ab4e7f0c5bd6fe5bcd4db204623-300.jpg?height=222&width=716&top_left_y=112&top_left_x=97)

图12.4.左图：用四边形谱系元素离散，具有多项式的不符合性；中图：用谱系元素的几何不符合性；右图：用谱系元素和有限元离散。

例如，我们将有$\Omega_{m}, N_{m}$等用于主域，$\Omega_{s}, N_{s}$用于从属域的多项式程度和图片中的所有其他数量。在我们的研究中，$\mathscr{U}_{1}^{\Gamma}$扮演主人的角色，而$\mathscr{U}_{2}^{\Gamma}$则扮演从者的角色。

对于问题离散化的有限元或谱元的选择从现在开始需要单独的论证。因此，让我们假设在$\Omega_{1}, \Omega_{2}$中只使用谱元素或有限元素；我们将在$12.8$节中看到如何处理混合情况。

\subsubsection{Characterization of the space of constraints by spectral elements}

用$\mathscr{E}_{s}^{\Gamma}$表示从属域$\Omega_{s}$中位于$\Gamma$上的谱元边缘的集合，并设

!!!!
\tilde{\Lambda}_{\delta}=\operatorname{span}\left\{\psi \in L^{2}(\Gamma):\left.\psi\right|_{e} \in \mathbb{P}_{N_{s}-2} \quad \forall e \in \mathscr{E}_{s}^{\Gamma}\right\}
\label{12.14}\end{equation}

和

!!!!
P_{\delta}=\left\{\mathbf{p} \in \mathscr{M}_{s}^{\Gamma}: \mathbf{p} \text { is the endpoint of an edge } e \in \mathscr{E}_{s}^{\Gamma}\right\}
\label{12.15}\end{equation}

为了使$\widetilde{\Lambda}_{\delta}$的定义有意义，我们必须采取$N_{s} \geq 2$ 。（$N_{s}=1$的情况可以简化为$\mathbb{Q}_{1}$类型的有限元表述）。

我们想用一个基来描述空间$\widetilde{\Lambda}_{\delta}$的特征，这个基的$L^{2}(\Gamma)$-函数只在一条边$e \in \mathscr{E}_{s}^{\Gamma}$上有支持，并且在这条边上与$N_{s}-2$上的$N_{s}-1$Gauss-Legendre正交节点相关的Lagrange特征多项式相吻合（见[CHQZ06，公式（2.3.10）]）。图12.5，左边，显示了支持在$\mathscr{E}_{s}^{\Gamma}$的第二条边上的$\widetilde{\Lambda}_{\delta}$的基础的函数$\psi_{l}$，并与$e$中的第一个Gauss-Legendre节点相关。

很容易看出，$\widetilde{\Lambda}_{\delta}$的维度等于$\left(N_{s}-1\right)$乘以$\mathscr{E}_{s}^{\Gamma}$的cardinality ，而$\operatorname{dim}\left(\widetilde{\Lambda}_{\delta}\right)+\operatorname{dim}\left(P_{\delta}\right)=\mathscr{N}_{\text {slave }}$ 。在图$12.6$的例子中，我们固定了$N_{s}=4$，所以$\operatorname{dim}\left(P_{\delta}\right)=3, \operatorname{dim}\left(\widetilde{\Lambda}_{\delta}\right)=6$和$\mathscr{N}_{\text {slave }}=9$ 。

\subsubsection{Characterization of the space of constraints by finite elements}

现在我们用$\mathscr{E}_{s}^{\Gamma}$表示$\Omega_{s}$位于$\Gamma$上的边的集合，如图12.7，左边，用$\mathscr{E}_{s, \delta}^{\Gamma}$表示$T_{s, k}$上的从属集合的三角形的边（图$12.7$ ，右边$)$ 。

集$P_{\delta}$的定义与\ref{12.15}相同，而解的跳跃的投影空间为

!!!!
\begin{gathered}
\tilde{\Lambda}_{\delta}=\operatorname{span}\left\{\psi \in L^{2}(\Gamma):\left.\psi\right|_{e} \in \mathbb{P}_{r_{s}}(e) \quad \forall e \in \mathscr{E}_{s, \delta}^{\Gamma} \text { such that } \bar{e} \cap P_{\delta}=\emptyset\right. \\
\left.\left.\psi\right|_{e} \in \mathbb{P}_{r_{s}-1}(e) \quad \forall e \in \mathscr{E}_{s, \delta}^{\Gamma} \text { such that } \bar{e} \cap P_{\delta} \neq \emptyset\right\}
\end{gathered}
\label{12.16}\end{equation}

其中$\mathbb{P}_{r}(e)$是区间$r$上的单变量度数多项式。

图$12.7$ ，右图描述了空间$\widetilde{\Lambda}_{\delta}$在界面$\Gamma$的整流上的一个通用函数。

为了在有限元$\mathbb{P}_{1}$的情况下描述\ref{12.16} 的基础，我们用$\mathbf{x}_{j}^{e}\left(j=1, \ldots, N_{s}+1\right)$表示属于$\mathscr{M}_{s}^{\Gamma} \cap \bar{e}$的节点，其中$e$是$\mathscr{E}_{s}^{\Gamma}$的边（见图$12.7$ ，左）。
 ![](https://cdn.mathpix.com/cropped/10058ab4e7f0c5bd6fe5bcd4db204623-301.jpg?height=150&width=624&top_left_y=588&top_left_x=147)

图12.5.左图：$\widetilde{\Lambda}_{\delta}$中用于谱元离散化的函数；右图：$\widetilde{\Lambda}_{\delta}$中用于有限元离散化的函数

![](https://cdn.mathpix.com/cropped/10058ab4e7f0c5bd6fe5bcd4db204623-301.jpg?height=137&width=432&top_left_y=816&top_left_x=239)

图12.6.$\Gamma$上的黑点代表从属集合$\mathscr{M}_{s}^{\Gamma}$的节点。

![](https://cdn.mathpix.com/cropped/10058ab4e7f0c5bd6fe5bcd4db204623-301.jpg?height=172&width=303&top_left_y=1009&top_left_x=166)
 ![](https://cdn.mathpix.com/cropped/10058ab4e7f0c5bd6fe5bcd4db204623-301.jpg?height=172&width=576&top_left_y=1009&top_left_x=166) space \ref{12.16} on a rectification of the interface $\Gamma$ The basis functions of $\widetilde{\Lambda}_{\delta}$ are functions in $L^{2}(\Gamma)$ that have one edge $e \in \mathscr{E}_{s}^{\Gamma}$ as support, and are associated to the inner nodes of $e$; for $j=3, \ldots, N_{s}-1$ they coincide with the piecewise-linear functions of the Lagrangian basis associated to nodes $\mathbf{x}_{j}^{e}$, while for $j=2$ (resp. $j=N_{s}$ ) the function $\psi_{j}$ equals 1 on the segment $\left[\mathbf{x}_{1}^{e}, \mathbf{x}_{2}^{e}\right]$ (resp. $\left.\left[\mathbf{x}_{N_{e}}^{e}, \mathbf{x}_{N_{e}+1}^{e}\right]\right)$ and on the rest of $e$ it coincides with the piecewise-linear characteristic Lagrange function for node $\mathbf{x}_{2}^{e}\left(\right.$ resp. $\left.\mathbf{x}_{N_{\mathrm{s}}}^{e}\right)$.

图$12.5$ ，右图是空间\ref{12.16} 的基函数$\psi_{l}$，支持在$\mathscr{E}_{s}^{\Gamma}$的第二条边。

\subsection{Mortar formulation for the Poisson problem}

在这个时候，我们可以确定空间$V_{\delta}$的特征，在其中寻找问题\ref{3.13} 的砂浆解。我们将说一个函数$v_{\delta} \in Y_{\delta}$满足砂浆条件，如果。

!!!!
\begin{cases}\int_{\Gamma}\left(v_{\delta}^{(m)}-v_{\delta}^{(s)}\right) \psi=0 & \forall \psi \in \widetilde{\Lambda}_{\delta} \\ v_{\delta}^{(m)}(\mathbf{p})=v_{\delta}^{(s)}(\mathbf{p}) & \forall \mathbf{p} \in P_{\delta}\end{cases}
\label{12.17}\end{equation}

而且我们还设置了

!!!!
V_{\delta}=\left\{v_{\delta} \in Y_{\delta}: v_{\delta} \text { satisfies conditions \ref{12.17} and } v_{\delta}=0 \text { on } \partial \Omega\right\} \text {. }
\label{12.18}\end{equation}

因此，$(3.13)$的砂浆配方为

!!!!
\text { find } u_{\delta} \in V_{\delta}: \quad \sum_{i=1}^{2} a_{i}\left(u_{\delta}^{(i)}, v_{\delta}^{(i)}\right)=\sum_{i=1}^{2} \int_{\Omega_{i}} f v_{\delta}^{(i)} \quad \forall v_{\delta} \in V_{\delta}
\label{12.19}\end{equation}

其中$a_{i}\left(u_{\delta}^{(i)}, v_{\delta}^{(i)}\right)$是双线性形式$a\left(u_{\delta}, v_{\delta}\right)$对$\Omega_{i}$的限制，或者可能是在使用Galerkin类型的数值积分公式（G-NI，见第10章）时通过高斯类型的正交公式对其进行离散化。

因此，砂浆解决方案在界面$\left(e \in \mathscr{E}_{S}^{\Gamma}\right)$的每条从属边$\Gamma$上满足一个弱连续性条件，在从属边的端点$\left(\mathbf{p} \in P_{\delta}\right)$上满足一个点匹配条件。在[Bel99, BM94]中，提出了一个替代的砂浆配方，其中没有条件\ref{12.17} {2}。从计算上讲，这种表述对$\mathbb{R}^{3}$中的域不是很有利。

当处理频谱近似时，如果$\Omega_{m}$和$\Omega_{s}$中的分区在$\Gamma$上是几何符合的，并且主域上的频谱插值度$N_{m}$不大于从域度$N_{s}$，那么条件\ref{12.17} 迫使$\Gamma$的所有部分具有强连续性。只有当$N_{m}>N_{s}$的解$u_{\delta}$在界面上是不连续的。文献中只将这后一种近似标记为砂浆或不符合要求，其中离散解$u_{\delta}$与连续解不属于同一空间。

对于有限元逼近，即使$\Omega_{m}$和$\Omega_{s}$中的插值度相等，每次$\mathscr{M}_{m}^{\Gamma}$和$\mathscr{M}_{s}^{\Gamma}$集合不同时，我们都有不符合性。只要我们采用谱元离散化，就可以证明（[BMP94]），如果连续问题\ref{3.13} 的解$u$和函数$f$在每个子域$\Omega_{i}$上都足够规则，即$u_{\mid \Omega_{i}} \in H^{\sigma_{i}}\left(\Omega_{i}\right)$与$\sigma_{i}>\frac{3}{2}$，$f_{\mid \Omega_{i}} \in H^{\rho_{i}}\left(\Omega_{i}\right)$与$\rho_{i}>1, i=1, \ldots, M$，则

!!!!
\left\|u-u_{\delta}\right\| \leq C\left(\sum_{i=1}^{M} N_{i}^{1-\sigma_{i}}\left\|u_{\mid \Omega_{i}}\right\|_{H^{\sigma_{i}}\left(\Omega_{i}\right)}+N_{i}^{-\rho_{i}}\left\|f_{\mid \Omega_{i}}\right\|_{H^{\rho_{i}}\left(\Omega_{i}\right)}\right)
\label{12.20}\end{equation}

其中$\|v\|$代表所谓的$H^{1}$破碎规范，即

!!!!
\|v\|=\left(\sum_{i=1}^{M}\left\|v_{\mid \Omega_{i}}\right\|_{H^{1}\left(\Omega_{i}\right)}^{2}\right)^{1 / 2}
$$

对于有限元素，称$h_{i}$为三角形$T_{i, k}$的最大直径，可以证明，如果$u_{\mid \Omega_{i}} \in H^{\sigma_{i}}\left(\Omega_{i}\right)$与$\sigma_{i}>\frac{3}{2}$，则

!!!!
\left\|u-u_{\delta}\right\| \leq C \sum_{i=1}^{M} h_{i}^{\min \left\{\sigma_{i}, r_{i}+1\right\}-1}\left\|u_{\mid \Omega_{i}}\right\|_{H^{\sigma_{i}}\left(\Omega_{i}\right)}
\label{12.21}\end{equation}

\subsection{Choosing basis functions}

为了解决问题\ref{12.19} ，让我们讨论如何定义基函数 $v_{\delta} \in$ $V_{\delta}$ 。用表示

- $\varphi_{k^{\prime}}^{(m)}, k^{\prime}=1, \ldots, \mathscr{N}_{\Omega_{m}}$ , $\Omega_{m}$ 中与$\mathscr{M}_{m} \backslash \mathscr{M}_{m}^{\Gamma} ;$ 的节点相关的拉格朗日特征函数，这些属于空间$V_{m, \delta_{m}}$，在$\Gamma$上相同消失 - $\varphi_{k^{\prime \prime}}^{(s)}, k^{\prime \prime}=1, \ldots, \mathscr{N}_{\Omega_{s}}$ , $\Omega_{s}$ 中与$\mathscr{M}_{s} \backslash \mathscr{M}_{s}^{\Gamma} ;$ 的节点相关的拉格朗日特征函数，它们属于$V_{s, \delta_{s}}$ ，在$\Gamma$ 上无效。

- $\mu_{k}^{(m)}, k=1, \ldots, \mathscr{N}_{\text {master }}$ ，拉格朗日的特征函数在$\Omega_{m}$中与$\mathscr{M}_{m}^{\Gamma} ;$的节点相关，它们属于$V_{m, \delta_{m}}$，在$\mathscr{M}_{m} \backslash \mathscr{M}_{m}^{\Gamma}$的节点上消失。

- $\mu_{j}^{(s)}, j=1, \ldots, \mathscr{N}_{\text {slave }}$ ，$\Omega_{s}$中的拉格朗日特征函数与$\mathscr{M}_{s}^{\Gamma} ;$的节点相关，这些属于$V_{s, \delta_{s}}$，在$\mathscr{M}_{s} \backslash \mathscr{M}_{s}^{\Gamma}$的节点上为零。

- $\mu_{k}, k=1, \ldots, \mathscr{N}_{\text {master }}$，与$\Gamma$的主动（或主）节点相关的基础函数，因此定义为

!!!!
\mu_{k}= \begin{cases}\mu_{k}^{(m)} \in V_{m, \delta_{m}} & \text { such that } \mu_{k}^{(m)}(\mathbf{x})=0 \quad \forall \mathbf{x} \in \mathscr{M}_{m} \backslash \mathscr{M}_{m}^{\Gamma} \\ \tilde{\mu}_{k}^{(s)} \in V_{s, \delta_{s}} & \text { such that } \tilde{\mu}_{k}^{(s)}(\mathbf{x})=0 \quad \forall \mathbf{x} \in \mathscr{M}_{s} \backslash \mathscr{M}_{s}^{\Gamma}\end{cases}
\label{12.22}\end{equation}

其中$\tilde{\mu}_{k}^{(s)}$是$\mathscr{N}_{\text {master }}$中的函数，我们可以通过矩形矩阵$\Xi=\left[\xi_{j k}\right]$写成$\mu_{j}^{(s)}$的线性组合。

!!!!
\tilde{\mu}_{k}^{(s)}=\sum_{j=1}^{\mathscr{N}_{\text {slave }}} \xi_{j k} \mu_{j}^{(s)}, \quad \text { for } k=1, \ldots, \mathscr{N}_{\text {master }}
\label{12.23}\end{equation}



![](https://cdn.mathpix.com/cropped/10058ab4e7f0c5bd6fe5bcd4db204623-304.jpg?height=128&width=698&top_left_y=116&top_left_x=106)

图12.8.对谱元近似的三个函数$\mu_{k}$界面的限制。灰色的是与主自由度相关的轨迹，黑色的是从属轨迹

很容易检查出

!!!!
V_{\delta}=\operatorname{span}\left\{\varphi_{k^{\prime}}^{(m)}, \varphi_{k^{\prime \prime}}^{(s)}, \mu_{k}\right\}
\label{12.24}\end{equation}

图$12.8$显示了三个不同函数$\mu_{k}$对谱元离散化的限制。左边是与$\mathscr{M}_{m}^{\Gamma}$中的节点相关的函数$\mu_{k}$，但在$\mathscr{M}_{s}^{\Gamma}$中没有，用于几何上不符合要求的分区；右边也是如此，但用于符合要求的分区。中间的函数$\mu_{k}$与$\mathscr{M}_{m}^{\Gamma} \cap \mathscr{M}_{s}^{\Gamma}$中的一个节点相关。

虽然我们可以通过使用迪里希特条件消除与$\partial \Omega$的节点相关的函数$\varphi_{k^{\prime}}^{(m)}$和$\varphi_{k^{\prime \prime}}^{(s)}$，但我们保留所有的$\mu_{k}^{(m)}, \mu_{j}^{(s)}$和$\mu_{k}$ ，因为如果迪里希特条件是非均质的，函数$\tilde{\mu}_{k}^{(s)}$也取决于与$\partial \Omega \cap \partial \Gamma$ 的节点相关的$\mu_{j}^{(s)}$ 。

由于函数$\varphi_{k^{\prime}}^{(m)}$和$\varphi_{k^{\prime \prime}}^{(s)}$在$\Gamma$上消失，施加$v_{\delta} \in V_{\delta}$，即砂浆条件\ref{12.17}，就等于要求对$k=1, \ldots, \mathscr{N}_{\text {master }}

!!!!
\begin{cases}\int_{\Gamma}\left(\mu_{k}^{(m)}-\tilde{\mu}_{k}^{(s)}\right) \psi_{\ell}=0 & \forall \psi_{\ell} \in \widetilde{\Lambda}_{\delta} \\ \mu_{k}^{(m)}(\mathbf{p})=\tilde{\mu}_{k}^{(s)}(\mathbf{p}) & \forall \mathbf{p} \in P_{\delta}\end{cases}
\label{12.25}\end{equation}

等价地，根据 \ref{12.23} ,

!!!!
\begin{cases}\sum_{j=1}^{N_{\text {slave }}} \xi_{j k} \int_{\Gamma} \mu_{j}^{(s)} \psi_{\ell}=\int_{\Gamma} \mu_{k}^{(m)} \psi_{\ell} \quad \forall \psi_{\ell} \in \widetilde{\Lambda}_{\delta} \\ \sum_{j=1}^{\mathscr{S}_{\text {lave }}} \xi_{j k} \mu_{j}^{(s)}(\mathbf{p})=\mu_{k}^{(m)}(\mathbf{p}) \quad \forall \mathbf{p} \in P_{\delta}\end{cases}
\label{12.26}\end{equation}

仍为 $k=1, \ldots, \mathscr{N}_{\text {master }}$ 。

系统\ref{12.26} 可以改写为矩阵形式

!!!!
\sum_{j=1}^{\mathscr{N}_{\text {slave }}} \xi_{j k} P_{\ell j}=\Phi_{\ell k}
\label{12.27}\end{equation}

其中$P$是维数为$\mathscr{N}_{\text {slave }}$的正方形矩阵，$\Phi$是具有$\mathscr{A}_{\text {slave }}$行和$\mathscr{N}_{\text {master }}$列的矩形矩阵，其条目来自\ref{12.26} 的关系。  $P$是非星形的，因为在谱元逼近的情况下，$\mathbb{P}_{N-2}-\mathbb{P}_{N}$满足inf-sup条件（见[BM92]）；同样，对于有限元（[Bel99]），我们对$\Lambda_{\delta}-\mathbb{P}_{1}$有一个inf-sup条件。

因此，矩阵$\Xi$可以通过解决线性系统找到

!!!!
P \Xi=\Phi \text {. }
\label{12.28}\end{equation}

使用适当精确的正交公式计算条目$P_{\ell j}=\int_{\Gamma} \mu_{j}^{(s)} \psi_{\ell}$和$\Phi_{\ell k}=\int_{\Gamma} \mu_{k}^{(m)} \psi_{\ell}$是至关重要的，以确保最佳误差估计（见\ref{12.20} 和\ref{12.21} ）。

\subsection{Choosing quadrature formulae for spectral elements}

条目$P_{\ell j}$只取决于从属域的离散化，所以我们可以重写

!!!!
P_{\ell j}=\int_{\Gamma} \mu_{j}^{(s)} \psi_{\ell}=\sum_{e \in \mathscr{E}_{S}^{\Gamma}} \int_{e} \mu_{j}^{(s)} \psi_{\ell}
$$

并使用GLL正交公式，每条边$N_{s}+1$上有$e \in \mathscr{E}_{s}^{\Gamma}$节点。这些公式精确到$2 N_{s}-1$度，并且由于$\left.\mu_{j}^{(s)}\right|_{e} \in \mathbb{P}_{N_{s}}$和$\left.\psi_{\ell}\right|_{e} \in \mathbb{P}_{N_{s}-2}$，它们精确地计算了条款$P_{\ell j}$。

为了计算元素$\Phi_{\ell k}$，我们需要说明$\Gamma$上是否存在几何符合。如果是，集合$\mathscr{E}_{m}^{\Gamma}$（$\Omega_{m}$中的元素的边缘位于$\Gamma$上）与$\mathscr{E}_{s} \Gamma$重合，我们可以写出

!!!!
\Phi_{\ell k}=\int_{\Gamma} \mu_{k}^{(m)} \psi_{\ell}=\sum_{e \in \mathscr{E}_{s}^{\Gamma}} \int_{e} \mu_{k}^{(m)} \psi_{\ell}
$$

由于$\left.\mu_{k}^{(m)}\right|_{e} \in \mathbb{P}_{N_{m}}$和$\left.\psi_{\ell}\right|_{e} \in \mathbb{P}_{N_{s}-2}$上的每条边$e \in \mathscr{E}_{s}^{\Gamma}$，为了准确计算$e \in \mathscr{E}_{s}^{\Gamma}$上的积分，我们可以使用$N_{q}+1$节点上的高斯勒格正交公式，因为这些公式精确到$2 N_{q}+1$ 度。

另一方面，在几何上不符合要求的情况下，$\mathscr{E}_{s}^{\Gamma}$和$\mathscr{E}_{m}^{\Gamma}$并不重合，在$\mathscr{E}_{s} \Gamma$（或$\left.\mathscr{E}_{m}^{\Gamma}\right)$）的边缘上的复合积分总是会引起很大的正交误差。假设，事实上，我们选择一个与$\mathscr{E}_{m}^{\Gamma}$相关的分区来计算积分$\Phi_{\ell k}$ 。对于每个$e \in \mathscr{E}_{m}^{\Gamma}$，我们有$\left.\mu_{k}^{(m)}\right|_{e} \in \mathbb{P}_{N_{m}}$，但不一定有$\left.\psi_{\ell}\right|_{e} \in \mathbb{P}_{N_{s}-2}$；实际上恰恰相反，对于$\psi_{\ell}$可能在$e \in \mathscr{E}_{m}^{\Gamma}$上是不连续的（图12.9）。如果我们采取$\mathscr{E}_{s}^{\Gamma}$的分区而不是$\mathscr{E}_{m}^{\top}$的分区，也会发生类似的情况。

因此，让我们建立一个新的分区$\mathscr{E}_{f}^{\Gamma}$，它将比$\mathscr{E}_{m}^{\Gamma}$和$\mathscr{E}_{s}^{\Gamma}$更细，其每条边$\tilde{e} \in \mathscr{E}_{f}^{\Gamma}$都只包含在$\mathscr{E}_{m}^{\Gamma}$的一条边和$\mathscr{E}_{s}^{\Gamma}$的一条边中（图12.9）。那么我们可以写成

!!!!
\Phi_{\ell k}=\int_{\Gamma} \mu_{k}^{(m)} \psi_{\ell}=\sum_{\tilde{e} \in \mathscr{E}_{f}^{\Gamma}} \int_{\tilde{e}} \mu_{k}^{(m)} \psi_{\ell}
$$



![](https://cdn.mathpix.com/cropped/10058ab4e7f0c5bd6fe5bcd4db204623-306.jpg?height=189&width=453&top_left_y=107&top_left_x=233)

图12.9.在用$N_{s}=3$进行谱元逼近的情况下，$\mathscr{E}_{s}^{\Gamma}, \mathscr{E}_{m}, \mathscr{E}_{f}^{\Gamma}$上的分区和一个函数$\left.\psi_{\ell}\right|_{e}$。

由于$\left.\mu_{k}^{(m)}\right|_{e} \in \mathbb{P}_{N_{m}}$和$\left.\psi_{\ell}\right|_{\tilde{e}} \in \mathbb{P}_{N_{s}-2}$在每个$\tilde{e} \in \mathscr{E}_{f}^{\Gamma}$上，我们可以在边$\tilde{e}$上使用Gauss-Legendre正交公式（见[CHQZ06]在$N_{q}+1$节点上的$N_{q}=!!!!\max \left\{N_{s}, N_{m}\right\}$ ，因此准确计算$\Phi_{\ell k}$ 。

\subsection{Choosing quadrature formulae for finite elements}

让我们考虑有限元$\mathbb{P}_{1}$的情况，记得$\mathscr{E}_{s} \Gamma$表示$\Gamma$的边的集合，而$\mathscr{E}_{s, \delta}^{\Gamma}$是位于$\Gamma$上的三角形$T_{s, k} \in \mathscr{T}_{s}$的边的集合（图12.7）。

元素$P_{\ell j}$，只取决于从属域的离散化，现在是

!!!!
P_{\ell j}=\int_{\Gamma} \mu_{j}^{(s)} \psi_{\ell}=\sum_{e \in \mathscr{E}_{s, \delta}^{\Gamma}} \int_{e} \mu_{j}^{(s)} \psi_{\ell}
$$

而在每条边$e \in \mathscr{E}_{s, \delta}^{\Gamma}$上，乘积$\mu_{j}^{(s)} \psi_{\ell}$是度数为$\leq 2$的多项式，我们可以用辛普森公式准确地在边$e \in \mathscr{E}_{s, \delta}^{\Gamma}$上积分（例如，见[QSS07]）。

为了计算元素$\Phi_{\ell k}$，我们按照我们在光谱情况下所做的类比进行，在$\Gamma$上没有几何符合。

建立一个比$\mathscr{E}_{m}$和$\mathscr{E}_{s, \delta}^{\Gamma}$更细的分区$\mathscr{E}_{f}^{\Gamma}$，使每条边$\tilde{e} \in \mathscr{E}_{f}^{\Gamma}$只位于$\mathscr{E}_{m}^{\Gamma}$的一条边和$\mathscr{E}_{s, \delta}^{\Gamma}$的一条边上，结果是

!!!!
\Phi_{\ell k}=\int_{\Gamma} \mu_{k}^{(m)} \psi_{\ell}=\sum_{\tilde{e} \in \mathscr{E}_{f}^{\Gamma}} \int_{\tilde{e}} \mu_{k}^{(m)} \psi_{\ell}
$$

$\left.\mu_{k}^{(m)}\right|_{\tilde{e}}$和$\left.\psi_{\ell}\right|_{\tilde{e}}$在每条$\tilde{e} \in \mathscr{E}_{f}^{\Gamma}$上的度数都不超过1，我们可以通过辛普森公式在每条边$\tilde{e}$上精确积分。

当更高阶的有限元出现时，程序是类似的，但条件是用更精确的公式，如Gauss-Legendre公式取代Simpson的公式。

四边形有限元$\mathbb{Q}_{1}$的情况以有限元$\mathbb{P}_{1}$的方式处理，因为拉格朗日基函数$\mathbb{Q}_{1}$和$\mathbb{P}_{1}$在$\Gamma$上的痕迹是一致的，而且空间$\Lambda_{\delta}$对两种元素的定义是一样的。

\subsection{Solving the linear system of the mortar method}

通过求解系统\ref{12.28}找到的系数$\xi_{i j}$确保\ref{12.22} -\ref{12.23} 的函数$\mu_{k}$满足空间$V_{\delta}$的约束，一旦主自由度$\lambda_{k}^{(m)} \in \mathscr{U}_{m}$被知道，就有可能用以下方法计算从属自由度$\lambda_{j}^{(s)} \in \mathscr{U}_{s}$ 。

!!!!
\boldsymbol{\lambda}^{(s)}=\boldsymbol{\Xi} \boldsymbol{\lambda}^{(m)}
\label{12.29}\end{equation}

其中$\boldsymbol{\lambda}^{(s)}=\left[\lambda_{j}^{(s)}\right]_{j=1}^{\mathscr{S}_{\text {slave }}}$和$\boldsymbol{\lambda}^{(m)}=\left[\lambda_{k}^{(m)}\right]_{k=1}^{\mathscr{S}_{\text {master }}}$ 。

当离散化符合$\Gamma$时，矩阵$\Xi$与维度$\mathscr{N}_{\text {master }}=\mathscr{A}_{\text {slave }}$的身份矩阵相吻合。

根据\ref{12.24} ，$V_{\delta}$中的每个函数都可以写成

!!!!
v_{\delta}(\mathbf{x})=\sum_{k^{\prime}=1}^{\mathscr{K}_{1}} u_{k^{\prime}}^{(m)} \varphi_{k^{\prime}}^{(m)}(\mathbf{x})+\sum_{k^{\prime \prime}=1}^{\mathscr{N}_{2}} u_{k^{\prime \prime}}^{(s)} \varphi_{k^{\prime \prime}}^{(s)}(\mathbf{x})+\sum_{k=1}^{\mathscr{Y}_{\text {master }}} \lambda_{k}^{(m)} \mu_{k}(\mathbf{x})
$$

现在改变$v_{\delta} \in \operatorname{span}\left\{\varphi_{k^{\prime}}^{(m)}, \varphi_{k^{\prime \prime}}^{(s)}, \mu_{k}\right\}$并定义向量$\mathbf{u}^{(m)}=\left[u_{k^{\prime}}^{(m)}\right]^{T}, \mathbf{u}^{(s)}=!!!!\left[u_{k^{\prime \prime}}^{(s)}\right]^{T}$，抵押系统\ref{12.19} 读作

!!!!
\left[\begin{array}{ccc}
A_{m m} & 0 & A_{m, \Gamma_{m}} \\
0 & A_{s s} & A_{s, \Gamma_{s}} \Xi \\
A_{\Gamma_{m}, m} & \Xi^{T} A_{\Gamma_{s}, s} & A_{\Gamma_{m}, \Gamma_{m}}+\Xi^{T} A_{\Gamma_{s}, \Gamma_{s}} \Xi
\end{array}\right]\left[\begin{array}{c}
\mathbf{u}^{(m)} \\
\mathbf{u}^{(s)} \\
\boldsymbol{\lambda}^{(m)}
\end{array}\right]=\left[\begin{array}{c}
\mathbf{f}_{m} \\
\mathbf{f}_{s} \\
\mathbf{f}_{\Gamma_{m}}+\Xi^{T} \mathbf{f}_{\Gamma_{s}}
\end{array}\right]
\label{12.30}\end{equation}

上面，对于$i \in\{m, s\}$，我们介绍了矩阵$\left(A_{i i}\right)_{j k}=a_{i}\left(\varphi_{k}^{(i)}, \varphi_{j}^{(i)}\right),\left(A_{i, \Gamma_{i}}\right)_{j k}=!!!!a_{i}\left(\mu_{k}^{(i)}, \varphi_{j}^{(i)}\right),\left(A_{\Gamma_{i}, i}\right)_{k j}=a_{i}\left(\varphi_{j}^{(i)}, \mu_{k}^{(i)}\right),\left(A_{\Gamma_{i}, \Gamma_{i}}\right)_{k \ell}=a_{i}\left(\mu_{\ell}^{(i)}, \mu_{k}^{(i)}\right)$和向量$\left(\mathbf{f}_{i}\right)_{j}=!!!!\int_{\Omega_{i}} f \varphi_{j}^{(i)},\left(\mathbf{f}_{\Gamma_{i}}\right)_{\ell}=\int_{\Omega_{i}} f \mu_{\ell}^{(i)}$，用于与不在边界$\partial \Omega$的节点相关的基函数。

矩阵$\Xi$完全取决于所选择的离散化，一旦离散化的参数被固定，就会建立。

系统\ref{12.30} 可以通过第七章中的直接迭代方法之一来解决。我们可以不求解整个系统\ref{12.30} ，而是求解向量$\boldsymbol{\lambda}^{(m)}$的Schur补码，这包括从系统中消除未知数$\mathbf{u}^{(m)}, \mathbf{u}^{(s)}$（详见第19.3.1节的描述）。让我们定义以下矩阵（称为局部舒尔补）。

!!!!
\Sigma_{i}=A_{\Gamma_{i}, \Gamma_{i}}-A_{\Gamma_{i}, i} A_{i i}^{-1} A_{i, \Gamma_{i}}, \quad \text { for } i=m, s
\label{12.31}\end{equation}

并设置

!!!!
\Sigma=\Sigma_{m}+\Xi^{T} \Sigma_{s} \Xi, \quad \chi=\left(\mathbf{f}_{\Gamma_{m}}-A_{m m}^{-1} \mathbf{f}_{m}\right)+\Xi^{T}\left(\mathbf{f}_{\Gamma_{s}}-A_{s s}^{-1} \mathbf{f}_{s}\right)
$$

现在我们按照菜谱来做。

- 通过求解来计算$\Gamma$上的主自由度。

!!!!
\Sigma \boldsymbol{\lambda}^{(m)}=\boldsymbol{\chi}
\label{12.32}\end{equation}

- 使用线性关系\ref{12.29} 确定$\Gamma$上的从属自由度； - 独立解决$A_{i i} \mathbf{u}^{(i)}=\mathbf{f}_{i}-A_{i, \Gamma_{i}} \boldsymbol{\lambda}^{(i)}, i=1,2$问题。这相当于解决两个在$\Gamma$上有规定轨迹的迪里切特问题。

方程\ref{12.32} 是Steklov-Poincaré方程\ref{19.26} 的离散对应方（见第19章），表达了通过界面的通量的连续性，而不是强连续性，如果$\Gamma$上的离散化是符合的，或者弱连续性，如果$\Gamma$上的表述是砂浆类型。

系统\ref{12.32} 通常通过迭代方法（如共轭梯度法、Bi-CGStab或GMRES）来解决，因为由于矩阵的存在，局部舒尔补码$\Sigma_{i}$没有被明确集合起来$A_{i i}^{-1}$。

对于砂浆公式产生的代数系统，已经提出了各种预处理方法；例如在[AMW99]中，\ref{12.32} 的预处理方法是基于砂浆痕迹空间的分解，即与界面痕迹相关的子空间的直接和（在许多子域的情况下）以及允许减少误差的低频的粗略空间。目前，由于只有两个子域和一个界面，我们用\ref{12.31} 中定义的矩阵$\Sigma_{m}$对系统\ref{12.32} 进行预处理。对于谱元离散化来说，它被证明是最佳的，在这个意义上，迭代方法解决\ref{12.32}到给定公差所需的迭代次数与主域和从域的度数$N_{i}(i=m, s)$无关（图12.13）。对于有限元近似，预处理程序$\Sigma_{m}$降低了方法收敛所需的迭代次数，但现在这个次数确实取决于离散化参数$h$，从图$12.14$的结果可以看出。

\subsection{The mortar method for combined finite and spectral elements}

到此为止，我们看了\ref{12.12}的空间$X_{i, \delta_{i}}(i=m, s)$在两个域$\Omega_{m}, \Omega_{s}$上都是同类的情况，也就是说都是谱系类型或有限元类型。现在我们考虑当我们选择$X_{m, \delta_{m}}$为有限元类型而$X_{s, \delta_{s}}$为谱元类型，或者相反的情况。

首先，注意到空间$V_{i, \delta_{i}}, i=m, s$ ，是由$X_{i, \delta_{i}}$ 自然定义的。约束空间$\Lambda_{\delta}$的定义与从属空间上采用的离散化严格相关，因此，如果$\Omega_{s}$中的离散化是谱式的，$\widetilde{\Lambda}_{\delta}$将被定义为\ref{12.14} ，或如\ref{12.16} 中的有限元。相应的基函数$\psi_{l}$将分别遵守第$12.2 .1$或$12.2 .2$节的定义。

现在我们需要准确计算\ref{12.26} 中出现的积分，这些积分定义了矩阵$P$和$\Phi$的条目。

计算$P_{\ell j}$只是在从属域上选择的离散化问题，所以它是按照$12.5$节中的解释进行的（对于谱系元素在$\Omega_{s}$中）。
 ![](https://cdn.mathpix.com/cropped/10058ab4e7f0c5bd6fe5bcd4db204623-309.jpg?height=122&width=714&top_left_y=123&top_left_x=100)

图12.10.对$\Gamma$的限制$\mu_{k}^{(m)}, \mu_{j}^{(s)}$和谱主/从有限元情况下的函数$\psi_{l}$的限制

![](https://cdn.mathpix.com/cropped/10058ab4e7f0c5bd6fe5bcd4db204623-309.jpg?height=120&width=232&top_left_y=339&top_left_x=103)

![](https://cdn.mathpix.com/cropped/10058ab4e7f0c5bd6fe5bcd4db204623-309.jpg?height=123&width=233&top_left_y=337&top_left_x=346)
 ![](https://cdn.mathpix.com/cropped/10058ab4e7f0c5bd6fe5bcd4db204623-309.jpg?height=126&width=712&top_left_y=334&top_left_x=102) / spectral slave case

或$12.6$节（用于有限元）。计算$\Phi_{\ell k}$需要更加小心，因为它同时涉及到$\Omega_{s}$（通过函数$\psi_{l}$）和$\Omega_{m}$（通过$\left.\mu_{k}^{(m)}\right)$ 。我们将把这两种情况分开，只讨论$\mathbb{P}_{1}$类型的有限元。

案例1：谱系主/从有限元。

函数$\mu_{k}^{(m)}$对$\mathscr{E}_{m}^{\Gamma}$的边$e$的限制是$N_{m}$度的多项式，而对$\psi_{l}$的边的限制最多是1度的多项式（图12.10）。让我们产生一个比$\mathscr{E}_{m}^{\Gamma}$和$\mathscr{E}_{s, \delta}^{\Gamma}$更细的分区$\mathscr{E}_{f}^{\Gamma}$，以便在每个$\tilde{e} \in \mathscr{E}_{f}^{\Gamma}$上，$\mu_{k}^{(m)}, \psi_{l}$的限制是多项式。乘积$\mu_{k}^{(m)} \psi_{l}$的度数最多为$N_{m}+1$，为了准确计算每个积分$\int_{\tilde{e}} \mu_{k}^{(m)} \psi_{l}$，我们可以在$N_{q}+1$的正交节点上使用Gauss-Legendre正交公式，如果$N_{m}$是偶数，就用$N_{q}=N_{m} / 2$，如果$N_{m}$是奇数，则用$N_{q}=\left(N_{m}+1\right) / 2$。

案例2：主有限元/谱系从属。

$\mu_{k}^{(m)}$对$\mathscr{E}_{m, \delta}^{\Gamma}$（$\Gamma$上的三角形$T_{m, k}$的所有边的集合）的边$e$的限制最多为1度的多项式，而$\psi_{l}$对$\mathscr{E}_{s}^{\Gamma}$的边的限制为1度的多项式（图12.11）。我们生成一个比$\mathscr{E}_{m, \delta}^{\Gamma}$和$\mathscr{E}_{s}^{\Gamma}$更细的分区$\mathscr{E}_{f}^{\Gamma}$，因此在每个$\tilde{e} \in \mathscr{E}_{f}^{\Gamma}$上，$\mu_{k}^{(m)}$和$\psi_{l}$的限制是多项式。乘积$\mu_{k}^{(m)} \psi_{l}$的度数最多为$N_{s}+1$，为了准确计算每个$\int_{\tilde{e}} \mu_{k}^{(m)} \psi_{l}$，我们可以采用Gauss-Legendre正交公式，$N_{q}+1$正交节点为$\tilde{e}$，如果$N_{s}$是偶数，则$N_{q}=\left(N_{s}+1\right) / 2$是奇数。

一旦$P$和$\Phi$被计算出来，我们就用\ref{12.28}来计算$\Xi$，然后求解线性系统\ref{12.30}（或者等同于\ref{12.32}，如12.7节所述）。

关于近似误差的分析，我们有最佳收敛性（[BMP94]），这个结果概括了估计\ref{12.20}和\ref{12.21}。在这些方法中$\Omega_{i}(i=1, \ldots, M)$，我们将那些采用谱离散化的方法$\Omega_{i}^{\text {es }}, i=!!!!1, \ldots, M^{e s}$，与那些采用有限元离散化的方法$\Omega_{i}^{e f}, i=1, \ldots, M^{e f}$区分开。

如果连续问题\ref{3.13} 的解$u$和函数$f$在每个子域$\Omega_{i}$上都足够规则，即$u_{\mid \Omega_{i}} \in H^{\sigma_{i}}\left(\Omega_{i}\right)$与$\sigma_{i}>\frac{3}{2}$和$f_{\mid \Omega_{i}^{e s}} \in H^{\rho_{i}}\left(\Omega_{i}^{e s}\right)$对所有$i=1, \ldots, M^{e s}$都有规则，则

!!!!
\begin{gathered}
\left\|u-u_{\delta}\right\| \leq C\left(\sum_{i=1}^{M^{e s}} N_{i}^{1-\sigma_{i}}\left\|u_{\mid \Omega_{i}}\right\|_{H^{\sigma_{i}}\left(\Omega_{i}^{e s}\right)}+N_{i}^{-\rho_{i}}\left\|f_{\mid \Omega_{i}}\right\|_{H^{\rho_{i}}\left(\Omega_{i}^{e s}\right)}\right. \\
\left.\quad+\sum_{i=1}^{M^{e f}} h_{i}^{\min \left\{\sigma_{i}, r_{i}+1\right\}-1}\left\|u_{\mid \Omega_{i}}\right\|_{H^{\sigma_{i}\left(\Omega_{i}^{\text {ef }}\right)}}\right)
\end{gathered}
\label{12.33}\end{equation}

\subsection{Generalization of the mortar method to multi-domain decompositions}

假设我们将域$\Omega$分解为两个以上的子域。前面几节对一个界面的研究必须对分解后的每一个界面重复进行。因此，对于每个接口$\Gamma_{i j}$，我们必须在$\Omega_{i}$和$\Omega_{j}$之间选择哪个为主，哪个为从，然后我们必须将系统\ref{12.25}施加到$\Gamma_{i j}$。因此，对于每个接口$\Gamma_{i j}$都有一个 "局部 "约束空间$\widetilde{\Lambda}_{\delta}$，它取决于在$\Gamma_{i j}$上选择的从属域，而整体的、全局的约束空间将是局部约束的笛卡尔积。在子域$\Omega_{i}$的顶点，位于$\Gamma$的闭合处，我们施加一个连续性条件，与\ref{12.25} {2}相类似。请注意，一个域可能是一个接口的主域和另一个接口的从域，如图12.3，右图。  例如，$\Omega_{3}$可能是$\Gamma_{36}$的主域，而$\Gamma_{35}$和$\Gamma_{32}$的从域。

复杂的分解所产生的问题具体体现在矩阵$P$和$\Phi$的构造中，体现在有效求解$P \Xi=\Phi$的程序中，以及体现在为最终代数系统选择一个好的预处理程序中。因此，砂浆配方应限于少量界面的情况。

\subsection{Numerical results for the mortar method}

考虑泊松问题

!!!!
\begin{cases}-\Delta u=f & \text { in } \Omega=(0,2)^{2} \\ u=g & \text { on } \partial \Omega\end{cases}
\label{12.34}\end{equation}

其中$f$和$g$是这样的：精确解读为$u(x, y)=\sin (\pi x y)+1$ 。将$\Omega$细分为两个子域$\Omega_{1}=(0,1) \times(0,2)$和$\Omega_{2}=(1,2) \times(0,2)$，在这两个子域上我们再引入一个统一的矩形分区，然后用谱元进行离散。

图$12.12$显示了一旦$\Omega_{1}$被指定为主，砂浆解和精确解之间的断裂规范误差。左边是奴隶的程度$N_{s}=$ 。
 ![](https://cdn.mathpix.com/cropped/10058ab4e7f0c5bd6fe5bcd4db204623-311.jpg?height=244&width=712&top_left_y=114&top_left_x=94)

图12.12.问题\ref{12.34}的解的破规范的误差。  $\Omega_{s}=2 \times 2$谱元。左边的从属域$N_{s}=14$的度数被固定，右边的主域$\Omega_{m}$的度数$N_{m}=14$被固定。

$N_{2}=14$是固定的，主度$N_{m}=N_{1}$是变化的，而右边的$N_{1}=14$在主域是固定的，从度是变化的。这两条曲线指的是子域上的不同分区：第一条曲线在几何上符合每个$2 \times 2$的谱元，第二条曲线在$\Omega_{m}$中有$2 \times 3$的谱元，在$\Omega_{s}$中有$2 \times 2$ 。在这两种情况下，误差都是指数级收敛的，直到固定谱度的域中的误差占优。

图$12.13$给出了使用$\Sigma_{m}$作为预处理程序并在停止测试中使用固定容限$\varepsilon=10^{-12}$时，预处理Bi-CGStab方法解决系统\ref{12.32} 所需的迭代次数。请注意，对于符合要求的离散化，在一次迭代后就能达到收敛，而在不符合要求的情况下，需要更多的迭代，尽管它们的数量与多项式度数无关 $N_{m}$ 和 $N_{s}$ 。

图$12.14$显示了用有限元$\mathbb{P}_{1}$逼近问题\ref{12.34} 的数值结果，包括主域$\Omega_{1}$和从域$\Omega_{2}$。函数$f, g$和子域与前面的情况相同。在这两个$\Omega_{i}$中，我们假设

![](https://cdn.mathpix.com/cropped/10058ab4e7f0c5bd6fe5bcd4db204623-311.jpg?height=232&width=338&top_left_y=928&top_left_x=99)
 ![](https://cdn.mathpix.com/cropped/10058ab4e7f0c5bd6fe5bcd4db204623-311.jpg?height=232&width=708&top_left_y=928&top_left_x=98tral elements. The degree is fixed on the slave domain $\Omega_{s}$ on the left, on the master domain $\Omega_{m}$ on the right 

![](https://cdn.mathpix.com/cropped/10058ab4e7f0c5bd6fe5bcd4db204623-312.jpg?height=309&width=433&top_left_y=118&top_left_x=237)

图12.14.迫击炮近似谱主/从有限元在规范$H^{1}$和断规范中的绝对误差

由$2 n_{i} \times 2 n_{i}$个三角形组成的均匀三角形，准确地说是$n_{m} \neq n_{s}:$，$n_{m}=2 k$和$n_{s}=3(k+2)$为$k=5,10,20,40$ 。

在图$12.14$中，我们可以读出随着网格大小$h_{i}$的变化，准则的绝对误差$H^{1}\left(\Omega_{i}\right)$和精确解与砂浆解之间的brokennorm误差：它们相对于$h_{i}$线性减少，与估算值\ref{12.21}一致。使用预处理程序$\Sigma_{m}$并在停止测试中给定公差$\varepsilon=10^{-12}$，预处理Bi-CGStab方法所需的迭代次数与$h_{i}$无关，结果是$\leq 6$。

在图$12.15$中，我们有规范的绝对误差$H^{1}\left(\Omega_{i}\right)$，以及精确解和砂浆解之间的断裂规范误差，随着网格大小$h_{s}$在$\Omega_{s}$中的变化，相对于在主域上用谱元和在从域上用有限元$\left(\mathbb{P}_{1}\right.$或$\left.\mathbb{Q}_{2}\right)$对问题\ref{12.34} 进行近似。函数$f, g$和子域的定义与前面的情况相同。
 ![](https://cdn.mathpix.com/cropped/10058ab4e7f0c5bd6fe5bcd4db204623-312.jpg?height=250&width=716&top_left_y=898&top_left_x=94)

图12.15.迫击炮近似谱主/从有限元的规范$H^{1}$和破碎规范的绝对误差。左边是$\mathbb{Q}_{6}-\mathbb{P}_{1}$ ，右边是$\mathbb{Q}_{8}-\mathbb{Q}_{2}$ 。在这两种情况下，断裂规范的误差线都与规范$H^{1}\left(\Omega_{s}\right)$中的曲线重叠并几乎隐藏了。

![](https://cdn.mathpix.com/cropped/10058ab4e7f0c5bd6fe5bcd4db204623-313.jpg?height=310&width=433&top_left_y=119&top_left_x=237)

图12.16.迫击炮近似主有限元/谱系从属的规范$H^{1}$和破碎规范的绝对误差

左边的错误是指$\Omega_{m}$在$3 \times 3$度的谱元中的分割，$\Omega_{s}$在$2 n_{s} \times 2 n_{s}$等分三角形中的分割，以及$n_{s}=20,40,80,160\left(h_{s}=2 / n_{s}\right)$。右边的错误是指$\Omega_{m}$在$3 \times 3$度的谱元中的分割，$N_{m}=8$，以及$\Omega_{s}$在$n_{s} \times n_{s}$中的相等四边形的分割，有$n_{s}=10,20,40,80\left(h_{s}=2 / n_{s}\right)$ 。

我们注意到有限元从属域的误差像$h_{s}^{r_{s}}$（$r_{s}$是有限元的多项式程度）一样减少，而主域的误差没有达到谱例的精度，因为它对从属域的较差精度很敏感。然而，它随着$h_{s}^{r_{s}+1}$的减少而减少，断裂规范的误差与估计值\ref{12.21} 一致。

在停止测试中，在给定容忍度$\varepsilon=10^{-12}$的情况下，带有预处理程序$\Sigma_{m}$的预处理Bi-CGStab方法需要的迭代次数，在两个测试中都随着$h_{s}$而略有减少，范围从$h_{s}=1 / 10$的8次迭代到$h_{s}=1 / 40$的5次。

在图$12.16$中显示了问题\ref{12.34} 的逼近的数值结果，主域上有有限元$\mathbb{P}_{1}$，从域上有谱元。函数$f, g$和子域的定义与上述情况相同。域$\Omega_{s}$被划分为$4 \times 4$度$N_{s}=6$的谱元，而在$\Omega_{m}$中，我们有$2 n_{m} \times 2 n_{m}$三角形的均匀三角，有$n_{m}=20,40,80,160$。

特别是我们可以看到，随着网格大小$h_{s}$在$\Omega_{s}$中的变化，精确解和砂浆解之间的规范$H^{1}\left(\Omega_{i}\right)$和破碎规范的绝对误差的行为。在主域上采用砂浆逼近，在从域上采用频谱逼近，$\Omega_{m}$和$\Omega_{s}$中的误差都随着$h_{m}$线性下降。这里也是如此，在停止测试中，在给定的容忍度$\varepsilon=10^{-12}$下，带有预处理程序$\Sigma_{m}$的预处理Bi-CGStab方法的迭代次数不取决于$h_{i}$，在所有测试中都是$\leq 8$。

\section{Diffusion-transport-reaction equations}

在这一章中，我们考虑以下形式的问题。

!!!!
\begin{cases}L u=-\operatorname{div}(\mu \nabla u)+\mathbf{b} \cdot \nabla u+\sigma u=f & \text { in } \Omega \\ u=0 & \text { on } \partial \Omega\end{cases}
\label{13.1}\end{equation}

其中$\mu, \sigma, f$和$\mathbf{b}$是给定函数（或常数）。在最一般的情况下，我们将假设$\mu \in \mathrm{L}^{\infty}(\Omega)$与$\mu(\mathbf{x}) \geq \mu_{0}>0, \sigma \in \mathrm{L}^{2}(\Omega)$与$\sigma(\mathbf{x}) \geq 0$a.e. 在$\Omega, \mathbf{b} \in\left[\mathrm{L}^{\infty}(\Omega)\right]^{2}$与$\operatorname{div}(\mathbf{b}) \in \mathrm{L}^{2}(\Omega)$ ，以及$f \in \mathrm{L}^{2}(\Omega)$ 。

在许多实际应用中，扩散项$-\operatorname{div}(\mu \nabla u)$被对流项$\mathbf{b} \cdot \nabla u$（也称为传输项）或反应项$\sigma u$（当$\sigma$为非负时也称为吸收项）所支配。在这种情况下，正如我们将看到的，解决方案可以产生边界层，即通常靠近$\Omega$的边界的区域，其中解决方案的特点是强梯度。

为了推导出这样的模型，并捕捉到与随机行走过程的类比，请参见例如[Sal08，第2章]。

在这一章中，我们分析了确保问题\ref{13.1} 的解的存在和唯一性的条件。我们还考虑了Galerkin方法，说明了它在边界层存在的情况下提供稳定解的困难，最后提出了替代的离散化方法来逼近\ref{13.1} 。

\subsection{Weak problem formulation}

让 $V=\mathrm{H}_{0}^{1}(\Omega)$ 。通过引入双线性形式 $a: V \times V \mapsto \mathbb{R}$ 。

!!!!
a(u, v)=\int_{\Omega} \mu \nabla u \cdot \nabla v d \Omega+\int_{\Omega} v \mathbf{b} \cdot \nabla u d \Omega+\int_{\Omega} \sigma u v d \Omega \quad \forall u, v \in V
\label{13.2}\end{equation}

问题\ref{13.1} 的弱表述为

!!!!
\text { find } u \in V: \quad a(u, v)=(f, v) \quad \forall v \in V \text {. }
\label{13.3}\end{equation}

为了证明\ref{13.3} 的解的存在性和唯一性，我们将使自己处于应用Lax-Milgram定理的条件下。

为了验证双线性形式$a(\cdot, \cdot)$的矫捷性，我们对组成\ref{13.2}的单项单独进行。

对于第一个条款，我们有

!!!!
\int_{\Omega} \mu \nabla v \cdot \nabla v d \Omega \geq \mu_{0}\|\nabla v\|_{\mathrm{L}^{2}(\Omega)}^{2}
\label{13.4}\end{equation}

正如$v \in \mathrm{H}_{0}^{1}(\Omega)$，Poincaré不等式成立（见$\left.(2.13)\right)$；那么

!!!!
\|v\|_{\mathrm{H}^{1}(\Omega)}^{2}=\|v\|_{\mathrm{L}^{2}(\Omega)}^{2}+\|\nabla v\|_{\mathrm{L}^{2}(\Omega)}^{2} \leq\left(1+C_{\Omega}^{2}\right)\|\nabla v\|_{\mathrm{L}^{2}(\Omega)}^{2}
$$

因此，从\ref{13.4} 中可以看出

!!!!
\int_{\Omega} \mu \nabla v \cdot \nabla v d \Omega \geq \frac{\mu_{0}}{1+C_{\Omega}^{2}}\|v\|_{\mathrm{H}^{1}(\Omega)}^{2}
$$

我们现在转到对流项。使用格林公式\ref{3.16} 可以得到

!!!!
\begin{aligned}
\int_{\Omega} v \mathbf{b} \cdot \nabla v d \Omega &=\frac{1}{2} \int_{\Omega} \mathbf{b} \cdot \nabla\left(v^{2}\right) d \Omega=-\frac{1}{2} \int_{\Omega} v^{2} \operatorname{div}(\mathbf{b}) d \Omega+\frac{1}{2} \int_{\partial \Omega} \mathbf{b} \cdot \mathbf{n} v^{2} d \gamma \\
&=-\frac{1}{2} \int_{\Omega} v^{2} \operatorname{div}(\mathbf{b}) d \Omega
\end{aligned}
$$

作为$v=0$在$\partial \Omega$上，因此

!!!!
\int_{\Omega} v \mathbf{b} \cdot \nabla v d \Omega+\int_{\Omega} \sigma v^{2} d \Omega=\int_{\Omega} v^{2}\left(-\frac{1}{2} \operatorname{div}(\mathbf{b})+\sigma\right) d \Omega
$$

最后一个积分当然是正数，如果我们假设

!!!!
-\frac{1}{2} \operatorname{div}(\mathbf{b})+\sigma \geq 0 \quad \text { a.e. in } \Omega
\label{13.5}\end{equation}

因此，双线性形式$a(\cdot, \cdot)$是强制性的，因为

!!!!
a(v, v) \geq \alpha\|v\|_{\mathrm{H}^{1}(\Omega)}^{2} \quad \forall v \in V, \quad \text { with } \quad \alpha=\frac{\mu_{0}}{1+C_{\Omega}^{2}}
\label{13.6}\end{equation}

为了证明双线性形式$a(\cdot, \cdot)$是连续的，即它满足$(2.6)$，我们对\ref{13.2}右边的第一项进行约束，如下所示

!!!!
\begin{aligned}
\left|\int_{\Omega} \mu \nabla u \cdot \nabla v d \Omega\right| & \leq\|\mu\|_{\mathrm{L}^{\infty}(\Omega)}\|\nabla u\|_{\mathrm{L}^{2}(\Omega)}\|\nabla v\|_{\mathrm{L}^{2}(\Omega)} \\
& \leq\|\mu\|_{\mathrm{L}^{\infty}(\Omega)}\|u\|_{\mathrm{H}^{1}(\Omega)}\|v\|_{\mathrm{H}^{1}(\Omega)}
\end{aligned}
\label{13.7}\end{equation}

我们使用了Hölder和Cauchy-Schwarz不等式（见第$2.5$节），以及不等式$\|\nabla w\|_{\mathrm{L}^{2}(\Omega)} \leq\|w\|_{\mathrm{H}^{1}(\Omega)} \forall w \in H^{1}(\Omega)$ 。对于第二项，以类似的方式进行，我们发现

!!!!
\begin{aligned}
&\left|\int_{\Omega} v \mathbf{b} \cdot \nabla u d \Omega\right| \begin{array}{l}
\leq\|\mathbf{b}\|_{\mathrm{L}^{\infty}(\Omega)}\|v\|_{\mathrm{L}^{2}(\Omega)}\|\nabla u\|_{\mathrm{L}^{2}(\Omega)} \\
& \leq\|\mathbf{b}\|_{\mathrm{L}^{\infty}(\Omega)}\|v\|_{\mathrm{H}^{1}(\Omega)}\|u\|_{\mathrm{H}^{1}(\Omega)}
\end{array}
\end{aligned}
\label{13.8}\end{equation}

最后，对于第三项，我们有，再次感谢Cauchy-Schwarz不等式。

!!!!
\left|\int_{\Omega} \sigma u v d \Omega\right| \leq C^{2}\|\sigma\|_{\mathrm{L}^{2}(\Omega)}\|u v\|_{\mathrm{L}^{2}(\Omega)} \leq C^{2}\|\sigma\|_{\mathrm{L}^{2}(\Omega)}\|u\|_{\mathrm{H}^{1}(\Omega)}\|v\|_{\mathrm{H}^{1}(\Omega)}
\label{13.9}\end{equation}

事实上，$\|u v\|_{\mathrm{L}^{2}(\Omega)} \leq\|u\|_{\mathrm{L}^{4}(\Omega)}\|v\|_{\mathrm{L}^{4}(\Omega)} \leq C^{2}\|u\|_{\mathrm{H}^{1}(\Omega)}\|v\|_{\mathrm{H}^{1}(\Omega)}$，在应用了不等式\ref{2.18}和利用了包容\ref{2.19}之后，$C$是包容常数。将\ref{13.7} 、\ref{13.8} 和\ref{13.9} 逐项相加，通过采取例如以下措施，可得出连续性属性$(2.6)$。

!!!!
M=\|\mu\|_{L^{\infty}(\Omega)}+\|\mathbf{b}\|_{\mathrm{L}^{\infty}(\Omega)}+C^{2}\|\sigma\|_{\mathrm{L}^{2}(\Omega)}
\label{13.10}\end{equation}

另一方面，由于Cauchy-Schwarz不等式和Poincaré不等式\ref{2.13}，\ref{13.3} 的右手边定义了一个有界的线性函数。

由于Lax-Milgram定理的假设得到了验证（见定理3.1），因此，弱问题\ref{13.3} 的解存在并且是唯一的。此外，以下先验估计成立

!!!!
\|u\|_{\mathrm{H}^{1}(\Omega)} \leq \frac{1}{\alpha}\|f\|_{\mathrm{L}^{2}(\Omega)}, \quad\|\nabla u\|_{\mathrm{L}^{2}(\Omega)} \leq \frac{C_{\Omega}}{\mu_{0}}\|f\|_{\mathrm{L}^{2}(\Omega)},
$$

作为\ref{13.4},\ref{13.6}和\ref{2.4}的结果。前者由推论\ref{3.1}得出，后者可以很容易地从方程$a(u, u)=(f, u)$开始，利用考奇-施瓦茨和庞加莱不等式以及\ref{13.4}和\ref{13.5}证明。

问题\ref{13.3} 的Galerkin近似值为

!!!!
\text { find } u_{h} \in V_{h}: \quad a\left(u_{h}, v_{h}\right)=\left(f, v_{h}\right) \quad \forall v_{h} \in V_{h},
\label{13.11}\end{equation}

其中$\left\{V_{h}, h>0\right\}$是$\mathrm{H}_{0}^{1}(\Omega)$的一个合适的子空间族。通过复制上面对精确问题\ref{13.3} 进行的证明，可以证明以下估计。

!!!!
\left\|u_{h}\right\|_{\mathrm{H}^{1}(\Omega)} \leq \frac{1}{\alpha}\|f\|_{\mathrm{L}^{2}(\Omega)}, \quad\left\|\nabla u_{h}\right\|_{\mathrm{L}^{2}(\Omega)} \leq \frac{C_{\Omega}}{\mu_{0}}\|f\|_{\mathrm{L}^{2}(\Omega)}
$$

这些特别证明了离散解的梯度（以及弱解$u$的梯度）可以和$\mu_{0}$的梯度一样大。

此外，Galerkin误差不等式\ref{4.10}得出

!!!!
\left\|u-u_{h}\right\|_{V} \leq \frac{M}{\alpha} \inf _{v_{h} \in V_{h}}\left\|u-v_{h}\right\|_{V}
\label{13.12}\end{equation}

根据$\alpha$和$M$的定义（见\ref{13.6} 和\ref{13.10} ），上界常数$M / \alpha$随着比率$\|\mathbf{b}\|_{L^{\infty}(\Omega)} /\|\mu\|_{L^{\infty}(\Omega)}$（即比率$\left.\|\sigma\|_{\mathrm{L}^{2}(\Omega)} /\|\mu\|_{L^{\infty}(\Omega)}\right)$增长而变得一样大（相应地，估计\ref{13.12} 没有意义），这发生在对流（即反应）项支配扩散项的情况。

在这种情况下，Galerkin方法会给出不准确的解，除非--正如我们将看到的$-$，使用极小的离散化步骤$h$。

备注13.1。问题\ref{13.1} 被称为扩散运输（-反应）问题的非保守形式，保守形式为

!!!!
\begin{cases}L u=\operatorname{div}(-\mu \nabla u+\mathbf{b} u)+\sigma u=f & \text { in } \Omega \\ u=0 & \text { on } \partial \Omega\end{cases}
\label{13.13}\end{equation}

如果$\mathbf{b}$是常数，两个公式\ref{13.1} 和\ref{13.13} 是等价的。与\ref{13.13} 相关的双线性形式是

!!!!
a(u, v)=\int_{\Omega}(\mu \nabla u-\mathbf{b} u) \cdot \nabla v d \Omega+\int_{\Omega} \sigma u v d \Omega \quad \forall u, v \in V
\label{13.14}\end{equation}

可以很容易地验证，确保这个双线性形式的矫捷性的条件是

!!!!
\frac{1}{2} \operatorname{div}(\mathbf{b})+\sigma \geq 0 \quad \text { a.e. in } \Omega
\label{13.15}\end{equation}

在这些假设下，对问题\ref{13.1} （以及其近似值）得出的结论也适用于问题\ref{13.13} 。

为了更精确地评估Galerkin方法所提供的数字解决方案的行为，我们分析了一个一维问题。

\subsection{Analysis of a one-dimensional diffusion-transport problem}

让我们考虑以下的一维扩散-运输问题

!!!!
\begin{cases}-\mu u^{\prime \prime}+b u^{\prime}=0, & 0<x<1 \\ u(0)=0, & u(1)=1\end{cases}
\label{13.16}\end{equation}

$\mu$和$b$是两个正常数。

它的弱表述是

!!!!
\text { find } u \in \mathrm{H}^{1}(0,1): \quad a(u, v)=0 \quad \forall v \in \mathrm{H}_{0}^{1}(0,1)
\label{13.17}\end{equation}

与$u(0)=0, u(1)=1$ ，和$a(u, v)=\int_{0}^{1}\left(\mu u^{\prime} v^{\prime}+b u^{\prime} v\right) d x$ 。按照第3.2.2节所述，我们可以通过引入边界数据的适当提升（或扩展）来重新表述\ref{13.17}。3.2.2，我们可以通过引入边界数据的适当提升（或扩展）来重新表述\ref{13.17} 。在这种特殊情况下，我们可以选择$R_{g}=x$ 。然后设定$\stackrel{0}{u}=u-R_{g}=u-x$，我们可以用以下方式重新表述\ref{13.17}

!!!!
\text { find } \stackrel{\circ}{u} \in \mathrm{H}_{0}^{1}(0,1): \quad a(\dot{u}, v)=F(v) \quad \forall v \in \mathrm{H}_{0}^{1}(0,1)
\label{13.18}\end{equation}

其中$F(v)=-a(x, v)=-\int_{0}^{1} b v d x$代表由于数据提升的贡献。我们将全局贝克莱特数定义为以下比率

!!!!
\mathbb{P e}_{g}=\frac{b L}{2 \mu},
\label{13.19}\end{equation}

$L$是域的线性维度（在我们的例子中是1）。这个比率提供了一个衡量对流项如何支配扩散项的尺度。因此，它的作用与纳维-斯托克斯方程中的雷诺数相同，我们将在第17章看到。对于一个负的$b$，它的绝对值应该用在前面的定义中。

我们首先计算这种问题的精确解。其相关的特征方程

!!!!
-\mu \lambda^{2}+b \lambda=0
$$

有两个根，$\lambda_{1}=0$和$\lambda_{2}=b / \mu$ 。因此，一般解决方案是

!!!!
u(x)=C_{1} e^{\lambda_{1} x}+C_{2} e^{\lambda_{2} x}=C_{1}+C_{2} e^{\frac{b}{\mu} x}
$$

通过施加边界条件，我们发现常数$C_{1}$和$C_{2}$，因此，解决方案是

!!!!
u(x)=\frac{\exp \left(\frac{b}{\mu} x\right)-1}{\exp \left(\frac{b}{\mu}\right)-1}
$$

使用指数的泰勒展开，如果$b / \mu \ll 1$我们得到

!!!!
u(x)=\frac{1+\frac{b}{\mu} x+\cdots-1}{1+\frac{b}{\mu}+\cdots-1} \simeq \frac{\frac{b}{\mu} x}{\frac{b}{\mu}}=x
$$

因此，解决方案位于插值边界数据的直线附近（这是对应于案例$b=0$的解决方案）。

反之，如果$b / \mu \gg 1$的指数非常大，因此

!!!!
u(x) \simeq \frac{\exp \left(\frac{b}{\mu} x\right)}{\exp \left(\frac{b}{\mu}\right)}=\exp \left(-\frac{b}{\mu}(1-x)\right)
$$

在几乎所有的区间上，解决方案都接近于零，除了点$x=1$的邻域，在那里它指数地趋向于1。这种邻域的宽度为$\mu / b$的数量级，因此非常小：解决方案在$x=1$附近表现出宽度为$\mathscr{O}\left(\frac{\mu}{b}\right)$的边界层（见图13.1），其中导数表现为$b / \mu$，因此如果$\mu \rightarrow 0$，则是无边界的。

现在让我们假设用Galerkin有限元方法与片断多项式来近似\ref{13.17} ：找到$u_{h} \in X_{h}^{1}$s.t.

!!!!
\begin{cases}a\left(u_{h}, v_{h}\right)=0 & \forall v_{h} \in \dot{X}_{h}^{1} \\ u_{h}(0)=0, u_{h}(1)=1\end{cases}
\label{13.20}\end{equation}



![](https://cdn.mathpix.com/cropped/10058ab4e7f0c5bd6fe5bcd4db204623-319.jpg?height=350&width=430&top_left_y=116&top_left_x=240)

图13.1.问题\ref{13.16} 的解在改变比率$b / \mu$时的行为。为了完整起见，我们还强调了与$b$为负数的情况有关的解决方案

其中，用$x_{i}$表示$i=0, \ldots M$，为$(0,1)$上引入的分区的顶点，我们设定，与\ref{4.14}相一致。

!!!!
\begin{gathered}
X_{h}^{r}=\left\{v_{h} \in C^{0}([0,1]):\left.v_{h}\right|_{\left[x_{i-1}, x_{i}\right]} \in \mathbb{P}_{r}, \quad i=1, \ldots, M\right\} \\
\dot{X}_{h}^{r}=\left\{v_{h} \in X_{h}^{r}: v_{h}(0)=v_{h}(1)=0\right\}
\end{gathered}
$$

为$r \geq 1$。在选择了每个$i=1, \ldots, M-1, v_{h}=\varphi_{i}$（$X_{h}^{1}$的第i个基础函数）后，我们有

!!!!
\int_{0}^{1} \mu u_{h}^{\prime} \varphi_{i}^{\prime} d x+\int_{0}^{1} b u_{h}^{\prime} \varphi_{i} d x=0
$$

换句话说，如果我们假设$\varphi_{i}$的支持率等于$\left[x_{i-1}, x_{i+1}\right]$，并写出

!!!!
\begin{gathered}
\mu\left[u_{i-1} \int_{x_{i-1}}^{x_{i}} \varphi_{i-1}^{\prime} \varphi_{i}^{\prime} d x+u_{i} \int_{x_{i-1}}^{x_{i+1}}\left(\varphi_{i}^{\prime}\right)^{2} d x+u_{i+1} \int_{x_{i}}^{x_{i+1}} \varphi_{i+1}^{\prime} \varphi_{i}^{\prime} d x\right] \\
+b\left[u_{i-1} \int_{x_{i-1}}^{x_{i}} \varphi_{i-1}^{\prime} \varphi_{i} d x+u_{i} \int_{i-1}^{x_{i+1}} \varphi_{i}^{\prime} \varphi_{i} d x+u_{i+1} \int_{x_{i}}^{x_{i+1}} \varphi_{i+1}^{\prime} \varphi_{i} d x\right]=0,
\end{gathered}
!!!!


 $u_{h}=\sum_{j=1}^{M-1} u_{j} \varphi_{j}(x)$ ，我们有

$\forall i=1, \ldots, M-1$ .如果分区是均匀的，即$x_{0}=0$和$x_{i}=x_{i-1}+h$，与$i=1, \ldots, M$，观察$\varphi_{i}^{\prime}(x)=\frac{1}{\hbar}$如果$x_{i-1}<x<x_{i}, \varphi_{i}^{\prime}(x)=-\frac{1}{\hbar}$如果$x_{i}<x<x_{i+1}$，对于$i=1, \ldots, M-1$，我们得到

!!!!
\mu\left(-u_{i-1} \frac{1}{h}+u_{i} \frac{2}{h}-u_{i+1} \frac{1}{h}\right)+b\left(-u_{i-1} \frac{1}{h} \frac{h}{2}+u_{i+1} \frac{1}{h} \frac{h}{2}\right)=0
$$

就是说

!!!!
\frac{\mu}{h}\left(-u_{i-1}+2 u_{i}-u_{i+1}\right)+\frac{1}{2} b\left(u_{i+1}-u_{i-1}\right)=0, \quad i=1, \ldots, M-1
\label{13.21}\end{equation}

将这些条款重新排列，我们发现

!!!!
\left(\frac{b}{2}-\frac{\mu}{h}\right) u_{i+1}+\frac{2 \mu}{h} u_{i}-\left(\frac{b}{2}+\frac{\mu}{h}\right) u_{i-1}=0, \quad i=1, \ldots, M-1
$$

除以$\mu / h$并定义本地（或 "网格"）贝克莱特数

!!!!
\mathbb{P e}=\frac{|b| h}{2 \mu}
\label{13.22}\end{equation}

我们终于有了

!!!!
(\mathbb{P e}-1) u_{i+1}+2 u_{i}-(\mathbb{P e}+1) u_{i-1}=0, \quad i=1, \ldots, M-1
\label{13.23}\end{equation}

这是一个线性差分方程，可以得到$u_{i}=!!!!\rho^{i}$形式的指数解（见[QSS07]）。将这种表达式替换到\ref{13.23} 中，我们得到

!!!!
(\mathbb{P e}-1) \rho^{2}+2 \rho-(\mathbb{P e}+1)=0
$$

从中我们可以得到两个根

!!!!
\rho_{1,2}=\frac{-1 \pm \sqrt{1+\mathbb{P e}^{2}-1}}{\mathbb{P e}-1}=\left\{\begin{array}{l}
(1+\mathbb{P e}) /(1-\mathbb{P e}) \\
1
\end{array}\right.
$$

由于\ref{13.23} 的线性，这种方程的一般解的形式为

!!!!
u_{i}=A_{1} \rho_{1}^{i}+A_{2} \rho_{2}^{i}
$$

与$A_{1}$和$A_{2}$两个任意常数。通过施加边界条件$u_{0}=0$和$u_{M}=1$，我们发现

!!!!
A_{1}=-A_{2} \text { and } A_{2}=\left(1-\left(\frac{1+\mathbb{P e}}{1-\mathbb{P e}}\right)^{M}\right)^{-1}
$$

总而言之，问题\ref{13.20} 的解决方案有以下节点值

!!!!
u_{i}=\frac{1-\left(\frac{1+\mathbb{P e}}{1-\mathbb{P e}}\right)^{i}}{1-\left(\frac{1+\mathbb{P e}}{1-\mathbb{P e}}\right)^{M}}, \quad i=0, \ldots, M
$$

我们观察到，如果$\mathbb{P e}>1$，括号内的项是负的，近似解变得振荡，而精确解则是单调的！这种现象显示在图13.2中，在不同的值下，\ref{13.23} 的解是单调的。这一现象显示在图13.2中，其中\ref{13.23} 的解，对于不同的值

![](https://cdn.mathpix.com/cropped/10058ab4e7f0c5bd6fe5bcd4db204623-321.jpg?height=334&width=423&top_left_y=113&top_left_x=247)

图13.2.扩散-传输问题\ref{13.16}的有限元解决方案，$\mathbb{P e}_{g}=50$的局部佩克莱特数的不同值

在全球贝氏数等于$50$的情况下，将局部贝氏数与精确解进行比较。可以看出，贝氏数越高，近似解的行为与精确解的行为相差越大，在接近边界层的地方，振荡变得越来越明显。

对这种错误行为最明显的补救措施是选择一个足够小的网格大小$h$，以确保$\mathbb{P e}<1$。然而，这种策略并不总是方便的：例如，如果$b=1$和$\mu=1 / 5000$，我们应该采取$h<1 / 2500$，即在$(0,1) !$上引入至少2500个间隔。特别是，对于几个维度的边界值问题，这种策略需要不合理的大量节点。一个更合适的补救办法是使用一个先验的自适应程序，只在边界层附近细化网格。有几种策略可用于这一目的。在比较知名的策略中，我们提到所谓的B型（Bakhvâlov）或S型（Shishkin）网格。例如，见 [GRS07] 。

替代的网格适应策略，包括先验和后验，特别是对多维问题有用的，在第4节中描述。4.6.

\subsection{Analysis of a one-dimensional diffusion-reaction problem}

现在让我们考虑一个一维扩散-反应问题。

!!!!
\begin{cases}-\mu u^{\prime \prime}+\sigma u=0, & 0<x<1 \\ u(0)=0, & u(1)=1\end{cases}
\label{13.24}\end{equation}

含有$\mu$和$\sigma$的正常数，其解为

!!!!
u(x)=\frac{\sinh (\alpha x)}{\sinh (\alpha)}=\frac{e^{\alpha x}-e^{-\alpha x}}{e^{\alpha}-e^{-\alpha}}, \text { with } \alpha=\sqrt{\sigma / \mu}
$$

在这种情况下，如果$\sigma / \mu \gg 1$有一个边界层，厚度为$\sqrt{\mu / \sigma}$，其中$\mu \rightarrow 0$的第一导数变得无界（例如，注意图13.3中显示的情况的精确解）。在这种情况下，定义全局贝克莱特数也很有意思，其形式为

!!!!
\mathbb{P e}_{g}=\frac{\sigma L^{2}}{6 \mu}
$$

$L$仍然是域的线性维度（在我们的例子中为1）。

Galerkin有限元近似\ref{13.24}的内容为

!!!!
\text { find } u_{h} \in X_{h}^{r} \text { such that } a\left(u_{h}, v_{h}\right)=0 \quad \forall v_{h} \in \dot{X}_{h}^{r} \text {, }
\label{13.25}\end{equation}

为$r \geq 1$，与$u_{h}(0)=0$、$u_{h}(1)=1$和$a\left(u_{h}, v_{h}\right)=\int_{0}^{1}\left(\mu u_{h}^{\prime} v_{h}^{\prime}+\sigma u_{h} v_{h}\right) d x$。等价地，通过设定$\stackrel{\circ}{u}_{h}=u_{h}-x$，和$F\left(v_{h}\right)=-a\left(x, v_{h}\right)=-\int_{0}^{1} \sigma x v_{h} d x$，我们有

!!!!
\text { find } \stackrel{\circ}{u}_{h} \in V_{h} \text { such that } a\left(\dot{u}_{h}, v_{h}\right)=F\left(v_{h}\right) \quad \forall v_{h} \in V_{h},
\label{13.26}\end{equation}

与$V_{h}=\dot{X}_{h}^{r}$ 。为了简单起见，让我们考虑问题\ref{13.25}，在均匀分区上有片状线性元素（即$r=1$）。与通用基函数$v_{h}=\varphi_{i}, i=1, \ldots, M-1$相关的方程是

!!!!
\int_{0}^{1} \mu u_{h}^{\prime} \varphi_{i}^{\prime} d x+\int_{0}^{1} \sigma u_{h} \varphi_{i} d x=0
$$

![](https://cdn.mathpix.com/cropped/10058ab4e7f0c5bd6fe5bcd4db204623-322.jpg?height=332&width=426&top_left_y=822&top_left_x=245)

图13.3.扩散反应问题\ref{13.24} 的数值解和精确解之间的比较$\mathbb{P e}_{g}=200$ 。数值解是用均匀网格上的Galerkin-线性有限元方法得到的。通过与上一节类似的方式进行计算，并观察到

!!!!
\int_{x_{i-1}}^{x_{i}} \varphi_{i-1} \varphi_{i} d x=\frac{h}{6}, \quad \int_{x_{i-1}}^{x_{i+1}} \varphi_{i}^{2} d x=\frac{2}{3} h, \quad \int_{x_{i}}^{x_{i+1}} \varphi_{i} \varphi_{i+1} d x=\frac{h}{6}
$$

我们得到

!!!!
\mu\left(-u_{i-1} \frac{1}{h}+u_{i} \frac{2}{h}-u_{i+1} \frac{1}{h}\right)+\sigma\left(u_{i-1} \frac{h}{6}+u_{i} \frac{2}{3} h+u_{i+1} \frac{h}{6}\right)=0
\label{13.27}\end{equation}

就是说

!!!!
\left(\frac{h}{6} \sigma-\frac{\mu}{h}\right) u_{i+1}+\left(\frac{2}{3} \sigma h+\frac{2 \mu}{h}\right) u_{i}+\left(\frac{h}{6} \sigma-\frac{\mu}{h}\right) u_{i-1}=0
$$

除以$\mu / h$并定义以下的局部佩克莱特数

!!!!
\mathbb{P e}=\frac{\sigma h^{2}}{6 \mu}
\label{13.28}\end{equation}

我们终于有了

!!!!
(\mathbb{P e}-1) u_{i+1}+2(1+2 \mathbb{P e}) u_{i}+(\mathbb{P e}-1) u_{i-1}=0, \quad i=1, \ldots, M-1
$$

这个三期差分方程对每个$i=!!!!0, \ldots, M$都有以下解

!!!!
u_{i}=\frac{\left[\frac{1+2 \mathbb{P e}+\sqrt{3 \mathbb{P e}(\mathbb{P e}+2)}}{1-\mathbb{P e}}\right]^{i}-\left[\frac{1+2 \mathbb{P e}-\sqrt{3 \mathbb{P e}(\mathbb{P e}+2)}}{1-\mathbb{P e}}\right]^{i}}{\left[\frac{1+2 \mathbb{P e}+\sqrt{3 \mathbb{P e}(\mathbb{P e}+2)}}{1-\mathbb{P e}}\right]^{M}-\left[\frac{1+2 \mathbb{P} e-\sqrt{3 \mathbb{P e}(\mathbb{P e}+2)}}{1-\mathbb{P e}}\right]^{M}}
$$

当$\mathbb{P e}>1$时，又是震荡的。

因此，当$\frac{\sigma}{\mu} \gg 1$，即扩散系数相对于反应系数来说非常小的时候，这个问题就很关键了（见图13.3中报告的例子）。

\section{ $13.4$ Finite elements and finite differences (FD)}。

我们想分析应用于解决扩散-传输和扩散-反应问题的有限差分法（简称FD）的行为，并强调与有限元法（简称FE）的类比和差异。我们将把自己限制在一维的情况下，我们将考虑一个均匀的网格。

让我们再考虑一次问题\ref{13.16} ，让我们通过有限差分对其进行近似。为了对两个项产生同样大小的局部离散化误差，我们将通过使用以下的中心增量比率来近似导数。

!!!!
u^{\prime}\left(x_{i}\right) &=\frac{u\left(x_{i+1}\right)-u\left(x_{i-1}\right)}{2 h}+\mathscr{O}\left(h^{2}\right), & i=1, \ldots, M-1 
\label{13.29}\end{equation}


!!!!
u^{\prime \prime}\left(x_{i}\right) &=\frac{u\left(x_{i+1}\right)-2 u\left(x_{i}\right)+u\left(x_{i-1}\right)}{h^{2}}+\mathscr{O}\left(h^{2}\right), & i=1, \ldots, M-1
\label{13.30}\end{equation}

在这两种情况下，正如所强调的那样，余数是相对于步长的无限小数$h$，通过引用截断的泰勒级数可以很容易地证明（见，例如，[QSS07]）。通过在\ref{13.16} 中用这些增量比率取代精确导数（从而忽略了无限小的误差），我们发现以下方案

!!!!
\left\{\begin{array}{l}
-\mu \frac{u_{i+1}-2 u_{i}+u_{i-1}}{h^{2}}+b \frac{u_{i+1}-u_{i-1}}{2 h}=0, \quad i=1, \ldots, M-1 \\
u_{0}=0, \quad u_{M}=1
\end{array}\right.
\label{13.31}\end{equation}

对于每个$i$，未知的$u_{i}$提供了一个节点值$u\left(x_{i}\right)$的近似值。乘以$h$，我们得到与在同一均匀网格上使用片状线性多项式的有限元方法得到的相同的方程\ref{13.21} 。

现在让我们考虑扩散反应问题\ref{13.24} 。以类似的方式进行，用有限差分法对其进行近似，可以得到

!!!!
\left\{\begin{array}{l}
-\mu \frac{u_{i+1}-2 u_{i}+u_{i-1}}{h^{2}}+\sigma u_{i}=0, \quad i=1, \ldots, M-1 \\
u_{0}=0, \quad u_{M}=1 .
\end{array}\right.
\label{13.32}\end{equation}

上述方程与\ref{13.27} 不同，后者是用线性有限元得到的：相反，在\ref{13.32} 中出现的反应项的对角线贡献$\sigma u_{i}$，在\ref{13.27} 中产生三个不同贡献的总和

!!!!
\sigma\left(u_{i-1} \frac{h}{6}+u_{i} \frac{2}{3} h+u_{i+1} \frac{h}{6}\right)
$$

因此，在这种情况下，两种方法$\mathrm{FE}$和$\mathrm{FD}$并不等同。我们观察到，无论为离散化步骤$h$选择哪一个值，使用FD方案\ref{13.32} 得到的解都不会显示出振荡。事实上，\ref{13.32}的解是

!!!!
u_{i}=\left(\rho_{1}^{M}-\rho_{2}^{M}\right)^{-1}\left(\rho_{1}^{i}-\rho_{2}^{i}\right)
$$

与

!!!!
\rho_{1,2}=\frac{\gamma}{2} \pm\left(\frac{\gamma^{2}}{4}-1\right)^{\frac{1}{2}} \text { and } \gamma=2+\frac{\sigma h^{2}}{\mu}
$$

第i个幂现在有一个正基，保证了序列$\left\{u_{i}\right\}$的单调行为。这与我们在第1节中看到的$13.3$的情况不同。  [对于$13.3$，有必要选择$h \leq \sqrt{\frac{6 \mu}{\sigma}}$以保证局部贝克莱特数\ref{13.28} 小于1。

![](https://cdn.mathpix.com/cropped/10058ab4e7f0c5bd6fe5bcd4db204623-325.jpg?height=331&width=425&top_left_y=113&top_left_x=244)

图13.4.使用Galerkin-线性有限元方法（FEM）和有限差分方法（FD）获得的一维扩散传输方程\ref{13.24} 与$\mathbb{P e}_{g}=2000$的数值解之间的比较，对于不同的局部佩克莱特数的值而言

\subsection{The mass-lumping technique}

在反应-扩散问题的情况下，我们可以通过使用线性有限元获得与有限差分相同的结果，只要我们采用所谓的质量堆积技术，由于质量矩阵

!!!!
\mathrm{M}=\left(m_{i j}\right), \quad m_{i j}=\int_{0}^{1} \varphi_{j} \varphi_{i} d x
$$

是三对角的，用一个对角矩阵$\mathrm{M}_{L}$来近似，称为浓缩或包络矩阵。为此，我们在每个区间$\left(x_{i}, x_{i+1}\right)$上使用下面的梯形正交公式，对每个$i=0, \ldots, M-1$进行计算

!!!!
\int_{x_{i}}^{x_{i+1}} f(x) d x \simeq \frac{h}{2}\left(f\left(x_{i}\right)+f\left(x_{i+1}\right)\right)
$$

由于有限元基函数的特性，我们随后发现。

!!!!
\begin{aligned}
&\int_{x_{i-1}}^{x_{i}} \varphi_{i-1} \varphi_{i} d x & \simeq \frac{h}{2}\left[\varphi_{i-1}\left(x_{i-1}\right) \varphi_{i}\left(x_{i-1}\right)+\varphi_{i-1}\left(x_{i}\right) \varphi_{i}\left(x_{i}\right)\right]=0 \\
&\int_{x_{i-1}}^{x_{i+1}} \varphi_{i}^{2} d x & =2 \int_{x_{i-1}}^{x_{i}} \varphi_{i}^{2} d x \simeq 2 \frac{h}{2}\left[\varphi_{i}^{2}\left(x_{i-1}\right)+\varphi_{i}^{2}\left(x_{i}\right)\right]=h \\
&\int_{x_{i}}^{x_{i+1}} \varphi_{i} \varphi_{i+1} d x & \simeq \frac{h}{2}\left[\varphi_{i}\left(x_{i}\right) \varphi_{i+1}\left(x_{i}\right)+\varphi_{i}\left(x_{i+1}\right) \varphi_{i+1}\left(x_{i+1}\right)\right]=0
\end{aligned}
$$

使用前面的公式来近似质量矩阵系数，我们得到以下对角矩阵$\mathrm{M}_{L}$，其元素是$\mathrm{M}$的每一行的元素之和，即

!!!!
\mathrm{M}_{L}=\operatorname{diag}\left(\widetilde{m}_{i i}\right), \quad \text { with } \quad \widetilde{m}_{i i}=\sum_{j=i-1}^{i+1} m_{i j}
\label{13.33}\end{equation}

请注意，由于基函数的以下分区统一属性

!!!!
\sum_{j=0}^{M} \varphi_{j}(x)=1 \quad \forall x \in[0,1]
\label{13.34}\end{equation}

$\mathrm{M}_{L}$的元素在区间$[0,1]$上取以下表达式

!!!!
\tilde{m}_{i i}=\int_{0}^{1} \varphi_{i} d x, \quad i=0, \ldots, M
$$

它们的值在练习3中报告，用于度数为$1,2,3$的有限元。如果将零阶的项按以下方式替换

!!!!
\int_{0}^{1} \sigma u_{h} \varphi_{i} d x=\sigma \sum_{j=1}^{M-1} u_{j} \int_{0}^{1} \varphi_{j} \varphi_{i} d x=\sigma \sum_{j=1}^{M-1} m_{i j} u_{j} \simeq \sigma \tilde{m}_{i i} u_{i}
$$

有限元问题产生的解与有限差分的解相吻合，因此对于$h$的每个值都是单调的。此外，用$\mathrm{M}_{L}$代替$\mathrm{M}$并不会降低方法的精度等级。

当使用线性元素时，质量凑合的过程\ref{13.33} 可以被推广到二维的情况。相反，对于二次有限元，上述由行相加组成的程序将产生一个奇异的质量矩阵$\mathrm{M}_{L}$（见例13.1）。另一种对角线化策略包括使用矩阵$\mathrm{M}=\operatorname{diag}\left(\widehat{m}_{i i}\right)$，其元素为

!!!!
\widehat{m}_{i i}=\frac{m_{i i}}{\sum_{j} m_{j j}}
$$

在一维情况下，对于线性和二次有限元，矩阵$\widehat{\mathrm{M}}$和$\mathrm{M}_{L}$是重合的，而对于三次元则不同（见练习三）。矩阵$\mathrm{M}$对于高阶的拉格朗日有限元也是非奇异的，而在使用非拉格朗日有限元时，例如使用层次基时，它可能变成奇异的。在后一种情况下，我们要求助于更复杂的质量堆积程序。事实上，一些能够产生非奇异矩阵的对角线化技术也已经为高阶有限元详细阐述了。例如，见 [CJRT01] 。例13.1.在顶点为$(0,0),(1,0)$和$(0,1)$的参考三角形上，$\mathbb{P}_{2}$有限元的质量矩阵为

!!!!
\mathrm{M}=\frac{1}{180}\left[\begin{array}{rrrrrr}
6 & -1 & -1 & 0 & -4 & 0 \\
-1 & 6 & -1 & 0 & 0 & -4 \\
-1 & -1 & 6 & -4 & 0 & 0 \\
0 & 0 & -4 & 32 & 16 & 16 \\
-4 & 0 & 0 & 16 & 32 & 16 \\
0 & -4 & 0 & 16 & 16 & 32
\end{array}\right]
$$

而块状质量矩阵由以下公式给出

!!!!
\begin{aligned}
&\mathrm{M}_{L}=\frac{1}{180} \operatorname{diag}(000606060) \\
&\widehat{\mathbf{M}}=\frac{1}{114} \operatorname{diag}(666323232)
\end{aligned}
$$

可以注意到，矩阵$\mathrm{M}_{L}$是奇异的。

质量堆积技术也用于其他情况，例如，在解决抛物线问题（见第5章）时，使用有限元空间离散和有限差分显式时间离散（例如，forward-Euler方法）。在这种情况下，将时间导数离散化产生的质量矩阵集合起来，可以进行对角线系统的求解，并相应地减少计算成本。

\section{ $13.6$ Decentred FD schemes and artificial diffusion}。

通过有限差分的比较分析，我们找到了解决扩散反应问题中有限元解的振荡行为的补救办法。我们现在希望对扩散-传输问题\ref{13.16} 的情况也能找到补救措施。

让我们考虑一下有限差分。数值解决方案中的振荡是由于我们使用中心有限差分（CFD）方案来离散传输项的事实。由于后者是非对称的，这表明在$x_{i}$点离散第一导数，其增量比例是递减的，如果场是正的，则在$x_{i-1}$点介入，反之则在$x_{i+1}$点介入。

这种技术被称为上风方案，由此产生的方案，在$b>0$的情况下被称为上风方案（简称FDUP），写为

!!!!
-\mu \frac{u_{i+1}-2 u_{i}+u_{i-1}}{h^{2}}+b \frac{u_{i}-u_{i-1}}{h}=0, \quad i=1, \ldots, M-1
\label{13.35}\end{equation}

(见图$13.5$中的一个上风方案的应用实例）。)付出的代价是收敛顺序的减少，因为递减的增量比

![](https://cdn.mathpix.com/cropped/10058ab4e7f0c5bd6fe5bcd4db204623-328.jpg?height=333&width=423&top_left_y=112&top_left_x=247)

图 13.5.使用中心（CFD）和上风（UPFD）有限差分方案对一维扩散-传输方程\ref{13.16} 的$\mathbb{P e}_{g}=50$和两个不同的局部佩克莱特数得到的解决方案。同样在高局部贝氏数的情况下，我们可以注意到由上风方案引入的人工扩散的稳定作用，但不可避免地伴随着精度的损失

与$\mathscr{O}\left(h^{2}\right)$相比，引入了局部离散化误差$\mathscr{O}(h)$（见\ref{13.30} ，在CFD情况下。

我们现在观察到，

!!!!
\frac{u_{i}-u_{i-1}}{h}=\frac{u_{i+1}-u_{i-1}}{2 h}-\frac{h}{2} \frac{u_{i+1}-2 u_{i}+u_{i-1}}{h^{2}}
$$

也就是说，用于逼近一阶导数的递增比率可以写成一个中心递增比率加上一个与二阶导数离散化成比例的项的总和，仍然是中心递增比率。因此，上风方案可以重新解释为一个中心有限差分方案，其中引入了一个与$h$成比例的人工扩散项。事实上，\ref{13.35} 等同于

!!!!
-\mu_{h} \frac{u_{i+1}-2 u_{i}+u_{i-1}}{h^{2}}+b \frac{u_{i+1}-u_{i-1}}{2 h}=0, \quad i=1, \ldots, M-1
\label{13.36}\end{equation}

其中$\mu_{h}=\mu(1+\mathbb{P e}), \mathbb{P e}$为\ref{13.22} 中引入的局部贝氏数。方案\ref{13.36} 对应于使用CFD方案对扰动问题进行离散化

!!!!
-\mu_{h} u^{\prime \prime}+b u^{\prime}=0
\label{13.37}\end{equation}

粘度 "校正"$\mu_{h}-\mu=\mu \mathbb{P e}=\frac{b h}{2}$被称为数值粘度或人工粘度。与方案\ref{13.36} 相关的新的局部贝克莱特数是

!!!!
\mathbb{P e}^{*}=\frac{b h}{2 \mu_{h}}=\frac{\mathbb{P e}}{(1+\mathbb{P e})}
$$

所以$\mathbb{P e}^{*}<1$为$h>0$的所有可能值。正如我们将在下一节看到的，这种解释允许将上风技术扩展到有限元，也允许扩展到二维情况，顺便说一下，在二维情况下，递减微分的概念并不明显。

更一般地说，在形式为\ref{13.36}的CFD方案中，我们可以使用以下的数值黏度系数

!!!!
\mu_{h}=\mu(1+\phi(\mathbb{P e}))
\label{13.38}\end{equation}

其中$\phi$是一个合适的局部佩克莱特数的函数，必须满足属性$\lim _{t \rightarrow 0+} \phi(t)=0$。可以很容易地看到，如果$\phi=0$，我们得到$\mathrm{CFD}$方法

\ref{13.31}，而如果$\phi(t)=t$ ，我们得到上风UPFD方法\ref{13.35}（或\ref{13.36}）。

对$\phi$的不同选择导致了不同的方案。例如，设置

!!!!
\phi(t)=t-1+B(2 t)
\label{13.39}\end{equation}

其中$B$是所谓的伯努利函数，定义为

!!!!
B(t)=\frac{t}{e^{t}-1} \quad \text { if } t>0, \quad \text { and } \quad B(0)=1
$$

我们得到指数拟合方案，一般归功于Scharfetter和Gummel或Iljin（事实上，它最初是由Allen和Southwell[AS55]引入的）。关于这种方法的更多信息，请参见第13.8.7节。

用$\phi^{U}$和$\phi^{S G}$表示由$\phi(t)=t$和$\phi(t)=t-1-B(2 t)$决定的两个函数，我们观察到，如果$\mathbb{P e} \rightarrow+\infty$，则$\phi^{S G}=\mathscr{O}\left(\mathbb{P e}^{2}\right)$和$\phi^{U}=\mathscr{O}(\mathbb{P e})$，如果$\mathbb{P e} \rightarrow 0^{+}($，见图13.6$)$ 。

可以验证，对于每个给定的$\mu$和$b$，Scharfetter-Gummel方案是一个二阶方案（关于$h$），由于这个原因，它有时被称为具有最佳黏度的上风方案。事实上，也可以验证，在$f$为常数的情况下，$-$更一般地说，只要$f$在每个区间上为常数即可

![](https://cdn.mathpix.com/cropped/10058ab4e7f0c5bd6fe5bcd4db204623-329.jpg?height=288&width=356&top_left_y=909&top_left_x=279)

图13.6.函数$\phi^{U}$（实线）和$\phi^{S G}$（蚀刻线）与当地贝克莱特数的关系

![](https://cdn.mathpix.com/cropped/10058ab4e7f0c5bd6fe5bcd4db204623-330.jpg?height=289&width=400&top_left_y=126&top_left_x=255)

图13.7.在$\mathbb{P e}_{g}=50$的情况下，精确解与上风方案（UPFD）和Scharfetter和Gummel方案（SGFD）得到的解的比较。

$\left.\left[x_{i}, x_{i+1}\right]\right)-$，该方案产生的数值解是节点精确的。这意味着在区间$(0,1)$内的每个离散化节点，它与解$u$完全重合，即我们有

!!!!
u_{i}=u\left(x_{i}\right) \text { for } i=1, \ldots, M-1
$$

与$h$的选择无关（见图13.7）。

我们观察到，与系数\ref{13.38} 相关的局部贝克莱特数是

!!!!
\mathbb{P e}^{*}=\frac{b h}{2 \mu_{h}}=\frac{\mathbb{P e}}{(1+\phi(\mathbb{P e}))}
$$

因此总是小于1，对于$h$的每个值。

备注13.2。无论$h$的值如何，与上风和指数拟合方案相关的矩阵都是一个M矩阵；因此，数值解具有单调行为（见[QSS07，第1章]）。

\subsection{Eigenvalues of the diffusion-transport equation}

让我们考虑在一般区间$L u=-\mu u^{\prime \prime}+b u^{\prime}$上与问题\ref{13.16} 相关的算子$(\alpha, \beta)$ 。其特征值$\lambda$解决$L u=\lambda u, \alpha<x<\beta, u(\alpha)=u(\beta)=0$，$u$是一个特征函数。一般来说，由于一阶项$b u^{\prime}$的存在，这种特征值会很复杂。假设$\mu>0$是常数（而$b$是先验的变量），我们有

!!!!
\int_{\alpha}^{\beta}|u|^{2} d x \operatorname{Re}(\lambda)=\int_{\alpha}^{\beta} L u \bar{u} d x=\mu \int_{\alpha}^{\beta}\left|u^{\prime}\right|^{2} d x-\frac{1}{2} \int_{\alpha}^{\beta} b^{\prime}|u|^{2} d x
\label{13.40}\end{equation}

可以推断，如果$\mu$很小，$b^{\prime}$严格为正，那么$\lambda$的实部不一定为正。然而，由于Poincaré不等式\ref{2.13}，我们有

!!!!
\int_{\alpha}^{\beta}\left|u^{\prime}\right|^{2} d x \geq C_{\alpha, \beta} \int_{\alpha}^{\beta}|u|^{2} d x
\label{13.41}\end{equation}

$C_{\alpha, \beta}$是一个取决于$\beta-\alpha$的正常数；我们从\ref{13.40} 推导出

!!!!
\operatorname{Re}(\lambda) \geq C_{\alpha, \beta} \mu-\frac{1}{2} b_{\max }^{\prime}
$$

其中$b_{\max }^{\prime}=\max _{\alpha \leq s \leq \beta} b^{\prime}(s)$ 。特别是，让我们观察到

!!!!
\operatorname{Re}(\lambda)>0 \quad \text { if } b \text { is constant or if } \quad b^{\prime}(x) \leq 0 \quad \forall x \in[\alpha, \beta]
$$

对于与手头问题的Galerkin-finite element近似相关的特征值，也可以得到同样的下限。后者是问题的解

!!!!
\text { find } \lambda_{h} \in \mathbb{C}, u_{h} \in V_{h}: \int_{\alpha}^{\beta} \mu u_{h}^{\prime} v_{h}^{\prime} d x+\int_{\alpha}^{\beta} b u_{h}^{\prime} v_{h} d x=\lambda_{h} \int_{\alpha}^{\beta} u_{h} v_{h} d x \forall v_{h} \in V_{h}
\label{13.42}\end{equation}

其中$V_{h}=\left\{v_{h} \in X_{h}^{r}: v_{h}(\alpha)=v_{h}(\beta)=0\right\}$ 。为了证明这一点，只需在\ref{13.42}中再次取$v_{h}=\bar{u}_{h}$，并像以前一样进行。

我们可以通过在\ref{13.42} 中再次选择$v_{h}=\bar{u}_{h}$并在两个成员中取模子来获得一个上界。

!!!!
\left|\lambda_{h}\right| \leq \frac{\mu\left\|u_{h}^{\prime}\right\|_{\mathrm{L}^{2}(\alpha, \beta)}^{2}+\|b\|_{\mathrm{L}^{\infty}(\alpha, \beta)}\left\|u_{h}^{\prime}\right\|_{\mathrm{L}^{2}(\alpha, \beta)}\left\|u_{h}\right\|_{\mathrm{L}^{2}(\alpha, \beta)}}{\left\|u_{h}\right\|_{\mathrm{L}^{2}(\alpha, \beta)}^{2}}
$$

通过使用一维情况下的反不等式\ref{4.52}，可以看出

!!!!
\exists C_{I}=C_{I}(r)>0: \forall v_{h} \in X_{h}^{r}, \quad\left\|v_{h}^{\prime}\right\|_{\mathrm{L}^{2}(\alpha, \beta)} \leq C_{I} h^{-1}\left\|v_{h}\right\|_{\mathrm{L}^{2}(\alpha, \beta)}
\label{13.43}\end{equation}

我们不难发现，

!!!!
\left|\lambda_{h}\right| \leq \mu C_{I}^{2} h^{-2}+\|b\|_{\mathrm{L}^{\infty}(\alpha, \beta)} C_{I} h^{-1}
$$

相反，如果我们在通常的参考区间$(-1,1)$上使用同一问题的Legendre G-NI频谱近似（见第10.3节），特征值问题采取以下形式。

!!!!
\left\{\begin{array}{l}
\text { find } \lambda^{N} \in \mathbb{C}, u_{N} \in \mathbb{P}_{N}^{0}: \\
\left(\mu u_{N}^{\prime}, v_{N}^{\prime}\right)_{N}+\left(b u_{N}^{\prime}, v_{N}\right)_{N}=\lambda^{N}\left(u_{N}, v_{N}\right)_{N} \quad \forall v_{N} \in \mathbb{P}_{N}^{0}
\end{array}\right.
\label{13.44}\end{equation}

$\mathbb{P}_{N}^{0}$现在是在$x=!!!!\pm 1$处消失的$N$度代数多项式的空间，而$(\cdot, \cdot)_{N}$是定义于\ref{10.25}的离散GLL标量积。为简单起见，我们将假设$b$也是常数。取$v_{N}=\bar{u}_{N}$，我们得到

!!!!
\operatorname{Re}\left(\lambda^{N}\right)=\frac{\mu\left\|u_{N}^{\prime}\right\|_{\mathrm{L}^{2}(-1,1)}^{2}}{\left\|u_{N}\right\|_{N}^{2}}
$$

因此，$\operatorname{Re}\left(\lambda^{N}\right)>0$ 。由于Poincaré不等式\ref{13.41} （它在区间$(-1,1)$内成立，常数$C_{\alpha, \beta}=\pi^{2} / 4$），我们得到下限

!!!!
\operatorname{Re}\left(\lambda^{N}\right)>\mu \frac{\pi^{2}}{4} \frac{\left\|u_{N}\right\|_{\mathrm{L}^{2}(-1,1)}^{2}}{\left\|u_{N}\right\|_{N}^{2}}
$$

由于$u_{N}$是一个最多只有$N$度的多项式，由于\ref{10.54}，我们得到了

!!!!
\operatorname{Re}\left(\lambda^{N}\right)>\mu \frac{\pi^{2}}{12}
$$

相反，使用以下代数多项式的反不等式

!!!!
\exists C>0: \forall v_{N} \in \mathbb{P}_{N}, \quad\left\|v_{N}^{\prime}\right\|_{L^{2}(-1,1)} \leq C N^{2}\left\|v_{N}\right\|_{L^{2}(-1,1)}
\label{13.45}\end{equation}

(见[CHQZ06])，再一次\ref{10.54}，我们发现

!!!!
\operatorname{Re}\left(\lambda^{N}\right)<C \mu N^{4}
$$

事实上，如果$N>1 / \mu$，我们可以证明，扩散传输问题\ref{13.44} 的特征值的模数表现与纯扩散问题的模数相似，即（见$10.3 .2$节）。

!!!!
C_{1} N^{-1} \leq\left|\lambda^{N}\right| \leq C_{2} N^{2}
$$

证明和更多细节，见[CHQZ06，第4.3.3节]。

\section{ $13.8$ Stabilization methods}。

前面几节介绍的Galerkin方法提供了一个传输项的中心近似。使用正心近似的一个可能方法是在与$u_{h}$所属空间不同的空间中选择测试函数$v_{h}$：通过这样做，我们得到一种叫做Petrov-Galerkin的方法，对于这种方法，基于Céa法则的分析不再成立。我们将在第13.8.2节更详细地分析这种方法。在本节中，我们将讨论稳定有限元的方法。

更确切地说，我们不使用Galerkin有限元方法\ref{13.26} 来逼近\ref{13.12} ，而是考虑使用广义Galerkin方法

!!!!
\text { find } \stackrel{\circ}{u}_{h} \in V_{h}: a_{h}\left(\dot{u}_{h}, v_{h}\right)=F_{h}\left(v_{h}\right) \quad \forall v_{h} \in V_{h},
\label{13.46}\end{equation}

其中

!!!!
a_{h}\left(\dot{u}_{h}, v_{h}\right)=a\left(\dot{u}_{h}, v_{h}\right)+b_{h}\left(\dot{u}_{h}, v_{h}\right) \text { and } F_{h}\left(v_{h}\right)=F\left(v_{h}\right)+G_{h}\left(v_{h}\right)
\label{13.47}\end{equation}

附加项$b_{h}\left(\dot{u}_{h}, v_{h}\right)$和$G_{h}\left(v_{h}\right)$的目的是消除（或至少减少）由Galerkin方法产生的数值振荡（当网格不够精细时），因此被命名为稳定项。后者在参数上取决于 $h$ 。

备注13.3。我们想指出，"稳定化 "这个词实际上是不确切的。Galerkin方法确实已经很稳定了，在解相对于问题数据的连续性的意义上（见已经证明的，例如在Section.  $13.1$中对问题\ref{13.1} 的证明）。在这种情况下，稳定化必须被理解为减少（最好是消除）数字解的振荡，当 $\mathbb{P e}>1$ 。

现在让我们看看选择稳定化条款的几种可能方式。

\subsubsection{Artificial diffusion and decentred finite element schemes}

根据我们对有限差分的看法，我们可以将Galerkin方法应用于问题\ref{13.16} （其弱式表述为\ref{13.18} ），用一个新的系数$\mu_{h}=\mu(1+\phi(\mathbb{P e}))$来代替粘性系数$\mu$。这样，我们最终在原来的粘度项$\mu$上增加了一个等于$\mu \phi(\mathbb{P e})$的人工（或数值）粘度，它通过局部佩克莱特数Pe取决于离散化步骤$h$。

这相当于在\ref{13.47} $G_{h}\left(v_{h}\right)=0$中的选择和

!!!!
b_{h}\left(\dot{u}_{h}, v_{h}\right)=\mu \phi(\mathbb{P e}) \int_{0}^{1} \stackrel{u}_{h} v_{h}^{\prime} d x
\label{13.48}\end{equation}

自

!!!!
a_{h}\left(\dot{u}_{h}, \stackrel{\circ}{u}_{h}\right) \geq \mu_{h}\left|\stackrel{\circ}{u}_{h}\right|_{\mathrm{H}^{1}(\Omega)}^{2}
$$

和$\mu_{h} \geq \mu$，我们可以说问题\ref{12.47}-\ref{12.48}比标准Galerkin公式有更大的矫顽力常数，这相当于在$a_{h}=a$和$F_{h}=F$中取舍。

下面的结果提供了用\ref{13.46},\ref{13.47},\ref{13.48}的解近似问题\ref{13.18}的误差的先验估计。

Theorem 13.1. Under the assumption that $u \in \mathrm{H}^{r+1}(\Omega)$, the error between the solution of problem (13.18) and that of the approximate problem (13.46) with artificial diffusion is bounded from above:

!!!!
\begin{aligned}
&\left\|\stackrel{\circ}{u}-\dot{u}_{h}\right\|_{\mathrm{H}^{1}(\Omega)} \leq \\
&\quad C \frac{h^{r}}{\mu(1+\phi(\mathbb{P} e))}\|\stackrel{\circ}{u}\|_{\mathrm{H}^{r+1}(\Omega)}+\frac{\vdots(\mathbb{P} e)}{1+\phi(\mathbb{P} e)}\|\stackrel{\circ}{u}\|_{\mathrm{H}^{1}(\Omega)}
\end{aligned}
\label{13.49}\end{equation}

with $C$ a suitable positive constant independent of $h$ and $\mu$.


证明。我们可以利用先前在第$10.4 .1$节中介绍的Strang的定理，由于该定理的存在，我们得到了一个新的证明。  $10.4 .1$，由于它，我们可以得到

!!!!
\begin{aligned}
\left\|\stackrel{\circ}{u}-\stackrel{u}_{h}\right\|_{\mathrm{H}^{1}(\Omega)} & \leq \inf _{w_{h} \in V_{h}}\left\{\left(1+\frac{M}{\mu_{h}}\right)\left\|\stackrel{\circ}{u}-w_{h}\right\|_{\mathrm{H}^{1}(\Omega)}\right.\\
&\left.+\frac{1}{\mu_{h}} \sup _{v_{h} \in V_{h}, v_{h} \neq 0} \frac{\left|a\left(w_{h}, v_{h}\right)-a_{h}\left(w_{h}, v_{h}\right)\right|}{\left\|v_{h}\right\|_{\mathrm{H}^{1}(\Omega)}}\right\} .
\end{aligned}
\label{13.50}\end{equation}

我们选择$w_{h}=P_{h}^{r} \dot{u}$，$\dot{u}$在$V_{h}$上的正交投影，相对于$\mathrm{H}_{0}^{1}(\Omega)$的标量积$\int_{0}^{1} u^{\prime} v^{\prime} d x$，即

!!!!
P_{h}^{r} \stackrel{\circ}{u} \in V_{h}: \int_{0}^{1}\left(P_{h}^{r} \stackrel{\circ}{u}-\stackrel{u}{u}\right)^{\prime} v_{h}^{\prime} d x=0 \quad \forall v_{h} \in V_{h}
$$

可以证明（见[QV94，第3章]）。

!!!!
\left\|\left(P_{h}^{r} \stackrel{u}\right)^{\prime}\right\|_{L^{2}(\Omega)} \leq\left\|(\dot{u})^{\prime}\right\|_{\mathrm{L}^{2}(\Omega)} \quad \text { and } \quad\left\|P_{h}^{r} \stackrel{\circ}{u}-\stackrel{\circ}{u}\right\|_{\mathrm{H}^{1}(\Omega)} \leq C h^{r}\|\stackrel{\circ}{u}\|_{\mathrm{H}^{r+1}(\Omega)}
$$

$C$ 是一个独立于$h$ 的常数。因此，我们可以用$\left(C / \mu_{h}\right) h^{r}\|\stackrel{\circ}{u}\|_{\mathrm{H}^{r+1}(\Omega)}$来约束\ref{13.50} 中右手边的第一个增量。现在，由于\ref{13.48} ，我们可以得到

!!!!
\frac{1}{\mu_{h}} \frac{\left|a\left(w_{h}, v_{h}\right)-a_{h}\left(w_{h}, v_{h}\right)\right|}{\left\|v_{h}\right\|_{\mathrm{H}^{1}(\Omega)}} \leq \frac{\mu}{\mu_{h}} \phi(\mathbb{P e}) \frac{1}{\left\|v_{h}\right\|_{\mathrm{H}^{1}(\Omega)}}\left|\int_{0}^{1} w_{h}^{\prime} v_{h}^{\prime} d x\right|
$$

使用考奇-施瓦茨不等式，并观察到

!!!!
\left\|v_{h}^{\prime}\right\|_{\mathrm{L}^{2}(\Omega)} \leq\left\|v_{h}\right\|_{\mathrm{H}^{1}(\Omega)}, \quad\left\|\left(P_{h}^{r} \stackrel{\circ}\right)^{\prime}\right\|_{\mathrm{L}^{2}(\Omega)} \leq\left\|P_{h}^{r} \stackrel{\circ}{u}\right\|_{\mathrm{H}^{1}(\Omega)} \leq\|\dot{u}\|_{\mathrm{H}^{1}(\Omega)},
$$

我们得到

!!!!
\frac{1}{\mu_{h}} \sup _{v_{h} \in V_{h}, v_{h} \neq 0} \frac{\left|a\left(P_{h}^{r} \dot{u}, v_{h}\right)-a_{h}\left(P_{h}^{r} \stackrel{u}, v_{h}\right)\right|}{\left\|v_{h}\right\|_{\mathrm{H}^{1}(\Omega)}} \leq \frac{\phi(\mathbb{P e})}{1+\phi(\mathbb{P e})}\|\dot{u}\|_{\mathrm{H}^{1}(\Omega)}
$$

因此，不等式\ref{13.49} 被证明。

Corollary 13.1. For a given $\mu$ and for h tending to 0 we have

!!!!
\left\|\stackrel{\circ}{u}-\stackrel{\circ}{u_{h}}\right\|_{\mathrm{H}^{1}(\Omega)} \leq C_{1}\left[h^{r}\|\stackrel{\circ}{u}\|_{\mathrm{H}^{r+1}(\Omega)}+\phi(\mathbb{P} e)\|\stackrel{\circ}{u}\|_{\mathrm{H}^{1}(\Omega)}\right]
\label{13.51}\end{equation}

where $C_{1}$ is a positive constant independent of $h$, while for a given $h$ and $\mu$ tending to 0 we have

!!!!
\left\|\stackrel{\circ}{u}-\stackrel{0}_{h}\right\|_{\mathrm{H}^{1}(\Omega)} \leq C_{2}\left[h^{r-1}\|\dot{u}\|_{\mathrm{H}^{r+1}(\Omega)}+\|\stackrel{\circ}{u}\|_{\mathrm{H}^{1}(\Omega)}\right]
\label{13.52}\end{equation}

where $C_{2}$ is a positive constant independent of $h$ and $\mu$.


证明。我们从\ref{13.49} 中得到\ref{13.51} ，记住对于任何给定的$\mu$，当$h \rightarrow 0$时，$\phi(\mathbb{P e}) \rightarrow 0$ 。为了得到\ref{13.52}，只需观察到，在上风情况下，$\phi^{U}(\mathbb{P e})=\mathbb{P e}$ ，所以

!!!!
\mu(1+\phi(\mathbb{P e}))=\mu+\frac{b}{2} h \quad \text { and } \quad \frac{\phi(\mathbb{P e})}{1+\phi(\mathbb{P e})}=\frac{h}{h+2 \mu / b}
$$

对于Scharfetter和Gummel方法，对于给定的$h$和$\mu$趋于0 .

特别是，对于给定的$\mu$，使用上风粘度时，稳定方法产生的误差在$h$中线性衰减（与度数$r$无关），而使用Scharfetter和Gummel类型的人工粘度时，如果$r \geq 2$，收敛率变成二次方。这个结果由估计\ref{13.51} 得出，回顾一下$\phi^{U}(\mathbb{P e})=\mathscr{O}(h)$，而$\phi^{S G}(\mathbb{P e})=\mathscr{O}\left(h^{2}\right)$对于固定的$\mu$和对于$h \rightarrow 0

\subsubsection{The Petrov-Galerkin method}

写出具有数值粘度的广义Galerkin问题\ref{13.46} 的一个等效方法是将其重新表述为Petrov-Galerkin方法，即测试函数的空间与寻求解决方案的空间不同的方法。准确地说，近似的形式如下

!!!!
\text { find } \stackrel{\circ}{u}_{h} \in V_{h}: \quad a\left(\dot{u}_{h}, v_{h}\right)=F\left(v_{h}\right) \quad \forall v_{h} \in W_{h},
\label{13.53}\end{equation}

其中$W_{h} \neq V_{h}$ ，而双线性形式$a(\cdot, \cdot)$与初始问题相同。可以验证，在线性有限元的情况下，即对于$r=1$，问题\ref{13.46} -\ref{13.48} 可以改写为\ref{13.53} ，其中$W_{h}$是由函数$\psi_{i}(x)=\varphi_{i}(x)+B_{i}^{\alpha}$生成的空间（见图13.8，右）。这里的$B_{i}^{\alpha}=\alpha B_{i}(x)$是所谓的气泡函数，有

!!!!
B_{i}(x)= \begin{cases}g\left(1-\frac{x-x_{i-1}}{h}\right), & x_{i-1} \leq x \leq x_{i} \\ -g\left(\frac{x-x_{i}}{h}\right), & x_{i} \leq x \leq x_{i+1} \\ 0 & \text { otherwise }\end{cases}
$$


![](https://cdn.mathpix.com/cropped/10058ab4e7f0c5bd6fe5bcd4db204623-336.jpg?height=230&width=700&top_left_y=119&top_left_x=106)

图13.8.泡沫函数$B_{i}$和空间$W_{h}$的基础函数$\psi_{i}$的例子

和$g(\xi)=3 \xi(1-\xi)$，其中$0 \leq \xi \leq 1$（见图13.8，左）[ZT00]。在上风有限差分的情况下，我们有 $\alpha=1$ ，而在Scharfetter-Gummel方案的情况下，我们有 $\alpha=\operatorname{coth}(\mathbb{P e})-1 / \mathbb{P e}$ 。请注意，在对流场的作用下，测试函数失去了其对称性特征（相对于通常的片状线性基础函数而言）。

\subsubsection{The artificial diffusion and streamline-diffusion methods in the two-dimensional case}

上风人工粘性方法可以被推广到我们考虑\ref{13.1} 类型的二维或三维问题的情况。在这种情况下，只需修改Galerkin近似法\ref{13.11} ，在双线性形式\ref{13.2} 中加入以下项即可

!!!!
Q h \int_{\Omega} \nabla u_{h} \cdot \nabla v_{h} d \Omega \quad \text { for a chosen } Q>0
\label{13.54}\end{equation}

这相当于在初始问题\ref{13.1} 中加入人工扩散项$-Q h \Delta u$。相应的方法被称为上风人工扩散。这样就引入了额外的扩散，不仅是在场$\mathbf{b}$的方向上，为了稳定Galerkin方法产生的振荡，我们理应这样做，而且还在正交方向上，这完全没有必要。例如，如果我们考虑二维问题

!!!!
-\mu \Delta u+\frac{\partial u}{\partial x}=f \quad \text { in } \Omega, \quad u=0 \quad \text { on } \partial \Omega
$$

其中传输场由矢量$\mathbf{b}=[1,0]^{T}$给出，我们要添加的人工扩散项是

!!!!
-Q h \frac{\partial^{2} u}{\partial x^{2}} \quad \text { and not } \quad-Q h \Delta u=-Q h\left(\frac{\partial^{2} u}{\partial x^{2}}+\frac{\partial^{2} u}{\partial y^{2}}\right)
$$

更一般地说，我们可以添加以下稳定化项

!!!!
-Q h \operatorname{div}[(\mathbf{b} \cdot \nabla u) \mathbf{b}]=-Q h \operatorname{div}\left(\frac{\partial u}{\partial \mathbf{b}} \mathbf{b}\right), \text { with } Q=|\mathbf{b}|^{-1}
$$

在Galerkin问题中，后者产生了以下条款

!!!!
b_{h}\left(u_{h}, v_{h}\right)=Q h\left(\mathbf{b} \cdot \nabla u_{h}, \mathbf{b} \cdot \nabla v_{h}\right)=Q h\left(\frac{\partial u_{h}}{\partial \mathbf{b}}, \frac{\partial v_{h}}{\partial \mathbf{b}}\right)
\label{13.55}\end{equation}

因此，由此产生的离散问题是对Galerkin问题\ref{13.11} 的修改，称为流线-扩散问题，其内容为

!!!!
\text { find } u_{h} \in V_{h}: a_{h}\left(u_{h}, v_{h}\right)=\left(f, v_{h}\right) \quad \forall v_{h} \in V_{h}
$$

其中

!!!!
a_{h}\left(u_{h}, v_{h}\right)=a\left(u_{h}, v_{h}\right)+b_{h}\left(u_{h}, v_{h}\right)
$$

基本上，我们正在添加一个与场$\mathbf{b}$方向的二阶导数成比例的项（也叫流线）。请注意，在这种情况下，人工粘性系数实际上是一个张量。事实上，稳定项$b_{h}(\cdot, \cdot)$可以看作是与算子$-\operatorname{div}\left(\boldsymbol{\mu}_{a} \nabla u\right)$相关的双线性形式，$\left[\boldsymbol{\mu}_{a}\right]_{i j}=Q h b_{i} b_{j}$ ，$b_{i}$是$i$的第1个分量。

尽管\ref{13.55} 项的扩散性比\ref{13.54} 小，但对于流线扩散法来说，其精度也只有$\mathscr{O}(h)$。更准确的稳定化方法在第13.8.6节中描述。13.8.6、$13.8 .8$和13.8.9节描述了更精确的稳定方法。为了介绍这些方法，我们需要一些定义，我们将在第13.8.4节和第13.8.9节预见这些定义。13.8.4和13.8.5节。

\subsubsection{Consistency and truncation error for the Galerkin and generalized Galerkin methods}

让我们考虑一个形式为\ref{13.47} 的广义Galerkin问题，并用$\stackrel{u}_{h}$代替$u_{h}$以恢复更熟悉的符号。注意，这种表述可以指任何空间维度的问题。我们定义一个变量$v_{h}$的函数

!!!!
\tau_{h}\left(u ; v_{h}\right)=a_{h}\left(u, v_{h}\right)-F_{h}\left(v_{h}\right)
$$

其规范

!!!!
\tau_{h}(u)=\sup _{v_{h} \in V_{h}, v_{h} \neq 0} \frac{\left|\tau_{h}\left(u ; v_{h}\right)\right|}{\left\|v_{h}\right\|_{V}}
\label{13.56}\end{equation}

被称为与广义Galerkin方法\ref{13.46} 相关的截断误差。根据第1.2节给出的定义，如果$\lim _{h \rightarrow 0} \tau_{h}(u)=0$，广义Galerkin方法被称为是一致的。

此外，如果截断误差\ref{13.57} 对$h$的每个值都是非零的，我们将说它是强（或完全）一致的。

标准的Galerkin方法是强一致的，正如第四章中所看到的，因为

!!!!
\tau_{h}\left(u ; v_{h}\right)=a\left(u, v_{h}\right)-F\left(v_{h}\right)=0 \quad \forall v_{h} \in V_{h}
\label{13.57}\end{equation}

相反，只要$a_{h}-a$和$F_{h}-F$在$h$趋于零时 "趋于零"，广义Galerkin方法才是一致的（一般情况下），这是Strang定理的保证。

关于上风和流线扩散方法，我们有

!!!!
\begin{aligned}
\tau_{h}\left(u ; v_{h}\right) &=a_{h}\left(u, v_{h}\right)-F\left(v_{h}\right) \\
&=a_{h}\left(u, v_{h}\right)-a\left(u, v_{h}\right)=\left\{\begin{array}{l}
Q h\left(\nabla u, \nabla v_{h}\right) \quad(\text { Upwind }), \\
Q h\left(\frac{\partial u}{\partial \mathbf{b}}, \frac{\partial v_{h}}{\partial \mathbf{b}}\right) \quad \text { (Streamline-Diffusion) }
\end{array}\right.
\end{aligned}
$$

因此两者都是一致的，但不是强一致的。强一致性方法的显著实例将在第13.8.6节中介绍和分析。

\subsubsection{Symmetric and skew-symmetric part of an operator}

让$V$是一个希尔伯特空间，$V^{\prime}$是其对偶。我们将说，一个算子$L: V \rightarrow V^{\prime}$是对称的，如果

!!!!
v^{\prime}\langle L u, v\rangle_{V}={ }_{V}\langle u, L v\rangle_{V^{\prime}} \quad \forall u, v \in V,
$$

倾斜对称的时候

!!!!
{ }_{V^{\prime}}\langle L u, v\rangle_{V}=-_{V}\langle u, L v\rangle_{V^{\prime}} \quad \forall u, v \in V
$$

一个算子可以被分成对称部分 $L_{S}$ 和偏斜对称部分 $L_{S S}$ 的总和。

!!!!
L u=L_{S} u+L_{S S} u
$$

例如，让我们考虑以下扩散-传输-反应算子

!!!!
L u=-\mu \Delta u+\operatorname{div}(\mathbf{b} u)+\sigma u, \quad \mathbf{x} \in \Omega \subset \mathbb{R}^{d}, d \geq 2
\label{13.58}\end{equation}

在空间$V=H_{0}^{1}(\Omega)$上操作。由于

!!!!
\begin{aligned}
\operatorname{div}(\mathbf{b} u) &=\frac{1}{2} \operatorname{div}(\mathbf{b} u)+\frac{1}{2} \operatorname{div}(\mathbf{b} u) \\
&=\frac{1}{2} \operatorname{div}(\mathbf{b} u)+\frac{1}{2} u \operatorname{div}(\mathbf{b})+\frac{1}{2} \mathbf{b} \cdot \nabla u
\end{aligned}
$$

我们可以按以下方式分割$L$。

!!!!
L u=\underbrace{-\mu \Delta u+\left[\sigma+\frac{1}{2} \operatorname{div}(\mathbf{b})\right] u}_{L_{S} u}+\underbrace{\frac{1}{2}[\operatorname{div}(\mathbf{b} u)+\mathbf{b} \cdot \nabla u]}_{L_{S S} u}
$$

请注意，反应系数已经变成$\sigma^{*}=\sigma+\frac{1}{2} \operatorname{div}(\mathbf{b})$ 。我们可以验证，这两个部分是对称的，而不是倾斜对称的。事实上，通过两次积分，我们得到， $\forall u, v \in V$ 。

!!!!
\begin{aligned}
v^{\prime}\left\langle L_{S} u, v\right\rangle_{V} &=\mu(\nabla u, \nabla v)+\left(\sigma^{*} u, v\right) \\
&=-\mu_{V}\langle u, \Delta v\rangle_{V^{\prime}}+\left(u, \sigma^{*} v\right) \\
&=v\left\langle u, L_{S} v\right\rangle_{V^{\prime}} \\
\qquad \begin{aligned}
v^{\prime}\left\langle L_{S S} u, v\right\rangle_{V} &=\frac{1}{2}(\operatorname{div}(\mathbf{b} u), v)+\frac{1}{2}(\mathbf{b} \cdot \nabla u, v) \\
&=-\frac{1}{2}(\mathbf{b} u, \nabla v)+\frac{1}{2}(\nabla u, \mathbf{b} v) \\
&=-\frac{1}{2}(u, \mathbf{b} \cdot \nabla v)-\frac{1}{2}(u, \operatorname{div}(\mathbf{b} v)) \\
&=-_{V}\left\langle u, L_{S S} v\right\rangle_{V^{\prime}}
\end{aligned}
\end{aligned}
$$

其中我们用$(\cdot, \cdot)$表示$L^{2}(\Omega)$的标量乘积。

备注13.4。我们回顾一下，任何矩阵A都可以被分解为和

!!!!
\mathrm{A}=\mathrm{A}_{S}+\mathrm{A}_{S S}
$$

其中

!!!!
A_{S}=\frac{1}{2}\left(A+A^{T}\right)
$$

是一个对称矩阵，称为$\mathrm{A}$的对称部分，并且

!!!!
\mathrm{A}_{S S}=\frac{1}{2}\left(\mathrm{~A}-\mathrm{A}^{T}\right)
$$

是一个歪斜对称矩阵，称为$\mathrm{A}$的歪斜对称部分。

\subsubsection{Strongly consistent methods (GLS, SUPG)}

我们考虑一个扩散-传输-反应问题，我们用抽象形式$L u=f$写在$\Omega$中，$u=0$在$\partial \Omega$上。让我们考虑相应的弱公式\ref{13.3} ，$a(\cdot, \cdot)$是与$L$相关的双线性形式。通过在Galerkin近似\ref{13.11} 中增加一个项，可以得到一个稳定的、强一致的方法，也就是考虑问题

!!!!
\text { find } u_{h} \in V_{h}: \quad a\left(u_{h}, v_{h}\right)+\mathscr{L}_{h}\left(u_{h}, f ; v_{h}\right)=\left(f, v_{h}\right) \quad \forall v_{h} \in V_{h},
\label{13.59}\end{equation}

为一个合适的形式$\mathscr{L}_{h}$，满足于

!!!!
\mathscr{L}_{h}\left(u, f ; v_{h}\right)=0 \quad \forall v_{h} \in V_{h}
\label{13.60}\end{equation}

(这是广义Galerkin方法\ref{13.46} ，\ref{13.47} 的情况，只要我们要求$\left.b_{h}\left(u, v_{h}\right)=G_{h}\left(v_{h}\right) \quad \forall v_{h} \in V_{h} .\right)$ 我们观察到在\ref{13.59}中，形式$\mathscr{L}_{h}$既取决于近似解$u_{h}$又取决于强制项$f$ 。验证\ref{13.60}的一个可能选择是

!!!!
\mathscr{L}_{h}\left(u_{h}, f ; v_{h}\right)=\mathscr{L}_{h}^{(\rho)}\left(u_{h}, f ; v_{h}\right)=\sum_{K \in \mathscr{T}_{h}}\left(L u_{h}-f, \tau_{K} \mathscr{S}^{(\rho)}\left(v_{h}\right)\right)_{\mathrm{L}^{2}(K)}
$$

其中$(u, v)_{\mathrm{L}^{2}(K)}=\int_{K} u v d K, \rho$和$\tau_{K}$是待定的参数，以及

!!!!
\mathscr{S}^{(\rho)}\left(v_{h}\right)=L_{S S} v_{h}+\rho L_{S} v_{h}
$$

这里，$L_{S}$和$L_{S S}$是被检查的算子$L$的对称部分，也就是斜对称部分。对$\tau_{K}$的一个可能选择是

!!!!
\tau_{K}=\delta \frac{h_{K}}{|\mathbf{b}(\mathbf{x})|} \quad \forall \mathbf{x} \in K, \forall K \in \mathscr{T}_{h}
\label{13.61}\end{equation}

其中$\mathbf{b}$是对流（或传输）场，$h_{K}$是通用元素的直径$K$ ，$\delta$是要规定的无尺寸系数。

为了验证\ref{13.59} 是完全一致的，我们注意到

!!!!
\tau_{h}\left(u ; v_{h}\right)=a\left(u, v_{h}\right)+\mathscr{L}_{h}^{(\rho)}\left(u, f ; v_{h}\right)-\left(f, v_{h}\right)
$$

对所有$v_{h} \in V_{h}$来说都是零，这要归功于\ref{13.3}和属性\ref{13.60}。因此截断误差\ref{13.57}为空。现在让我们看看与参数$\rho$的三种不同选择有关的一些特殊情况。

- 如果$\rho=1$，我们得到的方法称为Galerkin Least-Squares（GLS），其中

!!!!
\mathscr{S}^{(1)}\left(v_{h}\right)=L v_{h} .
$$

如果我们取$v_{h}=u_{h}$，我们看到在每个三角形上都有一个与$\int_{K}\left(L u_{h}\right)^{2} d K$成比例的项被添加到原始双线性形式中。

- 如果$\rho=0$，我们得到名为流线上风Petrov-Galerkin（SUPG）的方法，其中

!!!!
\mathscr{S}^{(0)}\left(v_{h}\right)=L_{S S} v_{h}
$$

- 如果$\rho=-1$我们得到所谓的Douglas-Wang$(\mathrm{DW})$方法，其中

!!!!
\mathscr{S}^{(-1)}\left(v_{h}\right)=\left(L_{S S}-L_{S}\right) v_{h}
$$

如果$\sigma=0$和divb$=0$，我们使用$\mathbb{P}_{1}$有限元，上述三种方法是重合的，如$-\left.\Delta u_{h}\right|_{K}=0 \quad \forall K \in \mathscr{T}_{h}$ 。

现在让我们把自己限制在两个最经典的程序，GLS$(\rho=1)$和SUPG$(\rho=0)$以及以保守形式书写的问题\ref{13.58} 。我们定义"$\rho$规范"

!!!!
\|v\|_{(\rho)}=\left\{\mu\|\nabla v\|_{\mathrm{L}^{2}(\Omega)}^{2}+\|\sqrt{\gamma} v\|_{\mathrm{L}^{2}(\Omega)}^{2}+\sum_{K \in \mathscr{T}_{h}}\left(\left(L_{S S}+\rho L_{S}\right) v, \tau_{K} \mathscr{S}^{(\rho)}(v)\right)_{\mathrm{L}^{2}(K)}\right\}^{\frac{1}{2}}
$$

其中$\gamma=\frac{1}{2}$除以$\mathbf{b}+\sigma$，当我们使用算子$L$的保守形式\ref{13.13} 时，否则使用非保守形式$\gamma=-\frac{1}{2} \operatorname{div} \mathbf{b}+\sigma$。在这两种情况下，我们假设$\gamma$是一个非负函数。以下（稳定性）不等式成立：存在一个取决于$\gamma$和$a(\cdot, \cdot)$的矫捷性常数$\alpha$的$\alpha^{*}$，使得

!!!!
\left\|u_{h}\right\|_{(\rho)} \leq \frac{C}{\alpha^{*}}\|f\|_{\mathrm{L}^{2}(\Omega)}
\label{13.62}\end{equation}

其中$C$是一个合适的常数（例如，见\ref{13.78} ）。此外，在适当的假设下，正如我们将在第13.8.8节中看到的，以下误差估计成立

!!!!
\left\|u-u_{h}\right\|_{(\rho)} \leq C h^{r+1 / 2}|u|_{\mathrm{H}^{r+1}(\Omega)}
\label{13.63}\end{equation}

因此，当我们采用的多项式的度数$r$增加时，方法的精度等级也会增加，就像在标准Galerkin方法中一样。13.8.8节将提供\ref{13.62}和\ref{13.63}在$\rho=1$情况下的证明。

稳定化参数$\delta$的选择，测量人工粘性的数量，是极其重要的。为此，我们在表$13.1$中报告了这种参数作为所选稳定方案的函数所允许的范围。在该表中，$C_{0}$是以下反不等式的常数

!!!!
\sum_{K \in \mathscr{T}_{h}} h_{K}^{2} \int_{K}\left|\Delta v_{h}\right|^{2} d K \leq C_{0}\left\|\nabla v_{h}\right\|_{\mathrm{L}^{2}(\Omega)}^{2} \quad \forall v_{h} \in X_{h}^{r}
\label{13.64}\end{equation}

很明显，$C_{0}=C_{0}(r)$ .让我们注意，对于线性有限元$C_{0}=0$ .在这种情况下，表$13.1$中的常数$\delta$不受任何上限的约束。相反，如果我们对更高程度的多项式感兴趣，$r \geq 2$ ，那么

!!!!
C_{0}(r)=\bar{C}_{0} r^{-4}
\label{13.65}\end{equation}

对于更广泛的分析，我们参考[QV94，第8章]，以及[RST96] 。我们还建议[Fun97]对带谱元素的近似情况进行分析。

表13.1.稳定参数$\delta$的允许值

\begin{tabular}{ll}
\SUPG & $0<\delta<1 / C_{0}$ GLS & $0<\delta$ GLS
GLS & $0<\delta$ （GLS）。
DW & $0<\delta<1 /\left(2 C_{0}\right)$ 缩写为 "DW"。
\hline
\end{tabular}

\subsection{On the choice of stabilization parameter $\tau_{K}$ }。

对于线性有限元$(r=1)$，另一个稳定化函数$\tau_{K}$的选择，替代\ref{13.61}中的选择，是

!!!!
\tau_{K}(\mathbf{x})=\frac{h_{K}}{2|\mathbf{b}(\mathbf{x})|} \xi\left(\mathbb{P e}_{K}\right) \quad \forall \mathbf{x} \in K, \quad \forall K \in \mathscr{T}_{h}
\label{13.66}\end{equation}

其中

!!!!
\mathbb{P e}_{K}(\mathbf{x})=\frac{|\mathbf{b}(\mathbf{x})| h_{K}}{2 \mu(\mathbf{x})} \quad \forall \mathbf{x} \in K, \quad \forall K \in \mathscr{T}_{h},
\label{13.67}\end{equation}

是局部贝克莱特数（与维度一的定义\ref{13.22} 相类似），例如，上风函数$\xi(\cdot)$可以选择如下

!!!!
\xi(\theta)=\operatorname{coth}(\theta)-1 / \theta, \quad \theta>0
\label{13.68}\end{equation}

由于$\lim _{\theta \rightarrow+\infty} \xi(\theta)=1\left(\right.$参见图13.9），如果$\mathbb{P e}_{K}(\mathbf{x}) \gg 1$，那么\ref{13.66} 在极限中减少到\ref{13.61} 与$\delta=1 / 2$ 。此外，由于$\theta \rightarrow 0$意味着$\xi(\theta)=\theta / 3+o(\theta)$，当$\mathbb{P e}_{K}(\mathbf{x}) \ll 1$时，我们有$\tau_{K}(\mathbf{x}) \rightarrow 0$（事实上，如果问题是扩散支配的，就不需要稳定化）。在文献中可以找到函数$\tau_{K}$的其他可能性。例如，$h_{K}$在\ref{13.66}-\ref{13.67}中可以用元素$K$沿$\mathbf{b}$的直径代替，或者可以选择上风函数$\xi(\cdot)$为$\xi(\theta)=\max \{0,1-1 / \theta\}$，或$\xi(\theta)=\min \{1, \theta / 3\}$（详见 [JK07] ）。

现在让我们对稳定函数的选择\ref{13.66} 给出一个启发式的解释 $\tau_{K}$ 。为此，采用一维扩散-运输问题\ref{13.16} 的变分公式\ref{13.18} 。给定$\Omega=(0,1)$的均匀分区$N$，宽度为$h=1 / N$的区间，考虑用SUPG方法对\ref{13.18}进行离散化。

!!!!
\text { find } \stackrel{\circ}{u}_{h} \in V_{h} \text { such that } a_{h}\left(\stackrel{\circ}{u}_{h}, v_{h}\right)=F_{h}\left(v_{h}\right) \quad \forall v_{h} \in V_{h},
$$

其中$V_{h} \subset H_{0}^{1}(0,1)$是$\mathscr{T}_{h}$上的片断-线性连续多项式的空间，并且

!!!!
\begin{array}{ll}
a_{h}(u, v)=\int_{0}^{1}\left(\mu u^{\prime} v^{\prime}+b u^{\prime} v\right) d x+\tau \int_{0}^{1}|b|^{2} u^{\prime} v^{\prime} d x & \forall u, v \in V_{h} \\
F_{h}(v)=-\int_{0}^{1} b v d x & \forall v \in V_{h} .
\end{array}
$$

图13.9.上风函数$\xi$定义于\ref{13.68}  通过定义$\mu_{h}=\mu\left(1+\tau|b|^{2} / \mu\right)$，双线性形式$a_{h}(\cdot, \cdot)$可以等价写为

!!!!
a_{h}(u, v)=\int_{0}^{1} \mu_{h} u^{\prime} v^{\prime} d x+\int_{0}^{1} b u^{\prime} v d x \quad \forall u, v \in V_{h}
$$

选择参数$\tau$为

!!!!
\tau=\frac{h}{2|b|}\left[\operatorname{coth}(\mathbb{P e})-\frac{1}{\mathbb{P e}}\right]
\label{13.69}\end{equation}

其中$\mathbb{P e}=\frac{b \mid h}{2 \mu}$是局部贝克莱特数。根据这些定义，我们可以得到

!!!!
\begin{aligned}
\tau \frac{|b|^{2}}{\mu} &=\mathbb{P e}\left[\operatorname{coth}(\mathbb{P e})-\frac{1}{\mathbb{P e}}\right] \\
&=\mathbb{P e c o t h}(\mathbb{P e})-1 \\
&=\mathbb{P e}-1+\mathbb{P e}(\operatorname{coth}(\mathbb{P e})-1) \\
&=\mathbb{P e}-1+B(2 \mathbb{P e})
\end{aligned}
$$

最后的平等涉及身份。

!!!!
\begin{aligned}
t(\operatorname{coth}(t)-1) &=t\left[\frac{e^{t}+e^{-t}}{e^{t}-e^{-t}}-1\right]=2 t\left[\frac{e^{-t}}{e^{t}-e^{-t}}\right] \\
&=\frac{2 t}{e^{2 t}-1}=B(2 t), \quad t>0
\end{aligned}
$$

这又是由$\operatorname{coth}(\cdot)$的定义引出的。以上，$B(\cdot)$是伯努利函数（参看第13.6节）。总而言之，$\mu_{h}$可写为

!!!!
\mu_{h}=\mu\left(1+\tau \frac{|b|^{2}}{\mu}\right)=\mu(1+\phi(\mathbb{P e}))
$$

在\ref{13.39} 中选择了$\phi$。因此，在这种特殊情况下，SUPG方法，如\ref{13.69}中选择的$\tau$，与第13.6节中遇到的Scharfetter和Gummel方法相吻合，后者是能够产生恒定系数问题（恒定源）的数值解的唯一方法，是节点上的精确。

备注13.5。如果采用度数为$r \geq 2$的多项式（如$h p$的表述，或者采用谱元），那么局部佩克莱特数的一个更连贯的定义是这样的

!!!!
\mathbb{P e}_{K}^{r}=\frac{|\mathbf{b}(\mathbf{x})| h_{K}}{2 \mu(\mathbf{x}) r}
$$

而相应的稳定函数\ref{13.66} 成为（见[GaAML04])

!!!!
\tau_{K}(\mathbf{x})=\frac{h_{K}}{2|\mathbf{b}| r} \xi\left(\mathbb{P e}_{K}^{r}\right)
$$



\subsubsection{Analysis of the GLS method}

在这一节中，我们要证明在GLS方法的情况下的稳定性属性\ref{13.62} 和收敛属性\ref{13.63} （因此对于$\rho=1$）。

我们假设微分算子$L$具有\ref{13.58} 的形式，其中$\mu>0$和$\sigma \geq 0$是常数，$\mathbf{b}$是一个矢量函数，其分量是连续的（例如常数），同质的Dirichlet边界条件被指定。因此，与算子$L$相关的双线性形式$a(\cdot, \cdot): V \times V \rightarrow \mathbb{R}$是

!!!!
a(u, v)=\mu \int_{\Omega} \nabla u \cdot \nabla v d \Omega+\int_{\Omega} \operatorname{div}(\mathbf{b} u) v d \Omega+\int_{\Omega} \sigma u v d \Omega
$$

与$V=\mathrm{H}_{0}^{1}(\Omega)$ 。为简单起见，我们假设存在两个常数 $\gamma_{0}$ 和 $\gamma_{1}$ ，以便

!!!!
0<\gamma_{0} \leq \gamma(\mathbf{x})=\frac{1}{2} \operatorname{div}(\mathbf{b}(\mathbf{x}))+\sigma \leq \gamma_{1} \quad \forall \mathbf{x} \in \Omega
\label{13.70}\end{equation}

在这种情况下，形式$a(\cdot, \cdot)$是coercive的，因为$a(v, v) \geq \mu\|\nabla v\|_{L^{2}(\Omega)}^{2}+\gamma_{0}\|v\|_{L^{2}(\Omega)}^{2}$ 。按照第13.8.5节中的程序，我们可以将与$L$相关的对称和倾斜对称部分写为

!!!!
L_{S} u=-\mu \Delta u+\gamma u, \quad L_{S S} u=\frac{1}{2}(\operatorname{div}(\mathbf{b} u)+\mathbf{b} \cdot \nabla u)
$$

此外，我们通过将$\mathscr{L}_{h}^{(1)}\left(u_{h}, f ; v_{h}\right)$分成两个项来重写稳定的公式\ref{13.59} ，一个包含$u_{h}$，另一个包含$f$。

!!!!
\text { find } u_{h} \in V_{h}: \quad a_{h}^{(1)}\left(u_{h}, v_{h}\right)=f_{h}^{(1)}\left(v_{h}\right) \quad \forall v_{h} \in V_{h}
\label{13.71}\end{equation}

与

!!!!
a_{h}^{(1)}\left(u_{h}, v_{h}\right)=a\left(u_{h}, v_{h}\right)+\sum_{K \in \mathscr{T}_{h}} \delta\left(L u_{h}, \frac{h_{K}}{|\mathbf{b}|} L v_{h}\right)_{\mathrm{L}^{2}(K)}
\label{13.72}\end{equation}

和

!!!!
f_{h}^{(1)}\left(v_{h}\right)=\left(f, v_{h}\right)+\sum_{K \in \mathscr{T}_{h}} \delta\left(f, \frac{h_{K}}{|\mathbf{b}|} L v_{h}\right)_{\mathrm{L}^{2}(K)}
\label{13.73}\end{equation}

我们观察到，使用这些符号，强一致性属性\ref{13.60}可以通过等式来表达

!!!!
a_{h}^{(1)}\left(u, v_{h}\right)=f_{h}^{(1)}\left(v_{h}\right) \quad \forall v_{h} \in V_{h}
\label{13.74}\end{equation}

我们现在可以证明以下初步结果。这个特性来自定义\ref{13.72} （选择了$v_{h}=u_{h}$）和\ref{13.70} 。在所研究的情况下，规范$\|\cdot\|_{(1)}$，为方便起见，我们在这里用符号$\|\cdot\|_{G L S}$表示，成为

!!!!
\left\|v_{h}\right\|_{G L S}^{2}=\mu\left\|\nabla v_{h}\right\|_{\mathrm{L}^{2}(\Omega)}^{2}+\left\|\sqrt{\gamma} v_{h}\right\|_{\mathrm{L}^{2}(\Omega)}^{2}+\sum_{K \in \mathscr{T}_{h}} \delta\left(\frac{h_{K}}{|\mathbf{b}|} L v_{h}, L v_{h}\right)_{\mathrm{L}^{2}(K)}
$$

我们可以证明以下稳定性结果。

Lemma 13.1. The bilinear form $a_{h}^{(1)}(\cdot, \cdot)$ defined in $(13.72)$ satisfies the following relation

!!!!
\begin{aligned}
a_{h}^{(1)}\left(v_{h}, v_{h}\right)=& \mu\left\|\nabla v_{h}\right\|_{\mathrm{L}^{2}(\Omega)}^{2}+\left\|\sqrt{\gamma} v_{h}\right\|_{\mathrm{L}^{2}(\Omega)}^{2} \\
&+\sum_{K \in \mathscr{T}_{h}} \delta\left(\frac{h_{K}}{|\mathbf{b}|} L v_{h}, L v_{h}\right)_{\mathrm{L}^{2}(K)} \forall v_{h} \in V_{h} .
\end{aligned}
\label{13.75}\end{equation}

This identity follows from definition \ref{13.72} (having chosen $v_{h}=u_{h}$ ) and from \ref{13.70}. In the case under exam, the norm $\|\cdot\|_{(1)}$, which we here denote by the symbol $\|\cdot\|_{G L S}$ for convenience, becomes

!!!!
\left\|v_{h}\right\|_{G L S}^{2}=\mu\left\|\nabla v_{h}\right\|_{\mathrm{L}^{2}(\Omega)}^{2}+\left\|\sqrt{\gamma} v_{h}\right\|_{\mathrm{L}^{2}(\Omega)}^{2}+\sum_{K \in \mathscr{T}_{h}} \delta\left(\frac{h_{K}}{|\mathbf{b}|} L v_{h}, L v_{h}\right)_{\mathrm{L}^{2}(K)}
\label{13.76}\end{equation}

We can prove the following stability result.

Lemma 13.2. Let $u_{h}$ be the solution of the GLS method. Then for each $\delta>0$ there exists a constant $C>0$, independent of $h$, such that

!!!!
\left\|u_{h}\right\|_{G L S} \leq C\|f\|_{\mathrm{L}^{2}(\Omega)}
$$



证明。我们在\ref{13.71} 中选择$v_{h}=u_{h}$。通过利用定理$13.1$和定义\ref{13.76} ，我们可以首先写出

!!!!
\left\|u_{h}\right\|_{G L S}^{2}=a_{h}^{(1)}\left(u_{h}, u_{h}\right)=f_{h}^{(1)}\left(u_{h}\right)=\left(f, u_{h}\right)_{\mathrm{L}^{2}(\Omega)}+\sum_{K \in \mathscr{T}_{h}} \delta\left(f, \frac{h_{K}}{|\mathbf{b}|} L u_{h}\right)_{\mathrm{L}^{2}(K)}
\label{13.77}\end{equation}

我们通过适当地应用Cauchy-Schwarz和Young不等式，分别为\ref{13.77} 的两个右手边项寻找一个上界。因此我们得到。

!!!!
\begin{aligned}
&\left(f, u_{h}\right)_{\mathrm{L}^{2}(\Omega)}=\left(\frac{1}{\sqrt{\gamma}} f, \sqrt{\gamma} u_{h}\right)_{\mathrm{L}^{2}(\Omega)} \leq\left\|\frac{1}{\sqrt{\gamma}} f\right\|_{\mathrm{L}^{2}(\Omega)}\left\|\sqrt{\gamma} u_{h}\right\|_{\mathrm{L}^{2}(\Omega)} \\
&\leq \frac{1}{4}\left\|\sqrt{\gamma} u_{h}\right\|_{\mathrm{L}^{2}(\Omega)}^{2}+\left\|\frac{1}{\sqrt{\gamma}} f\right\|_{\mathrm{L}^{2}(\Omega)}^{2} \\
&\left.\sum_{K \in \mathscr{T}_{h}} \delta\left(f, \frac{h_{K}}{|\mathbf{b}|} L u_{h}\right)_{\mathrm{L}^{2}(K)}=\sum_{K \in \mathscr{T}_{h}}\left(\sqrt{\delta \frac{h_{K}}{|\mathbf{b}|}} f, \sqrt{\delta \frac{h_{K}}{|\mathbf{b}|}} L u_{h}\right)_{\mathrm{L}^{2}(K)}\right) \\
&\leq \sum_{K \in \mathscr{T}_{h}}\left\|\sqrt{\delta \frac{h_{K}}{|\mathbf{b}|}} f\right\|_{\mathrm{L}^{2}(K)}\left\|\sqrt{\delta} \frac{h_{K}}{|\mathbf{b}|} L u_{h}\right\|_{\mathrm{L}^{2}(K)} \\
&\leq \sum_{K \in \mathscr{T}_{h}} \delta\left(\frac{h_{K}}{|\mathbf{b}|} f, f\right)_{\mathrm{L}^{2}(K)}+\frac{1}{4} \sum_{K \in \mathscr{T}_{h}} \delta\left(\frac{h_{K}}{|\mathbf{b}|} L u_{h}, L u_{h}\right)_{\mathrm{L}^{2}(K)}
\end{aligned}
$$

通过对前面两个上界的求和，并再次利用定义\rfe{13.76}，我们有

!!!!
\left\|u_{h}\right\|_{G L S}^{2} \leq\left\|\frac{1}{\sqrt{\gamma}} f\right\|_{\mathrm{L}^{2}(\Omega)}^{2}+\sum_{K \in \mathscr{T}_{h}} \delta\left(\frac{h_{K}}{|\mathbf{b}|} f, f\right)_{\mathrm{L}^{2}(K)}+\frac{1}{4}\left\|u_{h}\right\|_{G L S}^{2}
$$

也就是说，回顾一下$h_{K} \leq h$,

!!!!
\left\|u_{h}\right\|_{G L S}^{2} \leq \frac{4}{3}\left[\left\|\frac{1}{\sqrt{\gamma}} f\right\|_{\mathrm{L}^{2}(\Omega)}^{2}+\sum_{K \in \mathscr{T}_{h}} \delta\left(\frac{h_{K}}{|\mathbf{b}|} f, f\right)_{\mathrm{L}^{2}(K)}\right] \leq C^{2}\|f\|_{\mathrm{L}^{2}(\Omega)}^{2},
$$

已设定

!!!!
C=\left(\frac{4}{3} \max _{\mathbf{x} \in \Omega}\left(\frac{1}{\gamma}+\delta \frac{h}{|\mathbf{b}|}\right)\right)^{1 / 2}
\label{13.78}\end{equation}

我们观察到，前面的结果是有效的，唯一的约束条件是稳定化参数$\delta$是正的。事实上，这种参数也可能对每个元素$K$有所变化。在这种情况下，我们在\ref{13.72} 和\ref{13.73} 中会有$\delta_{K}$而不是$\delta$，而\ref{13.78} 中的常数$\delta$会有$\max _{K \in \mathscr{T}_{h}} \delta_{K}$的含义。

我们现在研究GLS方法的收敛性。


Theorem 13.2. We assume that the space $V_{h}$ satisfies the following local approximation property: for each $v \in V \cap H^{r+1}(\Omega)$, there exists a function $\hat{v}_{h} \in V_{h}$ such that

!!!!
\left\|v-\hat{v}_{h}\right\|_{\mathrm{L}^{2}(K)}+h_{K}\left|v-\hat{v}_{h}\right|_{\mathrm{H}^{1}(K)}+h_{K}^{2}\left|v-\hat{v}_{h}\right|_{\mathrm{H}^{2}(K)} \leq C h_{K}^{r+1}|v|_{\mathrm{H}^{r+1}(K)}
\label{13.79}\end{equation}

for each $K \in \mathscr{T}_{h}$. Moreover, we suppose that for each $K \in \mathscr{T}_{h}$ the local Péclet number of $K$ is larger than 1 ,

!!!!
\mathbb{P} e_{K}(\mathbf{x})=\frac{|\mathbf{b}(\mathbf{x})| h_{K}}{2 \mu}>1 \quad \forall \mathbf{x} \in K
\label{13.80}\end{equation}

Finally, we suppose that the inverse inequality (13.64) holds and that the stabilization parameter satisfies the relation $0<\delta \leq 2 C_{0}^{-1}$.
Then the following estimate holds for the error associated to the GLS method

!!!!
\left\|u_{h}-u\right\|_{G L S} \leq C h^{r+1 / 2}|u|_{\mathrm{H}^{r+1}(\Omega)}
\label{13.81}\end{equation}


as long as $u \in H^{r+1}(\Omega)$


证明。首先，我们将误差重写如下

!!!!
e_{h}=u_{h}-u=\sigma_{h}-\eta,
\label{13.82}\end{equation}

与$\sigma_{h}=u_{h}-\hat{u}_{h}, \eta=u-\hat{u}_{h}$，其中$\hat{u}_{h} \in V_{h}$是一个取决于$u$并满足属性\ref{13.79} 的函数。例如，如果$V_{h}=X_{h}^{r} \cap H_{0}^{1}(\Omega)$，我们可以选择$\hat{u}_{h}=\Pi_{h}^{r} u$，它是$u$的有限元插值。我们首先估计规范 $\left\|\sigma_{h}\right\|_{G L S}$ 。通过利用\ref{13.74} 给出的GLS方案的强一致性，我们得到

!!!!
\left\|\sigma_{h}\right\|_{G L S}^{2}=a_{h}^{(1)}\left(\sigma_{h}, \sigma_{h}\right)=a_{h}^{(1)}\left(u_{h}-u+\eta, \sigma_{h}\right)=a_{h}^{(1)}\left(\eta, \sigma_{h}\right)
$$

感谢\ref{13.71} 。现在，根据定义\ref{13.72} ，并由于同质的迪里切特边界条件，可以看出

!!!!
\begin{aligned}
&a_{h}^{(1)}\left(\eta, \sigma_{h}\right)=\mu \int_{\Omega} \nabla \eta \cdot \nabla \sigma_{h} d \Omega-\int_{\Omega} \eta \mathbf{b} \cdot \nabla \sigma_{h} d \Omega+\int_{\Omega} \sigma \eta \sigma_{h} d \Omega \\
&+\sum_{K \in \mathscr{T}_{h}} \delta\left(L \eta, \frac{h_{K}}{|\mathbf{b}|} L \sigma_{h}\right)_{\mathrm{L}^{2}(K)}=\underbrace{\mu\left(\nabla \eta, \nabla \sigma_{h}\right)-\sum_{K \in \mathscr{T}_{h}}\left(\eta, L \sigma_{h}\right)_{K}}_{(\mathrm{I})}+\underbrace{2\left(\gamma \eta, \sigma_{h}\right)_{\mathrm{L}^{2}(\Omega)}}_{(\mathrm{III})} \\
&+\underbrace{\sum_{K \in \mathscr{T}_{h}}\left(\eta,-\mu \Delta \sigma_{h}\right)_{\mathrm{L}^{2}(K)}}+\underbrace{\sum_{K \in \mathscr{T}_{h}} \delta\left(L \eta, \frac{h_{K}}{|\mathbf{b}|} L \sigma_{h}\right)_{\mathrm{L}^{2}(K)}}_{(\mathrm{V})} .
\end{aligned}
$$

现在我们分别对条款$(\mathrm{I})-(\mathrm{V})$进行约束。通过仔细使用考奇-施瓦茨和杨氏不等式，我们得到

!!!!
\begin{aligned}
(\mathrm{I}) &=\mu\left(\nabla \eta, \nabla \sigma_{h}\right)_{\mathrm{L}^{2}(\Omega)} \leq \frac{\mu}{4}\left\|\nabla \sigma_{h}\right\|_{\mathrm{L}^{2}(\Omega)}^{2}+\mu\|\nabla \eta\|_{\mathrm{L}^{2}(\Omega)}^{2} \\
(\mathrm{II}) &=-\sum_{K \in \mathscr{T}_{h}}\left(\eta, L \sigma_{h}\right)_{\mathrm{L}^{2}(K)}=-\sum_{K \in \mathscr{T}}\left(\sqrt{\frac{|\mathbf{b}|}{\delta h_{K}}} \eta, \sqrt{\frac{\delta h_{K}}{|\mathbf{b}|}} L \sigma_{h}\right)_{\mathrm{L}^{2}(K)} \\
& \leq \frac{1}{4} \sum_{K \in \mathscr{T}_{h}} \delta\left(\frac{h_{K}}{|\mathbf{b}|} L \sigma_{h}, L \sigma_{h}\right)_{\mathrm{L}^{2}(K)}+\sum_{K \in \mathscr{T}_{h}}\left(\frac{|\mathbf{b}|}{\delta h_{K}} \eta, \eta\right)_{\mathrm{L}^{2}(K)}
\end{aligned}
$$

对于(IV)项，再次感谢考奇-施瓦茨和杨氏不等式，假设\ref{13.80}和反不等式\ref{13.64}，我们得到

!!!!
\begin{aligned}
(\mathrm{IV}) &=\sum_{K \in \mathscr{T}_{h}}\left(\eta,-\mu \Delta \sigma_{h}\right)_{\mathrm{L}^{2}(K)} \\
& \leq \frac{1}{4} \sum_{K \in \mathscr{T}_{h}} \delta \mu^{2}\left(\frac{h_{K}}{|\mathbf{b}|} \Delta \sigma_{h}, \Delta \sigma_{h}\right)_{\mathrm{L}^{2}(K)}+\sum_{K \in \mathscr{T}_{h}}\left(\frac{|\mathbf{b}|}{\delta h_{K}} \eta, \eta\right)_{\mathrm{L}^{2}(K)} \\
& \leq \frac{1}{8} \delta \mu \sum_{K \in \mathscr{T}} h_{K}^{2}\left(\Delta \sigma_{h}, \Delta \sigma_{h}\right)_{\mathrm{L}^{2}(K)}+\sum_{K \in \mathscr{T}_{h}}\left(\frac{|\mathbf{b}|}{\delta h_{K}} \eta, \eta\right)_{\mathrm{L}^{2}(K)} \\
& \leq \frac{\delta C_{0} \mu}{8}\left\|\nabla \sigma_{h}\right\|_{\mathrm{L}^{2}(\Omega)}^{2}+\sum_{K \in \mathscr{T}_{h}}\left(\frac{|\mathbf{b}|}{\delta h_{K}} \eta, \eta\right)_{\mathrm{L}^{2}(K)}
\end{aligned}
$$

由于考奇-施瓦茨和杨氏不等式，项（V）最终可以再次被约束，如下所示

!!!!
\begin{aligned}
(\mathrm{V}) &=\sum_{K \in \mathscr{T}_{h}} \delta\left(L \eta, \frac{h_{K}}{|\mathbf{b}|} L \sigma_{h}\right)_{\mathrm{L}^{2}(K)} \\
& \leq \frac{1}{4} \sum_{K \in \mathscr{T}_{h}} \delta\left(\frac{h_{K}}{|\mathbf{b}|} L \sigma_{h}, L \sigma_{h}\right)_{\mathrm{L}^{2}(K)}+\sum_{K \in \mathscr{T}_{h}} \delta\left(\frac{h_{K}}{|\mathbf{b}|} L \eta, L \eta\right)_{\mathrm{L}^{2}(K)}
\end{aligned}
$$

由于这些上界并再次使用定义\ref{13.76} ，我们得到以下估计

!!!!
\begin{aligned}
&\left\|\sigma_{h}\right\|_{G L S}^{2}=a_{h}^{(1)}\left(\eta, \sigma_{h}\right) \leq \frac{1}{4}\left\|\sigma_{h}\right\|_{G L S}^{2} \\
&+\frac{1}{4}\left(\left\|\sqrt{\gamma} \sigma_{h}\right\|_{\mathrm{L}^{2}(\Omega)}^{2}+\sum_{K \in \mathscr{T}_{h}} \delta\left(\frac{h_{K}}{|\mathbf{b}|} L \sigma_{h}, L \sigma_{h}\right)_{\mathrm{L}^{2}(K)}\right)+\frac{\delta C_{0} \mu}{8}\left\|\nabla \sigma_{h}\right\|_{\mathrm{L}^{2}(\Omega)}^{2} \\
&+\underbrace{\mu\|\nabla \eta\|_{\mathrm{L}^{2}(\Omega)}^{2}+2 \sum_{K \in \mathscr{T}_{h}}\left(\frac{|\mathbf{b}|}{\delta h_{K}} \eta, \eta\right)_{\mathrm{L}^{2}(K)}+2\|\sqrt{\gamma} \eta\|_{\mathrm{L}^{2}(\Omega)}^{2}+\sum_{K \in \mathscr{T}_{h}} \delta\left(\frac{h_{K}}{|\mathbf{b}|} L \eta, L \eta\right)_{\mathrm{L}^{2}(K)}}_{\mathscr{E}(\eta)} \\
&\leq \frac{1}{2}\left\|\sigma_{h}\right\|_{G L S}^{2}+\mathscr{E}(\eta)
\end{aligned}
$$

在最后一段话中，利用了$\delta \leq 2 C_{0}^{-1}$的假设。然后，我们可以说

!!!!
\left\|\sigma_{h}\right\|_{G L S}^{2} \leq 2 \mathscr{E}(\eta)
$$

现在我们通过分别约束它的每个小数来估计项$\mathscr{E}(\eta)$。为此，我们将基本上使用局部近似特性\ref{13.79} 和\ref{13.80} 中提出的关于局部佩克莱特数$\mathbb{P e}_{K}$的要求。此外，我们注意到，余下部分引入的常数$C$既不取决于$h$，也不取决于$\mathbb{P}_{K}$，但可以取决于其他量，如\ref{13.70} 中的常数$\gamma_{1}$，反应常数$\sigma$，规范$\|\mathbf{b}\|_{L^{\infty}(\Omega)}$ ，稳定参数$\delta$ 。然后我们有

!!!!
\begin{aligned}
&\mu\|\nabla \eta\|_{\mathrm{L}^{2}(\Omega)}^{2} \leq C \mu h^{2 r}|u|_{\mathrm{H}^{r+1}(\Omega)}^{2} \\
&\leq C \frac{\|\mathbf{b}\|_{L^{\infty}(\Omega)} h}{2} h^{2 r}|u|_{\mathrm{H}^{r+1}(\Omega)}^{2} \leq C h^{2 r+1}|u|_{\mathrm{H}^{r+1}(\Omega)}^{2} \\
&\qquad 2 \sum_{K \in \mathscr{T}_{h}}\left(\frac{|\mathbf{b}|}{\delta h_{K}} \eta, \eta\right)_{\mathrm{L}^{2}(K)} \leq C \frac{\|\mathbf{b}\|_{L^{\infty}(\Omega)}}{\delta} \sum_{K \in \mathscr{T}_{h}} \frac{1}{h_{K}} h_{K}^{2(r+1)}|u|_{\mathrm{H}^{r+1}(K)}^{2} \\
&\leq C h^{2 r+1}|u|_{\mathrm{H}^{r+1}(\Omega)}^{2} \\
&2\|\sqrt{\gamma} \eta\|_{\mathrm{L}^{2}(\Omega)}^{2} \leq 2 \gamma_{1}\|\eta\|_{\mathrm{L}^{2}(\Omega)}^{2} \leq C h^{2(r+1)}|u|_{\mathrm{H}^{r+1}(\Omega)}^{2}
\end{aligned}
\label{13.83}\end{equation}

在控制第三项和的时候，利用了假设\ref{13.70} 。为$\mathscr{E}(\eta)$的第四项和找到一个上界要稍微困难一些：首先，通过对$L \eta$项的阐述，我们有

!!!!
\begin{aligned}
&\sum_{K \in \mathscr{T}_{h}} \delta\left(\frac{h_{K}}{|\mathbf{b}|} L \eta, L \eta\right)_{\mathrm{L}^{2}(K)}=\sum_{K \in \mathscr{T}_{h}} \delta\left\|\sqrt{\frac{h_{K}}{|\mathbf{b}|}} L \eta\right\|_{L^{2}(K)}^{2} \\
&=\sum_{K \in \mathscr{T}_{h}} \delta\left\|-\mu \sqrt{\frac{h_{K}}{|\mathbf{b}|}} \Delta \eta+\sqrt{\frac{h_{K}}{|\mathbf{b}|}} \operatorname{div}(\mathbf{b} \eta)+\sigma \sqrt{\frac{h_{K}}{|\mathbf{b}|}} \eta\right\|_{\mathrm{L}^{2}(K)}^{2} \\
&\leq C \sum_{K \in \mathscr{T}_{h}} \delta\left(\left\|\mu \sqrt{\frac{h_{K}}{|\mathbf{b}|}} \Delta \eta\right\|_{\mathrm{L}^{2}(K)}^{2}+\left\|\sqrt{\frac{h_{K}}{|\mathbf{b}|}} \operatorname{div}(\mathbf{b} \eta)\right\|_{\mathrm{L}^{2}(K)}^{2}+\left\|\sigma \sqrt{\frac{h_{K}}{|\mathbf{b}|}} \eta\right\|_{\mathrm{L}^{2}(K)}^{2}\right)
\end{aligned}
$$

现在，通过类似于获得估计值\ref{13.83} 和\ref{13.84} 的计算，很容易证明\ref{13.85} 左手边的第二和第三项可以用形式为$C h^{2 r+1}|u|_{\mathrm{H}^{r+1}(\Omega)}^{2}$的项进行约束，对于常数$C$的适当选择。对于第一个和，我们有

!!!!
\begin{aligned}
&\sum_{K \in \mathscr{T}_{h}} \delta\left\|\mu \sqrt{\frac{h_{K}}{|\mathbf{b}|}} \Delta \eta\right\|_{\mathrm{L}^{2}(K)}^{2} \leq \sum_{K \in \mathscr{T}_{h}} \delta \frac{h_{K}^{2} \mu}{2}\|\Delta \eta\|_{\mathrm{L}^{2}(K)}^{2} \\
&\leq C \delta\|\mathbf{b}\|_{L^{\infty}(\Omega)} \sum_{K \in \mathscr{T}_{h}} h_{K}^{3}\|\Delta \eta\|_{\mathrm{L}^{2}(K)}^{2} \leq C h^{2 r+1}|u|_{\mathrm{H}^{r+1}(\Omega)}^{2}
\end{aligned}
$$

再次使用条件\ref{13.79} 和\ref{13.80} 。后者的约束使我们可以得出以下结论

!!!!
\mathscr{E}(\eta) \leq C h^{2 r+1}|u|_{\mathrm{H}^{r+1}(\Omega)}^{2}
$$

就是说

!!!!
\left\|\sigma_{h}\right\|_{G L S} \leq C h^{r+1 / 2}|u|_{\mathrm{H}^{r+1}(\Omega)}
\label{13.86}\end{equation}

回归到\ref{13.82} ，为了获得对规范$\left\|u_{h}-u\right\|_{G L S}$的理想估计，我们仍然必须估计$\|\eta\|_{G L S}$。这显然会导致估计三个贡献，如\ref{13.83} 、\ref{13.84} 和\ref{13.85} ，并最终产生

!!!!
\|\eta\|_{G L S} \leq C h^{r+1 / 2}|u|_{\mathrm{H}^{r+1}(\Omega)}
$$

将这一结果与\ref{13.86} 结合起来，就可以得到所需的估计值\ref{13.81} 。

\subsubsection{Stabilization through bubble functions}

前面几节考虑的广义Galerkin方法，由于双线性形式的丰富性，产生了稳定的数值解 $a(\cdot, \cdot)$ 。另一种策略是采用比标准子空间更丰富的子空间 $V_{h}$ 。这样做的目的是在丰富的空间中选择近似解和测试函数，从而保持在一个经典的Galerkin框架内。参照通常的扩散-传输-反应问题的形式\ref{13.1} ，我们引入有限维空间

!!!!
V_{h}^{b}=V_{h} \oplus B
$$

其中$V_{h}=X_{h}^{r} \cap H_{0}^{1}(\Omega)$是通常的空间，$B$是泡沫函数的有限维空间，或

!!!!
B=\left\{v_{B} \in H_{0}^{1}(\Omega):\left.v_{B}\right|_{K}=c_{K} b_{K},\left.b_{K}\right|_{\partial K}=0 \text { and } c_{K} \in \mathbb{R}\right\}
$$

在每个元素$K$上，我们再加上修正项$b_{K}$，对其有几种不同的选择。由于我们只想处理与空间$\mathscr{T}_{h}$相关的初始网格$V_{h}$，一个标准的选择导致定义$b_{K}=\lambda_{1} \lambda_{2} \lambda_{3}$，其中$\lambda_{i}$，对于$i=0, \ldots, 2$，是$K$上的arycentric坐标，即定义于$K$的线性多项式，在三角形的一侧消失，在与该侧相反的顶点取值为1。(其定义见$4.4 .3$节）。)在这种情况下，函数$b_{K}$与所谓的立方气泡相吻合，在$K$的边界上取值为0，在其内部取值为正（见图13.10（左））。] 是与三角形$K$相关的唯一自由度（例如，它将与$b_{K}$在$K$上的最大值重合，或者与它在重心处的值重合）。(见第4.4.3节）。)

备注13.6.为了在域$\Omega$上引入一个计算子网格(作为网格$\mathscr{T}_{h}$的适当细化而得到)，我们可以对气泡函数$b_{K}$采用更复杂的定义。例如，$b_{K}$可以是一个片状线性函数，同样定义在元素$K$上，并且在三角形的边界上假设值为0（就像与$K$内的某个点相关的线性有限元的基函数）（见图13.10（右））。  [EG04] .

在这一点上，我们可以引入所研究问题的空间$V_{h}^{b}$上的Galerkin近似，其形式为

!!!!
\text { find } u_{h}^{b} \in V_{h}^{b}: \quad a\left(u_{h}+u_{b}, v_{h}^{b}\right)=\left(f, v_{h}^{b}\right) \quad \forall v_{h}^{b} \in V_{h}^{b} \text {, }
$$

与$a(\cdot, \cdot)$是与微分算子$L$相关的双线性形式。
 ![](https://cdn.mathpix.com/cropped/10058ab4e7f0c5bd6fe5bcd4db204623-350.jpg?height=270&width=464&top_left_y=928&top_left_x=224)

图13.10.立体（左）和线性（右）气泡的例子 我们建议将\ref{13.87} 重写为$V_{h}$中的稳定Galerkin方案，通过消除函数$u_{b}$。到目前为止，我们只能说，在每个元素 $K,\left.u_{b}\right|_{K}=c_{b, K} b_{K}$ 对于一个合适的（未知的）常数 $c_{b, K}$ ，与 $u_{b} \in B$ 。我们将$u_{h}^{b}$和$v_{h}^{b}$都分解为$V_{h}$的函数和$B$的函数之和，也就是

!!!!
u_{h}^{b}=u_{h}+u_{b}, \quad v_{h}^{b}=v_{h}+v_{b}
$$

对于任何给定的$K$，我们首先选择\ref{13.87} 中的$v_{h}^{b}$作为测试函数，该函数由$v_{h}=0$和$v_{b} \in B$确定，以便

!!!!
v_{b}= \begin{cases}b_{K} & \text { in } K \\ 0 & \text { elsewhere }\end{cases}
$$

然后我们有

!!!!
a\left(u_{h}+u_{b}, v_{b}\right)=a_{K}\left(u_{h}+c_{b, K} b_{K}, b_{K}\right)
$$

用$a_{K}(\cdot, \cdot)$表示双线性形式$a(\cdot, \cdot)$对元素$K$的限制。因此，我们可以将\ref{13.87} 改写为

!!!!
a_{K}\left(u_{h}, b_{K}\right)+c_{b, K} a_{K}\left(b_{K}, b_{K}\right)=\left(f, b_{K}\right)_{\mathrm{L}^{2}(K)}
\label{13.88}\end{equation}

利用$b_{K}$在$K$的边界上消失的事实，我们可以对\ref{13.88} 的第一项进行分项积分，得到$a_{K}\left(u_{h}, b_{K}\right)=\left(L u_{h}, b_{K}\right)_{\mathrm{L}^{2}(K)}$，那么常数$c_{b, K}$的未知值为

!!!!
c_{b, K}=\frac{\left(f-L u_{h}, b_{K}\right)_{\mathrm{L}^{2}(K)}}{a_{K}\left(b_{K}, b_{K}\right)}
$$

我们现在选择\ref{13.87}中的测试函数$v_{h}^{b}$作为任何函数$v_{h} \in V_{h}$和$v_{b}=0$所识别的函数，从而得到

!!!!
a\left(u_{h}, v_{h}\right)+\sum_{K \in \mathscr{T}_{h}} c_{b, K} a_{K}\left(b_{K}, v_{h}\right)=\left(f, v_{h}\right)_{\mathrm{L}^{2}(\Omega)}
\label{13.89}\end{equation}

让我们重写$a_{K}\left(b_{K}, v_{h}\right)$ 。通过部分积分并利用微分算子$L$的对称和偏斜对称部分的定义（见第13.8.5节），我们有

!!!!
\begin{aligned}
a_{K}\left(b_{K}, v_{h}\right)=& \int_{K} \mu \nabla b_{K} \cdot \nabla v_{h} d K+\int_{K} \mathbf{b} \cdot \nabla b_{K} v_{h} d K+\int_{K} \sigma b_{K} v_{h} d K \\
=&-\int_{K} \mu b_{K} \Delta v_{h} d K+\int_{\partial K} \mu b_{K} \nabla v_{h} \cdot \mathbf{n} d \gamma-\int_{K} b_{K} \nabla v_{h} \cdot \mathbf{b} d K \\
&+\int_{\partial K} \mathbf{b} \cdot \mathbf{n} v_{h} b_{K} d \gamma+\int_{K} \sigma b_{K} v_{h} d K=\left(b_{K},\left(L_{S}-L_{S S}\right) v_{h}\right)_{\mathrm{L}^{2}(K)}
\end{aligned}
$$

我们利用了泡沫函数$b_{K}$在元素$K$的边界上消失的特性，此外，divb$=0$。以非常类似的方式，我们可以用以下方式重写常数$c_{b, K}$的分母

!!!!
a_{K}\left(b_{K}, b_{K}\right)=\left(L_{S} b_{K}, b_{K}\right)_{\mathrm{L}^{2}(K)}
$$

回归到\ref{13.89} ，因此我们有

!!!!
a\left(u_{h}, v_{h}\right)+a_{B}\left(u_{h}, f ; v_{h}\right)=\left(f, v_{h}\right)_{\mathrm{L}^{2}(\Omega)} \quad \forall v_{h} \in V_{h}
$$

其中

!!!!
a_{B}\left(u_{h}, f ; v_{h}\right)=\sum_{K \in \mathscr{T}_{h}} \frac{\left(L u_{h}-f, b_{K}\right)_{K}\left(L_{S S} v_{h}-L_{S} v_{h}, b_{K}\right)_{\mathrm{L}^{2}(K)}}{\left(L_{S} b_{K}, b_{K}\right)_{\mathrm{L}^{2}(K)}}
$$

因此，我们找到了一个稳定的Galerkin方案，它可以被表述为强一致的形式\ref{13.59} 。在$\mathbf{b}$为常数的情况下，我们可以用一种广义的道格拉斯-王方法来确定它。

通过选择一个方便的气泡$b_{K}$并遵循与上面说明的类似的程序，也可以定义广义的SUPG和GLS方法（见[BFHR97] ）。基于所谓的子网格粘性的类似策略也可以成功使用。见[EG04]中的广泛分析。

\subsection{DG methods for diffusion-transport equations}

第12章中介绍的用于泊松问题的非连续Galerkin方法可以扩展到扩散-传输-反应问题\ref{13.13} （守恒形式），如下：求$u_{\delta} \in W_{\delta}^{0}$s.t.

!!!!
\begin{gathered}
\left.\left.\sum_{m=1}^{M}\left(\mu \nabla u_{\delta}, \nabla v_{\delta}\right)_{\Omega_{m}}-\sum_{e \in \mathscr{E}_{\delta}} \int_{e}\left[v_{\delta}\right] \cdot\left\{\mu \nabla u_{\delta}\right\}-\tau \sum_{e \in \mathscr{E}_{\delta}} \int_{e}\left[u_{\delta}\right]\{\mu\rangle v_{\delta}\right\}\right\} \\
+\sum_{e \in \mathscr{E}_{\delta}} \int_{e} \gamma|e|^{-1}\left[u_{\delta}\right] \cdot\left[v_{\delta}\right]-\sum_{m=1}^{M}\left(\mathbf{b} u_{\delta}, \nabla v_{\delta}\right)_{\Omega_{m}}+\sum_{e \in \mathscr{E}_{\delta}} \int_{e}\left\{\mathfrak{b} u_{\delta}\right\}_{\mathbf{b}} \cdot\left[v_{\delta}\right] \\
+\sum_{m=1}^{M}\left(\sigma u_{\delta}, v_{\delta}\right)_{\Omega_{m}}=\sum_{m=1}^{M}\left(f, v_{\delta}\right)_{\Omega_{m}}
\end{gathered}
\label{13.90}\end{equation}

我们使用了与第12.1节相同的符号；此外。

!!!!
\left\{\mathbf{b} u_{\delta}\right\}_{\mathbf{b}}= \begin{cases}\mathbf{b} u_{\delta}^{+} & \text {if } \mathbf{b} \cdot \mathbf{n}^{+}>0 \\ \mathbf{b} u_{\delta}^{-} & \text {if } \mathbf{b} \cdot \mathbf{n}^{+}<0 \\ \mathbf{b}\left\{u_{\delta}\right\} & \text { if } \mathbf{b} \cdot \mathbf{n}^{+}=0\end{cases}
\label{13.91}\end{equation}

请注意：$\left\{\mathbf{b} u_{\delta}\right\}_{\mathbf{b}} \cdot\left[v_{\delta}\right]=0$ 如果$\mathbf{b} \cdot \mathbf{n}^{+}=0

如果扩散-运输-反应方程以非保守形式写成\ref{13.1} ，通过b$\cdot \nabla u=\operatorname{div}(\mathbf{b} u)-\operatorname{div}(\mathbf{b}) u$，只需修改\ref{13.90}，代入项

!!!!
\sum_{m=1}^{M}\left(\sigma u_{\delta}, v_{\delta}\right)_{\Omega_{m}} \text { with } \sum_{m=1}^{M}\left(\eta u_{\delta}, v_{\delta}\right)_{\Omega_{m}}
$$

其中$\eta(\mathbf{x})=\sigma(\mathbf{x})-\operatorname{div}(\mathbf{b}(\mathbf{x})) ;$这次我们假设存在一个正的常数$\eta_{0}>0$，以便$\eta(\mathbf{x}) \geq \eta_{0}$对几乎每一个$\mathbf{x} \in \Omega$都是如此。

DG方法可以很容易地被定位到每一个子域$\Omega_{m}$（无论是有限元还是谱元）。事实上，由于检验函数不一定是连续的，对于每个$m(m=1, \ldots, M)$，我们可以选择检验函数在元素$\Omega_{m}$外消失。这样，\ref{13.90} 中的和（或\ref{12.7）中的和）被简化为单一指数$m$，而边缘上的和被简化为$\Omega_{m}$边界上的边缘。我们在这里发现了DG方法的另一个特点：它很适合于逐个元素的局部细化，既可以是网格细化（"$h$ -细化"），也可以是多项式细化（"$p$ -细化"，$p$ 是局部多项式程度，与有限元的$r$ 和谱元方法的$N$ 表示的一样）。

在第1章中，我们将看到在双曲问题中，解是不连续的。  $14,15,16$我们将看到，在双曲问题中，解可能是不连续的。当初始和/或边界数据不连续时就是这种情况，更普遍的是，对于非线性问题。在所有这些情况下，基于不连续多项式函数的近似是非常合适的。关于扩散-传输问题的DG方法的进一步细节，请参见，例如[Coc99, HSS02, BMS04, BHS06, AM09]。

最后，让我们指出，前面的描述可以扩展到一个问题，即空间算子被写成取决于$\nabla u$ , $\operatorname{div}(\phi(\nabla u))$ 的通量的发散。为此，我们只需要在每个公式中用通量表达式$\nabla u$代替$\Phi(\nabla u)$ 。

关于DG方法\ref{13.90} 得到的数值结果的分析，我们参考第13.11节。

\subsection{Mortar methods for the diffusion-transport equations}

第12章中描述的关于泊松问题的砂浆方法可以应用于方程\ref{13.1} 和以守恒形式书写的方程\ref{13.13} 的离散化。域离散化以及主空间和从空间的选择可以按照第12章中对泊松问题的描述来进行。

在方程\ref{12.19} 和系统\ref{12.30} 中出现的双线性形式$a_{i}\left(u_{\delta}^{(i)}, v_{\delta}^{(i)}\right)$现在读作

!!!!
a_{i}\left(u_{\delta}^{(i)}, v_{\delta}^{(i)}\right)=\int_{\Omega_{i}} \mu \nabla u_{\delta}^{(i)} \cdot \nabla v_{\delta}^{(i)}+\int_{\Omega_{i}} v_{\delta}^{(i)} \mathbf{b} \cdot \nabla u_{\delta}^{(i)}+\int_{\Omega_{i}} \sigma u_{\delta}^{(i)} v_{\delta}^{(i)}
$$

在问题\ref{13.1} 的情况下，和

!!!!
a_{i}\left(u_{\delta}^{(i)}, v_{\delta}^{(i)}\right)=\int_{\Omega_{i}} \mu \nabla u_{\delta}^{(i)} \cdot \nabla v_{\delta}^{(i)}-\int_{\Omega_{i}} u_{\delta}^{(i)} \mathbf{b} \cdot \nabla v_{\delta}^{(i)}+\int_{\Omega_{i}} \sigma u_{\delta}^{(i)} v_{\delta}^{(i)}+\int_{\partial \Omega_{i}} \mathbf{b} \cdot \mathbf{n} u_{\delta}^{(i)} v_{\delta}^{(i)}
\label{13.92}\end{equation}

如果是守恒形式的问题\ref{13.13} ，其中传输项已被部分整合。

然而，我们必须指出，当$|\mathbf{b}(\mathbf{x})| \gg \mu$时，如前一章所见，砂浆解并不总是允许达到像\ref{12.20} 和\ref{12.21} 那样的最佳误差估计，也就是可以表示为局部误差之和的全局误差，而不要求共享同一界面的子域离散化之间有任何兼容性约束。更确切地说，由于界面上的不一致性，即使像GLS或SUPG这样的稳定技术被调用，也会出现不稳定。为了理解为什么会出现这种情况，我们首先考虑守恒形式的扩散-传输-反应问题\ref{13.13} 及其弱迫公式（如\ref{12.19} ），其$a_{i}\left(u_{\delta}^{(i)}, v_{\delta}^{(i)}\right)$定义在\ref{13.92} 。现在加入GLS稳定化，用稳定化的形式代替双线性形式

!!!!
a_{i, \delta}^{(1)}\left(u_{\delta}^{(i)}, v_{\delta}^{(i)}\right)=a_{i}\left(u_{\delta}^{(i)}, v_{\delta}^{(i)}\right)+\sum_{T_{i, k} \in \mathscr{T}_{i}}\left(L u_{\delta}^{(i)}, \tau_{k} L v_{\delta}^{(i)}\right)_{L^{2}\left(T_{i, k}\right)}
\label{13.93}\end{equation}

根据前几节使用的形式主义，$a_{i . \delta}^{(1)}$中的索引（1）表示稳定化中的选择$\rho=1$；$T_{i, k}$中的元素是$\Omega_{i}$的三角化的元素。现在我们写道

!!!!
a_{\delta}^{(1)}\left(u_{\delta}, v_{\delta}\right)=\sum_{i=1}^{2} a_{i, \delta}^{(1)}\left(u_{\delta}^{(i)}, v_{\delta}^{(i)}\right)
$$

(源术语以类似的方式进行稳定)。

使用经典的积分规则，我们有

!!!!
\begin{aligned}
\int_{\Omega_{i}} \operatorname{div}\left(\mathbf{b} u_{\delta}^{(i)}\right) u_{\delta}^{(i)} &=\frac{1}{2} \int_{\Omega_{i}} \operatorname{div}\left(\mathbf{b} u_{\delta}^{(i)}\right) u_{\delta}^{(i)}-\frac{1}{2} \int_{\Omega_{i}} u_{\delta}^{(i)} \mathbf{b} \cdot \nabla u_{\delta}^{(i)}+\frac{1}{2} \int_{\partial \Omega_{i}} \mathbf{b} \cdot \mathbf{n}_{i}\left(u_{\delta}^{(i)}\right)^{2} \\
&=\frac{1}{2} \int_{\Omega_{i}}(\operatorname{div} \mathbf{b})\left(u_{\delta}^{(i)}\right)^{2}+\frac{1}{2} \int_{\Gamma} \mathbf{b} \cdot \mathbf{n}_{i}\left(u_{\delta}^{(i)}\right)^{2}
\end{aligned}
$$

其中$\mathbf{n}_{i}$表示$\partial \Omega_{i}$上的外向单位矢量，由于同质的迪里希特条件，最后一个边界积分现在被限制在内部界面上。那么

!!!!
\begin{aligned}
a_{i, \delta}^{(1)}\left(u_{\delta}^{(i)}, u_{\delta}^{(i)}\right)=& \mu\left\|\nabla u_{\delta}^{(i)}\right\|_{L^{2}\left(\Omega_{i}\right)}^{2}+\left\|\sqrt{\sigma+\frac{1}{2} \operatorname{divb}} u_{\delta}^{(i)}\right\|_{L^{2}\left(\Omega_{i}\right)}^{2} \\
&+\sum_{T_{i, k} \in \mathscr{T}_{i}}\left(L u_{\delta}^{(i)}, \tau_{k} L u_{\delta}^{(i)}\right)_{L^{2}\left(T_{i, k}\right)}+\frac{1}{2} \int_{\Gamma} \mathbf{b} \cdot \mathbf{n}_{i}\left(u_{\delta}^{(i)}\right)^{2}
\end{aligned}
$$

和

!!!!
\begin{aligned}
a_{\delta}^{(1)}\left(u_{\delta}, u_{\delta}\right)=& \mu\left\|\nabla u_{\delta}\right\|_{L^{2}(\Omega)}^{2}+\left\|\sqrt{\sigma+\frac{1}{2} \operatorname{div} \mathbf{b}} u_{\delta}\right\|_{L^{2}(\Omega)}^{2} \\
&+\sum_{i=1,2 \atop T_{i, k} \in \mathscr{T}_{i}}\left(L u_{\delta}^{(i)}, \tau_{k} L u_{\delta}^{(i)}\right)_{L^{2}\left(T_{i, k}\right)}+\frac{1}{2} \int_{\Gamma} \mathbf{b} \cdot \mathbf{n}_{\Gamma}\left(\left(u_{\delta}^{(1)}\right)^{2}-\left(u_{\delta}^{(2)}\right)^{2}\right)
\end{aligned}
$$

自$\mathbf{n}_{\Gamma}=\mathbf{n}_{1}=-\mathbf{n}_{2}$在界面上。由于积分的存在，$\frac{1}{2} \int_{\Gamma} \mathbf{b} \cdot \mathbf{n}_{\Gamma}\left(\left(u_{\delta}^{(1)}\right)^{2}-\left(u_{\delta}^{(2)}\right)^{2}\right), a_{\delta}^{(1)}$对于规范$\|\cdot\|_{G L S}$或任何其他离散规范来说，可能无法成为coercive的。为了解决这个问题，在$\left[\mathrm{AAH}^{+} 98\right]$中建议在双线性形式$a_{\delta}^{(1)}$上再添加一个类似DG的稳定项$\Gamma$ 。

!!!!
\tilde{a}_{\Gamma}\left(u_{\delta}, v_{\delta}\right)=\int_{\Gamma}\left(\mathbf{b} \cdot \mathbf{n}_{1}\right)^{-}\left(u_{\delta}^{(2)}-u_{\delta}^{(1)}\right) v_{\delta}^{(1)}+\int_{\Gamma}\left(\mathbf{b} \cdot \mathbf{n}_{2}\right)^{-}\left(u_{\delta}^{(1)}-u_{\delta}^{(2)}\right) v_{\delta}^{(2)}
$$

这里$x^{-}$表示数字$x$的负部分（即$x^{-}=(|x|-x) / 2$）。根据$\Gamma$的符号，将$\left(\mathbf{b} \cdot \mathbf{n}_{i}\right)^{-}$上的每个积分分成两个项，借助于简单的代数运算，我们可以得到

!!!!
\tilde{a}_{\Gamma}\left(u_{\delta}, u_{\delta}\right)=\frac{1}{2} \int_{\Gamma}\left|\mathbf{b} \cdot \mathbf{n}_{\Gamma}\right|\left(u_{\delta}^{(1)}-u_{\delta}^{(2)}\right)^{2}
$$

因此，形式$a_{\delta}^{(1)}\left(u_{\delta}, u_{\delta}\right)+\tilde{a}_{\Gamma}\left(u_{\delta}, u_{\delta}\right)$对于GLS规范\ref{13.77} 是强制性的。

\subsection{Some numerical tests}

我们现在介绍一些使用线性有限元得到的关于以下二维扩散-传输概率的数值解。

!!!!
\left\{\begin{array}{l}
-\mu \Delta u+\mathbf{b} \cdot \nabla u=f \quad \text { in } \Omega=(0,1) \times(0,1) \\
u=g \quad \text { on } \partial \Omega
\end{array}\right.
\label{13.94}\end{equation}

其中$\mathbf{b}=(1,1)^{T}$ 。首先让我们考虑以下恒定数据。  $f \equiv 1$ 和
 ![](https://cdn.mathpix.com/cropped/10058ab4e7f0c5bd6fe5bcd4db204623-355.jpg?height=268&width=722&top_left_y=905&top_left_x=94)

图13.11.用$\mu=10^{-3}, h=1 / 80$对问题\ref{13.94} 进行逼近，使用标准（左）和GLS（右）Galerkin方法。相应的局部贝克莱特数为$\mathbb{P e}=8.84$ 。

$g \equiv 0$ .在这种情况下，解决方案的特点是在边缘附近有一个边界层 $x=1$ 和 $y=1$ 。我们考虑了两个不同的粘度值。  $\mu=10^{-3}$ 和 $\mu=10^{-5}$ 。对于这两个问题，我们分别比较了使用标准Galerkin方法和GLS Galerkin方法得到的解，分别对统一离散化步骤$h: 1 / 20$和$1 / 80$做了两种不同的选择。在GLS情况下，我们使用$\tau_{K}$的值\ref{13.61} 。对$\mu$和$h$这两个值的组合产生了四个不同的局部佩克莱特数的值。通过分析图13.11-13.14（考虑到不同的垂直尺度）可以看出，对于不断增加的贝氏数，标准Galerkin方法提供的解决方案表示出越来越强的波动。后者最终完全克服了数值解（见图13.14）。另一方面，GLS方法能够提供一个可接受的数值解，甚至对于极高的$\mathbb{P e}$值（尽管它在$(1,1)$点出现了过冲）。

现在让我们选择强制项$f$和边界数据$g$的方式，以便

!!!!
u(x, y)=x+y(1-x)+\frac{\mathrm{e}^{-1 / \mu}-\mathrm{e}^{-(1-x)(1-y) / \mu}}{1-\mathrm{e}^{-1 / \mu}}
$$

是精确解（例如，见[HSS02]）。相应的贝克莱特数是 $\mathbb{P} e_{g l}=$ $(\sqrt{2} \mu)^{-1}$ 。对于小的粘度值$\mu$，这个解决方案在边缘附近有一个边界层$x=1$和$y=1$。在下文中，我们考虑两个不同的粘度值。  $\mu=10^{-1}$ 和 $\mu=10^{-9}$ 。数值近似是基于分片线性有限元 $(r=1)$ 。我们比较了使用标准Galerkin方法、SUPG方法和DG方法\ref{13.92} （与$\sigma=1$和$\gamma=10 r^{2}$）在变体DG-N下得到的数值解\ref{12.7}，其中边界条件是用Nitsche惩罚技术施加的[Nit71] 。在图13.5和$13.6$中，我们绘制了使用非结构化三角形网格的数值解，其网格大小为$h \approx 1 / 8$ 。图13.17-13.18显示了在更细的网格$h \approx 1 / 16$上获得的类似结果；它们表明，对于小贝氏（全局）数，三种不同的方法产生了非常相似的解。对于大Péclet数，图13.16 $13.18$（注意不同的垂直比例）显示，Galerkin的解决方案
 ![](https://cdn.mathpix.com/cropped/71627ab35978b0d0d1f5970ad976ca1f-01.jpg?height=210&width=718&top_left_y=963&top_left_x=98)

图13.12.用$\mu=10^{-3}, h=1 / 20$对问题\ref{13.94} 进行逼近，使用标准（左）和GLS（右）Galerkin方法。相应的局部贝克莱特数为$\mathbb{P e}=35.35$ 。
 ![](https://cdn.mathpix.com/cropped/71627ab35978b0d0d1f5970ad976ca1f-02.jpg?height=278&width=726&top_left_y=110&top_left_x=95)

图13.13.用$\mu=10^{-5}, h=1 / 80$对问题\ref{13.94} 进行逼近，使用标准（左）和GLS（右）Galerkin方法。相应的局部贝克莱特数为$\mathbb{P e}=883.88$ 。

![](https://cdn.mathpix.com/cropped/71627ab35978b0d0d1f5970ad976ca1f-02.jpg?height=258&width=358&top_left_y=527&top_left_x=98)
 ![](https://cdn.mathpix.com/cropped/71627ab35978b0d0d1f5970ad976ca1f-02.jpg?height=258&width=718&top_left_y=527&top_left_x=98) (left) and GLS (right) Galerkin method. The corresponding local Péclet number is $\mathbb{P e}=3535.5

方法表现出非常明显的虚假振荡。相反，SUPG提供了可接受的解决方案，尽管它们受到与点$(1,1)$相对应的过冲的影响。

由于对边界条件的直接（基本）处理，DG方法在那些与外流边界相交的元素上表现出振荡。最后，由于对边界条件的弱处理，DG-N的解既没有振荡也没有过冲。然而，通过这种（Nitsche）方法，边界长解不能被正确地近似。

最后，我们考虑一个纯粹的运输问题，即$\mathbf{b} \cdot \nabla u=f$中的$\Omega=(0,1)^{2}$与$u=g \mathrm{su} \Gamma^{-}, \mathbf{b}=(1,1)$，$f$和$g$的选择方式使精确解成为$u(x, y)=1+\sin \left(\pi(x+1)(y+1)^{2} / 8\right)$。

我们在网格大小为 $r=1,2,3$ 的均匀三角形网格序列上，用度数为 $h$ 的分片多项式的DG方法解决这个问题。DG

![](https://cdn.mathpix.com/cropped/71627ab35978b0d0d1f5970ad976ca1f-03.jpg?height=165&width=255&top_left_y=145&top_left_x=196)

![](https://cdn.mathpix.com/cropped/71627ab35978b0d0d1f5970ad976ca1f-03.jpg?height=163&width=259&top_left_y=146&top_left_x=459)

(a) 标准Galerkin方法

![](https://cdn.mathpix.com/cropped/71627ab35978b0d0d1f5970ad976ca1f-03.jpg?height=167&width=254&top_left_y=364&top_left_x=195)

(c) DG法 (b) SUPG法

![](https://cdn.mathpix.com/cropped/71627ab35978b0d0d1f5970ad976ca1f-03.jpg?height=161&width=258&top_left_y=367&top_left_x=460)

(d) DG方法的DG-N变体

图13.15.分别用Galerkin方法、SUPG方法、DG方法\ref{13.92} （含$\sigma=1$和$\gamma=10 r^{2}$）和弱加边界条件的DG-N变体得到问题\ref{13.94} 的近似解。使用$h \approx 1 / 8$和片状线性有限元$(r=1)$的三角网格

![](https://cdn.mathpix.com/cropped/71627ab35978b0d0d1f5970ad976ca1f-03.jpg?height=190&width=254&top_left_y=651&top_left_x=200)

(a) 标准Galerkin方法

![](https://cdn.mathpix.com/cropped/71627ab35978b0d0d1f5970ad976ca1f-03.jpg?height=195&width=251&top_left_y=875&top_left_x=196)

(c) DG法

![](https://cdn.mathpix.com/cropped/71627ab35978b0d0d1f5970ad976ca1f-03.jpg?height=190&width=255&top_left_y=652&top_left_x=463)

(b) SUPG方法

![](https://cdn.mathpix.com/cropped/71627ab35978b0d0d1f5970ad976ca1f-03.jpg?height=195&width=258&top_left_y=875&top_left_x=460)

(d) DG方法的DG-N变体

图13.16.分别用Galerkin方法、SUPG方法、DG方法\ref{13.92} （含$\sigma=1$和$\gamma=10 r^{2}$）和弱加边界条件的DG-N变体得到问题\ref{13.94} 的近似解。使用$h \approx 1 / 8$和片状线性有限元$(r=1)$的三角网格

![](https://cdn.mathpix.com/cropped/71627ab35978b0d0d1f5970ad976ca1f-04.jpg?height=162&width=252&top_left_y=147&top_left_x=196)

![](https://cdn.mathpix.com/cropped/71627ab35978b0d0d1f5970ad976ca1f-04.jpg?height=163&width=260&top_left_y=146&top_left_x=459)

(a) 标准Galerkin方法

![](https://cdn.mathpix.com/cropped/71627ab35978b0d0d1f5970ad976ca1f-04.jpg?height=168&width=257&top_left_y=363&top_left_x=195)

(c) DG法 (b) SUPG法

![](https://cdn.mathpix.com/cropped/71627ab35978b0d0d1f5970ad976ca1f-04.jpg?height=164&width=259&top_left_y=365&top_left_x=459)

(d) DG方法的DG-N变体

图13.17.分别由Galerkin方法、SUPG方法、DG方法\ref{13.92} （含$\sigma=1$和$\gamma=10 r^{2}$）和弱加边界条件的DG-N变体得到的$\mu=10^{-1}$的问题\ref{13.94} 的近似解。三角形网格与$h \approx 1 / 16$。

![](https://cdn.mathpix.com/cropped/71627ab35978b0d0d1f5970ad976ca1f-04.jpg?height=189&width=251&top_left_y=647&top_left_x=200)

(a) 标准Galerkin方法

![](https://cdn.mathpix.com/cropped/71627ab35978b0d0d1f5970ad976ca1f-04.jpg?height=206&width=256&top_left_y=861&top_left_x=193)

(c) DG法和片状线性有限元$(r=1)

![](https://cdn.mathpix.com/cropped/71627ab35978b0d0d1f5970ad976ca1f-04.jpg?height=189&width=254&top_left_y=647&top_left_x=462)

(b) SUPG方法

![](https://cdn.mathpix.com/cropped/71627ab35978b0d0d1f5970ad976ca1f-04.jpg?height=200&width=258&top_left_y=865&top_left_x=460)

(d) DG方法的DG-N变体

图13.18.分别由Galerkin方法、SUPG方法、DG方法\ref{13.92} （含$\sigma=1$和$\gamma=10 r^{2}$）和弱加边界条件的DG-N变体得到的问题\ref{13.94} 的近似解。三角网格与$h \approx 1 / 16$和片状线性有限元$(r=1)$。

![](https://cdn.mathpix.com/cropped/71627ab35978b0d0d1f5970ad976ca1f-05.jpg?height=342&width=430&top_left_y=94&top_left_x=240)

图13.19.程度为$r=1,2,3,4$的有限元的逼近误差与自由度数的关系

方法提供了以下误差估计（例如，见[BMS04]）。

!!!!
\left\|u-u_{h}\right\|=\left(\left\|u-u_{h}\right\|_{L^{2}(\Omega)}^{2}+\sum_{e \in \mathscr{E}_{h}}\left\|s_{e}^{1 / 2}\left[u-u_{h}\right]\right\|_{0, e}^{2}\right)^{1 / 2} \leq C h^{r+1 / 2}\|u\|_{H^{r+1}(\Omega)}
\label{13.95}\end{equation}

\ref{13.95}

其中$s_{e}=\alpha\left|\mathbf{b} \cdot \mathbf{n}_{\mathbf{e}}\right|$是一个合适的稳定项，其中$\alpha$是一个独立于$h$的正常数，$e . \mathscr{E}_{h}$是三角形的所有边的集合，$C$是一个正常数。在图$13.19$中，我们报告了（以对数尺度）在能量准则\ref{13.95} 中计算的误差：衰减为$h^{r+1 / 2}$ ，如误差估计\ref{13.95} 所预测。
 ![](https://cdn.mathpix.com/cropped/71627ab35978b0d0d1f5970ad976ca1f-05.jpg?height=246&width=710&top_left_y=870&top_left_x=100)

图13.20.在网格大小为$h=1 / 4$（左）和$h=1 / 8$（右$)$）的均匀网格上获得的有限元解决方案

\subsection{An example of goal-oriented grid adaptivity}

正如在备注4.10中预计的那样，在第4.10节中提出的用于控制一个合适的误差函数的后验分析，可以通过假设适当地重新定义局部残差\ref{4.98}和局部残差\ref{4.98}来扩展到各种微分问题。  $4.6 .5$中提出的用于控制误差的合适函数的事后分析，可以通过假设对局部残差\ref{4.98}和广义跳跃\ref{4.94}的合适的重新定义，扩展到各种微分问题。在处理具有显性输运的扩散-输运问题时，网格调整被证明是特别有用的。在这里，网格三角形的准确位置，例如在（内部或边界）层，可以大大减少计算成本。

让我们考虑问题\ref{13.1} ，$\mu=10^{-3}, \mathbf{b}=(y,-x)^{T}, \sigma$和$f$相同为空，$\Omega$与$L$形域（图13.21）$(0,4)^{2} \backslash(0,2)^{2}$相吻合。我们假设在$\{x=4\}$和$\{y=0\}$上设置一个同质的诺伊曼条件，在$\{x=0\}$上设置一个非同质的迪里希特条件$(u=1)$，在边界的其余部分设置一个同质的迪里希特条件。因此，\ref{13.1}的解$u$的特点是具有圆形的两个内部层。为了测试适应性网格对函数$J$的具体选择的敏感性，让我们考虑以下两个选项。

!!!!
J(v)=J_{1}(v)=\int_{\Gamma_{1}} \mathbf{b} \cdot \mathbf{n} v d s, \quad \text { with } \quad \Gamma_{1}=\{x=4\} \cup\{y=0\}
$$

用于控制通过$\{x=4\}$和$\{y=0\}$流出的正常流量，以及

!!!!
J(v)=J_{2}(v)=\int_{\Gamma_{2}} \mathbf{b} \cdot \mathbf{n} v d s, \quad \text { with } \quad \Gamma_{2}=\{x=4\}
$$

如果我们仍然对控制流动感兴趣，但只是通过$\{x=4\}$ 。从1024个元素的准均匀初始网格开始，我们在图$13.21$中显示了选择$J=J_{1}$（左）和$J=J_{2}$（右），在适应过程的第四次和第二次迭代时得到的（各向异性的）网格。两个边界层都负责通过$\Gamma_{1}$的流动，事实上，网格被细化为两个层的对应关系。然而，只有上层被 "识别 "为沿$\Gamma_{2}$流动的信息。最后，注意图中网格的强烈各向异性。为了不仅遵循细化，而且遵循网格的正确方向，三角形是以这样的方式实现的，即遵循解决方案的方向属性（边界层）。进一步的细节，请参考 [FMP04] 。

\subsection{Exercises}

1.将一维扩散-传输-反应算子的对称和偏斜对称部分进行分解

!!!!
L u=-\mu u^{\prime \prime}+b u^{\prime}+\sigma u
$$


![](https://cdn.mathpix.com/cropped/71627ab35978b0d0d1f5970ad976ca1f-07.jpg?height=330&width=696&top_left_y=118&top_left_x=106)

图13.21.功能$J_{1}$的第四个适应性网格（左）；功能$J_{2}$的第二个适应性网格（右）。

2.将以非发散形式书写的扩散-传输算子拆分为对称和偏斜对称部分

!!!!
L u=-\mu \Delta u+\mathbf{b} \cdot \nabla u
$$

3.证明在参考区间$[0,1]$内，一维线性、二次和三次有限元产生以下通过质量堆积技术得到的浓缩矩阵。

!!!!
\begin{array}{ll}
r=1 \quad & \mathbf{M}_{L}=\widehat{\mathbf{M}}=\frac{1}{2} \operatorname{diag}(11) \\
r=2 \quad \mathbf{M}_{L}=\widehat{\mathbf{M}}=\frac{1}{6} \operatorname{diag}(141) \\
r=3 & \left\{\begin{array}{l}
\mathrm{M}_{L}=\frac{1}{8} \operatorname{diag}(1331) \\
\widehat{\mathrm{M}}=\frac{1}{1552} \operatorname{diag}(128648648128)=\operatorname{diag}\left(\frac{8}{97}, \frac{81}{194}, \frac{81}{194}, \frac{8}{97}\right)
\end{array}\right.
\end{array}
$$

4.考虑问题

!!!!
\left\{\begin{array}{lr}
-\varepsilon u^{\prime \prime}(x)+b u^{\prime}(x)=1, & 0<x<1 \\
u(0)=\alpha, & u(1)=\beta
\end{array}\right.
$$

其中$\varepsilon>0$和$\alpha, \beta, b \in \mathbb{R}$已经给出。找出它的有限元公式与上风的人工粘性。讨论其稳定性和收敛性，并与Galerkin-线性有限元公式进行比较。

5.考虑问题

!!!!
\left\{\begin{array}{l}
-\varepsilon u^{\prime \prime}(x)+u^{\prime}(x)=1, \quad 0<x<1 \\
u(0)=0, \quad u^{\prime}(1)=1
\end{array}\right.
$$

与$\varepsilon>0$给出。写出它的弱表述和它的Galerkinfinite element类型的近似。验证该方案是否稳定并解释原因。

6.考虑问题

!!!!
\begin{cases}-\operatorname{div}(\mu \nabla u)+\operatorname{div}(\boldsymbol{\beta} u)+\sigma u=f & \text { in } \Omega \\ -\gamma \cdot \mathbf{n}+\mu \nabla u \cdot \mathbf{n}=0 & \text { on } \Gamma_{N} \\ u=0 & & \text { on } \Gamma_{D}\end{cases}
$$

其中$\Omega$是$\mathbb{R}^{2}$的一个开放子集，边界$\Gamma=\Gamma_{D} \cup \Gamma_{N}, \stackrel{\circ}{\Gamma} \cap \stackrel{\circ}{\Gamma}_{N}=\emptyset, \mathbf{n}$是$\Gamma, \mu=\mu(\mathbf{x})>\mu_{0}>0, \sigma=\sigma(\mathbf{x})>0, f=f(\mathbf{x})$的外向法线，是给定的标量函数，$\boldsymbol{\beta}=\boldsymbol{\beta}(\mathbf{x}), \gamma=\gamma(\mathbf{x})$是给定的向量函数。

用Galerkin-线性有限元方法对其进行近似。找出在哪些关于系数$\mu, \sigma$和$\beta$的假设下，该方法是不准确的，并提出不同情况下的相关补救措施。

7.考虑一维扩散-运输问题

!!!!
\left\{\begin{array}{l}
-\left(\mu u^{\prime}-\psi^{\prime} u\right)^{\prime}=1, \quad 0<x<1 \\
u(0)=u(1)=0
\end{array}\right.
\label{13.96}\end{equation}

其中$\mu$是一个正常数，$\psi$是一个给定函数。

a) 通过对函数$\psi$引入合适的假设，研究问题\ref{13.96} 的存在性和唯一性，并提出一个稳定的有限元数值近似。

b) 考虑变量变化$u=\rho e^{\psi / \mu}, \rho$是一个辅助的未知函数。研究问题\ref{13.96}的弱解在新的未知数$\rho$中的存在性和唯一性，并使用有限元方法提供其数值近似。

c) 比较(a)和(b)中的两种方法，包括从抽象的角度和数字的角度。

8.考虑扩散-传输-反应问题

!!!!
\begin{cases}-\Delta u+\operatorname{div}(\mathbf{b} u)+u=0 & \text { in } \Omega \subset \mathbb{R}^{2} \\ u=\varphi \quad \text { on } \Gamma_{D}, \quad \frac{\partial u}{\partial n}=0 & \text { on } \Gamma_{N}\end{cases}
$$

其中$\Omega$是一个开放的有界域，$\partial \Omega=\Gamma_{D} \cup \Gamma_{N}, \Gamma_{D} \neq \emptyset

通过对数据$\mathbf{b}=\left(b_{1}(\mathbf{x}), b_{2}(\mathbf{x})\right)^{T}(\mathbf{x} \in \Omega)$和$\varphi=\varphi(\mathbf{x})\left(\mathbf{x} \in \Gamma_{D}\right)$做适当的正则性假设，证明解的存在和唯一性。在$|\mathbf{b}| \gg 1$的情况下，用人工扩散有限元和SUPG-有限元方法对问题进行近似，讨论与Galerkin有限元方法相比的优缺点。9.9. 考虑问题

!!!!
-\sum_{i, j=1}^{2} \frac{\partial^{2} u}{\partial x_{i} \partial x_{j}}+\beta \frac{\partial^{2} u}{\partial x_{1}^{2}}+\gamma \frac{\partial^{2} u}{\partial x_{1} \partial x_{2}}+\delta \frac{\partial^{2} u}{\partial x_{2}^{2}}+\eta \frac{\partial u}{\partial x_{1}}=f \text { in } \Omega
$$

与$u=0$对$\partial \Omega$，其中$\beta, \gamma, \delta, \eta$是给定系数，$f$是$\mathbf{x}=\left(x_{1}, x_{2}\right) \in \Omega$的给定函数

a) 找到确保弱解存在和唯一性的数据条件。

b) 使用Galerkin有限元方法提供一个近似值并分析其收敛性。

c) 在数据的哪些条件下，Galerkin问题是对称的？

在这种情况下，提供合适的方法来解决相关的代数问题。

\section{Finite differences for hyperbolic equations}

在本章中，我们处理的是双曲型的时间依赖问题。关于它们的起源和深入的分析，见[Sal08，第4章]。我们将只考虑使用有限差分法进行数值逼近，这是历史上第一个应用于这类方程的方法。为了简单地介绍该理论的基本概念，我们的大部分介绍将涉及取决于单一空间变量的问题。有限元逼近将在第15章讨论，对非线性问题的扩展将在第$16$章讨论。

\subsection{A scalar transport problem}

让我们考虑以下标量双曲问题

!!!!
\begin{cases}\frac{\partial u}{\partial t}+a \frac{\partial u}{\partial x}=0, & x \in \mathbb{R}, t>0 \\ u(x, 0)=u_{0}(x), & x \in \mathbb{R}\end{cases}
\label{14.1}\end{equation}

其中$a \in \mathbb{R} \backslash\{0\}$ 。这个问题的解决方案是一个以速度$a$，在$(x, t)$平面内移动的波，由以下公式给出

!!!!
u(x, t)=u_{0}(x-a t), \quad t \geq 0
$$

我们考虑平面$x(t)$中的曲线$(x, t)$，以下常微分方程的解

!!!!
\left\{\begin{array}{l}
\frac{d x}{d t}=a, \quad t>0 \\
x(0)=x_{0}
\end{array}\right.
$$

对于不同的$x_{0} \in \mathbb{R}$的值。它们读作$x(t)=x_{0}+a t$，被称为特征线（通常简称特征）。\ref{14.1}的解沿着这些线保持不变，对于

!!!!
\frac{d u}{d t}=\frac{\partial u}{\partial t}+\frac{\partial u}{\partial x} \frac{d x}{d t}=0
$$

就更普遍的问题而言

!!!!
\begin{cases}\frac{\partial u}{\partial t}+a \frac{\partial u}{\partial x}+a_{0} u=f, & x \in \mathbb{R}, \quad t>0 \\ u(x, 0)=u_{0}(x), & x \in \mathbb{R}\end{cases}
\label{14.2}\end{equation}

其中$a, a_{0}$和$f$是$(x, t)$的给定函数，特征线$x(t)$是Cauchy问题的解

!!!!
\left\{\begin{array}{l}
\frac{d x}{d t}=a(x, t), \quad t>0 \\
x(0)=x_{0}
\end{array}\right.
$$

在这种情况下，\ref{14.2}的解满足以下关系

!!!!
\frac{d}{d t} u(x(t), t)=f(x(t), t)-a_{0}(x(t), t) u(x(t), t)
$$

因此有可能通过解决每条特征曲线上的常微分方程来提取解决方案$u$（这种方法导致了所谓的特征方法）。

例如，如果$a_{0}=0$，我们发现

!!!!
u(x, t)=u_{0}(x-a t)+\int_{0}^{t} f(x-a(t-s), s) d s, \quad t>0
$$

现在让我们考虑有界区间内的问题\ref{14.1} 。例如，让我们假设$x \in[0,1]$和$a>0$ 。由于$u$在特征上是常数，从图$14.1$中我们推断出，解在某一点$\mathrm{P}$的值与从P出来的特征脚$P_{0}$的值重合。 相反，从$\mathrm{Q}$出来的特征

![](https://cdn.mathpix.com/cropped/71627ab35978b0d0d1f5970ad976ca1f-11.jpg?height=244&width=255&top_left_y=954&top_left_x=326)

图14.1.从$P$和$Q$发出的特征线（此处为直线）与直线$x=0$相交的例子为$t>0$ 。因此，点$x=0$是一个流入点，我们必须在这个点上指定$u$的值。请注意，如果 $a<0$ ，流入点将是 $x=1$ 。

参照问题\ref{14.1} ，我们可以看到，如果$u_{0}$在$x_{0}$处是一个不连续的函数，那么这种不连续将沿着从$x_{0}$发出的特征传播（这个过程可以通过引入双曲问题的弱解概念从数学的角度严格地正式化）。为了使不连续性正规化，可以用一连串的正规函数$u_{0}$来近似初始基准$u_{0}^{\varepsilon}(x), \varepsilon>0$ 。然而，这个程序只有在双曲问题是线性的情况下才有效。非线性双曲问题的解确实也会对有规律的初始数据产生不连续（我们将在第16章看到）。在这种情况下，策略（这也启发了数值方法）是对微分方程本身而不是初始数据进行规范化。我们可以考虑以下扩散-传输方程

!!!!
\frac{\partial u^{\varepsilon}}{\partial t}+a \frac{\partial u^{\varepsilon}}{\partial x}=\varepsilon \frac{\partial^{2} u^{\varepsilon}}{\partial x^{2}}, \quad x \in \mathbb{R}, t>0
$$

对于$\varepsilon>0$的小值，可以看作是方程\ref{14.1} 的抛物线正则化。如果我们设定$u^{\varepsilon}(x, 0)=u_{0}(x)$，我们可以证明

!!!!
\lim _{\varepsilon \rightarrow 0^{+}} u^{\varepsilon}(x, t)=u_{0}(x-a t), t>0, x \in \mathbb{R}
$$

\subsubsection{An a priori estimate}

现在让我们回到有界区间上的传输反应问题\ref{14.2} 。

!!!!
\begin{cases}\frac{\partial u}{\partial t}+a \frac{\partial u}{\partial x}+a_{0} u=f, & x \in(\alpha, \beta), t>0 \\ u(x, 0)=u_{0}(x), & x \in[\alpha, \beta] \\ u(\alpha, t)=\varphi(t), & t>0\end{cases}
\label{14.3}\end{equation}

其中$a(x), f(x, t)$和$\varphi(t)$是指定的函数；我们假设$a(x)>0$，所以$x=\alpha$是流入点（施加边界条件），而$x=\beta$是流出点。

将\ref{14.3} 的第一个方程乘以$u$，在$x$中进行积分，并使用部分积分的公式，我们得到每个$t>0$。

!!!!
\frac{1}{2} \frac{d}{d t} \int_{\alpha}^{\beta} u^{2} d x+\int_{\alpha}^{\beta}\left(a_{0}-\frac{1}{2} a_{x}\right) u^{2} d x+\frac{1}{2}\left(a u^{2}\right)(\beta)-\frac{1}{2}\left(a u^{2}\right)(\alpha)=\int_{\alpha}^{\beta} f u d x
$$

假设存在一个$\mu_{0} \geq 0$，使得

!!!!
a_{0}-\frac{1}{2} a_{x} \geq \mu_{0} \quad \forall x \in[\alpha, \beta]
$$

我们发现

!!!!
\frac{1}{2} \frac{d}{d t}\|u(t)\|_{\mathrm{L}^{2}(\alpha, \beta)}^{2}+\mu_{0}\|u(t)\|_{\mathrm{L}^{2}(\alpha, \beta)}^{2}+\frac{1}{2}\left(a u^{2}\right)(\beta) \leq \int_{\alpha}^{\beta} f u d x+\frac{1}{2} a(\alpha) \varphi^{2}(t)
$$

如果$f$和$\varphi$同为零，则

!!!!
\|u(t)\|_{L^{2}(\alpha, \beta)} \leq\left\|u_{0}\right\|_{L^{2}(\alpha, \beta)} \quad \forall t>0 .
$$

在更一般的问题\ref{14.2} 的情况下，如果我们假设$\mu_{0}>0$，由于考奇-施瓦茨和杨氏不等式，我们有

!!!!
\int_{\alpha}^{\beta} f u d x \leq\|f\|_{\mathrm{L}^{2}(\alpha, \beta)}\|u\|_{\mathrm{L}^{2}(\alpha, \beta)} \leq \frac{\mu_{0}}{2}\|u\|_{\mathrm{L}^{2}(\alpha, \beta)}^{2}+\frac{1}{2 \mu_{0}}\|f\|_{\mathrm{L}^{2}(\alpha, \beta)}^{2}
$$

通过对时间的整合，我们得到以下先验估计

!!!!
\begin{aligned}
&\|u(t)\|_{\mathrm{L}^{2}(\alpha, \beta)}^{2}+\mu_{0} \int_{0}^{t}\|u(s)\|_{\mathrm{L}^{2}(\alpha, \beta)}^{2} d s+a(\beta) \int_{0}^{t} u^{2}(\beta, s) d s \\
&\leq\left\|u_{0}\right\|_{\mathrm{L}^{2}(\alpha, \beta)}^{2}+a(\alpha) \int_{0}^{t} \varphi^{2}(s) d s+\frac{1}{\mu_{0}} \int_{0}^{t}\|f\|_{\mathrm{L}^{2}(\alpha, \beta)}^{2} d s
\end{aligned}
$$

另一个估计不需要$a(x)$的可微性，而是使用$a_{0} \leq a(x) \leq a_{1}$为两个合适的正常数$a_{0}$和$a_{1}$的假设，可以通过将方程乘以$a^{-1}$得到。

!!!!
a^{-1} \frac{\partial u}{\partial t}+\frac{\partial u}{\partial x}=a^{-1} f
$$

通过乘以$u$并在$\alpha$和$\beta$之间进行积分，我们得到。

!!!!
\frac{1}{2} \frac{d}{d t} \int_{\alpha}^{\beta} a^{-1}(x) u^{2}(x, t) d x+\frac{1}{2} u^{2}(\beta, t)=\int_{\alpha}^{\beta} a^{-1}(x) f(x, t) u(x, t) d x+\frac{1}{2} \varphi^{2}(t)
$$

如果$f=0$我们立即得到

!!!!
\|u(t)\|_{a}^{2}+\int_{0}^{t} u^{2}(\beta, s) d s=\left\|u_{0}\right\|_{a}^{2}+\int_{0}^{t} \varphi^{2}(s) d s, t>0
$$

我们已经定义了

!!!!
\|v\|_{a}=\left(\int_{\alpha}^{\beta} a^{-1}(x) v^{2}(x) d x\right)^{\frac{1}{2}}
$$

由于$a^{-1}$的下限和上限，后者等同于$\mathrm{L}^{2}(\alpha, \beta)$的规范。另一方面，如果$f \neq 0$，我们可以进行如下操作

!!!!
\|u(t)\|_{a}^{2}+\int_{0}^{t} u^{2}(\beta, s) d s \leq\left\|u_{0}\right\|_{a}^{2}+\int_{0}^{t} \varphi^{2}(s) d s+\int_{0}^{t}\|f\|_{a}^{2} d s+\int_{0}^{t}\|u(s)\|_{a}^{2} d s
$$

使用了考奇-施瓦茨不等式。

现在应用Gronwall的定理（见定理2.2），我们得到，对于每个$t>0$ 。

!!!!
\|u(t)\|_{a}^{2}+\int_{0}^{t} u^{2}(\beta, s) d s \leq e^{t}\left(\left\|u_{0}\right\|_{a}^{2}+\int_{0}^{t} \varphi^{2}(s) d s+\int_{0}^{t}\|f\|_{a}^{2} d s\right)
\label{14.4}\end{equation}

\subsection{Systems of linear hyperbolic equations}

让我们考虑一个线性系统，其形式为

!!!!
\begin{cases}\frac{\partial \mathbf{u}}{\partial t}+\mathrm{A} \frac{\partial \mathbf{u}}{\partial x}=\mathbf{0}, & x \in \mathbb{R}, t>0 \\ \mathbf{u}(0, x)=\mathbf{u}_{0}(x), & x \in \mathbb{R}\end{cases}
\label{14.5}\end{equation}


其中$\mathbf{u}:[0, \infty) \times \mathbb{R} \rightarrow \mathbb{R}^{p}, \mathrm{~A}: \mathbb{R} \rightarrow \mathbb{R}^{p \times p}$是一个给定的矩阵，$\mathbf{u}_{0}: \mathbb{R} \rightarrow \mathbb{R}^{p}$是初始基准点。

我们首先考虑$A$的系数为常数的情况（即与$x$和$t$无关）。如果A可以被对角化并且有实数特征值，则系统\ref{14.5} 被称为双曲，即

!!!!
\mathrm{A}=\mathrm{T} \Lambda \mathrm{T}^{-1}
$$

这里$\Lambda=\operatorname{diag}\left(\lambda_{1}, \ldots, \lambda_{p}\right)$，用$\lambda_{i} \in \mathbb{R}$表示$i=1, \ldots, p$，是$\mathrm{A}, \mathrm{T}: \mathbb{R} \rightarrow \mathbb{R}^{p \times p}, \mathrm{~T}=\left[\omega^{1}, \omega^{2}, \ldots, \boldsymbol{\omega}^{p}\right]$的特征值的对角线矩阵，是其列向量为$\mathrm{A}$的右向量的矩阵，即

!!!!
\mathrm{A\omega}^{k}=\lambda_{k} \boldsymbol{\omega}^{k}, \quad k=1, \ldots, p
$$

通过这种相似性转换，系统\ref{14.5} 变为

!!!!
\frac{\partial \mathbf{w}}{\partial t}+\Lambda \frac{\partial \mathbf{w}}{\partial x}=\mathbf{0}
\label{14.6}\end{equation}

其中$\mathbf{w}=\mathrm{T}^{-1} \mathbf{u}$被称为特征变量。这样，我们得到$p$形式的独立方程

!!!!
\frac{\partial w_{k}}{\partial t}+\lambda_{k} \frac{\partial w_{k}}{\partial x}=0, \quad k=1, \ldots, p
$$

与问题\ref{14.1} 的方程完全相似（只要我们假设$a_{0}$和$f$为空）。因此，解$w_{k}$沿着每条特征曲线$x=x(t)$是常数，是考奇问题的解

!!!!
\left\{\begin{array}{l}
\frac{d x}{d t}=\lambda_{k}, \quad t>0 \\
x(0)=x_{0} .
\end{array}\right.
\label{14.7}\end{equation}

由于$\lambda_{k}$是常数，特征曲线实际上是直线$x(t)=x_{0}+!!!!\lambda_{k} t$，解读为$w_{k}(x, t)=\psi_{k}\left(x-\lambda_{k} t\right)$ ，其中$\psi_{k}$是由初始条件决定的单变量函数。在问题\ref{14.5} 的情况下，我们有$\psi_{k}(x)=w_{k}(x, 0)$，因此解$\mathbf{u}=\mathrm{T} \mathbf{w}$的形式为

!!!!
\mathbf{u}(x, t)=\sum_{k=1}^{p} w_{k}\left(x-\lambda_{k} t, 0\right) \omega^{k}
$$

后者是由$p$行进的、非交互式的波组成。

由于严格双曲系统承认$p$从平面$(x, t), u(\bar{x}, \bar{t})$的每一点$(\bar{x}, \bar{t})$发出的不同特征线将只取决于点$\bar{x}-\lambda_{k} \bar{t}$的初始基准，对于$k=1, \ldots, p$。由于这个原因，代表从$(\bar{x}, \bar{t})$出来的特征脚的$p$点的集合，即

!!!!
D(\bar{x}, \bar{t})=\left\{x \in \mathbb{R} \mid x=\bar{x}-\lambda_{k} \bar{t}, k=1, \ldots, p\right\}
\label{14.8}\end{equation}

被称为解$\mathbf{u}$在点$(\bar{x}, \bar{t})$的依赖域。

如果我们考虑一个有界区间$(\alpha, \beta)$而不是整个实线，$\lambda_{k}, k=1, \ldots, p$的符号，表示每个特征变量的流入点。在有界区间上的问题集的情况下，函数$\psi_{k}$不仅由初始条件决定，而且由每个特征变量的流入点的边界条件决定。在考虑了一个点$(\bar{x}, \bar{t})$与$\bar{x} \in(\alpha, \beta)$和$\bar{t}>0$之后，如果$\bar{x}-\lambda_{k} \bar{t} \in(\alpha, \beta)$，那么$w_{k}(\bar{x}, \bar{t})$就由初始条件决定，在

![](https://cdn.mathpix.com/cropped/71627ab35978b0d0d1f5970ad976ca1f-15.jpg?height=247&width=651&top_left_y=905&top_left_x=129)

图14.2.平面$w_{k}$中某一点的$(x, t)$的值取决于边界条件或初始条件，取决于$x-\lambda_{k} t$的值。$\lambda_{k}$的两个符号，正的（右）和负的（左），都显示出特别我们有$w_{k}(\bar{x}, \bar{t})=w_{k}\left(\bar{x}-\lambda_{k} \bar{t}, 0\right)$ 。反之，如果$\bar{x}-\lambda_{k} \bar{t} \notin(\alpha, \beta)$，那么$w_{k}(\bar{x}, \bar{t})$的值将取决于边界条件（见图14.2）。

!!!!
\begin{aligned}
&\text { if } \lambda_{k}>0, w_{k}(\bar{x}, \bar{t})=w_{k}\left(\alpha, \bar{t}-\frac{\bar{x}-\alpha}{\lambda_{k}}\right) \\
&\text { if } \lambda_{k}<0, w_{k}(\bar{x}, \bar{t})=w_{k}\left(\beta, \bar{t}-\frac{\bar{x}-\beta}{\lambda_{k}}\right)
\end{aligned}
$$

因此，正特征值的数量决定了在$x=\alpha$要分配的边界条件的数量，而在$x=\beta$，我们需要分配与负特征值数量相同的条件。

在\ref{14.5} 中矩阵A的系数是$x$和$t$的函数的情况下，我们分别表示为

!!!!
\mathrm{L}=\left[\begin{array}{c}
\mathbf{l}_{1}^{T} \\
\vdots \\
\mathbf{l}_{p}^{T}
\end{array}\right] \quad \text { and } \quad \mathrm{R}=\left[\mathbf{r}_{1} \ldots \mathbf{r}_{p}\right]
$$

包含$\mathrm{A}$的左、右特征向量的矩阵，其元素满足以下关系

!!!!
\mathbf{A} \mathbf{r}_{k}=\lambda_{k} \mathbf{r}_{k}, \quad \mathbf{l}_{k}^{T} \mathbf{A}=\lambda_{k} \mathbf{l}_{k}^{T},
$$

就是说

!!!!
\mathrm{AR}=\mathrm{R} \Lambda, \quad \mathrm{LA}=\Lambda \mathrm{L}
$$

在不丧失一般性的情况下，我们可以假设$\mathrm{LR}=\mathrm{I}$ 。现在我们假设存在一个矢量函数$\mathbf{w}$，它满足以下关系

!!!!
\frac{\partial \mathbf{w}}{\partial \mathbf{u}}=\mathrm{R}^{-1}, \quad \text { that is } \quad \frac{\partial \mathbf{u}_{k}}{\partial \mathbf{w}}=\mathbf{r}_{k}, \quad k=1, \ldots, p
$$

按照我们最初的做法，我们得到

!!!!
\mathrm{R}^{-1} \frac{\partial \mathbf{u}}{\partial t}+\Lambda \mathrm{R}^{-1} \frac{\partial \mathbf{u}}{\partial x}=\mathbf{0}
$$

因此有了新的对角线系统\ref{14.6} 。通过重新引入特征曲线\ref{14.7}（后者将不再是直线，因为特征值$\lambda_{k}$对于$x$和$t$的不同值是不同的），$\mathbf{w}$沿着它们是常数。它的组成部分仍然被称为特征变量；作为$\mathrm{R}^{-1}=\mathrm{L}$（由于归一化关系）我们得到

!!!!
\frac{\partial w_{k}}{\partial \mathbf{u}} \cdot \mathbf{r}_{m}=\mathbf{l}_{k} \cdot \mathbf{r}_{m}=\delta_{k m}, \quad k, m=1, \ldots, p
$$

函数$w_{k}, k=1, \ldots, p$被称为双曲系统的黎曼不变量。

\subsubsection{The wave equation}

让我们考虑以下二阶双曲方程

!!!!
\frac{\partial^{2} u}{\partial t^{2}}-\gamma^{2} \frac{\partial^{2} u}{\partial x^{2}}=f, \quad x \in(\alpha, \beta), \quad t>0
\label{14.9}\end{equation}



!!!!
u(x, 0)=u_{0}(x) \quad \text { and } \quad \frac{\partial u}{\partial t}(x, 0)=v_{0}(x), \quad x \in(\alpha, \beta)
$$

是初始数据，让我们假设，$u$在边界处是完全空的

!!!!
u(\alpha, t)=0 \quad \text { and } \quad u(\beta, t)=0, \quad t>0
\label{14.10}\end{equation}

在这种情况下，$u$可以代表长度为$\beta-\alpha$的振动弹性弦的垂直位移，固定在端点，$\gamma$是一个系数，取决于弦的具体质量和张力。弦线受到一个垂直力的作用，其密度为$f$ 。函数$u_{0}(x)$和$v_{0}(x)$描述了弦线的初始位移和速度。

为了简化符号，我们用$\partial_{t} u$表示导数$\frac{\partial u}{\partial t}$，用$\partial_{x} u$表示导数$\frac{\partial u}{\partial x}$，我们对二次导数使用类似的符号。

现在我们假设$f$为空。从方程\ref{14.9}中我们推导出系统的动能是保留的，即(见练习1)

!!!!
\left\|\partial_{t} u(t)\right\|_{\mathrm{L}^{2}(\alpha, \beta)}^{2}+\gamma^{2}\left\|\partial_{x} u(t)\right\|_{\mathrm{L}^{2}(\alpha, \beta)}^{2}=\left\|v_{0}\right\|_{\mathrm{L}^{2}(\alpha, \beta)}^{2}+\gamma^{2}\left\|\partial_{x} u_{0}\right\|_{\mathrm{L}^{2}(\alpha, \beta)}^{2}
\label{14.11}\end{equation}

随着变量的变化

!!!!
\omega_{1}=\partial_{x} u, \quad \omega_{2}=\partial_{t} u
$$

波浪方程\ref{14.9}成为以下一阶系统

!!!!
\frac{\partial \omega}{\partial t}+\mathrm{A} \frac{\partial \omega}{\partial x}=\mathbf{f}, \quad x \in(\alpha, \beta), \quad t>0
\label{14.12}\end{equation}

其中

!!!!
\boldsymbol{\omega}=\left[\begin{array}{l}
\omega_{1} \\
\omega_{2}
\end{array}\right], \quad \mathrm{A}=\left[\begin{array}{cc}
0 & -1 \\
-\gamma^{2} & 0
\end{array}\right], \quad \mathbf{f}=\left[\begin{array}{l}
0 \\
f
\end{array}\right]
$$

其初始条件为$\omega_{1}(x, 0)=u_{0}^{\prime}(x)$和$\omega_{2}(x, 0)=v_{0}(x)$ 。

由于$\mathrm{A}$的特征值是不同的实数$\pm \gamma$（代表波的传播速率），系统\ref{14.12} 是双曲的。

请注意，同样在这种情况下，规则的解对应于规则的初始数据，而初始数据的不连续将沿着特征线传播 $\frac{d x}{d t}=\pm \gamma$ 。

\subsection{The finite difference method}

为了简单起见，我们现在将考虑问题\ref{14.1} 。为了数值解决后者，我们可以使用基于有限差分法的空间-时间离散化。在这种情况下，半平面$\{t>0\}$被离散化，选择一个时间步长$\Delta t$，一个空间离散化步长$h$，并以下列方式定义网格点$\left(x_{j}, t^{n}\right)$。

!!!!
x_{j}=j h, \quad j \in \mathbb{Z}, \quad t^{n}=n \Delta t, \quad n \in \mathbb{N}
$$



!!!!
\lambda=\Delta t / h
$$

并让我们定义

!!!!
x_{j+1 / 2}=x_{j}+h / 2 \text {. }
$$

我们寻求离散的解决方案$u_{i}^{n}$，它近似于每个$j$和$n$。

双曲初值问题经常使用显式方法进行时间离散。当然，这对$\lambda$的值施加了限制，而隐式方法一般是没有的。任何显式有限差分方法都可以写成以下形式

!!!!
u_{j}^{n+1}=u_{j}^{n}-\lambda\left(H_{j+1 / 2}^{n}-H_{j-1 / 2}^{n}\right)
\label{14.13}\end{equation}

其中$H_{j+1 / 2}^{n}=H\left(u_{j}^{n}, u_{j+1}^{n}\right)$为一个合适的函数$H(\cdot, \cdot)$，称为数值通量。

数字方案\ref{14.13} 基本上是以下考虑的结果。假设$a$是常数，让我们把方程\ref{14.1} 写成守恒形式

!!!!
\frac{\partial u}{\partial t}+\frac{\partial(a u)}{\partial x}=0
$$

$a u$是与该方程相关的$f l u x$。通过空间积分，我们得到

!!!!
\int_{x_{j-1 / 2}}^{x_{j+1 / 2}} \frac{\partial u}{\partial t} d x+[a u]_{x_{j-1 / 2}}^{x_{j+1 / 2}}=0, \quad j \in \mathbb{Z}
$$

就是说

!!!!
\frac{\partial}{\partial t} U_{j}+\frac{(a u)\left(x_{j+\frac{1}{2}}\right)-(a u)\left(x_{j-\frac{1}{2}}\right)}{h}=0, \quad \text { where } \quad U_{j}=h^{-1} \int_{x_{j-\frac{1}{2}}}^{x_{j+\frac{1}{2}}} u(x) d x
$$

方程\ref{14.13} 现在可以解释为一个近似值，其中时间导数使用前向欧拉有限差分方案离散，$U_{j}$被$u_{j}$取代，$H_{j+1 / 2}$是$(a u)\left(x_{j+\frac{1}{2}}\right)$的适当近似。

\subsubsection{Discretization of the scalar equation}

在显式方法方面，数值方法的区别在于如何选择数值通量$H$。特别是，我们引用了以下方法。

\subsection{- 正向/中心欧拉 $(\mathrm{FE} / \mathbf{C})$ }。

!!!!
u_{j}^{n+1}=u_{j}^{n}-\frac{\lambda}{2} a\left(u_{j+1}^{n}-u_{j-1}^{n}\right)
\label{14.14}\end{equation}

的形式\ref{14.13} ，只要我们定义

!!!!
H_{j+1 / 2}=\frac{1}{2} a\left(u_{j+1}+u_{j}\right)
\label{14.15}\end{equation}



- Lax-Friedrichs (LF)

!!!!
u_{j}^{n+1}=\frac{1}{2}\left(u_{j+1}^{n}+u_{j-1}^{n}\right)-\frac{\lambda}{2} a\left(u_{j+1}^{n}-u_{j-1}^{n}\right)
\labei{13.16}
$$

也是\ref{14.13}的形式，有

!!!!
H_{j+1 / 2}=\frac{1}{2}\left[a\left(u_{j+1}+u_{j}\right)-\lambda^{-1}\left(u_{j+1}-u_{j}\right)\right]
\label{14.17}\end{equation}

- Lax-Wendroff (LW)

!!!!
u_{j}^{n+1}=u_{j}^{n}-\frac{\lambda}{2} a\left(u_{j+1}^{n}-u_{j-1}^{n}\right)+\frac{\lambda^{2}}{2} a^{2}\left(u_{j+1}^{n}-2 u_{j}^{n}+u_{j-1}^{n}\right)
\label{14.18}\end{equation}

可以改写为\ref{14.13}的形式，条件是我们取

!!!!
H_{j+1 / 2}=\frac{1}{2}\left[a\left(u_{j+1}+u_{j}\right)-\lambda a^{2}\left(u_{j+1}-u_{j}\right)\right]
$$

- 上风（或正向/偏心欧拉）（U）

!!!!
u_{j}^{n+1}=u_{j}^{n}-\frac{\lambda}{2} a\left(u_{j+1}^{n}-u_{j-1}^{n}\right)+\frac{\lambda}{2}|a|\left(u_{j+1}^{n}-2 u_{j}^{n}+u_{j-1}^{n}\right)
\label{14.20}\end{equation}

对应的形式\ref{14.13} ，只要我们选择

!!!!
H_{j+1 / 2}=\frac{1}{2}\left[a\left(u_{j+1}+u_{j}\right)-|a|\left(u_{j+1}-u_{j}\right)\right]
\label{14.21}\end{equation}

通过用$u_{j-1}^{n}$和$u_{j+1}^{n}$的平均值替换\ref{14.14} 中的节点值$u_{j}^{n}$，可以从FE/C方法中获得$\mathrm{LF}$。

LW方法来自于时间上的泰勒扩展

!!!!
u^{n+1}=u^{n}+\left(\partial_{t} u\right)^{n} \Delta t+\left(\partial_{t t} u\right)^{n} \frac{\Delta t^{2}}{2}+\mathscr{O}\left(\Delta t^{3}\right)
$$

其中$\left(\partial_{t} u\right)^{n}$表示$u$在时间$t^{n}$的偏导数。然后，利用方程\ref{14.1} ，我们用$\partial_{t} u$替换$-a \partial_{x} u$，用$a^{2} \partial_{x x} u$替换$\partial_{t t} u$。忽略余下的$\mathscr{O}\left(\Delta t^{3}\right)$，用居中的有限差分来逼近空间导数，我们得到\ref{14.18} 。最后，$\mathrm{U}$方法是通过用上风有限差分对方程的对流项$a \partial_{x} u$进行离散得到的，如第13章第13.6节所示。

之前介绍的所有方案都是显性的。隐性方法的一个例子是如下。

- 后退/居中的欧拉$(\mathbf{B E} / \mathbf{C})$ 

!!!!
u_{j}^{n+1}+\frac{\lambda}{2} a\left(u_{j+1}^{n+1}-u_{j-1}^{n+1}\right)=u_{j}^{n}
\label{14.22}\end{equation}

当然，隐式方案也可以用类似于\ref{14.13}的一般形式来重写，其中$H^{n}$被$H^{n+1}$所取代。在特定情况下，数值通量将再次由 \ref{14.15} 定义。

公式\ref{14.13} 的优点是它可以很容易地扩展到更一般的双曲问题的情况。

特别是，我们将在第14.3.2节研究线性系统的情况。而对非线性双曲方程的扩展将在第16.2节中考虑。最后，我们指出以下用于近似波浪方程\ref{14.9} 的方案，同样是在$f=0$的情况下。

- Leap-Frog

!!!!
u_{j}^{n+1}-2 u_{j}^{n}+u_{j}^{n-1}=(\gamma \lambda)^{2}\left(u_{j+1}^{n}-2 u_{j}^{n}+u_{j-1}^{n}\right)
\label{14.23}\end{equation}

- Newmark

!!!!
u_{j}^{n+1}-2 u_{j}^{n}+u_{j}^{n-1}=\frac{(\gamma \lambda)^{2}}{4}\left(w_{j}^{n-1}+2 w_{j}^{n}+w_{j}^{n+1}\right)
\label{14.24}\end{equation}

其中$w_{j}^{n}=u_{j+1}^{n}-2 u_{j}^{n}+u_{j-1}^{n}

\subsubsection{Discretization of linear hyperbolic systems}

让我们考虑线性系统\ref{14.5} 。概括\ref{14.13} ，一个有限差分近似的数值方案可以写成以下形式

!!!!
\mathbf{u}_{j}^{n+1}=\mathbf{u}_{j}^{n}-\lambda\left(\mathbf{H}_{j+1 / 2}^{n}-\mathbf{H}_{j-1 / 2}^{n}\right)
$$

其中$\mathbf{u}_{j}^{n}$是近似于$\mathbf{u}\left(x_{j}, t^{n}\right)$的矢量。现在，$\mathbf{H}_{j+1 / 2}$是一个矢量数值通量。它的形式表达可以通过概括标量的情况，用\ref{14.15},\ref{14.17},\ref{14.19},\ref{14.21}中的$a, a^{2}$和$|a|$分别替换为$\mathrm{A}, \mathrm{A}^{2}$和$|\mathrm{A}|$，可以轻松得出，其中

!!!!
|\mathrm{A}|=\mathrm{T}|\Lambda| \mathrm{T}^{-1}
$$

$|\Lambda|=\operatorname{diag}\left(\left|\lambda_{1}\right|, \ldots,\left|\lambda_{p}\right|\right)$和$\mathrm{T}$是$\mathrm{A}$的特征矢量矩阵。

例如，将$p$中的系统\ref{14.5} 转化为独立的传输方程，并用标量方程的上风方案对每个方程进行逼近，我们得到以下初始系统的上风数字方案

!!!!
\mathbf{u}_{j}^{n+1}=\mathbf{u}_{j}^{n}-\frac{\lambda}{2} \mathrm{~A}\left(\mathbf{u}_{j+1}^{n}-\mathbf{u}_{j-1}^{n}\right)+\frac{\lambda}{2}|\mathrm{~A}|\left(\mathbf{u}_{j+1}^{n}-2 \mathbf{u}_{j}^{n}+\mathbf{u}_{j-1}^{n}\right)
$$

这种方案的数值通量为

!!!!
\mathbf{H}_{j+\frac{1}{2}}=\frac{1}{2}\left[\mathrm{~A}\left(\mathbf{u}_{j+1}+\mathbf{u}_{j}\right)-|\mathbf{A}|\left(\mathbf{u}_{j+1}-\mathbf{u}_{j}\right)\right]
$$

Lax-Wendroff方法成为

!!!!
\mathbf{u}_{j}^{n+1}=\mathbf{u}_{j}^{n}-\frac{1}{2} \lambda \mathbf{A}\left(\mathbf{u}_{j+1}^{n}-\mathbf{u}_{j-1}^{n}\right)+\frac{1}{2} \lambda^{2} \mathrm{~A}^{2}\left(\mathbf{u}_{j+1}^{n}-2 \mathbf{u}_{j}^{n}+\mathbf{u}_{j-1}^{n}\right)
$$

而其数值通量为

!!!!
\mathbf{H}_{j+\frac{1}{2}}=\frac{1}{2}\left[\mathrm{~A}\left(\mathbf{u}_{j+1}+\mathbf{u}_{j}\right)-\lambda \mathrm{A}^{2}\left(\mathbf{u}_{j+1}-\mathbf{u}_{j}\right)\right]
$$



\subsubsection{Boundary treatment}

如果我们想在有界区间上离散双曲方程\ref{14.3} ，我们显然需要使用流入节点$x=\alpha$来施加边界条件，例如$u_{0}^{n+1}=\varphi\left(t^{n+1}\right)$，而在所有其他节点$x_{j}, 1 \leq j \leq m$（包括流出节点$x_{m}=\beta$）我们将编写有限差分方案。

然而，使用空间导数的中心离散化的方案需要在$x_{m}$处进行特殊处理。事实上，他们将需要$u_{m+1}$的值，这是不可用的，因为它与坐标为$\beta+h$的点有关，在积分区间之外。这个问题可以用各种方法解决。一个选择是在最后一个节点上只使用上风去中心离散化，因为这种离散化不需要知道$x_{m+1}$中的基准点；然而这种方法只是一个一阶方法。另外，$u_{m}^{n+1}$的值可以通过从内部节点的可用值外推获得。一个例子是沿特征线外推，适用于$\lambda a \leq 1 ;$提供$u_{m}^{n+1}=u_{m-1}^{n} \lambda a+u_{m}^{n}(1-\lambda a)$ 的方案。

另一个选择是对流出节点$x_{m}$也适用居中有限差分方案，并使用基于常数外推$\left(u_{m+1}^{n}=u_{m}^{n}\right)$或线性外推$\left(u_{m+1}^{n}=2 u_{m}^{n}-u_{m-1}^{n}\right)$的近似值，以代替$u_{m+1}^{n}$。

在双曲系统的情况下，这个问题变得更加棘手，我们必须求助于相容方程。为了对这些方面有更多的了解，并分析它们在数值边界处理中可能产生的不稳定性，读者可以参考Strickwerda [Str89], [QV94, Chap. 14] 和 [LeV07] 。

\subsection{Analysis of the finite difference methods}

我们分析了我们之前介绍的有限差分方法的一致性、稳定性和收敛性。

\subsubsection{Consistency and convergence}

对于一个给定的数值方案，局部截断误差是期望精确解来验证数值方案本身产生的误差。

例如，在方案\ref{14.14} 的情况下，用$u$表示精确问题\ref{14.1} 的解决方案，我们可以在$\left(x_{j}, t^{n}\right)$点定义截断误差如下

!!!!
\tau_{j}^{n}=\frac{u\left(x_{j}, t^{n+1}\right)-u\left(x_{j}, t^{n}\right)}{\Delta t}+a \frac{u\left(x_{j+1}, t^{n}\right)-u\left(x_{j-1}, t^{n}\right)}{2 h}
$$

如果截断错误

!!!!
\tau(\Delta t, h)=\max _{j, n}\left|\tau_{j}^{n}\right|
$$

当$\Delta t$和$h$独立趋向于零时，那么数字方案将被称为一致。此外，我们将说一个数值方案在时间上精确到$p$阶，在空间上精确到$q$阶（对于合适的整数$p$和$q$），如果对于精确问题的一个足够规则的解，我们有

!!!!
\tau(\Delta t, h)=\mathscr{O}\left(\Delta t^{p}+h^{q}\right)
$$

适当地使用泰勒展开，然后我们可以看到，前面介绍的方法的截断误差为。

- 欧拉（向前或向后）/居中。  $\mathscr{O}\left(\Delta t+h^{2}\right)$ ;

- 上风。  $\mathscr{O}(\Delta t+h)$ ;

- Lax-Friedrichs: $\mathscr{O}\left(\frac{h^{2}}{\Delta t}+\Delta t+h^{2}\right)$ 。

- 拉克斯-温德洛夫。  $\mathscr{O}\left(\Delta t^{2}+h^{2}+h^{2} \Delta t\right)$ .

最后，我们将说，一个方案是收敛的（在最大规范中），如果

!!!!
\lim _{\Delta t, h \rightarrow 0}\left(\max _{j, n}\left|u\left(x_{j}, t^{n}\right)-u_{j}^{n}\right|\right)=0
$$

显然，我们也可以考虑更弱的规范，如 $\|\cdot\|_{\Delta, 1}$ 和 $\|\cdot\|_{\Delta, 2}$ ，我们将在 \ref{14.26} 中介绍这些规范。

\subsubsection{Stability}

我们将说，如果对于每个瞬间$T$，存在一个常数$C_{T}>0$（可能取决于$T$），使得对于每个$h>0$，存在$\delta_{0}>0$（可能取决于$\left.h\right)$，使得对于每个$0<\Delta t<\delta_{0}$我们有

!!!!
\left\|\mathbf{u}^{n}\right\|_{\Delta} \leq C_{T}\left\|\mathbf{u}^{0}\right\|_{\Delta}
\label{14.25}\end{equation}

对于每个$n$，如$n \Delta t \leq T$ ，以及每个初始基准$\mathbf{u}_{0}$。请注意，$C_{T}$不应取决于$\Delta t$和$h$。通常情况下（总是如此，在显式方法的情况下），只有当时间步长相对于空间步长足够小时，我们才会有稳定性，也就是对于$\delta_{0}=\delta_{0}(h)$ 。

符号$\|\cdot\|_{\Delta}$表示一个合适的离散规范，例如

!!!!
\|\mathbf{v}\|_{\Delta, p}=\left(h \sum_{j=-\infty}^{\infty}\left|v_{j}\right|^{p}\right)^{\frac{1}{p}} \text { for } p=1,2, \quad\|\mathbf{v}\|_{\Delta, \infty}=\sup _{j}\left|v_{j}\right|
\label{14.26}\end{equation}

注意$\|\mathbf{v}\|_{\Delta, p}$如何代表$\mathrm{L}^{p}(\mathbb{R})$准则的近似值，对于$p=1,2$或$+\infty$ .

对于参数$\Delta t$和$h$的任何选择，隐式后向/中心欧拉方案\ref{14.22} 在准则$\|\cdot\|_{\Delta, 2}$中是稳定的（见练习2）。

在以下情况下，一个方案被称为相对于规范的强稳定性$\|\cdot\|_{\Delta}$： 1.

!!!!
\left\|\mathbf{u}^{n}\right\|_{\Delta} \leq\left\|\mathbf{u}^{n-1}\right\|_{\Delta}
\label{14.27}\end{equation}

对于每个$n$，如$n \Delta t \leq T$，以及每个初始基准$\mathbf{u}_{0}$，这意味着\ref{14.25}可与$C_{T}=1$进行验证。

![](https://cdn.mathpix.com/cropped/71627ab35978b0d0d1f5970ad976ca1f-23.jpg?height=188&width=654&top_left_y=110&top_left_x=105)

图14.3.对具有$p=2$的系统的CFL条件的几何解释，其中$r_{i}=$ $\bar{x}-\lambda_{i}(t-\bar{t}) i=1,2$ 。左边满足CFL条件，右边被违反。

备注14.1.在双曲问题的背景下，人们经常需要长时间的解（具有$T \gg 1$的解）。这种情况下通常需要一个强稳定的方案，因为这保证了数字解对于$T$的每个值都是有界的。

正如我们将看到的，形式为\ref{14.13} 的显式数值方案的稳定性的一个必要条件是，时间和空间离散化步骤满足

!!!!
|a \lambda| \leq 1, \text { or } \Delta t \leq \frac{h}{|a|} .
\label{14.28}\end{equation}

这就是著名的$C F L$条件（来自Courant, Friedrichs and Lewy, [CFL28] ）。数字$a \lambda$通常被称为$C F L$数，是一个物理上的无量纲数量（$a$是一个速度）。

CFL稳定性条件的几何学解释如下。在有限差分方案中，$u_{j}^{n+1}$的值一般取决于$u_{j+i}^{n}$时在$t^{n}$三点的值$x_{j+i}, i=-1,0,1$ 。向后推进，我们推断出，解$u_{j}^{n+1}$将只取决于$x_{j+i}$点的初始数据，对于$i=!!!!-(n+1), \ldots,(n+1)$（见图14.3）。

将$D_{\Delta t}\left(x_{j}, t^{n}\right)$的数值依赖域称为$u_{j}^{n}$的依赖域，因此将其称为$u_{j}^{n}$的数值依赖域，前者将验证

!!!!
D_{\Delta t}\left(x_{j}, t^{n}\right) \subset\left\{x \in \mathbb{R}:\left|x-x_{j}\right| \leq n h=\frac{t^{n}}{\lambda}\right\}
$$

因此，对于每个给定的点$(\bar{x}, \bar{t})$，我们有

!!!!
D_{\Delta t}(\bar{x}, \bar{t}) \subset\left\{x \in \mathbb{R}:|x-\bar{x}| \leq \frac{\bar{t}}{\lambda}\right\}
\label{14.29}\end{equation}

特别是，对$\Delta t \rightarrow 0$采取限制，并固定$\lambda$，数字依赖域成为

!!!!
D_{0}(\bar{x}, \bar{t})=\left\{x \in \mathbb{R}:|x-\bar{x}| \leq \frac{\bar{t}}{\lambda}\right\}
$$

那么条件\ref{14.28} 就等同于包含了

!!!!
D(\bar{x}, \bar{t}) \subset D_{0}(\bar{x}, \bar{t})
$$

其中$D(\bar{x}, \bar{t})$是\ref{14.8} 中定义的精确解的依赖域。注意，在标量情况下，$p=1$和$\lambda_{1}=a$ .

备注14.2.CFL条件特别规定，对于双曲初值问题，不存在无条件稳定和一致的明确的有限不同方案。事实上，假设CFL条件被违反。那么依赖域中至少存在一个不属于数值依赖域的点$x^{*}$。那么将初始基准点改为$x^{*}$将只修改精确解而不修改数值解。这意味着方法的不收敛性，因此也意味着不稳定性。事实上，对于一个一致的方法，Lax-Richtmyer等价定理指出，稳定性是其收敛的充分条件。

备注14.3。在\ref{14.1} 中$a=a(x, t)$不再是常数的情况下，CFL条件变为

!!!!
\Delta t \leq \frac{h}{\sup _{x \in \mathbb{R}, t>0}|a(x, t)|}
$$

如果空间离散化的步骤不同，我们有

!!!!
\begin{gathered}
\Delta t \leq \min _{k} \frac{h_{k}}{\sup }|a(x, t)| \\
x \in\left(x_{k}, x_{k+1}\right), t>0
\end{gathered}
$$

与 $h_{k}=x_{k+1}-x_{k}$ 。

参照双曲系统\ref{14.5} ，CFL稳定性条件，与\ref{14.28} 相类似，将是

!!!!
\left|\lambda_{k} \frac{\Delta t}{h}\right| \leq 1, \quad k=1, \ldots, p, \quad \text { or, equivalently, } \quad \Delta t \leq \frac{h}{\max _{k}\left|\lambda_{k}\right|}
$$

其中$\left\{\lambda_{k}, k=1 \ldots, p\right\}$是$\mathrm{A}$的特征值。

这个条件也可以写成\ref{14.29} 的形式。后者表达了这样的要求：每条形式为$x=\bar{x}-\lambda_{k}(\bar{t}-t), k=1, \ldots, p$的线，必须与位于数字依赖域内的点$x^{(k)}$相交于水平线$t=\bar{t}-\Delta t$。

定理14.1.如果满足CFL条件\ref{14.28} ，则上风向、Lax-的

Friedrichs和Lax-Wendroff方案在规范中是强稳定的$\|\cdot\|_{\Delta, 1}$ 。

证明。为了证明上风方案\ref{14.20} 的稳定性，我们将其改写为以下形式（假定$a>0$）。

!!!!
u_{j}^{n+1}=u_{j}^{n}-\lambda a\left(u_{j}^{n}-u_{j-1}^{n}\right)
$$



!!!!
\left\|\mathbf{u}^{n+1}\right\|_{\Delta, 1} \leq h \sum_{j}\left|(1-\lambda a) u_{j}^{n}\right|+h \sum_{j}\left|\lambda a u_{j-1}^{n}\right|
$$

在假设\ref{14.28} 下，$\lambda a$和$1-\lambda a$两个值都是非负的。因此。

!!!!
\left\|\mathbf{u}^{n+1}\right\|_{\Delta, 1} \leq h(1-\lambda a) \sum_{j}\left|u_{j}^{n}\right|+h \lambda a \sum_{j}\left|u_{j-1}^{n}\right|=\left\|\mathbf{u}^{n}\right\|_{\Delta, 1}
$$

即不等式 \ref{14.25} 与 $C_{T}=1$ 均成立。因此，该方案对于规范$\|\cdot\|_{\Delta}=\|\cdot\|_{\Delta, 1}$来说是强稳定的。

对于Lax-Friedrichs方案，总是在CFL条件\ref{14.28} 下，我们从\ref{14.16} 中推导出，即

!!!!
u_{j}^{n+1}=\frac{1}{2}(1-\lambda a) u_{j+1}^{n}+\frac{1}{2}(1+\lambda a) u_{j-1}^{n},
$$

那么

!!!!
\begin{aligned}
\left\|\mathbf{u}^{n+1}\right\|_{\Delta, 1} & \leq \frac{1}{2} h\left[\sum_{j}\left|(1-\lambda a) u_{j+1}^{n}\right|+\sum_{j}\left|(1+\lambda a) u_{j-1}^{n}\right|\right] \\
& \leq \frac{1}{2}(1-\lambda a)\left\|\mathbf{u}^{n}\right\|_{\Delta, 1}+\frac{1}{2}(1+\lambda a)\left\|\mathbf{u}^{n}\right\|_{\Delta, 1}=\left\|\mathbf{u}^{n}\right\|_{\Delta, 1}
\end{aligned}
$$

对于Lax-Wendroff方案，证明是类似的（例如见[QV94, Chap 14] 或 $[$ Str89] 。  $)$ .

最后，我们可以证明，如果CFL条件得到验证，上风方案满足

!!!!
\left\|\mathbf{u}^{n}\right\|_{\Delta, \infty} \leq\left\|\mathbf{u}^{0}\right\|_{\Delta, \infty} \quad \forall n \geq 0
\label{14.30}\end{equation}

即它在准则$\|\cdot\|_{\Delta, \infty}$中是强稳定的。关系\ref{14.30} 被称为离散最大原则（见练习4）。


Theorem 14.2. The backward Euler scheme BE/C is strongly stable in the norm $\|\cdot\|_{\Delta, 2}$, with no restriction on $\Delta t .$ The forward Euler scheme FE/C, instead, is never strongly stable. However, it is stable with constant $C_{T}=e^{T / 2}$ provided that we assume that $\Delta t$ satisfies the following condition (more restrictive than the $C F L$ condition)

!!!!
\Delta t \leq\left(\frac{h}{a}\right)^{2}
\label{14.31}\end{equation}


证明。我们观察到，

!!!!
(B-A) B=\frac{1}{2}\left(B^{2}-A^{2}+(B-A)^{2}\right) \quad \forall A, B \in \mathbb{R}
\label{14.32}\end{equation}

作为一个事实

!!!!
(B-A) B=(B-A)^{2}+(B-A) A=\frac{1}{2}\left((B-A)^{2}+(B-A)(B+A)\right)
$$

将\ref{14.22} 乘以$u_{j}^{n+1}$，我们发现

!!!!
\left(u_{j}^{n+1}\right)^{2}+\left(u_{j}^{n+1}-u_{j}^{n}\right)^{2}=\left(u_{j}^{n}\right)^{2}-\lambda a\left(u_{j+1}^{n+1}-u_{j-1}^{n+1}\right) u_{j}^{n+1}
$$

观察到

!!!!
\sum_{j \in \mathbb{Z}}\left(u_{j+1}^{n+1}-u_{j-1}^{n+1}\right) u_{j}^{n+1}=0
\label{14.33}\end{equation}

(伸缩性总和），我们立即得到$\left\|\mathbf{u}^{n+1}\right\|_{\Delta, 2}^{2} \leq\left\|\mathbf{u}^{n}\right\|_{\Delta, 2}^{2}$，这是为$\mathrm{BE} / \mathrm{C}$方案寻求的结果。

现在让我们转向FE/C方案，并将\ref{14.14} 乘以$u_{j}^{n}$ 。观察到

!!!!
(B-A) A=\frac{1}{2}\left(B^{2}-A^{2}-(B-A)^{2}\right) \quad \forall A, B \in \mathbb{R}
\label{14.34}\end{equation}

我们发现

!!!!
\left(u_{j}^{n+1}\right)^{2}=\left(u_{j}^{n}\right)^{2}+\left(u_{j}^{n+1}-u_{j}^{n}\right)^{2}-\lambda a\left(u_{j+1}^{n}-u_{j-1}^{n}\right) u_{j}^{n}
$$

另一方面，我们再一次从\ref{14.14} 中得到

!!!!
u_{j}^{n+1}-u_{j}^{n}=-\frac{\lambda a}{2}\left(u_{j+1}^{n}-u_{j-1}^{n}\right)
$$

因此

!!!!
\left(u_{j}^{n+1}\right)^{2}=\left(u_{j}^{n}\right)^{2}+\left(\frac{\lambda a}{2}\right)^{2}\left(u_{j+1}^{n}-u_{j-1}^{n}\right)^{2}-\lambda a\left(u_{j+1}^{n}-u_{j-1}^{n}\right) u_{j}^{n}
$$

现在在$j$上求和，并观察到最后一个附录产生了一个望远镜式的和（因此它没有提供任何贡献），在乘以$h$之后，我们得到了。

!!!!
\left\|\mathbf{u}^{n+1}\right\|_{\Delta, 2}^{2}=\left\|\mathbf{u}^{n}\right\|_{\Delta, 2}^{2}+\left(\frac{\lambda a}{2}\right)^{2} h \sum_{j \in \mathbb{Z}}\left(u_{j+1}^{n}-u_{j-1}^{n}\right)^{2}
$$

从中我们可以推断出，在$\Delta t$中没有任何数值是强稳定的方法。然而，由于

!!!!
\left(u_{j+1}^{n}-u_{j-1}^{n}\right)^{2} \leq 2\left[\left(u_{j+1}^{n}\right)^{2}+\left(u_{j-1}^{n}\right)^{2}\right]
$$

我们发现，在假设\ref{14.31} 下，。

!!!!
\left\|\mathbf{u}^{n+1}\right\|_{\Delta, 2}^{2} \leq\left(1+\lambda^{2} a^{2}\right)\left\|\mathbf{u}^{n}\right\|_{\Delta, 2}^{2} \leq(1+\Delta t)\left\|\mathbf{u}^{n}\right\|_{\Delta, 2}^{2}
$$

通过递归，我们发现

!!!!
\left\|\mathbf{u}^{n}\right\|_{\Delta, 2}^{2} \leq(1+\Delta t)^{n}\left\|\mathbf{u}^{0}\right\|_{\Delta, 2}^{2} \leq e^{T}\left\|\mathbf{u}^{0}\right\|_{\Delta, 2}^{2}
$$

其中我们使用了不等式

!!!!
(1+\Delta t)^{n} \leq e^{n \Delta t} \leq e^{T} \quad \forall n \text { such that } t^{n} \leq T
$$

我们的结论是

!!!!
\left\|\mathbf{u}^{n}\right\|_{\Delta, 2} \leq e^{T / 2}\left\|\mathbf{u}^{0}\right\|_{\Delta, 2}
$$

这是为$\mathrm{FE} / \mathrm{C}$方案寻求的稳定性结果。

\subsubsection{Von Neumann analysis and amplification coefficients}

冯-诺依曼的分析对于研究一个方案在规范$\|\cdot\|_{\Delta, 2}$中的稳定性很有用。为此，我们假设函数$u_{0}(x)$是$2 \pi$-周期性的，因此它可以写成如下的傅里叶级数

!!!!
u_{0}(x)=\sum_{k=-\infty}^{\infty} \alpha_{k} e^{i k x}
\label{14.35}\end{equation}

其中

!!!!
\alpha_{k}=\frac{1}{2 \pi} \int_{0}^{2 \pi} u_{0}(x) e^{-i k x} d x
$$

是$k$-次傅里叶系数。因此。

!!!!
u_{j}^{0}=u_{0}\left(x_{j}\right)=\sum_{k=-\infty}^{\infty} \alpha_{k} e^{i k j h}, \quad j=0, \pm 1, \pm 2, \cdots
$$

可以验证的是，应用第14.3.1节中看到的任何一种差分方案，我们可以得到以下关系

!!!!
u_{j}^{n}=\sum_{k=-\infty}^{\infty} \alpha_{k} e^{i k j h} \gamma_{k}^{n}, \quad j=0, \pm 1, \pm 2, \ldots, \quad n \geq 1
\label{14.36}\end{equation}

数字$\gamma_{k} \in \mathbb{C}$被称为第$k$个频率（或谐波）的放大系数，用于描述所研究的方案。例如，在前向中心欧拉法（FE/C）的情况下，我们发现

!!!!
\begin{aligned}
u_{j}^{1} &=\sum_{k=-\infty}^{\infty} \alpha_{k} e^{i k j h}\left(1-\frac{a \Delta t}{2 h}\left(e^{i k h}-e^{-i k h}\right)\right) \\
&=\sum_{k=-\infty}^{\infty} \alpha_{k} e^{i k j h}\left(1-\frac{a \Delta t}{h} i \sin (k h)\right)
\end{aligned}
$$

表14.1.14.3.1节中不同数字方案的放大系数。我们回顾一下，$\lambda=\Delta t / h$ 。

\begin{tabular}{lc}{begin{tabular}.
\hline \multicolumn{1}{c}{ Scheme } & $\gamma_{k}$ \
\hline Forward/centered Euler & $1-i a \lambda \sin (k h)$ （正向/居中的欧拉） №$1-i a \lambda \sin (k h)$
Backward/centered Euler & $(1+i a \lambda \sin (k h))^{-1}$ （后退/居中欧拉） \hline
Upwind & $1-|a| \lambda\left(1-e^{-i k h}\right)$ （上风）。
Lax-Friedrichs & $\cos k h-i a \lambda \sin (k h)$ （拉克斯-弗里德里希斯）。
Lax-Wendroff & $1-i a \lambda \sin (k h)-a^{2} \lambda^{2}(1-\cos (k h))$ Lax-Wendroff
\hline
\end{tabular}

因此。

!!!!
\gamma_{k}=1-\frac{a \Delta t}{h} i \sin (k h) \quad \text { and thus } \quad\left|\gamma_{k}\right|=\left\{1+\left(\frac{a \Delta t}{h} \sin (k h)\right)^{2}\right\}^{\frac{1}{2}}
$$

由于存在$k$的值，对于$\left|\gamma_{k}\right|>1$，没有$\Delta t$和$h$的值，方案是强稳定的。

以类似的方式进行其他方案，我们发现表$14.1$中报告的系数。

现在我们将看到如何应用冯-诺依曼分析来研究数值方案在$\|\cdot\|_{\Delta, 2}$准则方面的稳定性，并确定其耗散和分散特性。

为此，我们证明以下结果。

$e^{\beta T / m}$ .特别是，如果我们可以把$\beta=0$（以及因此$\left.\left|\gamma_{k}\right| \leq 1 \forall k\right)$则

方案对于同一规范来说是强稳定的。

证明。我们将假设问题\ref{14.1} 是在区间$[0,2 \pi]$上提出的。在这样的区间内，让我们考虑$N+1$的等距节点。

!!!!
x_{j}=j h, \quad j=0, \ldots, N, \quad \text { with } \quad h=\frac{2 \pi}{N}
$$

($N$是一个偶数正整数)，其中满足数字方案\ref{14.13}。此外，为简单起见，我们将假设初始基准$u_{0}$是周期性的。由于数值方案只取决于$u_{0}$在节点$x_{j}$处的值，我们可以用阶为$N / 2$的傅里叶多项式代替$u_{0}$。

!!!!
\tilde{u}_{0}(x)=\sum_{k=-\frac{N}{2}}^{\frac{N}{2}-1} \alpha_{k} e^{i k x}
\label{14.37}\end{equation}

其中在节点处进行插值。请注意，$\tilde{u}_{0}$是一个周期为$2 \pi$的周期函数。由于\ref{14.36}，我们将有。

!!!!
u_{j}^{0}=u_{0}\left(x_{j}\right)=\sum_{k=-\frac{N}{2}}^{\frac{N}{2}-1} \alpha_{k} e^{i k j h}, \quad u_{j}^{n}=\sum_{k=-\frac{N}{2}}^{\frac{N}{2}-1} \alpha_{k} \gamma_{k}^{n} e^{i k j h}
$$

我们注意到，

!!!!
\left\|\mathbf{u}^{n}\right\|_{\Delta, 2}^{2}=h \sum_{j=0}^{N-1} \sum_{k, m=-\frac{N}{2}}^{\frac{N}{2}-1} \alpha_{k} \bar{\alpha}_{m}\left(\gamma_{k} \bar{\gamma}_{m}\right)^{n} e^{i(k-m) j h}
$$

如

!!!!
h \sum_{j=0}^{N-1} e^{i(k-m) j h}=2 \pi \delta_{k m}, \quad-\frac{N}{2} \leq k, m \leq \frac{N}{2}-1
$$

(见例如[QSS07, Lemma 10.2]）我们发现

!!!!
\left\|\mathbf{u}^{n}\right\|_{\Delta, 2}^{2}=2 \pi \sum_{k=-\frac{N}{2}}^{\frac{N}{2}-1}\left|\alpha_{k}\right|^{2}\left|\gamma_{k}\right|^{2 n}
$$

由于对$\left|\gamma_{k}\right|$的假设，我们有

!!!!
\left\|\mathbf{u}^{n}\right\|_{\Delta, 2}^{2} \leq(1+\beta \Delta t)^{\frac{2 n}{m}} 2 \pi \sum_{k=-\frac{N}{2}}^{\frac{N}{2}-1}\left|\alpha_{k}\right|^{2}=(1+\beta \Delta t)^{\frac{2 n}{m}}\left\|\mathbf{u}^{0}\right\|_{\Delta, 2}^{2} \forall n \geq 0
$$

如$1+\beta \Delta t \leq e^{\beta \Delta t}$，我们推导出

!!!!
\left\|\mathbf{u}^{n}\right\|_{\Delta, 2} \leq e^{\frac{\beta \Delta n}{m}}\left\|\mathbf{u}^{0}\right\|_{\Delta, 2}=e^{\frac{\beta T}{m}}\left\|\mathbf{u}^{0}\right\|_{\Delta, 2} \quad \forall n \quad \text { such that } \quad n \Delta t \leq T
$$

这就证明了该定理。

备注14.4。如果需要强稳定性，定理$14.3$中指出的条件$\left|\gamma_{k}\right| \leq 1$也是必要的。

在上风方案\ref{14.20} 的情况下，由于

!!!!
\left|\gamma_{k}\right|^{2}=[1-|a| \lambda(1-\cos k h)]^{2}+a^{2} \lambda^{2} \sin ^{2} k h, \quad k \in \mathbb{Z}
$$

我们得到

!!!!
\left|\gamma_{k}\right| \leq 1 \text { if } \Delta t \leq \frac{h}{|a|}, \quad k \in \mathbb{Z}
\label{14.38}\end{equation}

也就是说，CFL条件保证了$\|\cdot\|_{\Delta, 2}$准则中的强稳定性。以类似的方式进行，我们可以验证\ref{14.38} 对于Lax-Friedrichs方案也是成立的。

在准则$\|\cdot\|_{\Delta, 2}$中，居中的后向欧拉方案BE/C反而是无条件强稳定的，因为对于每个$k$和每个可能的$\Delta t$和$h$的选择，我们之前在定理$14.2$中通过不同的程序得到。

在有中心的前向欧拉方法FE/C的情况下，我们有

!!!!
\left|\gamma_{k}\right|^{2}=1+\frac{a^{2} \Delta t^{2}}{h^{2}} \sin ^{2}(k h) \leq 1+\frac{a^{2} \Delta t^{2}}{h^{2}}, \quad k \in \mathbb{Z}
$$

如果$\beta>0$是一个常数，使得

!!!!
\Delta t \leq \beta \frac{h^{2}}{a^{2}}
\label{14.39}\end{equation}

那么$\left|\gamma_{k}\right| \leq(1+\beta \Delta t)^{1 / 2}$ 。因此，应用定理$14.3$（与$\left.m=2\right)$一起，我们推断出FE/C方案是稳定的，尽管有一个更严格的CFL条件，就像之前按照定理14.2的不同路径得到的那样。

如果我们对运输反应方程应用居中的正向欧拉方法

!!!!
\frac{\partial u}{\partial t}+a \frac{\partial u}{\partial x}+a_{0} u=0
\label{14.40}\end{equation}

与$a_{0}>0$，对于每个$k \in \mathbb{Z}$我们发现

!!!!
\left|\gamma_{k}\right|^{2}=1-2 a_{0} \Delta t+\Delta t^{2} a_{0}^{2}+\lambda^{2} \sin ^{2}(k h) \leq 1-2 a_{0} \Delta t+\Delta t^{2} a_{0}^{2}+\left(\frac{a \Delta t}{h}\right)^{2}
$$

那么该方案在$\|.\|_{\Delta, 2}$准则下是强稳定的，条件是

!!!!
\Delta t<\frac{2 a_{0}}{a_{0}^{2}+h^{-2} a^{2}}
\label{14.41}\end{equation}

例14.1.为了在数值上验证稳定性条件\ref{14.41}，我们考虑了方程\ref{14.40}在区间$(0,1)$的周期性边界条件。我们选择了$a=a_{0}=1$和初始基准$u_{0}$，在区间$(1 / 3,2 / 3)$内等于2，其他地方等于0。由于初始数据是一个方波，它的傅里叶扩展的所有$\alpha_{k}$系数都不是空的。在图14.4的右边，我们报告了$\left\|\mathbf{u}^{n}\right\|_{\Delta, 2}$在$(0,2.5)$的时间间隔内的两个$\Delta t$值，一个比\ref{14.41}提供的临界值$\Delta t^{*}=2 /\left(1+h^{-2}\right)$大，一个比它小。请注意，对于$\Delta t<\Delta t^{*}$，规范是递减的，而在相反的情况下，在最初的减少之后，规范是指数级增长的。图$14.5$显示了与$\mathrm{FE} / \mathrm{C}$使用相同的初始数据得到的$a_{0}=0$的结果。在左边的图中，我们显示了$\left\|\mathbf{u}^{n}\right\|_{\Delta, 2}$在不同的$h$值和使用$\Delta t=10 h^{2}$时的行为，也就是根据不等式\ref{14.39} 提供的限制改变时间步长，并取$\beta=10$。请注意，对于$h$的递减值，解的规范仍然是有界的。在同一幅图的右侧，我们说明了对于相同的$h$值，以$\Delta t=0.1 h$为条件得到的结果，这相当于一个等于$0.1$的恒定CFL数。在这种情况下，数值解的离散规范随着$h$的减少而膨胀，正如预期的那样。
 ![](https://cdn.mathpix.com/cropped/991f5db518e324d299c1ff4972bba9fb-005.jpg?height=238&width=694&top_left_y=112&top_left_x=106)

图14.4。右图显示了$\left\|\mathbf{u}^{n}\right\|_{\Delta, 2}$的行为，其中$\mathbf{u}^{n}$是方程\ref{14.40} 的解（用$\mathrm{FE} / \mathrm{C}$方法得到的$\left.a=a_{0}=1\right)$，有两个$\Delta t$的值，一个比临界值$\Delta t^{*}$小，一个大。在左边，使用的初始基准是

![](https://cdn.mathpix.com/cropped/991f5db518e324d299c1ff4972bba9fb-005.jpg?height=239&width=305&top_left_y=460&top_left_x=138)
 ![](https://cdn.mathpix.com/cropped/991f5db518e324d299c1ff4972bba9fb-005.jpg?height=238&width=644&top_left_y=460&top_left_x=138) $a_{0}=0$ and for different values of $h$. On the left, the case where $\Delta t$ satisfies the stability condition \ref{14.39}. On the right, the results obtained by maintaining the CFL number constant and equal to $0.1$, violating condition \ref{14.39}

\subsubsection{Dissipation and dispersion}

除了可以查询数值方案的稳定性外，对放大系数的分析也有助于研究其耗散和分散特性。

为了澄清这个问题，让我们考虑问题\ref{14.1} 的精确解；那么

!!!!
u\left(x, t^{n}\right)=u_{0}(x-a n \Delta t), \quad n \geq 0, \quad x \in \mathbb{R}
$$

与$t^{n}=n \Delta t$ 。特别是，使用\ref{14.35}我们可以得到

!!!!
u\left(x_{j}, t^{n}\right)=\sum_{k=-\infty}^{\infty} \alpha_{k} e^{i k j h}\left(g_{k}\right)^{n} \quad \text { with } g_{k}=e^{-i a k \Delta t}
\label{14.42}\end{equation}

比较\ref{14.42} 和\ref{14.36} ，我们可以注意到放大系数$\gamma_{k}$（由具体的数字方案产生）是$g_{k}$的对应物。我们观察到，$\left|g_{k}\right|=1$为每个$k \in \mathbb{Z}$，而$\left|\gamma_{k}\right| \leq 1$为了保证方案的强稳定性。因此，$\gamma_{k}$是一个耗散性系数。$\left|\gamma_{k}\right|$越小，振幅$\alpha_{k}$的减少就越大，因此，数值方案的耗散也就越大。

比值$\varepsilon_{a}(k)=\frac{\left|\gamma_{k}\right|}{g_{k} \mid}$被称为与数值方案相关的$k$-次谐波的放大误差（或耗散误差）（在我们的例子中它与放大系数重合）。

已设定

!!!!
\phi_{k}=k h
$$

如$k \Delta t=\lambda \phi_{k}$，我们得到了

!!!!
g_{k}=e^{-i a \lambda \phi_{k}}
\label{14.43}\end{equation}

实数$\phi_{k}$，这里用弧度表示，称为$k$-次谐波的相角。我们用以下方式重写$\gamma_{k}$。

!!!!
\gamma_{k}=\left|\gamma_{k}\right| e^{-i \omega \Delta t}=\left|\gamma_{k}\right| e^{-i \frac{\omega}{k} \lambda \phi_{k}}
$$

并将这种关系与\ref{14.43} 相比较，我们可以推断出比率$\frac{\omega}{k}$代表数字方案的传播率，相对于$k$-次谐波。该比率

!!!!
\varepsilon_{d}(k)=\frac{\omega}{k a}=\frac{\omega h}{\phi_{k} a}
$$

数值传播与精确解的传播$a$之间的误差称为相对于$\varepsilon_{d}$-次谐波的色散误差。

到目前为止分析的数值方案的放大（或耗散）误差和色散误差是相位角$\phi_{k}$和CFL数$a \lambda$的函数，如图14.6中报告。出于对称的原因，我们考虑了区间$0 \leq \phi_{k} \leq \pi$，我们在$x$轴上用度数而不是弧度来表示$\phi_{k}$注意正向/居中欧拉方案如何在我们考虑的所有CFL方案中给出一个数值高于1的放大系数曲线，根据这一事实，这种方案从来没有强烈稳定。

例14.2.在图$14.7$中，我们比较了用$a=1$和初始基准$u_{0}$解方程\ref{14.1} 得到的数值结果。解决方案是由以原点$(x=0)$为中心的两个等长的正弦波包组成。在左边的数字中 $l=20 h$ ，而在右边的数字中我们有 $l=8 h$ 。由于$k=\frac{2 \pi}{l}$，我们有$\phi_{k}=\frac{2 \pi}{l} h$，因此波包的相角值在左边是$\phi_{k}=\pi / 20$，右边是$\phi_{k}=\pi / 8$。数值解是针对CFL数的值$0.75$计算的，使用了前面说明的不同（稳定）方案。我们可以注意到耗散效应在高频$\left(\phi_{k}=\pi / 4\right)$下非常强，特别是对于一阶上风、后向/中心欧拉和Lax-Friedrichs方法。

为了体会色散效应，图14.8报告了8个时间步长后对$\phi_{k}=\pi / 4$的解。我们可以注意到Lax-Wendroff方法是如何做到最小的
 ![](https://cdn.mathpix.com/cropped/991f5db518e324d299c1ff4972bba9fb-007.jpg?height=890&width=706&top_left_y=112&top_left_x=104)

图14.6.以相位角$\phi_{k}=k h$和CFL数的不同值计算，不同数值方案的放大和色散误差

消散性。此外，通过仔细观察数值波峰相对于数值解的位置，我们可以验证Lax-Friedrichs方法具有正分散误差。事实上，数值波预计了精确波。对于CFL来说，上风法也是弱色散的。
 ![](https://cdn.mathpix.com/cropped/991f5db518e324d299c1ff4972bba9fb-008.jpg?height=902&width=706&top_left_y=115&top_left_x=104)

图14.7.不同波长的正弦波包$(l=20 h$左、$l=8 h$右$)$的对流传输方程的数值解，用不同的数值方案得到。实线显示的是$t=1$的数值解，虚线显示的是同一时刻的精确解。

数等于$0.75$，而Lax-Friedrichs和后向欧拉方法的分散性是很明显的（甚至在只有8个时间步骤之后！）。
 ![](https://cdn.mathpix.com/cropped/991f5db518e324d299c1ff4972bba9fb-009.jpg?height=620&width=572&top_left_y=116&top_left_x=172)

图14.8.正弦波包的对流传输的数值解。实线代表8个时间步骤后的解。蚀刻线表示在同一时间水平上相应的精确解。

\subsection{Equivalent equations}

对于每个数值方案，我们都可以联系到一个微分方程系列，称为等效方程。

\subsubsection{The upwind scheme case}

让我们首先关注一下上风方案。假设存在一个正则函数$v(x, t)$，在每一点$(x, t) \in \mathbb{R} \times \mathbb{R}^{+}$满足差分方程\ref{14.20}（而不仅仅是在网格节点$\left.\left(x_{j}, t^{n}\right) !\right)$。然后我们可以写出（在$a>0$的情况下)

!!!!
\frac{v(x, t+\Delta t)-v(x, t)}{\Delta t}+a \frac{v(x, t)-v(x-h, t)}{h}=0
\label{14.44}\end{equation}

使用相对于$x$和$t$的泰勒展开，并假设$v$相对于$x$和$t$属于$C^{4}$类，我们可以写出

!!!!
\begin{aligned}
&\frac{v(x, t+\Delta t)-v(x, t)}{\Delta t}=v_{t}+\frac{\Delta t}{2} v_{t t}+\frac{\Delta t^{2}}{6} v_{t t t}+\mathscr{O}\left(\Delta t^{3}\right) \\
&a \frac{v(x, t)-v(x-h, t)}{h}=a v_{x}-\frac{a h}{2} v_{x x}+\frac{a h^{2}}{6} v_{x x x}+\mathscr{O}\left(h^{3}\right)
\end{aligned}
$$

其中右手边的导数都是在$(x, t)$处评价的。由于\ref{14.44}，我们推断出，在每一点$(x, t)$，函数$v$满足以下关系

!!!!
v_{t}+a v_{x}=R^{U}+\mathscr{O}\left(\Delta t^{3}+h^{3}\right)
\label{14.45}\end{equation}

与

!!!!
R^{U}=\frac{1}{2}\left(a h v_{x x}-\Delta t v_{t t}\right)-\frac{1}{6}\left(a h^{2} v_{x x x}+\Delta t^{2} v_{t t t}\right) .
$$

对$t$中的这种方程进行形式化微分，我们发现

!!!!
v_{t t}+a v_{x t}=R_{t}^{U}+\mathscr{O}\left(\Delta t^{3}+h^{3}\right) .
$$

相反，在$x$中对其进行微分，我们有

!!!!
v_{x t}+a v_{x x}=R_{x}^{U}+\mathscr{O}\left(\Delta t^{3}+h^{3}\right) .
\label{14.46}\end{equation}

因此

!!!!
v_{t t}=a^{2} v_{x x}+R_{t}^{U}-a R_{x}^{U}+\mathscr{O}\left(\Delta t^{3}+h^{3}\right),
\label{14.47}\end{equation}

这使得我们可以从\ref{14.45}中获得

!!!!
v_{t}+a v_{x}=\mu v_{x x}-\frac{1}{6}\left(a h^{2} v_{x x x}+\Delta t^{2} v_{t t t}\right)-\frac{\Delta t}{2}\left(R_{t}^{U}-a R_{x}^{U}\right)+\mathscr{O}\left(\Delta t^{3}+h^{3}\right)
\label{14.48}\end{equation}

已设定

!!!!
\mu=\frac{1}{2} a h(1-(a \lambda))
\label{14.49}\end{equation}

并且，像往常一样，$\lambda=\Delta t / h$ 。现在，将\ref{14.47} 相对于$t$正式微分，以及\ref{14.46} 相对于$x$，我们发现

!!!!
\begin{aligned}
v_{t t t} &=a^{2} v_{x x t}+R_{t t}^{U}-a R_{x t}^{U}+\mathscr{O}\left(\Delta t^{3}+h^{3}\right) \\
&=-a^{3} v_{x x x}+a^{2} R_{x x}^{U}+R_{t t}^{U}-a R_{x t}^{U}+\mathscr{O}\left(\Delta t^{3}+h^{3}\right)
\end{aligned}
\label{14.50}\end{equation}

此外，我们有

!!!!
\begin{aligned}
&R_{t}^{U}=\frac{1}{2} a h v_{x x t}-\frac{\Delta t}{2} v_{t t t}-\frac{a h^{2}}{6} v_{x x x t}-\frac{\Delta t^{2}}{6} v_{t t t t} \\
&R_{x}^{U}=\frac{1}{2} a h v_{x x x}-\frac{\Delta t}{2} v_{t t x}-\frac{a h^{2}}{6} v_{x x x x}-\frac{\Delta t^{2}}{6} v_{t t t x}
\end{aligned}
\label{14.51}\end{equation}

在\ref{14.48} 中使用关系\ref{14.50}和\ref{14.51}，我们得到

!!!!
\begin{aligned}
v_{t}+a v_{x}=\mu & v_{x x}-\frac{a h^{2}}{6}\left(1-\frac{a^{2} \Delta t^{2}}{h^{2}}-\frac{3 a \Delta t}{2 h}\right) v_{x x x} \\
&+\underbrace{\frac{\Delta t}{4}\left(\Delta t v_{t t t}-a h v_{x x t}-a \Delta t v_{t t x}\right)}_{(\mathrm{A})} \\
&+\frac{\Delta t}{12}\left(\Delta t^{2} v_{t t t t}-a \Delta t^{2} v_{t t t x}+a h^{2} v_{x x x t}-a^{2} h^{2} v_{x x x x}\right) \\
&-\frac{a^{2} \Delta t^{2}}{6} R_{x x}^{U}-\frac{\Delta t^{2}}{6} R_{t t}^{U}+a \frac{\Delta t^{2}}{6} R_{x t}^{U}+\mathscr{O}\left(\Delta t^{3}+h^{3}\right) .
\end{aligned}
\label{14.52}\end{equation}

现在让我们把重点放在（A）项中所包含的$v$的第三次导数。由于\ref{14.50} ，\ref{14.46} 和\ref{14.47} ，我们分别发现。

!!!!
\begin{aligned}
&v_{t t t}=-a^{3} v_{x x x}+r_{1}, \\
&v_{x x t}=-a v_{x x x}+r_{2}, \\
&v_{t t x}=a^{2} v_{x x x}+r_{3},
\end{aligned}
$$

其中$r_{1}, r_{2}$和$r_{3}$是包含不少于四阶的$v$的导数的项，以及$\mathscr{O}\left(\Delta t^{3}+h^{3}\right)$的项（注意，从$R^{U}$的定义可以看出，其二阶导数是通过不少于四阶的$v$的导数表示）。将乘以$v_{x x x}$的系数重新组合，因此我们从\ref{14.52} 中推导出

!!!!
v_{t}+a v_{x}=\mu v_{x x}+v v_{x x x}+R_{4}(v)+\mathscr{O}\left(\Delta t^{3}+h^{3}\right),
\label{14.53}\end{equation}

已设定

!!!!
v=-\frac{a h^{2}}{6}\left(1-3 a \lambda+2(a \lambda)^{2}\right)
\label{14.54}\end{equation}

并用$R_{4}(v)$表示包含$v$的阶数至少为4的导数的项集。

我们可以得出结论，函数$v$分别满足，方程式。

!!!!
v_{t}+a v_{x}=0
\label{14.56}\end{equation}

如果我们忽略含有高于第一阶导数的条款。

!!!!
v_{t}+a v_{x}=\mu v_{x x}
\label{14.57}\end{equation}

如果我们忽略含有二阶以上导数的项。

!!!!
v_{t}+a v_{x}=\mu v_{x x}+v v_{x x x}
$$

如果我们忽略第三阶以上的导数。系数$\mu$和$v$在\ref{14.49} 和\ref{14.54} 。方程\ref{14.55} 、\ref{14.56} 和\ref{14.57} 被称为相对于上风方案的等效方程（一阶、二阶或三阶）。

\subsubsection{The Lax-Friedrichs and Lax-Wendroff case}

以类似的方式进行，我们可以推导出任何数字方案的等价方程。例如，在Lax-Friedrichs方案的情况下，用$v$表示一个假设的函数，在每一点$(x, t)$验证方程\ref{14.16} ，并观察到

!!!!
\begin{aligned}
&\frac{1}{2}(v(x+h, t)+v(x-h, t))=v+\frac{h^{2}}{2} v_{x x}+\mathscr{O}\left(h^{4}\right) \\
&\frac{1}{2}(v(x+h, t)-v(x-h, t))=h v_{x}+\frac{h^{3}}{6} v_{x x x}+\mathscr{O}\left(h^{4}\right)
\end{aligned}
$$

我们得到

!!!!
v_{t}+a v_{x}=R^{L F}+\mathscr{O}\left(\frac{h^{4}}{\Delta t}+\Delta t^{3}\right)
\label{14.58}\end{equation}

已设定

!!!!
R^{L F}=\frac{h^{2}}{2 \Delta t}\left(v_{x x}-\lambda^{2} v_{t t}\right)-\frac{a h^{2}}{6}\left(v_{x x x}+\frac{\lambda^{2}}{a} v_{t t t}\right)
$$

正如我们之前所做的那样，繁琐的计算允许我们从\ref{14.58} 中推导出等价方程\ref{14.55} -\ref{14.57} ，在这种情况下有

!!!!
\mu=\frac{h^{2}}{2 \Delta t}\left(1-(a \lambda)^{2}\right), \quad v=\frac{a h^{2}}{3}\left(1-(a \lambda)^{2}\right)
$$

在Lax-Wendroff方案的情况下，等效方程由以下参数描述

!!!!
\mu=0, \quad v=\frac{a h^{2}}{6}\left((a \lambda)^{2}-1\right)
$$

\subsubsection{On the meaning of coefficients in equivalent equations}

一般来说，在等效方程中，术语$\mu v_{x x}$代表耗散，而$v v_{x x x}$代表分散。我们可以通过检查问题的解决方案来提供一个启发式的证明

!!!!
\begin{cases}v_{t}+a v_{x}=\mu v_{x x}+v v_{x x x}, & x \in \mathbb{R}, t>0 \\ v(x, 0)=e^{i k x}, & k \in \mathbb{Z}\end{cases}
\label{14.59}\end{equation}

通过应用傅里叶变换，我们发现，如果$\mu=v=0$ ,

!!!!
v(x, t)=e^{i k(x-a t)}
$$

而对于$\mu$和$v$的任意实数（与$\mu>0$）我们有

!!!!
v(x, t)=e^{-\mu k^{2} t} e^{i k\left[x-\left(a+v k^{2}\right) t\right]}
$$

比较这两种关系，我们看到，对于$\mu$的增长值，解决方案的模数变小。随着频率$k$的增加，这种效果变得更加显著（这种现象我们已经在上一节中登记，尽管有部分不同的论据）。

因此，\ref{14.59} 中的项$\mu v_{x x}$对解有耗散作用。反过来，$v$修改了解决方案的传播速率，在$v>0$的情况下增加，如果$v<0$则减少。同样在这种情况下，在高频率下效果更明显。因此，第三导数项$v v_{x x x}$引入了色散效应。

一般来说，在等效方程中，偶数阶空间导数代表扩散性条款，而奇数阶导数代表耗散性条款。对于一阶方案（如上风方案），耗散效应往往几乎不可见，因为它被耗散效应所掩盖。以同阶的$\Delta t$和$h$为例，从\ref{14.56}和\ref{14.57}我们可以看出，$v \ll \mu$为$h \rightarrow 0$，因为$v=O\left(h^{2}\right)$和$\mu=O(h)$ 。特别是，如果CFL数为$\frac{1}{2}$，则上风法的三阶等效方程具有空的分散性，这与上一节中看到的数值结果一致。

相反，分散效应对于Lax-Friedrichs方案以及Lax-Wendroff方案是明显的，后者是二阶的，没有$\mu v_{x x}$类型的耗散项。然而，作为稳定的方案，后者无法避免耗散性。事实上，Lax-Wendroff方案的四阶等效方程是

!!!!
v_{t}+a v_{x}=\frac{a h^{2}}{6}\left[(a \lambda)^{2}-1\right] v_{x x x}-\frac{a h^{3}}{6} a \lambda\left[1-(a \lambda)^{2}\right] v_{x x x x}
$$

其中最后一项是耗散性的，如果$|a \lambda|<1$，通过应用傅里叶变换可以很容易验证。然后，我们也为Lax-Wendroff方案恢复CFL条件。

\subsubsection{Equivalent equations and error analysis}

用于获得等价方程的技术与我们在线性系统的数值求解过程中遇到的所谓后向分析有很强的相似性，其中计算的（非精确）解被解释为扰动线性系统的精确解（见[QSS07，第3章]）。事实上，扰动系统所起的作用与等价方程的作用相似。

此外，我们观察到，对一个数值方案的误差分析可以通过使用与之相关的等效方程来进行。事实上，通过一般地用$r=\mu v_{x x}+v v_{x x x}$表示等效方程的右侧，通过与\ref{14.1} 的比较，我们得到误差方程

!!!!
e_{t}+a e_{x}=r
$$

其中$e=v-u$ 。将此方程乘以$e$并在空间和时间上进行积分（在0和$t$之间），我们得到

!!!!
\|e(t)\|_{\mathrm{L}^{2}(\mathbb{R})} \leq C(t)\left(\|e(0)\|_{\mathrm{L}^{2}(\mathbb{R})}+\sqrt{\int_{0}^{t}\|r(s)\|_{\mathrm{L}^{2}(\mathbb{R})}^{2} d s}\right), \quad t>0
$$

使用了先验估计\ref{14.4} 。我们可以假设$e(0)=0$，因此观察到$\|e(t)\|_{\mathrm{L}^{2}(\mathbb{R})}$趋于零（对于$h$和$\Delta t$趋于零），对于上风或Lax-Friedrichs方案是1阶，对于Lax-Wendroff方案是2阶（已经假设$v$足够规则）。

\subsection{Exercises}

1.验证问题\ref{14.9}-\ref{14.10}的解(用$f=0$)是否满足特征\ref{14.11}。

[解决方案。将\ref{14.9}乘以$u_{t}$并在空间积分，我们得到

!!!!
0=\int_{\alpha}^{\beta} u_{t t} u_{t} d x-\int_{\alpha}^{\beta} \gamma^{2} u_{x x} u_{t} d x=\frac{1}{2} \int_{\alpha}^{\beta}\left[\left(u_{t}\right)^{2}\right]_{t} d x+\int_{\alpha}^{\beta} \gamma^{2} u_{x} u_{x t} d x-\left[\gamma^{2} u_{x} u_{t}\right]_{\alpha}^{\beta}
\label{14.60}\end{equation}

如

!!!!
\int_{\alpha}^{\beta} u_{t t} u_{t} d x=\frac{1}{2} \int_{\alpha}^{\beta}\left[\left(u_{t}\right)^{2}\right]_{t} d x \quad \text { and } \quad \int_{\alpha}^{\beta} \gamma^{2} u_{x} u_{x t} d x=\frac{1}{2} \int_{\alpha}^{\beta} \gamma^{2}\left[\left(u_{x}\right)^{2}\right]_{t} d x
$$

在时间上对\ref{14.60}进行整合，我们有

!!!!
\int_{\alpha}^{\beta} u_{t}^{2}(t) d x+\int_{\alpha}^{\beta} \gamma^{2} u_{x}^{2}(t) d x-\int_{\alpha}^{\beta} v_{0}^{2} d x-\int_{\alpha}^{\beta} \gamma^{2} u_{0 x}^{2} d x=0
\label{14.61}\end{equation}

因此，\ref{14.11}立即从后一个关系中得出。]

2.验证由后向/中心欧拉方案\ref{14.22}提供的解决方案。

是无条件稳定的；更确切地说。

!!!!
\|\mathbf{u}\|_{\Delta, 2} \leq\left\|\mathbf{u}^{0}\right\|_{\Delta, 2} \quad \forall \Delta t, h>0
$$

[解决方案。注意，由于\ref{14.32} 。

!!!!
\left(u_{j}^{n+1}-u_{j}^{n}\right) u_{j}^{n+1} \geq \frac{1}{2}\left(\left|u_{j}^{n+1}\right|^{2}-\left|u_{j}^{n}\right|^{2}\right) \quad \forall j, n
$$

然后，用\ref{14.22} 乘以$u_{j}^{n+1}$，对指数$j$求和，并使用\ref{14.33} ，我们发现

!!!!
\sum_{j}\left|u_{j}^{n+1}\right|^{2} \leq \sum_{j}\left|u_{j}^{n}\right|^{2} \quad \forall n \geq 0
$$

从中可以看出结果] 。

3.证明\ref{14.30}

[解决方案。我们注意到，在$a>0$的情况下，上风方案可以改写为以下形式

!!!!
u_{j}^{n+1}=(1-a \lambda) u_{j}^{n}+a \lambda u_{j-1}^{n}
$$

根据假设\ref{14.28} ，系数$a \lambda$和$1-a \lambda$都是非负的，因此

!!!!
\min \left(u_{j}^{n}, u_{j-1}^{n}\right) \leq u_{j}^{n+1} \leq \max \left(u_{j}^{n}, u_{j-1}^{n}\right)
$$

那么

!!!!
\inf _{l \in \mathbb{Z}}\left\{u_{l}^{0}\right\} \leq u_{j}^{n} \leq \sup _{l \in \mathbb{Z}}\left\{u_{l}^{0}\right\} \quad \forall j \in \mathbb{Z}, \forall n \geq 0
$$

从中可以看出\ref{14.30} 。

4.研究Lax-Friedrichs方案\ref{14.16} 对问题\ref{14.1} 求解的准确性。

5.研究Lax-Wendroff方案\ref{14.18} 对问题\ref{14.1} 求解的准确性。第十五章

\section{Finite elements and spectral methods for hyperbolic equations}

在本章中，我们将说明如何将Galerkin方法，特别是有限元方法和谱法，应用于标量双曲方程的空间和/或时间离散化。我们将同时处理连续和不连续的有限元。

让我们考虑运输问题\ref{14.3} ，为了简单起见，让我们设定$(\alpha, \beta)=$ $(0,1), \varphi=0$ 。此外，让我们假设$a$是一个正常数，$a_{0}$是一个非负常数。

首先，我们以连续有限元为基础进行空间离散化。因此，我们尝试采用以下形式的半离散化。

$\forall t>0$ ，找到$u_{h}=u_{h}(t) \in V_{h}$，以便于

!!!!
\left(\frac{\partial u_{h}}{\partial t}, v_{h}\right)+a\left(\frac{\partial u_{h}}{\partial x}, v_{h}\right)+a_{0}\left(u_{h}, v_{h}\right)=\left(f, v_{h}\right) \forall v_{h} \in V_{h},
\label{15.1}\end{equation}

$u_{h}^{0}$是初始基准的近似值。我们已经设定

!!!!
V_{h}=\left\{v_{h} \in X_{h}^{r}: v_{h}(0)=0\right\}, \quad r \geq 1
$$

空间$X_{h}^{r}$的定义与\ref{4.14}一样，只要我们用$(0,1)$代替$(a, b)$。

\subsection{Temporal discretization}

对于问题\ref{15.1} 的时间离散化，我们将使用有限差分方案，如第 $14$ 章中介绍的那些。

按照惯例，我们将用$u_{h}^{n}, n \geq 0$表示，$u_{h}$在时间$t^{n}=n \Delta t$的近似值。

\subsubsection{The forward and backward Euler schemes}

在我们使用前向欧拉方案的情况下，离散问题变成了。

$\forall n \geq 0$ ，找到$u_{h}^{n+1} \in V_{h}$，以便

!!!!
\frac{1}{\Delta t}\left(u_{h}^{n+1}-u_{h}^{n}, v_{h}\right)+a\left(\frac{\partial u_{h}^{n}}{\partial x}, v_{h}\right)+a_{0}\left(u_{h}^{n}, v_{h}\right)=\left(f^{n}, v_{h}\right) \forall v_{h} \in V_{h}
\label{15.2}\end{equation}

其中$(u, v)=\int_{0}^{1} u(x) v(x) d x$照例表示$\mathrm{L}^{2}(0,1)$的标量乘积

在后退欧拉方法的情况下，代替\ref{15.2}我们将有

!!!!
\frac{1}{\Delta t}\left(u_{h}^{n+1}-u_{h}^{n}, v_{h}\right)+a\left(\frac{\partial u_{h}^{n+1}}{\partial x}, v_{h}\right)+a_{0}\left(u_{h}^{n+1}, v_{h}\right)=\left(f^{n+1}, v_{h}\right) \forall v_{h} \in V_{h}
\label{15.3}\end{equation}

Theorem 15.1. The backward Euler scheme is strongly stable with no restriction on $\Delta t$. Instead, the forward Euler method is strongly stable only for $a_{0}>0$, provided we suppose that

!!!!
\Delta t \leq \frac{2 a_{0}}{\left(a C h^{-1}+a_{0}\right)^{2}}
\label{15.4}\end{equation}

for a given constant $C=C(r)$


证明。在\ref{15.2} 中选择$v_{h}=u_{h}^{n}$，我们得到（在$f=0$的情况下)

!!!!
\left(u_{h}^{n+1}-u_{h}^{n}, u_{h}^{n}\right)+\Delta t a\left(\frac{\partial u_{h}^{n}}{\partial x}, u_{h}^{n}\right)+\Delta t a_{0}\left\|u_{h}^{n}\right\|_{\mathrm{L}^{2}(0,1)}^{2}=0
$$

对于第一项，我们使用同一性

!!!!
(v-w, w)=\frac{1}{2}\left(\|v\|_{\mathrm{L}^{2}(0,1)}^{2}-\|w\|_{\mathrm{L}^{2}(0,1)}^{2}-\|v-w\|_{\mathrm{L}^{2}(0,1)}^{2}\right) \forall v, w \in \mathrm{L}^{2}(0,1)
\label{15.5}\end{equation}

它概括了\ref{14.34} 。对于第二个和，通过部分积分和使用边界条件，我们发现

!!!!
\left(\frac{\partial u_{h}^{n}}{\partial x}, u_{h}^{n}\right)=\frac{1}{2}\left(u_{h}^{n}(1)\right)^{2}
$$

因此，我们得到

!!!!
\left\|u_{h}^{n+1}\right\|_{\mathrm{L}^{2}(0,1)}^{2}+a \Delta t\left(u_{h}^{n}(1)\right)^{2}+2 a_{0} \Delta t\left\|u_{h}^{n}\right\|_{\mathrm{L}^{2}(0,1)}^{2}=\left\|u_{h}^{n}\right\|_{\mathrm{L}^{2}(0,1)}^{2}+\left\|u_{h}^{n+1}-u_{h}^{n}\right\|_{\mathrm{L}^{2}(0,1)}^{2}
\label{15.6}\end{equation}

我们现在寻求对$\left\|u_{h}^{n+1}-u_{h}^{n}\right\|_{\mathrm{L}^{2}(0,1)^{2}}^{2}$项的估计。为此，在\ref{15.2} 中设定

!!!!
\begin{aligned}
&v_{h}=u_{h}^{n+1}-u_{h}^{n}, \text { we obtain } \\
&\qquad \begin{aligned}
\left\|u_{h}^{n+1}-u_{h}^{n}\right\|_{\mathrm{L}^{2}(0,1)}^{2} & \leq \Delta t a\left|\left(\frac{\partial u_{h}^{n}}{\partial x}, u_{h}^{n+1}-u_{h}^{n}\right)\right|+\Delta t a_{0}\left|\left(u_{h}^{n}, u_{h}^{n+1}-u_{h}^{n}\right)\right| \\
& \leq \Delta t\left[a\left\|\frac{\partial u_{h}^{n}}{\partial x}\right\|_{L^{2}(0,1)}+a_{0}\left\|u_{h}^{n}\right\|_{\mathrm{L}^{2}(0,1)}\right]\left\|u_{h}^{n+1}-u_{h}^{n}\right\|_{\mathrm{L}^{2}(0,1)}
\end{aligned}
\end{aligned}
$$

现在使用反不等式\ref{13.43} （指区间$(0,1)$），我们得到

!!!!
\left\|u_{h}^{n+1}-u_{h}^{n}\right\|_{L^{2}(0,1)} \leq \Delta t\left(a C_{I} h^{-1}+a_{0}\right)\left\|u_{h}^{n}\right\|_{L^{2}(0,1)}
$$

最后，\ref{15.6} 变为

!!!!
\begin{aligned}
&\left\|u_{h}^{n+1}\right\|_{\mathrm{L}^{2}(0,1)}^{2}+a \Delta t\left(u_{h}^{n}(1)\right)^{2} \\
&\quad+\Delta t\left[2 a_{0}-\Delta t\left(a C_{I} h^{-1}+a_{0}\right)^{2}\right]\left\|u_{h}^{n}\right\|_{\mathrm{L}^{2}(0,1)}^{2} \leq\left\|u_{h}^{n}\right\|_{\mathrm{L}^{2}(0,1)}^{2}
\end{aligned}
\label{15.7}\end{equation}

如果满足\ref{15.4}，那么$\left\|u_{h}^{n+1}\right\|_{\mathrm{L}^{2}(0,1)} \leq\left\|u_{h}^{n}\right\|_{\mathrm{L}^{2}(0,1)}$，因此我们在$\mathrm{L}^{2}(0,1)$规范中具有强稳定性。

在$a_{0}=0$的情况下，得到的稳定条件是没有意义的。然而，如果我们假设

!!!!
\Delta t \leq \frac{K h^{2}}{a^{2} C_{I}^{2}}
$$

对于一个给定的常数$K>0$，那么我们可以对\ref{15.7} 应用离散Gronwall定理（见定理2.3），我们发现该方法是稳定的，其稳定常数在这种情况下取决于最终时间$T$。确切地说。

!!!!
\left\|u_{h}^{n}\right\|_{\mathrm{L}^{2}(0,1)} \leq \exp \left(K t^{n}\right)\left\|u_{h}^{0}\right\|_{\mathrm{L}^{2}(0,1)} \leq \exp (K T)\left\|u_{h}^{0}\right\|_{\mathrm{L}^{2}(0,1)} \quad \forall n \geq 1
$$

在后退欧拉方法\ref{15.3} 的情况下，我们选择$v_{h}=u_{h}^{n+1}$ 。通过使用关系

!!!!
(v-w, v)=\frac{1}{2}\left(\|v\|_{\mathrm{L}^{2}(0,1)}^{2}-\|w\|_{\mathrm{L}^{2}(0,1)}^{2}+\|v-w\|_{\mathrm{L}^{2}(0,1)}^{2}\right) \forall v, w \in \mathrm{L}^{2}(0,1)
\label{15.8}\end{equation}

其中概括了\ref{14.32} ，我们发现

!!!!
\left(1+2 a_{0} \Delta t\right)\left\|u_{h}^{n+1}\right\|_{\mathrm{L}^{2}(0,1)}^{2}+a \Delta t\left(u_{h}^{n+1}(1)\right)^{2} \leq\left\|u_{h}^{n}\right\|_{\mathrm{L}^{2}(0,1)}^{2}
\label{15.9}\end{equation}

因此，我们在$\mathrm{L}^{2}(0,1)$、所有$\Delta t$和所有$a_{0} \geq 0$都有强稳定性。



\subsubsection{The upwind, Lax-Friedrichs and Lax-Wendroff schemes}

Lax-Friedrichs(LF)、Lax-Wendroff(LW)和逆风(U)有限差分方案在有限元情况下的泛化可以通过不同方式实现。我们首先观察到\ref{14.16} 、\ref{14.18} 和\ref{14.20} 可以被改写成以下综合形式

!!!!
\frac{u_{j}^{n+1}-u_{j}^{n}}{\Delta t}+a \frac{u_{j+1}^{n}-u_{j-1}^{n}}{2 h}-\mu \frac{u_{j+1}^{n}-2 u_{j}^{n}+u_{j-1}^{n}}{h^{2}}+a_{0} u_{j}^{n}=0
\label{15.10}\end{equation}

(但是请注意\ref{14.16}、\ref{14.18}和\ref{14.20}中的$a_{0}=0$。)第二个项是通过中心有限差分对对流项$a u_{x}\left(t^{n}\right)$的离散化，而第三个项是数值扩散项，对应于通过有限差分对$-\mu u_{x x}\left(t^{n}\right)$的离散化。数值粘性系数$\mu$由以下公式给出

!!!!
\mu=\left\{\begin{aligned}
h^{2} / 2 \Delta t &(\mathrm{LF}) \\
a^{2} \Delta t / 2 &(\mathrm{LW}) \\
a h / 2 &(\mathrm{U})
\end{aligned}\right.
\label{15.11}\end{equation}

方程\ref{15.10}建议采用以下有限元版本来逼近问题\ref{14.3}。  $\forall n \geq 0$ ，找到$u_{h}^{n+1} \in V_{h}$，以便于

!!!!
\begin{aligned}
&\frac{1}{\Delta t}\left(u_{h}^{n+1}-u_{h}^{n}, v_{h}\right)+a\left(\frac{\partial u_{h}^{n}}{\partial x}, v_{h}\right)+a_{0}\left(u_{h}^{n}, v_{h}\right) \\
&+\mu\left(\frac{\partial u_{h}^{n}}{\partial x}, \frac{\partial v_{h}}{\partial x}\right)-\mu \gamma \frac{\partial u_{h}^{n}}{\partial x}(1) v_{h}(1)=\left(f^{n}, v_{h}\right) \quad \forall v_{h} \in V_{h}
\end{aligned}
\label{15.12}\end{equation}

其中$\gamma=1,0$取决于我们在对数值粘度项进行分项积分时是否要考虑到边界贡献。

对于稳定性分析，在$\gamma=0, a_{0}=0, a>0$的情况下，让我们设定$v_{h}=u_{h}^{n+1}-u_{h}^{n}$，以获得

!!!!
\left\|u_{h}^{n+1}-u_{h}^{n}\right\|_{\mathrm{L}^{2}(0,1)} \leq \Delta t\left(a+\mu C_{I} h^{-1}\right)\left\|\frac{\partial u_{h}^{n}}{\partial x}\right\|_{\mathrm{L}^{2}(0,1)}
$$

由于不等式\ref{4.52}。现在设定$v_{h}=u_{h}^{n}$，由于\ref{15.5}我们得到

!!!!
\begin{aligned}
&\left\|u_{h}^{n+1}\right\|_{\mathrm{L}^{2}(0,1)}^{2}-\left\|u_{h}^{n}\right\|_{\mathrm{L}^{2}(0,1)}^{2}+a \Delta t\left(u_{h}^{n}(1)\right)^{2}+2 \Delta t \mu\left\|\frac{\partial u_{h}^{n}}{\partial x}\right\|_{\mathrm{L}^{2}(0,1)}^{2} \\
&\qquad=\left\|u_{h}^{n+1}-u_{h}^{n}\right\|_{\mathrm{L}^{2}(0,1)}^{2} \leq \Delta t^{2}\left(a+\mu C_{I} h^{-1}\right)^{2}\left\|\frac{\partial u_{h}^{n}}{\partial x}\right\|_{\mathrm{L}^{2}(0,1)}^{2}
\end{aligned}
$$

因此，强稳定性的充分条件（即获得诸如\ref{14.27}这样的估计，相对于$\left.\|\cdot\|_{L^{2}(0,1)}\right)$而言，是

!!!!
\Delta t \leq \frac{2 \mu}{\left(a+\mu C_{I} h^{-1}\right)^{2}}
$$

由于\ref{15.11} ，在上风法的情况下，这等同于

!!!!
\Delta t \leq \frac{h}{a}\left(\frac{1}{1+C_{I} / 2}\right)^{2}
$$

在线性有限元的情况下，$C_{I} \simeq 2 \sqrt{3}$ ，因此

!!!!
\frac{a \Delta t}{h} \lesssim\left(\frac{1}{1+\sqrt{3}}\right)^{2}
$$

我们刚刚开发的稳定性分析是基于能量方法的，在这种情况下，会导致次优的结果。正如我们在第14.4.3节中所看到的，借助于冯-诺依曼分析可以得到一个更好的指标。为此，我们观察到，在具有恒定间距的线性有限元$h,\ref{15.12}与$f=0$的情况下，对于每个内部节点$x_{j}$可以按以下方式重写。

!!!!
\begin{aligned}
&\frac{1}{6}\left(u_{j+1}^{n+1}+4 u_{j}^{n+1}+u_{j-1}^{n+1}\right)+\frac{\lambda a}{2}\left(u_{j+1}^{n}-u_{j-1}^{n}\right)+\frac{a_{0}}{6} \Delta t\left(u_{j+1}^{n}+4 u_{j}^{n}+u_{j-1}^{n}\right) \\
&-\mu \Delta t \frac{u_{j+1}^{n}-2 u_{j}^{n}+u_{j-1}^{n}}{h^{2}}=\frac{1}{6}\left(u_{j+1}^{n}+4 u_{j}^{n}+u_{j-1}^{n}\right)
\end{aligned}
\label{15.13}\end{equation}

通过比较这种关系和\ref{15.10} ，我们可以注意到，差异只存在于由时间导数和零阶项产生的项中，并且必须归因于在有限元情况下质量矩阵的存在。另一方面，我们在第$13.5$节中看到  $13.5$中看到，我们可以应用质量堆积技术，用一个对角矩阵来近似质量矩阵。通过这种方式进行，方案\ref{15.13}可以有效地减少到\ref{15.10}（见练习1）。

备注 15.1.注意，关系\ref{15.13} 是指内部节点。用有限元方法处理边界条件的方法通常会产生与通过有限差分方法得到的不同的关系。

这些观察使我们能够将第14.3.1节中看到的所有方案扩展到类似的方案，这些方案由连续线性有限元的空间离散产生。为此，只需将术语$u_{j}^{n+1}-u_{j}^{n}$替换为

!!!!
$$

因此，一般方案\ref{14.13} 被替换为

!!!!
\frac{1}{6}\left(u_{j-1}^{n+1}+4 u_{j}^{n+1}+u_{j-1}^{n+1}\right)=\frac{1}{6}\left(u_{j-1}^{n}+4 u_{j}^{n}+u_{j-1}^{n}\right)-\lambda\left(H_{j+1 / 2}^{n *}-H_{j-1 / 2}^{n *}\right)
\label{15.14}\end{equation}

其中

!!!!
H_{j+1 / 2}^{n *}= \begin{cases}H_{j+1 / 2}^{n} & \text { for explicit time-advancing schemes, } \\ H_{j+1 / 2}^{n+1} & \text { for implicit time-advancing schemes. }\end{cases}
$$

请注意，即使我们采用了与显式时间推进方案相对应的数值通量，由于质量矩阵项的存在，所产生的方案也不会再导致对角线系统（事实上，它变成了三对角线系统）。相对于类似的完全有限差分方案而言，使用显式时间推进方案的有限元可能显得很不方便。然而，这样的方案具有有趣的特点。特别是，让我们使用第14.4.3节中说明的冯-诺依曼分析，考虑其放大和分散系数。为此，让我们假设微分方程是在$\mathbb{R}$的所有地方定义的，或者，让我们考虑一个有界区间，并假设其端点的周期性边界条件。在这两种情况下，我们可以假设关系\ref{15.14} 对指数$j$的所有值都成立。通过简单的计算，我们可以写出有限差分方案的放大系数$\gamma_{k}$（见表14.1）和相应的有限元方案的放大系数$\gamma_{k}^{\mathrm{FEM}}$之间的关系如下

!!!!
\gamma_{k}^{\mathrm{FEM}}=\frac{3 \gamma_{k}-1+\cos \left(\phi_{k}\right)}{2+\cos \left(\phi_{k}\right)}
\label{15.15}\end{equation}

其中我们再次用$\phi_{k}$表示相对于$k$-次谐波的相位角（见第14.4.3节）。

因此，我们可以计算出放大和色散误差，在图15.1中报告。将它们与相应的有限差分方案的类似误差（在图14.6中报告）相比较，我们可以做出以下评论。正向欧拉方案仍然是无条件不稳定的（在强稳定性意义上）。如果CFL数小于$\frac{1}{3}$，上风方案（FEM）是强稳定的（因此，比用能量法发现的结果限制性要小），而Lax-Friedrichs（FEM）方法从不满足条件$\gamma_{k}^{F E M} \leq 1$（与我们在这种情况下用能量法发现的结果相一致）。

更一般地说，我们可以说，在有明确时间处理的方案的情况下，"有限元 "版本需要比相应的有限差分版本更严格的稳定性条件。特别是，对于Lax-Wendroff有限元方案，我们将用LW（FEM）表示，现在CFL数必须小于$\frac{1}{\sqrt{3}}$，而不是像有限差分情况下的1。然而，LW（FEM）方案（对于其稳定的CFL值），在相位角$\phi_{k}=k h$的大范围内，其扩散性和分散性比等效的有限差分方案略低。隐式欧拉方案在有限元版本中也保持无条件稳定（与我们在第1节中使用能量法得到的一致。  $15.1 .1)$ .

例15.1。前面的结论在实验中得到了验证，具体如下。我们重复了图$14.7$（右）的情况，现在我们考虑的是CFL值为$0.5$ 。图15.2中报告了通过经典的Lax-Wendroff方法（LW）和通过LW（FEM）对$t=2$得到的数值解。我们可以注意到LW（FEM）方案提供了一个更准确的解决方案，尤其是具有更小的相位误差。这一结果被两种情况下的误差的$\|\cdot\|_{\Delta, 2}$准则值所证实。事实上，通过调用$u$精确解和$u_{L W}$、$u_{L W(F E M)}$这两个数值方案得到的解，$\left\|u_{L W}-u\right\|_{\Delta, 2}=$ $0.78, \quad\left\|u_{L W(F E M)}-u\right\|_{\Delta, 2}=0.49$ 。

在非周期性边界条件下进行的进一步测试证实了之前得出的稳定性特性。
 ![](https://cdn.mathpix.com/cropped/991f5db518e324d299c1ff4972bba9fb-022.jpg?height=592&width=704&top_left_y=116&top_left_x=106)

$\mathrm{mr}

误差LW（FEM

![](https://cdn.mathpix.com/cropped/991f5db518e324d299c1ff4972bba9fb-022.jpg?height=152&width=344&top_left_y=713&top_left_x=107)

![](https://cdn.mathpix.com/cropped/991f5db518e324d299c1ff4972bba9fb-022.jpg?height=150&width=345&top_left_y=847&top_left_x=107)

![](https://cdn.mathpix.com/cropped/991f5db518e324d299c1ff4972bba9fb-022.jpg?height=132&width=243&top_left_y=854&top_left_x=500)


图15.1.几种有限元方案的放大和色散误差，来自于
 ![](https://cdn.mathpix.com/cropped/991f5db518e324d299c1ff4972bba9fb-022.jpg?height=284&width=636&top_left_y=713&top_left_x=107) the general scheme \ref{15.14} 

![](https://cdn.mathpix.com/cropped/991f5db518e324d299c1ff4972bba9fb-023.jpg?height=340&width=398&top_left_y=113&top_left_x=259)

图15.2.通过Lax-Wendroff有限差分方案（LW）和其有限元版本（LW（FEM））得到的解决方案之间的比较  $\left(\phi_{k}=\pi / 4, t=2\right)

\subsection{Taylor-Galerkin schemes}

我们现在说明一类名为 "Taylor-Galerkin "方案的有限元方案。这些方案的推导方式与Lax-Wendroff方案类似，我们将看到LW(FEM)版本确实属于这一类。

为简单起见，我们将提及纯传输问题\ref{14.1} 。Taylor-Galerkin方法包括将Taylor公式截断到一阶的组合

!!!!
u\left(x, t^{n+1}\right)=u\left(x, t^{n}\right)+\Delta t \frac{\partial u}{\partial t}\left(x, t^{n}\right)+\int_{t^{n}}^{t^{n+1}}\left(s-t^{n}\right) \frac{\partial^{2} u}{\partial t^{2}}(x, s) d s
\label{15.16}\end{equation}

与方程\ref{14.1} 。通过对\ref{14.1} 与$t$的关系进行正式微分，我们得到

!!!!
\frac{\partial^{2} u}{\partial t^{2}}=\frac{\partial}{\partial t}\left(-a \frac{\partial u}{\partial x}\right)=-a \frac{\partial}{\partial x} \frac{\partial u}{\partial t}=a^{2} \frac{\partial^{2} u}{\partial x^{2}}
$$

从\ref{15.16} 中，我们得到

!!!!
u\left(x, t^{n+1}\right)=u\left(x, t^{n}\right)-a \Delta t \frac{\partial u}{\partial x}\left(x, t^{n}\right)+a^{2} \int_{t^{n}}^{t^{n+1}}\left(s-t^{n}\right) \frac{\partial^{2} u}{\partial x^{2}}(x, s) d s
\label{15.17}\end{equation}

我们以下列方式对该积分进行近似

!!!!
\int_{t^{n}}^{t^{n+1}}\left(s-t^{n}\right) \frac{\partial^{2} u}{\partial x^{2}}(x, s) d s \approx \frac{\Delta t^{2}}{2}\left[\theta \frac{\partial^{2} u}{\partial x^{2}}\left(x, t^{n}\right)+(1-\theta) \frac{\partial^{2} u}{\partial x^{2}}\left(x, t^{n+1}\right)\right]
\label{15.18}\end{equation}

通过在$s=t^{n}+\frac{\Delta t}{2}$处评估第一个因子，通过$\theta \in[0,1]$和$s=t^{n+1}$处的线性组合（使用$\theta \in[0,1]$作为参数），得到第二个因子的值。我们用$u^{n}(x)$表示近似函数$u\left(x, t^{n}\right)$ 。让我们考虑两种显著的情况。如果$\theta=1$，我们得到一个在时间上明确的半离散化方案

!!!!
u^{n+1}=u^{n}-a \Delta t \frac{\partial u^{n}}{\partial x}+\frac{a^{2} \Delta t^{2}}{2} \frac{\partial^{2} u^{n}}{\partial x^{2}}
$$

如果我们现在用有限差分或有限元进行空间离散，我们就会恢复之前研究的LW和LW（FEM）方案。

相反，如果我们取$\theta=\frac{2}{3}$，\ref{15.18} 中的近似误差变成$O\left(\Delta t^{4}\right)$（假设$u$具有所需的规律性）。事实上，这种选择相当于在$t^{n}$和$t^{n+1}$之间用其线性插值来逼近$\frac{\partial^{2} u}{\partial x^{2}}$。由此产生的半微分化方案被写为

!!!!
\left[1-\frac{a^{2} \Delta t^{2}}{6} \frac{\partial^{2}}{\partial x^{2}}\right] u^{n+1}=u^{n}-a \Delta t \frac{\partial u^{n}}{\partial x}+\frac{a^{2} \Delta t^{2}}{3} \frac{\partial^{2} u^{n}}{\partial x^{2}}
\label{15.19}\end{equation}

其在时间上的截断误差为 $\mathscr{O}\left(\Delta t^{3}\right)$ 。

在这一点上，使用有限元方法进行空间离散化导致了以下方案，称为泰勒-加勒金（TG）。

为$n=0,1, \ldots$找到$u_{h}^{n+1} \in V_{h}$，以便于

!!!!
\begin{aligned}
A\left(u_{h}^{n+1}, v_{h}\right)=&\left(u_{h}^{n}, v_{h}\right)-a \Delta t\left(\frac{\partial u_{h}^{n}}{\partial x}, v_{h}\right)-\frac{a^{2} \Delta t^{2}}{3}\left(\frac{\partial u_{h}^{n}}{\partial x}, \frac{\partial v_{h}}{\partial x}\right) \\
&+\gamma \frac{a^{2} \Delta t^{2}}{3} \frac{\partial u_{h}^{n}}{\partial x}(1) v_{h}(1) \quad \forall v_{h} \in V_{h}
\end{aligned}
\label{15.20}\end{equation}

其中

!!!!
A\left(u_{h}^{n+1}, v_{h}\right)=\left(u_{h}^{n+1}, v_{h}\right)+\frac{a^{2} \Delta t^{2}}{6}\left(\frac{\partial u_{h}^{n+1}}{\partial x}, \frac{\partial v_{h}}{\partial x}\right)-\gamma \frac{a^{2} \Delta t^{2}}{6} \frac{\partial u_{h}^{n+1}}{\partial x}(1) v_{h}(1)
$$

和$\gamma=1,0$，取决于我们在对二阶导数进行分项积分时是否要考虑边界贡献。

后者产生了一个线性系统，其矩阵为

!!!!
\mathrm{A}=\mathrm{M}+\frac{a^{2}(\Delta t)^{2}}{6} \mathrm{~K}
$$

$\mathrm{M}$是质量矩阵，$\mathrm{K}$是刚度矩阵，可能还会考虑到边界贡献（如果$\gamma=1$）。

在线性有限元的情况下，冯-诺伊曼分析导致以下$k$-个方案的放大系数\ref{15.20} 。

!!!!
\gamma_{k}=\frac{2+\cos (k h)-2 a^{2} \lambda^{2}(1-\cos (k h))+3 i a \lambda \sin (k h)}{2+\cos (k h)+a^{2} \lambda^{2}(1-\cos (k h))}
\label{15.21}\end{equation}

可以证明该方案在CFL条件下 $\|\cdot\|_{\Delta, 2}$ 是强稳定的 $\frac{a \Delta t}{h} \leq 1$ 。因此，它的稳定性条件比Lax-Wendroff（FEM）的限制性更小
 ![](https://cdn.mathpix.com/cropped/991f5db518e324d299c1ff4972bba9fb-025.jpg?height=426&width=534&top_left_y=115&top_left_x=193)

图15.3.泰勒-加勒金方案\ref{15.20} 的放大（上）和色散（下）误差，作为相位角$\phi_{k}=k h$的函数和不同的CFL数的值

计划。

图$15.3$显示了方案\ref{15.20} 的放大和色散误差的行为，作为相位角的函数，与我们在第14.4.4节看到的其他方案相类似。

在线性有限元的情况下，TG方案的截断误差为 $\mathscr{O}\left(\Delta t^{3}\right)+\mathscr{O}\left(h^{2}\right)+\mathscr{O}\left(h^{2} \Delta t\right)$ 。

例15.2.为了比较上两节介绍的方案的准确性，我们考虑了以下问题

!!!!
\begin{cases}\frac{\partial u}{\partial t}+\frac{\partial u}{\partial x}=0, & x \in(0,0.5), t>0 \\ u(x, 0)=u_{0}(x), & x \in(0,0.5)\end{cases}
$$

具有周期性边界条件，$u(0, t)=u(0.5, t)$ ，为$t>0$ 。初始基准是$u_{0}(x)=2 \cos (4 \pi x)+\sin (20 \pi x)$，如图$15.4$（左）所示。后者叠加了两个谐波，一个是低频的，一个是高频的。

我们考虑了Taylor-Galerkin、Lax-Wendroff（FEM）、（有限差分）Lax-Wendroff和upwind方案。在图15.4（右）中，我们显示了在时间$\left\|u-u_{h}\right\|_{\Delta, 2}$下，不同的$\Delta t$值和固定的CFL数$0.55$下得到的离散准则的误差。我们可以注意到Taylor-Galerkin方案有更好的收敛性，而Lax-Wendroff方案的两个版本显示出相同的收敛顺序，但有限元版本的误差更小。上风向
 ![](https://cdn.mathpix.com/cropped/991f5db518e324d299c1ff4972bba9fb-026.jpg?height=286&width=718&top_left_y=117&top_left_x=98)

图15.4.例子$15.2$模拟的初始条件$u_{0}$（左）和不同数值方案下变化$\Delta t$和固定CFL的$\left\|u-u_{h}\right\|_{\Delta, 2}$的误差（右）。

方案的精度较低：它的特点是绝对误差较大，收敛率较低。此外，可以验证的是，对于一个固定的CFL，上风方案的误差是$\mathscr{O}(\Delta t)$，Lax-Wendroff方案的两个变体的误差是$\mathscr{O}\left(\Delta t^{2}\right)$，而Taylor-Galerkin方案的误差是$\mathscr{O}\left(\Delta t^{3}\right)$。

我们在图$15.5$和$15.6$中报告了传输问题的数值近似值和相应的最大规范误差。

!!!!
\begin{cases}\frac{\partial u}{\partial t}-\frac{\partial u}{\partial x}=0, & x \in(0,2 \pi), t>0 \\ u(x, 0)=\sin (\pi \cos (x)), & x \in(0,2 \pi)\end{cases}
$$

具有周期性边界条件。这种近似是通过2阶和4阶的有限差分（ufd2，ufd4），4阶和6阶的紧凑有限差分（ucp4，ucp6），以及带有傅里叶基的Galerkin谱法（ugal）得到的。为了便于比较，我们还报告了精确解$u(x, t)=\sin (\pi \cos (x+t))$（uex）。

![](https://cdn.mathpix.com/cropped/991f5db518e324d299c1ff4972bba9fb-026.jpg?height=233&width=331&top_left_y=917&top_left_x=113)
 ![](https://cdn.mathpix.com/cropped/991f5db518e324d299c1ff4972bba9fb-026.jpg?height=234&width=684&top_left_y=916&top_left_x=113) methods (of order 2,4$)$, compact finite difference methods (of order 4 and 6 ) and with the Fourier Galerkin spectral method (from [CHQZ06]) 

![](https://cdn.mathpix.com/cropped/991f5db518e324d299c1ff4972bba9fb-027.jpg?height=265&width=373&top_left_y=117&top_left_x=276)

图15.6.图$15.5$中报告的不同数值方法的最大规范误差的行为（来自[CHQZ06] ）。

\subsection{The multi-dimensional case}

现在让我们转向多维情况，考虑以下一阶、线性和标量双曲运输-反应问题，在域$\Omega \subset \mathbb{R}^{d}$中，有$d=2,3:$。

!!!!
\begin{cases}\frac{\partial u}{\partial t}+\mathbf{a} \cdot \nabla u+a_{0} u=f, & \mathbf{x} \in \Omega, t>0 \\ u=\varphi, & \mathbf{x} \in \partial \Omega^{i n}, t>0 \\ u_{\mid t=0}=u_{0}, & & \mathbf{x} \in \Omega\end{cases}
\label{15.22}\end{equation}

其中$\mathbf{a}=\mathbf{a}(\mathbf{x}), a_{0}=a_{0}(\mathbf{x}, t)$（可能为零），$f=f(\mathbf{x}, t), \varphi=\varphi(\mathbf{x}, t)$和$u_{0}=u_{0}(\mathbf{x})$为给定函数。流入边界$\partial \Omega^{\text {in }}$的定义为

!!!!
\partial \Omega^{i n}=\{\mathbf{x} \in \partial \Omega: \mathbf{a}(\mathbf{x}) \cdot \mathbf{n}(\mathbf{x})<0\}
\label{15.23}\end{equation}

n是对$\partial \Omega$的外向单位法向量。

为了简单起见，我们假设a不依赖于$t$；这样，流入边界$\partial \Omega^{\text {in }}$就不会随时间变化。

\subsubsection{Semi-discretization: strong and weak treatment of the boundary conditions}

为了得到问题\ref{15.22} 的半离散近似，类似于在一维情况下使用的\ref{15.1} ，我们定义空间

!!!!
V_{h}=X_{h}^{r}, \quad V_{h}^{i n}=\left\{v_{h} \in V_{h}: v_{h \mid} \partial \Omega^{i n}=0\right\},
$$

其中$r$是一个整数$\geq 1$，$X_{h}^{r}$是在\ref{4.38}中引入的。我们用$u_{0, h}$和$\varphi_{h}$分别表示$u_{0}$和$\varphi$的两个合适的有限元近似值，我们考虑问题：对于每个$t>0$找到$u_{h}(t) \in V_{h}$，以便

!!!!
\left\{\begin{array}{l}
\int_{\Omega} \frac{\partial u_{h}(t)}{\partial t} v_{h} d \Omega+\int_{\Omega} \mathbf{a} \cdot \nabla u_{h}(t) v_{h} d \Omega+\int_{\Omega} a_{0}(t) u_{h}(t) v_{h} d \Omega \\
=\int_{\Omega} f(t) v_{h} d \Omega \quad \forall v_{h} \in V_{h}^{i n} \\
u_{h}(t)=\varphi_{h}(t) \quad \text { on } \partial \Omega^{i n}
\end{array}\right.
\label{15.24}\end{equation}

与 $u_{h}(0)=u_{0, h} \in V_{h}$ 。

为了获得稳定性估计，我们为简单起见，假设$\varphi$，以及$\varphi_{h}$，是完全无效的。在这种情况下，$u_{h}(t) \in V_{h}^{i n}$，并对每一个$t, v_{h}=u_{h}(t)$，我们有以下不等式

!!!!
\begin{aligned}
\left\|u_{h}(t)\right\|_{\mathrm{L}^{2}(\Omega)}^{2} &+\int_{0}^{t} \mu_{0}\left\|u_{h}(\tau)\right\|_{\mathrm{L}^{2}(\Omega)}^{2} d \tau+\int_{0}^{t} \int_{\partial \Omega \backslash \partial \Omega^{i n}} \mathbf{a} \cdot \mathbf{n} u_{h}^{2}(\tau) d \gamma d \tau \\
& \leq\left\|u_{0, h}\right\|_{\mathrm{L}^{2}(\Omega)}^{2}+\int_{0}^{t} \frac{1}{\mu_{0}}\|f(\tau)\|_{\mathrm{L}^{2}(\Omega)}^{2} d \tau
\end{aligned}
\label{15.25}\end{equation}

我们假设存在一个正常数$\mu_{0}$，这样，对于所有的$t>0$和$\Omega$中的每个$\mathbf{x}$,

!!!!
0<\mu_{0} \leq \mu(\mathbf{x}, t)=a_{0}(\mathbf{x}, t)-\frac{1}{2} \operatorname{diva}(\mathbf{x})
\label{15.26}\end{equation}

在这种假设没有得到验证的情况下（例如，如果$\mathbf{a}$是一个常数场和$a_{0}=0$），那么通过使用格隆沃尔定理$2.2$我们可以得到

!!!!
\begin{aligned}
&\left\|u_{h}(t)\right\|_{\mathrm{L}^{2}(\Omega)}^{2}+\int_{0}^{t} \int_{\partial \Omega \backslash \partial \Omega^{i n}} \mathbf{a} \cdot \mathbf{n} u_{h}^{2}(\tau) d \gamma d \tau \\
&\leq\left(\left\|u_{0, h}\right\|_{\mathrm{L}^{2}(\Omega)}^{2}+\int_{0}^{t}\|f(\tau)\|_{\mathrm{L}^{2}(\Omega)}^{2} d \tau\right) \exp \int_{0}^{t}\left[1+2 \mu^{*}(\tau)\right] d \tau
\end{aligned}
\label{15.27}\end{equation}

其中我们设置了$\mu^{*}(t)=\max _{\mathbf{x} \in \bar{\Omega}}|\mu(\mathbf{x}, t)|$ 。

为简单起见，假设$f=0$ ，如果$u_{0} \in H^{r+1}(\Omega)$我们有以下收敛结果

!!!!
\begin{aligned}
\max _{t \in[0, T]}\left\|u(t)-u_{h}(t)\right\|_{L^{2}(\Omega)} &+\left(\int_{0}^{T} \int_{\partial \Omega}|\mathbf{a} \cdot \mathbf{n}|\left|u(t)-u_{h}(t)\right|^{2} d \gamma d t\right)^{1 / 2} \\
& \leq C h^{r}\left\|u_{0}\right\|_{\mathrm{H}^{r+1}(\Omega)}
\end{aligned}
$$

关于证明，我们参考[QV94，第14章]，[Joh87]和其中引用的参考文献。在问题\ref{15.24}中，边界条件是以强（或基本）方式施加的。另一种选择是弱的（或自然的）处理，它来自于\ref{15.24}中第一个方程中传输项的部分积分，我们现在考虑$v_{h} \in V_{h}$（即我们不再要求测试函数在流入边界上为空）。我们得到

!!!!
\begin{aligned}
\left.\int_{\Omega} \frac{\partial u_{h}(t)}{\partial t} v_{h} d \Omega-\int_{\Omega} \operatorname{div}\left(\mathbf{a} v_{h}\right)\right) u_{h}(t) d \Omega \\
&+\int_{\Omega} a_{0} u_{h}(t) v_{h} d \Omega+\int_{\partial \Omega} \mathbf{a} \cdot \mathbf{n} u_{h}(t) v_{h} d \gamma=\int_{\Omega} f(t) v_{h} d \Omega
\end{aligned}
$$

边界条件是通过将$u_{h}$替换为$\varphi_{h}$施加在流入的边界部分，得到

!!!!
\begin{gathered}
\int_{\Omega} \frac{\partial u_{h}(t)}{\partial t} v_{h} d \Omega-\int_{\Omega} \operatorname{div}\left(\mathbf{a} v_{h}\right) u_{h}(t) d \Omega+\int_{\Omega} a_{0} u_{h}(t) v_{h} d \Omega+\int_{\partial \Omega \backslash \partial \Omega^{i n}} \mathbf{a} \cdot \mathbf{n} u_{h}(t) v_{h} d \gamma \\
=\int_{\Omega} f(t) v_{h} d \Omega-\int_{\partial \Omega^{i n}} \mathbf{a} \cdot \mathbf{n} \varphi_{h}(t) v_{h} d \gamma \forall v_{h} \in V_{h}
\end{gathered}
\label{15.28}\end{equation}

显然，以这种方式找到的解$u_{h}$只以近似的方式满足边界条件。

另一个选择是通过部分反积分\ref{15.28} ，从而产生以下公式：对于每个$t>0$，找到$u_{h}(t) \in V_{h}$，以便

!!!!
\begin{gathered}
\int_{\Omega} \frac{\partial u_{h}(t)}{\partial t} v_{h} d \Omega+\int_{\Omega} \mathbf{a} \cdot \nabla u_{h}(t) v_{h} d \Omega+\int_{\Omega} a_{0} u_{h}(t) v_{h} d \Omega+\int_{\partial \Omega^{i n}} v_{h}\left(\varphi_{h}(t)-u_{h}(t)\right) \mathbf{a} \cdot \mathbf{n} d \gamma \\
=\int_{\Omega} f(t) v_{h} d \Omega \forall v_{h} \in V_{h}
\end{gathered}
\label{15.29}\end{equation}

我们注意到，公式\ref{15.28} 和\ref{15.29} 是等价的：唯一的区别是强调边界项的方式。特别是，公式\ref{15.29} 中的边界积分可以解释为一个惩罚项，我们用它来评估$u_{h}$与流入边界上的数据$\varphi_{h}$有多大差别。假设假设\ref{15.26} 仍然成立，在\ref{15.29} 中选择了$v_{h}=u_{h}(t)$，通过部分积分对流项，并使用Cauchy-Schwarz和Young不等式，我们得到以下稳定性估计

!!!!
\begin{aligned}
&\left\|u_{h}(t)\right\|_{\mathrm{L}^{2}(\Omega)}^{2}+\int_{0}^{t} \mu_{0}\left\|u_{h}(\tau)\right\|_{\mathrm{L}^{2}(\Omega)}^{2} d \tau+\int_{0}^{t} \int_{\partial \Omega \backslash \partial \Omega^{i n}} \mathbf{a} \cdot \mathbf{n} u_{h}^{2}(\tau) d \gamma d \tau \\
&\leq\left\|u_{0, h}\right\|_{\mathrm{L}^{2}(\Omega)}^{2}+\int_{0}^{t} \int_{\partial \Omega^{i n}}|\mathbf{a} \cdot \mathbf{n}| \varphi_{h}^{2}(\tau) d \gamma d \tau+\int_{0}^{t} \frac{1}{\mu_{0}}\|f(\tau)\|_{\mathrm{L}^{2}(\Omega)}^{2} d \tau
\end{aligned}
\label{15.30}\end{equation}

在没有假设\ref{15.26}的情况下，不等式\ref{15.30}将以类似于我们之前看到的方式发生变化，只要我们使用格隆沃尔定理$2.2$，就像我们推导\ref{15.27}那样。

备注15.2。在问题\ref{15.22}的边界条件采取$\mathbf{a} \cdot \mathbf{n} u=\psi$形式的情况下，我们可以通过添加惩罚项再次弱化它，在这种情况下将采取以下形式

!!!!
\int_{\partial \Omega^{i n}}\left(\psi_{h}(t)-\mathbf{a} \cdot \mathbf{n} u_{h}(t)\right) v_{h} d \gamma
$$

$\psi_{h}$是基准面$\psi$的一个合适的有限元近似值。

除了强加和弱加边界条件，即公式\ref{15.24} 和\ref{15.29} 之外，我们可以采用Petrov-Galerkin方法，在流入边界$u_{h}(t)=\varphi_{h}(t)$上强加条件，在流出边界$\partial \Omega^{\text {out }}$上要求$v_{h}=0$，产生以下离散公式。设$V_{h}^{\text {out }}=\left\{v_{h} \in V_{h}: v_{h \mid} \partial \Omega^{\text {out }}=0\right\}$ 。然后对于每个$t>0$找到$u_{h}(t) \in V_{h}=!!!!X_{h}^{r}$，以便

!!!!
\left\{\begin{aligned}
\int_{\Omega} \frac{\partial u_{h}(t)}{\partial t} v_{h} d \Omega+\int_{\Omega}\left(\mathbf{a} \cdot \nabla u_{h}(t)\right) v_{h} d \Omega+\int_{\Omega} a_{0}(t) u_{h}(t) v_{h} d \Omega \\
=\int_{\Omega} f(t) v_{h} d \Omega \quad \forall v_{h} \in V_{h}^{\text {out }}
\end{aligned}\right.
$$

我们回顾一下，对于Petrov-Galerkin公式来说，良好处理性分析不能再基于Lax-Milgram法则了。

相反，如果以弱的方式提出流入条件，我们会有以下表述。

对于每个$t>0$，找到$u_{h}(t) \in V_{h}=X_{h}^{r}$，这样，对于每个$v_{h} \in V_{h}^{\text {out }}$ 。

!!!!
\begin{aligned}
\int_{\Omega} \frac{\partial u_{h}(t)}{\partial t} v_{h} d \Omega-\int_{\Omega} \operatorname{div}\left(\mathbf{a} v_{h}\right) u_{h}(t) d \Omega+& \int_{\Omega} a_{0}(t) u_{h}(t) v_{h} d \Omega \\
&=\int_{\Omega} f(t) v_{h} d \Omega-\int_{\partial \Omega^{i n}} \mathbf{a} \cdot \mathbf{n} \varphi_{h}(t) v_{h} d \gamma
\end{aligned}
$$

关于进一步的细节，读者可以参考[QV94，第14章]。

\subsubsection{Temporal discretization}

为了说明问题，让我们仅限于考虑Galerkin半离散问题\ref{15.24} 。使用后向欧拉方案进行时间离散化，我们得到以下全离散问题：$\forall n \geq 0$找到$u_{h}^{n+1} \in V_{h}$，以便

!!!!
\left\{\begin{array}{l}
\frac{1}{\Delta t} \int_{\Omega}\left(u_{h}^{n+1}-u_{h}^{n}\right) v_{h} d \Omega+\int_{\Omega} \mathbf{a} \cdot \nabla u_{h}^{n+1} v_{h} d \Omega+\int_{\Omega} a_{0}^{n+1} u_{h}^{n+1} v_{h} d \Omega \\
=\int_{\Omega} f^{n+1} v_{h} d \Omega \quad \forall v_{h} \in V_{h}^{i n} \\
u_{h}^{n+1}=\varphi_{h}^{n+1} \text { on } \partial \Omega^{i n}
\end{array}\right.
$$

其中$u_{h}^{0}=u_{0, h} \in V_{h}$是初始基准$V_{h}$中的一个合适的近似值。

让我们限于同质情况，其中$f=0$和$\varphi_{h}=0$（在这种情况下$u_{h}^{n} \in V_{h}^{\text {in }}$代表每个$n \geq 0$）。设为$v_{h}=u_{h}^{n+1}$，并使用同一性\ref{15.8} 和\ref{15.26} ，我们得到，对于每个$n \geq 0$来说

!!!!
\begin{aligned}
&\frac{1}{2 \Delta t}\left(\left\|u_{h}^{n+1}\right\|_{\mathrm{L}^{2}(\Omega)}^{2}-\left\|u_{h}^{n}\right\|_{\mathrm{L}^{2}(\Omega)}^{2}\right) \\
&+\frac{1}{2} \int_{\partial \Omega \backslash \partial \Omega^{i n}} \mathbf{a} \cdot \mathbf{n}\left(u_{h}^{n+1}\right)^{2} d \gamma+\mu_{0}\left\|u_{h}^{n+1}\right\|_{\mathrm{L}^{2}(\Omega)}^{2} \leq 0
\end{aligned}
$$

对于每个$m \geq 1$，从0到$m-1$的$n$相加，我们得到

!!!!
\begin{aligned}
&\left\|u_{h}^{m}\right\|_{\mathrm{L}^{2}(\Omega)}^{2}+2 \Delta t\left(\mu_{0} \sum_{n=0}^{m}\left\|u_{h}^{n}\right\|_{\mathrm{L}^{2}(\Omega)}^{2}+\frac{1}{2} \sum_{n=0}^{m} \int_{\partial \Omega \backslash \partial \Omega^{i n}} \mathbf{a} \cdot \mathbf{n}\left(u_{h}^{n}\right)^{2} d \gamma\right) \\
&\leq\left\|u_{0, h}\right\|_{\mathrm{L}^{2}(\Omega)}^{2}
\end{aligned}
$$

特别是，由于$\mathbf{a} \cdot \mathbf{n} \geq 0$对$\partial \Omega \backslash \partial \Omega^{i n}$，我们得出结论，即

!!!!
\left\|u_{h}^{m}\right\|_{\mathrm{L}^{2}(\Omega)} \leq\left\|u_{0, h}\right\|_{\mathrm{L}^{2}(\Omega)} \quad \forall m \geq 0
$$

正如预期的那样，这种方法是强稳定的，对$\Delta t$没有条件。我们现在考虑使用正向欧拉方法进行时间离散化

!!!!
\left\{\begin{array}{l}
\frac{1}{\Delta t} \int_{\Omega}\left(u_{h}^{n+1}-u_{h}^{n}\right) v_{h} d \Omega+\int_{\Omega} \mathbf{a} \cdot \nabla u_{h}^{n} v_{h} d \Omega+\int_{\Omega} a_{0}^{n} u_{h}^{n} v_{h} d \Omega \\
=\int_{\Omega} f^{n} v_{h} d \Omega \quad \forall v_{h} \in V_{h}^{i n} \\
u_{h}^{n+1}=\varphi_{h}^{n+1} \text { on } \partial \Omega^{i n}
\end{array}\right.
\label{15.31}\end{equation}

我们再次假设$f=0, \varphi=0$和条件\ref{15.26}被验证。此外，我们假设$\|\mathbf{a}\|_{L^{\infty}(\Omega)}<\infty$，并且对于每个$t>0,\left\|a_{0}\right\|_{L^{\infty}(\Omega)}<\infty$ .设定$v_{h}=u_{h}^{n}$，利用特性\ref{15.5} 并对对流项进行部分积分，我们得到

!!!!
\begin{aligned}
&\frac{1}{2 \Delta t}\left(\left\|u_{h}^{n+1}\right\|_{\mathrm{L}^{2}(\Omega)}^{2}-\left\|u_{h}^{n}\right\|_{\mathrm{L}^{2}(\Omega)}^{2}-\left\|u_{h}^{n+1}-u_{h}^{n}\right\|_{\mathrm{L}^{2}(\Omega)}^{2}\right) \\
&+\frac{1}{2} \int_{\partial \Omega \backslash \partial \Omega^{i n}} \mathbf{a} \cdot \mathbf{n}\left(u_{h}^{n}\right)^{2} d \gamma+\left(-\frac{1}{2} \operatorname{div}(\mathbf{a})+a_{0}^{n},\left(u_{h}^{n}\right)^{2}\right)=0
\end{aligned}
$$

然后，在走了几步之后。

!!!!
\begin{aligned}
\left\|u_{h}^{n+1}\right\|_{\mathrm{L}^{2}(\Omega)}^{2} &+\Delta t \int_{\partial \Omega \backslash \partial \Omega^{i n}} \mathbf{a} \cdot \mathbf{n}\left(u_{h}^{n}\right)^{2} d \gamma+2 \Delta t \mu_{0}\left\|u_{h}^{n}\right\|_{\mathrm{L}^{2}(\Omega)}^{2} \\
& \leq\left\|u_{h}^{n}\right\|_{\mathrm{L}^{2}(\Omega)}^{2}+\left\|u_{h}^{n+1}-u_{h}^{n}\right\|_{\mathrm{L}^{2}(\Omega)}^{2}
\end{aligned}
\label{15.32}\end{equation}

现在有必要控制$\left\|u_{h}^{n+1}-u_{h}^{n}\right\|_{\mathrm{L}^{2}(\Omega)}^{2}$这个词。为此，我们将$v_{h}=!!!!u_{h}^{n+1}-u_{h}^{n}$设为\ref{15.31}，得到

!!!!
\begin{aligned}
&\left\|u_{h}^{n+1}-u_{h}^{n}\right\|_{\mathrm{L}^{2}(\Omega)}^{2}=-\Delta t\left(\mathbf{a} \nabla u_{h}^{n}, u_{h}^{n+1}-u_{h}^{n}\right)-\Delta t\left(a_{0}^{n} u_{h}^{n}, u_{h}^{n+1}-u_{h}^{n}\right) \\
&\leq \Delta t\|\mathbf{a}\|_{\mathrm{L}^{\infty}(\Omega)}\left|\left(\nabla u_{h}^{n}, u_{h}^{n+1}-u_{h}^{n}\right)\right|+\Delta t\left\|a_{0}^{n}\right\|_{\mathrm{L}^{\infty}(\Omega)}\left|\left(u_{h}^{n}, u_{h}^{n+1}-u_{h}^{n}\right)\right| \\
&\leq \Delta t\|\mathbf{a}\|_{\mathrm{L}^{\infty}(\Omega)}\left\|\nabla u_{h}^{n}\right\|_{\mathrm{L}^{2}(\Omega)}\left\|u_{h}^{n+1}-u_{h}^{n}\right\|_{\mathrm{L}^{2}(\Omega)}+ \\
&\Delta t\left\|a_{0}^{n}\right\|_{\mathrm{L}^{\infty}(\Omega)}\left\|u_{h}^{n}\right\|_{\mathrm{L}^{2}(\Omega)}\left\|u_{h}^{n+1}-u_{h}^{n}\right\|_{\mathrm{L}^{2}(\Omega)}
\end{aligned}
$$

使用反不等式\ref{4.52}，我们得到

!!!!
\begin{aligned}
\left\|u_{h}^{n+1}-u_{h}^{n}\right\|_{\mathrm{L}^{2}(\Omega)}^{2} & \leq \Delta t\left(C_{I} h^{-1}\|\mathbf{a}\|_{\mathrm{L}^{\infty}(\Omega)}+\right.\\
&\left.\left\|a_{0}^{n}\right\|_{\mathrm{L}^{\infty}(\Omega)}\right)\left\|u_{h}^{n}\right\|_{\mathrm{L}^{2}(\Omega)}\left\|u_{h}^{n+1}-u_{h}^{n}\right\|_{\mathrm{L}^{2}(\Omega)}
\end{aligned}
$$

然后,进过一些步骤，

!!!!
\left\|u_{h}^{n+1}-u_{h}^{n}\right\|_{\mathrm{L}^{2}(\Omega)} \leq \Delta t\left(C_{I} h^{-1}\|\mathbf{a}\|_{\mathrm{L}^{\infty}(\Omega)}+\left\|a_{0}^{n}\right\|_{\mathrm{L}^{\infty}(\Omega)}\right)\left\|u_{h}^{n}\right\|_{\mathrm{L}^{2}(\Omega)}
\label{15.32}\end{equation}

利用这样的结果来寻找\ref{15.32} 中项的上界，我们有

由于边界条件的假设，$\partial \Omega \backslash \partial \Omega^{\text {in }}$上的积分是正的；因此，如果

!!!!
\Delta t \leq \frac{2 \mu_{0}}{\left(C_{I} h^{-1}\|\mathbf{a}\|_{\mathrm{L}^{\infty}(\Omega)}+\left\|a_{0}^{n}\right\|_{L^{\infty}(\Omega)}\right)^{2}}
\label{15.33}\end{equation}

我们有$\left\|u_{h}^{n+1}\right\|_{\mathrm{L}^{2}(\Omega)} \leq\left\|u_{h}^{n}\right\|_{\mathrm{L}^{2}(\Omega)}$，即该方案是强稳定的。请注意，稳定性条件\ref{15.33}是抛物线型的，类似于\ref{14.31} 中对有限差分离析的情况。

备注15.3。在a为常数且$a_{0}=0$的情况下，我们有$\mu_{0}=0$ ，而稳定条件\ref{15.33} 永远不可能被一个正的$\Delta t$所满足。因此，\ref{15.33}中的结果与我们之前为正向欧拉方案发现的结果并不矛盾。

\subsection{Discontinuous finite elements}

到目前为止所采用的另一种方法是基于使用不连续的有限元，产生不连续的Galerkin方法（简称DG），类似于第12章和$2 n d$节中已经讨论的方法。  $13.9$中处理的$2 n d$阶问题。这种选择的动机是，正如我们以前所观察到的，（甚至是线性）双曲问题的解可能是不连续的。

对于一个给定的$\mathscr{T}_{h}$的网格$\Omega$，不连续有限元的空间为

!!!!
W_{h}=Y_{h}^{r}=\left\{v_{h} \in \mathrm{L}^{2}(\Omega) \mid v_{h \mid K} \in \mathbb{P}_{r}, \forall K \in \mathscr{T}_{h}\right\}
\label{15.34}\end{equation}

即度数小于或等于$r$的分片多项式函数的空间，其中$r \geq 0$，不一定连续穿过有限元界面。

\subsubsection{The one-dimensional upwind DG method}

在一维问题\ref{14.3} 最简单的上风版本中，DG有限元方法有如下形式。  $\forall t>0$ ，找到一个函数$u_{h}=$ $u_{h}(t) \in W_{h}$ ，使得

!!!!
\begin{aligned}
&\int_{\alpha}^{\beta} \frac{\partial u_{h}(t)}{\partial t} v_{h} d x \\
&+\sum_{i=0}^{m-1}\left[\begin{array}{c}
\left.\int_{x_{i}}^{x_{i+1}}\left(a \frac{\partial u_{h}(t)}{\partial x}+a_{0} u_{h}(t)\right) v_{h} d x+a\left(x_{i}\right)\left(u_{h}^{+}(t)-U_{h}^{-}(t)\right)\left(x_{i}\right) v_{h}^{+}\left(x_{i}\right)\right] \\
=\int_{\alpha} f(t) v_{h} d x \quad \forall v_{h} \in W_{h}
\end{array}\right]
\end{aligned}
\label{15.35}\end{equation}

其中我们假设$a(x)$是一个连续函数。我们为每个$t>0$设定了

!!!!
U_{h}^{-}(t)\left(x_{i}\right)= \begin{cases}u_{h}^{-}(t)\left(x_{i}\right), & i=1, \ldots, m-1 \\ \varphi_{h}(t)\left(x_{0}\right)\end{cases}
\label{15.36}\end{equation}

其中$\left\{x_{i}, i=0, \cdots, m\right\}$是节点，$x_{0}=\alpha, x_{m}=\beta, h$是两个连续节点之间的最大距离，$v_{h}^{+}\left(x_{i}\right)$表示$v_{h}$在$x_{i}, v_{h}^{-}\left(x_{i}\right)$左侧的右边极限。为了简化符号，$u_{h}$和$f$对$t$的依赖性在不产生歧义的情况下往往会被理解。

现在我们推导出\ref{15.35} 的解$u_{h}$的稳定性估计，为简单起见，假设强迫项$f$是相同的空。然后在\ref{15.35} 中选择$v_{h}=u_{h}$，我们有（设定$\Omega=(\alpha, \beta)$ )

!!!!
\begin{aligned}
&\frac{1}{2} \frac{d}{d t}\left\|u_{h}\right\|_{\mathrm{L}^{2}(\Omega)}^{2}+ \\
&\sum_{i=0}^{m-1}\left[\int_{x_{i}}^{x_{i+1}}\left(\frac{a}{2} \frac{\partial}{\partial x}\left(u_{h}\right)^{2}+a_{0} u_{h}^{2}\right) d x+a\left(x_{i}\right)\left(u_{h}^{+}-U_{h}^{-}\right)\left(x_{i}\right) u_{h}^{+}\left(x_{i}\right)\right]=0 .
\end{aligned}
$$

现在，通过部分整合对流项，我们有

!!!!
\begin{aligned}
&\frac{1}{2} \frac{d}{d t}\left\|u_{h}\right\|_{\mathrm{L}^{2}(\Omega)}^{2}+\sum_{i=0}^{m-1} \int_{x_{i}}^{x_{i+1}}\left(a_{0}-\frac{\partial}{\partial x}\left(\frac{a}{2}\right)\right) u_{h}^{2} d x+ \\
&\sum_{i=0}^{m-1}\left[\frac{a}{2}\left(x_{i+1}\right)\left(u_{h}^{-}\left(x_{i+1}\right)\right)^{2}+\frac{a}{2}\left(x_{i}\right)\left(u_{h}^{+}\left(x_{i}\right)\right)^{2}-a\left(x_{i}\right) U_{h}^{-}\left(x_{i}\right) u_{h}^{+}\left(x_{i}\right)\right]=0
\end{aligned}
\label{15.37}\end{equation}

隔离与节点$x_{0}$相关的贡献，并利用定义\ref{15.36} ，我们可以将前述方程中的第二个和改写为

!!!!
\begin{aligned}
& \sum_{i=0}^{m-1}\left[\frac{a}{2}\left(x_{i+1}\right)\left(u_{h}^{-}\left(x_{i+1}\right)\right)^{2}+\frac{a}{2}\left(x_{i}\right)\left(u_{h}^{+}\left(x_{i}\right)\right)^{2}-a\left(x_{i}\right) U_{h}^{-}\left(x_{i}\right) u_{h}^{+}\left(x_{i}\right)\right] \\
=& \frac{a}{2}\left(x_{0}\right)\left(u_{h}^{+}\left(x_{0}\right)\right)^{2}-a\left(x_{0}\right) \varphi_{h}\left(x_{0}\right) u_{h}^{+}\left(x_{0}\right)+\frac{a}{2}\left(x_{m}\right)\left(u_{h}^{-}\left(x_{m}\right)\right)^{2}+\\
& \sum_{i=1}^{m-1}\left[\frac{a}{2}\left(x_{i}\right)\left(\left(u_{h}^{-}\left(x_{i}\right)\right)^{2}+\left(u_{h}^{+}\left(x_{i}\right)\right)^{2}\right)-a\left(x_{i}\right) u_{h}^{-}\left(x_{i}\right) u_{h}^{+}\left(x_{i}\right)\right] \\
=& \frac{a}{2}\left(x_{0}\right)\left(u_{h}^{+}\left(x_{0}\right)\right)^{2}-a\left(x_{0}\right) \varphi_{h}\left(x_{0}\right) u_{h}^{+}(\alpha)+\\
& \frac{a}{2}\left(x_{m}\right)\left(u_{h}^{-}\left(x_{m}\right)\right)^{2}+\sum_{i=1}^{m-1} \frac{a}{2}\left(x_{i}\right)\left[u_{h}\left(x_{i}\right)\right]^{2}
\end{aligned}
\label{15.38}\end{equation}

用$\left[u_{h}\left(x_{i}\right)\right]=u_{h}^{+}\left(x_{i}\right)-u_{h}^{-}\left(x_{i}\right)$表示函数$u_{h}$在节点$x_{i}$的跳跃。我们现在假设，类似于多维的情况（见\ref{15.26}，即

!!!!
\exists \gamma \geq 0 \text { suchthat } a_{0}-\frac{\partial}{\partial x}\left(\frac{a}{2}\right) \geq \gamma
\label{15.39}\end{equation}

回到\ref{15.37} ，使用关系式\ref{15.38} 和考奇-施瓦茨和杨氏不等式，我们有

!!!!
\begin{aligned}
&\frac{1}{2} \frac{d}{d t}\left\|u_{h}\right\|_{\mathrm{L}^{2}(\Omega)}^{2}+\gamma\left\|u_{h}\right\|_{\mathrm{L}^{2}(\Omega)}^{2}+\sum_{i=1}^{m-1} \frac{a}{2}\left(x_{i}\right)\left[u_{h}\left(x_{i}\right)\right]^{2}+\frac{a}{2}\left(x_{0}\right)\left(u_{h}^{+}\left(x_{0}\right)\right)^{2}+ \\
&\frac{a}{2}\left(x_{m}\right)\left(u_{h}^{-}\left(x_{m}\right)\right)^{2}=a\left(x_{0}\right) \varphi_{h}\left(x_{0}\right) u_{h}^{+}\left(x_{0}\right) \leq \frac{a}{2}\left(x_{0}\right) \varphi_{h}^{2}\left(x_{0}\right)+\frac{a}{2}\left(x_{0}\right)\left(u_{h}^{+}\left(x_{0}\right)\right)^{2}
\end{aligned}
$$

也就是说，对时间也进行积分，$\forall t>0$ 。

!!!!
\begin{gathered}
\left\|u_{h}(t)\right\|_{\mathrm{L}^{2}(\Omega)}^{2}+2 \gamma \int_{0}^{t}\left\|u_{h}(t)\right\|_{\mathrm{L}^{2}(\Omega)}^{2} d t+\sum_{i=1}^{m-1} a\left(x_{i}\right) \int_{0}^{t}\left[u_{h}\left(x_{i}, t\right)\right]^{2} d t+ \\
a\left(x_{m}\right)\left(u_{h}^{-}\left(x_{m}\right)\right)^{2} \leq\left\|u_{0, h}\right\|_{\mathrm{L}^{2}(\Omega)}^{2}+a\left(x_{0}\right) \int_{0}^{t} \varphi_{h}^{2}\left(x_{0}, t\right) d t
\end{gathered}
\label{15.40}\end{equation}

这样的估计代表了理想的稳定性结果。

请注意，如果强迫项不再是空的，我们可以通过适当地使用Gronwall Lemma $2.2$来处理$f$的贡献，来复制先前的分析。这将导致类似于\ref{15.40}的估计，然而这一次不等式的右侧将成为

!!!!
e^{t}\left(\left\|u_{0, h}\right\|_{\mathrm{L}^{2}(\Omega)}^{2}+a\left(x_{0}\right) \int_{0}^{t} \varphi_{h}^{2}\left(x_{0}, t\right) d t+\int_{0}^{t}(f(\tau))^{2} d \tau\right)
\label{15.41}\end{equation}

在不等式\ref{15.39} 中的常数$\gamma$是严格的正数的情况下，我们可以避免使用Gronwall法则，而获得诸如\ref{15.40}的估计，其中第一项$2 \gamma$被$\gamma$取代，而第二项采取\ref{15.41}的形式，没有指数$e^{t}$ 。

由于测试函数的不连续性，\ref{15.35} 可以用等价的方式改写如下， $\forall i=0, \ldots, m-1$ 。

!!!!
\begin{aligned}
&\int_{x_{i}}^{x_{i+1}}\left(\frac{\partial u_{h}}{\partial t}+a \frac{\partial u_{h}}{\partial x}+a_{0} u_{h}\right) v_{h} d x+a\left(u_{h}^{+}-U_{h}^{-}\right)\left(x_{i}\right) v_{h}^{+}\left(x_{i}\right) \\
&\quad=\int_{x_{i}} f v_{h} d x \quad \forall v_{h} \in \mathbb{P}_{r}\left(I_{i}\right)
\end{aligned}
\label{15.42}\end{equation}

与 $I_{i}=\left[x_{i}, x_{i+1}\right]$ 。换句话说，通过不连续有限元的近似产生了元素间的 "独立 "关系；连接一个元素和它的邻居的唯一项是跳跃项$\left(u_{h}^{+}-U_{h}^{-}\right)$，也可以解释为被检查元素的流入边界上的边界基准的归属。

然后我们有一组小问题要在每个元素中解决，准确地说，是每个区间$r+1$的方程$\left[x_{i}, x_{i+1}\right]$ 。让我们把它们以紧凑的形式写成

!!!!
M_{h} \dot{\mathbf{u}}_{h}(t)+L_{h} \mathbf{u}_{h}(t)=\mathbf{f}_{h}(t) \quad \forall t>0, \quad \mathbf{u}_{h}(0)=\mathbf{u}_{0, h}
\label{15.43}\end{equation}

$M_{h}$是质量矩阵，$L_{h}$是与双线性形式和跳跃关系有关的矩阵，$\mathbf{f}_{h}$是源项。

!!!!
\begin{aligned}
\left(M_{h}\right)_{p q}=\int_{x_{i}}^{x_{i+1}} \varphi_{p} \varphi_{q} d x, \quad\left(L_{h}\right)_{p q}=\int_{x_{i}}^{x_{i+1}}\left(a \varphi_{q, x}+a_{0} \varphi_{q}\right) \varphi_{p} d x+\left(a \varphi_{q} \varphi_{p}\right)\left(x_{i}\right) \\
&\left(\mathbf{f}_{h}\right)_{p}=\int_{x_{i}}^{x_{i+1}} f \varphi_{p} d x+a U_{h}^{-}\left(x_{i}\right) \varphi_{p}\left(x_{i}\right), \quad p, q=0, \ldots, r
\end{aligned}
$$

我们用$\left\{\varphi_{q}, q=0, \ldots, r\right\}$表示$\mathbb{P}_{r}\left(\left[x_{i}, x_{i+1}\right]\right)$的基础，用$\mathbf{u}_{h}(t)$表示$\left.u_{h}(x, t)\right|_{\left[x_{i}, x_{i+1}\right]}$在基础$\left\{\varphi_{q}\right\}$上的系数。如果我们采用拉格朗日基，我们将得到，例如，图中报告的函数$15.7$（对于$r=0, r=1$和$r=2$），$\left\{\mathbf{u}_{h}(t)\right\}$的值是$u_{h}(t)$在节点$\left(x_{i+1 / 2}\right.$对$r=0, x_{i}$ 和$x_{i+1}$对

![](https://cdn.mathpix.com/cropped/991f5db518e324d299c1ff4972bba9fb-036.jpg?height=149&width=715&top_left_y=116&top_left_x=99)

图15.7.$r=0, r=1$和$r=2$的拉格朗日基数

$r=1, x_{i}, x_{i+1 / 2}$和$x_{i+1}$为$r=2$）。)请注意，所有以前的函数在区间$\left[x_{i}, x_{i+1}\right]$外都是相同的空。此外，在不连续的有限元的情况下，完全可以使用度数为$r=0$的多项式，在这种情况下，传输项$a \frac{\partial u_{h}}{\partial x}$将在每个元素上提供一个空贡献。

为了实现质量矩阵的对角化，使用Legendre多项式$\mathbb{P}_{r}\left(\left[x_{i}, x_{i+1}\right]\right)$作为$\varphi_{q}(x)=L_{q}\left(2\left(x-x_{i}\right) / h_{i}\right), h_{i}=x_{i+1}-x_{i}$的基础可能会很有趣。该族$\left\{L_{q}, q=0,1, \ldots\right\}$是定义在区间$[-1,1]$上的正交Legendre多项式，我们在第10.2.2节中已经介绍过。事实上，以这种方式我们可以得到$\left(M_{h}\right)_{p q}=\frac{h_{i}}{2 p+1} \delta_{p q}, p, q=0, \ldots r$ 。显然，在这种情况下，未知值$\left\{\mathbf{u}_{h}(t)\right\}$不能解释为$u_{h}(t)$的节点值，而是解释为$u_{h}(t)$在新基础上的扩展的Legendre系数。

当我们使用显式时间推进方案（例如第16章介绍的二阶和三阶RungeKutta方案）时，质量矩阵的对角化就变得特别有趣。在这种情况下，的确，我们将有一个完全显式的问题要在每个小区间内解决。

为了说明问题，我们在下文中介绍了一些针对问题的数值结果

!!!!
\begin{cases}\frac{\partial u}{\partial t}+\frac{\partial u}{\partial x}=0, & x \in(-5,5), t>0 \\ u(-5, t)=0, & t>0\end{cases}
\label{15.44}\end{equation}

使用初始条件

!!!!
u(x, 0)= \begin{cases}\sin (\pi x), & x \in(-2,2) \\ 0 & \text { otherwise }\end{cases}
\label{15.45}\end{equation}

该问题使用线性有限元进行空间离散，包括连续的和不连续的。对于时间离散化，我们在两种情况下都使用了后向欧拉方案。我们选择了$h=0.25$和时间步长$\Delta t=h$；对于$h$这个值，与正弦波相关的相位数是$\phi_{k}=\pi / 2$。

在图$15.8$中，我们报告了时间$t=1$的数值解，以及相应的精确解。该方案具有很强的数值扩散性，但在连续元素的情况下，也有接近尾声的小振荡。此外，我们可以观察到，使用不连续有限元得到的数值解，尽管是不连续的，但在接近尾声时不再具有振荡行为。
 ![](https://cdn.mathpix.com/cropped/991f5db518e324d299c1ff4972bba9fb-037.jpg?height=266&width=704&top_left_y=128&top_left_x=108)

图15.8.问题\ref{15.44} 的时间$t=1$与$\phi_{k}=\pi / 2, h=0.25$的解，使用连续（左）和不连续（右）线性有限元和后向欧拉时间离散化得到。

现在让我们考虑以下问题

!!!!
\begin{cases}\frac{\partial u}{\partial t}+\frac{\partial u}{\partial x}=0, & x \in(0,1), t>0 \\ u(0, t)=1, & t>0 \\ u(x, 0)=0, & x \in[0,1]\end{cases}
\label{15.46}\end{equation}

它代表了进入领域的不连续的传输。我们考虑了连续线性有限元，对边界条件进行了强处理和弱处理，以及不连续线性有限元。这一次，我们也使用了后向欧拉方法来进行时间离散化。网格大小为$h=0.025$ ，时间步长为$\Delta t=h$ 。

时间$t=0.5$的结果在图15.9中表示。我们可以注意到Dirichlet基准如何被弱边界处理的方案很好地表现出来。为此，对于弱边界处理的连续有限元的情况，我们计算了$\left|u_{h}(0)-u(0)\right|$对于$t=0.1$的几个值的行为，$h$是常数。我们可以注意到关于$h$的线性收敛到零。

\subsubsection{The multi-dimensional case}

现在让我们考虑多维的情况\ref{15.22} 。让$W_{h}$成为\ref{15.34}中介绍的每个元素$K \in \mathscr{T}_{h}$上度数为$r$的不连续分片多项式的空间。问题\ref{15.22}的不连续Galerkin(DG)有限元半微分化为：对于每个$t>0$，找到$u_{h}(t) \in W_{h}$，使得

!!!!
\begin{aligned}
&\int_{\Omega} \frac{\partial u_{h}(t)}{\partial t} v_{h} d \Omega+\sum_{K \in \mathscr{T}_{h}}\left[a_{K}\left(u_{h}(t), v_{h}\right)-\int_{\partial K^{i n}} \mathbf{a} \cdot \mathbf{n}_{K}\left[u_{h}(t)\right] v_{h}^{+} d \gamma\right] \\
&=\int_{\Omega} f(t) v_{h} d \Omega \quad \forall v_{h} \in W_{h}
\end{aligned}
\label{15.47}\end{equation}


![](https://cdn.mathpix.com/cropped/991f5db518e324d299c1ff4972bba9fb-038.jpg?height=530&width=666&top_left_y=126&top_left_x=122)

图15.9.对$t=0.5$与$h=0.025$的问题\ref{15.46} 的解决方案，使用连续线性有限元和边界Dirichlet条件的强（左上）和弱（右上）处理，而空间的不连续元素已被使用（左下）。最后，我们展示了（左下）$\left|u_{h}(0)-u(0)\right|$作为$h$的函数，在弱处理狄里奇条件下的行为

与$u_{h}(0)=u_{0, h}$，其中$\mathbf{n}_{K}$表示$\partial K$上的外向单位法向量，并且

!!!!
\partial K^{i n}=\left\{\mathbf{x} \in \partial K: \mathbf{a}(\mathbf{x}) \cdot \mathbf{n}_{K}(\mathbf{x})<0\right\}
$$

双线性形式$a_{K}$以如下方式定义

!!!!
a_{K}(u, v)=\int_{K}\left(\mathbf{a} \cdot \nabla u v+a_{0} u v\right) d \mathbf{x}
$$

而

!!!!
\left[u_{h}(\mathbf{x})\right]= \begin{cases}u_{h}^{+}(\mathbf{x})-u_{h}^{-}(\mathbf{x}), & \mathbf{x} \notin \partial \Omega^{i n} \\ u_{h}^{+}(\mathbf{x})-\varphi_{h}(\mathbf{x}), & \mathbf{x} \in \partial \Omega^{i n}\end{cases}
$$

$\partial \Omega^{i n}$是流入的边界\ref{15.23} ，并且有

!!!!
u_{h}^{\pm}(\mathbf{x})=\lim _{s \rightarrow 0^{\pm}} u_{h}(\mathbf{x}+s \mathbf{a}), \quad \mathbf{x} \in \partial K
$$

对于每个$t>0$，对问题\ref{15.47}得到的稳定性估计是（由于假设\ref{15.26}）。

!!!!
\begin{aligned}
\left\|u_{h}(t)\right\|_{\mathrm{L}^{2}(\Omega)}^{2} &+\int_{0}^{t}\left(\mu_{0}\left\|u_{h}(\tau)\right\|_{\mathrm{L}^{2}(\Omega)}^{2}+\sum_{K \in \mathscr{T}_{h}} \int_{\partial K^{i n}}\left|\mathbf{a} \cdot \mathbf{n}_{K}\right|\left[u_{h}(\tau)\right]^{2}\right) d \tau \\
& \leq C\left[\left\|u_{0, h}\right\|_{\mathrm{L}^{2}(\Omega)}^{2}+\int_{0}^{t}\left(\|f(\tau)\|_{\mathrm{L}^{2}(\Omega)}^{2}+\left|\varphi_{h}\right|_{\mathbf{a}, \partial \Omega^{i n}}^{2}\right) d \tau\right],
\end{aligned}
$$

对$\Gamma$的每个子集$\partial \Omega$的正度量，引入了seminorm

!!!!
|v|_{\mathbf{a}, \Gamma}=\left(\int_{\Gamma}|\mathbf{a} \cdot \mathbf{n}| v^{2} d \gamma\right)^{1 / 2}
$$

为简单起见，假设$f=0, \varphi=0$，以及$u_{0} \in H^{r+1}(\Omega)$，我们可以证明以下先验的误差估计

!!!!
\begin{gathered}
\max _{t \in[0, T]}\left\|u(t)-u_{h}(t)\right\|_{L^{2}(\Omega)}+\left(\int_{0}^{T} \sum_{K \in \mathscr{T}_{h}} \int_{\partial K^{i n}}\left|\mathbf{a} \cdot \mathbf{n}_{K}\right|\left[u(t)-u_{h}(t)\right]^{2} d t\right)^{\frac{1}{2}} \\
\leq C h^{r+1 / 2}\left\|u_{0}\right\|_{\mathrm{H}^{r+1}(\Omega)}
\end{gathered}
\label{15.48}\end{equation}

关于证明，我们参考[QV94，第14章]，[Joh87] ，以及其中引用的参考文献。

\subsubsection{DG method with jump stabilization}

基于不同形式的稳定化，其他的表述也是可能的。让我们考虑一个扩散和反应问题，如\ref{15.22} ，但以守恒形式写出

!!!!
\frac{\partial u}{\partial t}+\operatorname{div}(\mathbf{a} u)+a_{0} u=f, \quad \mathbf{x} \in \Omega, t>0
\label{15.49}\end{equation}

现在已经设定

!!!!
a_{K}\left(u_{h}, v_{h}\right)=\int_{K}\left(-u_{h}\left(\mathbf{a} \cdot \nabla v_{h}\right)+a_{0} u_{h} v_{h}\right) d \mathbf{x}
$$

我们考虑基于DG方法的以下近似方法（见第$12.1$和13.9节）：对于每个$t>0$，找到$u_{h}(t) \in W_{h}$，以便。

!!!!
\begin{aligned}
&\int_{\Omega} \frac{\partial u_{h}(t)}{\partial t} v_{h} d \Omega+\sum_{K \in \mathscr{T}_{h}} a_{K}\left(u_{h}(t), v_{h}\right)+\sum_{e \not \subset \partial \Omega^{i n}} \int_{e}\left\{\left\{\mathbf{a} u_{h}(t)\right\}\left[v_{h}\right] d \gamma\right. \\
&+\sum_{e \not \subset \partial \Omega} \int_{e} c_{e}\left[u_{h}(t)\right]\left[v_{h}\right] d \gamma \\
&=\int_{\Omega} f(t) v_{h} d \Omega-\sum_{e \subset \partial \Omega^{i n}} \int(\mathbf{a} \cdot \mathbf{n}) \varphi_{h}(t) v_{h} d \gamma \quad \forall v_{h} \in W_{h}
\end{aligned}
\label{15.50}\end{equation}

符号如下：我们用$e$表示网格$\mathscr{T}_{h}$的任何一边，由两个三角形共享，例如$K_{1}$和$K_{2}$ 。对于每个标量函数$\psi$，在网格上是片状规则的，有$\psi^{i}=\left.\psi\right|_{K_{i}}$，我们对其在$e$上的跳跃定义如下。

!!!!
[\psi]=\psi^{1} \mathbf{n}_{1}+\psi^{2} \mathbf{n}_{2}
$$

$\mathbf{n}_{i}$是元素$K_{i}$的外向单位法线。相反，如果$\sigma$是一个矢量函数，那么它在$e$上的平均值被定义为

!!!!
\{\sigma\}\}=\frac{1}{2}\left(\sigma^{1}+\sigma^{2}\right) .
$$

请注意，标量函数$[\psi]$到$e$的跳变是一个与$e$的法线平行的矢量。

这些定义并不取决于元素的排序。

如果$e$是属于边界$\partial \Omega$的一面，那么

!!!!
[\psi]=\psi \mathbf{n}, \quad \begin{cases}{\|} \boldsymbol{\sigma}\}=\boldsymbol{\sigma}\end{cases}
$$

关于$c_{e}$，这是一个非负函数，通常会被选择为每一侧的常数。例如，在每个内侧选择$c_{e}=|\mathbf{a} \cdot \mathbf{n}| / 2$，在$\partial \Omega^{\text {in }}, c_{e}=\mathbf{a} \cdot \mathbf{n} / 2$上选择$\partial \Omega^{\text {out }}$，\ref{15.50}中的表述被简化为标准的上风表述

!!!!
\begin{aligned}
&\int_{\Omega} \frac{\partial u_{h}(t)}{\partial t} v_{h} d \Omega+\sum_{K \in \mathscr{T} h} a_{K}\left(u_{h}(t), v_{h}\right)+\sum_{e \not \subset \partial \Omega^{i n}} \int_{e}\left\{\mathfrak{a} u_{h}(t)\right\}_{\mathbf{a}}\left[v_{h}\right] d \gamma \\
&=\int_{\Omega} f(t) v_{h} d \Omega-\sum_{e \subset \partial \Omega^{i n}} \int_{e}(\mathbf{a} \cdot \mathbf{n}) \varphi_{h}(t) v_{h} d \gamma \quad \forall v_{h} \in W_{h}
\end{aligned}
\label{15.51}\end{equation}

这里$\left\{\mathbf{a} u_{h}\right\}_{\mathbf{a}}$表示$\mathbf{a} u_{h}$的上风值，如果$\mathbf{a} \cdot \mathbf{n}_{1}>0$与$\mathbf{a} u_{h}^{1}$重合，如果$\mathbf{a} \cdot \mathbf{n}_{1}<0$与$u_{h}^{2}$重合，最后如果$\mathbf{a} \cdot \mathbf{n}_{1}=0$与$\left\{\mathbf{a} u_{h}\right\}$重合（如定义\ref{13.91} ）。最后，如果$\mathbf{a}$是一个常数（或无发散）向量，那么$\operatorname{div}\left(\mathbf{a} u_{h}\right)=\mathbf{a} \cdot \nabla u_{h}$和\ref{15.51} 与\ref{15.47} 重合。公式\ref{15.50}被称为具有跳跃稳定的不连续Galerkin方法。如果$c_{e} \geq \theta_{0}\left|\mathbf{a} \cdot \mathbf{n}_{e}\right|$（对于合适的$\theta_{0}>0$）的每个内侧$e$，后者是稳定的，也是以最优阶次收敛的。事实上，在静止问题的情况下，可以证明

!!!!
\left\|u-u_{h}\right\|_{\mathrm{L}^{2}(\Omega)}^{2}+\sum_{e \in \mathscr{T}_{h}}\left\|\sqrt{c_{e}}\left[u-u_{h}\right]\right\|_{\mathrm{L}^{2}(e)}^{2} \leq C h^{2 r+1}\|u\|_{\mathrm{H}^{r+1}(\Omega)}^{2}
$$

对于证明和其他具有跳跃稳定的公式，包括平流-扩散方程的情况，我们请读者参考 [BMS04] 。

\subsection{Approximation using spectral methods}

在这一节中，我们将简要地讨论用谱系方法对双曲问题进行逼近。为了简单起见，我们将把讨论限于一维问题。我们将首先处理单一区间的G-NI逼近，然后是对应于子区间分解的SEM逼近，当我们从一个区间移动到其相邻区间时，我们使用不连续多项式。这提供了不连续有限元的一般化，在这种情况下，我们考虑每个元素上的 "高 "度多项式，每个元素上的积分使用GLL积分公式\ref{10.18} 进行近似。

\subsubsection{The G-NI method in a single interval}

让我们考虑一阶双曲运输-反应问题\ref{14.3} ，我们假设 $(\alpha, \beta)=(-1,1)$ 。然后我们在空间上用谱系配位法进行近似，并强加边界条件。用$\left\{x_{0}=\right.!!!!\left.-1, x_{1}, \ldots, x_{N}=1\right\}$表示第10.2.3节介绍的GLL节点后，半离散化的问题是。

对于每个$t>0$，找到$u_{N}(t) \in \mathbb{Q}_{N}$（多项式\ref{10.1}的空间，使得

!!!!
\begin{cases}\left(\frac{\partial u_{N}}{\partial t}+a \frac{\partial u_{N}}{\partial x}+a_{0} u_{N}\right)\left(x_{j}, t\right)=f\left(x_{j}, t\right), & j=1, \ldots, N \\ u_{N}(-1, t)=\varphi(t) \\ u_{N}\left(x_{j}, 0\right)=u_{0}\left(x_{j}\right), & j=0, \ldots, N\end{cases}
$$

适当地使用\ref{10.25}中定义的离散GLL标量积，$\mathrm{G}$-NI对问题\ref{15.52}的近似成为：对于每个$t>0$，找到$u_{N}(t) \in \mathbb{Q}_{N}$，使得

!!!!
\left\{\begin{array}{l}
\left(\frac{\partial u_{N}(t)}{\partial t}, v_{N}\right)_{N}+\left(a \frac{\partial u_{N}(t)}{\partial x}, v_{N}\right)_{N}+\left(a_{0} u_{N}(t), v_{N}\right)_{N}=\left(f(t), v_{N}\right)_{N} \quad \forall v_{N} \in \mathbb{Q}_{N}^{-} \\
u_{N}(-1, t)=\varphi(t) \\
u_{N}(x, 0)=u_{0, N}
\end{array}\right.
\label{15.52}\end{equation}

其中$u_{0, N} \in \mathbb{Q}_{N}$是$u_{0}$的合适近似值，并设置了$\mathbb{Q}_{N}^{-}=\left\{v_{N} \in \mathbb{Q}_{N}:\right.!!!!\left.v_{N}(-1)=0\right\}$ 。在流入地，解$u_{N}$在每个时间$t>0$满足施加的条件，而测试函数消失。

事实上，如果\ref{15.53} 中的$u_{0, N}$被选为内插的$\Pi_{N}^{G L L} u_{0}$，那么问题\ref{15.52}和\ref{15.53}的解就会重合。为了证明这一点，只需在\ref{15.53}中选择与特征多项式$\psi_{j}$（在\ref{10.12},\ref{10.13}中定义，与GLL节点$x_{j}$相关，对每个$j=1, \ldots, N$都重合。

现在让我们推导出由离散标量积\ref{10.25} 引起的规范\ref{10.53}中的公式\ref{15.53}的稳定性估计。为了简单起见，我们选择一个同质的流入基准，即$\varphi(t)=0$，对于每个$t$，以及$a$和$a_{0}$常数。在选择了每个$t>0, v_{N}=u_{N}(t)$后，我们得到

!!!!
\frac{1}{2} \frac{\partial}{\partial t}\left\|u_{N}(t)\right\|_{N}^{2}+\frac{a}{2} \int_{-1}^{1} \frac{\partial u_{N}^{2}(t)}{\partial x} d x+a_{0}\left\|u_{N}(t)\right\|_{N}^{2}=\left(f(t), u_{N}(t)\right)_{N}
\label{15.53}\end{equation}

通过改写对流项，对时间进行积分并使用杨氏不等式，我们可以得到

!!!!
\begin{aligned}
&\left\|u_{N}(t)\right\|_{N}^{2}+a \int_{0}^{t}\left(u_{N}(1, \tau)\right)^{2} d \tau+2 a_{0} \int_{0}^{t}\left\|u_{N}(\tau)\right\|_{N}^{2} d \tau \\
&=\left\|u_{0, N}\right\|_{N}^{2}+2 \int_{0}^{t}\left(f(\tau), u_{N}(\tau)\right)_{N} d \tau \\
&\leq\left\|u_{0, N}\right\|_{N}^{2}+a_{0} \int_{0}^{t}\left\|u_{N}(\tau)\right\|_{N}^{2} d \tau+\frac{1}{a_{0}} \int_{0}^{t}\|f(\tau)\|_{N}^{2} d \tau
\end{aligned}
$$

就是说

!!!!
\begin{gathered}
\left\|u_{N}(t)\right\|_{N}^{2}+a \int_{0}^{t}\left(u_{N}(1, \tau)\right)^{2} d \tau+a_{0} \int_{0}^{t}\left\|u_{N}(\tau)\right\|_{N}^{2} d \tau \\
\leq\left\|u_{0, N}\right\|_{N}^{2}+\frac{1}{a_{0}} \int_{0}^{t}\|f(\tau)\|_{N}^{2} d \tau
\end{gathered}
\label{15.54}\end{equation}

初始数据的法线可以通过以下方式进行约束

!!!!
\left\|u_{0, N}\right\|_{N}^{2} \leq\left\|u_{0, N}\right\|_{\mathrm{L}^{\infty}(-1,1)}^{2}\left(\sum_{i=0}^{N} \alpha_{i}\right)=2\left\|u_{0, N}\right\|_{\mathrm{L}^{\infty}(-1,1)}^{2}
$$

而类似的约束对$\|f(\tau)\|_{N}^{2}$也成立，前提是$f$是一个连续函数。因此，回到\ref{15.54} 并使用不等式\ref{10.54} 来约束左手边的规范，我们推导出

!!!!
\begin{gathered}
\left\|u_{N}(t)\right\|_{\mathrm{L}^{2}(-1,1)}^{2}+a \int_{0}^{t}\left(u_{N}(1, \tau)\right)^{2} d \tau+a_{0} \int_{0}^{t}\left\|u_{N}(\tau)\right\|_{\mathrm{L}^{2}(-1,1)}^{2} d \tau \\
\leq 2\left\|u_{0, N}\right\|_{\mathrm{L}^{\infty}(-1,1)}^{2}+\frac{2}{a_{0}} \int_{0}^{t}\|f(\tau)\|_{\mathrm{L}^{2}(-1,1)}^{2} d \tau .
\end{gathered}
$$

在对流项$a$不是常数的情况下，如果我们从\ref{15.52}中微分方程的保守表述开始，也就是当左手边的第二项被$\partial(a u) / \partial x$取代时，G-NI方法被重新解释为一种配位方法就不那么直接。在这种情况下，我们可以再次证明G-NI近似等同于拼合近似，其中对流项被$\partial\left(\Pi_{N}^{G L L}\left(a u_{N}\right)\right) / \partial x$取代，即被内插导数\ref{10.40}取代。

同样在G-NI近似的情况下，我们可以诉诸于边界条件的弱加成。这种方法比上面考虑的方法更灵活，也更适合于对多维问题或方程组的推广。正如我们在上一节中所看到的，弱施加边界条件的出发点是对传输项进行适当的部分积分。参照一维问题\ref{15.52}，我们有（如果$a$是常数的话

!!!!
\begin{aligned}
\int_{-1}^{1} a \frac{\partial u(t)}{\partial x} v d x &=-\int_{-1}^{1} a u(t) \frac{\partial v}{\partial x} d x+[a u(t) v]_{-1}^{1} \\
&=-\int_{-1}^{1} a u(t) \frac{\partial v}{\partial x} d x+a u(1, t) v(1)-a \varphi(t) v(-1)
\end{aligned}
$$

由于上述特性，我们可以立即制定问题\ref{15.52} 的G-NI近似，并对边界条件进行弱处理：对于每个$t>0$，找到$u_{N}(t) \in \mathbb{Q}_{N}$，使得

!!!!
\begin{aligned}
&\left(\frac{\partial u_{N}(t)}{\partial t}, v_{N}\right)_{N}-\left(a u_{N}(t), \frac{\partial v_{N}}{\partial x}\right)_{N}+\left(a_{0} u_{N}(t), v_{N}\right)_{N}+ \\
&a u_{N}(1, t) v_{N}(1)=\left(f(t), v_{N}\right)_{N}+a \varphi(t) v_{N}(-1) \forall v_{N} \in \mathbb{Q}_{N}
\end{aligned}
$$

与$u_{N}(x, 0)=u_{0, N}(x)$ 。我们注意到，解$u_{N}$和检验函数$v_{N}$在边界都是自由的。

通过对对流项进行适当的反积分，可以得到\ref{15.55}的等效表述。

对于每个$t>0$，找到$u_{N}(t) \in \mathbb{Q}_{N}$，以便

!!!!
\begin{aligned}
&\left(\frac{\partial u_{N}(t)}{\partial t}, v_{N}\right)_{N}+\left(a \frac{\partial u_{N}(t)}{\partial x}, v_{N}\right)_{N}+\left(a_{0} u_{N}(t), v_{N}\right)_{N}+ \\
&a\left(u_{N}(-1, t)-\varphi(t)\right) v_{N}(-1)=\left(f, v_{N}\right)_{N} \forall v_{N} \in \mathbb{Q}_{N}
\end{aligned}
\label{15.56}\end{equation}

现在有可能将这种弱的表述重新解释为一种合适的配位方法。为此，只要在\ref{15.56}中选择测试函数$v_{N}$作为与GLL节点相关的特征多项式\ref{10.12}、\ref{10.13}即可。首先考虑内部和外流节点，因此选择$v_{N}=\psi_{i}$ ，与$i=1, \ldots, N$ ，我们有

!!!!
\left(\frac{\partial u_{N}}{\partial t}+a \frac{\partial u_{N}}{\partial x}+a_{0} u_{N}\right)\left(x_{i}, t\right)=f\left(x_{i}, t\right)
\label{15.57}\end{equation}

之前已经简化了方程中所有项所共有的权重$\alpha_{i}$。另一方面，通过选择$v_{N}=\psi_{0}$，我们在流入节点得到以下关系

!!!!
\begin{aligned}
\left(\frac{\partial u_{N}}{\partial t}\right.&\left.+a \frac{\partial u_{N}}{\partial x}+a_{0} u_{N}\right)(-1, t) \\
&+\frac{1}{\alpha_{0}} a\left(u_{N}(-1, t)-\varphi(t)\right)=f(-1, t)
\end{aligned}
\label{15.58}\end{equation}

$\alpha_{0}=2 /\left(N^{2}+N\right)$ 是与节点 $x_{0}=-1$ 相关的 GLL 权重。从方程\ref{15.57} 和\ref{15.58} 可以看出，除了流入节点外，所有GLL节点都可以用搭配的方式进行重构，对于流入节点，我们发现以下关系

!!!!
a\left(u_{N}(-1, t)-\varphi(t)\right)=\alpha_{0}\left(f-\frac{\partial u_{N}}{\partial t}-a \frac{\partial u_{N}}{\partial x}-a_{0} u_{N}\right)(-1, t)
\label{15.59}\end{equation}

后者可以解释为微分问题\ref{15.52} 的边界条件的满足，直至与$u_{N}$近似相关的残差。因此，这样的条件只有在极限中，对于$N \longrightarrow \infty$（即以一种自然的方式）才得到确切满足。

根据我们之前指出的，配方\ref{15.56} 将是复杂的，例如，在非恒定对流场的情况下 $a$ 。确实如此。

!!!!
-\left(a u_{N}(t), \frac{\partial v_{N}}{\partial x}\right)_{N}=\left(a \frac{\partial u_{N}(t)}{\partial x}, v_{N}\right)_{N}-a u_{N}(1, t) v_{N}(1)+a \varphi(t) v_{N}(-1)
$$

将不成立，因为在这种情况下，乘积$a u_{N}(t) \frac{\partial v_{N}}{\partial x}$不再确定度数为$2 N-1$的多项式，所以数字积分公式的精确性将不成立。因此有必要在反积分之前应用第10.2.3节中介绍的内插算子$\Pi_{N}^{G L L}$，以便

!!!!
\begin{aligned}
-\left(a u_{N}(t), \frac{\partial v_{N}}{\partial x}\right)_{N} &=-\left(\Pi_{N}^{G L L}\left(a u_{N}(t)\right), \frac{\partial v_{N}}{\partial x}\right)_{N} \\
&=-\left(\Pi_{N}^{G L L}\left(a u_{N}(t)\right), \frac{\partial v_{N}}{\partial x}\right) \\
&=\left(\frac{\partial}{\partial x} \Pi_{N}^{G L L}\left(a u_{N}(t)\right), v_{N}\right)-\left[\left(a u_{N}(t)\right) v_{N}\right]_{-1}^{1}
\end{aligned}

$$

在这种情况下，公式\ref{15.56} 就变成了。

对于每个$t>0$，找到$u_{N}(t) \in \mathbb{Q}_{N}$，以便

!!!!
\begin{aligned}
&\left(\frac{\partial u_{N}(t)}{\partial t}, v_{N}\right)_{N}+\left(\frac{\partial}{\partial x} \Pi_{N}^{G L L}\left(a u_{N}(t)\right), v_{N}\right)+\left(a_{0} u_{N}(t), v_{N}\right)_{N}+ \\
&a(t)\left(u_{N}(-1, t)-\varphi(t)\right) v_{N}(-1)=\left(f(t), v_{N}\right)_{N} \forall v_{N} \in \mathbb{Q}_{N}
\end{aligned}
\label{15.60}\end{equation}

与 $u_{N}(x, 0)=u_{0, N}(x)$ 。同样，用关系\ref{15.57} 和\ref{15.59} 表示的公式\ref{15.56} 的拼合重新解释，将需要随着插值算子$\Pi_{N}^{G L L}$的引入而修改（即用插值导数取代精确导数）。精确地说，我们得到

!!!!
\left(\frac{\partial u_{N}}{\partial t}+\frac{\partial}{\partial x} \Pi_{N}^{G L L}\left(a u_{N}(t)\right)+a_{0} u_{N}\right)\left(x_{i}, t\right)=f\left(x_{i}, t\right)
$$

为$i=1, \ldots, N$，和

!!!!
a(-1)\left(u_{N}(-1, t)-\varphi(t)\right)=\alpha_{0}\left(f-\frac{\partial u_{N}}{\partial t}-\frac{\partial}{\partial x} \Pi_{N}^{G L L}\left(a u_{N}(t)\right)-a_{0} u_{N}\right)(-1, t)
$$

在流入的节点 $x=-1$ 。

\subsubsection{The DG-SEM-NI method}

正如预期的那样，我们将在本节中介绍一种基于子区间划分的近似方法，在每个子区间中使用G-NI方法。此外，解决方案在一个区间和其相邻区间之间是不连续的。这就解释了DG（不连续的Galerkin）、SEM（谱元法）、NI（数值积分）的缩写词。

让我们在一般区间$(\alpha, \beta)$上重新考虑问题\ref{15.52} 。在后者上，我们在$M$子区间$\Omega_{m}=\left(\bar{x}_{m-1}, \bar{x}_{m}\right)$与$m=1, \ldots, M$中引入一个分区。让

!!!!
W_{N, M}=\left\{v \in \mathrm{L}^{2}(\alpha, \beta):\left.v\right|_{\Omega_{m}} \in \mathbb{Q}_{N}, \forall m=1, \ldots, M\right\}
$$

是每个子区间上度数为$N(\geq 1)$的分片多项式的空间。我们观察到，在点$\left\{\bar{x}_{i}\right\}$的对应中，连续性不一定得到保证。因此，我们可以制定问题\ref{15.52}的如下近似值：对于每个$t>0$，找到$u_{N, M}(t) \in W_{N, M}$，使得

!!!!
\begin{aligned}
&\sum_{m=1}^{M}\left[\left(\frac{\partial u_{N, M}}{\partial t}, v_{N, M}\right)_{N, \Omega_{m}}+\left(a \frac{\partial u_{N, M}}{\partial x}, v_{N, M}\right)_{N, \Omega_{m}}+\left(a_{0} u_{N, M}, v_{N, M}\right)_{N, \Omega_{m}}\right. \\
&\left.+a\left(\bar{x}_{m-1}\right)\left(u_{N, M}^{+}-U_{N, M}^{-}\right)\left(\bar{x}_{m-1}\right) v_{N, M}^{+}\left(\bar{x}_{m-1}\right)\right]=\sum_{m=1}^{M}\left(f, v_{N, M}\right)_{N, \Omega_{m}}
\end{aligned}
\label{15.61}\end{equation}

为所有$v_{N, M} \in W_{N, M}$，其中

!!!!
U_{N, M}^{-}\left(\bar{x}_{i}\right)= \begin{cases}u_{N, M}^{-}\left(\bar{x}_{i}\right), & i=1, \ldots, M-1 \\ \varphi\left(\bar{x}_{0}\right), & \text { for } i=0,\end{cases}
\label{15.62}\end{equation}

其中$(\cdot, \cdot)_{N, \Omega_{m}}$表示通过GLL公式\ref{10.25} 对标量积$\mathrm{L}^{2}$限制在元素$\Omega_{m}$的近似。为了简化符号，我们省略了$t$对$u_{N, M}$和$f$的依赖，明确指出。鉴于测试函数的不连续性质，我们可以通过选择测试函数$v_{N, M}$使$\left.v_{N, M}\right|_{[\alpha, \beta] \backslash_{m}}=0$在每个$M$子区间上重新表述方程\ref{15.61}。以这种方式进行，我们得到

!!!!
\begin{aligned}
&\left(\frac{\partial u_{N, M}}{\partial t}, v_{N, M}\right)_{N, \Omega_{m}}+\left(a \frac{\partial u_{N, M}}{\partial x}, v_{N, M}\right)_{N, \Omega_{m}}+\left(a_{0} u_{N, M}, v_{N, M}\right)_{N, \Omega_{m}} \\
&+a\left(\bar{x}_{m-1}\right)\left(u_{N, M}^{+}-U_{N, M}^{-}\right)\left(\bar{x}_{m-1}\right) v_{N, M}^{+}\left(\bar{x}_{m-1}\right)=\left(f, v_{N, M}\right)_{N, \Omega_{m}}
\end{aligned}
$$

对于每个$m=1, \ldots, M$。我们注意到，对于$m=1$，术语

!!!!
a\left(\bar{x}_{0}\right)\left(u_{N, M}^{+}-\varphi\right)\left(\bar{x}_{0}\right) v_{N, M}^{+}\left(\bar{x}_{0}\right)
$$

可以被看作是以弱形式施加的流入边界条件。另一方面，对于$m=2, \ldots, M$，术语

!!!!
a\left(\bar{x}_{m-1}\right)\left(u_{N, M}^{+}-U_{N, M}^{-}\right)\left(\bar{x}_{m-1}\right) v_{N, M}^{+}\left(\bar{x}_{m-1}\right)
$$

可以解释为一个惩罚项，它提供了在端点$u_{N, M}$上对解决方案$\bar{x}_{i}, i=1, \ldots, M-1$的连续性的弱强加。

我们现在想把公式\ref{15.61} 解释为一种合适的搭配方法。为此，我们在每个子区间$\Omega_{m}$上引入$N+1$GLL节点$x_{j}^{(m)}$，并以$j=!!!!0, \ldots, N$表示相应的权重（见\ref{10.71} ）。现在我们选择\ref{15.61} 中的检验函数$v_{N, M}$作为与节点$x_{j}^{(m)}$相关的特征拉格朗日多项式$\psi_{j}^{(m)} \in \mathbb{P}^{N}\left(\Omega_{m}\right)$，并在域$\Omega_{m}$外进行琐碎的扩展。 鉴于跳跃项的存在，我们将对方程\ref{15.61} 进行非唯一的重写。我们首先考虑与节点$x_{j}^{(m)}$相关的特征多项式，与$j=1, \ldots, N-1$和$m=1, \ldots, M$。在这种情况下，我们将没有惩罚项的贡献，得到的结果是

!!!!
\left[\frac{\partial u_{N, M}}{\partial t}+a \frac{\partial u_{N, M}}{\partial x}+a_{0} u_{N, M}\right]\left(x_{j}^{(m)}\right)=f\left(x_{j}^{(m)}\right)
$$

对于这种节点的选择，我们因此正好找到了微分问题\ref{15.52} 的拼合。

相反，在函数$\psi_{j}^{(m)}$与分区$\left\{\bar{x}_{i}\right\}$的一个节点相关联的情况下，即$j=0$与$m=1, \ldots, M$，我们有

!!!!
\begin{array}{r}
\alpha_{0}^{(m)}\left[\frac{\partial u_{N, M}}{\partial t}+a \frac{\partial u_{N, M}}{\partial x}+a_{0} u_{N, M}\right]\left(x_{0}^{(m)}\right) \\
+a\left(x_{0}^{(m)}\right)\left(u_{N, M}^{+}-U_{N, M}^{-}\right)\left(x_{0}^{(m)}\right)=\alpha_{0}^{(m)} f\left(x_{0}^{(m)}\right)
\end{array}
\label{15.63}\end{equation}

回顾一下，$U_{N, M}^{-}\left(x_{0}^{(1)}\right)=\varphi\left(\bar{x}_{0}\right)$。我们隐含地采用了一个惯例，即子区间$\Omega_{m}$不应包括$\bar{x}_{m}$，因为所采用方法的不连续性质会使我们对每个节点$\bar{x}_{i}$处理两次，与$i=1, \ldots, M-1$。方程\ref{15.63} 可以改写为

!!!!
\left[\frac{\partial u_{N, M}}{\partial t}+a \frac{\partial u_{N, M}}{\partial x}+a_{0} u_{N, M}-f\right]\left(x_{0}^{(m)}\right)=-\frac{a\left(x_{0}^{(m)}\right)}{\alpha_{0}^{(m)}}\left(u_{N, M}^{+}-U_{N, M}^{-}\right)\left(x_{0}^{(m)}\right)
$$

我们观察到，虽然左手边代表节点$x_{0}^{(m)}$处的方程的残余，但右手边的方程是在$x_{0}^{(m)}$处对$u_{N, M}$的连续性弱加的残余，最多是一个乘法系数。

\subsection{Numerical treatment of boundary conditions for hyperbolic systems}

我们已经看到了对标量输运方程施加流入边界条件的不同策略。当考虑双曲系统时，边界条件的数值处理需要更多的关注。我们将解释为什么要点是使用一维的恒定系数的线性系统。

!!!!
\begin{cases}\frac{\partial \mathbf{u}}{\partial t}+A \frac{\partial \mathbf{u}}{\partial x}=\mathbf{0}, \quad-1<x<1, t>0 \\ \mathbf{u}(x, 0)=\mathbf{u}_{0}(x), \quad-1<x<1\end{cases}
\label{15.64}\end{equation}

用适当的边界条件完成。按照[CHQZ07]，我们选择由两个双曲方程组成的系统的情况，并把$u$作为向量$(u, v)^{T}$，而

!!!!
A=\left[\begin{array}{cc}
-1 / 2 & -1 \\
-1 & -1 / 2
\end{array}\right]
$$

其特征值为 $-3 / 2$ 和 $1 / 2$ 。我们做出的选择是

!!!!
u(x, 0)=\sin (2 x)+\cos (2 x), \quad v(x, 0)=\sin (2 x)-\cos (2 x)
$$

为初始条件和

!!!!
\begin{aligned}
&u(-1, t)=\sin (-2+3 t)+\cos (-2-t)=\varphi(t) \\
&v(1, t)=\sin (2+3 t)+\cos (2-t)=\psi(t)
\end{aligned}
\label{15.65}\end{equation}

为边界条件。

现在让我们考虑（右）特征向量矩阵

!!!!
W=\left[\begin{array}{cc}
1 / 2 & 1 / 2 \\
1 / 2 & -1 / 2
\end{array}\right]
$$

其倒数为

!!!!
W^{-1}=\left[\begin{array}{cc}
1 & 1 \\
1 & -1
\end{array}\right]
$$

利用对角线化

!!!!
\Lambda=W^{-1} A W=\left[\begin{array}{cc}
-3 / 2 & 0 \\
0 & 1 / 2
\end{array}\right]
$$

我们可以重写\ref{15.64} 中的微分方程，用特征变量来表示

!!!!
\mathbf{z}=W^{-1} \mathbf{u}=\left[\begin{array}{l}
u+v \\
u-v
\end{array}\right]=\left[\begin{array}{l}
z_{1} \\
z_{2}
\end{array}\right]
\label{15.66}\end{equation}

作为

!!!!
\frac{\partial \mathbf{z}}{\partial t}+\Lambda \frac{\partial \mathbf{z}}{\partial x}=\mathbf{0}
\label{15.67}\end{equation}

特征变量$z_{1}$以$3 / 2$的速率向左传播，而$z_{2}$以$1 / 2$的速率向右传播。

这表明在$x=1$处为$z_{1}$指定一个条件，在$x=-1$处为$z_{2}$指定一个。$z_{1}$和$z_{2}$的边界值可以通过使用$u$和$v$的边界条件产生，如下。从关系式\ref{15.66} 我们可以得出

!!!!
\mathbf{u}=W \mathbf{z}=\left[\begin{array}{cc}
1 / 2 & 1 / 2 \\
1 / 2 & -1 / 2
\end{array}\right]\left[\begin{array}{l}
z_{1} \\
z_{2}
\end{array}\right]=\left[\begin{array}{c}
1 / 2\left(z_{1}+z_{2}\right) \\
1 / 2\left(z_{1}-z_{2}\right)
\end{array}\right]
$$

也就是说，利用为$u$和$v$分配的边界值\ref{15.65} 。

!!!!
\frac{1}{2}\left(z_{1}+z_{2}\right)(-1, t)=\varphi(t), \quad \frac{1}{2}\left(z_{1}-z_{2}\right)(1, t)=\psi(t)
\label{15.68}\end{equation}

结论是，尽管系统\ref{15.67} 的对角线结构，特征变量实际上是由边界条件\ref{15.68} 耦合的。

因此，我们不得不面对这样一个问题：从数值角度看，如何处理像\ref{15.64} 这样的系统的边界条件。事实上，即使从相应的标量问题的离散化中也会产生困难（对于$a$常数$>0$）。

!!!!
\begin{cases}\frac{\partial z}{\partial t}+a \frac{\partial z}{\partial x}=0, & -1<x<1, t>0 \\ z(-1, t)=\phi(t), & t>0 \\ z(x, 0)=z_{0}(x), & -1<x<1\end{cases}
\label{15.69}\end{equation}

如果我们不使用适当的离散化方案，就会出现这种情况。我们将说明谱系近似方法的程序。事实上，正确处理高阶方法的边界条件甚至比有限元或有限差分方法更重要，因为光谱方法的边界误差会以无限的速度向内传播。

在介绍了区间$x_{0}=-1<x_{1}<\ldots<x_{N-1}<x_{N}=1$的分区后，如果我们决定使用，例如，有限差分方案，我们会遇到问题，主要是在确定$z$在流出节点$x_{N}$的值，除非我们使用一阶逆风方案。事实上，除非引入定义区间$(-1,1)$以外的额外节点，否则高阶FD方案，如居中有限差分方案将无法提供这样的近似值。

相反，光谱离散化不涉及任何边界问题。例如，对应于问题\ref{15.69} 的配位方案可以写成如下。

$\forall n \geq 0$ ，找到$z_{N}^{n} \in \mathbb{Q}_{N}$，以便

!!!!
\left\{\begin{array}{l}
\frac{z_{N}^{n+1}\left(x_{i}\right)-z_{N}^{n}\left(x_{i}\right)}{\Delta t}+a \frac{\partial z_{N}^{n}}{\partial x}\left(x_{i}\right)=0, \quad i=1, \ldots, N \\
z_{N}^{n+1}\left(x_{0}\right)=\phi\left(t^{n+1}\right)
\end{array}\right.
$$

每个节点都有一个方程，无论是内部还是边界上的节点，流出的节点被视为任何其他内部节点。然而，当转移到系统\ref{15.64} 时，两个未知数和两个方程与每个内部节点$x_{i}$，与$i=1, \ldots, N-1$相关联，而在边界节点$x_{0}$和$x_{N}$我们仍然有两个未知数，但只有一个方程式。因此，我们将需要为这些点提供额外的条件：一般来说，在端点$x=-1$我们将需要与$A$的正特征值一样多的条件，而对于$x=1$我们将需要提供与负特征值一样多的额外条件。

让我们在频谱Galerkin方法的指导下，寻找这个问题的解决方案。让我们假设我们对系统\ref{15.64} 应用了拼合方法；然后，我们想找到$\mathbf{u}_{N}=\left(u_{N, 1}, u_{N, 2}\right)^{T} \in\left(\mathbb{Q}_{N}\right)^{2}$，使得

!!!!
\frac{\partial \mathbf{u}_{N}}{\partial t}\left(x_{i}\right)+A \frac{\partial \mathbf{u}_{N}}{\partial x}\left(x_{i}\right)=\mathbf{0}, \quad i=1, \ldots, N-1
\label{15.70}\end{equation}

并与

!!!!
u_{N, 1}\left(x_{0}, t\right)=\varphi(t), \quad u_{N, 2}\left(x_{N}, t\right)=\psi(t) .
\label{15.71}\end{equation}

获得$u_{N, 1}$和$u_{N, 2}$在$x_{N}$或$x_{0}$的两个缺失方程的最简单想法是利用矢量方程\ref{15.70}以及\ref{15.71}中的已知矢量$\varphi(t)$和$\psi(t)$。然而，以这种方式计算出的解是非常不稳定的。为了寻求另一种方法，我们的想法是在$2(N-1)$搭配关系\ref{15.70} 和 "物理 "边界条件\ref{15.71}中加入在$x_{0}$和$x_{N}$点的出射特征方程。更详细地说，在点$x_{0}=-1$处从域中流出的特征是与矩阵$A$的负特征值相关的特征，其公式为

!!!!
\frac{\partial z_{1}}{\partial t}\left(x_{0}\right)-\frac{3}{2} \frac{\partial z_{1}}{\partial x}\left(x_{0}\right)=0
\label{15.72}\end{equation}

而与$x_{N}=1$点相关的特征值$1 / 2$突出显示为正特征值，由以下公式给出

!!!!
\frac{\partial z_{2}}{\partial t}\left(x_{N}\right)+\frac{1}{2} \frac{\partial z_{2}}{\partial x}\left(x_{N}\right)=0
\label{15.73}\end{equation}

选择流出特征的动机是，后者将信息从域的内部带到相应的流出点，在那里施加微分方程是有意义的。

方程\ref{15.72} 和\ref{15.73} 允许我们在$2 N+2$未知数$u_{N, 1}\left(x_{i}, t\right)=u_{N}\left(x_{i}, t\right), u_{N, 2}\left(x_{i}, t\right)=v_{N}\left(x_{i}, t\right)$中拥有一个$i=0, \ldots, N$的封闭方程组。为了完整起见，我们可以用未知数$u_{N}$和$v_{N}$重写特征方程\ref{15.72} 和\ref{15.73} ，即为

!!!!
\frac{\partial\left(u_{N}+v_{N}\right)}{\partial t}\left(x_{0}\right)-\frac{3}{2} \frac{\partial\left(u_{N}+v_{N}\right)}{\partial x}\left(x_{0}\right)=0
$$

和

!!!!
\frac{\partial\left(u_{N}-v_{N}\right)}{\partial t}\left(x_{N}\right)+\frac{1}{2} \frac{\partial\left(u_{N}-v_{N}\right)}{\partial x}\left(x_{N}\right)=0
$$

分别为，或以矩阵形式表示为

!!!!
\begin{aligned}
&{\left[W_{11}^{-1} W_{12}^{-1}\right]\left[\frac{\partial \mathbf{u}_{N}}{\partial t}\left(x_{0}\right)+A \frac{\partial \mathbf{u}_{N}}{\partial x}\left(x_{0}\right)\right]=0} \\
&{\left[W_{21}^{-1} \quad W_{22}^{-1}\right]\left[\frac{\partial \mathbf{u}_{N}}{\partial t}\left(x_{N}\right)+A \frac{\partial \mathbf{u}_{N}}{\partial x}\left(x_{N}\right)\right]=0}
\end{aligned}
\label{15.74}\end{equation}

这样的附加方程被称为兼容性方程：它们代表了问题在边界点的微分方程的线性组合，其系数由矩阵$W^{-1}$的成分给出。

备注15.4.由于它们的全局性，谱系方法（无论是同位法、Galerkin法还是G-NI法）都会立即在整个域中传播在边界引入的每一个可能的数值扰动。因此，频谱方法代表了一个很好的测试平台，可以了解数值策略对于双曲系统的边界处理是多么合适。

\subsubsection{Weak treatment of boundary conditions}

现在我们想把基于相容性方程的方法概括化，并从点式关系，如\ref{15.74}，转向积分关系，更适合于数值近似，如有限元或G-NI。

让我们再一次考虑恒定系数系统\ref{15.64}和第15.6节中使用的符号。让$A$是一个实数、对称和非单调的矩阵，其对角线项是$A$的实数特征值，$W$是方形矩阵，其列是$A$的（右）特征矢量。我们假设$W$是正交的，这保证了$\Lambda=W^{T} A W$ 。特征变量，定义为$\mathbf{z}=W^{T} \mathbf{u}$ ，满足对角线系统\ref{15.67} 。我们引入特征值矩阵的分裂$\Lambda=\operatorname{diag}\left(\Lambda^{+}, \Lambda^{-}\right)$，由正的特征值$\left(\Lambda^{+}\right)$和负的特征值$\left(\Lambda^{-}\right)$分组产生。两个子矩阵都是对角线，$\Lambda^{+}$阶的正定$p, \Lambda^{-}$阶的负定$n=d-p$ 。类似地，我们可以将$\mathbf{z}$改写为$\mathbf{z}=\left(\mathbf{z}^{+}, \mathbf{z}^{-}\right)^{T}$，用$\mathbf{z}^{+}\left(\mathbf{z}^{-}\right)$表示沿斜率为正（负）的特征线不变的特征变量，换句话说，在$(x, t)$参考框架上向右（向左）移动的线。在对应于右极点的时候，$x=1, \mathbf{z}^{+}$与传出的特征变量有关，而$\mathbf{z}^{-}$与传入的特征变量有关。显然，这两个角色在左边界点$x=-1$处发生了转换。

一个简单的情况是，当我们把两个域极值的传入特性值作为边界条件，即$p$条件在$x=-1$，$n$条件在$x=1$。在这种情况下，\ref{15.67} 代表一个完全成熟的解耦系统。然而，更常见的是，物理变量的适当线性组合的值被分配在两个边界点。从$z$变量的角度来看，这些变量产生了特征变量的线性组合。原则上，没有一个传出的特征将由这些组合决定，因为产生的值通常与双曲系统向内传播的值不相容。相反，边界条件应允许将传入的特征变量作为传出的特征变量和问题数据的一个函数来确定。

为了清楚起见，让我们考虑以下边界条件

!!!!
B_{L} \mathbf{u}(-1, t)=\mathbf{g}_{L}(t), \quad B_{R} \mathbf{u}(1, t)=\mathbf{g}_{R}(t), \quad t>0
\label{15.75}\end{equation}

其中$\mathbf{g}_{L}$和$\mathbf{g}_{R}$是指定的向量，$B_{L}, B_{R}$是合适的矩阵。在左边的极值$x=-1$，我们有$p$传入特征，$B_{L}$将有维度$p \times d$。设置$C_{L}=B_{L} W$并使用为$\mathbf{z}$介绍的分割$\mathbf{z}=\left(\mathbf{z}^{+}, \mathbf{z}^{-}\right)^{T}$和特征向量矩阵的相应分割$W=\left(W^{+}, W^{-}\right)^{T}$，我们有

!!!!
C_{L} \mathbf{z}(-1, t)=C_{L}^{+} \mathbf{z}^{+}(-1, t)+C_{L}^{-} \mathbf{z}^{-}(-1, t)=\mathbf{g}_{L}(t)
$$

其中$C_{L}^{+}=B_{L} W^{+}$是一个$p \times p$矩阵，而$C_{L}^{-}=B_{L} W^{-}$的维度为$p \times n$ 。我们要求$C_{L}^{+}$是非星形的。那么$x=-1$处的传入特征可以通过以下方式得到

!!!!
\mathbf{z}^{+}(-1, t)=S_{L} \mathbf{z}^{-}(-1, t)+\mathbf{z}_{L}(t),
\label{15.76}\end{equation}

$S_{L}=-\left(C_{L}^{+}\right)^{-1} C_{L}^{-}$是一个$p \times n$矩阵和$\mathbf{z}_{L}(t)=\left(C_{L}^{+}\right)^{-1} \mathbf{g}_{L}(t)$ 。以类似的方式，我们可以在右侧极值$x=1$处指定传入的特征变量为

!!!!
\mathbf{z}^{-}(1, t)=S_{R} \mathbf{z}^{+}(1, t)+\mathbf{z}_{R}(t)
\label{15.77}\end{equation}

$S_{R}$是一个$n \times p$矩阵。

矩阵$S_{L}$和$S_{R}$被称为反射矩阵。

因此，双曲系统\ref{15.64} 将由边界条件\ref{15.75} 完成，或者说，由条件\ref{15.76} -\ref{15.77} 完成。

让我们看看这样的边界条件选择可以带来哪些好处。我们从问题\ref{15.64} 的弱表述开始，对包含空间导数的项进行部分积分

!!!!
\int_{-1}^{1} \mathbf{v}^{T} \frac{\partial \mathbf{u}}{\partial t} d x-\int_{-1}^{1}\left(\frac{\partial \mathbf{v}}{\partial x}\right)^{T} A \mathbf{u} d x+\left[\mathbf{v}^{T} A \mathbf{u}\right]_{-1}^{1}=0
$$

对于每个$t>0, \mathbf{v}$是一个任意的、可微的测试函数。我们希望通过利用边界方程\ref{15.76}-\ref{15.77}来重写边界项$\left[\mathbf{v}^{T} A \mathbf{u}\right]_{-1}^{1}$。引入与检验函数$\mathbf{v}$相关的特征变量$W^{T} \mathbf{v}=\mathbf{y}=\left(\mathbf{y}^{+}, \mathbf{y}^{-}\right)^{T}$，我们将得到

!!!!
\mathbf{v}^{T} A \mathbf{u}=\mathbf{y}^{T} \Lambda \mathbf{z}=\left(\mathbf{y}^{+}\right)^{T} \Lambda^{+} \mathbf{z}^{+}+\left(\mathbf{y}^{-}\right)^{T} \Lambda^{-} \mathbf{z}^{-}
$$

利用关系式\ref{15.76}-\ref{15.77}，可以得出以下结论

!!!!
\begin{array}{ll} 
& \int_{-1}^{1} \mathbf{v}^{T} \frac{\partial \mathbf{u}}{\partial t} d x-\int_{-1}^{1}\left(\frac{\partial \mathbf{v}}{\partial x}\right)^{T} A \mathbf{u} d x \\
- & \left(\mathbf{y}^{+}\right)^{T}(-1, t) \Lambda^{+} S_{L} \mathbf{z}^{-}(-1, t)-\left(\mathbf{y}^{-}\right)^{T}(-1, t) \Lambda^{-} \mathbf{z}^{-}(-1, t) \\
+ & \left(\mathbf{y}^{+}\right)^{T}(1, t) \Lambda^{+} \mathbf{z}^{+}(1, t)+\left(\mathbf{y}^{-}\right)^{T}(1, t) \Lambda^{-} S_{R} \mathbf{z}^{+}(1, t) \\
= & \left(\mathbf{y}^{+}\right)^{T}(-1, t) \Lambda^{+} \mathbf{z}_{L}(t)-\left(\mathbf{y}^{-}\right)^{T}(1, t) \Lambda^{-} \mathbf{z}_{R}(t)
\end{array}
\label{15.78}\end{equation}

我们注意到边界条件\ref{15.76}-\ref{15.77}被自然地纳入到系统的右手边中。此外，通过部分积分，有可能得到\ref{15.78}的等效表述，其中边界条件是以弱方式施加的

!!!!
\begin{aligned}
& \int_{-1}^{1} \mathbf{v}^{T} \frac{\partial \mathbf{u}}{\partial t} d x+\int_{-1}^{1} \mathbf{v}^{T} A \frac{\partial \mathbf{u}}{\partial x} d x \\
+&\left(\mathbf{y}^{+}\right)^{T}(-1, t) \Lambda^{+}\left(\mathbf{z}^{+}(-1, t)-S_{L} \mathbf{z}^{-}(-1, t)\right) \\
-&\left(\mathbf{y}^{-}\right)^{T}(1, t) \Lambda^{-}\left(\mathbf{z}^{-}(1, t)-S_{R} \mathbf{z}^{+}(1, t)\right) \\
=&\left(\mathbf{y}^{+}\right)^{T}(-1, t) \Lambda^{+} \mathbf{z}_{L}(t)-\left(\mathbf{y}^{-}\right)^{T}(1, t) \Lambda^{-} \mathbf{z}_{R}(t)
\end{aligned}
\label{15.79}\end{equation}

最后，我们回顾一下，通常对反射矩阵$S_{L}$和$S_{R}$做出以下假设，称为耗散假设

!!!!
\left\|S_{L}\right\|\left\|S_{R}\right\|<1
\label{15.80}\end{equation}

\ref{15.80}中的矩阵规范必须理解为矩形矩阵的欧几里得规范，即$S_{L}^{T} S_{L}$和$S_{R}^{T} S_{R}$的最大特征值的平方根。这个假设足以保证前面的方案在$\mathrm{L}^{2}$准则下的稳定性。公式\ref{15.78} （或\ref{15.79} ）适用于Galerkin近似，如Galerkin有限元、频谱Galerkin方法、单域高斯数值积分的频谱方法（G-NI）、频谱元素版本，无论是连续（SEM-NI）还是不连续（DG-SEM-NI）频谱元素。

\subsection{Exercises}

1.证明连续线性有限元的离散化\ref{15.13}与有限差分的离散化\ref{14.22}相吻合，如果质量矩阵使用质量包络技术进行对角化。

[解：如第13.5节所述，使用统一分割的特性\rfe{13.34}。

2.证明第\ref{15.4}节中提供的基于有限元的半微分化的稳定性不等式。\ref{15.4}中提供的基于有限元的半微分化的稳定性不等式。

3.证明关系\ref{15.13}。

4.使用连续谱元法SEM-NI和非连续谱元法DG-SEM-NI对系统\ref{15.78}进行微处理。

\section{Nonlinear hyperbolic problems}

在本章中，我们将介绍一些非线性双曲问题的例子。我们将指出这类问题的一些特点，最明显的是它们在连续初始和边界数据的情况下也能产生不连续的解。这些问题的数值逼近远非易事。在此，我们将简单地指出在一维方程的情况下如何应用有限差分和有限元方案。

关于更完整的讨论，我们参考[LeV07, GR96, Bre00, Tor09, Kro97, LeF02]。

\subsection{Scalar equations}

让我们考虑以下方程

!!!!
\frac{\partial u}{\partial t}+\frac{\partial}{\partial x} F(u)=0, \quad x \in \mathbb{R}, t>0
\label{16.1}\end{equation}

其中$F$是$u$的非线性函数，称为$f l u x$的$u$，因为在$\mathbb{R}$的每个区间$(\alpha, \beta)$，它满足以下关系

!!!!
\frac{d}{d t} \int_{\alpha}^{\beta} u(x, t) d x=F(u(t, \alpha))-F(u(t, \beta))
$$

那么，如果$u=u(x, t)$代表一个物理量$q$的密度（或浓度），$F$是其相关的通量，$q$在$[\alpha, \beta]$中的变化率由通过端点$\alpha$和$\beta$ 的净通量决定。

由于这个原因，\ref{16.1} 表达的是一个守恒定律。一个典型的例子是伯格斯方程

!!!!
\frac{\partial u}{\partial t}+u \frac{\partial u}{\partial x}=0
\label{16.2}\end{equation}

这个方程在例$1.3$中已经考虑过了，当通量为$F(u)=u^{2} / 2$时对应于\ref{16.1}。它的特征曲线是通过解决$x^{\prime}(t)=u$得到的。

然而，由于$u$在特征上是常数，我们得到$x^{\prime}(t)=$常数，所以特征是直线。后者在平面$(x, t)$中由map$t \rightarrow\left(x+t u_{0}(x), t\right)$定义，\ref{16.2}的解隐含地由$u\left(x+t u_{0}(x)\right)=!!!!u_{0}(x), t<t_{c}, t_{c}$定义，是此类特征相交的第一个瞬间。例如，如果$u_{0}(x)=\left(1+x^{2}\right)^{-1}$ ，那么$t_{c}=8 / \sqrt{27}$ 。

事实上，如果$u_{0}^{\prime}(x)$在某一点上是负数，在设定了

!!!!
t_{c}=-\frac{1}{\min u_{0}^{\prime}(x)}
$$

对于$t>t_{c}$，不可能有经典的解决方案（即$C^{1}$类），因为

!!!!
\lim _{t \rightarrow t_{c}^{-}}\left(\inf _{x \in \mathbb{R}} \frac{\partial u}{\partial x}(x, t)\right)=-\infty
$$

让我们考虑图16.1：注意对于$t=t_{c}$，解决方案如何有一个不连续的地方。

为了解释这种唯一性的丧失，我们引入了双曲方程的弱解的概念：我们说$u$是\ref{16.1}的弱解，如果它在所有的点$x \in \mathbb{R}$都满足微分关系\ref{16.1}，除了那些不连续的地方。在后者中，我们不再期望\ref{16.1}成立（对一个不连续的函数进行微分是没有意义的）。相反，我们要求验证以下朗肯-胡戈尼奥特条件

!!!!
F\left(u_{r}\right)-F\left(u_{l}\right)=\sigma\left(u_{r}-u_{l}\right)
\label{16.3}\end{equation}

其中$u_{r}$和$u_{l}$分别表示$u$在不连续点的右极限和左极限，$\sigma$是不连续点的传播速度。因此，条件\ref{16.3} 表达了这样一个事实：通量的跳跃与解的跳跃成正比。

弱解不一定是唯一的：在这些弱解中，物理上正确的是所谓的熵解。正如我们将在本节末尾看到的，在布尔格斯方程的情况下，熵解是作为$\varepsilon \rightarrow 0$的极限得到的。

![](https://cdn.mathpix.com/cropped/991f5db518e324d299c1ff4972bba9fb-055.jpg?height=302&width=340&top_left_y=899&top_left_x=285)

图16.1.具有粘性扰动项的方程在临界时间$t_{c}$解$u^{\varepsilon}(x, t)$的奇点发展情况

!!!!
\frac{\partial u^{\varepsilon}}{\partial t}+\frac{\partial}{\partial x} F\left(u^{\varepsilon}\right)=\varepsilon \frac{\partial^{2} u^{\varepsilon}}{\partial x^{2}}, x \in \mathbb{R}, t>0
$$

与 $u^{\varepsilon}(x, 0)=u_{0}(x)$ 。

一般来说，我们可以这样说。

- 如果$F(u)$是可微的，那么由\ref{16.3}给出的以$\sigma$速度传播的不连续满足熵条件，如果

!!!!
F^{\prime}\left(u_{l}\right) \geq \sigma \geq F^{\prime}\left(u_{r}\right)
$$

- 如果$F(u)$不是可微的，由\ref{16.3} 给出的以速率$\sigma$传播的不连续满足熵条件，如果

!!!!
\frac{F(u)-F\left(u_{l}\right)}{u-u_{l}} \geq \sigma \geq \frac{F(u)-F\left(u_{r}\right)}{u-u_{r}}
$$

对于$u_{l}$和$u_{r}$之间的每个u。

例16.1.让我们考虑具有以下初始条件的布尔格斯方程

!!!!
u_{0}(x)= \begin{cases}u_{l} & \text { if } x<0 \\ u_{r} & \text { if } x>0\end{cases}
$$

其中$u_{r}$和$u_{l}$是两个常数。如果$u_{l}>u_{r}$ ，则存在一个唯一的弱解（也是熵）。

!!!!
u(x, t)= \begin{cases}u_{l}, & x<\sigma t \\ u_{r}, & x>\sigma t\end{cases}
\label{16.4}\end{equation}

其中$\sigma=\left(u_{l}+u_{r}\right) / 2$是不连续点（也叫冲击）的传播速率。在这种情况下，特征 "进入 "冲击（见图16.2）。

如果 $u_{l}<u_{r}$ ，有无限多的弱解：一个仍然有\ref{16.4}，但在这种情况下，特征退出不连续（见图16.3）。这样的解是不稳定的，也就是说，对数据的小扰动会大大改变解本身。另一个弱解是

!!!!
u(x, t)= \begin{cases}u_{l} & \text { if } x<u_{l} t \\ \frac{x}{t} & \text { if } u_{l} t \leq x \leq u_{r} t \\ u_{r} & \text { if } x>u_{r} t\end{cases}
!!!!
 ![](https://cdn.mathpix.com/cropped/991f5db518e324d299c1ff4972bba9fb-056.jpg?height=194&width=512&top_left_y=1005&top_left_x=199)

图16.2.伯格斯方程的熵解

![](https://cdn.mathpix.com/cropped/991f5db518e324d299c1ff4972bba9fb-057.jpg?height=193&width=264&top_left_y=109&top_left_x=451)

图16.3.伯格斯方程的非熵解
 ![](https://cdn.mathpix.com/cropped/991f5db518e324d299c1ff4972bba9fb-057.jpg?height=200&width=516&top_left_y=346&top_left_x=200)

图16.4.稀疏波

这样的解决方案，描述的是稀疏波，是熵，与之前的解决方案相反（见图16.4）。

我们说，如果存在一个严格的凸函数$\sigma \in \mathrm{L}^{\infty}(0,1)$和一个函数\subsubsection{Mixed (or Robin) boundary conditions}，使得双曲问题\ref{16.1} 有一个熵函数，即

!!!!
\Psi^{\prime}(u)=\eta^{\prime}(u) F^{\prime}(u)
\label{16.5}\end{equation}

其中'素'表示相对于参数$u$的导数。函数$\eta$被称为熵，$\Psi$被称为熵通量。我们回顾一下，如果对于每个不同的$u$和$w$以及每个$\theta \in(0,1)$，我们都可以说一个函数$\eta$是凸的。

!!!!
\eta(u+\theta(w-u))<(1-\theta) \eta(u)+\theta \eta(w)
$$

如果$\eta$有一个连续的二阶导数，这就相当于要求$\eta^{\prime \prime}>0$ 。

备注16.1。这里介绍的是熵的 "数学 "定义。在\ref{16.1}支配物理现象的情况下，通常可以定义一个 "热力学熵"。后者原来是根据上述定义的熵。

\ref{16.1}的准线性形式由以下公式给出

!!!!
\frac{\partial u}{\partial t}+F^{\prime}(u) \frac{\partial u}{\partial x}=0
\label{16.6}\end{equation}

如果$u$足够规则，通过将\ref{16.6}乘以$\eta^{\prime}(u)$可以很容易地验证，$\eta$和$\Psi$满足以下守恒定律

!!!!
\frac{\partial \eta}{\partial t}(u)+\frac{\partial \Psi}{\partial x}(u)=0
\label{16.7}\end{equation}

对于一个标量方程，通常可以找到不同的函数对$\eta$和$\Psi$来满足给定的条件。

为推导\ref{16.7} 而进行的操作只有在$u$是规则的情况下才有意义，特别是在解中没有不连续的情况下。然而，我们可以找到在\ref{16.1}解的不连续处由熵变量验证的条件，当这种方程代表以下正则化方程（称为粘性方程）的$\varepsilon \rightarrow 0^{+}$的极限时

!!!!
\frac{\partial u}{\partial t}+\frac{\partial F}{\partial x}(u)=\varepsilon \frac{\partial^{2} u}{\partial x^{2}}
$$

这是一个平流扩散方程（非线性平流）。它的解对每个$\varepsilon>0 ;$都是有规律的，通过执行之前使用的相同操作，我们可以写出

!!!!
\frac{\partial \eta}{\partial t}(u)+\frac{\partial \Psi}{\partial x}(u)=\varepsilon \eta^{\prime}(u) \frac{\partial^{2} u}{\partial x^{2}}=\varepsilon \frac{\partial}{\partial x}\left[\eta^{\prime}(u) \frac{\partial u}{\partial x}\right]-\varepsilon \eta^{\prime \prime}(u)\left(\frac{\partial u}{\partial x}\right)^{2}
$$

通过在一般板块上的积分$\left[x_{1}, x_{2}\right] \times\left[t_{1}, t_{2}\right]$，我们可以得到

!!!!
\begin{aligned}
&\int_{t_{1}}^{t_{2}} \int_{x_{1}}^{x_{2}}\left[\frac{\partial \eta}{\partial t}(u)+\frac{\partial \Psi(u)}{\partial x}\right] d x d t=\varepsilon \int_{t_{1}}^{t_{2}}\left[\eta^{\prime}\left(u\left(x_{2}, t\right)\right) \frac{\partial u}{\partial x}\left(x_{2}, t\right)\right. \\
&\left.-\eta^{\prime}\left(u\left(x_{1}, t\right)\right) \frac{\partial u}{\partial x}\left(x_{1}, t\right)\right] d t-\varepsilon \int_{t_{1}}^{t_{2}} \int_{x_{1}}^{x_{2}} \eta^{\prime \prime}(u)\left(\frac{\partial u}{\partial x}\right)^{2} d x d t=R_{1}(\varepsilon)+R_{2}(\varepsilon)
\end{aligned}
$$

其中我们设置了

!!!!
\begin{gathered}
R_{1}(\varepsilon)=\varepsilon \int_{t_{1}}^{t_{2}}\left[\eta^{\prime}\left(u\left(x_{2}, t\right)\right) \frac{\partial u}{\partial x}\left(x_{2}, t\right)-\eta^{\prime}\left(u\left(x_{1}, t\right)\right) \frac{\partial u}{\partial x}\left(x_{1}, t\right)\right] d t \\
R_{2}(\varepsilon)=-\varepsilon \int_{t_{1}}^{t_{2}} \int_{x_{1}}^{x_{2}} \eta^{\prime \prime}(u)\left(\frac{\partial u}{\partial x}\right)^{2} d x d t
\end{gathered}
$$

我们有

!!!!
\lim _{\varepsilon \rightarrow 0^{+}} R_{1}(\varepsilon)=0
$$

而如果修改后的问题的$\varepsilon \rightarrow 0^{+}$的解表示跨越$(x, t)$平面的一条曲线的不连续，我们有

!!!!
\lim _{\varepsilon \rightarrow 0^{+}} R_{2}(\varepsilon) \neq 0
$$

因为包含$\left(\frac{\partial u}{\partial x}\right)^{2}$项的积分，一般来说是无界的。

另一方面，$R_{2}(\varepsilon) \leq 0$对于每个$\varepsilon>0$，与$\partial^{2} \eta / \partial u^{2}>0$，因此，$\varepsilon \rightarrow 0^{+}$的弱边界解满足

!!!!
\int_{t_{1}}^{t_{2}} \int_{x_{1}}^{x_{2}}\left[\frac{\partial \eta}{\partial t}(u)+\frac{\partial \Psi}{\partial x}(u)\right] d x d t \leq 0 \quad \forall x_{1}, x_{2}, t_{1}, t_{2}
\label{16.9}\end{equation}

换句话说

!!!!
\frac{\partial \eta}{\partial t}(u)+\frac{\partial \Psi}{\partial x}(u) \leq 0, \quad x \in \mathbb{R}, \quad t>0
$$

在一个弱的意义上。显然，我们刚才看到的和熵解的概念之间存在着一种关系。如果微分方程有一个熵函数$\eta$，那么当且仅当$\eta$满足\ref{16.9} 时，一个弱解就是熵解。换句话说，熵解是正则化问题\ref{16.8} 的解的极限，如$\varepsilon \rightarrow 0^{+}$ 。

\subsection{Finite difference approximation}

让我们回到非线性双曲方程\ref{16.1} ，其初始条件为

!!!!
u(x, 0)=u_{0}(x), x \in \mathbb{R}
$$

我们用$a(u)=F^{\prime}(u)$表示其特征率。同样对于这个问题，我们可以使用形式为\ref{14.13} 的显式有限差分方案，其中$H_{j+1 / 2}^{n}=H\left(u_{j}^{n}, u_{j+1}^{n}\right)

!!!!
H_{j+1 / 2}^{n} \simeq \frac{1}{\Delta t} \int_{t^{n}}^{t^{n+1}} F\left(u\left(x_{j+1 / 2}, t\right)\right) d t
$$

近似于时间间隔$x_{j+1 / 2}$中通过$\left[t^{n}, t^{n+1}\right]$的平均通量。为了具有一致性，数字通量$H(\cdot, \cdot)$必须验证

!!!!
H(\bar{u}, \bar{u})=F(\bar{u}),
\label{16.10}\end{equation}

如果$\bar{u}$是一个常数。那么由于Lax和Wendroff的一个经典结果，函数$u$使得

!!!!
u\left(x_{j}, t^{n}\right)=\lim _{\Delta t, h \rightarrow 0} u_{j}^{n}
$$

是原问题\ref{16.1} 的弱解。

然而，不幸的是，以这种方式获得的解决方案不一定满足熵条件（否则说，弱的解决方案可能不是熵的）。

为了 "恢复" 熵解，数值方案必须引入一个合适的数值扩散，正如第16.1节的分析所建议的。为此，我们将\ref{14.13} 改写成以下形式

!!!!
u_{j}^{n+1}=G\left(u_{j-1}^{n}, u_{j}^{n}, u_{j+1}^{n}\right)
\label{16.11}\end{equation}

并且我们介绍一些定义。数值方案\ref{16.11} 被称为。

- 如果$G$是一个在其每个参数中单调增加的函数，则为单调。

- 如果存在$C>0$，使sup$_{j, n}\left|u_{j}^{n}\right| \leq C$有界的话

- 如果$\forall h>0, \exists \delta_{0}>0$（可能取决于$\left.h\right)$，以便对每个$0<\Delta t<$而言，稳定的

$\delta_{0}$ ，如果$\mathbf{u}^{n}$和$\mathbf{v}^{n}$是由两个初始数据$\mathbf{u}^{0}$和$\mathbf{v}^{0}$开始得到的有限差分解决方案，则

!!!!
\left\|\mathbf{u}^{n}-\mathbf{v}^{n}\right\|_{\Delta} \leq C_{T}\left\|\mathbf{u}^{0}-\mathbf{v}^{0}\right\|_{\Delta}
\label{16.12}\end{equation}

对于每个$n \geq 0$，如$n \Delta t \leq T$和任何选择的初始数据$\mathbf{u}^{0}$和$\mathbf{v}^{0}$ 。常数$C_{T}>0$独立于$\Delta t$和$h$，而$\|\cdot\|_{\Delta}$是一个合适的离散准则，例如\ref{14.26}中介绍的那些。请注意，对于线性问题，这个定义等同于\ref{14.25} 。当在\ref{16.12}中我们可以用$C_{T}=1$来代替每个$T>0$时，我们说该数值方案是强稳定的。

例如，为了简化符号，使用$F_{j}=F\left(u_{j}\right)$，问题\ref{16.1} 的Lax-Friedrichs方案是通过一般方案\ref{14.13}实现的，其中我们取

!!!!
H_{j+1 / 2}=\frac{1}{2}\left[F_{j+1}+F_{j}-\frac{1}{\lambda}\left(u_{j+1}-u_{j}\right)\right]
$$

这个方法是一致的、稳定的和单调的，前提是以下条件（类似于之前在线性情况下看到的CFL条件）成立

!!!!
\left|F^{\prime}\left(u_{j}^{n}\right)\right| \frac{\Delta t}{h} \leq 1 \quad \forall j \in \mathbb{Z}, \forall n \in \mathbb{N}
\label{16.13}\end{equation}

库兹涅佐夫（N.N. Kuznetsov）的一个经典结果是，\ref{16.11} 类型的单调方案是有界的、稳定的、收敛于熵解的，并且就时间和空间而言，最多精确到一阶，也就是说，存在一个常数$C>0$，使得

!!!!
\max _{j, n}\left|u_{j}^{n}-u\left(x_{j}, t^{n}\right)\right| \leq C(\Delta t+h)
$$

这些方案一般来说耗散性太大，除非使用非常细的网格，否则不会产生准确的解决方案。

更高阶的方案（称为高阶冲击捕捉方案）可以使用允许校准数值耗散作为解的局部规则性的功能的技术来开发。通过这样做，人们可以通过使用最小的数值耗散来正确解决不连续问题（确保熵解的收敛并避免虚假的振荡）。这是一个复杂的话题，不可能在几行字内理出头绪。对于深入的分析，我们参考[LeV02b, LeV07, GR96, Hir88]。

\subsection{Approximation by discontinuous finite elements}

对于问题\ref{16.1} 的离散化，我们现在考虑基于不连续Galerkin（DG）有限元的空间近似。使用在第$15.4$节中介绍的同样的符号，我们寻求对每一个问题的  $15.4$，我们对每个$t>0, u_{h}(t) \in W_{h}$，如我们有$\forall j=!!!!0, \ldots, m-1$和$\forall v_{h} \in \mathbb{P}_{r}\left(I_{j}\right)$，寻求

!!!!
\int_{I_{j}} \frac{\partial u_{h}}{\partial t} v_{h} d x-\int_{I_{j}} F\left(u_{h}\right) \frac{\partial v_{h}}{\partial x} d x+H_{j+1}\left(u_{h}\right) v_{h}^{-}\left(x_{j+1}\right)-H_{j}\left(u_{h}\right) v_{h}^{+}\left(x_{j}\right)=0
\label{16.14}\end{equation}

与$I_{j}=\left[x_{j}, x_{j+1}\right]$ 。初始数据$u_{h}^{0}$是由关系提供的


!!!!
\int_{I_{j}} u_{h}^{0} v_{h} d x=\int_{I_{j}} u_{0} v_{h} d x, \quad j=0, \ldots, m-1
$$

现在函数$H_{j}$表示节点$x_{j}$处的非线性通量，取决于$u_{h}$在$x_{j}$处的值，即

!!!!
H_{j}\left(u_{h}(t)\right)=H\left(u_{h}^{-}\left(x_{j}, t\right), u_{h}^{+}\left(x_{j}, t\right)\right)
\label{16.15}\end{equation}

对于一个合适的数值通量$H(\cdot, \cdot)$ 。如果$j=0$，我们将不得不设置$u_{h}^{-}\left(x_{0}, t\right)=\phi(t)$，这是左侧极值的边界基准点（当然，假设这是流入点）。

我们注意到，对于$H$的选择存在多种选择。第一个要求是数值通量$H$必须与通量$F$一致，即它必须满足任何常数值$\bar{u}$的属性\ref{16.10}。此外，我们希望\ref{16.14}是单调方案的扰动。事实上，正如上一节所指出的，后者是稳定的，并收敛于熵解，尽管只是一阶精确。更确切地说，我们要求\ref{16.14} 在$r=0$时是单调方案。在这种情况下，用$u_{h}^{(j)}$表示$u_{h}$对$I_{j},\ref{16.14}的恒定值后，就变成了

!!!!
h_{j} \frac{\partial}{\partial t} u_{h}^{(j)}(t)+H\left(u_{h}^{(j)}(t), u_{h}^{(j+1)}(t)\right)-H\left(u_{h}^{(j-1)}(t), u_{h}^{(j)}(t)\right)=0
\label{16.16}\end{equation}

的初始数据$u_{h}^{0,(j)}=h_{i}^{-1} \int_{x_{j}^{j+1}}^{x_{j+1}} u_{0} d x$在区间$I_{j}, j=0, \ldots, m-1$。我们用 $h_{j}=x_{j+1}-x_{j}$ 表示 $I_{j}$ 的长度。

为了使方案\ref{16.16} 是单调的，通量$H$必须是单调的，这相当于说$H(v, w)$是其参数的Lipschitz函数，在$v$中不减少，在$w$中不增加，即$v \rightarrow H(v, \cdot)$是一个非减少的函数而$w \rightarrow H(\cdot, w)$是非增加的。在符号中，$H(\uparrow, \downarrow)$ .

以下是三个经典的单调通量的例子。

1. Godunov Flux

!!!!
H(v, w)= \begin{cases}\min _{v \leq u \leq w} F(u) & \text { if } v \leq w \\ \max _{w \leq u \leq v} F(u) & \text { if } v>w\end{cases}
$$

2. Engquist-Osher Flux

!!!!
H(v, w)=\int_{0}^{v} \max \left(F^{\prime}(u), 0\right) d u+\int_{0}^{w} \min \left(F^{\prime}(u), 0\right) d u+F(0)
$$

3. Lax-Friedrichs Flux

!!!!
H(v, w)=\frac{1}{2}[F(v)+F(w)-\delta(w-v)], \quad \delta=\max _{\inf _{x} u_{0}(x) \leq u \leq \sup _{x} u_{0}(x)}\left|F^{\prime}(u)\right|
$$

戈杜诺夫通量是产生最少数值耗散的通量，拉克斯-弗里德里希斯通量是最便宜的评估。然而，数值经验表明，如果度数$r$增加，通量$H$的选择对近似的质量没有重大影响。

在线性情况下，其中$F(u)=a u$，所有以前的通量都是重合的，并且等于上风通量

!!!!
H(v, w)=a \frac{v+w}{2}-\frac{|a|}{2}(w-v) .
\label{16.17}\end{equation}

在这种情况下，我们观察到，当$a>0$时，方案\ref{16.14} 与\ref{15.42} 中引入的方案完全吻合。事实上，在\ref{15.42} 中设定$a_{0}=0$和$f=0$并通过部分积分，我们得到，对于每个$j=1, \ldots, m-1

!!!!
\begin{aligned}
&\int_{I_{j}} \frac{\partial u_{h}}{\partial t} v_{h} d x-\int_{I_{j}}\left(a u_{h}\right) \frac{\partial v_{h}}{\partial x} d x \\
&+\left(a u_{h}\right)^{-}\left(x_{j+1}\right) v_{h}^{-}\left(x_{j+1}\right)-\left(a u_{h}\right)^{-}\left(x_{j}\right) v_{h}^{+}\left(x_{j}\right)=0
\end{aligned}
\label{16.18}\end{equation}

即\ref{16.14} ，记住，在所考察的案例中，$a u_{h}=F\left(u_{h}\right)$和，$\forall j=!!!!1, \ldots, m-1$ 。

!!!!
\left(a u_{h}\right)^{-}\left(x_{j}\right)=a \frac{u_{h}^{-}\left(x_{j}\right)+u_{h}^{+}\left(x_{j}\right)}{2}-\frac{a}{2}\left(u_{h}^{+}\left(x_{j}\right)-u_{h}^{-}\left(x_{j}\right)\right)=H_{j}\left(u_{h}\right)
$$

验证案例$j=0$是很明显的。

我们有以下稳定性结果

!!!!
\left\|u_{h}(t)\right\|_{\mathrm{L}^{2}(\alpha, \beta)}^{2}+\theta\left(u_{h}(t)\right) \leq\left\|u_{h}^{0}\right\|_{\mathrm{L}^{2}(\alpha, \beta)}^{2}
$$

设有$\left[u_{h}\right]_{j}=u_{h}^{+}\left(x_{j}\right)-u_{h}^{-}\left(x_{j}\right)$，和

!!!!
\theta\left(u_{h}(t)\right)=|a| \int_{0}^{t} \sum_{j=1}^{m-1}\left[u_{h}(t)\right]_{j}^{2} d t
$$

请注意，跳跃也是由初始数据控制的。收敛性分析提供了以下结果（在假设$u_{0} \in \mathrm{H}^{r+1}(\alpha, \beta)$的情况下)

!!!!
\left\|u(t)-u_{h}(t)\right\|_{\mathrm{L}^{2}(\alpha, \beta)} \leq C h^{r+1 / 2}\left|u_{0}\right|_{\mathrm{H}^{r+1}(\alpha, \beta)}
\label{16.19}\end{equation}

因此，收敛顺序$(=r+1 / 2)$大于我们使用连续有限元的收敛顺序$(=r)$，正如之前在线性情况下遇到的那样（见\ref{15.48} ）。在非线性情况下，对于$r=0$，定义seminorm

!!!!
|v|_{T V(\alpha, \beta)}=\sum_{j=0}^{m-1}\left|v_{j+1}-v_{j}\right|, \quad v \in W_{h}
$$

并在\ref{16.16}中采取恩奎斯特-奥舍数值通量，我们有以下结果（归功于N.N. Kuznestov

!!!!
\left\|u(t)-u_{h}(t)\right\|_{L^{1}(\alpha, \beta)} \leq\left\|u_{0}-u_{h}^{0}\right\|_{L^{1}(\alpha, \beta)}+C\left|u_{0}\right|_{T V(\alpha, \beta)} \sqrt{t h}
$$

此外，$\left|u_{h}(t)\right|_{T V(\alpha, \beta)} \leq\left|u_{h}^{0}\right|_{T V(\alpha, \beta)} \leq\left|u_{0}\right|_{T V(\alpha, \beta)}$ 。

\subsubsection{Temporal discretization of DG methods}

对于时间离散化，我们首先将方案\ref{16.14} 写成代数形式

!!!!
\begin{aligned}
&\mathbf{M}_{h} \dot{\mathbf{u}}_{h}(t)=L_{h}\left(\mathbf{u}_{h}(t), t\right), \quad t \in(0, T) \\
&\mathbf{u}_{h}(0)=\mathbf{u}_{h}^{0}
\end{aligned}
$$

$\mathbf{u}_{h}(t)$是自由度的矢量，$L_{h}\left(\mathbf{u}_{h}(t), t\right)$是由通量项$-\frac{\partial F}{\partial x}$离散化产生的矢量，$\mathrm{M}_{h}$是质量矩阵。  $\mathrm{M}_{h}$是一个块状对角矩阵，其$j$第1块是对应于元素$I_{j}$的质量矩阵。如前所述，如果我们求助于Legendre多项式基础，后者是对角线的，它是正交的。

对于时间离散化，除了前面讨论的欧拉方案外，我们可以采用以下二阶Runge-Kutta方法。

!!!!
\begin{aligned}
&\mathrm{M}_{h}\left(\mathbf{u}_{h}^{*}-\mathbf{u}_{h}^{n}\right)=\Delta t L_{h}\left(\mathbf{u}_{h}^{n}, t^{n}\right) \\
&\mathrm{M}_{h}\left(\mathbf{u}_{h}^{* *}-\mathbf{u}_{h}^{*}\right)=\Delta t L_{h}\left(\mathbf{u}_{h}^{*}, t^{n+1}\right) \\
&\mathbf{u}_{h}^{n+1}=\frac{1}{2}\left(\mathbf{u}_{h}^{n}+\mathbf{u}_{h}^{* *}\right)
\end{aligned}
\label{16.20}\end{equation}

在线性问题的情况下（其中$F(u)=a u)$，使用$r=1$这个方案在规范$\|\cdot\|_{\mathrm{L}^{2}(\alpha, \beta)}$中是稳定的，条件是

!!!!
\Delta t \leq \frac{1}{3} \frac{h}{|a|}
$$

是满足的。对于一个任意的$r$，数字证据表明，必须使用$2 r+1$阶的方案，在这种情况下，我们在条件下有稳定性

!!!!
\Delta t \leq \frac{1}{2 r+1} \frac{h}{|a|}
$$

我们报告了三阶Runge-Kutta方案，最好是在 $r=1$ 时使用。

!!!!
\begin{aligned}
&\mathbf{M}_{h}\left(\mathbf{u}_{h}^{*}-\mathbf{u}_{h}^{n}\right)=\Delta t L_{h}\left(\mathbf{u}_{h}^{n}, t^{n}\right) \\
&\mathbf{M}_{h}\left(\mathbf{u}_{h}^{* *}-\left(\frac{3}{4} \mathbf{u}_{h}^{n}+\frac{1}{4} \mathbf{u}_{h}^{*}\right)\right)=\frac{1}{4} \Delta t L_{h}\left(\mathbf{u}_{h}^{*}, t^{n+1}\right) \\
&\mathbf{M}_{h}\left(u_{h}^{n+1}-\left(\frac{1}{3} \mathbf{u}_{h}^{n}+\frac{2}{3} \mathbf{u}_{h}^{* *}\right)\right)=\frac{2}{3} \Delta t L_{h}\left(\mathbf{u}_{h}^{* *}, t^{n+1 / 2}\right)
\end{aligned}
$$

更一般地说，以下的Runge-Kutta方法系列是由$\left[\right.$ Shu88]和[SO88, SO89]提出的。为了便于记数，让我们设定$K_{h}=M_{h}^{-1} L_{h}$ 。然后从$\mathbf{u}_{h}^{n}$得到新的数值$\mathbf{u}_{h}^{n+1}$，如下所示。

1.设置$\mathbf{u}_{h}^{(0)}=\mathbf{u}_{h}^{n}

2.对于 $i=1, \ldots, I$ 计算中间向量 2a) $\mathbf{u}_{h}^{i}=\sum_{p=0}^{i-1} \alpha_{i p} \mathbf{w}_{h}^{i p}$ ,

2b) $\mathbf{w}_{h}^{i p}=\mathbf{u}_{h}^{(p)}+\frac{\beta_{i p}}{\alpha_{i p}} \Delta t^{n} K_{h}\left(\mathbf{u}_{h}^{(p)}\right)$ 。

3.设置$\mathbf{u}_{h}^{n+1}=\mathbf{u}_{h}^{(I)}

系数被要求满足以下条件。

i) 如果 $\beta_{i p} \neq 0$ 则 $\alpha_{i p} \neq 0$ ;

ii) $\alpha_{i p} \geq 0

(积极性)。

iii) $\sum_{p=0}^{i-1} \alpha_{i p}=1 \quad$（一致性）。

让我们对一个任意的半规范$\left|\mathbf{w}_{h}^{i p}\right| \leq\left|\mathbf{u}_{h}^{(p)}\right|$做稳定性假设$|\cdot|$ 那么②和③就可以得到

!!!!
\begin{aligned}
\left|\mathbf{u}_{h}^{(i)}\right| &=\left|\sum_{p=0}^{i-1} \alpha_{i p} \mathbf{w}_{h}^{i p}\right| \leq \sum_{p=0}^{i-1} \alpha_{i p}\left|\mathbf{w}_{h}^{i p}\right| \\
& \leq \sum_{p=0}^{i-1} \alpha_{i p}\left|\mathbf{u}_{h}^{(p)}\right| \leq \max _{0 \leq p \leq i-1}\left|\mathbf{u}_{h}^{(p)}\right|
\end{aligned}
$$

因此，特别是$\left|\mathbf{u}_{h}^{n}\right| \leq\left|\mathbf{u}_{h}^{0}\right| \quad \forall n \geq 0

RK-DG方案在[SGT01]中进行了分析，它们被命名为强保稳方案。

例16.2.让我们重新考虑例$15.2$的问题，我们用不连续的有限元方法来解决这个问题，用三阶Runge-Kutta方案进行时间离散化。我们的范围是通过实验来验证\ref{16.19} 。为此，我们使用了一个非常小的时间步长，$\Delta t=5 \times 10^{-4}$，以及通过反复将初始值$h=12.5 \times 10^{-3}$减半得到的5个递减值的步长$h$。我们比较了度数$r$等于$0,1,2$和$3$的元素在时间$\mathrm{L}^{2}(0,1)$规范中的误差。结果在图16.5中以对数比例报告。这与理论相符，根据该理论，误差在$h^{r+1 / 2}$时趋向于零。事实上，对于$r=1$，在这种特殊情况下，收敛速度比理论预测的要快：数值数据提供了一个非常接近$2$的收敛顺序。在$r>1$的情况下，我们没有报告小于$h$的结果，因为对于这些值（以及选定的$\Delta t$），问题在数值上是不稳定的。

例16.3.让我们考虑与上例相同的线性传输问题，现在使用图$16.6$左侧所示的方波作为初始基准点。由于初始基准是不连续的，使用高阶元素并不能改善收敛顺序，对于所有考虑的$r$的值，其结果都非常接近$1 / 2$的理论值。在图$16.7$中，我们显示了在$r=2$情况下解的不连续附近的振荡，这是收敛性下降的原因，而$r=0$的解表示没有振荡。

![](https://cdn.mathpix.com/cropped/991f5db518e324d299c1ff4972bba9fb-065.jpg?height=328&width=405&top_left_y=113&top_left_x=254)

图16.5.使用程度为$r=0,1,2,3$的不连续有限元求解具有规则初始基准的线性传输问题得到的误差$\left\|u-u_{h}\right\|_{L^{2}(0,1)}$ 。误差是在时间$t=0.01$计算的。时间推进方案是三阶Runge-Kutta方案，时间步长$\Delta t=5 \times 10^{-4}$ 。
 ![](https://cdn.mathpix.com/cropped/991f5db518e324d299c1ff4972bba9fb-065.jpg?height=262&width=674&top_left_y=564&top_left_x=120)

图 16.6.误差$\left\|u-u_{h}\right\|_{\mathrm{L}^{2}(0,1)}$通过解决一个线性传输问题得到的，初始基准在左图中说明。我们使用了度数$r$等于0、1、2和3的不连续有限元。误差是在时间$t=0.01$计算的。时间进度方案是三阶Runge-Kutta方案，$\Delta t=5 \times 10^{-4}$ 。

在非线性问题的情况下，使用$r=0$的二阶Runge-Kutta方案，在\ref{16.13}的条件下我们得到

!!!!
\left|u_{h}^{n}\right|_{T V(\alpha, \beta)} \leq\left|u_{0}\right|_{T V(\alpha, \beta)},
$$

即在规范$|\cdot|_{T V(\alpha, \beta)}$中的强稳定性。

当我们不求助于单调方案时，要获得强稳定性就更难了。在这种情况下，我们可以把自己限制在保证局部平均数的总变化是均匀有界的。(见[Coc98] 。)

例16.4.这个例子说明了非线性问题的一个典型特征，那就是即使我们从一个规则的初始基准点开始，也会出现不连续的情况。对这个
 ![](https://cdn.mathpix.com/cropped/991f5db518e324d299c1ff4972bba9fb-066.jpg?height=268&width=702&top_left_y=117&top_left_x=104)

图16.7.图16.6的测试案例在时间$t=0.01$和$h=3.125 \times 10^{-3}$的解。左边是$r=3$的情况：注意在不连续处存在振荡，而其他地方的解是准确的。在右侧，我们显示了对$r=0$使用相同的空间和时间离散化时得到的解。

最后，我们考虑在$(0,1)$区间的布尔格斯方程\ref{16.2} ，初始基准（见图16.8）。

!!!!
u_{0}(x)= \begin{cases}1, & 0 \leq x \leq \frac{5}{12} \\ 54\left(2 x-\frac{5}{6}\right)^{3}-27\left(2 x-\frac{5}{6}\right)^{2}+1, & \frac{5}{12}<x<\frac{7}{12} \\ 0, & \frac{7}{12} \leq x \leq 1\end{cases}
$$

可以很容易地验证，图16.8所示的$u_{0}$，是属于$C^{1}(0,1)$类。

然后我们考虑了用非连续Galerkin方法得到的数值解，使用三阶Runge-Kutta方案，时间步长为$\Delta t=$ $10^{-3}$ 和 $h=0.01$ ，为$r=0, r=1$ 和 $r=2$ 。图$16.9$显示了用这种方案得到的时间$t=0.5$的解。我们可以注意到一个不连续的出现，在$r=0$的情况下，数值方案的解决没有振荡，而对于$r$的较大值，我们在不连续本身的附近有振荡。

![](https://cdn.mathpix.com/cropped/991f5db518e324d299c1ff4972bba9fb-066.jpg?height=265&width=340&top_left_y=933&top_left_x=284)

图16.8.伯格斯问题的第一个测试案例的初始解$u_{0}$。
 ![](https://cdn.mathpix.com/cropped/991f5db518e324d299c1ff4972bba9fb-067.jpg?height=532&width=696&top_left_y=119&top_left_x=110)

图16.9.伯格斯问题的第一个测试案例在时间$t=0.5$的解决方案。比较$r=0$（左上）、$r=1$（右上）和$r=2$（下）的数值解。对于$r=0$的情况，用虚线连接每个元素的中点，突出了片状常数的离散解。

为了消除溶液不连续点附近的振荡，我们可以使用涉及通量限制器的技术，其描述超出了本书的范围。关于这一点，我们请读者参考之前引用的书目。我们只想说，三阶Runge-Kutta方案\ref{16.20}被修改如下

!!!!
\begin{aligned}
&\mathbf{u}_{h}^{*}=\Lambda_{h}\left(\mathbf{u}_{h}^{n}+\Delta t \mathbf{M}_{h}^{-1} L_{h}\left(\mathbf{u}_{h}^{n}, t^{n}\right)\right) \\
&\mathbf{u}_{h}^{* *}=\Lambda_{h}\left(\frac{3}{4} \mathbf{u}_{h}^{n}+\frac{1}{4} \mathbf{u}_{h}^{*}+\frac{1}{4} \Delta t \mathbf{M}_{h}^{-1} L_{h}\left(\mathbf{u}_{h}^{*}, t^{n+1}\right)\right) \\
&\mathbf{u}_{h}^{n+1}=\Lambda_{h}\left(\frac{1}{3} \mathbf{u}_{h}^{n}+\frac{2}{3} \mathbf{u}_{h}^{* *}+\frac{2}{3} \Delta t \mathbf{M}_{h}^{-1} L_{h}\left(\mathbf{u}_{h}^{* *}, t^{n+1 / 2}\right)\right)
\end{aligned}
$$

$\Lambda_{h}$是通量限制器，这也是一个取决于计算出的解的变化的函数，即两个相邻节点的值之间的差异。在解是有规律的情况下，这等于身份算子，而如果这些变化导致数值解的高频振荡，它就会限制其变化。显然，$\Lambda_{h}$必须以合适的方式构建，特别是它必须保持方案的一致性和守恒性，并且必须尽可能地与同一算子不同，以防止精度下降。

![](https://cdn.mathpix.com/cropped/991f5db518e324d299c1ff4972bba9fb-068.jpg?height=258&width=332&top_left_y=119&top_left_x=292)

图16.10.在时间$t=0.5$对Burgers问题的第一个测试案例的解。它是在$r=1$时得到的，并通过应用通量限制器技术使不连续点附近的数值解正规化

为了举例说明，我们在图$16.10$中报告了用线性不连续有限元$(r=1)$对图$16.9$中的相同试验案例应用通量限制器得到的结果。得到的数值解更有规律，尽管比图16.9的数值解稍有扩散性。

例16.5。现在让我们考虑第二个问题，初始基准是图16.11，通过对前一个测试案例的基准线$x=0.5$进行反射得到。通过保持数值模拟的所有其余参数不变，我们再次检查$t=0.5$处的解决方案。后者如图16.12所示。在这种情况下，解仍然是连续的；事实上，在这种初始条件下，特征线（在布尔格斯方程的情况下是平面$(x, t)$中的直线，斜率$\left.\arctan u^{-1}\right)$）从未交叉。通过放大，可以从质量上体会到在$r=2$下得到的解决方案比在$r=1$下得到的解决方案更准确。

![](https://cdn.mathpix.com/cropped/991f5db518e324d299c1ff4972bba9fb-068.jpg?height=254&width=333&top_left_y=943&top_left_x=290)

图16.11.伯格斯问题的第二个测试案例的初始解$u_{0}$。
 ![](https://cdn.mathpix.com/cropped/991f5db518e324d299c1ff4972bba9fb-069.jpg?height=278&width=700&top_left_y=118&top_left_x=107)

图16.12.在时间$t=0.5$对Burgers问题的第二个测试案例的解决方案。在$r=1$获得的解决方案（左）与$r=2$获得的解决方案（右）之间的比较。在方框中，我们说明了数字解决方案的放大，这使得我们可以定性地掌握对$r=2$获得的改进的精度。

\subsection{Nonlinear hyperbolic systems}

在这最后一节中，我们简要地讨论一下非线性双曲系统的情况。一个经典的例子是由欧拉方程提供的，欧拉方程是由$\mathbb{R}^{d}, d=1,2,3$中的以下Navier-Stokes方程（用于可压缩流体）得到的。

!!!!
\begin{aligned}
&\frac{\partial \rho}{\partial t}+\sum_{j=1}^{d} \frac{\partial\left(\rho u_{j}\right)}{\partial x_{j}}=0 \\
&\frac{\partial\left(\rho u_{i}\right)}{\partial t}+\sum_{j=1}^{d}\left[\frac{\partial\left(\rho u_{i} u_{j}+\delta_{i j} p\right)}{\partial x_{j}}-\frac{\partial \tau_{i j}}{\partial x_{j}}\right]=0, \quad i=1, \ldots, d \\
&\frac{\partial \rho e}{\partial t}+\sum_{j=1}^{d}\left[\frac{\partial\left(\rho h u_{j}\right)}{\partial x_{j}}-\frac{\partial\left(\sum_{i=1}^{d} u_{i} \tau_{i j}+q_{j}\right)}{\partial x_{j}}\right]=0
\end{aligned}
\label{16.21}\end{equation}

变量具有以下含义。  $\mathbf{u}=\left(u_{1}, \ldots, u_{d}\right)^{T}$是速度矢量，$\rho$是密度，$p$是压力，$e_{i}+\frac{1}{2}|\mathbf{u}|^{2}$是单位质量的总能量，等于内能$e_{i}$和流体动能之和，$h=e+p / \rho$是单位质量的总焓，$\mathbf{q}$是热流量，最后是

!!!!
\tau_{i j}=\mu\left[\left(\frac{\partial u_{j}}{\partial x_{i}}+\frac{\partial u_{i}}{\partial x_{j}}\right)-\frac{2}{3} \delta_{i j} \operatorname{divu}\right], \quad i, j=1, \ldots, d
$$

应力张量（$\mu$是流体的分子粘度）。

上述系统中的方程分别描述了质量、动量和能量的守恒。为了完成这个系统，有必要把$e$与变量$\rho, p, \mathbf{u}$联系起来，通过定义一个规律

!!!!
e=\Phi(\rho, p, \mathbf{u})
$$

后者通常是由被测流体的状态方程导出。特别是，理想气体的状态方程

!!!!
p=\rho R T, \quad e_{i}=C_{v} T
$$

其中$R=C_{p}-C_{v}$是气体常数，$T$是其温度，提供

!!!!
e=\frac{p}{\rho(\gamma-1)}+\frac{1}{2}|\mathbf{u}|^{2}
$$

其中$\gamma=C_{p} / C_{v}$分别是恒定压力和体积下的比热之比。热通量$\mathbf{q}$通常通过菲克定律与温度梯度有关

!!!!
\mathbf{q}=-\kappa \nabla T=-\frac{\kappa}{C_{v}} \nabla\left(e-\frac{1}{2}|\mathbf{u}|^{2}\right)
$$

$\kappa$是被测流体的导电性。

如果$\mu=0$和$\kappa=0$，我们得到非粘性流体的欧拉方程。有兴趣的读者可以在专门的流体力学教科书或非线性双曲系统的教科书中找到它们，例如 [Hir88] 或 [GR96] 。这种方程可以用以下方式写成紧凑的形式

!!!!
\frac{\partial \mathbf{w}}{\partial t}+\operatorname{Div} F(\mathbf{w})=\mathbf{0}
\label{16.22}\end{equation}

其中$\mathbf{w}=(\rho, \rho \mathbf{u}, \rho e)^{T}$是所谓保守变量的向量。通量矩阵$F(\mathbf{w})$，是$\mathbf{w}$的非线性函数，可以从\ref{16.21} 得到。例如，如果$d=2$ ，我们有

!!!!
F(\mathbf{w})=\left[\begin{array}{cc}
\rho u_{1} & \rho u_{2} \\
\rho u_{1}^{2}+p & \rho u_{1} u_{2} \\
\rho u_{1} u_{2} & \rho u_{2}^{2}+p \\
\rho h u_{1} & \rho h u_{2}
\end{array}\right]
$$

最后，在\ref{16.22} 中，Div表示张量的发散算子：如果$\tau$是一个张量，其分量为$\left(\tau_{i j}\right)$，其发散是一个矢量，分量为

!!!!
(\operatorname{Div}(\tau))_{k}=\sum_{j=1}^{d} \frac{\partial}{\partial x_{j}}\left(\tau_{k j}\right), \quad k=1, \ldots, d
\label{16.23}\end{equation}

形式\ref{16.22} 被称为欧拉方程的守恒形式。事实上，通过在任何区域$\Omega \subset \mathbb{R}^{d}$上积分并使用高斯定理，我们得到

!!!!
\frac{d}{d t} \int_{\Omega} \mathbf{w} d \Omega+\int_{\partial \Omega} F(\mathbf{w}) \cdot \mathbf{n} d \gamma=0
$$

这可以解释为：$\mathbf{w}$在$\Omega$中的时间变化被通过$\Omega$ ;\ref{16.22}边界的通量变化所补偿，因此是一个守恒法。纳维-斯托克斯方程也可以写成保守形式如下

!!!!
\frac{\partial \mathbf{w}}{\partial t}+\operatorname{Div} F(\mathbf{w})=\operatorname{Div} G(\mathbf{w})
$$

其中$G(\mathbf{w})$是所谓的粘性通量。在$d=2$的情况下，这些通量由以下公式给出

!!!!
G(\mathbf{w})=\left[\begin{array}{cc}
0 & 0 \\
\tau_{11} & \tau_{12} \\
\tau_{21} & \tau_{22} \\
\rho h u_{1}+\mathbf{u} \cdot \tau_{1}+q_{1} & \rho h u_{2}+\mathbf{u} \cdot \tau_{2}+q_{2}
\end{array}\right]
$$

其中 $\tau_{1}=\left(\tau_{11}, \tau_{21}\right)^{T}$ 和 $\tau_{2}=\left(\tau_{12}, \tau_{22}\right)^{T}$ .

我们现在将系统\ref{16.22} 改写成以下形式

!!!!
\frac{\partial \mathbf{w}}{\partial t}+\sum_{i=1}^{d} \frac{\partial F_{i}(\mathbf{w})}{\partial \mathbf{w}} \frac{\partial \mathbf{w}}{\partial x_{i}}=0
\label{16.24}\end{equation}

这是以下准线性形式的一个特殊情况

!!!!
\frac{\partial \mathbf{w}}{\partial t}+\sum_{i=1}^{d} A_{i}(\mathbf{w}) \frac{\partial \mathbf{w}}{\partial x_{i}}=\mathbf{0}
\label{16.25}\end{equation}

如果矩阵$A^{\alpha}(\mathbf{w})=\sum_{i=1}^{d} \alpha_{i} A_{i}(\mathbf{w})$对于$\left\{\alpha_{1}, \ldots, \alpha_{d}\right\}$的所有实值都可以对角化，并且其特征值是实数且不同，那么系统\ref{16.25}被称为严格双曲。

例16.6.所谓$p$-系统提供了一个严格双曲问题的简单例子。

!!!!
\begin{aligned}
&\frac{\partial v}{\partial t}-\frac{\partial u}{\partial x}=0 \\
&\frac{\partial u}{\partial t}+\frac{\partial}{\partial x} p(v)=0
\end{aligned}
$$

如果$p^{\prime}(v)<0$ ，雅各布矩阵的两个特征值

!!!!
A(\mathbf{w})=\left(\begin{array}{cc}
0 & -1 \\
p^{\prime}(v) & 0
\end{array}\right)
$$

是

!!!!
\lambda_{1}(v)=-\sqrt{-p^{\prime}(v)}<0<\lambda_{2}(v)=+\sqrt{-p^{\prime}(v)}
$$

例16.7.对于一维欧拉系统（即用$d=1)$我们有。  $\mathbf{w}=$ $(\rho, \rho u, e)^{T}$ 和 $F(\mathbf{w})=\left(\rho u, \rho u^{2}+p, u(e+p)\right)^{T}$ 。系统的矩阵$A_{1}(\mathbf{w})$的特征值为$u-c, u, u+c$，其中$c=\sqrt{\gamma \frac{p}{\rho}}$为音速。由于$u, c \in \mathbb{R}$的特征值是实数且不同，因此一维欧拉系统是严格双曲的。在标量情况下对解的不连续性所做的评论可以扩展到系统的情况，通过引入弱解的概念也在这里。熵条件可以扩展到系统的情况，例如使用Lax提出的条件。我们注意到，在一维系统\ref{16.22} 的情况下，Rankine-Hugoniot跳跃条件被写成以下形式

!!!!
F\left(\mathbf{w}_{+}\right)-F\left(\mathbf{w}_{-}\right)=\sigma\left(\mathbf{w}_{+}-\mathbf{w}_{-}\right)
$$

$\mathbf{w}_{\pm}$是两个常数状态，代表通过不连续的未知数的值，$\sigma$再次代表不连续传播的速度。利用微积分的基本定理，这种关系可以写成以下形式

!!!!
\begin{aligned}
\sigma\left(\mathbf{w}_{+}-\mathbf{w}_{-}\right) &=\int_{0}^{1} D F\left(\theta \mathbf{w}_{+}+(1-\theta) \mathbf{w}_{-}\right) \cdot\left(\mathbf{w}_{+}-\mathbf{w}_{-}\right) d \theta \\
&=A\left(\mathbf{w}_{-}, \mathbf{w}_{+}\right) \cdot\left(\mathbf{w}_{+}-\mathbf{w}_{-}\right)
\end{aligned}
\label{16.26}\end{equation}

其中矩阵

!!!!
A\left(\mathbf{w}_{-}, \mathbf{w}_{+}\right)=\int_{0}^{1} D F\left(\theta \mathbf{w}_{+}+(1-\theta) \mathbf{w}_{-}\right) d \theta
$$

代表$F$的雅各布系数的平均值（用$D F$表示）沿着连接$\mathbf{w}_{-}$和$\mathbf{w}_{+}$的部分。关系\ref{16.26} 表明，在发生不连续的每一点上，左右状态$\mathbf{w}_{+}-\mathbf{w}_{-}$之间的差异是矩阵$A\left(\mathbf{w}_{-}, \mathbf{w}_{+}\right)$的一个特征向量，而跳跃率$\sigma$与相应的特征值$\lambda=\lambda\left(\mathbf{w}_{-}, \mathbf{w}_{+}\right)$相吻合。

!!!!
A(\mathbf{w})=D F(\mathbf{w})
$$

Lax的可接受性条件要求

!!!!
\lambda_{i}\left(\mathbf{w}_{+}\right) \leq \sigma \leq \lambda_{i}\left(\mathbf{w}_{-}\right) \quad \text { for each i. }
$$

直观地说，这意味着$i-$族的冲击的速度必须超过紧随冲击前面的波的速度$\lambda_{i}\left(\mathbf{w}_{+}\right)$，并且必须小于冲击后面的波的速度$\lambda_{i}\left(\mathbf{w}_{-}\right)$。

在$m$方程$(m>1)$的双曲系统的情况下，熵$\eta$和其相应的通量$\Psi$仍然是标量函数，关系\ref{16.5}变为

!!!!
\nabla \Psi(\mathbf{u})=\frac{d \mathbf{F}}{d \mathbf{u}}(\mathbf{u}) \cdot \nabla \eta(\mathbf{u})
\label{16.27}\end{equation}

表示一个$m$方程组和2个未知数$(\eta$和$\Psi)$。如果$m>2$ ，这个系统可能没有解。

备注16.2。在欧拉方程的情况下，熵函数在$m=3$的情况下也存在。

\section{Navier-Stokes equations}

纳维-斯托克斯方程描述了密度恒定的流体$\rho$在域$\Omega \subset \mathbb{R}^{d}$中的运动（与$\left.d=2,3\right)$ .其内容如下

!!!!
\begin{cases}\frac{\partial \mathbf{u}}{\partial t}-\operatorname{div}\left[v\left(\nabla \mathbf{u}+\nabla \mathbf{u}^{T}\right)\right]+(\mathbf{u} \cdot \nabla) \mathbf{u}+\nabla p=\mathbf{f}, & \mathbf{x} \in \Omega, t>0 \\ \operatorname{div} \mathbf{u}=0, & \mathbf{x} \in \Omega, t>0\end{cases}
\label{17.1}\end{equation}

$\mathbf{u}$是流体的速度，$p$是压力除以密度（将简单地称为 "压力"），$v$是运动粘度，以及$\mathbf{f}$是我们认为属于$\mathrm{L}^{2}\left(\mathbb{R}^{+} ;\left[\mathrm{L}^{2}(\Omega)\right]^{d}\right)$的单位质量的强制项（见第5.2节）。第一个方程是线性动量守恒方程，第二个方程是质量守恒方程，这也被称为连续性方程。术语$(\mathbf{u} \cdot \nabla) \mathbf{u}$描述了对流运输的过程，而$-\operatorname{div}\left[v\left(\nabla \mathbf{u}+\nabla \mathbf{u}^{T}\right)\right]$描述了分子扩散的过程。系统\ref{17.1} 可以由第16章介绍的可压缩流动的类似系统推导出来，假设$\rho$为常数，使用连续性方程（在目前的假设下，采取简化形式$\operatorname{div} \mathbf{u}=0$）来简化各种项，最后用$\rho$除以该方程。注意，在不可压缩的情况下\ref{17.2} ，能量方程已经消失了。事实上，即使这样的方程仍然可以写成不可压缩流，一旦从\ref{17.1}的解中得到速度场，就可以独立找到它的解。

当$v$为常数时，从连续性方程中我们可以得到

!!!!
\operatorname{div}\left[v\left(\nabla \mathbf{u}+\nabla \mathbf{u}^{T}\right)\right]=v(\Delta \mathbf{u}+\nabla \operatorname{div} \mathbf{u})=v \Delta \mathbf{u}
$$

因此，系统\ref{17.1} 可以写成等效形式

!!!!
\begin{cases}\frac{\partial \mathbf{u}}{\partial t}-v \Delta \mathbf{u}+(\mathbf{u} \cdot \nabla) \mathbf{u}+\nabla p=\mathbf{f}, & \mathbf{x} \in \Omega, t>0 \\ \operatorname{div} \mathbf{u}=0, & \mathbf{x} \in \Omega, t>0\end{cases}
\label{17.2}\end{equation}

这就是我们在本章要考虑的问题。

方程\ref{17.2} 通常被称为不可压缩的Navier-Stokes方程。更一般地说，满足不可压缩性条件$\operatorname{div} \mathbf{u}=0$的流体被称为不可压缩的。恒定密度的流体必然满足这一条件，然而，存在着以可变密度为特征的不可压缩流体（例如，分层流体），它们受不同的方程组支配，其中密度$\rho$明确地显示出来。这种情况将在第17.9节讨论。

为了使问题\ref{17.2} 得到很好的解决，有必要指定初始条件

!!!!
\mathbf{u}(\mathbf{x}, 0)=\mathbf{u}_{0}(\mathbf{x}) \quad \forall \mathbf{x} \in \Omega
\label{17.3}\end{equation}

其中$\mathbf{u}_{0}$是一个给定的无发散矢量场，加上合适的边界条件，例如$\forall t>0$ 。

!!!!
\left\{\begin{array}{l}
\mathbf{u}(\mathbf{x}, t)=\boldsymbol{\varphi}(\mathbf{x}, t) \quad \forall \mathbf{x} \in \Gamma_{D} \\
\left(v \frac{\partial \mathbf{u}}{\partial \mathbf{n}}-p \mathbf{n}\right)(\mathbf{x}, t)=\boldsymbol{\psi}(\mathbf{x}, t) \quad \forall \mathbf{x} \in \Gamma_{N}
\end{array}\right.
\label{17.4}\end{equation}

其中$\varphi$和$\psi$是给定的矢量函数，而$\Gamma_{D}$和$\Gamma_{N}$提供了领域边界$\partial \Omega$的划分，即$\Gamma_{D} \cup \Gamma_{N}=\partial \Omega, \dot{\Gamma}_{D} \cap \stackrel{\circ}{\Gamma_{N}}=\emptyset$。最后，像往常一样$\mathbf{n}$是对$\partial \Omega$的外向单位法向量。如果我们使用另一种表述\ref{17.1} ，\ref{17.4} 中的第二个方程必须被替换为

!!!!
\left[v\left(\nabla \mathbf{u}+\nabla \mathbf{u}^{T}\right) \mathbf{n}-p \mathbf{n}\right](\mathbf{x}, t)=\psi(\mathbf{x}, t) \quad \forall \mathbf{x} \in \Gamma_{N}
$$

关于边界条件的进一步考虑将在第17.9.2节进行。

用$u_{i}, i=1, \ldots, d$表示矢量$\mathbf{u}$相对于笛卡尔框架的分量，用$f_{i}$表示$\mathbf{f}$的分量，系统\ref{17.2} 可以被写成

!!!!
\left\{\begin{array}{l}
\frac{\partial u_{i}}{\partial t}-v \Delta u_{i}+\sum_{j=1}^{d} u_{j} \frac{\partial u_{i}}{\partial x_{j}}+\frac{\partial p}{\partial x_{i}}=f_{i}, \quad i=1, \ldots, d \\
\sum_{j=1}^{d} \frac{\partial u_{j}}{\partial x_{j}}=0
\end{array}\right.
$$

在二维情况下，纳维-斯托克斯方程与前面提到的边界条件产生了良好解决的问题。这意味着，如果所有的数据（初始条件、强制项、边界数据）都足够平滑，那么，解与它的导数一起是连续的，在时间上不会出现奇点。在三维空间中，情况可能有所不同，经典解的存在性和唯一性仅在时间上被证明（即对于一个足够小的时间间隔）。在下一节中，我们将介绍纳维-斯托克斯方程的弱表述，对于该方程而言，其解的存在性在所有时间内都已被证明。然而，唯一性的问题（与正则性的问题有关）仍然是开放的，实际上是纳维-斯托克斯理论的核心问题。备注17.1。纳维-斯托克斯方程是以原始变量$\mathbf{u}$和$p$来写的，但也可以使用其他的变量集。例如，在二维情况下，常见的是涡度$\omega$和流函数$\psi$，它们与速度的关系如下所示

!!!!
\omega=\operatorname{rot} \mathbf{u}=\frac{\partial u_{2}}{\partial x_{1}}-\frac{\partial u_{1}}{\partial x_{2}}, \quad \mathbf{u}=\left[\begin{array}{c}
\frac{\partial \psi}{\partial x_{2}} \\
-\frac{\partial \psi}{\partial x_{1}}
\end{array}\right]
$$

从数学的角度来看，各种公式实际上是等价的，尽管它们引起了不同的数字方法。例如，见 [Qua93] 。

\subsection{Weak formulation of Navier-Stokes equations}

问题\ref{17.2} -\ref{17.4} 的弱表述可以通过正式进行得到，如下。让我们用属于适当空间$V$的测试函数$\mathbf{v}$乘以\ref{17.2}的第一个方程，并对$\Omega$进行积分。

!!!!
\int_{\Omega} \frac{\partial \mathbf{u}}{\partial t} \cdot \mathbf{v} d \Omega-\int_{\Omega} v \Delta \mathbf{u} \cdot \mathbf{v} d \Omega+\int_{\Omega}[(\mathbf{u} \cdot \nabla) \mathbf{u}] \cdot \mathbf{v} d \Omega+\int_{\Omega} \nabla p \cdot \mathbf{v} d \Omega=\int_{\Omega} \mathbf{f} \cdot \mathbf{v} d \Omega
$$

使用格林公式\ref{3.16} 和\ref{3.17} ，我们发现。

!!!!
\begin{aligned}
-\int_{\Omega} v \Delta \mathbf{u} \cdot \mathbf{v} d \Omega &=\int_{\Omega} v \nabla \mathbf{u} \cdot \nabla \mathbf{v} d \Omega-\int_{\partial \Omega} v \frac{\partial \mathbf{u}}{\partial \mathbf{n}} \cdot \mathbf{v} d \gamma \\
\int_{\Omega} \nabla p \cdot \mathbf{v} d \Omega &=-\int_{\Omega} p \operatorname{div} \mathbf{v} d \Omega+\int_{\partial \Omega} p \mathbf{v} \cdot \mathbf{n} d \gamma
\end{aligned}
$$

在\ref{17.2} 的第一条中使用这些关系，我们得到

!!!!
\begin{aligned}
\int_{\Omega} \frac{\partial \mathbf{u}}{\partial t} \cdot \mathbf{v} d \Omega+\int_{\Omega} v \nabla \mathbf{u} \cdot \nabla \mathbf{v} d \Omega+\int_{\Omega}[(\mathbf{u} \cdot \nabla) \mathbf{u}] \cdot \mathbf{v} d \Omega-\int_{\Omega} p \operatorname{div} \mathbf{v} d \Omega \\
&=\int_{\Omega} \mathbf{f} \cdot \mathbf{v} d \Omega+\int_{\partial \Omega}\left(v \frac{\partial \mathbf{u}}{\partial \mathbf{n}}-p \mathbf{n}\right) \cdot \mathbf{v} d \gamma \quad \forall \mathbf{v} \in V
\end{aligned}
\label{17.5}\end{equation}

(所有的边界积分确实应该被看作是对偶性的配对)。

同样，通过将\ref{17.2}的第二个方程乘以测试函数$q$，属于要指定的合适空间$Q$，然后在$\Omega$上积分，可以看出

!!!!
\int_{\Omega} q \operatorname{divu} d \Omega=0 \quad \forall q \in Q
\label{17.6}\end{equation}

通常选择$V$，使测试函数在边界部分消失，其中迪里希特数据在$\mathbf{u}$上被规定，即

!!!!
V=\left[\mathrm{H}_{\Gamma_{D}}^{1}(\Omega)\right]^{d}=\left\{\mathbf{v} \in\left[\mathrm{H}^{1}(\Omega)\right]^{d}:\left.\mathbf{v}\right|_{\Gamma_{D}}=\mathbf{0}\right\}
\label{17.7}\end{equation}

如果$\Gamma_{D}=\partial \Omega$，它将与$\left[\mathrm{H}_{0}^{1}(\Omega)\right]^{d}$相吻合。如果$\Gamma_{N} \neq \emptyset$ ，我们可以选择$Q=\mathrm{L}^{2}(\Omega)$ 。此外，如果$t>0$ ，那么$\mathbf{u}(t) \in\left[\mathrm{H}^{1}(\Omega)\right]^{d}$ ，与$\mathbf{u}(t)=\varphi(t)$ 在$\Gamma_{D}, \mathbf{u}(0)=\mathbf{u}_{0}$ 和$p(t) \in Q$ 上。

在选择了这些函数空间后，我们首先可以注意到

!!!!
\int_{\partial \Omega}\left(v \frac{\partial \mathbf{u}}{\partial \mathbf{n}}-p \mathbf{n}\right) \cdot \mathbf{v} d \gamma=\int_{\Gamma_{N}} \psi \cdot \mathbf{v} d \gamma \quad \forall \mathbf{v} \in V
$$

此外，所有涉及双线性项的积分都是有限的。更确切地说，通过使用矢量符号$\mathbf{H}^{k}(\Omega)=\left[\mathrm{H}^{k}(\Omega)\right]^{d}, \mathbf{L}^{p}(\Omega)=\left[\mathrm{L}^{p}(\Omega)\right]^{d}, k \geq 1,1 \leq p<\infty$，我们发现。

!!!!
\begin{aligned}
&\left|v \int_{\Omega} \nabla \mathbf{u} \cdot \nabla \mathbf{v} d \Omega\right| \leq v|\mathbf{u}|_{\mathbf{H}^{1}(\Omega)}|\mathbf{v}|_{\mathbf{H}^{1}(\Omega)} \\
&\left|\int_{\Omega} p \operatorname{div} \mathbf{v} d \Omega\right| \leq\|p\|_{\mathrm{L}^{2}(\Omega)}|\mathbf{v}|_{\mathbf{H}^{1}(\Omega)} \\
&\left|\int_{\Omega} q \nabla \mathbf{u} d \Omega\right| \leq\|q\|_{\mathrm{L}^{2}(\Omega)}|\mathbf{u}|_{\mathbf{H}^{1}(\Omega)}
\end{aligned}
$$

对于每个函数$\mathbf{v} \in \mathbf{H}^{1}(\Omega)$，我们用以下方式表示

!!!!
\|\mathbf{v}\|_{\mathbf{H}^{1}(\Omega)}=\left(\sum_{k=1}^{d}\left\|v_{k}\right\|_{\mathrm{H}^{1}(\Omega)}^{2}\right)^{1 / 2}
$$

其规范和由

!!!!
|\mathbf{v}|_{\mathbf{H}^{1}(\Omega)}=\left(\sum_{k=1}^{d}\left|v_{k}\right|_{\mathrm{H}^{1}(\Omega)}^{2}\right)^{1 / 2}
$$

其seminorm。符号$\|\mathbf{v}\|_{\mathbf{L}^{p}(\Omega)}, 1 \leq p<\infty$ ，具有类似的含义。在张量函数的情况下，将使用同样的符号。由于Poincaré的不等式，对于属于$V$的所有函数，$|\mathbf{v}|_{\mathbf{H}^{1}(\Omega)}$等同于$\operatorname{norm}\|\mathbf{v}\|_{\mathbf{H}^{1}(\Omega)}$。

而且涉及三线项的积分是有限的。为了说明这一点，让我们首先回顾以下结果（见\ref{2.19}；关于其证明，见[AF03]）：如果$d \leq 3$ ,

!!!!
\forall \mathbf{v} \in \mathbf{H}^{1}(\Omega), \text { then } \mathbf{v} \in \mathbf{L}^{4}(\Omega) \text { and } \exists C>0 \text { s.t. }\|\mathbf{v}\|_{\mathbf{L}^{4}(\Omega)} \leq C\|\mathbf{v}\|_{\mathbf{H}^{1}(\Omega)}
$$

使用以下三期霍尔德不等式

!!!!
\left|\int_{\Omega} f g h d \Omega\right| \leq\|f\|_{L^{p}(\Omega)}\|g\|_{\mathrm{L}^{q}(\Omega)}\|h\|_{\mathrm{L}^{r}(\Omega)}
$$

对所有$p, q, r>1$有效，如$p^{-1}+q^{-1}+r^{-1}=1$，我们得出的结论是

!!!!
\left|\int_{\Omega}[(\mathbf{u} \cdot \nabla) \mathbf{u}] \cdot \mathbf{v} d \Omega\right| \leq\|\nabla \mathbf{u}\|_{\mathbf{L}^{2}(\Omega)}\|\mathbf{u}\|_{\mathbf{L}^{4}(\Omega)}\|\mathbf{v}\|_{\mathbf{L}^{4}(\Omega)} \leq C^{2}\|\mathbf{u}\|_{\mathbf{H}^{1}(\Omega)}^{2}\|\mathbf{v}\|_{\mathbf{H}^{1}(\Omega)}
$$

至于解决方案的唯一性，让我们再次考虑强形式的Navier-Stokes方程\ref{17.2}（对弱形式的\ref{17.5}、\ref{17.6}也可以做类似的考虑）。如果$\Gamma_{D}=\partial \Omega$，当只施加迪里切特类型的边界条件时，压力仅以其梯度出现；在这种情况下，如果我们称$(\mathbf{u}, p)$为\ref{17.2}的解，对于任何可能的常数$c$，耦合$(\mathbf{u}, p+c)$也是一个解，因为$\nabla(p+c)=\nabla p$ 。为了避免这种不确定性，我们可以先验地固定$p$在域$\Omega$的一个给定点$\mathbf{x}_{0}$的值，也就是设定$p\left(\mathbf{x}_{0}\right)=p_{0}$，或者，要求压力具有空平均，即$\int_{\Omega} p d \Omega=0$。前一个条件要求为压力规定一个点状值，但这与我们的Ansatz$p \in \mathrm{L}^{2}(\Omega)$不一致。 然而，我们预计，当我们寻找一个连续的有限维压力时，这在数值层面上是可以接受的。由于这个原因，我们从现在开始假设压力是无平均的。更具体地说，我们将考虑以下压力空间

!!!!
\mathrm{Q}=\mathrm{L}_{0}^{2}(\Omega)=\left\{p \in \mathrm{L}^{2}(\Omega): \int_{\Omega} p d \Omega=0\right\}
$$

此外，我们观察到，如果$\Gamma_{D}=\partial \Omega$，规定的迪里希特数据$\varphi$必须与不可压缩性约束兼容；事实上。

!!!!
\int_{\partial \Omega} \boldsymbol{\varphi} \cdot \mathbf{n} d \gamma=\int_{\Omega} \operatorname{div} \mathbf{u} \mathrm{d} \Omega=0
$$

如果$\Gamma_{N}$不是空的，即在存在诺伊曼或混合迪里希勒-诺伊曼边界条件的情况下，压力不确定的问题（直到一个可加常数）不再存在。在这种情况下，我们可以采取 $\mathrm{Q}=\mathrm{L}^{2}(\Omega)$ 。总之，从现在开始，我们将隐含地假定

!!!!
Q=\mathrm{L}^{2}(\Omega) \quad \text { if } \quad \Gamma_{N} \neq \emptyset, \quad Q=\mathrm{L}_{0}^{2}(\Omega) \quad \text { if } \Gamma_{N}=\emptyset
\label{17.8}\end{equation}

因此，系统的弱表述\ref{17.2},\ref{17.3},\ref{17.4}是。

找到$\mathbf{u} \in \mathrm{L}^{2}\left(\mathbb{R}^{+} ;\left[\mathrm{H}^{1}(\Omega)\right]^{d}\right) \cap C^{0}\left(\mathbb{R}^{+} ;\left[\mathrm{L}^{2}(\Omega)\right]^{d}\right), p \in \mathrm{L}^{2}\left(\mathbb{R}^{+} ; Q\right)$，以便于

!!!!
\left\{\begin{aligned}
\int_{\Omega} \frac{\partial \mathbf{u}}{\partial t} \cdot \mathbf{v} d \Omega+v \int_{\Omega} \nabla \mathbf{u} \cdot \nabla \mathbf{v} d \Omega+\int_{\Omega}[(\mathbf{u} \cdot \nabla) \mathbf{u}] \cdot \mathbf{v} d \Omega-\int_{\Omega} p \operatorname{div} \mathbf{v} d \Omega \\
=\int_{\Omega} \mathbf{f} \cdot \mathbf{v} d \Omega+\int_{\Gamma_{N}} \boldsymbol{\psi} \cdot \mathbf{v} d \gamma \quad \forall \mathbf{v} \in V
\end{aligned}\right.
\label{17.9}\end{equation}

与$\left.\mathbf{u}\right|_{\Gamma_{D}}=\varphi_{D}$和$\left.\mathbf{u}\right|_{t=0}=\mathbf{u}_{0}$ 。空间$V$是\ref{17.7}中的空间，而$Q$是\ref{17.8} 中引入的空间。$\mathbf{u}$和$p$的随时间变化的函数空间已在第二节中介绍。  $2.7$ .

正如我们已经预料到的，对于这个问题，在两个维度$d=2$和$d=3$上都可以证明解决方案的存在性，而唯一性只在$d=2$的情况下被证明，因为数据足够小（例如，见[Tem01]和[Sal08]）。

让我们定义雷诺数

!!!!
R e=\frac{|\mathbf{U}| L}{v}
$$

其中$L$是域的代表长度$\Omega$（例如研究流体流动的通道长度），$\mathbf{U}$是代表流体速度。

雷诺数衡量的是对流对扩散的支配程度。当$R e \ll 1$时，对流项$(\mathbf{u} \cdot \nabla) \mathbf{u}$可以省略，纳维-斯托克斯方程就会简化为所谓的斯托克斯方程，这将在本章的后面进行研究。另一方面，如果$\operatorname{Re}$很大，可能会出现关于解的唯一性、静止和稳定解的存在、可能存在的奇怪吸引物、向湍流过渡等问题。见[Tem01, FMRT01]。

当流速的波动发生在非常小的空间和时间尺度上时，它们的数值近似变得非常困难，甚至不可能。在这些情况下，人们通常求助于所谓的湍流模型：后者允许通过代数方程或微分方程对这种流动行为进行近似描述。本专著将不涉及这一主题。有兴趣的读者可以参考，例如，[Wil98]关于湍流的物理方面的描述，[HYR08]关于不可压缩流的多尺度分析，[Le 05]关于多尺度系统的建模方面，[MP94]关于最广泛使用的湍流模型之一的分析，所谓$\kappa-\varepsilon$模型。  [Sag06]和[BIL06]提供了对所谓的大型$E d d y$模型的分析，该模型的计算成本更高，但原则上更适合对湍流场提供更真实的描述。

最后，让我们提一下\ref{16.21} 中介绍的欧拉方程，该方程用于可压缩或不可压缩的流动，在这些情况下，可以忽略粘度。从形式上讲，这相当于将雷诺数等于无穷大。

通过消除压力，纳维-斯托克斯方程可以用$r e-$唯一变量的形式重写$\mathbf{u}$ 。为了这个目的，让我们介绍以下$\left[\mathrm{H}^{1}(\Omega)\right]^{d}$的子空间。

!!!!
V_{\text {div }}=\left\{\mathbf{v} \in\left[\mathrm{H}^{1}(\Omega)\right]^{d}: \operatorname{div} \mathbf{v}=0\right\}, \quad \mathrm{V}_{\mathrm{div}}^{0}=\left\{\mathbf{v} \in \mathrm{V}_{\mathrm{div}}: \mathbf{v}=\mathbf{0} \text { on } \Gamma_{\mathrm{D}}\right\}
$$

当要求\ref{17.9}中的动量方程中的检验函数$\mathbf{v}$属于空间$V_{\text {div }}$时，与压力梯度有关的项消失了，因此我们发现速度的问题缩小了，找到$\mathbf{u} \in \mathrm{L}^{2}\left(\mathbb{R}^{+} ; V_{\mathrm{div}}\right) \cap C^{0}\left(\mathbb{R}^{+} ;\left[\mathrm{L}^{2}(\Omega)\right]^{d}\right)$，以便于

!!!!
\begin{aligned}
\int_{\Omega} \frac{\partial \mathbf{u}}{\partial t} \cdot \mathbf{v} d \Omega &+v \int_{\Omega} \nabla \mathbf{u} \cdot \nabla \mathbf{v} d \Omega+\int_{\Omega}[(\mathbf{u} \cdot \nabla) \mathbf{u}] \cdot \mathbf{v} d \Omega \\
&=\int_{\Omega} \mathbf{f} \cdot \mathbf{v} d \Omega+\int_{\Gamma_{N}} \psi \cdot \mathbf{v} d \gamma \quad \forall \mathbf{v} \in V_{\mathrm{div}}^{0}
\end{aligned}
\label{17.10}\end{equation}

与 $\left.\mathbf{u}\right|_{\Gamma_{D}}=\varphi_{D}$ 和 $\left.\mathbf{u}\right|_{t=0}=\mathbf{u}_{0}$ 。由于这个问题是（非线性）抛物线，它的分析可以用类似于第五章中应用的技术来进行。(显然，如果$\mathbf{u}$是\ref{17.9} 的解，那么它也能解决\ref{17.10} 。反之，以下定理成立。关于其证明，请参见，例如，[QV94] 。

Theorem 17.1. Let $\Omega \subset \mathbb{R}^{d}$ be a domain with Lipschitz-continuous boundary $\partial \Omega .$ Let $\mathbf{u}$ be a solution to the reduced problem (17.10). Then there exists a unique function $p \in \mathrm{L}^{2}\left(\mathbb{R}^{+} ; Q\right)$ such that $(\mathbf{u}, p)$ is a solution to $(17.9)$.

一旦减少的问题得到解决，就存在一个唯一的方法来恢复压力$p$，因此也就有了原始纳维-斯托克斯问题\ref{17.9} 的完整解。

然而，在实践中，从数值的角度来看，这种方法可能是相当不合适的。事实上，在Galerkin空间近似框架中，它需要构建有限维度的子空间，例如$V_{\mathrm{div}, h}$，无发散速度函数。在这方面，例如见[BF91a]和[BBF13]的有限元逼近，以及[CHQZ06]的频谱逼近。此外，定理$17.1$的结果不是建设性的，因为它没有提供建立解决压力的方法 $p$ 。由于这些原因，人们通常倾向于直接对完整的耦合问题\ref{17.9} 进行近似。

\subsection{Stokes equations and their approximation}

在本节中，我们将考虑以下具有同质Dirichlet边界条件的广义斯托克斯问题

!!!!
\begin{cases}\alpha \mathbf{u}-v \Delta \mathbf{u}+\nabla p=\mathbf{f} & \text { in } \Omega \\ \operatorname{div} \mathbf{u}=0 & \text { in } \Omega \\ \mathbf{u}=\mathbf{0} & \text { on } \partial \Omega\end{cases}
\label{17.11}\end{equation}

对于一个给定的系数 $\alpha \geq 0$ 。这个问题描述的是不可压缩的粘性流动的运动，其中（二次）对流项被忽略了，这种简化是可以接受的 $\operatorname{Re} \ll 1$ 。然而，在使用纳维-斯托克斯方程的隐式时间离散化时，也可以产生类似\ref{17.11} 的问题，我们将在第17.7节看到。从分析的角度来看，纳维尔-斯托克斯方程可以被看作是斯托克斯方程的紧凑扰动，因为它们与后者的区别仅仅在于对流项的存在，它是一阶的，而扩散项是二阶的。另一方面，可以说当雷诺数$\operatorname{Re}$非常大时，这个项会对解决方案的行为产生根本性的影响，正如已经指出的。

问题\ref{17.11} 的弱表述为：。

找到$\mathbf{u} \in V$和$p \in Q$，以便于

!!!!
\begin{cases}\int_{\Omega}(\alpha \mathbf{u} \cdot \mathbf{v}+v \nabla \mathbf{u} \cdot \nabla \mathbf{v}) d \Omega-\int_{\Omega} p \operatorname{div} \mathbf{v} d \Omega=\int_{\Omega} \mathbf{f} \cdot \mathbf{v} d \Omega \quad \forall \mathbf{v} \in V \\ \int_{\Omega} q \operatorname{divu} d \Omega=0 & \forall q \in Q\end{cases}
\label{17.12}\end{equation}

其中$V=\left[\mathrm{H}_{0}^{1}(\Omega)\right]^{d}$和$Q=\mathrm{L}_{0}^{2}(\Omega)$ 。现在定义双线性形式$a: V \times V \mapsto \mathbb{R}$和$b: V \times Q \mapsto \mathbb{R}$如下。

!!!!
\begin{aligned}
&a(\mathbf{u}, \mathbf{v})=\int_{\Omega}(\alpha \mathbf{u} \cdot \mathbf{v}+v \nabla \mathbf{u} \cdot \nabla \mathbf{v}) d \Omega \\
&b(\mathbf{u}, q)=-\int_{\Omega} q \operatorname{divu} d \Omega
\end{aligned}
\label{17.13}\end{equation}

有了这些符号，问题\ref{17.12} 就变成了：找到$(\mathbf{u}, p) \in V \times Q$，使得

!!!!
\begin{cases}a(\mathbf{u}, \mathbf{v})+b(\mathbf{v}, p)=(\mathbf{f}, \mathbf{v}) & \forall \mathbf{v} \in V \\ b(\mathbf{u}, q)=0 & \forall q \in Q\end{cases}
\label{17.14}\end{equation}

其中$(\mathbf{f}, \mathbf{v})=\sum_{i=1}^{d} \int_{\Omega} f_{i} v_{i} d \Omega

如果我们考虑非均质边界条件，如\ref{17.4}所示，斯托克斯问题的弱表述变成：找到$(\dot{\mathbf{u}}, p) \in V \times Q$，以便

!!!!
\begin{cases}a(\hat{\mathbf{u}}, \mathbf{v})+b(\mathbf{v}, p)=\mathbf{F}(\mathbf{v}) & \forall \mathbf{v} \in V \\ b(\hat{\mathbf{u}}, q)=G(q) & \forall q \in Q\end{cases}
\label{17.15}\end{equation}

其中$V$和$Q$分别是\ref{17.7} 和\ref{17.8} 中引入的空间。用$\mathbf{R} \boldsymbol{\varphi} \in\left[\mathrm{H}^{1}(\Omega)\right]^{d}$表示边界基准$\varphi$的提升，我们设定$\stackrel{\mathbf{u}}=!!!!\mathbf{u}-\mathbf{R} \varphi$，而右边的新项有如下表达。

!!!!
\mathbf{F}(\mathbf{v})=(\mathbf{f}, \mathbf{v})+\int_{\Gamma_{N}} \psi \mathbf{v} d \gamma-a(\mathbf{R} \varphi, \mathbf{v}), \quad G(q)=-b(\mathbf{R} \varphi, q)
\label{17.16}\end{equation}

以下结果成立。

Theorem 17.2. The couple $(\mathbf{u}, p)$ solves the Stokes problem (17.14) iff it is a saddle point of the Lagrangian functional

!!!!
\mathscr{L}(\mathbf{v}, q)=\frac{1}{2} a(\mathbf{v}, \mathbf{v})+b(\mathbf{v}, q)-(\mathbf{f}, \mathbf{v})
$$

or equivalently,

!!!!
\mathscr{L}(\mathbf{u}, p)=\min _{\mathbf{v} \in V} \max _{q \in Q} \mathscr{L}(\mathbf{v}, q)
$$


因此，压力$q$扮演了与无发散约束相关的拉格朗日乘数的角色。正如我们在第17.1节看到的纳维-斯托克斯方程，有可能从斯托克斯方程中正式消除变量$p$，从而得到以下缩小的斯托克斯问题（以弱形式）。

!!!!
\text { find } \mathbf{u} \in V_{\mathrm{div}}^{0} \quad \text { such that } \quad a(\mathbf{u}, \mathbf{v})=(\mathbf{f}, \mathbf{v}) \quad \forall \mathbf{v} \in V_{\text {div }}^{0}
\label{17.17}\end{equation}

这是一个向量变量的椭圆问题 $\mathbf{u}$ 。存在性和唯一性可以用Lax-Milgram定理3.1来证明。事实上，$V_{\text {div }}^{0}$是一个关于$\operatorname{norm}\|\nabla \mathbf{v}\|_{\mathrm{L}^{2}(\Omega)}$的希尔伯特空间，因为发散算子从$V$连续到$\mathrm{L}^{2}(\Omega)$，因此$V_{\mathrm{div}}^{0}$是空间$V$的一个封闭子空间。此外，双线性形式$a(\cdot, \cdot)$在$V_{\text {div }}^{0}$和$\mathbf{f} \in V_{\text {div }}^{\prime}$中是连续和强制的。利用Cauchy-Schwarz和Poincaré不等式，在\ref{17.17}中取$\mathbf{v}=\mathbf{u}$可以得到如下估计

!!!!
\begin{aligned}
\frac{\alpha}{2}\|\mathbf{u}\|_{\mathrm{L}^{2}(\Omega)}^{2}+v\|\nabla \mathbf{u}\|_{\mathrm{L}^{2}(\Omega)}^{2} & \leq \frac{1}{2 \alpha}\|\mathbf{f}\|_{\mathrm{L}^{2}(\Omega)}^{2}, & \text { if } \alpha \neq 0, \\
\|\nabla \mathbf{u}\|_{L^{2}(\Omega)} & \leq \frac{C_{\Omega}}{v}\|f\|_{L^{2}(\Omega)}, & \text { if } \alpha=0,
\end{aligned}
$$

其中$C_{\Omega}$是Poincaré不等式\ref{2.13}的常数。注意，压力已经从\ref{17.17} 中消失了。然而，仍然从\ref{17.17} 中我们可以推断出，矢量$\mathbf{w}=\alpha \mathbf{u}-v \Delta \mathbf{u}-\mathbf{f}$，被视为$\mathrm{H}^{-1}(\Omega)$的线性函数，当应用于$V_{\text {div }}^{0}$的任何矢量函数时都消失。由于这一特性，存在一个唯一的函数$p \in Q$，使得$\mathbf{w}=\nabla p$，即$p$在分布意义上满足\ref{17.11}的第一个方程（这需要适当使用Thm.  $16.7$，我们将在后面介绍；见，例如，[QV94]）。)因此，夫妇$(\mathbf{u}, p)$是弱问题\ref{17.14} 的唯一解。

问题\ref{17.14} 的Galerkin近似有以下形式：找到$\left(\mathbf{u}_{h}, p_{h}\right) \in V_{h} \times Q_{h}$，以便

!!!!
\begin{cases}a\left(\mathbf{u}_{h}, \mathbf{v}_{h}\right)+b\left(\mathbf{v}_{h}, p_{h}\right)=\left(\mathbf{f}, \mathbf{v}_{h}\right) & \forall \mathbf{v}_{h} \in V_{h} \\ b\left(\mathbf{u}_{h}, q_{h}\right)=0 & \forall q_{h} \in Q_{h}\end{cases}
\label{17.18}\end{equation}

其中$\left\{V_{h} \subset V\right\}$和$\left\{Q_{h} \subset Q\right\}$代表两个取决于实离散化参数$h$的有限维子空间族。相反，如果我们考虑对应于非均质边界数据\ref{17.4}的问题\ref{17.15}-\ref{17.16}，上述公式需要修改，在第一个方程的右手边使用$\mathbf{F}\left(\mathbf{v}_{h}\right)$，在第二个方程的手边使用$G\left(q_{h}\right)$。这些新函数可以从\ref{17.16}中得到，方法是用$\mathbf{R} \varphi$在$\Gamma_{D}$的节点上的内插值（在所有其他节点上消失）代替$\psi$，用它在$\Gamma_{N}$上的节点的内插值代替。问题\ref{17.18}的代数式将在第17.4节中讨论。

下面这个著名的定理是由F.Brezzi [Bre74] 提出的，它保证了问题\ref{17.18}的唯一性和存在性。

定理17.3.如果以下条件成立，Galerkin近似\ref{17.18}承认有且只有一个解。

1.双线性形式a$(\cdot, \cdot)$是。

a) coercive，即$\exists \alpha>0$（可能取决于h），以便

!!!!
a\left(\mathbf{v}_{h}, \mathbf{v}_{h}\right) \geq \alpha\left\|\mathbf{v}_{h}\right\|_{V}^{2} \quad \forall \mathbf{v}_{h} \in V_{h}^{*},
$$

其中$V_{h}^{*}=\left\{\mathbf{v}_{h} \in V_{h}: b\left(\mathbf{v}_{h}, q_{h}\right)=0 \forall q_{h} \in Q_{h}\right\}

b）连续的，即$\exists \gamma>0$，以便于


!!!!
\left|a\left(\mathbf{u}_{h}, \mathbf{v}_{h}\right)\right| \leq \gamma\left\|\mathbf{u}_{h}\right\|_{V}\left\|\mathbf{v}_{h}\right\|_{V} \quad \forall \mathbf{u}_{h}, \mathbf{v}_{h} \in V_{h}
$$

2.双线性形式$b(\cdot, \cdot)$是连续的，也就是$\exists \delta>0$，使得

!!!!
\left|b\left(\mathbf{v}_{h}, q_{h}\right)\right| \leq \delta\left\|\mathbf{v}_{h}\right\|_{V}\left\|q_{h}\right\|_{Q} \quad \forall \mathbf{v}_{h} \in V_{h}, q_{h} \in Q_{h}
$$

3.最后，存在一个正的常数$\beta$（可能取决于$\mathrm{h}$），使得

!!!!
\forall q_{h} \in Q_{h}, \exists \mathbf{v}_{h} \in V_{h}: b\left(\mathbf{v}_{h}, q_{h}\right) \geq \beta\left\|\mathbf{v}_{h}\right\|_{\mathbf{H}^{1}(\Omega)}\left\|q_{h}\right\|_{\mathrm{L}^{2}(\Omega)}
$$


\ref{17.19}


在前面的假设下，离散的解决方案满足以下先验的估计。

!!!!
\begin{aligned}
&\left\|\mathbf{u}_{h}\right\|_{V} \leq \frac{1}{\alpha}\|\mathbf{f}\|_{V^{\prime}} \\
&\left\|p_{h}\right\|_{Q} \leq \frac{1}{\beta}\left(1+\frac{\gamma}{\alpha}\right)\|\mathbf{f}\|_{V^{\prime}}
\end{aligned}
$$

其中$V^{\prime}$是$V$的对偶空间。此外，以下收敛结果成立。

!!!!
\begin{aligned}
&\left\|\mathbf{u}-\mathbf{u}_{h}\right\|_{V} \leq\left(1+\frac{\delta}{\beta}\right)\left(1+\frac{\gamma}{\alpha}\right) \inf _{\mathbf{v}_{h} \in V_{h}}\left\|\mathbf{u}-\mathbf{v}_{h}\right\|_{V}+\frac{\delta}{\alpha} \inf _{q_{h} \in Q_{h}}\left\|p-q_{h}\right\|_{Q} \\
&\left\|p-p_{h}\right\|_{Q} \leq \frac{\gamma}{\beta}\left(1+\frac{\gamma}{\alpha}\right)\left(1+\frac{\delta}{\beta}\right) \inf _{\mathbf{v}_{h} \in V_{h}}\left\|\mathbf{u}-\mathbf{v}_{h}\right\|_{V}
\end{aligned}
$$

值得注意的是，条件\ref{17.19} 相当于存在一个正的常数$\beta$，使得

!!!!
\inf _{q_{h} \in Q_{h}, q_{h} \neq 0} \sup _{\mathbf{v}_{h} \in V_{h}, \mathbf{v}_{h} \neq 0} \frac{b\left(\mathbf{v}_{h}, q_{h}\right)}{\left\|\mathbf{v}_{h}\right\|_{\mathbf{H}^{1}(\Omega)}\left\|q_{h}\right\|_{\mathrm{L}^{2}(\Omega)}} \geq \beta
$$

由于这样的原因，它通常被称为inf-sup条件。

这个定理的证明需要函数分析的非基本工具。我们将在第17.3节给出比Stokes问题更普遍的鞍点问题。从这个角度看，定理$17.3$可以被看作是定理$17.5$和17.6的一个特例。对理论方面不感兴趣的读者可以跳过下一节，直接跳到第17.4节。

\subsection{Saddle-point problems}

本节的范围是研究问题\ref{17.14} 和\ref{17.18} ，并说明后者的解是如何收敛于前者的。为了达到这个目的，我们将在一个更抽象的框架内重塑这些公式，这将最终允许使用[Bre74, Bab71, BBF13]中提出的理论。

\subsubsection{Problem formulation}

设$X$和$M$为两个希尔伯特空间，赋予其规范$\|\cdot\|_{X}$和$\|\cdot\|_{M}$。用$X^{\prime}$和$M^{\prime}$表示相应的对偶空间（即定义在$X$和$M$上的线性和有界函数的空间），我们引入双线性形式$a(\cdot, \cdot): X \times X \longrightarrow \mathbb{R}$和$b(\cdot, \cdot): X \times M \longrightarrow \mathbb{R}$，我们假设它们是连续的，即存在两个常数$\gamma, \delta>0$，使得对所有$w, v \in X$和$\mu \in M$ ,

!!!!
|a(w, v)| \leq \gamma\|w\|_{X}\|v\|_{X}, \quad|b(w, \mu)| \leq \delta\|w\|_{X}\|\mu\|_{M}
\label{17.21}\end{equation}

现在考虑以下受限问题：找到$(u, \eta) \in X \times M$，使得

!!!!
\begin{cases}a(u, v)+b(v, \eta)=\langle l, v\rangle & \forall v \in X \\ b(u, \mu)=\langle\sigma, \mu\rangle & \forall \mu \in M\end{cases}
\label{17.22}\end{equation}

其中$l \in X^{\prime}$和$\sigma \in M^{\prime}$是两个指定的线性函数，而$\langle\cdot, \cdot\rangle$表示$X$和$X^{\prime}$或者$M$和$M^{\prime}$之间的配对。

公式\ref{17.22}具有足够的通用性，包括斯托克斯问题的公式\ref{17.14}、关于双线性形式$a(\cdot, \cdot)$(用$\eta$代表约束)的通用约束问题的公式，或者再次包括当混合有限元近似用于各种类型的边界值问题，例如那些线性弹性问题时得到的公式(例如，见[BF91a, QV94])。

问题\ref{17.22}可以方便地以算子形式重新表述。为此，我们将双线性形式$a(\cdot, \cdot)$和$b(\cdot, \cdot)$与运算符$A \in \mathscr{L}\left(X, X^{\prime}\right)$和$B \in!!!!\mathscr{L}\left(X, M^{\prime}\right)$联系起来，通过以下关系定义。

!!!!
\begin{array}{ll}
\langle A w, v\rangle=a(w, v) & \forall w, v \in X \\
\langle B v, \mu\rangle=b(v, \mu) & \forall v \in X, \mu \in M .
\end{array}
$$

关系对$X^{\prime}$到$X$以及$M^{\prime}$到$M$ 。根据第4.5.3节介绍的符号，我们用$X^{\prime}$到$X$和$M^{\prime}$到$M$表示。我们用$\mathscr{L}(V, W)$表示$V$和$W$之间的线性和有界函数的空间。

让$B^{T} \in \mathscr{L}\left(M, X^{\prime}\right)$成为$B$的邻接算子，定义为

!!!!
\left\langle B^{T} \mu, v\right\rangle=\langle B v, \mu\rangle=b(v, \mu) \quad \forall v \in X, \mu \in M
\label{17.23}\end{equation}

前者在$X^{\prime}$和$X$之间具有对偶性，后者在$M^{\prime}$和$M$之间具有对偶性。（该算子在第二节中用符号$B^{\prime}$表示。  $2.6$ ，见一般定义 $(2.20)$ 。但在这里，为了与鞍点问题框架中使用的经典符号保持一致，我们用$B^{T}$来表示它）。)

以算子的形式，鞍点问题\ref{17.22} 可以重述如下：找到$(u, \eta) \in X \times M$，使得

!!!!
\begin{cases}A u+B^{T} \eta=l & \text { in } X^{\prime} \\ B u=\sigma & \text { in } M^{\prime}\end{cases}
\label{17.24}\end{equation}

\subsubsection{Analysis of the problem}

为了分析问题\ref{17.24} ，我们引入仿生流形

!!!!
X^{\sigma}=\{v \in X: b(v, \mu)=\langle\sigma, \mu\rangle \forall \mu \in M\}
\label{17.25}\end{equation}

空间$X^{0}$表示$B$的内核，也就是

!!!!
X^{0}=\{v \in X: b(v, \mu)=0 \forall \mu \in M\}=\operatorname{ker}(B)
$$

这是一个$X$的封闭子空间。因此，我们可以将\ref{17.22}与以下简化问题联系起来

!!!!
\text { find } u \in X^{\sigma} \quad \text { such that } \quad a(u, v)=\langle l, v\rangle \quad \forall v \in X^{0} \text {. }
\label{17.26}\end{equation}

如果$(u, \eta)$是\ref{17.22}的解，那么$u$就是\ref{17.26}的解。在下文中，我们将引入适当的条件，使反面情况也能成立。此外，我们想证明\ref{17.26}的解的唯一性。这将使我们得到原始鞍点问题\ref{17.22} 的存在性和唯一性结果。

我们用$X_{\text {polar }}^{0}$来表示$X^{0}$的极值集，也就是

!!!!
X_{\text {polar }}^{0}=\left\{g \in X^{\prime}:\langle g, v\rangle=0 \forall v \in X^{0}\right\}
$$

见图17.1的示意图。由于$X^{0}=\operatorname{ker}(B)$ ，我们有$X_{\text {polar }}^{0}=(\operatorname{ker}(B))_{\text {polar }}$ 。空间 $X$ 是 $X^{0}$ 及其正交空间 $\left(X^{0}\right)^{\perp}$ 的直接和。

!!!!
X=X^{0} \oplus\left(X^{0}\right)^{\perp}
$$



![](https://cdn.mathpix.com/cropped/991f5db518e324d299c1ff4972bba9fb-085.jpg?height=315&width=516&top_left_y=110&top_left_x=200)

图17.1.空间$X$和$M$，对偶空间$X^{\prime}$和$M^{\prime}$，子空间$X^{0},\left(X^{0}\right)^{\perp}$和$X_{\text {polar }}^{0}$，以及运算符$A, B$和$B^{T}$ 。虚线表示同构关系

由于一般来说，$\operatorname{ker}(B)$不是空的，我们不能期望$B$是$X$和$M^{\prime}$之间的同构。我们的目的是找到一个条件，保证$B$是$\left(X^{0}\right)^{\perp}$和$M^{\prime}$之间的同构（同样，$B^{T}$是$M$和$\left.X_{\text {polar }}^{0}\right)$的同构。


Lemma 17.1. The three following statements are equivalent:
a. there exists a constant $\beta^{*}>0$ such that the following compatibility condition holds

!!!!
\forall \mu \in M \exists v \in X, \quad v \neq 0: b(v, \mu) \geq \beta^{*}\|v\|_{X}\|\mu\|_{M}
\label{17.27}\end{equation}


b. the operator $B^{T}$ is an isomorphism from $M$ onto $X_{\text {polar }}^{0}$; moreover,

!!!!
\left\|B^{T} \mu\right\|_{X^{\prime}}=\sup _{v \in V, v \neq 0} \frac{\left\langle B^{T} \mu, v\right\rangle}{\|v\|_{X}} \geq \beta^{*}\|\mu\|_{M} \quad \forall \mu \in M
\label{17.28}\end{equation}

c. the operator B is an isomorphism from $\left(X^{0}\right)^{\perp}$ onto $M^{\prime} ;$ moreover,

!!!!
\|B v\|_{M^{\prime}}=\sup _{\mu \in M, \mu \neq 0} \frac{\langle B v, \mu\rangle}{\|\mu\|_{M}} \geq \beta^{*}\|v\|_{X} \quad \forall v \in\left(X^{0}\right)^{\perp}
\label{17.29}\end{equation}



证明。由于$B^{T}$的定义\ref{17.23} ，两个不等式\ref{17.27} 和\ref{17.28} 确实重合。现在让我们证明，$B^{T}$是$M$和$X_{\text {polar }}^{0}$之间的同构关系。由\ref{17.28} 可知，$B^{T}$是一个从$M$到其范围$\mathscr{R}\left(B^{T}\right)$的注入算子，具有连续逆。那么$\mathscr{R}\left(B^{T}\right)$就是$X^{\prime}$的一个封闭子空间。剩下的就是证明$\mathscr{R}\left(B^{T}\right)=X_{\text {polar }}^{0}$ 。从闭域定理（见，例如，[Yos74]），我们有

!!!!
\mathscr{R}\left(B^{T}\right)=(\operatorname{ker}(B))_{\text {polar }}
$$

因此，$\mathscr{R}\left(B^{T}\right)=X_{\text {polar }}^{0}$，这是所期望的结果。

现在让我们证明b.和$\mathrm{c}$之间的等价关系。 空间$X_{\text {polar }}^{0}$可以被识别为$\left(X^{0}\right)^{\perp}$的对偶空间。事实上，对于每一个$g \in\left(\left(X^{0}\right)^{\perp}\right)^{\prime}$，我们可以关联一个函数$\hat{g} \in X^{\prime}$，它满足以下关系

!!!!
\langle\hat{g}, v\rangle=\left\langle g, P^{\perp} v\right\rangle \quad \forall v \in X
$$

其中$P^{\perp}$表示$X$对$\left(X^{0}\right)^{\perp}$的正交投影，也就是

!!!!
\forall v \in X, \quad P^{\perp} v \in\left(X^{0}\right)^{\perp}:\left(P^{\perp} v-v, w\right)_{X}=0 \quad \forall w \in\left(X^{0}\right)^{\perp}
$$

显然，$\hat{g} \in X_{\text {polar }}^{0}$并且可以验证$g \longrightarrow \hat{g}$是$\left(\left(X^{0}\right)^{\perp}\right)^{\prime}$和$X_{\text {polar }}^{0}$之间的等距双射。因此，$B^{T}$是一个从$M$到$\left(\left(X^{0}\right)^{\perp}\right)^{\prime}$的同构，满足以下关系

!!!!
\left\|\left(B^{T}\right)^{-1}\right\|_{\mathscr{L}\left(X_{\text {polar }}^{0}, M\right)} \leq \frac{1}{\beta^{*}}
$$

当且仅当$B$是一个从$\left(X^{0}\right)^{\perp}$到$M^{\prime}$的同构，满足关系

!!!!
\left\|B^{-1}\right\|_{\mathscr{L}\left(M^{\prime},\left(X^{0}\right)^{\perp}\right)} \leq \frac{1}{\beta^{*}}
$$

这就完成了我们的证明。

在这一点上，我们可以证明问题\ref{17.22}是很好提出的。


Theorem 17.4. Let the bilinear form $a(\cdot, \cdot)$ satisfy the continuity condition (17.21) and be coercive on the space $X^{0}$, that is

!!!!
\exists \alpha>0: a(v, v) \geq \alpha\|v\|_{X}^{2} \quad \forall v \in X^{0}
\label{17.30}\end{equation}

Suppose moreover that the bilinear form $b(\cdot, \cdot)$ satisfies the continuity condition (17.21) as well as the compatibility condition (17.27).
Then for every $l \in X^{\prime}$ and $\sigma \in M^{\prime}$, there exists a unique solution u of problem (17.26); furthermore, there exists a unique function $\eta \in M$ such that $(u, \eta)$ is the unique solution to the original saddle-point problem (17.22).
Moreover, the map $(l, \sigma) \longrightarrow(u, \eta)$ is an isomorphism from $X^{\prime} \times M^{\prime}$ onto $X \times M$ and the following a priori estimates hold:

!!!!
\|u\|_{X} \leq \frac{1}{\alpha}\left[\|l\|_{X^{\prime}}+\frac{\alpha+\gamma}{\beta^{*}}\|\sigma\|_{M^{\prime}}\right]
\label{17.31}\end{equation}


!!!!
\|\eta\|_{M} \leq \frac{1}{\beta^{*}}\left[\left(1+\frac{\gamma}{\alpha}\right)\|l\|_{X^{\prime}}+\frac{\gamma(\alpha+\gamma)}{\alpha \beta^{*}}\|\sigma\|_{M^{\prime}}\right]
\label{17.32}\end{equation}

The constants $\alpha, \beta^{*}$ and $\gamma$ are defined in $(17.30),(17.27)$ and $(17.21)$, respectively. The symbols $\|\cdot\|_{X^{\prime}}$ and $\|\cdot\|_{M^{\prime}}$ indicate the norms of the dual spaces, and are defined as in (17.28) and (17.29), respectively.


证明。\ref{17.26}的解的唯一性直接来自于coercive属性\ref{17.30}。现在我们来证明存在性。从假设\ref{17.27}和定理17.1的c.中所述的等价结果，我们可以推断出存在一个唯一的函数$u^{\sigma} \in\left(X^{0}\right)^{\perp}$，使得$B u^{\sigma}=\sigma$ ，而且，。

!!!!
\left\|u^{\sigma}\right\|_{X} \leq \frac{1}{\beta^{*}}\|\sigma\|_{M^{\prime}}
\label{17.33}\end{equation}

鞍点问题\ref{17.26} 可以重新表述如下

!!!!
\text { find } \widetilde{u} \in X^{0} \quad \text { such that } \quad a(\widetilde{u}, v)=\langle l, v\rangle-a\left(u^{\sigma}, v\right) \quad \forall v \in X^{0} \text {. }
\label{17.34}\end{equation}

问题\ref{17.26} 的解$u$由关系$u=\widetilde{u}+u^{\sigma}$确定。在这一点上，问题\ref{17.34} 的解$\widetilde{u}$的存在性和唯一性由Lax-Milgram定理以及先验估计得出

!!!!
\|\widetilde{u}\|_{X} \leq \frac{1}{\alpha}\left(\|l\|_{X^{\prime}}+\gamma\left\|u^{\sigma}\right\|_{X}\right),
$$

也就是说，由于 \ref{17.33} 。

!!!!
\|\widetilde{u}\|_{X} \leq \frac{1}{\alpha}\left(\|l\|_{X^{\prime}}+\frac{\gamma}{\beta^{*}}\|\sigma\|_{M^{\prime}}\right)
\label{17.35}\end{equation}

因此，问题$u$的解的\ref{17.22}部分的唯一性是$\widetilde{u} \in X^{0}$和$u^{\sigma} \in\left(X^{0}\right)^{\perp}$的唯一性的直接结果，而稳定性估计\ref{17.31}又来自\ref{17.35}和\ref{17.33}的结合。

现在我们把重点放在解决方案的$\eta$部分。由于\ref{17.34}可以重述为

!!!!
\langle A u-l, v\rangle=0 \quad \forall v \in X^{0}
$$

由此可见，$(A u-l) \in X_{\text {polar }}^{0}$，所以我们可以利用$17.1$中的b点，得出结论：存在一个唯一的$\eta \in M$，使得$A u-l=-B^{T} \eta$，即$(u, \eta)$是问题\ref{17.22}的解，并且$\eta$满足不等式。

!!!!
\|\eta\|_{M} \leq \frac{1}{\beta^{*}}\|A u-l\|_{X^{\prime}}
\label{17.36}\end{equation}

我们已经注意到，\ref{17.22}的每一个解$(u, \eta)$都会产生还原问题\ref{17.26}的解$u$，因此\ref{17.22}的解具有唯一性。最后，先验估计\ref{17.32}由\ref{17.36}得出，因为注意到

!!!!
\|\eta\|_{M} \leq \frac{1}{\beta^{*}}\left[\|A\|_{\mathscr{L}\left(X, X^{\prime}\right)}\|u\|_{X}+\|l\|_{X^{\prime}}\right]
$$

并使用已经证明的对$u$的先验估计\ref{17.31} 。

\subsubsection{Galerkin approximation, stability and convergence analysis}

为了引入抽象鞍点问题\ref{17.22} 的Galerkin近似，我们考虑了空间$X_{h}$和$M_{h}$的两个有限维子空间系列$X$和$M$，分别。它们既可以是有限元片断多项式空间，也可以是全局多项式（谱）空间，或谱元子空间。我们寻找以下问题的解决方案。

给出$l \in X^{\prime}$和$\sigma \in M^{\prime}$，求$\left(u_{h}, \eta_{h}\right) \in X_{h} \times M_{h}$，使之符合条件。

!!!!
\begin{cases}a\left(u_{h}, v_{h}\right)+b\left(v_{h}, \eta_{h}\right)=\left\langle l, v_{h}\right\rangle & \forall v_{h} \in X_{h} \\ b\left(u_{h}, \mu_{h}\right)=\left\langle\sigma, \mu_{h}\right\rangle & \forall \mu_{h} \in M_{h}\end{cases}
\label{17.37}\end{equation}

按照我们对连续问题的做法，我们可以引入子空间

!!!!
X_{h}^{\sigma}=\left\{v_{h} \in X_{h}: b\left(v_{h}, \mu_{h}\right)=\left\langle\sigma, \mu_{h}\right\rangle \forall \mu_{h} \in M_{h}\right\}
\label{17.38}\end{equation}

这使我们能够引入以下有限维度的对应缩减公式\ref{17.26}

!!!!
\text { find } u_{h} \in X_{h}^{\sigma} \text { such that } a\left(u_{h}, v_{h}\right)=\left\langle l, v_{h}\right\rangle \quad \forall v_{h} \in X_{h}^{0} \text {. }
\label{17.39}\end{equation}

因为一般来说，$M_{h}$与$M$不同，所以空间\ref{17.38}不一定是$X^{\sigma}$的一个子空间。

显然，\ref{17.37}的每一个解$\left(u_{h}, \eta_{h}\right)$都会产生还原问题\ref{17.39}的解$u_{h}$。在这一节中，我们将寻找允许我们证明反面陈述也是真的条件，以及问题\ref{17.37}的解的稳定性和收敛性结果。

我们首先证明定理 $17.4$ 的离散对应关系。

Theorem $17.5$ (Existence, uniqueness and stability). Suppose that the bilinear form $a(\cdot, \cdot)$ satisfies the continuity property (17.21) and that it is coercive on the space $X_{h}^{0}$, that is there exists a constant $\alpha_{h}>0$ such that

!!!!
a\left(v_{h}, v_{h}\right) \geq \alpha_{h}\left\|v_{h}\right\|_{X}^{2} \quad \forall v_{h} \in X_{h}^{0}
\label{17.40}\end{equation}

Moreover, suppose that the bilinear form $b(\cdot, \cdot)$ satisfies the continuity condition (17.21) and that the following discrete compatibility condition holds: there exists a constant $\beta_{h}>0$ such that

!!!!
\forall \mu_{h} \in M_{h} \exists v_{h} \in X_{h}, v_{h} \neq 0: b\left(v_{h}, \mu_{h}\right) \geq \beta_{h}\left\|v_{h}\right\|_{X}\left\|\mu_{h}\right\|_{M}
\label{17.41}\end{equation}

Then, for every $l \in X^{\prime}$ and $\sigma \in M^{\prime}$, there exists a unique solution $\left(u_{h}, \eta_{h}\right)$ of problem (17.37) which satisfies the following stability conditions:

!!!!
\left\|u_{h}\right\|_{X} \leq \frac{1}{\alpha_{h}}\left[\|l\|_{X^{\prime}}+\frac{\alpha_{h}+\gamma}{\beta_{h}}\|\sigma\|_{M^{\prime}}\right]
\label{17.42}\end{equation}

!!!!
\left\|\eta_{h}\right\|_{M} \leq \frac{1}{\beta_{h}}\left[\left(1+\frac{\gamma}{\alpha_{h}}\right)\|l\|_{X^{\prime}}+\frac{\gamma\left(\alpha_{h}+\gamma\right)}{\alpha_{h} \beta_{h}}\|\sigma\|_{M^{\prime}}\right]
\label{17.43}\end{equation}


证明。通过重复定理$17.4$的证明可以得到，考虑用$X_{h}$代替$X, M_{h}$代替$M$，并简单注意到

!!!!
\|l\|_{X_{h}^{\prime}} \leq\|l\|_{X^{\prime}}, \quad\|\sigma\|_{M_{h}^{\prime}} \leq\|\sigma\|_{M^{\prime}}
$$

矫捷性条件\ref{17.30} 不一定保证\ref{17.40} ，因为$X_{h}^{0} \not \subset!!!!X^{0}$，兼容性条件\ref{17.27} 一般也不意味着离散兼容性条件\ref{17.41} ，这是由于$X_{h}$是$X$的一个适当子空间。此外，在\ref{17.40} 和\ref{17.41} 中的常数$\alpha_{h}$和$\beta_{h}$与$h$无关的情况下，不等式\ref{17.42} 和\ref{17.43} 提供了期望的稳定性结果。

条件\ref{17.41} 代表众所周知的inf-sup或$L B B$条件（见[BF91a] ）。

(条件\ref{17.19} （或\ref{17.20} ）只是一个特殊情况）。

我们现在来看看收敛结果。

Theorem $17.6$ (Convergence). Let the assumptions of Theorems $17.4$ and $17.5$ be satisfied. Then the solutions $(u, \eta)$ and $\left(u_{h}, \eta_{h}\right)$ of problems (17.22) and (17.37), respectively, satisfy the following error estimates:

!!!!
\left\|u-u_{h}\right\|_{X} \leq\left(1+\frac{\gamma}{\alpha_{h}}\right) \inf _{v_{h}^{*} \in X_{h}^{\sigma}}\left\|u-v_{h}^{*}\right\|_{X}+\frac{\delta}{\alpha_{h}} \inf _{\mu_{h} \in M_{h}}\left\|\eta-\mu_{h}\right\|_{M}
\label{17.44}\end{equation}

!!!!
\begin{aligned}
\left\|\eta-\eta_{h}\right\|_{M} & \leq \frac{\gamma}{\beta_{h}}\left(1+\frac{\gamma}{\alpha_{h}}\right) \inf _{v_{h}^{*} \in X_{h}^{\sigma}}\left\|u-v_{h}^{*}\right\|_{X} \\
&+\left(1+\frac{\delta}{\beta_{h}}+\frac{\gamma \delta}{\alpha_{h} \beta_{h}}\right) \inf _{\mu_{h} \in M_{h}}\left\|\eta-\mu_{h}\right\|_{M}
\end{aligned}
\label{17.45}\end{equation}

where $\gamma, \delta, \alpha_{h}$ and $\beta_{h}$ are respectively defined by the relations $(17.21),(17.40)$ and (17.41). Moreover, the following error estimate holds


!!!!
\inf _{v_{h}^{*} \in X_{h}^{\sigma}}\left\|u-v_{h}^{*}\right\|_{X} \leq\left(1+\frac{\delta}{\beta_{h}}\right) \inf _{v_{h} \in X_{h}}\left\|u-v_{h}\right\|_{X}
\label{17.46}\end{equation}

证明。考虑$v_{h} \in X_{h}, v_{h}^{*} \in X_{h}^{\sigma}$和$\mu_{h} \in M_{h}$ 。通过从\ref{17.22}  {1}中减去\ref{17.37} {1}，然后再加减数量$a\left(v_{h}^{*}, v_{h}\right)$和$b\left(v_{h}, \mu_{h}\right)$，我们发现

!!!!
a\left(u_{h}-v_{h}^{*}, v_{h}\right)+b\left(v_{h}, \eta_{h}-\mu_{h}\right)=a\left(u-v_{h}^{*}, v_{h}\right)+b\left(v_{h}, \eta-\mu_{h}\right)
$$

现在让我们选择$v_{h}=u_{h}-v_{h}^{*} \in X_{h}^{0}$ 。从空间$X_{h}^{0}$的定义和使用\ref{17.40}和\ref{17.21}，我们可以发现边界

!!!!
\left\|u_{h}-v_{h}^{*}\right\|_{X} \leq \frac{1}{\alpha_{h}}\left(\gamma\left\|u-v_{h}^{*}\right\|_{X}+\delta\left\|\eta-\mu_{h}\right\|_{M}\right)
$$

从中可以立即得出估计值\ref{17.44} ，因为

!!!!
\left\|u-u_{h}\right\|_{X} \leq\left\|u-v_{h}^{*}\right\|_{X}+\left\|u_{h}-v_{h}^{*}\right\|_{X}
$$

现在我们来证明估计\ref{17.45} 。由于兼容性条件\ref{17.41} ，对于每一个$\mu_{h} \in M_{h}$我们可以写出

!!!!
\left\|\eta_{h}-\mu_{h}\right\|_{M} \leq \frac{1}{\beta_{h}} \sup _{v_{h} \in X_{h}, v_{h} \neq 0} \frac{b\left(v_{h}, \eta_{h}-\mu_{h}\right)}{\left\|v_{h}\right\|_{X}} .
\label{17.47}\end{equation}

另一方面，将\ref{17.37} {1}与\ref{17.22} {1}并列相减，然后加减数量$b\left(v_{h}, \mu_{h}\right)$，我们可以得到

!!!!
b\left(v_{h}, \eta_{h}-\mu_{h}\right)=a\left(u-u_{h}, v_{h}\right)+b\left(v_{h}, \eta-\mu_{h}\right)
$$

利用\ref{17.47} 中的这一特性以及连续性不等式\ref{17.21}，可以看出

!!!!
\left\|\eta_{h}-\mu_{h}\right\|_{M} \leq \frac{1}{\beta_{h}}\left(\gamma\left\|u-u_{h}\right\|_{X}+\delta\left\|\eta-\mu_{h}\right\|_{M}\right)
$$

只要我们使用之前为变量$u$得出的误差估计\ref{17.44}，就能得到理想的结果。

最后，让我们证明\ref{17.46}。属性\ref{17.41}允许我们使用离散版的Lemma$17.1$（现在应用于有限维子空间）。然后，由于\ref{17.29}的离散对应关系，对于每一个$v_{h} \in X_{h}$，我们可以找到一个唯一的函数$z_{h} \in\left(X_{h}^{0}\right)^{\perp}$，使得

!!!!
b\left(z_{h}, \mu_{h}\right)=b\left(u-v_{h}, \mu_{h}\right) \quad \forall \mu_{h} \in M_{h}
$$

此外，还有。

!!!!
\left\|z_{h}\right\|_{X} \leq \frac{\delta}{\beta_{h}}\left\|u-v_{h}\right\|_{X}
$$

函数$v_{h}^{*}=z_{h}+v_{h}$属于$X_{h}^{\sigma}$，因为$b\left(u, \mu_{h}\right)=\left\langle\sigma, \mu_{h}\right\rangle$为所有$\mu_{h} \in M_{h}$。此外。

!!!!
\left\|u-v_{h}^{*}\right\|_{X} \leq\left\|u-v_{h}\right\|_{X}+\left\|z_{h}\right\|_{X} \leq\left(1+\frac{\delta}{\beta_{h}}\right)\left\|u-v_{h}\right\|_{X}
$$

因此，估计\ref{17.46} 如下。

只要\ref{17.40} 和\ref{17.41} 中的常数$\alpha_{h}$和$\beta_{h}$自下而上被两个独立于$\alpha$和$\beta$的常数所约束，那么不等式\ref{17.44} 和\ref{17.45} 就会得到具有最佳收敛率的误差估计。我们还要指出，即使不满足兼容性条件\ref{17.27} 和\ref{17.41} ，不等式\ref{17.44} 仍然成立。

备注17.2（假压力模式）。兼容性条件\ref{17.41} 对于保证解的$\eta_{h}$分量的唯一性至关重要。事实上，如果\ref{17.41} 不成立，那么

!!!!
\exists \mu_{h}^{*} \in M_{h}, \mu_{h}^{*} \neq 0 \text { s.t. } b\left(v_{h}, \mu_{h}^{*}\right)=0 \quad \forall v_{h} \in X_{h}
$$

因此，如果$\left(u_{h}, \eta_{h}\right)$是问题\ref{17.37} 的解，那么$\left(u_{h}, \eta_{h}+\tau \mu_{h}^{*}\right)$ ，对于所有$\tau \in \mathbb{R}$，也是一个解。任何这样的函数$\mu_{h}^{*}$被称为假模，或者更具体地说，当它指的是斯托克斯问题\ref{17.18} 时，函数$\mu_{h}$代表离散压力的压力假模。由于离散问题\ref{17.37} 无法检测到这种假模，所以会出现数值不稳定。

对于一对给定的有限维空间$X_{h}$和$M_{h}$，证明离散相容条件\ref{17.41} 以独立于$\beta_{h}$的常数成立并非总是容易的。有几个实用的标准，其中我们提到Fortin（[For77]）、Boland和Nicolaides（[BN83]）以及Verfürth（[Ver84]）的标准。(见[BF91b] 。)

\subsection{Algebraic formulation of the Stokes problem}

让我们研究一下与Stokes问题的Galerkin近似\ref{17.18} 相关的代数系统的结构（或者，更一般的，像\ref{17.37} 一样的离散鞍点问题）。用以下公式表示

!!!!
\left\{\varphi_{j} \in V_{h}\right\}, \quad\left\{\phi_{k} \in Q_{h}\right\}
$$

分别为空间$V_{h}$和$Q_{h}$的基函数。让我们把离散解$\mathbf{u}_{h}$和$p_{h}$相对于这种基展开。

!!!!
\mathbf{u}_{h}(\mathbf{x})=\sum_{j=1}^{N} u_{j} \varphi_{j}(\mathbf{x}), \quad p_{h}(\mathbf{x})=\sum_{k=1}^{M} p_{k} \phi_{k}(\mathbf{x})
\label{17.48}\end{equation}

有集$N=\operatorname{dim} V_{h}$和$M=\operatorname{dim} Q_{h}$ 。通过在\ref{17.18}中选择相同的基础函数作为测试函数，我们得到以下的块状线性系统

!!!!
\left\{\begin{array}{l}
\mathrm{A} \mathbf{U}+\mathrm{B}^{T} \mathbf{P}=\mathbf{F} \\
\mathrm{B} \mathbf{U}=\mathbf{0}
\end{array}\right.
\label{17.49}\end{equation}

其中$\mathrm{A} \in \mathbb{R}^{N \times N}$和$\mathrm{B} \in \mathbb{R}^{M \times N}$是分别与双线性形式$a(\cdot, \cdot)$和$b(\cdot, \cdot)$有关的矩阵，其元素由以下公式给出

!!!!
\mathrm{A}=\left[a_{i j}\right]=\left[a\left(\varphi_{j}, \boldsymbol{\varphi}_{i}\right)\right], \quad \mathrm{B}=\left[b_{k m}\right]=\left[b\left(\varphi_{m}, \phi_{k}\right)\right],
$$

而$\mathbf{U}$和$\mathbf{P}$是未知数的向量。

!!!!
\mathbf{U}=\left[u_{j}\right], \quad \mathbf{P}=\left[p_{j}\right]
$$

$(N+M) \times(N+M)$ 矩阵

!!!!
\mathrm{S}=\left[\begin{array}{cc}
\mathrm{A} & \mathrm{B}^{T} \\
\mathrm{~B} & 0
\end{array}\right]
\label{17.50}\end{equation}

是块状对称的（因为A是对称的）和不确定的，其特点是具有可变符号的实数特征值（正和负）。  如果没有一个特征值是空的，那么$\mathrm{S}$就是非星形的，这一属性来自于inf-sup条件\ref{17.20} 。为了证明后一个声明，我们进行如下操作。

由于$\mathrm{A}$是非单调的$-\mathrm{it}$，与\ref{17.49}的第一条中的胁迫双线性形式$a(\cdot, \cdot)-$相关，我们可以正式得到$\mathbf{U}$为

!!!!
\mathbf{U}=\mathrm{A}^{-1}\left(\mathbf{F}-\mathbf{B}^{T} \mathbf{P}\right)
\label{17.51}\end{equation}

在\ref{17.49} 的第二个方程中使用\ref{17.51} ，可以得到

!!!!
\mathbf{R} \mathbf{P}=\mathrm{BA}^{-1} \mathbf{F}, \quad \text { where } \quad \mathrm{R}=\mathrm{BA}^{-1} \mathrm{~B}^{T}
\label{17.52}\end{equation}

这相当于对系统\ref{17.50} 进行了一次块状高斯消除。

这样我们就得到了唯一未知数$\mathbf{P}$（压力）的简化系统，在$\mathrm{R}$为非正弦的情况下，该系统有唯一的解。由于$\mathrm{A}$是非单调和正定的，如果$\mathrm{B}^{T}$有一个空核，则后一条件得到满足，即

!!!!
\operatorname{kerB}^{T}=\{\mathbf{0}\}
\label{17.53}\end{equation}

其中$\operatorname{kerB}^{T}=\left\{\mathbf{x} \in \mathbb{R}^{M}: B^{T} \mathbf{x}=\mathbf{0}\right\}$ 。后面的代数条件实际上等同于inf-sup条件\ref{17.20} （见练习一）。

另一方面，由于$\mathrm{A}$是非星形的，从$\mathbf{P}$的存在性和唯一性，我们推断存在一个唯一的矢量$\mathbf{U}$，满足\ref{17.51} 。

总之，当且仅当条件\ref{17.53}成立时，系统\rfe{17.49}承认有唯一的解$(\mathbf{U}, \mathbf{P})$。

备注17.3。条件\ref{17.53}相当于要求$B^{T}$(以及随之而来的$B$)具有全秩，即$\operatorname{rank}\left(B^{T}\right)=\min (N, M)$ ，因为秩$\left(B^{T}\right)$是$B^{T}$的线性独立行向量(或等价的列向量)的最大数目。在$\operatorname{deed}, \operatorname{rank}\left(B^{T}\right)+\operatorname{dim} \operatorname{ker}\left(B^{T}\right)=M$中

让我们再次考虑关于一般鞍点问题的备注$17.2$，并假设inf-sup条件\ref{17.20}不成立。那么

!!!!
\exists q_{h}^{*} \in Q_{h}: \quad b\left(\mathbf{v}_{h}, q_{h}^{*}\right)=0 \quad \forall \mathbf{v}_{h} \in V_{h}
\label{17.54}\end{equation}

因此，如果$\left(\mathbf{u}_{h}, p_{h}\right)$是斯托克斯问题\ref{17.18} 的一个解，那么$\left(\mathbf{u}_{h}, p_{h}+q_{h}^{*}\right)$也是一个解，因为

!!!!
\begin{aligned}
a\left(\mathbf{u}_{h}, \mathbf{v}_{h}\right)+b\left(\mathbf{v}_{h}, p_{h}+q_{h}^{*}\right) &=a\left(\mathbf{u}_{h}, \mathbf{v}_{h}\right)+b\left(\mathbf{v}_{h}, p_{h}\right)+b\left(\mathbf{v}_{h}, q_{h}^{*}\right) \\
&=a\left(\mathbf{u}_{h}, \mathbf{v}_{h}\right)+b\left(\mathbf{v}_{h}, p_{h}\right)=\left(\mathbf{f}, \mathbf{v}_{h}\right) \quad \forall \mathbf{v}_{h} \in V_{h}
\end{aligned}
$$

不能满足inf-sup条件的函数$q_{h}^{*}$对Galerkin问题\ref{17.18} 是不可见的。由于这个原因，正如已经观察到的那样，它们被称为假压力模式，甚至是寄生模式。它们的存在抑制了压力解的产生。
 ![](https://cdn.mathpix.com/cropped/991f5db518e324d299c1ff4972bba9fb-093.jpg?height=116&width=500&top_left_y=110&top_left_x=205)

图17.2.不连续压力的情况：不满足inf-sup条件的选择，在三角形上（左）和四边形上（右）。

是唯一的，产生了数值不稳定性。由于这个原因，那些违反兼容性条件\ref{17.20} 的有限维子空间被称为不稳定的，或不兼容的。

为了保证数值问题的良好解决，一般采用两种策略。

- 选择满足inf-sup条件的空间［$V_{h}$］和［$Q_{h}$］。

- 通过消除虚假模式来稳定（事先或事后）有限维度的问题。

让我们分析一下第一种类型的策略。首先，我们将考虑有限元空间的情况。为了描述$Q_{h}$和$V_{h}$的特征，只需在三角形的每个元素上选择它们的自由度。由于弱表述不需要连续压力，我们将首先考虑不连续压力的情况。

由于斯托克斯方程在$p$中为一阶，在$\mathbf{u}$中为二阶，一般来说，对速度空间$k \geq 1$使用程度为$V_{h}$的片断多项式是有意义的，对空间$k-1$使用程度为$Q_{h}$的片断多项式是有意义的。

特别是，我们可能希望对每个速度分量使用分片线性有限元$\mathbb{P}_{1}$，对压力使用分片常数有限元$\mathbb{P}_{0}$（见图$17.2$，在该图中，与后面所有的图一样，我们用符号$\square$表示压力的自由度，而用符号$\bullet$表示每个速度分量的自由度）。事实上，这种选择虽然很自然，但不能通过inf-sup检验\ref{17.20}（见练习3）。

当寻找一个兼容的空间夫妇时，速度空间$V_{h}$越大，越有可能满足inf-sup条件。否则，与空间$Q_{h}$相比，空间$V_{h}$应该足够 "丰富"。在图$17.3$中，我们报告了满足inf-sup条件的三种不同的空间选择，仍然是在连续ve-的情况下。

![](https://cdn.mathpix.com/cropped/991f5db518e324d299c1ff4972bba9fb-093.jpg?height=123&width=261&top_left_y=1031&top_left_x=110)
 ![](https://cdn.mathpix.com/cropped/991f5db518e324d299c1ff4972bba9fb-093.jpg?height=124&width=690&top_left_y=1030&top_left_x=110angles, (a), and on quadrilaterals, (b). Also the couple (c), known as Crouzeix-Raviart elements, satisfies the inf-sup condition 
 ![](https://cdn.mathpix.com/cropped/991f5db518e324d299c1ff4972bba9fb-094.jpg?height=264&width=504&top_left_y=110&top_left_x=204)

图17.4.连续压力的情况：夫妇（a）和（b）不满足$\inf -s u p$条件。(c)中用于速度分量的元素被称为$\mathbb{P}_{1}$-iso$\mathbb{P}_{2}$有限元，而(d)对偶被称为小型元素

locity和不连续的压力。选择(a)由$\mathbb{P}_{2}-\mathbb{P}_{0}$元素组成，(b)由$\mathbb{Q}_{2}-\mathbb{P}_{0}$元素组成，而选择(c)由片状线性不连续元素组成压力，而速度分量由片状二次连续元素组成，在每个三角形上富含一个立方气泡函数$-$这些是所谓Crouzeix-Raviart元素。

在图17.4(a), (b)中，我们报告了在连续压力情况下两种不兼容的有限元选择。它们由三角形上的片状线性元素（即四边形上的双线性元素）组成，用于速度和压力。更为普遍的是，速度和压力的相同多项式程度的有限元$k \geq 1$是不稳定的。在同一图中，(c)和(d)中显示的元素反而是稳定的。在这两种情况下，压力是一个片状线性连续函数，而速度是四个子三角形上的片状线性多项式（情况(c)），或由一个立方泡函数丰富的片状线性多项式（情况(d)）。这对$\mathbb{P}_{2}-\mathbb{P}_{1}$（连续的片状二次方速度和连续的片状线性压力）是稳定的。这是所谓的Taylor-Hood元素$\mathbb{P}_{k}-\mathbb{P}_{k-1}, k \geq 2$（连续速度和连续压力）家族的最小程度的代表，它是inf-sup稳定的。关于这里提到的稳定性结果的证明，以及收敛性分析，读者可以参考 [BF91a] 。

如果我们使用谱系方法，对速度和压力都使用等阶多项式空间，会产生违反inf-sup条件的子空间。兼容的谱空间可以通过对每个速度分量使用$N(\geq 2)$度的多项式和对压力使用$N-2$度的多项式来获得，从而产生所谓的$\mathbb{Q}_{N}-\mathbb{Q}_{N-2}$近似。每个速度分量的自由度由第10.2.3节介绍的$(N+1)^{2}$GLL节点表示（见图17.5）。对于压力，至少可以使用两组插值节点：或者由$(N-1)^{2}$GLL节点集的内部节点代表的子集（图17.6，左），或者由第10.2.2节介绍的$(N-1)^{2}$高斯节点代表（图17.6，右）。这种选择是光谱型近似的基础，如拼合、G-NI

![](https://cdn.mathpix.com/cropped/991f5db518e324d299c1ff4972bba9fb-095.jpg?height=295&width=298&top_left_y=120&top_left_x=309)

图17.5.$(N+1)^{2}$ Gauss-Legendre-Lobatto（GLL）节点（此处为$N=6$），承载速度分量的自由度。
 ![](https://cdn.mathpix.com/cropped/991f5db518e324d299c1ff4972bba9fb-095.jpg?height=290&width=622&top_left_y=508&top_left_x=144)

图 17.6.$(N-1)^{2}$内部高斯-勒格-洛巴托（GLL）节点（左）和$(N-1)^{2}$高斯-勒格（GL）节点（右）（此处为$N=6$），主持压力的自由度。

(Galerkin with numerical integration), 或 SEM-NI (spectral element with numerical integration) (见 [CHQZ07] )。

\subsection{An example of stabilized problem}

我们已经看到，对速度和压力都使用等度多项式的有限元或谱系方法不满足inf-sup条件，因此是不稳定的。然而，通过SUPG或GLS技术来稳定它们是可能的，比如在第13章中遇到的对平流-扩散方程进行数值逼近的框架。关于斯托克斯方程的稳定化技术的一般讨论，读者可以参考[BF91a] 。在此，我们只想说明在速度分量和压力分量均采用片状连续线性有限元的情况下，GLS稳定技术如何应用于问题\ref{17.18} 。

!!!!
V_{h}=\left[\dot{X}_{h}^{1}\right]^{2}, \quad Q_{h}=\left\{q_{h} \in X_{h}^{1}: \int_{\Omega} q_{h} d \Omega=0\right\}
$$

这一选择是由于需要保持尽可能低的全局自由度数，特别是在处理三维问题时。因此，我们设定$W_{h}=V_{h} \times Q_{h}$，并代替\ref{17.18} ，考虑以下问题（我们将自己限制在$\alpha=0$的情况下）。

!!!!
\text { find }\left(\mathbf{u}_{h}, p_{h}\right) \in W_{h}: A_{h}\left(\mathbf{u}_{h}, p_{h} ; \mathbf{v}_{h}, q_{h}\right)=\left(\mathbf{f}_{h}, \mathbf{v}_{h}\right) \quad \forall\left(\mathbf{v}_{h}, q_{h}\right) \in W_{h} .
\label{17.55}\end{equation}

我们已经设定了

!!!!
\begin{aligned}
&A_{h}: W_{h} \times W_{h} \rightarrow \mathbb{R} \\
&A_{h}\left(\mathbf{u}_{h}, p_{h} ; \mathbf{v}_{h}, q_{h}\right)=a\left(\mathbf{u}_{h}, \mathbf{v}_{h}\right)+b\left(\mathbf{v}_{h}, p_{h}\right)-b\left(\mathbf{u}_{h}, q_{h}\right) \\
&+\delta \sum_{K \in \mathscr{T}_{h}} h_{K}^{2} \int_{K}\left(-v \Delta \mathbf{u}_{h}+\nabla p_{h}-\mathbf{f}\right)\left(-v \Delta \mathbf{v}_{h}+\nabla q_{h}\right) d K
\end{aligned}
$$

我们用$\delta$表示一个必须方便地选择的正参数。这是对问题\ref{17.11}的强一致性近似：事实上，取决于离散动量方程残差的附加项在精确解的计算中是空的，这要感谢\ref{17.12} ,$-v \Delta \mathbf{u}+\nabla p-\mathbf{f}=\mathbf{0}$ 。 (注意，在这种特定情况下，$\Delta \mathbf{u}_{h \mid K}=\Delta \mathbf{v}_{h \mid K}=\mathbf{0} \forall K \in \mathscr{T}_{h}$ 因为我们使用的是分片线性有限元函数。) 。

从一致性上看

!!!!
A_{h}\left(\mathbf{u}_{h}, p_{h} ; \mathbf{u}_{h}, p_{h}\right)=v\left\|\nabla \mathbf{u}_{h}\right\|_{\mathbf{L}^{2}(\Omega)}^{2}+\delta \sum_{k \in \mathscr{T}_{h}} h_{K}^{2}\left\|\nabla p_{h}\right\|_{\mathbf{L}^{2}(K)}^{2}
\label{17.56}\end{equation}

我们推断，双线性形式$A_{h}$的核还原为空向量，因此问题\ref{17.55} 有一个且只有一个解。后者满足稳定性不等式

!!!!
v\left\|\nabla \mathbf{u}_{h}\right\|_{\mathbf{L}^{2}(\Omega)}^{2}+\delta \sum_{K \in \mathscr{T}_{h}} h_{K}^{2}\left\|\nabla p_{h}\right\|_{\mathbf{L}^{2}(K)}^{2} \leq C\|\mathbf{f}\|_{\mathbf{L}^{2}(\Omega)}^{2}
\label{17.57}\end{equation}

$C$是一个常数，取决于$v$，但不取决于$h$（见练习7）。

通过应用斯特朗定理$10.1$，我们现在可以证明广义Galerkin问题\ref{17.55} 的解满足以下误差估计

!!!!
\left\|\mathbf{u}-\mathbf{u}_{h}\right\|_{\mathbf{H}^{1}(\Omega)}+\left(\delta \sum_{K \in \mathscr{T}_{h}} h_{K}^{2}\left\|\nabla p-\nabla p_{h}\right\|_{\mathbf{L}^{2}(K)}^{2}\right)^{1 / 2} \leq C h
$$

仍然使用第17.2节的符号，我们可以证明\ref{17.55} 承认以下矩阵形式

!!!!
\left[\begin{array}{cc}
\mathrm{A} & \mathrm{B}^{T} \\
\mathrm{~B} & -\mathrm{C}
\end{array}\right]\left[\begin{array}{l}
\mathbf{U} \\
\mathbf{P}
\end{array}\right]=\left[\begin{array}{l}
\mathbf{F} \\
\mathbf{G}
\end{array}\right]
\label{17.58}\end{equation}

这个系统与没有稳定化的\ref{17.49} 不同，因为存在占据位置$(2,2)$的非空块，它与稳定化项有关。更确切地说。

!!!!
C=\left(c_{k m}\right), c_{k m}=\delta \sum_{K \in \mathscr{T}_{h}} h_{K}^{2} \int_{K} \nabla \phi_{m} \cdot \nabla \phi_{k} d K, \quad k, m=1, \ldots, M
$$

而右手边的分量$\mathbf{G}$是

!!!!
g_{k}=-\delta \sum_{K \in \mathscr{T}_{h}} h_{K}^{2} \int_{K} \mathbf{f} \cdot \nabla \phi_{k} d K, \quad k=1, \ldots, M
$$

在这种情况下，压力未知数的简化系统为

!!!!
\mathbf{R} \mathbf{P}=\mathbf{B A}^{-1} \mathbf{F}-\mathbf{G}
$$

与\ref{17.52}相比，这次的$\mathrm{R}=\mathrm{BA}^{-1} \mathrm{~B}^{T}+\mathrm{C}$。矩阵$\mathrm{R}$是非星形的，因为$\mathrm{C}$是一个正定矩阵。

\subsection{A numerical example}

我们要解决方域中的静止的纳维-斯托克斯方程$\Omega=$ $(0,1) \times(0,1)$，其迪里切条件如下

!!!!
\begin{array}{ll}
\mathbf{u}=\mathbf{0}, & \mathbf{x} \in \partial \Omega \backslash \Gamma \\
\mathbf{u}=(1,0)^{T}, & \mathbf{x} \in \Gamma
\end{array}
\label{17.59}\end{equation}

其中 $\Gamma=\left\{\mathbf{x}=\left(x_{1}, x_{2}\right)^{T} \in \partial \Omega: x_{2}=1\right\}$ 。这个问题被称为Liddriven cavity中的流动。我们将在矩形有限元上使用连续的片状双线性$\mathbb{Q}_{1}-\mathbb{Q}_{1}$多项式。正如我们所知，这些空间不满足兼容性条件近似；在图17.7，左边，我们显示了由这种Galerkin近似产生的虚假压力模式。在同一幅图中，我们画出了在同一类型的有限元上使用GLS稳定化（在上一节中谈到）得到的压力隔离线。现在的压力已经没有数值振荡了。对于稳定化问题，在图17.8中我们显示了两个不同的雷诺数值$\operatorname{Re}=1000$和$\operatorname{Re}=5000$的流线。稳定项同时修正了压力不稳定性（通过摆脱虚假的
 ![](https://cdn.mathpix.com/cropped/991f5db518e324d299c1ff4972bba9fb-098.jpg?height=324&width=674&top_left_y=122&top_left_x=116)

图17.7.盖子驱动的空腔问题的数值近似的压力隔离线。稳定的GLS近似（在右边）；垂直线对应于压力的空值。非稳定的近似（在左边）；明显存在着虚假的数值压力

![](https://cdn.mathpix.com/cropped/991f5db518e324d299c1ff4972bba9fb-098.jpg?height=327&width=325&top_left_y=582&top_left_x=119)
 ![](https://cdn.mathpix.com/cropped/991f5db518e324d299c1ff4972bba9fb-098.jpg?height=326&width=678&top_left_y=582&top_left_x=119) to two different values of the Reynolds number: $\operatorname{Re}=1000$, left, and $\operatorname{Re}=5000$, right

模式）和纯Galerkin方法的潜在不稳定性，当扩散被对流所主导时，就会出现这种情况，我们在第$13$章中已经广泛地讨论了这个问题。

对于同样的问题，我们也考虑了频谱G-NI近似，其中压力和每个速度分量是$\mathbb{Q}_{N}$的多项式（与$N=32$）。如前所述，这种空间的选择不满足inf-sup条件，因此它产生了虚假的压力模式，在图17.9左图中清晰可见。类似于之前用于有限元的GLS稳定化，也可以为G-NI方法设置。相应的解现在是稳定的，没有虚假的
 ![](https://cdn.mathpix.com/cropped/991f5db518e324d299c1ff4972bba9fb-099.jpg?height=300&width=628&top_left_y=115&top_left_x=143)

图 17.9.纯谱G-NI方法（左边）和GLS稳定谱G-NI方法（右边）得到的压力隔离线。在这两种情况下，压力和速度都使用了相同程度的多项式，$N=32$。正如预期的那样，纯G-NI方法产生了虚假的压力解。测试案例是以前用双线性有限元逼近的相同的盖子驱动的空腔问题

如同该图右侧显示的压力隔离线所示，压力模式。

\subsection{Time discretization of Navier-Stokes equations}

现在让我们回到纳维-斯托克斯方程\ref{17.2} ，重点讨论时间离散化的问题。为了避免不必要的繁琐符号，从现在开始，我们将假设\ref{17.4} 中的$\Gamma_{D}=\partial \Omega$和$\varphi=\mathbf{0}$，此时速度空间变成$V=$ $\left[\mathrm{H}_{0}^{1}(\Omega)\right]^{d}$ 。纳维-斯托克斯方程的空间离散化得到以下问题：对于每一个$t>0$，找到$\left(\mathbf{u}_{h}(t), p_{h}(t)\right) \in V_{h} \times Q_{h}$，使得

!!!!
\left\{\begin{aligned}
\left(\frac{\partial \mathbf{u}_{h}(t)}{\partial t}, \mathbf{v}_{h}\right) &+a\left(\mathbf{u}_{h}(t), \mathbf{v}_{h}\right)+c\left(\mathbf{u}_{h}(t), \mathbf{u}_{h}(t), \mathbf{v}_{h}\right)+b\left(\mathbf{v}_{h}, p_{h}(t)\right) \\
&=\left(\mathbf{f}_{h}(t), \mathbf{v}_{h}\right) \forall \mathbf{v}_{h} \in V_{h} \\
b\left(\mathbf{u}_{h}(t), q_{h}\right) &=0 \quad \forall q_{h} \in Q_{h}
\end{aligned}\right.
\label{17.60}\end{equation}

其中，像往常一样，$\left\{V_{h} \subset V\right\}$和$\left\{Q_{h} \subset Q\right\}$分别是速度和压力函数空间的两个有限维子空间族。三线性形式$c(\cdot, \cdot, \cdot)$，定义为

!!!!
c(\mathbf{w}, \mathbf{z}, \mathbf{v})=\int_{\Omega}[(\mathbf{w} \cdot \nabla) \mathbf{z}] \cdot \mathbf{v} d \Omega \quad \forall \mathbf{w}, \mathbf{z}, \mathbf{v} \in V
$$

是与非线性对流项相关的，而$a(\cdot, \cdot)$和$b(\cdot, \cdot)$与\ref{17.13} 中相同（然而设定$\alpha=0$）。

问题\ref{17.60} 实际上是一个非线性微分代数方程组。通过使用前几节已经使用过的符号，它可以用紧凑的形式重新表述如下

!!!!
\left\{\begin{array}{l}
\mathrm{M} \frac{d \mathbf{u}(t)}{d t}+\mathrm{A} \mathbf{u}(t)+\mathrm{C}(\mathbf{u}(t)) \mathbf{u}(t)+\mathrm{B}^{T} \mathbf{p}(t)=\mathbf{f}(t) \\
\mathrm{B} \mathbf{u}(t)=\mathbf{0}
\end{array}\right.
\label{17.61}\end{equation}

与$\mathbf{u}(0)=\mathbf{u}_{0} \cdot \mathrm{C}(\mathbf{u}(t))$实际上是一个取决于$\mathbf{u}(t)$的矩阵，其通用系数为$c_{m i}(t)=c\left(\mathbf{u}(t), \varphi_{i}, \varphi_{m}\right)$。对于这个系统的时间离散化，让我们使用，例如，$\theta$方法，该方法在第二节中介绍过。  $5.1$介绍的抛物线方程的方法。通过设置

!!!!
\begin{aligned}
&\mathbf{u}_{\theta}^{n+1}=\theta \mathbf{u}^{n+1}+(1-\theta) \mathbf{u}^{n} \\
&\mathbf{p}_{\theta}^{n+1}=\theta \mathbf{p}^{n+1}+(1-\theta) \mathbf{p}^{n} \\
&\mathbf{f}_{\theta}^{n+1}=\theta \mathbf{f}\left(t^{n+1}\right)+(1-\theta) \mathbf{f}\left(t^{n}\right) \\
&\mathrm{C}_{\theta}\left(\mathbf{u}^{n+1, n}\right) \mathbf{u}^{n+1, n}=\theta \mathrm{C}\left(\mathbf{u}^{n+1}\right) \mathbf{u}^{n+1}+(1-\theta) \mathrm{C}\left(\mathbf{u}^{n}\right) \mathbf{u}^{n}
\end{aligned}
$$

我们得到以下代数方程组

!!!!
\left\{\begin{array}{l}
\mathrm{M} \frac{\mathbf{u}^{n+1}-\mathbf{u}^{n}}{\Delta t}+\mathrm{Au}_{\theta}^{n+1}+\mathrm{C}_{\theta}\left(\mathbf{u}^{n+1, n}\right) \mathbf{u}^{n+1, n}+\mathrm{B}^{T} \mathbf{p}_{\theta}^{n+1}=\mathbf{f}_{\theta}^{n+1} \\
\mathrm{~B} \mathbf{u}^{n+1}=\mathbf{0}
\end{array}\right.
\label{17.62}\end{equation}

除了特殊情况$\theta=0$，即对应于正向欧拉方法，这个系统的解决是相当复杂的。一个可能的选择是使用半隐式方案，其中方程的线性部分是隐式推进的，而非线性项是显式推进的。这样做，如果$\theta \geq 1 / 2$，得到的方案是无条件稳定的，而在所有其他情况下，它必须服从对时间步长$\Delta t$的稳定性限制（取决于$h$和$v$ ）。我们在下一节将进一步阐述这个问题。随后，在第17.7.2节和第17.7.2节中，我们将进一步阐述这个问题。17.7.2和17.7.3节，我们将讨论其他时间离散化方案。关于更多的细节、结果和参考文献，例如，见[QV94，第13章]。

\subsubsection{Finite difference methods}

我们首先考虑\ref{17.61}中第一个方程的明确时间离散化，对应于\ref{17.62} 中的选择$\theta=0$。如果我们假设所有的量在$t^{n}$时都是已知的，我们可以把$t^{n}+1$时的相关问题写成以下样子

!!!!
\left\{\begin{array}{l}
\mathbf{M} \mathbf{u}^{n+1}=H\left(\mathbf{u}^{n}, \mathbf{p}^{n}, \mathbf{f}^{n}\right) \\
\mathbf{B} \mathbf{u}^{n+1}=\mathbf{0}
\end{array}\right.
$$

其中$\mathrm{M}$是质量矩阵，其条目为

!!!!
m_{i j}=\int_{\Omega} \boldsymbol{\varphi}_{i} \varphi_{j} d \Omega
$$

这个系统对于未知矢量$\mathbf{u}^{n+1}$是过度确定的，而它不允许确定压力$\mathbf{p}^{n+1}$ 。然而，如果我们在动量方程中用$\mathbf{p}^{n+1}$代替$\mathbf{p}^{n}$，我们会得到新的线性系统

!!!!
\left\{\begin{array}{l}
\frac{1}{\Delta t} \mathbf{M} \mathbf{u}^{n+1}+\mathbf{B}^{T} \mathbf{p}^{n+1}=\mathbf{G} \\
\mathbf{B} \mathbf{u}^{n+1}=\mathbf{0}
\end{array}\right.
\label{17.63}\end{equation}

G是一个合适的已知矢量。这个系统对应于\ref{17.60}的半显式离散化。由于$\mathrm{M}$是对称的和正定的，如果条件\ref{17.53}得到满足，那么还原后的系统$\mathrm{BM}^{-1} \mathrm{~B}^{T} \mathbf{p}^{n+1}=\mathrm{BM}^{-1} \mathbf{G}$是非正定的。一旦得到解决，速度矢量$\mathbf{u}^{n+1}$可以从\ref{17.63} 的第一个方程中恢复出来。只要时间步长满足以下限制，这种离散化方法就具有时间稳定性

!!!!
\Delta t \leq C \min \left(\frac{h^{2}}{v}, \frac{h}{\max _{\mathbf{x} \in \Omega}\left|\mathbf{u}^{n}(\mathbf{x})\right|}\right)
$$

现在让我们考虑对\ref{17.60}的隐式离散化，例如后向欧拉方法，它对应于在\ref{17.62}中选择$\theta=1$。正如已经观察到的，这个方案是无条件稳定的。它产生了一个非线性代数系统，可以被看作是稳定的Navier-Stokes问题的有限元空间近似值

!!!!
\left\{\begin{array}{l}
-v \Delta \mathbf{u}^{n+1}+\left(\mathbf{u}^{n+1} \cdot \nabla\right) \mathbf{u}^{n+1}+\nabla p^{n+1}+\frac{\mathbf{u}^{n+1}}{\Delta t}=\tilde{\mathbf{f}} \\
\operatorname{div} \mathbf{u}^{n+1}=0
\end{array}\right.
$$

这种非线性代数系统的求解可以通过Newton-Krylov技术来实现，即使用Krylov方法（例如GMRES或BiCGStab）来求解在Newton每个迭代步骤中得到的线性系统（参见，例如[Saa96]或[QV94，第2章]）。我们记得，牛顿方法是基于对流项的完全线性化， $\mathbf{u}_{k}^{n+1} \cdot \nabla \mathbf{u}_{k+1}^{n+1}+\mathbf{u}_{k+1}^{n+1} \cdot \nabla \mathbf{u}_{k}^{n+1}$ 。一种流行的方法是在少数Piccard迭代后开始牛顿迭代，其中对流项的评估如下。  $\mathbf{u}_{k}^{n+1} \cdot \nabla \mathbf{u}_{k+1}^{n+1}$ .这种方法需要三个嵌套循环。

- 时间上的迭代。  $t^{n} \rightarrow t^{n+1}$ ;

- 牛顿迭代。  $\mathbf{x}_{k}^{n+1} \rightarrow \mathbf{x}_{k+1}^{n+1}$ ;

- 克里洛夫迭代。  $\left[\mathbf{x}_{k}^{n+1}\right]_{j} \rightarrow\left[\mathbf{x}_{k}^{n+1}\right]_{j+1}$；为了简单起见，我们把$\mathbf{x}^{n}$称为夫妇$\left(\mathbf{u}^{n}, \mathbf{p}^{n}\right)$ 。很明显，目标是以下收敛结果。

!!!!
\lim _{k \rightarrow \infty} \lim _{j \rightarrow \infty}\left[\mathbf{x}_{k}^{n+1}\right]_{j}=\left[\begin{array}{l}
\mathbf{u}^{n+1} \\
\mathbf{p}^{n+1}
\end{array}\right]
$$

最后，让我们操作一个半隐式的时间离散化，包括明确处理非线性对流项。在这种情况下，可以得到以下代数线性系统，其形式类似于\ref{17.49} 。

!!!!
\left\{\begin{array}{l}
\frac{1}{\Delta t} \mathrm{Mu}^{n+1}+\mathrm{A} \mathbf{u}^{n+1}+\mathrm{B}^{T} \mathbf{p}^{n+1}=\mathbf{G} \\
\mathrm{Bu}^{n+1}=\mathbf{0}
\end{array}\right.
\label{17.64}\end{equation}

其中$\mathbf{G}$是一个合适的已知向量。在这种情况下，对时间步长的稳定性限制有以下形式

!!!!
\Delta t \leq C \frac{h}{\max _{\mathbf{x} \in \Omega}\left|\mathbf{u}^{n}(\mathbf{x})\right|}
\label{17.65}\end{equation}

在所有情况下，都可以证明最佳误差估计。

\subsubsection{Characteristics (or Lagrangian) methods}

速度矢量场的物质导数（也称为拉格朗日导数）被定义为

!!!!
\frac{D \mathbf{u}}{D t}=\frac{\partial \mathbf{u}}{\partial t}+(\mathbf{u} \cdot \nabla) \mathbf{u}
$$

特征方法是基于对材料导数的近似，例如通过后向欧拉方法

!!!!
\frac{D \mathbf{u}}{D t}(\mathbf{x}) \approx \frac{\mathbf{u}^{n+1}(\mathbf{x})-\mathbf{u}^{n}\left(\mathbf{x}_{p}\right)}{\Delta t}
$$

其中$\mathbf{x}_{p}$是在$t^{n}$时间从$t^{n+1}$发出的特征的脚。必须解决一个普通微分方程系统，以追溯从$\mathbf{x}$点发出的特征线$\mathbf{X}$。

!!!!
\left\{\begin{array}{l}
\frac{d \mathbf{X}}{d t}(t ; s, \mathbf{x})=\mathbf{u}(t, \mathbf{X}(t ; s, \mathbf{x})), \quad t \in\left(t^{n}, t^{n+1}\right) \\
\mathbf{X}(s ; s, \mathbf{x})=\mathbf{x}
\end{array}\right.
$$

已设置 $s=t^{n+1}$ 。

主要的困难在于确定特征线。第一个问题是如何对$\mathbf{u}(\mathbf{t})$的速度场进行适当的近似，因为$\mathbf{u}^{n+1}$是未知的。最简单的方法是使用前向欧拉方案对材料导数进行离散化。第二个困难来自于一个特征线可能穿过计算网格的几个元素的事实。因此，有必要采用一种算法来定位特征线脚所在的元素，或者检测出后者碰到边界边缘的情况。通过前面对材料导数的离散化，在每个时间层$t^{n+1}$，动量方程变成（正式）的

!!!!
\frac{\mathbf{u}^{n+1}(\mathbf{x})-\mathbf{u}^{n}\left(\mathbf{x}_{p}\right)}{\Delta t}-v \Delta \mathbf{u}^{n+1}(\mathbf{x})+\nabla p^{n+1}(\mathbf{x})=\mathbf{f}^{n+1}(\mathbf{x})
$$

如果在空间的分片线性有限元框架内使用，这个方案是无条件稳定的。此外，它满足误差估计

!!!!
\left\|\mathbf{u}\left(t^{n}\right)-\mathbf{u}^{n}\right\|_{L^{2}(\Omega)} \leq C\left(h+\Delta t+h^{2} / \Delta t\right) \quad \forall n \geq 1
$$

为独立于$C$的正常数$v$ 。基于特征的光谱方法的时间离散化策略在[CHQZ07，第3章]中进行了回顾。

\subsubsection{Fractional step methods}

让我们考虑一个抽象的时间相关问题。

!!!!
\frac{\partial w}{\partial t}+L w=f
$$

其中$L$是一个微分算子，它分成两个算子$L_{1}$和$L_{2}$之和，即

!!!!
L v=L_{1} v+L_{2} v
$$

分数步法允许分两步（或更多）从时间$t^{n}$到$t^{n+1}$的时间推进。首先，只有算子$L_{1}$在时间上隐式推进，然后通过执行第二步来修正所得到的解决方案，其中只有另一个算子$L_{2}$在发挥作用。这就是为什么这类方法也被称为算子分割。

原则上，通过分离两个算子$L_{1}$和$L_{2}$，一个复杂的问题被分割成两个较简单的问题，每个问题都有自己的特点。在这方面，运算符$L_{1}$和$L_{2}$的选择可以基于物理考虑：例如，扩散可以从运输中分离出来。事实上，用特征法解决纳维-斯托克斯方程也可以被看作是一种分数步骤法，其第一步算子由拉格朗日导数表示。

一个简单的，尽管不是最佳的分步方案，就是下面这个被称为亚年科分割的方案。

1. 计算方程的解$\tilde{w}$。

!!!!
\frac{\tilde{w}-w^{n}}{\Delta t}+L_{1} \tilde{w}=0
$$

2. 计算方程的解$w^{n+1}$。

!!!!
\frac{w^{n+1}-\tilde{w}}{\Delta t}+L_{2} w^{n+1}=f^{n}
$$

通过消除$\tilde{w}$，可以发现$w^{n+1}$的问题如下

!!!!
\frac{w^{n+1}-w^{n}}{\Delta t}+L w^{n+1}=f^{n}+\Delta t L_{1}\left(f^{n}-L_{2} w^{n+1}\right)
$$

如果$L_{1}$和$L_{2}$都是椭圆算子，这个方案对于$\Delta t$来说是无条件稳定的。

这一策略可以应用于纳维-斯托克斯方程\ref{17.2} ，选择$L_{1}$作为$L_{1}(\mathbf{w})=-v \Delta \mathbf{w}+(\mathbf{w} \cdot \nabla) \mathbf{w}$，而$L_{2}$是与纳维-斯托克斯问题的剩余项相关的算子。这样，我们就把处理纳维-斯托克斯方程时产生的主要困难，即非线性部分与施加不可压缩性约束的部分分开。相应的分步方案为：。

1. 解决速度的扩散-运输方程$\tilde{\mathbf{u}}^{n+1}

!!!!
\begin{cases}\frac{\tilde{\mathbf{u}}^{n+1}-\mathbf{u}^{n}}{\Delta t}-v \Delta \tilde{\mathbf{u}}^{n+1}+\left(\mathbf{u}^{*} \cdot \nabla\right) \mathbf{u}^{* *}=\mathbf{f}^{n+1} & \text { in } \Omega \\ \widetilde{\mathbf{u}}^{n+1}=\mathbf{0} & \text { on } \partial \Omega\end{cases}
\label{17.66}\end{equation}

2. 对两个未知数$\mathbf{u}^{n+1}$和$p^{n+1}$解决以下耦合问题

!!!!
\begin{cases}\frac{\mathbf{u}^{n+1}-\tilde{\mathbf{u}}^{n+1}}{\Delta t}+\nabla p^{n+1}=\mathbf{0} & \text { in } \Omega \\ \operatorname{divu}^{n+1}=0 & \text { in } \Omega \\ \mathbf{u}^{n+1} \cdot \mathbf{n}=0 & \text { on } \partial \Omega\end{cases}
\label{17.67}\end{equation}

其中$\mathbf{u}^{*}$和$\mathbf{u}^{* *}$可以是$\tilde{\mathbf{u}}^{n+1}$或$\mathbf{u}^{n}$，取决于非线性对流项的处理是显式、隐式还是半隐式。这样，在第一步计算出中间速度$\tilde{\mathbf{u}}^{n+1}$，然后在第二步对其进行修正，以满足不可压缩性约束。第一步的扩散-传输问题可以通过使用第$13$章中研究的近似技术成功解决。

更多的是对与第二步有关的问题的数值处理。通过对第一个方程正式应用发散算子，我们可以得到

!!!!
\operatorname{div} \frac{\mathbf{u}^{n+1}}{\Delta t}-\operatorname{div} \frac{\tilde{\mathbf{u}}^{n+1}}{\Delta t}+\Delta p^{n+1}=0
$$

是一个具有诺伊曼边界条件的椭圆边界值问题

!!!!
\left\{\begin{array}{l}
-\Delta p^{n+1}=-\operatorname{div} \frac{\tilde{\mathbf{u}}^{n+1}}{\Delta t} \quad \text { in } \Omega \\
\frac{\partial p^{n+1}}{\partial n}=0 \quad \text { on } \partial \Omega
\end{array}\right.
\label{17.68}\end{equation}

诺伊曼条件来自于$\mathbf{u}^{n+1} \cdot \mathbf{n}=0$上的条件$\partial \Omega$。从\ref{17.68}的解，我们得到$p^{n+1}$，从而通过使用\ref{17.67}的第一个方程得到$\mathbf{u}^{n+1}$。

!!!!
\mathbf{u}^{n+1}=\tilde{\mathbf{u}}^{n+1}-\Delta t \nabla p^{n+1} \quad \text { in } \Omega
\label{17.69}\end{equation}

这正是为了满足无发散约束而对速度场进行的修正。

总之，首先我们求解椭圆系统\ref{17.66} 得到中间速度$\tilde{\mathbf{u}}^{n+1}$，然后通过标量椭圆问题\ref{17.68} 得到压力未知数$p^{n+1}$，最后通过显式修正方程\ref{17.69} 得到新速度场$\mathbf{u}^{n+1}$。

现在让我们研究一下这种方法的主要特点。

假设我们在第一步采取$\mathbf{u}^{*}=\mathbf{u}^{* *}=\mathbf{u}^{n}$；在空间离散化之后，我们得出一个线性系统为

!!!!
\left(\frac{1}{\Delta t} \mathrm{M}+\mathrm{A}\right) \tilde{\mathbf{u}}^{n+1}=\tilde{\mathbf{f}}^{n+1}
$$

由于对对流项的明确处理，该解在时间步长上经历了像\ref{17.65} 那样的稳定性限制。另一方面，这个线性系统自然地分裂成$d$个较小规模的独立系统，速度场的每个空间分量都有一个。

相反，如果我们使用隐式时间推进方案，就像我们通过设置$\mathbf{u}^{*}=\mathbf{u}^{* *}=\tilde{\mathbf{u}}^{n+1}$得到的那样，我们得到一个无条件稳定的方案，但是由于非线性对流项的存在，所有空间分量的耦合更加复杂。这个非线性代数系统可以通过例如牛顿-克雷洛夫方法来解决，类似于我们在第17.7.1节介绍的方法。在该方法的第二步，我们只对速度场的法向分量强制执行边界条件。然而，我们对切向分量的行为缺乏任何控制。这就产生了一个所谓的分裂误差：尽管解是无发散的，但由于没有满足切向速度分量的物理边界条件，就会产生宽度为$\sqrt{v \Delta t}$的压力边界层。

刚刚描述的方法最初是由Chorin和Temam提出的，也被称为投影法。原因可以在著名的Helmholtz-Weyl 分解定理中找到。

![](https://cdn.mathpix.com/cropped/991f5db518e324d299c1ff4972bba9fb-105.jpg?height=266&width=722&top_left_y=966&top_left_x=97)

由于这一结果，任何函数$\mathbf{v} \in\left[\mathrm{L}^{2}(\Omega)\right]^{d}$都可以统一表示为一个螺线管（即无发散）场和一个非旋转场（即一个合适的标量函数的梯度）之和。

事实上，在第一步\ref{17.66} 中，初步速度$\tilde{\mathbf{u}}^{n+1}$是通过解决动量方程从$\mathbf{u}^{n}$中得到的，在第二步的过程中，在\ref{17.69} 中构建了一个螺线型场$\mathbf{u}^{n+1}$，$\mathbf{u}^{n+1} \cdot \mathbf{n}=0$在$\partial \Omega$上。这个螺线管场是$\widetilde{\mathbf{u}}^{n+1}$的投影，通过应用分解定理和以下标识得到。  $\mathbf{v}=\tilde{\mathbf{w}}^{n+1}, \mathbf{v}=\mathbf{u}^{n+1}, \psi=+\Delta t p^{n+1}$ .

命名为投射法是由于

!!!!
\int_{\Omega} \mathbf{u}^{n+1} \cdot \psi d \Omega=\int_{\Omega} \tilde{\mathbf{u}}^{n+1} \cdot \psi d \Omega \quad \forall \psi \in \mathrm{H}_{\mathrm{div}}^{0}
$$

即$\mathbf{u}^{n+1}$是$\mathrm{L}^{2}(\Omega)$的标量积在空间$\mathrm{H}_{\text {div }}^{0}$的投影。

备注17.4。为了减少对压力的分割误差，已经提出了几种投影方法的变体，不仅适用于有限元方法，也适用于高阶谱或谱元空间近似。有兴趣的读者可以参考，例如[QV94, Qua93, Pro97, KS05]和[CHQZ07, Chap.3]。

例17.1.在图17.10中，我们显示了在有5个圆孔的二维域$\Omega=(0,17) \times(0,10)$中，纳维-斯托克斯方程解所对应的速度模量的孤立线。这可以被看作是具有5个圆柱体的三维域的正交部分。一个非均质的Dirichlet条件，$\mathbf{u}=[\arctan (20(5-|5-y|)), 0]^{T}$，在流入处被指定，一个均质的Dirichlet条件被规定在水平面以及圆柱体的边界上，而在流出处，应力张量的法向分量被设置为零。空间离散采用稳定谱元法，有114个谱元，每个谱元上的压力和速度分量都是7度的多项式，加上二阶BDF2方案进行时间离散（见$8.5$和[QSS07]部分）。

\subsection{Algebraic factorization methods and preconditioners for saddle-point systems}

解决类似\ref{17.49} 的系统的另一种方法是基于使用系统矩阵\ref{17.50} 的不精确（或不完全）因式分解。我们提醒，这些系统可以通过近似解决斯托克斯方程、纳维-斯托克斯方程（在使用第17.7.1节描述的线性化方法之一后）得到。17.7.1, 17.7.2或17.7.3节所述的线性化方法），或者，更一般的，从鞍点问题的近似中得到，如17.3节所示。让我们也指出，在所有这些情况下，在
 ![](https://cdn.mathpix.com/cropped/991f5db518e324d299c1ff4972bba9fb-107.jpg?height=542&width=420&top_left_y=112&top_left_x=248)

图 17.10.例$17.1$的测试案例在$t=10.5$（上图）和$t=11.4$（下图）时间层的速度矢量模数的隔离线

空间离散化方法可以基于迄今为止讨论的任何一种方法（有限元、有限差分、有限体积、频谱方法等）。一般来说，我们将假设处理以下形式的代数系统

!!!!
\left[\begin{array}{ll}
\mathrm{C} & \mathrm{B}^{T} \\
\mathrm{~B} & 0
\end{array}\right]\left[\begin{array}{l}
\mathbf{U} \\
\mathbf{P}
\end{array}\right]=\left[\begin{array}{l}
\mathbf{F} \\
\mathbf{0}
\end{array}\right]
\label{17.70}\end{equation}

其中$C$在系统\ref{17.49} 的情况下与$A$重合，在系统\ref{17.64} 的情况下与$\frac{1}{\Delta t} \mathrm{M}+\mathrm{A}$重合，而更一般地，它可以由$\frac{\alpha}{\Delta t} \mathrm{M}+\mathrm{A}+\delta \mathrm{D}$给出，而$\mathrm{D}$是与压力梯度算子相关的矩阵，如果线性化或半隐式处理被应用到对流项。在后一种情况下，系数$\alpha$和$\delta$将取决于采用的具体线性化或半隐式方法。

同样在这种情况下，我们可以将\ref{17.70} 与舒尔补码联系起来

!!!!
\mathrm{R} \mathbf{P}=\mathrm{BC}^{-1} \mathbf{F}, \quad \text { with } \mathrm{R}=\mathrm{BC}^{-1} \mathrm{~B}^{T}
\label{17.71}\end{equation}

如果我们从斯托克斯系统\ref{17.49}而不是\ref{17.70}开始，它就会还原为\ref{17.52}。我们开始注意到$\mathrm{R}$的条件数取决于inf-sup常数$\beta_{h}$ ，见\ref{17.41}，以及连续性常数$\delta$（见\ref{17.21}）。更确切地说，在静止问题\ref{17.11}的情况下，以下关系成立

!!!!
\beta_{h}=\sqrt{\lambda_{\min }}, \quad \delta \geq \sqrt{\lambda_{\max }}
$$

其中$\lambda_{\min }$和$\lambda_{\max }$是$\mathrm{R}$的特征值（见[QV94, Sect. 9.2.1]）。因此，$\operatorname{cond}(\mathrm{R}) \leq \delta^{2} / \beta_{h}^{2}$ 。在时间依赖的情况下，我们得到一个类似\ref{17.70}的系统；在这种情况下，$\mathrm{R}$的条件数也取决于$\Delta t$和对流项被离散化的方式。

解决\ref{17.52} 的一个可能的策略是用迭代方法解决Schur补数系统\ref{17.71}：如果$\mathrm{C}=\mathrm{A}$（因为$A$是对称的），则采用共轭梯度法，否则采用GMRES或Bi-CGStab方法，当$\delta \neq 0$。使用一个方便的预处理程序是必须的。关于更普遍的讨论，例如，对于有限元离散化的情况，见[ESW05, BGL05, QV94]，对于基于谱法的离散化，见[CHQZ07]。

我们首先观察一下，系统\ref{17.70} 的矩阵，我们用$S$表示，可以写成两个块三角矩阵的乘积LU。

!!!!
\mathrm{S}=\left[\begin{array}{cc}
\mathrm{I} & 0 \\
\mathrm{BC}^{-1} & \mathrm{I}
\end{array}\right]\left[\begin{array}{cc}
\mathrm{C} & \mathrm{B}^{T} \\
0 & -\mathrm{R}
\end{array}\right]
$$

两个矩阵中的每一个

!!!!
P_{D}=\left[\begin{array}{cc}
C & 0 \\
0 & -R
\end{array}\right] \text { or } \quad P_{T}=\left[\begin{array}{cc}
C & B^{T} \\
0 & -R
\end{array}\right]
$$

提供了一个最佳的预处理程序$S$，一个块对角线预处理程序$\left(\mathrm{P}_{D}\right)$，和一个块三角形预处理程序$\left(\mathrm{P}_{T}\right.$）。)不幸的是，由于对角线上存在舒尔补码$\mathrm{R}$，它们的计算成本都很高，而舒尔补码又包含矩阵C的逆值。另外，我们可以使用它们的近似值

!!!!
\widehat{\mathrm{P}}_{\mathrm{D}}=\left[\begin{array}{cc}
\widehat{\mathrm{C}} & 0 \\
0 & -\widehat{\mathrm{R}}
\end{array}\right] \quad \text { or } \quad \widehat{\mathrm{P}}_{\mathrm{T}}=\left[\begin{array}{cc}
\widehat{\mathrm{C}} & \mathrm{B}^{T} \\
0 & -\widehat{\mathrm{R}}
\end{array}\right]
$$

其中$\widehat{C}$和$\widehat{R}$分别是$C$和$R$的两个便宜的近似值。  $\widehat{C}$可以从刚度矩阵的最优预处理中建立，比如那些将在$19$章中介绍的预处理。

压力校正扩散预处理程序（PCD）利用了以下$\mathrm{R}$的近似值

!!!!
\widehat{\mathrm{R}}_{P C D}=\mathrm{A}_{P} \mathrm{C}_{P}^{-1} \mathrm{M}_{P}
$$

其中$\mathrm{M}_{P}$是压力质量矩阵，$\mathrm{A}_{P}$是压力拉普拉斯矩阵，$\mathrm{C}_{P}$是对流-扩散压力矩阵。这里的 "压力 "意味着这些矩阵是通过使用有限维压力子空间$\left\{\varphi_{k}, k=1, \ldots, M\right\}$的基础函数$Q_{h}$产生的。这个预处理程序在频谱上等同于$\mathrm{BM}^{-1} \mathrm{~B}^{T}$ ，其中$\mathrm{M}$ 是速度质量矩阵。参见[ESW05] 。该预处理程序的应用需要一个泊松压力求解，一个质量矩阵求解，以及一个与$F_{P}$的矩阵向量乘积。在构建 $\mathrm{A}_{P}$ 和 $\mathrm{C}_{P}$ 时应考虑到边界条件。

最小二乘换算器预处理程序（LSC）是

!!!!
\widehat{\mathrm{R}}_{L S C}=\left(\mathrm{BM}_{V}^{-1} \mathrm{~B}^{T}\right)\left(\mathrm{BM}_{V}^{-1} \mathrm{CM}_{V}^{-1} \mathrm{~B}^{T}\right)^{-1}\left(\mathrm{~B} \widehat{\mathrm{M}}_{V}^{-1} \mathrm{~B}^{T}\right)
$$

其中$\widehat{\mathrm{M}}_{V}$是由速度质量矩阵$\mathrm{M}$得到的对角线矩阵，不考虑对角线外的条款。使用这个预处理程序需要进行两次泊松求解。使用LSC预处理的Krylov迭代的收敛性与网格大小无关，与雷诺数有轻微的关系。见[EHS $\left.^{+} 06\right]$ 。

在[BO06]中介绍的增强的拉格朗日预处理（AL），其内容为

!!!!
\widehat{\mathrm{R}}_{A L}=\left(v \widehat{\mathrm{M}}_{P}^{-1}+\gamma \mathrm{W}^{-1}\right)^{-1}
$$

其中$\widehat{\mathrm{M}}_{P}$是一个对角线矩阵，近似于$\mathrm{M}_{P}, \mathrm{~W}$是一个适当选择的矩阵，在最简单的情况下，也由$\widehat{\mathrm{M}}_{P}, v$是流动粘度和$\gamma$是一个正参数（通常取为1）给出。这个预处理程序要求对原系统\ref{17.70} 进行修改，用$\mathrm{C}+\gamma \mathrm{B}^{T} \mathrm{~W}^{-1} \mathrm{~B}$代替$(1,1)$块，这与$\mathrm{B} \mathbf{u}=\mathbf{0}$一致。新项$\gamma \mathrm{B}^{T} \mathrm{~W}^{-1} \mathrm{~B}$引入了速度矢量分量之间的耦合。然而，收敛性与网格大小和雷诺数都无关。

最后，让我们指出，可以使用基于全局矩阵的不完全$L U$因式分解（ILU）$\mathrm{S}$的直接代数预处理器，并结合适当的未知数重排。深入的讨论可以在 [RVS08] 中找到。

一个不同的$\mathrm{S}$的LU因子化。

!!!!
\mathrm{S}=\left[\begin{array}{cc}
\mathrm{C} & 0 \\
\mathrm{~B} & -\mathrm{R}
\end{array}\right]\left[\begin{array}{cc}
\mathrm{I} & \mathrm{C}^{-1} \mathrm{~B}^{T} \\
0 & \mathrm{I}
\end{array}\right]
\label{17.72}\end{equation}

在[Pat80]中介绍的所谓SIMPLE预处理的基础上，通过用三角矩阵$\mathrm{D}^{-1}$代替$\mathrm{L}$和$\mathrm{U}$中的$\mathrm{C}^{-1}$得到（比如，D可以是$\mathrm{C}$的对角线）。更确切地说。

!!!!
P_{S I M P L E}=\left[\begin{array}{cc}
C & 0 \\
B & -\widehat{R}
\end{array}\right]\left[\begin{array}{cc}
\mathrm{I} & \mathrm{D}^{-1} \mathrm{~B}^{T} \\
0 & \mathrm{I}
\end{array}\right]=\widehat{\mathrm{L}} \widehat{\mathrm{U}}
$$

与 $\widehat{\mathrm{R}}=\mathrm{BD}^{-1} \mathrm{~B}^{T}$ 。

使用这种预处理程序，当网格大小$h$减小和/或雷诺数增加时，预处理迭代方法的收敛性会变差。请注意，使用$\mathrm{P}_{S I M P L E}$一次，例如

!!!!
\mathrm{P}_{S I M P L E} \mathbf{w}=\mathbf{r}
\label{17.73}\end{equation}

与$\mathbf{r}=\left[\mathbf{r}_{u}, \mathbf{r}_{p}\right]$和$\mathbf{w}=[\mathbf{u}, \mathbf{p}]$，得到$\widehat{\mathrm{L}} \mathbf{w}^{*}=\mathbf{r}$，所以$\widehat{\mathrm{U}} \mathbf{w}=\mathbf{w}^{*}$，即设定$\mathbf{w}^{*}=\left[\mathbf{u}^{*}, \mathbf{p}^{*}\right]:

!!!!
\mathrm{Cu}^{*}=\mathbf{r}_{u} 
\label{17.74}\end{equation}

!!!!
\widehat{\mathbf{R}}=\mathrm{Bu}^{*}-\mathbf{r}_{p} 
\label{17.75}\end{equation}

!!!!
\mathbf{u}=\mathbf{u}^{*}-\mathrm{D}^{-1} \mathrm{~B}^{T} \mathbf{p}^{*}
\label{17.76}\end{equation}

这需要对速度进行C解，并对压力进行泊松解（对于$\mathrm{BD}^{-1} \mathrm{~B}^{T}$）。

已经提出了SIMPLE预处理程序的几个一般化，以SIMPER、$h$-SIMPLE和MSIMPLER的名义。在\ref{17.73} 中使用$\mathrm{P}_{\text {SIMPLER }}$而不是$P_{\text {SIMPLE }}$涉及以下步骤。

!!!!
\widehat{\mathrm{R}} \mathbf{p}^{0}=\mathrm{BD}^{-1} \mathbf{r}_{u}-\mathbf{r}_{p},
\label{17.77} 
$$

!!!!
\mathbf{C u}^{*}=\mathbf{r}_{u}-\mathrm{B}^{T} \mathbf{p}^{0} 
\label{17.78}\end{equation}

!!!!
\widehat{\mathrm{R}} \mathbf{p}^{*}=\mathrm{Bu}^{*}-\mathbf{r}_{p} 
\label{17.79}\end{equation}

!!!!
\mathbf{u}=\mathbf{u}^{*}-\mathrm{D}^{-1} \mathrm{~B}^{T} \mathbf{p}^{*} 
\label{17.80}\end{equation}

!!!!
\mathbf{p}=\mathbf{p}^{*}+\omega \mathbf{p}^{0},
\label{17.81}\end{equation}

其中$\omega \in] 0,1]$是一个可能的松弛参数$(\omega=1$在SIMPLE中，$\omega \neq 1$在$\operatorname{SIMPLER}(\omega)$中）。)因此，它涉及两个压力泊松求解和一个C-速度求解；然而，一般来说，它比SIMPLE享有更快的收敛性。

预处理程序$h S I M P L E$（$h=$混合）是基于SIMPLE和SIMPLER的综合应用。最后，预处理程序MSIMPLER使用了与SIMPLER相同的步骤\ref{17.77}-\ref{17.81}，但是近似的Schur补码$\mathrm{R}=$ $\mathrm{BD}^{-1} \mathrm{~B}^{T}$被最小二乘换算器$\widehat{\mathrm{R}}_{L S C}$取代。收敛性比SIMPLE的其他变体要好。

更多讨论和比较分析见 [RVS09] 以及 [Wes01] 。

在$\mathrm{P}_{S I M P L E}$中使用的$\widehat{L} \widehat{U}$因式分解可以被视为更普遍的不精确或代数因式分解家族的一个特例，其内容如下

!!!!
\widehat{\mathrm{S}}=\widehat{\mathrm{L}} \widehat{\mathrm{U}}=\left[\begin{array}{cc}
\mathrm{C} & 0 \\
\mathrm{~B} & -\mathrm{B} \mathscr{L} \mathrm{B}^{T}
\end{array}\right]\left[\begin{array}{cc}
\mathrm{I} & \mathscr{U} \mathrm{B}^{T} \\
0 & \mathrm{I}
\end{array}\right]
\label{17.82}\end{equation}

这里$\mathscr{L}$和$\mathscr{U}$代表$\mathrm{C}^{-1}$的两个（不一定重合）近似值。使用这个不精确的因式分解，线性系统的解是

!!!!
\widehat{\mathrm{S}}\left[\begin{array}{l}
\widehat{\mathbf{u}} \\
\widehat{\mathbf{p}}
\end{array}\right]=\left[\begin{array}{l}
\mathbf{F} \\
\mathbf{0}
\end{array}\right]
$$

可以通过以下步骤找到。

!!!!
\begin{array}{lll}
\text { step } \widehat{\mathrm{L}}: & \left\{\begin{array}{lll}
\mathrm{Cu}^{*}=\mathbf{F} & & \text { (intermediate velocity) } \\
-\mathrm{B} \mathscr{L} \mathrm{B}^{T} \widehat{\mathbf{p}}=-\mathrm{Bu}^{*}
\end{array}\right. & \begin{array}{l}
\text { (pressure })
\end{array} \\
\text { step } \widehat{\mathrm{U}}: \quad \widehat{\mathbf{u}}=\mathbf{u}^{*}-\mathscr{U} \mathrm{B}^{T} \widehat{\mathbf{p}} & \text { (final velocity) }
\end{array}
$$

当与时间相关的问题（无论是斯托克斯还是纳维-斯托克斯）一起使用时，例如\ref{17.64} ，有两种不同的可能 [QSV00] 。

!!!!
\mathscr{L}=\mathscr{U}=\left(\frac{1}{\Delta t} \mathrm{M}\right)^{-1} 
\label{17.83}\end{equation}


!!!!
\mathscr{L}=\left(\frac{1}{\Delta t} \mathrm{M}\right)^{-1} \quad \text { and } \quad \mathscr{U}=\mathrm{C}^{-1}
\label{17.84}\end{equation}

前者\ref{17.83} 被命名为Chorin-Temam代数近似法，因为步骤$\hat{L}$和$\hat{U}$可以被视为之前描述的Chorin-Temam分数步骤法的代数对应方法（见第17.7.3节）。

第二种选择，\ref{17.84} ，被称为Yosida近似，因为它可以被解释为Schur补数的Yosida正则化（[Ven98]）。与基于微分步骤方法的策略相比，这种策略的潜在优势在于它不需要对边界条件有任何特别的关注。后者隐含在代数公式\ref{17.70} 中，在$\widehat{\mathrm{L}}$和$\widehat{\mathrm{U}}$步骤过程中不需要进一步要求。

基于对因子的不同选择$\mathscr{L}$和$\mathscr{U}$，对不精确因子化技术\ref{17.82} 的几种概括是可能的。如果用高阶$(\geq 2)$时间方案对时间相关的Navier-Stokes方程进行时间离散，则要选择不精确因子，以便保持时间离散顺序。见[GSV06, SV05, Ger08]。

在图17.11中，我们显示了在域$\Omega=(0,1)^{2}$上使用谱元法（SEM）对时间相关的Navier-Stokes方程进行近似的误差行为，谱元的边长为$4 \times 4$的方形元素，速度分量为$N=8$度的多项式，压力为$N=6$。精确解是 $\mathbf{u}(x, y, t)=(\sin (x) \sin (y+t), \cos (x) \cos (y+t))^{T}, p(x, y, t)=$ $\cos (x) \sin (y+t)$ 。时间离散化是基于$2(\mathrm{BDF} 2), 3$ (BDF3)和4(BDF4)阶的隐式后向微分公式(见[QSS07] )，然后分别基于2、3和4阶的非精确(Yosida)代数因子。用$\left(\mathbf{u}_{N}^{n}, p_{N}^{n}\right)$表示时间层次$t^{n}$的数值解，速度和压力的误差为
 ![](https://cdn.mathpix.com/cropped/991f5db518e324d299c1ff4972bba9fb-111.jpg?height=236&width=696&top_left_y=958&top_left_x=104)

图17.11.左边是速度误差$E_{\mathbf{u}}$；右边是压力误差$E_{p}$，定义为

!!!!
E_{\mathbf{u}}=\left(\Delta t \sum_{n=0}^{N_{T}}\left\|\mathbf{u}\left(t^{n}\right)-\mathbf{u}_{N}^{n}\right\|_{H^{1}(\Omega)}^{2}\right)^{1 / 2} \text { and } E_{p}=\left(\Delta t \sum_{n=0}^{N_{T}}\left\|p\left(t^{n}\right)-p_{N}^{n}\right\|_{L^{2}(\Omega)}^{2}\right)^{1 / 2}
$$

速度的误差相对于$\Delta t$是无限小的，分别为2、3和4阶，而压力的误差分别为$3 / 2,5 / 2$和$7 / 2$阶。

\subsection{Free surface flow problems}

自由表面流可以在各种情况和不同形状下表现出来。每当两种不相溶的流体接触时，就会产生一个自由表面。它们可以产生喷流[LR98]、气泡[HB76, TF88]、液滴[Max76]和薄膜。这类流体在各种不同的应用中都会遇到，如河流、湖泊和海洋中的波浪[Bla02, Qu02]，波浪与固体介质（船只、海岸等）的相互作用[Wya00, KMI $\left.^{+} 83\right]$，聚合物和液体金属的注射、成型和挤压[Cab03]，化学反应器或生物反应器，等等。根据所涉及的空间和时间尺度，像热传导、表面张力、层流到湍流过渡、可压缩性和化学反应、与固体的相互作用等过程可能对流动行为产生相关影响。在下文中，我们将重点讨论受表面张力影响的粘性牛顿流体的层流；在这些情况下，流动可由不可压缩的纳维-斯托克斯方程描述。

在为这种流体建模时，可以采用两种不同的方法。

- 前面跟踪法。这些方法认为自由表面是一个移动域的边界，在这个边界上指定了合适的边界条件。在域的内部，使用传统的流体模型；但应特别注意域不是固定的。在域的另一侧，流体，例如空气，通常被忽略，或者以简化的方式建模，而不明确求解它（例如，见[MP97]）。

- 锋面捕捉法。两种流体实际上被视为具有固定边界的领域中的单一流体，其属性如密度和粘度作为片状常数函数变化。不连续线实际上是自由表面（见，例如，[HW65, HN81]）。

关于自由边界问题的数值方法的回顾，请参见 [Hou95] 。

在下文中，我们将考虑前沿捕捉方法。更确切地说，我们将为密度和粘度可变的一般流体的情况推导出一个数学模型，因此它将适合于模拟被自由表面分开的两种流体的流动。

\subsubsection{Navier-Stokes equations with variable density and viscosity}

我们考虑粘性不可压缩流的一般情况，其密度$\rho$和动态粘性$\mu$在空间和时间上都有变化。在一个给定的空间域内
 ![](https://cdn.mathpix.com/cropped/991f5db518e324d299c1ff4972bba9fb-113.jpg?height=288&width=612&top_left_y=114&top_left_x=149)

图17.12.两种典型的二维网格，用于前沿追踪法（左）和前沿捕捉法（右）。粗线代表自由表面

$\Omega \subset \mathbb{R}^{d}$，流体的速度$\mathbf{u}=\mathbf{u}(\mathbf{x}, t)$和压力$p=p(\mathbf{x}, t)$的演变由以下方程模拟。

!!!!
\begin{cases}\rho \partial_{t} \mathbf{u}+\rho(\mathbf{u} \cdot \nabla) \mathbf{u}-\operatorname{div}(2 \mu \mathbf{D}(\mathbf{u}))+\nabla p=\mathbf{f}, & \mathbf{x} \in \Omega, t>0 \\ \operatorname{div} \mathbf{u}=0, & \mathbf{x} \in \Omega, t>0\end{cases}
$$

其中$(\mathbf{D}(\mathbf{v}))=\frac{\nabla \mathbf{v}+\nabla \mathbf{v}^{T}}{2}$是$\mathbf{v}$的对称梯度，这个张量也被称为变形率，而f表示一个体积力，例如重力。(这里$\partial_{t}$代表$\partial / \partial t$ 。张量的发散在\ref{16.23}中已经介绍过了)。

这些方程必须由合适的初始和边界条件来补充。在$\rho$为常数的情况下，我们检索到\ref{17.1} 的形式。请注意，不可压缩性与可变密度并不矛盾。不可压缩性意味着一个单一的流体包裹不改变体积，从而不改变密度，而可变密度意味着不同的流体包裹可能有不同的密度。左手边\ref{17.85} 的最后两项可以改写为$-\operatorname{div} \mathbf{T}(\mathbf{u}, p)$ ，其中

!!!!
\mathbf{T}(\mathbf{u}, p)=2 \mu \mathbf{D}(\mathbf{u})-\mathbf{I} p
$$

是应力张量，而$\mathbf{I}$是$d \times d$特性张量。这个模型的完整推导可以在[LL59]中找到，比如说。

密度函数$\rho$的方程式可以从质量平衡方程中得到

!!!!
\begin{array}{lr}
\mathrm{D}_{t} \rho=\partial_{t} \rho+\mathbf{u} \cdot \nabla \rho=0, & \mathbf{x} \in \Omega, t>0 \\
\left.\rho\right|_{t=0}=\rho_{0}, & \mathbf{x} \in \Omega
\end{array}
\label{17.87}\end{equation}

其中$\mathrm{D}_{t}$表示材料或拉格朗日导数，见第17.7.2节。在那些粘度$\mu$可以用密度表示的情况下，即$\mu=\mu(\rho)$，这个关系，连同\ref{17.87} ，提供了$\rho$和$\mu$的演变模型。第17.9.3节描述了适用于两种流体流动的特殊情况的模型。耦合问题\ref{17.85} -\ref{17.86} -\ref{17.87} 的分析是一项具有挑战性的任务。我们请读者参考 [Lio96] 。如果 $\mathbf{f}=\rho \mathbf{g}$ 和 $\sigma=0$ 可以证明一个全局存在的结果。这个证明要求$\Omega$是$\mathbb{R}^{d}$的一个光滑的、有边界的、连接的开放子集，并且在整个边界上施加同质的迪里切特边界条件（即与$\left.\mathbf{g}_{D}=\mathbf{0}\right)$）。如果初始和源数据满足

!!!!
\begin{aligned}
&\rho_{0} \geq 0 \text { a.e. in } \Omega, \quad \rho_{0} \in L^{\infty}(\Omega), \quad \rho_{0} \mathbf{u}_{0} \in L^{2}(\Omega)^{d}, \quad \rho_{0}\left|\mathbf{u}_{0}\right|^{2} \in L^{1}(\Omega), \\
&\text { and } \quad \mathbf{g} \in L^{2}(\Omega \times(0, T))^{d}
\end{aligned}
$$

则存在满足以下条件的全局弱解

!!!!
\begin{aligned}
&\rho \in L^{\infty}(\Omega \times(0, T)), \quad \rho \in C\left([0, \infty) ; L^{p}(\Omega)\right) \quad \forall p \in[1, \infty) \\
&\mathbf{u} \in\left[L^{2}\left(0, T ; H_{0}^{1}(\Omega)\right)\right]^{d}, \quad \nabla \mathbf{u} \in\left[L^{2}(\Omega \times(0, T))\right]^{d \times d} \\
&\rho|\mathbf{u}|^{2} \in L^{\infty}\left(0, T ; L^{1}(\Omega)\right)
\end{aligned}
$$

田中[Tan93]的另一个结果是处理表面张力系数$\sigma$与零不同但为常数的情况。在初始数据的一些（更强的）规律性假设下，已经证明对于足够小的初始数据和外力，存在一个全局解。此外，局部唯一性（在时间上）也被证明。

\subsubsection{Boundary conditions}

让我们把本章开头关于边界条件的讨论概括到纳维尔-斯托克斯方程的更一般的表述\ref{17.85} 、\ref{17.86} 的情况。我们仍然考虑将域$\partial \Omega$的边界分割成有限数量的部分，并对它们施加适当的边界条件。有几种条件是可以接受的：一般的讨论见，例如，[QV94]和其中的参考文献。在下文中，我们只描述最常用的自由表面流的条件。

Dirichlet边界条件规定了边界子集上的速度矢量值$\Gamma_{D}$ 。

!!!!
\mathbf{u}=\varphi \quad \text { on } \quad \Gamma_{D} \subset \partial \Omega
\label{17.88}\end{equation}

它们既可用于在流入的边界上施加速度曲线，也可用于模拟以规定速度移动的固体边界。在后一种情况下，它们被称为无滑移边界条件，因为它们迫使流体不滑移而粘在墙上。

正如我们已经注意到的，当在整个边界$\partial \Omega$上指定迪里希特边界条件时，压力不是唯一定义的。在这种情况下，如果$(\mathbf{u}, p)$是\ref{17.85} 、\ref{17.86} 和\ref{17.88} 的解，那么$(\mathbf{u}, p+c), c \in \mathbb{R}$也是同一方程组的解。利用高斯定理，从方程\ref{17.86} 可以看出，$\mathbf{g}_{D}$必须满足兼容性条件

!!!!
\int_{\partial \Omega} \mathbf{g}_{D} \cdot \mathbf{n} \mathrm{d} \gamma=0
$$

诺伊曼边界条件规定了一个单位面积的力$\psi_{N}$作为应力张量的法向分量

!!!!
\mathbf{T}(\mathbf{u}, p) \mathbf{n}=2 \mu \mathbf{D}(\mathbf{u}) \mathbf{n}-p \mathbf{n}=\psi \quad \text { on } \Gamma_{N} \subset \partial \Omega
\label{17.89}\end{equation}

其中$\mathbf{n}$是$\Gamma_{N}$上的外单位法线。当$\psi_{N}=\mathbf{0}$的子集$\Gamma_{N}$被称为自由流出物。对于速度梯度的消失，力$\psi_{N}$对应于边界上的压力。关于这种类型的边界条件的解释和含义，也请参见[HRT96]的更多细节。诺伊曼边界条件被用来模拟边界上每单位面积$\mathbf{g}_{N}$的给定力。

混合边界条件规定了速度场的法向分量以及法向应力的切向分量的值，即：。

!!!!
\begin{array}{ll}
\mathbf{u} \cdot \mathbf{n}=\varphi \cdot \mathbf{n} & \text { on } \Gamma_{D}, \\
(\mathbf{T}(\mathbf{u}, p) \mathbf{n}) \cdot \tau=(2 \mu \mathbf{D}(\mathbf{u}) \mathbf{n}) \cdot \tau=0 & \text { on } \Gamma_{N}, \quad \forall \tau: \tau \cdot \mathbf{n}=0 .
\end{array}
$$

选择$\varphi=\mathbf{0}$是为了模拟解决方案沿$\Gamma_{D}$的对称性，但也是在$\Gamma_{D}$上的自由滑动，没有渗透。在这种情况下，我们谈论的是自由滑移的边界条件。

在某些情况下，需要从滑移到无滑移边界条件的平滑过渡。这可以通过在法线方向施加迪里希特边界条件来实现，与自由滑移边界条件相类似，并通过罗宾边界条件（迪里希特和诺伊曼边界条件的线性组合）取代切线方向上的边界条件。

!!!!
\begin{array}{ll}
\mathbf{u} \cdot \mathbf{n}=\varphi \cdot \mathbf{n} & \text { on } \Gamma_{D} \\
\left(\omega C_{\tau} \mathbf{u}+(1-\omega)(\mathbf{T}(\mathbf{u}, p) \mathbf{n})\right) \cdot \tau= \\
\left(\omega C_{\tau} \mathbf{u}+(1-\omega)(2 \mu \mathbf{D}(\mathbf{u}) \mathbf{n})\right) \cdot \tau=\omega C_{\tau} \mathbf{g}_{D} \cdot \tau & \text { on } \Gamma_{N}, \quad \forall \tau: \tau \cdot \mathbf{n}=0
\end{array}
$$

参数$\omega \in[0,1]$决定了该制度。对于$\omega=0$我们有自由滑动的边界条件，而对于$\omega=1$我们有无滑动的边界条件。在实践中，$\omega$可以是空间和时间的平滑函数，其值在$[0,1]$中，因此允许在两种情况之间平滑过渡。这对$\varphi=\mathbf{0}$来说是成立的，但过渡边界条件也涵盖了$\varphi \neq 0$和$\omega=1$的一般Dirichlet情况。权重$C_{\tau}$可以被看作是速度和单位面积上的力之间的转换系数。这种类型的边界条件已在 [Joe05] 中详细研究过。

\subsubsection{Application to free surface flows}

自由表面流可以用\ref{17.85} -\ref{17.86} 来建模。在这个角度，自由表面是一个界面，用$\Gamma(t)$表示，将域$\Omega$切割成两个开放的子域$\Omega^{+}(t)$和$\Omega^{-}(t)$ 。界面的初始位置是已知的，$\Gamma(0)=\Gamma_{0}$ ，界面以流体速度$\mathbf{u}$ 移动。在每个子域上，我们有恒定的密度和粘性，用 $\rho^{+}, \rho^{-}, \mu^{+}$ 和 $\mu^{-}$ 表示。我们要求 $\rho^{\pm}>0$ 和 $\mu^{\pm}>0$ 。

然后，密度和粘度的全局定义如下。

!!!!
\rho(\mathbf{x}, t)=\left\{\begin{array}{ll}
\rho^{-} & \mathbf{x} \in \Omega^{-}(t) \\
\rho^{+} & \mathbf{x} \in \Omega^{+}(t)
\end{array} \quad \mu(\mathbf{x}, t)= \begin{cases}\mu^{-} & \mathbf{x} \in \Omega^{-}(t) \\
\mu^{+} & \mathbf{x} \in \Omega^{+}(t)\end{cases}\right.
$$

为了模拟浮力效应，重力$\mathbf{f}=\rho \mathbf{g}$，其中$\mathbf{g}$是重力加速度的矢量，必须插入到右手边。

由于粘度在界面上是不连续的，方程\ref{17.85} 只能在两个子域的内部强烈成立。因此，后者必须与合适的界面条件相耦合（例如，见[Smo01]）。

我们用$\mathbf{n}_{\Gamma}$表示从$\Omega^{-}$指向$\Omega^{+}$的界面单位法线，用$\kappa$表示界面曲率，定义为

!!!!
\kappa=\sum_{i=1}^{d-1} \frac{1}{R_{\tau_{i}}}
\label{17.90}\end{equation}

其中$R_{\tau_{i}}$是沿主矢量$\tau_{i}$的曲率半径，这些主矢量跨越了界面$\Gamma$的切线空间。$R_{\tau_{i}}$的符号是使$R_{\tau_{i}} \mathbf{n}_{\Gamma}$从$\Gamma$指向本地近似$\Gamma$的圆心。

一个数量$v$在界面上的跳跃用$[v]_{\Gamma}$来表示，定义为

!!!!
\begin{aligned}
[v]_{\Gamma}(\mathbf{x}, t) &=\lim _{\varepsilon \rightarrow 0^{+}}\left(v\left(\mathbf{x}+\varepsilon \mathbf{n}_{\Gamma}, t\right)-v\left(\mathbf{x}-\varepsilon \mathbf{n}_{\Gamma}, t\right)\right) \\
&=\left.v\right|_{\Omega^{+}(t)}(\mathbf{x}, t)-\left.v\right|_{\Omega^{-}(t)}(\mathbf{x}, t) \quad \forall \mathbf{x} \in \Gamma(t)
\end{aligned}
$$

然后将接口条件改为。

!!!!
{[\mathbf{u}]_{\Gamma}=\mathbf{0}} 
\label{17.91}\end{equation}

!!!!
{\left[\mathbf{T}(\mathbf{u}, p) \mathbf{n}_{\Gamma}\right]_{\Gamma}=\left[2 \mu \mathbf{D}(\mathbf{u}) \mathbf{n}_{\Gamma}-p \mathbf{n}_{\Gamma}\right]_{\Gamma}=\sigma \kappa \mathbf{n}_{\Gamma} .}
\label{17.92}\end{equation}

公式\ref{17.91} 被称为运动学界面条件。它表达了速度的所有分量都是连续的属性。事实上，法向分量必须是连续的，因为没有流过界面，而切向分量必须是连续的，因为假设两种流体都是粘性的$\left(\mu^{+}>0\right.$ 和 $\left.\mu^{-}>0\right)$ 。

公式\ref{17.92} 被称为动态界面条件。它表达了这样一个特性，即法向应力以表面张力给定的相同数量跳动。这个力与界面曲率成正比，并指向界面法线的同一方向。表面张力系数$\sigma$取决于流体配对，一般来说也取决于温度。我们将假设它是常数，因为所有的热传导效应都被忽略了。

请注意，界面的演变必须与质量守恒方程\ref{17.87} 兼容。在数学上，这个方程必须在弱的意义上理解，即在分布的意义上，因为密度在界面上是不连续的，因此，其导数只能被弱的解释。

由于这种形式的质量守恒方程往往不便于进行数值模拟，因此已经引入了其他描述界面演变的等效模型$\Gamma(t)$。在第17.10节中有一个简短的概述。

\subsection{Interface evolution modelling}

我们在这里简要介绍一下在固定领域中对界面$\Gamma(t)$的演变进行建模的不同方法 $\Omega$ 。

\subsubsection{Explicit interface descriptions}

一个界面可以通过界面上的一组标记点或线段（在$2 \mathrm{D}$中，在$3 \mathrm{D}$中为表面线段）来明确表示，这些标记点或线段由流体速度传送。

在[HW65]中介绍的标记点的情况下，各点之间的连接性是不知道的，必须在需要时进行重建。为了简化这一任务，通常在界面附近放置额外的标记点，标记 $\Omega^{+}$ 或 $\Omega^{-}$ 。标记的平移很简单，连接性也很容易改变。然而，从标记的分布来重建界面还是有些麻烦的。通常情况下，还需要重新分配标记，引入新的标记或丢弃现有的标记。

几个标记可以连接起来定义一条线或一个面，可以是直线（平面），也可以是曲线，例如通过NURBS。一组这样的几何对象现在可以定义表面。它的演变是由构成对象的演变来模拟的，因此也是由定义它们的标记来模拟的。因此，界面的连接性得到了保留。这解决了纯粹的标记方法的困难，同时也带来了一个新的缺点：界面的拓扑变化是由基本的物理学允许的，但不是由这种描述允许的。必须采用复杂的程序来检测和正确处理界面断裂。

\subsubsection{Implicit interface descriptions}

在前面的捕捉方法中，接口是由标量函数$\phi: \Omega \times(0, T) \rightarrow \mathbb{R}$的值隐含地表示的，它告诉人们任何点$\mathbf{x}$属于哪个子集。  $\Omega^{+}(t)$或$\Omega^{-}(t)$ 。然后为$\phi$求解的传输方程描述了界面的演变。通过这一特点，所有隐式界面模型都有一个共同的优点，即在模型中界面的拓扑变化是可能的，而且这些变化无需特别干预。

\section{Volume-of-fluid methods}

流体体积法（VOF）最初是由Hirt和Nichols [HN81] 提出的。设$\phi$是一个片状常数函数，使得

!!!!
\phi(\mathbf{x}, t)= \begin{cases}1, & \mathbf{x} \in \Omega^{+}(t) \\ 0, & \mathbf{x} \in \Omega^{-}(t)\end{cases}
$$

因此，界面$\Gamma(t)$位于函数$\phi$的不连续处，而密度和粘度则简单定义为

!!!!
\rho=\rho^{-}+\left(\rho^{+}-\rho^{-}\right) \phi, \quad \mu=\mu^{-}+\left(\mu^{+}-\mu^{-}\right) \phi
\label{17.93}\end{equation}

传输方程通常用以单元为中心的有限体积方法进行离散，在每个网格单元中用一个常数值来逼近$\phi$（见第$9.1$和17.12节）。由于离散误差和扩散传输方案，$\phi$的近似值将在0和1之间，根据方程\ref{17.93} 可以（并且通常是）解释为流体占据$\Omega^{+}$的体积分数。这就解释了流体的体积这一名称。0和1之间的体积分数实际上代表两种流体的混合物。由于流体被假定为不相溶，这种行为是不可取的，特别是因为混合效应可能不会集中在界面附近，而是扩散到整个领域 $\Omega$ 。当这种情况发生时，所谓的尖锐界面会变得越来越扩散。有几种技术可以限制这个问题。我们已经开发了详细的程序来重建扩散界面的法线和曲率。

流体体积法的优点是，应用传输方程的保守离散化确保流体的质量守恒，因为$\phi$和$\rho$之间的关系\ref{17.93} 是线性的。

\section{Level-set methods}

为了规避流体体积法的问题，Dervieux和Thomasset[DT80]在1980年提出将界面定义为连续伪密度函数的零级集，并将这种方法应用于流动问题。他们的方法随后在[OS88]和随后的出版物中得到了更系统的研究，水平集方法这一术语就是在这里产生的。1992年，Mulder、Osher和Sethian首次将其应用于流动问题 [MOS92] 。与流体体积法相比，这些方法允许保持界面的清晰度，因为$\phi$被定义为一个连续的函数，这样。

!!!!
\begin{array}{ll}
\phi(\mathbf{x}, t)>0, & \mathbf{x} \in \Omega^{+}(t) \\
\phi(\mathbf{x}, t)<0, & \mathbf{x} \in \Omega^{-}(t) \\
\phi(\mathbf{x}, t)=0, & \mathbf{x} \in \Gamma(t)
\end{array}
$$

函数$\phi$被称为水平集函数，因为接口$\Gamma(t)$是其零水平集，它的等值线或等值面与零相关。

!!!!
\Gamma(t)=\{\mathbf{x} \in \Omega: \phi(\mathbf{x}, t)=0\}
\label{17.94}\end{equation}

现在，密度和粘度可以用$\phi$的函数表示为

!!!!
\rho=\rho^{-}+\left(\rho^{+}-\rho^{-}\right) H(\phi), \quad \mu=\mu^{-}+\left(\mu^{+}-\mu^{-}\right) H(\phi)
\label{17.95}\end{equation}

其中$H(\cdot)$是海维塞德函数

!!!!
H(\xi)= \begin{cases}0, & \xi<0 \\ 1, & \xi>0\end{cases}
$$

从结构上看，界面在水平集模型中保持尖锐，不相溶的液体不会开始混合。此外，界面的法线和曲率的确定也更加直接和自然。反过来，由于关系\ref{17.95} 不是线性的，对$\phi$的传输方程应用保守离散化并不能保证离散化后流体的质量守恒。然而，这并不是一个大问题，因为质量误差仍然随着网格的细化而消失，并且被水平集公式的优势所抵消。

自由表面的演变是由水平集函数的平流方程描述的

!!!!
\begin{cases}\partial_{t} \phi+\mathbf{u} \cdot \nabla \phi=0 & \text { in } \Omega \times(0, T) \\ \phi=\phi_{0} & \text { in } \Omega \text { at } t=0 \\ \phi=\phi_{i n} & \text { on } \partial \Sigma_{i n} \times(0, T)\end{cases}
\label{17.96}\end{equation}

其中$\Sigma_{i n}$是流入的边界

!!!!
\Sigma_{i n}=\{(\mathbf{x}, t) \in \partial \Omega \times(0, T): \mathbf{u}(\mathbf{x}, t) \cdot \mathbf{n}<0\}
$$

因此，流动方程\ref{17.85} -\ref{17.86} 和水平集方程\ref{17.96} 是耦合的。方程\ref{17.96} 可以推导如下 [MOS92] ：让 $\overline{\mathbf{x}}(t)$ 是界面上一个点的路径 $\Gamma(t)$ 。这个点随着流体移动，因此 $\mathrm{D}_{t} \overline{\mathbf{x}}(t)=\mathbf{u}(\overline{\mathbf{x}}(t), t)$ 。由于函数$\phi$在移动界面上总是为零，我们必须有

!!!!
\phi(\overline{\mathbf{x}}(t), t)=0
$$

相对于时间的推导，并应用连锁规则，我们得到

!!!!
\partial_{t} \phi+\nabla \phi \cdot \mathbf{u}=0 \quad \text { on } \Gamma(t) \quad \forall t \in(0, T) .
\label{17.97}\end{equation}

如果我们考虑的是$\Omega^{\pm}$中的一个点的路径，我们可能需要$\phi(\overline{\mathbf{x}}(t), t)=\pm c, c>0$，以确保$\phi(\overline{\mathbf{x}}, t)$的符号不会改变，并且$\overline{\mathbf{x}}(t) \in \Omega^{\pm}(t)$对所有$t$都是如此。

这样一来，方程\ref{17.97} 就可以推广到整个域$\Omega$，从而得到方程\ref{17.96} 。

我们现在可以验证质量守恒得到了满足：使用\ref{17.95} ，我们得到的形式是

!!!!
\begin{aligned}
\partial_{t} \rho+\mathbf{u} \cdot \nabla \rho &=\left(\rho^{+}-\rho^{-}\right)\left(\partial_{t} H(\phi)+\mathbf{u} \cdot \nabla H(\phi)\right) \\
&=\left(\rho^{+}-\rho^{-}\right) \delta(\phi)\left(\partial_{t} \phi+\mathbf{u} \cdot \nabla \phi\right)
\end{aligned}
\label{17.98}\end{equation}

其中$\delta(\cdot)$表示狄拉克三角函数。根据方程\ref{17.96} ，\ref{17.98} 中的第三个因子为零。因此，方程\ref{17.87} 成立，质量守恒被水平集界面进化模型所满足。

\section{Interface-related quantities}

在两个流体流动的背景下，界面的法线和曲率是特别值得关注的。也就是说，表面张力与曲率成正比，并在法线方向发挥作用。

我们现在将解释这些量子如何取决于$\phi$，而不去讨论所涉及的微分几何的细节。例如，见[Spi99]的详细和严格的推导。单位法线$\mathbf{n}_{\Gamma}$与所有切线方向$\tau$正交，而这些切线方向的特点是$\phi$在任何切线方向的方向导数必须消失。

!!!!
0=\partial_{\tau} \phi=\nabla \phi \cdot \tau \quad \text { on } \Gamma
$$

因此，$\phi$的梯度与所有的切线方向都是正交的，我们可以通过归一化来定义界面单位法线

!!!!
\mathbf{n}_{\Gamma}=\frac{\nabla \phi}{|\nabla \phi|}
\label{17.99}\end{equation}

注意，根据这个定义，$\mathbf{n}_{\Gamma}$从$\Omega^{-}$指向$\Omega^{+}$。此外，由于$\phi$不仅是在界面上定义的，而且是在整个域中定义的，所以法线的表达式也自然地概括到整个域。

为了推导出曲率的表达式，我们需要考虑主要的切线方向$\tau_{i}, i=1 \ldots d-1$ 。这些是界面被圆（圆柱体）近似的方向，即$\mathbf{n}_{\Gamma}$在$\tau_{i}$的方向上的方向导数与$\tau_{i}$平行。

!!!!
\partial_{\tau_{i}} \mathbf{n}_{\Gamma}=\nabla \mathbf{n}_{\Gamma} \tau_{i}=-\kappa_{i} \tau_{i}, \quad \kappa_{i} \in \mathbb{R}, \quad i=1 \ldots d-1
\label{17.100}\end{equation}

$\left|\kappa_{i}\right|$越大，表面在这个方向的弯曲度越大，系数$\kappa_{i}$实际上被称为主曲率。从简单的计算中可以看出，$\kappa_{i}=\left(R_{\tau_{i}}\right)^{-1}$ ，其中的数值$R_{\tau_{i}}$是方程\ref{17.90} 中的近似圆（圆柱）的半径。

我们可以从方程\ref{17.100）中看到，$d-1$值$-\kappa_{i}$是$d \times d$-张量$\nabla \mathbf{n}_{\Gamma}$的特征值。根据\ref{17.99} ，$\mathbf{n}_{\Gamma}$（本质上）是一个梯度场，在界面附近是平滑的。因此，等级二张量$\nabla \mathbf{n}_{\Gamma}$（本质上）是一个平滑函数的二次导数的张量，因此是对称的。所以它还有一个实数特征值，其相关的特征向量必须是$\mathbf{n}_{\Gamma}$，因为对称张量的特征向量是正交的。很容易看出，各自的特征值为零

!!!!
\left(\nabla \mathbf{n}_{\Gamma} \mathbf{n}_{\Gamma}\right)_{i}=\sum_{j=1}^{d}\left(\partial_{x_{i}} n_{j}\right) n_{j}=\sum_{j=1}^{d} \frac{1}{2} \partial_{x_{i}}\left(n_{j}^{2}\right)=\frac{1}{2} \partial_{x_{i}}\left|\mathbf{n}_{\Gamma}\right|^{2}=0
$$

根据结构\ref{17.99} ，作为$\left|\mathbf{n}_{\Gamma}\right|=1$。

从方程\ref{17.90} 开始，我们得到曲率

!!!!
\kappa=\sum_{i=1}^{d-1} \frac{1}{R_{\tau_{i}}}=\sum_{i=1}^{d-1} \kappa_{i}=-\operatorname{tr}\left(\nabla \mathbf{n}_{\Gamma}\right)=-\nabla \cdot \mathbf{n}_{\Gamma}
$$

并使用方程\ref{17.99} ，我们得到

!!!!
\kappa=-\nabla \cdot\left(\frac{\nabla \phi}{|\nabla \phi|}\right)
\label{17.101}\end{equation}



\section{Initial Condition}

虽然我们知道界面在$t=0$的位置$\Gamma_{0}$，但相关的水平集函数$\phi_{0}$并不是唯一定义的。选择的自由可以用来进一步简化后续任务。我们注意到$\phi$的陡峭梯度使得方程\ref{17.96} 的数值解更加困难（例如见[QV94]），而当从$\phi$确定$\Gamma$时，平坦的梯度会降低数值稳定性。因此，一个很好的折衷办法是进一步约束 $|\nabla \phi|=1$ 。

满足这一约束条件的函数是距离函数

!!!!
\operatorname{dist}(\mathbf{x} ; \Gamma)=\min _{\mathbf{y} \in \Gamma}|\mathbf{x}-\mathbf{y}|
$$

其中在每一点$\mathbf{x}$取从$\mathbf{x}$到$\Gamma$的最小欧氏距离值。用这个函数在$-1$上乘以$\Omega^{-}$，我们得到带符号的距离函数

!!!!
\operatorname{sdist}(\mathbf{x} ; \Gamma)= \begin{cases}\operatorname{dist}(\mathbf{x} ; \Gamma), & \mathbf{x} \in \Omega^{+} \\ 0, & \mathbf{x} \in \Gamma \\ -\operatorname{dist}(\mathbf{x} ; \Gamma), & \mathbf{x} \in \Omega^{-}\end{cases}
$$

因此，选择$\phi_{0}$，代表初始界面$\Gamma_{0}$，作为$\phi_{0}(\mathbf{x})=\operatorname{sdist}\left(\mathbf{x} ; \Gamma_{0}\right)$，是通常和合理的做法。

由于$|\nabla \phi|=1$，界面法线和曲率的表达进一步简化为

!!!!
\mathbf{n}_{\Gamma}=\nabla \phi \quad \text { and } \quad \kappa=-\nabla \cdot \nabla \phi=-\Delta \phi
$$

\section{Reinitialization}

不幸的是，$|\nabla \phi|=1$的属性在$\phi$与流体速度$\mathbf{u}$的平流作用下没有被保留下来。只要$|\nabla \phi|$不离1太远，这就不是一个问题，但这在一般情况下不能保证。可以采取两种不同的策略来处理这个问题。

一种方法是确定一个平流速度场，使界面运动与流体速度场相同，同时保留距离特性。实际上，这样的速度场是存在的，被称为扩展速度，因为它是通过将界面上规定的速度扩展到整个域来构造的；有效的算法在[AS99]中描述。

另外，我们仍然可以使用流体速度$\mathbf{u}$来对水平集函数$\phi$进行漂移，并在$|\nabla \phi|$变得过大或过小时进行干预。在这种情况下采取的行动被称为重新初始化，因为其程序与初始条件下的初始化部分相同。假设我们决定在时间$t=t_{r}$进行重新初始化。

1.给出$\phi\left(\cdot, t_{r}\right)$，求$\Gamma\left(t_{r}\right)=\left\{\mathbf{x}: \phi\left(\mathbf{x}, t_{r}\right)=0\right\}$。

2.用$\phi\left(\cdot, t_{r}\right)$替换$\operatorname{sdist}\left(\cdot, \Gamma\left(t_{r}\right)\right)$ 。

有趣的是，事实证明，寻找延伸速度的问题与用有符号距离函数重新初始化$\phi$的问题密切相关。同样的算法可以被使用，同样的计算成本也是可以预期的。但有两个概念上的差异有利于重初始化方法：首先，扩展速度必须在每个时间步长进行计算，而重初始化可以只在必要时进行，这导致计算成本的全面降低。其次，近似的扩展速度只能近似地保持距离特性，而且可能不能保证重新初始化是不必要的。

关于有效构建有符号距离函数的近似值的算法细节，特别是对于三维情况，可以在 [Win07] 中找到。

\subsection{Finite volume approximation}

第9章中描述的有限体积方法被广泛用于解决微分方程描述的问题，在不同的工程领域都有应用。特别是，在流体动力学领域最常用的商业代码采用有限体积方案来解决Navier-Stokes方程。后者经常与湍流、过渡、燃烧、运输和化学物种反应的模型相耦合。

当应用于不可压缩的Navier-Stokes方程时，问题的鞍点性质使得控制量的选择至关重要。最自然的选择，即速度和压力节点的重合，会产生虚假的压力模式。其原因与以前注意到的Galerkin有限元近似相似：如果我们希望问题得到很好的解决，隐含在控制体选择基础上的离散空间必须满足一个兼容性条件。

由于这个原因，对速度和压力采用不同的控制量，也就是节点，是很常见的。图17.13是一个例子，显示了速度分量和压力（在交错网格上）节点的可能选择，以及相应的控制体。与速度对应的控制体用于动量方程的离散化，而压力控制体用于连续性方程。我们回顾一下，后者不包含时间导数项。

另外，我们可以采用类似于第17.5节中的稳定技术，允许将速度和压力节点放在同一个网格上。有兴趣的读者可以参考专著[FP02]、[Kro97]、[Pat80]和[VM96]以了解更多细节。

![](https://cdn.mathpix.com/cropped/991f5db518e324d299c1ff4972bba9fb-122.jpg?height=163&width=202&top_left_y=988&top_left_x=474)

图17.13.速度和压力的交错的有限体积网格。左边是连续性方程的控制体积，右边是用于动量方程的控制体积。
 ![](https://cdn.mathpix.com/cropped/991f5db518e324d299c1ff4972bba9fb-123.jpg?height=222&width=622&top_left_y=112&top_left_x=146)

图17.14.在$t=100$（左）和$t=102$（右），$\operatorname{Re}=200$的时间瞬间，围绕5个圆柱体的不可压缩的流动的涡度场

在图17.14中，我们显示了5个圆柱体周围的不可压缩流在两个时间瞬间的涡度场（这与例17.1中描述的问题相同，见图17.10），雷诺数为$200$ 。在这种情况下，Navier-Stokes方程是通过以单元为中心的有限体积离散化来解决的。这里使用的计算网格有103932个元素，时间步长$\Delta t=0.001$ 。

让我们再报告一下美洲杯帆船在逆风状态下的水动力流动模拟，目的是研究其附属装置（灯泡、龙骨和小翼）的效率（见图17.15，左）。本例中使用的计算网格是混合网格，包括三角形和四角形的表面元素，以及四面体、六面体、棱柱形和金字塔形的体积元素（见图17.15，右）。

该数学模型是在第1节中说明的。  $17.9$中对自由表面流体的说明。然而，纳维-斯托克斯方程与$k-\varepsilon$湍流模型[MP94]相耦合，通过RANS（雷诺平均纳维-斯托克斯）的方法。问题的未知数是控制体积中心的变量值（速度、压力和湍流量），在这种情况下对应于网格的体积元素。

![](https://cdn.mathpix.com/cropped/991f5db518e324d299c1ff4972bba9fb-123.jpg?height=267&width=353&top_left_y=909&top_left_x=97)
 ![](https://cdn.mathpix.com/cropped/991f5db518e324d299c1ff4972bba9fb-123.jpg?height=268&width=720&top_left_y=908&top_left_x=97) bulb-keel intersection (right) The time-dependent Navier-Stokes equations are advanced in time using a fractional-step scheme, as described in Sect. 17.7.3. As previously pointed out, the choice of placing velocity and pressure at the same points makes it necessary to adopt a suitable stabilization of the equations [RC83]. For the computation of the free surface, we have used both the volume-of-fluid method and the one based on the level-set technique, described in Sect. 17.10.2, the latter being more costly from a computational viewpoint but in general less dissipative.

这类模拟可能需要有非常多的元素的网格，在这种情况下，人们希望再现复杂的流体动力学现象，如复杂几何形状周围的湍流，或存在流动分离的区域。在这种情况下使用的网格由500万个单元组成，产生了一个超过3000万个未知数的代数系统。这种规模的问题通常是通过采用基于域分解方法的并行计算技术来解决的（见第19章），以便将计算分配给几个处理器。

压力分布和壁面剪应力的分析，以及通过流线的三维流动的可视化（见图17.16和17.17）在流体力学项目阶段确实非常有用，其目的是优化船的性能（见例如[PQ05, PQ07, DPQ08]）。
 ![](https://cdn.mathpix.com/cropped/991f5db518e324d299c1ff4972bba9fb-124.jpg?height=258&width=720&top_left_y=645&top_left_x=96)

图17.16.表面压力分布（左）和船体附属物周围的流线（右）。

\subsection{Exercises}

1.证明条件\ref{17.53} 等同于inf-sup条件\ref{17.20} 。

[解：注意，如果$\exists \mathbf{p}^{*} \neq \mathbf{0}$与$\mathbf{p}^{*} \in \mathbb{R}^{M}$，如$\mathrm{B}^{T} \mathbf{p}^{*}=\mathbf{0}$，或者等价地，如果$\exists p_{h}^{*} \in \mathbb{Q}_{h}$，如$b\left(\varphi_{n}, p_{h}^{*}\right)=0 \forall n=1, \ldots, N$，条件\ref{17.53} 被违反。这相当于$b\left(\mathbf{v}_{h}, p_{h}^{*}\right)=0 \forall \mathbf{v}_{h} \in V_{h}$ ，这又相当于违反了\ref{17.20} .] 2.证明满足\ref{17.53}的必要条件是：$2 N \geq M$ 。  $\left[\right.$ 解：我们有$N=\operatorname{rank}(\mathrm{B})+\operatorname{dim}(\operatorname{kerB})$ ，而$M=\operatorname{rank}\left(\mathrm{B}^{T}\right)+\operatorname{dim}\left(\operatorname{kerB}^{T}\right)=$ $\operatorname{rank}\left(\mathrm{B}^{T}\right)=\operatorname{rank}(\mathrm{B})$ 。因此，我们有 $N-M=\operatorname{dim}(\operatorname{kerB}) \geq 0$ ，因此条件 $N \geq M$ 是解的唯一条件。]

3.证明速度和压力的有限元对$\mathbb{P}_{1}-\mathbb{P}_{0}$不满足$i n f-s u p$的条件。

[解：我们把自己限制在一个二维迪里希特问题上，并考虑一个由$2 n^{2}$个三角形组成的简单均匀三角形，$n \geq 2$，就像图17.18中显示的那样，左图。这个三角形带有压力的$M=2 n^{2}-1$自由度（除了一个三角形外，每个三角形都有一个值，因为我们的压力必须有空平均），速度场的$N=2(n-1)^{2}$自由度（对应于每个内部顶点的两个分量的值）。因此，练习二中证明的必要条件$N \geq M$在当前情况下没有得到满足。]

4.证明在由矩形构成的网格上，每个矩形上的速度分量和恒压的双线性多项式的有限元对$\mathbb{Q}_{1}-\mathbb{Q}_{0}$不满足inf-sup条件。

[解：考虑一个正方形的计算域和一个由$n \times n$个正方形组成的统一直角坐标网格，如图$17.18$右$)$ 。有$(n-1)^{2}$个内部结点
 ![](https://cdn.mathpix.com/cropped/991f5db518e324d299c1ff4972bba9fb-125.jpg?height=258&width=720&top_left_y=603&top_left_x=96)

图 17.17.顺风航行时围绕风帆的流线（左）和围绕船体附属物的流线（右）。

![](https://cdn.mathpix.com/cropped/991f5db518e324d299c1ff4972bba9fb-125.jpg?height=231&width=237&top_left_y=945&top_left_x=167)
 ![](https://cdn.mathpix.com/cropped/991f5db518e324d299c1ff4972bba9fb-125.jpg?height=232&width=582&top_left_y=944&top_left_x=166) (right) finite elements with spurious pressure modes carrying $N=2(n-1)^{2}$ degrees of freedom for the velocity and $M=n^{2}-1$ for the pressure. The necessary condition is therefore satisfied provided $n \geq 3$. We therefore verify directly that the $\inf -\sup$ condition does not hold. Let $h$ be the uniform size of the element edges and denote by $q_{i \pm 1 / 2, j \pm 1 / 2}$ the value at the midpoint $\left(x_{i \pm 1 / 2}, y_{j \pm 1 / 2}\right)=\left(x_{i} \pm h / 2, y_{i} \pm h / 2\right)$ of a given function $q$. Let $K_{i j}$ be a square of the grid. A simple calculation shows that

!!!!
\begin{aligned}
&\int_{\Omega} q_{h} \operatorname{div} \mathbf{u}_{h} d \Omega=\frac{h}{2} \sum_{i, j=1}^{n-1} u_{i j}\left(q_{i-1 / 2, j-1 / 2}+q_{i-1 / 2, j+1 / 2}\right. \\
&\left.-q_{i+1 / 2, j-1 / 2}-q_{i+1 / 2, j+1 / 2}\right) \\
&+v_{i j}\left(q_{i-1 / 2, j-1 / 2}-q_{i-1 / 2, j+1 / 2}+q_{i+1 / 2, j-1 / 2}-q_{i+1 / 2, j+1 / 2}\right)
\end{aligned}
$$

显然，任何在图17.18右方的黑色元素上数值为1，在白色元素上数值为$-1$的元素向常数函数$p^{*}$，都是假压力。]

5.考虑具有非均质Dirichlet边界条件的稳定斯托克斯问题

!!!!
\begin{cases}-v \Delta \mathbf{u}+\nabla p=\mathbf{f} & \text { in } \Omega \subset \mathbb{R}^{2} \\ \operatorname{div} \mathbf{u}=0 & & \text { in } \Omega \\ \mathbf{u}=\mathbf{g} & & \text { on } \Gamma=\partial \Omega\end{cases}
$$

其中$\mathbf{g}$是一个给定的向量函数。证明$\int_{\Gamma} \mathbf{g} \cdot \mathbf{n}=0$是弱解存在的一个必要条件。证明动量方程的弱形式的右手边是$V^{\prime}$的一个元素，是空间$V=\left[\mathrm{H}_{0}^{1}(\Omega)\right]^{d}$的对偶。

6.对非均质的纳维-斯托克斯问题做同样的事（如练习5）。

!!!!
\begin{cases}(\mathbf{u} \cdot \nabla) \mathbf{u}-v \Delta \mathbf{u}+\nabla p=\mathbf{f} & \text { in } \Omega \subset \mathbb{R}^{2} \\ \operatorname{div} \mathbf{u}=0 & \text { in } \Omega \\ \mathbf{u}=\mathbf{g} & \text { on } \Gamma=\partial \Omega\end{cases}
$$

7.证明先验估计\ref{17.57} 。

$\left[\right.$ 解：选择$\mathbf{v}_{h}=\mathbf{u}_{h}$和$q_{h}=p_{h}$作为\ref{17.55} 的检验函数。然后应用考奇-施瓦茨、杨和庞加莱不等式来约束右手边] 。第18章

\section{Optimal control of partial differential equations}

在本章中，我们将介绍线性椭圆偏微分方程的最优控制的基本概念。首先我们介绍函数空间中的经典理论 "à la J.L.Lions"，见[Lio71, Lio72]；然后我们将讨论基于使用拉格朗日函数的方法（见，例如，[Mau81, BKR00, Jam88]）。最后，我们将展示两种不同的控制问题的数值方法，基于Galerkin有限元方法。

本书旨在对这一引人入胜的复杂主题作一个基本介绍。建议有兴趣的读者查阅更专业的专著，例如[Lio71, AWB71, ATF87, Ago03, BKR00, Gun03, Jam88, APV98, MP01, FCZ04, DZ06, Zua05, IK08, HPUU09, Tro10, BS12] 。关于这里使用的函数分析的基本概念，见第2章，也见[Ada75, BG87, Bre86, Rud91, Sal08, TL58]。

\subsection{Definition of optimal control problems}

在抽象的术语中，控制问题可以用图18.1中的范式来表达。有一个由状态问题表示的系统，可以是代数问题，也可以是常微分方程的初值问题，或者是偏微分方程的边界值问题。它的解，一般用$y$表示，取决于一个变量$u$，代表可以对系统施加的控制。控制问题的目标是找到控制$u$，使合适的输出变量（用$z$表示，称为观测变量（是$u$到$y$的函数）采取一个期望的 "值"$z_{d}$，即所谓的观测，或目标。

如果存在一个控制$u$，使观察到的变量$z$与期望值$z_{d}$完全一致，那么这个问题就被称为可控的。并非所有的系统都是可控的（在这方面，见评论文章[Zua06]）：例如，在简单的情况下，状态问题是线性代数系统$A \mathbf{y}=\mathbf{b}$，其中$A$是一个给定的$n \times n$非辛格矩阵，$\mathbf{b}$是$\mathbb{R}^{n}$的给定矢量。



$\left(\begin{array}{c}\text { Input } \\ \text { Control }\end{array} \longrightarrow(\begin{array}{c}{\text { System }}{\text { State }}\end{array} \longrightarrow \underbrace{\text { Output }}{\text { Observation }}\right.

图18.1.控制问题的基本要素

此外，假设观察由一个分量$\sigma$表示，例如第一个分量，并假设控制是右手边的一个分量，例如最后一个分量。因此，问题是这样的。"找到$u \in \mathbb{R}$，使线性系统$A \mathbf{y}=\mathbf{b}+[0, \ldots, 0, u]^{T}$的解满足$y_{1}=y_{1}^{*} \cdot, y_{1}^{*}$是一个给定值。一般来说，这个问题是无解的。由于这个原因，人们通常倾向于用优化问题来代替可控性问题：这样做并不期望输出变量$z$完全等于观测值$z_{d}$，而是期望$z$和$z_{d}$之间的差异（在适当的意义上）是尽可能小的。因此，控制和优化是两个密切相关的概念，我们将在本章的后面看到。

如前所述，我们将只考虑由椭圆PDEs支配的系统。为了这个目的，我们首先介绍进入控制问题的数学实体。

- 控制函数 $u$ 。它属于一个函数空间$\mathscr{U}_{a d}$，称为可接受控制的空间。一般来说，$\mathscr{U}_{a d} \subseteq \mathscr{U}$ ，其中$\mathscr{U}$是一个函数空间，适合描述$u$在给定状态方程中承担的作用。如果$\mathscr{U}_{a d}=\mathscr{U}$，控制问题是无约束的；如果$\mathscr{U}_{a d} \subset \mathscr{U}$，控制问题被称为$\mathrm{con}$紧张的。

- 系统的状态$y(u) \in \mathscr{V}$（一个合适的函数空间），一个取决于控制$u$的函数，它满足状态方程

!!!!
A y(u)=f,
\label{18.1}\end{equation}

其中$A: \mathscr{V} \mapsto \mathscr{V}^{\prime}$是一个微分算子（线性或非线性）。这个问题描述了一个受适当边界条件制约的物理问题。正如我们将看到的，控制函数可以进入右手边，在边界数据中，或在微分算子的系数中。

- $z(u)$中的观察函数，也取决于通过$y$的控制$u$和一个合适的算子$C: \mathscr{V} \rightarrow \mathscr{Z}$。

!!!!
z(u)=C y(u)
$$

这个函数属于观察函数的空间$\mathscr{Z}$，必须 "接近 "观察函数$z_{d}$ 。事实上，优化系统\ref{18.1} 意味着找到控制函数$u$，使函数$z(u)$"尽可能地接近 "观察函数$z_{d}$。这一目标将通过我们将要描述的最小化过程来实现。

- 一个成本函数$J(u)$ ，定义在空间$\mathscr{U}_{a d}$ 上。

!!!!
u \in \mathscr{U}_{a d} \mapsto J(u) \in \mathbb{R} \quad \text { with } J(u) \geq 0
$$

一般来说，$J$将通过$z(u)$依赖于$u$（也），即$J(u)=\tilde{J}(u, z(u))$，对于一个合适的函数$\tilde{J}: \mathscr{U}_{a d} \times \mathscr{Z} \rightarrow \mathbb{R}$。

最佳控制问题可以用以下两种方式表述。

i) 找到$u \in \mathscr{U}_{a d}$，使得

!!!!
J(u)=\inf J(v) \quad \forall v \in \mathscr{U}_{a d}
\label{18.2}\end{equation}

ii）找到$u \in \mathscr{U}_{a d}$，使以下不等式成立

!!!!
J(u) \leq J(v) \quad \forall v \in \mathscr{U}_{a d}
\label{18.3}\end{equation}

满足\ref{18.2} （或\ref{18.3} ）的函数$u$被称为系统\ref{18.1} 的最优控制。

在分析控制问题的存在性和唯一性属性以及优化条件的特征之前，让我们考虑一个简单的有限维的例子。

\subsection{A control problem for linear systems}

让$A$是一个$n \times n$非星形矩阵，$B$是一个$n \times q$矩阵。此外，让$\mathbf{f}$是一个$\mathbb{R}^{n}, \mathbf{u}$的向量，一个$\mathbb{R}^{q}$的向量代表控制。代表状态的向量$\mathbf{y}=\mathbf{y}(\mathbf{u}) \in \mathbb{R}^{n}$满足以下线性系统

!!!!
A \mathbf{y}=\mathbf{f}+B \mathbf{u}
\label{18.4}\end{equation}

我们寻找一个控制$\mathbf{u}$，使以下线性函数最小化。

!!!!
J(\mathbf{u})=\left\|\mathbf{z}(\mathbf{u})-\mathbf{z}_{d}\right\|_{\mathbb{R}^{m}}^{2}+\|\mathbf{u}\|_{N}^{2}
\label{18.5}\end{equation}

在这个方程中，$\mathbf{z}_{d}$是$\mathbb{R}^{m}, \mathbf{z}(\mathbf{u})=C \mathbf{y}(\mathbf{u})$的一个给定向量（目标），其中$C$是一个$m \times n$矩阵，$\|\mathbf{u}\|_{N}=(N \mathbf{u}, \mathbf{u})_{\mathbb{R}^{q}}^{1 / 2}$是$N$的诺姆，$\mathbf{u}, N$是一个维数为$q \times q$ 的给定对称和正定矩阵。

将术语$\|\mathbf{u}\|_{N}^{2}$解释为与控制相关的能量，因此问题是：选择控制，使观察$\mathbf{z}(\mathbf{u})$接近目标$\mathbf{z}_{d}$，其能量较小。

请注意

!!!!
J(\mathbf{u})=\left(C A^{-1}(\mathbf{f}+B \mathbf{u})-\mathbf{z}_{d}, C A^{-1}(\mathbf{f}+B \mathbf{u})-\mathbf{z}_{d}\right)_{\mathbb{R}^{m}}+(N \mathbf{u}, \mathbf{u})_{\mathbb{R}^{q}}
\label{18.6}\end{equation}

因此，成本函数$J(\mathbf{u})$是$\mathbf{u}$的二次函数，在$\mathbb{R}^{q}$上有一个全局最小值。后者的特点是：条件

!!!!
J^{\prime}(\mathbf{u}) \mathbf{h}=0 \quad \forall \mathbf{h} \in \mathbb{R}^{q}
\label{18.7}\end{equation}

其中$J^{\prime}(\mathbf{u}) \mathbf{h}$是在 "点"$\mathbf{u}$处计算的沿方向$\mathbf{h}$的（Gâteaux）方向导数，即（见第二章的定义$2.6$）。

!!!!
J^{\prime}(\mathbf{u}) \mathbf{h}=\lim _{t \rightarrow 0} \frac{J(\mathbf{u}+t \mathbf{h})-J(\mathbf{u})}{t}
$$

自

!!!!
A \mathbf{y}^{\prime}(\mathbf{u}) \mathbf{h}=B \mathbf{h} \text { and } \mathbf{z}^{\prime}(\mathbf{u}) \mathbf{h}=C \mathbf{y}^{\prime}(\mathbf{u}) \mathbf{h}
$$

对于所有的$\mathbf{u}$和$\mathbf{h}$，从\ref{18.6}我们得到

!!!!
\begin{aligned}
J^{\prime}(\mathbf{u}) \mathbf{h} &=2\left[\left(\mathbf{z}^{\prime}(\mathbf{u}) \mathbf{h}, \mathbf{z}(\mathbf{u})-\mathbf{z}_{d}\right)_{\mathbb{R}^{m}}+(N \mathbf{u}, \mathbf{h})_{\mathbb{R}} q\right] \\
&=2\left[\left(C A^{-1} B \mathbf{h}, C \mathbf{y}(\mathbf{u})-\mathbf{z}_{d}\right)_{\mathbb{R}^{m}}+(N \mathbf{u}, \mathbf{h})_{\mathbb{R}^{q}}\right]
\end{aligned}
\label{18.8}\end{equation}

让我们介绍以下系统的解$\mathbf{p}=\mathbf{p}(\mathbf{u}) \in \mathbb{R}^{n}$，它被称为\ref{18.4}的邻接状态

!!!!
A^{T} \mathbf{p}(\mathbf{u})=C^{T}\left(C \mathbf{y}(\mathbf{u})-\mathbf{z}_{d}\right)
\label{18.9}\end{equation}

从\ref{18.8} 我们推导出

!!!!
J^{\prime}(\mathbf{u}) \mathbf{h}=2\left[(B \mathbf{h}, \mathbf{p}(\mathbf{u}))_{\mathbb{R}^{n}}+(N \mathbf{u}, \mathbf{h})_{\mathbb{R} q}\right]
$$

就是说

!!!!
J^{\prime}(\mathbf{u})=2\left[B^{T} \mathbf{p}(\mathbf{u})+N \mathbf{u}\right]
\label{18.10}\end{equation}

由于$J$在$\mathbf{u}$点达到最小，对于$J^{\prime}(\mathbf{u})=\mathbf{0}$，我们可以得出结论，三场系统

!!!!
\left\{\begin{array}{l}
A \mathbf{y}=\mathbf{f}+B \mathbf{u} \\
A^{T} \mathbf{p}=C^{T}\left(C \mathbf{y}-\mathbf{z}_{d}\right) \\
B^{T} \mathbf{p}+N \mathbf{u}=\mathbf{0}
\end{array}\right.
\label{18.11}\end{equation}

承认一个唯一的解决方案$(\mathbf{u}, \mathbf{y}, \mathbf{p}) \in \mathbb{R}^{q} \times \mathbb{R}^{n} \times \mathbb{R}^{n}$，并且$\mathbf{u}$是原始系统的唯一最优控制。

在下一节中，我们将介绍几个拉普拉斯方程的最优控制问题的例子。

\subsection{Some examples of optimal control problems for the Laplace equation}

为了简单起见，考虑椭圆算子$A$是拉普拉斯的情况。我们定义两个不同系列的最优控制问题：分布式控制和边界控制。

- 分布式控制。让我们介绍一下状态问题

!!!!
\begin{cases}-\Delta y=f+u & \text { in } \Omega \\ y=0 & \text { on } \Gamma=\partial \Omega\end{cases}
\label{18.12}\end{equation}

其中$\Omega$是一个域，$\mathbb{R}^{n}, y \in \mathscr{V}=H_{0}^{1}(\Omega)$是状态变量，$f \in L^{2}(\Omega)$是一个给定的源项，$u \in \mathscr{U}_{a d}=L^{2}(\Omega)$是控制函数。我们可以考虑两种不同的成本函数： - 在域上，例如

!!!!
J(u)=\int_{\Omega}\left(y(u)-z_{d}\right)^{2} d \Omega
\label{18.13}\end{equation}

- 在边界上，例如（只要$y(u)$有足够的规律性

!!!!
J(u)=\int_{\Gamma}\left(\frac{\partial y(u)}{\partial n}-z_{d_{\Gamma}}\right)^{2} d \gamma
$$

函数$z_{d}$和$z_{d_{\Gamma}}$是两个规定的观察（或目标）函数。

- 边界控制。现在考虑以下的状态问题

!!!!
\begin{cases}-\Delta y=f & \text { in } \Omega \\ y=u & \text { on } \Gamma_{D} \\ \frac{\partial y}{\partial n}=0 & \text { on } \Gamma_{N}\end{cases}
\label{18.14}\end{equation}

与 $\Gamma_{D} \cup \Gamma_{N}=\partial \Omega$ 和 $\stackrel{\circ}{\Gamma}_{D} \cap \stackrel{\circ}{\Gamma}_{N}=\emptyset$ 。控制$u \in H^{\frac{1}{2}}\left(\Gamma_{D}\right)$是在迪里希特边界上定义的。可以考虑两种不同类型的成本函数。

- 在域上，如\ref{18.13} 。

- 在边界上，例如

!!!!
J(u)=\int_{\Gamma_{N}}\left(y(u)-z_{d_{\Gamma_{N}}}\right)^{2} d \gamma
$$

在这里，$z_{d_{\Gamma_{N}}}$也代表一个给定的观察函数。

\section{ $18.4$ On minimization of linear functionals}。

在这一节中，我们回顾一些关于线性函数极值的存在性和唯一性的结果，重点是那些与本章所讨论的控制问题有关的结果。更多的结果见，例如，[Lio71, BG87, Bre86, TL58]。我们考虑一个希尔伯特空间$\mathscr{U}$，并赋予其标量积$(\cdot, \cdot)$和双线性形式$\pi$。

!!!!
u, v \mapsto \pi(u, v) \quad \forall u, v \in \mathscr{U}
\label{18.15}\end{equation}

我们假设它是对称的、连续的和强制性的。标量积在$\mathscr{U}$上引起的规范将用$\|w\|=\sqrt{(w, w)}$表示。让

!!!!
v \mapsto F(v) \quad \forall v \in \mathscr{U}
\label{18.16}\end{equation}

是$\mathscr{U}$上的一个线性和有界函数。最后，让$\mathscr{U}_{a d}$成为U的可接受控制函数的封闭子空间，并考虑以下成本函数

!!!!
J(v)=\pi(v, v)-2 F(v) \quad \forall v \in \mathscr{U}_{a d}
\label{18.17}\end{equation}

以下结果成立。

定理18.1。在前面的假设下，存在一个唯一的$u \in \mathscr{U}_{a d}$，使得

Theorem 18.1. Under the previous assumptions, there exists a unique $u \in \mathscr{U}_{a d}$ such that

!!!!
J(u)=\inf J(v) \quad \forall v \in \mathscr{U}_{a d},
\label{18.18}\end{equation}

其中$J(v)$在\ref{18.17} 中定义；$u$被称为最优控制。此外。

(i) 函数$u \in \mathscr{U}_{\text {ad }}$满足变量不等式


!!!!
\pi(u, v-u) \geq F(v-u) \quad \forall v \in \mathscr{U}_{a d}
\label{18.19}\end{equation}

(ii) 如果$\mathscr{U}_{a d}=\mathscr{U}$（即我们考虑$a$非约束优化问题），由于Lax-Milgram定理3.1，u满足与\ref{18.18}相关的以下欧拉方程式

!!!!
\pi(u, w)=F(w) \quad \forall w \in \mathscr{U}
\label{18.20}\end{equation}



(iii) 如果$\mathscr{U}_{a d}$是一个顶点在原点的闭合凸圆锥体$0^{1}, u$满足


!!!!
\pi(u, v) \geq F(v) \quad \forall v \in \mathscr{U}_{a d} \quad \text { and } \quad \pi(u, u)=F(u)
\label{18.21}\end{equation}

(iv) 假设map$v \mapsto F(v)$是严格凸和可微的，$J$（不一定是二次）满足。  $J(v) \rightarrow \infty$ 当$\|v\|_{\mathscr{W}} \rightarrow \infty \forall v \in \mathscr{U}_{a d}$ 。那么满足条件\ref{18.18} 的唯一函数$u \in \mathscr{U}_{a d}$的特征是变分不等式


!!!!
J^{\prime}(u)(v-u) \geq 0 \quad \forall v \in \mathscr{U}_{a d}
\label{18.22}\end{equation}

or, equivalently,

!!!!
J^{\prime}(v)(v-u) \geq 0 \quad \forall u \in \mathscr{U}_{a d}
\label{18.23}\end{equation}

(The symbol $J^{\prime}$ denotes the Gâteaux derivative of $J$, see Definition $2.5$ of Chap. 2.)


证明。完整的证明见，例如，[Lio71，第1章，定理1.1]。这里我们证明\ref{18.19} 。如果$u$最小化\ref{18.18} ，那么对于所有$v \in \mathscr{U}_{a d}$和每个$0<\vartheta<1, J(u) \leq!!!!J((1-\vartheta) u+\vartheta v)$，因此$\frac{1}{\vartheta}[J(u+\vartheta(v-u))-J(u)] \geq 0$ 。当$\vartheta \rightarrow 0$时，这个不等式仍然成立（只要这个极限存在），因此

!!!!
J^{\prime}(u)(v-u) \geq 0 \quad \forall v \in \mathscr{U}_{a d} .
\label{18.24}\end{equation}

通过回顾 $J$ 的定义\ref{18.17} ，得出不等式\ref{18.19} 。

反之亦然（因此\ref{18.18} 和\ref{18.19} 实际上是等同的）。事实上，如果$u$满足\ref{18.19}，那么\ref{18.24}也满足，由于map$v \mapsto J(v)$对每个$0<\vartheta<1$的凸性，我们有

!!!!
J(v)-J(w) \geq \frac{1}{\vartheta}[J((1-\vartheta) w+v)-J(w)] \quad \forall v, w \in \mathscr{U}_{a d}
$$

取极限为$\vartheta \rightarrow 0$，我们得到

!!!!
J(v)-J(w) \geq J^{\prime}(w)(v-w)
$$

取$w=u$并使用\ref{18.24}，我们得到$J(v) \geq J(u)$ ，即\ref{18.18} 。

为了证明\ref{18.20}，只要在\ref{18.19}中选择$v=u \pm w \in \mathscr{U}$即可。

现在让我们证明\ref{18.21} 。第一个不等式可以通过将$v$替换为\ref{18.19}中的$v+u$得到。现在在\ref{18.19} 中设置$v=0$，我们得到$\pi(u, u) \leq F(u)$ 。将后者与\ref{18.21} 中的第一个不等式结合起来，我们得到\ref{18.21}中的第二个方程。反之（即\ref{18.21} \ref{8.19}）则是显而易见的。

关于\ref{18.22}和\ref{18.23}的证明，见[Lio71, Chap 1, Theorem 1.4]。


备注18.1。如果$J(v)$在$v, \forall v \in \mathscr{U}$中是可微的，那么对于$J$的每个最小化函数$u \in \mathscr{U}$（只要它确实存在）我们有$J^{\prime}(u)=0$。此外，在定理$18.1$（步骤㈣）的假设下，至少存在一个最小化元素$u \in \mathscr{U}$ 。

我们可以总结说，最小化问题的解$u \in \mathscr{U}_{a d}$满足以下（等价）条件。

$\begin{array}{lll}\text { i) } & J(u)=\inf J(v) & \forall v \in \mathscr{U}_{a d} \\ \text { ii) } & J(u) \leq J(v) & \forall v \in \mathscr{U}_{a d} \\ \text { iii) } & J^{\prime}(u)(v-u) \geq 0 & \forall v \in \mathscr{U}_{a d} \\ \text { iv) } & J^{\prime}(v)(v-u) \geq 0 & \forall u \in \mathscr{U}_{a d}\end{array}

在结束本节之前，考虑寻找满足变分不等式\ref{18.19} 的$u \in \mathscr{U}_{a d}$的抽象问题（当$\pi(\cdot, \cdot)$不是对称的时候，这个问题不对应于变分微积分中的最小化问题）。

Theorem 18.2. If there exists a constant $c>0$ such that

!!!!
\pi\left(v_{1}-v_{2}, v_{1}-v_{2}\right) \geq c\left\|v_{1}-v_{2}\right\|^{2} \quad \forall v_{1}, v_{2} \in \mathscr{U}_{a d}
$$

then there exists a unique function $u \in \mathscr{U}_{a d}$ which satisfies $(18.19)$.

证明见[Lio71, Chap 1, Theorem 2.1]。

\subsection{The theory of optimal control for elliptic problems}

在本节中，我们说明了由线性椭圆方程（状态方程）支配的控制问题的一些存在性和唯一性结果。为了简单起见，我们限制在分布式控制上（见第18.3节）；然而，类似的结果对边界控制问题也是成立的，见 [Lio71] 。

设$\mathscr{V}$和$\mathscr{H}$是两个希尔伯特空间，$\mathscr{V}^{\prime}$是$\mathscr{V}$的对偶，$\mathscr{H}^{\prime}$是$\mathscr{H}$的对偶，并假设$\mathscr{V}$在$\mathscr{H}$中是密集的，有连续注入。我们回顾一下，在这种情况下，第二章的属性$(2.10)$成立。此外，用$(\cdot, \cdot)$表示$\mathscr{H}$的标量积，并假设$a(u, v)$是$\mathscr{V}$上的双线性、连续和胁迫形式（但不一定对称）。在这些假设下，Lax-Milgram定理保证存在一个问题的唯一解$y \in \mathscr{V}$。

!!!!
a(y, \varphi)=(f, \varphi) \quad \forall \varphi \in \mathscr{V}
\label{18.26}\end{equation}

通过引入与双线性形式$A$相关的算子$a(\cdot, \cdot)$（见\ref{3.39} ）。

!!!!
A \in \mathscr{L}\left(\mathscr{V}, \mathscr{V}^{\prime}\right): \mathscr{v}^{\prime}\langle A \varphi, \psi\rangle_{\mathscr{V}}=a(\varphi, \psi) \quad \forall \varphi, \psi \in \mathscr{V}
$$

问题\ref{18.26} 变成（以算子形式）的

!!!!
A y=f \quad \text { in } \mathscr{V}^{\prime}
\label{18.27}\end{equation}

这个方程将由一个分布式控制项来补充。

设$\mathscr{U}$为控制函数的希尔伯特空间，$B$为属于该空间的算子$\mathscr{L}\left(\mathscr{U}, \mathscr{V}^{\prime}\right)$。对于每个控制函数$u$，系统的状态方程为

!!!!
A y(u)=f+B u \quad \text { in } \mathscr{V}^{\prime}
\label{18.28}\end{equation}

或者，以弱的形式。

!!!!
y(u) \in \mathscr{V}: a(y(u), \varphi)=(f, \varphi)+b(u, \varphi) \quad \forall \varphi \in \mathscr{V}
\label{18.29}\end{equation}

其中$b(\cdot, \cdot)$是与算子$B$相关的双线性形式，也就是

!!!!
b(u, \varphi)=\mathscr{V}^{\prime}\langle B u, \varphi\rangle_{\mathscr{V}} \quad \forall u \in \mathscr{U}, \forall \varphi \in \mathscr{V}
\label{18.30}\end{equation}

让我们用$\mathscr{Z}$来表示观察函数的希尔伯特空间，并引入观察方程

!!!!
z(u)=C y(u)
\label{18.31}\end{equation}

为一个合适的算子 $C \in \mathscr{L}(\mathscr{V}, \mathscr{Z})$ 。最后，让我们定义成本函数

!!!!
J(y(u), u)=\left\|C y(u)-z_{d}\right\|_{\mathscr{Z}}^{2}+(N u, u)_{\mathscr{W}},
\label{18.32}\end{equation}

我们将用速记符号$J(u)$来表示。这里$N \in \mathscr{L}(\mathscr{U}, \mathscr{U})$是一个对称的正定式，因此

!!!!
(N u, u)_{\mathscr{U}} \geq v\|u\|_{\mathscr{U}}^{2} \quad \forall u \in \mathscr{U},
\label{18.33}\end{equation}

其中$v>0$和$z_{d} \in \mathscr{Z}$是期望的（目标）观察。

最佳控制问题包括寻找$u \in \mathscr{U}_{a d} \subseteq \mathscr{U}$，以便

!!!!
J(u)=\inf J(v) \quad \forall v \in \mathscr{U}_{a d}
\label{18.34}\end{equation}

图18.2描述了上述最优控制问题定义中涉及的空间和运算符的提醒。

![](https://cdn.mathpix.com/cropped/991f5db518e324d299c1ff4972bba9fb-135.jpg?height=244&width=502&top_left_y=123&top_left_x=198)

图18.2.控制问题陈述中涉及的函数空间和运算符

备注 18.2.当最小化\ref{18.32} 时，实际上是最小化了两个项之间的组合。前者强制要求观察值$z(u)$与期望值（目标值）$z_{d}$相闭。后者对使用 "太贵 "的控制$u$进行惩罚。启发式地讲，我们试图通过减少努力使$z(u)$向$z_{d}$发展。请注意，如果形式$N$为空，这一理论也适用，但在这种情况下，我们只能证明最优控制的存在，而不是其唯一性。

为了应用第18.4节所述的抽象理论结果，注意到$u \mapsto y(u)$中$\mathscr{U}$的映射是仿射的，我们可以将\ref{18.32}重写如下

!!!!
J(u)=\left\|C[y(u)-y(0)]+C y(0)-z_{d}\right\|_{\mathscr{Z}}^{2}+(N u, u)_{\mathscr{U}}
\label{18.35}\end{equation}

现在让我们定义一个在$\pi$中连续的双线性形式$\mathscr{U}$和一个函数$F$如下，对所有$u, v \in \mathscr{U}$ :

!!!!
\begin{gathered}
\pi(u, v)=(C[y(u)-y(0)], C[y(v)-y(0)]) \mathscr{Z}+(N u, v)_{\mathscr{U}}, \\
F(v)=\left(z_{d}-C y(0), C[y(v)-y(0)]\right) \mathscr{\mathscr { Z }}
\end{gathered}
$$

那么

!!!!
J(v)=\pi(v, v)-2 F(v)+\left\|z_{d}-C y(0)\right\|_{\mathscr{Z}}^{2}
$$

由于$\|C[y(v)-y(0)]\|_{\mathscr{Z}}^{2} \geq 0$，由于\ref{18.33}我们得到了

!!!!
\pi(v, v) \geq v\|v\|_{\mathscr{U}}^{2} \quad \forall v \in \mathscr{U}
$$

通过这样做，我们将控制问题归入第18.4节中的一般表述。然后定理 $18.1$ 保证了控制函数的存在性和唯一性 $u \in \mathscr{U}_{a d}$ 。

在这个阶段，我们想研究一下对解决控制问题有用的方程的结构。由于定理18.1，并且由于$A$是$\mathscr{V}$和$\mathscr{V}^{\prime}$之间的同构（参见定义$2.4$），我们有

!!!!
y(u)=A^{-1}(f+B u)
$$

当$y^{\prime}(u) \psi=A^{-1} B \psi$，因此

!!!!
y^{\prime}(u)(v-u)=A^{-1} B(v-u)=y(v)-y(u)
$$

由于最优控制必须满足\ref{18.22} ，除以2的不等式\ref{18.22} ，我们得到，感谢\ref{18.35}

!!!!
\left(C y(u)-z_{d}, C[y(v)-y(u)]\right)_{\mathscr{Z}}+(N u, v-u)_{\mathscr{U}} \geq 0 \quad \forall v \in \mathscr{U}_{a d}
\label{18.36}\end{equation}

现在让$C^{\prime} \in \mathscr{L}\left(\mathscr{Z}^{\prime}, \mathscr{V}^{\prime}\right)$成为算子$C \in \mathscr{L}(\mathscr{V}, \mathscr{Z})(\operatorname{see}(2.20))$的邻接点。那么

!!!!
\mathscr{Z}\langle C y, v\rangle_{\mathscr{Z}^{\prime}}=\mathscr{v}\left\langle y, C^{\prime} v\right\rangle_{\mathscr{V}^{\prime}} \quad \forall y \in \mathscr{V}, \forall v \in \mathscr{Z}^{\prime}
$$

因此\ref{18.36} 成为

!!!!
\mathscr{V}^{\prime}\left\langle C^{\prime} \Lambda_{\mathscr{Z}}\left(C y(u)-z_{d}\right), y(v)-y(u)\right\rangle_{\mathscr{V}}+(N u, v-u)_{\mathscr{U}} \geq 0 \quad \forall v \in \mathscr{U}_{a d}
\label{18.37}\end{equation}

其中$\Lambda_{\mathscr{Z}}$表示从$\mathscr{Z}$到$\mathscr{Z}^{\prime}($的典范雷兹同构，见$(2.5))$ 。现在让我们介绍一下$A^{\prime} \in \mathscr{L}\left(\mathscr{V}, \mathscr{V}^{\prime}\right)$的邻接算子$A

!!!!
\mathscr{v}\left\langle A^{\prime} \varphi, \psi\right\rangle_{\mathscr{V}}=\mathscr{v}\langle\varphi, A \psi\rangle_{\mathscr{V}} \quad \forall \varphi, \psi \in \mathscr{V}
$$

这个算子在第二节中用符号$A^{*}$表示。  $3.5$（见拉格朗日特性\ref{3.42} ）。由于［$(3.40)$］和［$(3.41)$］，我们得到

!!!!
\mathscr{V}^{\prime}\left\langle A^{\prime} \varphi, \psi\right\rangle_{\mathscr{V}}=a(\psi, \varphi) \quad \forall \varphi, \psi \in \mathscr{V}
\label{18.38}\end{equation}

我们定义邻接状态（或邻接变量）$p(u) \in \mathscr{V}$为邻接方程的解

!!!!
A^{\prime} p(u)=C^{\prime} \Lambda_{\mathscr{Z}}\left(C y(u)-z_{d}\right)
\label{18.39}\end{equation}

与$u \in \mathscr{U}$ 。由于\ref{18.39}，我们得到

!!!!
\begin{gathered}
\mathscr{V}^{\prime}\left\langle C^{\prime} \Lambda_{\mathscr{Z}}\left(C y(u)-z_{d}\right), y(v)-y(u)\right\rangle_{\mathscr{V}}= \\
\mathscr{y}^{\prime}\left\langle A^{\prime} p(u), y(v)-y(u)\right\rangle_{\mathscr{V}}=
\end{gathered}
$$

(感谢$\left.A^{\prime}\right) \quad \mathscr{V}\langle p(u), A(y(v)-y(u))\rangle_{\mathscr{V}}=$的定义)

!!!!
\text { (thanks to \ref{18.28}) } \quad \mathscr{V}\langle p(u), B(v-u)\rangle_{\mathscr{V}}=\mathscr{\mathscr { U } ^ { \prime }}\left\langle B^{\prime} p(u), v-u\right\rangle_{\mathscr{U}},
$$

其中$B^{\prime} \in \mathscr{L}\left(\mathscr{V}, \mathscr{U}^{\prime}\right)$是$B$的邻接算子（见$\left.(2.20)\right)$ 。由此可见，借助于$\mathscr{U}$和$\mathscr{U}^{\prime}$的里兹典型同构$\Lambda_{\mathscr{W}}$（又见$\left.(2.5)\right)$），不等式\ref{18.22} 可以改写为

!!!!
\frac{1}{2} J^{\prime}(u)(v-u)=\left(\Lambda_{\mathscr{U}}^{-1} B^{\prime} p(u)+N u, v-u\right) \mathscr{U} \geq 0 \quad \forall v \in \mathscr{U}_{a d}
\label{18.40}\end{equation}

在无约束控制的情况下，也就是当$\mathscr{U}_{a d}=\mathscr{U}$时，最后一个不等式实际上变成了平等，即

!!!!
B^{\prime} p(u)+\Lambda_{\mathscr{U}} N u=0 .
\label{18.41}\end{equation}

这可以通过在\ref{18.40} 中取$v=u-\left(\Lambda_{\mathscr{W}}^{-1} B^{\prime} p(u)+N u\right)$得出。在$\mathscr{V} \subset \mathscr{U}$的情况下，前面的方程式意味着

!!!!
b(v, p)+n(u, v)=0 \quad \forall v \in \mathscr{V}
$$

最后的结果在下面的定理中重述（[Lio71, Chap. 2, Thm. 1.4]）。

Theorem 18.3. A necessary and sufficient condition for the existence of an optimal control $u \in \mathscr{U}_{\text {ad }}$ is that the following equations and inequalities hold ( see \ref{18.28},\ref{18.39},\ref{18.40} )

!!!!
\begin{cases}y=y(u) \in \mathscr{V}, & A y(u)=f+B u \\ p=p(u) \in \mathscr{V}, & A^{\prime} p(u)=C^{\prime} \Lambda\left(C y(u)-z_{d}\right) \\ u \in \mathscr{U}_{a d}, & \left(\Lambda_{\mathscr{U}}^{-1} B^{\prime} p(u)+N u, v-u\right)_{\mathscr{U}} \geq 0 \quad \forall v \in \mathscr{U}_{a d}\end{cases}
\label{18.42}\end{equation}

or, in weak form:

!!!!
\begin{cases}y=y(u) \in \mathscr{V}, & a(y(u), \varphi)=(f, \varphi)+b(u, \varphi) \quad \forall \varphi \in \mathscr{V}, \\ p=p(u) \in \mathscr{V}, & a(\psi, p(u))=\left(C y(u)-z_{d}, C \psi\right) \mathscr{\mathscr { Z }} \quad \forall \psi \in \mathscr{V} \\ u \in \mathscr{U}_{a d}, \quad & \left(\Lambda_{\mathscr{U}}^{-1} B^{\prime} p(u)+N u, v-u\right)_{\mathscr{U}} \geq 0 \quad \forall v \in \mathscr{U}_{a d}\end{cases}
\label{18.43}\end{equation}

This is called the optimality system.
If $N$ is symmetric and positive definite, then the control u is unique; on the other hand, if $N=0$ and $\mathscr{U}_{a d}$ is bounded, then there exists at least one solution, and the family of optimal controls forms a closed and convex subset $\mathscr{X}$ of $\mathscr{U}_{a d}$. The third condition of $(18.42)$ can be expressed as follows

!!!!
\left(\Lambda_{\mathscr{U}}^{-1} B^{\prime} p(u)+N u, u\right)_{\mathscr{U}}=\inf _{v \in \mathscr{U}_{a d}}\left(\Lambda_{\mathscr{U}}^{-1} B^{\prime} p(u)+N u, v\right) \mathscr{U}
\label{18.44}\end{equation}

Finally,

!!!!
\frac{1}{2} J^{\prime}(u)=B^{\prime} p(u)+\Lambda_{\mathscr{U}} N u
\label{18.45}\end{equation}


备注18.3。除了取决于形式的项$N, J^{\prime}$可以通过算子$B^{\prime}$从邻接变量$p$得到。这个结果将成为数值方法的基础，这些方法对于确定近似的控制函数很有用。如果$\mathscr{U}_{a d}=\mathscr{U}$，那么最优控制满足以下条件

!!!!
N u=-\Lambda_{\mathscr{U}}^{-1} B^{\prime} p(u)
\label{18.46}\end{equation}

由于特性$(2.24)$，我们有

!!!!
\Lambda_{\mathscr{U}}^{-1} B^{\prime}=B^{T} \Lambda_{\mathcal{V}}
\label{18.47}\end{equation}

其中$\Lambda_{\mathscr{V}}$是$\mathscr{V}$到$\mathscr{V}^{\prime}$的里兹典型同构，$B^{T}: \mathscr{V}^{\prime} \rightarrow \mathscr{U}$是$B$的转置算子，在$(2.22)$中引入。

\subsection{Some examples of optimal control problems}

在本节中，我们将介绍三个优化控制问题的例子。

\subsubsection{A Dirichlet problem with distributed control}

让我们恢复分布式控制的例子\ref{18.12} ，并考虑以下的成本函数（要最小化）。

!!!!
J(v)=\int_{\Omega}\left(y(v)-z_{d}\right)^{2} d \Omega+(N v, v)
\label{18.48}\end{equation}

其中，例如，我们可以设置$N=v I, v>0$ 。在这种情况下，$\mathscr{V}=H_{0}^{1}(\Omega), \mathscr{H}=$ $L^{2}(\Omega), \mathscr{U}=\mathscr{H}\left(\right.$ 然后$\left.(N v, v)=(N v, v)_{\mathscr{U}}\right)$ 因此$\Lambda_{\mathscr{W}}$ 是身份算子。此外，$B$是身份算子，$C$是$\mathscr{H}, \mathscr{Z}=\mathscr{H}$中$\mathscr{V}$的注入算子，因此$\Lambda_{\mathscr{Z}}$是身份算子。最后，$a(u, v)=\int_{\Omega} \nabla u \cdot \nabla v d \Omega$ 。由于定理$18.3$，我们得到，与$A=-\Delta$一起，以下的最优性系统。

!!!!
\begin{cases}y(u) \in H_{0}^{1}(\Omega) \quad: \quad A y(u)=f+u \quad \text { in } \Omega \\ p(u) \in H_{0}^{1}(\Omega) & : \quad A^{\prime} p(u)=y(u)-z_{d} \quad \text { in } \Omega \\ u \in \mathscr{U}_{a d} \quad & : \int_{\Omega}(p(u)+N u)(v-u) d \Omega \geq 0 \quad \forall v \in \mathscr{U}_{a d}\end{cases}
\label{18.49}\end{equation}

在无约束的情况下，$\mathscr{U}_{a d}=\mathscr{U}\left(=L^{2}(\Omega)\right)$，最后一个不等式简化为方程

!!!!
p(u)+N u=0,
$$

正如我们通过采取$v=u-(p(u)+N u)$可以看出。

\ref{18.49}的前两个方程提供了一个用于两个变量$y$和$p$的系统

!!!!
\left\{\begin{array}{lll}
A y+N^{-1} p=f \quad \text { in } \Omega, & y=0 \quad \text { on } \partial \Omega \\
A^{\prime} p-y=-z_{d} \quad \text { in } \Omega, & p=0 \quad \text { on } \partial \Omega
\end{array}\right.
$$

其解决方案提供了最佳控制 $u=-N^{-1} p$ 。

如果$\Omega$有一个光滑的边界，根据椭圆规律性属性，$y$和$p$都属于空间$H^{2}(\Omega)$ 。由于$N^{-1}$将$H^{2}(\Omega)$映射到自身，最优控制$u$也属于$H^{2}(\Omega)$ 。

\subsubsection{A Neumann problem with distributed control}

现在考虑一下这个问题

!!!!
\begin{cases}A y(u)=f+u & \text { in } \Omega \\ \frac{\partial y(u)}{\partial n_{A}}=g & & \text { on } \partial \Omega\end{cases}
\label{18.50}\end{equation}

对于给定的$f \in L^{2}(\Omega)$和$g \in H^{-1 / 2}(\partial \Omega)$，其中$A$是一个椭圆算子，$\frac{\partial}{\partial n_{A}}$是与$A$相关的正态导数（见$(3.34))$ 。要最小化的成本函数是\ref{18.48}中引入的函数。在这种情况下，$\mathscr{V}=H^{1}(\Omega), \mathscr{H}=L^{2}(\Omega)$ ，$\mathscr{U}=\mathscr{H}, B$是身份算子，$C$是$\mathscr{V}$到$\mathscr{H}$的注入图。

!!!!
a(\psi, \varphi)=\mathscr{V}^{\prime}\langle A \psi, \varphi\rangle_{\mathscr{V}}, \quad F(\varphi)=\int_{\Omega} f \varphi d \Omega+\int_{\partial \Omega} g \varphi d \gamma
$$

如果$A \varphi=-\Delta \varphi+\beta \varphi$ ，与$\beta>0$ ，那么

!!!!
a(\psi, \varphi)=\int_{\Omega} \nabla \psi \cdot \nabla \varphi d \Omega+\int_{\Omega} \beta \psi \varphi d \Omega
$$

状态问题的变量表述\ref{18.50}为

!!!!
\text { find } y(u) \in H^{1}(\Omega): a(y(u), \varphi)=F(\varphi) \quad \forall \varphi \in H^{1}(\Omega)
\label{18.51}\end{equation}

邻接问题是以下诺伊曼问题

!!!!
\begin{cases}A^{\prime} p(u)=y(u)-z_{d} & \text { in } \Omega \\ \frac{\partial p(u)}{\partial n_{A^{\prime}}}=0 & \text { on } \partial \Omega\end{cases}
\label{18.52}\end{equation}

最佳控制可以通过解决由\ref{18.50},\ref{18.52}形成的系统得到，并且

!!!!
u \in \mathscr{U}_{a d}: \int_{\Omega}(p(u)+N u)(v-u) d \Omega \geq 0 \quad \forall v \in \mathscr{U}_{a d}
\label{18.53}\end{equation}

\subsubsection{A Neumann problem with boundary control}

现在考虑一下这个问题

!!!!
\begin{cases}A y(u)=f & \text { in } \Omega \\ \frac{\partial y(u)}{\partial n_{A}}=g+u & & \text { on } \partial \Omega\end{cases}
\label{18.54}\end{equation}

其中运算符与之前相同，成本函数仍然是\ref{18.48}的。在这种情况下。

!!!!
\mathscr{V}=H^{1}(\Omega), \quad \mathscr{H}=L^{2}(\Omega), \quad \mathscr{U}=H^{-1 / 2}(\partial \Omega)
$$

对于所有$u \in \mathscr{U}, B u \in \mathscr{V}^{\prime}$由$\mathscr{V}\langle B u, \varphi\rangle_{\mathscr{V}}=\int_{\partial \Omega} u \varphi d \gamma$给出，$C$是$\mathscr{V}$在$\mathscr{H}$的注入图。

\ref{18.54}的弱表述是

找到 $y(u) \in \mathscr{H}^{1}(\Omega): a(y(u), \varphi)=\int_{\Omega} f \varphi d \Omega+\int_{\partial \Omega}(g+u) \varphi d \gamma \quad \forall \varphi \in \mathscr{H}^{1}(\Omega)$ 。邻接问题仍由\ref{18.52} 给出，而产生最优控制的变分不等式是\ref{18.42} 的第三个。这个不等式的解释远非微不足道。如果我们选择

!!!!
(u, v)_{\mathscr{U}}=\int_{\partial \Omega}\left(-\Delta_{\partial \Omega}\right)^{-1 / 4} u\left(-\Delta_{\partial \Omega}\right)^{-1 / 4} v d \gamma=\int_{\partial \Omega}\left(-\Delta_{\partial \Omega}\right)^{-1 / 2} u v d \gamma
$$

作为$\mathscr{U}$中的标量积，其中$\Delta_{\partial \Omega}$是Laplace-Beltrami算子（例如，见[QV94]），可以证明\ref{18.42} 的第三个不等式等同于（见[Lio71，第一章，第2.4节]）。

!!!!
\int_{\partial \Omega}\left(p(u)_{\mid \partial \Omega}+\left(-\Delta_{\partial \Omega}\right)^{-1 / 2} N u\right)(v-u) d \gamma \geq 0 \quad \forall v \in \mathscr{U}_{a d}
$$

在表$18.1$和$18.2$中，我们总结了对刚才考虑的问题得出的主要结论。

Table 18.1. Summary of Dirichlet control problems

![](https://cdn.mathpix.com/snip/images/OQ-0ZURKZ32uxGdpxSwpLNesEJMz0_BJd5TioUI_E6Y.original.fullsize.png)
![](https://cdn.mathpix.com/snip/images/qbHfUzj8-whWxhbpLvheTinCYLba3ZBAUtTAySrVtnw.original.fullsize.png)





\subsection{Numerical tests}

在本节中，我们提出了一些解决$1 \mathrm{D}$最优控制问题的数值测试，与表$18.1$和18.2中总结的问题类似。我们推迟了unitil Sect.  $18.3$中对用于$y, p$和$u$近似的数值技术的描述。

对于所有的数值模拟，我们考虑域$\Omega=(0,1)$ ，一个简单的扩散反应算子$A$ 。

!!!!
A y=-\mu y^{\prime \prime}+\gamma y
$$

和表格中考虑的相同的成本函数，正则化系数为$v=10^{-2}$（除非另有说明）。我们通过片状线性有限元对状态和邻接问题进行离散，网格大小为$h=10^{-2}$；用于求解
 ![](https://cdn.mathpix.com/cropped/991f5db518e324d299c1ff4972bba9fb-142.jpg?height=280&width=710&top_left_y=114&top_left_x=100)

图18.3.案例D1。初始和最优状态变量及期望函数（左）；最优控制函数（右）。

表18.3.案例D1.迭代次数和对应于$v$不同值的最佳成本函数

\begin{tabular}{|c|c|c|c|c|c|c|c|c|c|c|c|c|c|c|c|c|c|c〗。}
\hline $v$ & $i t$ & $J$ & $v$ & $i t$ & $J$ & $v$ & $i t$ & $J$ №$J$
\$10^{-2}$ & 11 & $0.0202$ & $10^{-3}$ & 71 & $0.0047$ & $10^{-4}$ & 349 & $0.0011$ 。
\hline
\end{tabular}

在最小化问题上，我们使用共轭梯度法，加速参数$\tau^{k}$初始化为$\tau^{0}=\bar{\tau}$，然后在收敛需要时，在随后的每一步中减少2。这满足了阿米约规则（见第18.9节）。迭代方法的容忍度tol被固定为$10^{-3}$，其停止标准如下 $\left\|J^{\prime}\left(u^{k}\right)\right\|<\operatorname{Tol}\left\|J^{\prime}\left(u^{0}\right)\right\|$ 。

- 案例D1（表$18.1$左上角）：分布式控制和观测，有迪里希特边界条件。我们假设

!!!!
\mu=1, \quad \gamma=0, \quad f=1, \quad u^{0}=0, \quad z_{d}=\left\{\begin{array}{ll}
x & x \leq 0.5 \\
1-x & x>0.5
\end{array}, \quad \bar{\tau}=10\right.
$$

$u^{0}$的成本函数值是$J^{0}=0.0396$ 。经过11次迭代，我们得到了最佳成本函数 $J=0.0202$ 。在图18.3中，我们报告了初始和最优控制$u$的状态变量和期望函数$z_{d}$（左），以及最优控制函数（右）。

如表18.3所示，迭代次数随着$v$的减少而增加。在同一张表中，为了比较，我们还报告了在不同的$v$值下对应于$u$最优值的成本函数$J$的值。

在图$18.4$中，我们报告了在不同的$v$值下得到的最佳状态（左）和控制函数（右）。

- 案例D2（表$18.1$右上方）：分布式控制和边界观测，有迪里希特边界条件。我们考虑$\mu=1, \gamma=0, f=1, u^{0}=0$ ，而目标函数$z_{d}$是这样的：$z_{d}(0)=-1$和$z_{d}(1)=-4 ;$ 最后，$\bar{\tau}=0.1$ 。在初始步骤中，我们有$J=12.5401$，经过89次迭代后$J=0.04305$；我们可以
 ![](https://cdn.mathpix.com/cropped/991f5db518e324d299c1ff4972bba9fb-143.jpg?height=282&width=688&top_left_y=112&top_left_x=112)

图18.4.案例D1.最佳状态变量$y_{2}$（用于$\left.v=1 e-2\right), y_{3}$（用于$\left.v=1 e-3\right), y_{4}$（用于$v=1 e-4)$和期望函数$z_{d}$（左）；最佳控制$u_{2}$（用于$\left.v=1 e-2\right), u_{3}$（用于$\left.v=1 e-3\right)$ 、$u_{4}$（用于$\left.v=1 e-4\right)$ （右

![](https://cdn.mathpix.com/cropped/991f5db518e324d299c1ff4972bba9fb-143.jpg?height=277&width=340&top_left_y=502&top_left_x=94)
 ![](https://cdn.mathpix.com/cropped/991f5db518e324d299c1ff4972bba9fb-143.jpg?height=278&width=708&top_left_y=500&top_left_x=94)

观察状态变量的法向导数是如何 "接近 "期望值的 $\left.z_{d} \mid \mu \frac{\partial y}{\partial n}(0), \mu \frac{\partial y}{\partial n}(1)\right]=[-1.0511,-3.8695]$ 。在图$18.5$中，我们报告了初始和最优状态（左）以及相应的最优控制函数（右）。

- 案例D3（表$18.1$左下方）：边界控制和分布式观测，有迪里希特边界条件。我们考虑$\mu=1, \gamma=0, f=1$ ，初始控制$u^{0}$，以便$u^{0}(0)=u^{0}(1)=0, z_{d}=-1-3 x$和$\bar{\tau}=0.1$。初始函数值为 $J=0.4204$ ，经过55次迭代，我们有 $J=0.0364$ ，边界上的最优控制为 $[u(0), u(1)]=[0.6638,0.5541]$ 。在图18.6，左边，我们报告了初始和最终的状态变量以及期望的观察函数。

- 案例D4（表$18.1$右下方）：边界控制和观测，有迪里希特边界条件。我们假设 $\mu=1, \gamma=0, f=1$ ，初始控制 $u^{0}$ 这样 $u^{0}(0)=u^{0}(1)=0$ ，而目标函数 $z_{d}$ 是这样 $z_{d}(0)=-1$ 和 $z_{d}(1)=-4 ;$ 最后， $\bar{\tau}=0.1$ 。对于 $i t=0$ ，成本函数值为 $J=12.5401$ ，仅经过4次迭代 $J=8.0513$ ，边界上的最优控制为 $[u(0), u(1)]=[0.7481,-0.7481]$ 。在图18.6，右边，我们报告了状态变量。
 ![](https://cdn.mathpix.com/cropped/991f5db518e324d299c1ff4972bba9fb-144.jpg?height=276&width=704&top_left_y=114&top_left_x=94)

图18.6.左图：案例D3。初始和最优状态变量以及期望的观测函数。右边。案例D4。初始和最优状态变量

![](https://cdn.mathpix.com/cropped/991f5db518e324d299c1ff4972bba9fb-144.jpg?height=272&width=335&top_left_y=482&top_left_x=102)
 ![](https://cdn.mathpix.com/cropped/991f5db518e324d299c1ff4972bba9fb-144.jpg?height=276&width=710&top_left_y=478&top_left_x=102) control variable (right)

- 案例N1（表$18.2$左上角）：分布式控制和观察，有诺伊曼边界条件。我们考虑$\mu=1, \gamma=1, f=0, g=-1, u^{0}=0, z_{d}=1, \bar{\tau}=$ $0.1$ 。在初始步骤中，我们有 $J=9.0053$ ，经过18次迭代，成本函数值为 $J=0.0944$ 。在图$18.7$中，我们报告了诺伊曼问题的状态变量（左）和最终的最优控制（右）。

- 案例N2（表$18.2$右上方）：分布式控制和边界观测，有诺伊曼边界条件。我们考虑 $\mu=1, \gamma=1 f=0$ ，函数 $g$ 这样 $g(0)=-1$ 和 $g(1)=-4, u^{0}=0$ ，而目标函数 $z_{d}$ 是这样 $z_{d}(0)=z_{d}(1)=1 ;$ 最后， $\bar{\tau}=0.1$ 。对于 $i t=0, J=83.1329$ ，经过153次迭代 $J=0.6280$ ，边界上的最佳状态是 $[y(0), y(1)]=[1.1613,0.7750]$ 。在图$18.8$中，我们报告了状态变量（左）和最佳控制变量（右）。

- 案例N3（表$18.2$左下方）：边界控制和分布式观测，具有诺伊曼边界条件。我们假设 $\mu=1, \gamma=1, f=0$ ，初始控制 $u^{0}$ ，这样 $u^{0}(0)=u^{0}(1)=0, z_{d}=-1-3 x, \bar{\tau}=0.1$ 。初始成本函数值为$J=9.0053$ ，经过9次迭代后有$J=0.0461$ ，最优控制为
 ![](https://cdn.mathpix.com/cropped/991f5db518e324d299c1ff4972bba9fb-145.jpg?height=278&width=700&top_left_y=114&top_left_x=107)

图18.8.案例N2。初始和最优状态变量（左）；最优控制变量（右）。

![](https://cdn.mathpix.com/cropped/991f5db518e324d299c1ff4972bba9fb-145.jpg?height=278&width=342&top_left_y=517&top_left_x=109)
 ![](https://cdn.mathpix.com/cropped/991f5db518e324d299c1ff4972bba9fb-145.jpg?height=278&width=698&top_left_y=517&top_left_x=108) Right: Case N4. Initial and optimal state variables.

是$[u(0), u(1)]=[1.4910,1.4910]$。在图18.9的左边，我们报告了初始和最优控制$u$的状态变量，以及期望的观察函数。

- 案例N4（表$18.2$右下方）：边界控制和观察，有诺伊曼边界条件。我们考虑$\mu=1, \gamma=1, f=0, g$，如$g(0)=-1$和$g(1)=-4$，初始控制$u^{0}$如$u^{0}(0)=u^{0}(1)=0$，而目标函数$z_{d}$如$z_{d}(0)=z_{d}(1)=1 ;$，最后，$\bar{\tau}=0.1$ 。在初始步骤 $J=83.1329$ ，经过37次迭代 $J=0.2196$ ，最优控制为 $[u(0), u(1)]=[1.5817,4.3299]$ ，边界上的观察状态为 $[y(0), y(1)]=[1.0445,0.9282]$ 。在图18.9，右边，我们报告了初始和最优状态变量。

\subsection{Lagrangian formulation of control problems}

在本节中，我们提出了另一种解决最优控制问题的方法，基于拉格朗日乘数；这种方法更好地突出了邻接变量所发挥的作用。

\subsection{Constrained optimization in $\mathbb{R}^{n}$ }。

让我们从一个简单的例子开始，即$\mathbb{R}^{n}$中的约束性优化。给定两个函数$f, g \in C^{1}(X)$，其中$X$是$\mathbb{R}^{n}$中的一个开放集，我们寻找$f$的极值，约束其属于

!!!!
E_{0}=\left\{\mathbf{x} \in \mathbb{R}^{n}: g(\mathbf{x})=0\right\}
$$

为了简化论述，我们考虑的是约束$g$是一个标量函数的情况。我们给出正规点和约束临界点的以下定义。

在这些定义的基础上，以下结果成立。

![](https://cdn.mathpix.com/cropped/991f5db518e324d299c1ff4972bba9fb-146.jpg?height=132&width=719&top_left_y=867&top_left_x=97)

我们引入函数$\mathscr{L}: X \times \mathbb{R} \mapsto \mathbb{R}$ ，称为拉格朗日（或拉格朗日函数）。

!!!!
\mathscr{L}(\mathbf{x}, \lambda)=f(\mathbf{x})-\lambda g(\mathbf{x})
$$

从定理$18.4$中我们推断出，当且仅当$\left(\mathbf{x}_{0}, \lambda_{0}\right)$是$\mathscr{L}$的（自由）临界点时，$\mathbf{x}_{0}$是一个受限临界点。数字$\lambda_{0}$被称为拉格朗日乘数，可以和$\mathbf{x}_{0}$一起，通过解系统得到

!!!!
\nabla \mathscr{L}(\mathbf{x}, \lambda)=\mathbf{0}
$$

就是说

!!!!
\left\{\begin{array}{l}
\mathscr{L}_{\mathbf{x}}=\nabla f-\lambda \nabla g=\mathbf{0} \\
\mathscr{L}_{\lambda}=-g=0
\end{array}\right.
$$

\subsubsection{The solution approach based on the Lagrangian}

在本节中，我们将把第18.8.1节中发展的理论扩展到最优控制问题。在这种情况下，拉格朗日方法可以作为 "à la Lions "方法的替代品（例如，见[BKR00] ）。

它实际上是用来将基于后验误差估计的网格适应性技术与最优控制问题结合起来（见[BKR00, Ded04]）。

基于拉格朗日乘数的方法也被广泛用于解决形状优化问题，其中控制是由计算域的形状表示的。因此，最优控制函数$u$是一个定义在边界（或边界的一个子集）上的函数，它描述了从原始位置的最佳位移。有兴趣的读者可以参考，例如，[Jam88, MP01, SZ91]。

在第18.8.1节中，基于拉格朗日的方法允许确定带有约束条件$g$的函数$f$的极值。相反，在控制问题中，我们寻找一个满足最小化问题\ref{18.34} 的函数$u \in \mathscr{U}_{a d} \subset \mathscr{U}$，$y(u)$是状态方程\ref{18.28} 的解。通常，$A$是应用于状态变量的椭圆微分算子，而$B$是应用于状态方程中控制函数的算子。这个问题可以被看作是一个约束最小化问题，只要我们在成本函数$J$和第18.8.1节的函数$f$之间，在状态方程和约束方程$g=0$之间，以及最后在控制函数$u$和极值$\mathbf{x}$之间说明适当的对应关系。

为简单起见，我们假设 $\mathscr{U}_{a d}=\mathscr{U}$ 。关于更普遍的处理方法，见，例如 [Gun03] 。

因此，最佳控制问题的解决可以被视为寻找以下拉格朗日函数的（无约束）临界 "点"。

!!!!
\mathscr{L}(y, p, u)=J(y(u), u)+\mathscr{v}\langle p, f+B u-A y(u)\rangle_{\mathscr{V}^{\prime}}
\label{18.55}\end{equation}

其中$p$是拉格朗日乘数。在这个框架中，（无约束的）临界点由函数$y, p$和$u$表示。因此，问题变成了

找到$(y, p, u) \in \mathscr{V} \times \mathscr{V} \times \mathscr{U}: \nabla \mathscr{L}(y, p, u)[(\psi, \varphi, \phi)]=0 \quad \forall(\psi, \varphi, \phi) \in \mathscr{V} \times \mathscr{V} \times \mathscr{U}

就是说

!!!!
\begin{cases}\mathscr{L}_{p}(y, p, u)[\psi]=0 & \forall \psi \in \mathscr{V} \\ \mathscr{L}_{y}(y, p, u)[\varphi]=0 & \forall \varphi \in \mathscr{V} \\ \mathscr{L}_{u}(y, p, u)[\phi]=0 & \forall \phi \in \mathscr{U}\end{cases}
\label{18.56}\end{equation}

我们用简略的符号$\mathscr{L}_{y}$来表示$\mathscr{L}$相对于$y$的Gâteaux导数（见定义2.6）。符号$\mathscr{L}_{p}$和$\mathscr{L}_{u}$有类似的含义。现在考虑一个具有两个线性算子$A$和$B$的椭圆型状态方程作为例子，我们以弱形式重写\ref{18.29} ；给定$u \in \mathscr{U}$和$f \in \mathscr{H}$ 。

!!!!
\text { find } y=y(u) \in \mathscr{V}: a(y, \varphi)=(f, \varphi)+b(u, \varphi) \quad \forall \varphi \in \mathscr{V}
\label{18.57}\end{equation}

双线性形式$a(\cdot, \cdot)$与算子$A, b(\cdot, \cdot)$与$B$有关。要最小化的成本函数可以表示为

!!!!
J(y(u), u)=\left\|C y(u)-z_{d}\right\|^{2}+n(u, u)
\label{18.58}\end{equation}

其中$C$是将状态变量映射到观测函数空间$\mathscr{Z}$的算子，$z_{d}$是目标观测，$n(\cdot, \cdot)$是与$N$相关的对称双线性形式。到目前为止，没有对边界条件、控制的种类（分布式或边界上的控制）或观察的种类做出假设。这样做的目的是为了考虑一个非常普遍的框架。在弱形式下，$(18.55)$成为

!!!!
\mathscr{L}(y, p, u)=J(y(u), u)+b(u, p)+(f, p)-a(y, p)
$$

自

!!!!
\begin{cases}\mathscr{L}_{p}(y, p, u)[\varphi]=(f, \varphi)+b(u, \varphi)-a(y, \varphi) & \forall \varphi \in \mathscr{V} \\ \mathscr{L}_{y}(y, p, u)[\psi]=2\left(C y-z_{d}, C \psi\right)-a(\psi, p) & \forall \psi \in \mathscr{V} \\ \mathscr{L}_{u}(y, p, u)[\phi]=b(\phi, p)+2 n(u, \phi) \quad \forall \phi \in \mathscr{U}\end{cases}
\label{18.59}\end{equation}

\ref{18.56}，得到最优性系统

!!!!
\begin{cases}y \in \mathscr{V}: a(y, \varphi)=b(u, \varphi)+(f, \varphi) & \forall \varphi \in \mathscr{V} \\ p \in \mathscr{V}: a(\psi, p)=2\left(C y-z_{d}, C \psi\right) & \forall \psi \in \mathscr{V} \\ u \in \mathscr{U}: b(\phi, p)+2 n(u, \phi)=0 & \forall \phi \in \mathscr{U}\end{cases}
\label{18.60}\end{equation}

值得注意的是，在将$p$重新缩放为$\tilde{p}=p / 2$后，从\ref{18.60} 得到的变量$(y, \tilde{p}, u)$实际上满足在Lions方法框架中得到的系统\ref{18.43} 。请注意，$\mathscr{L}_{p}$的消失产生状态方程（弱形式），$\mathscr{L}_{y}$的消失产生拉格朗日乘子的方程（可与邻接方程相识别），$\mathscr{L}_{u}$的消失产生所谓的敏感性方程，表达实现最优的条件。邻接变量，即拉格朗日乘数，与成本函数J对观察函数变化的敏感性有关，因此也与控制的变化有关 $u$ 。

根据我们在第2.2节中所看到的，用成本函数$J$相对于$u$,\ref{18.60}的导数来表达拉格朗日$\mathscr{L}_{u}$的Gâteaux导数非常有用。这种对应关系是由里兹表示定理（见定理2.1）保证的。事实上，由于$\mathscr{L}_{u}[\phi]$是一个线性有界函数，而$\phi$属于希尔伯特空间$\mathscr{U}$，我们可以逐案计算$J^{\prime}$，也就是说，从\ref{18.59} 的第三条，以及从\ref{18.45}开始

!!!!
\mathscr{L}_{u}[\phi]=\left(J^{\prime}(u), \phi\right)_{\mathscr{U}}=b(\phi, p)+2 n(u, \phi)
$$

值得注意的是，邻接方程是如何产生的。根据Lions的理论，邻接方程是基于使用邻接算子（见方程\ref{18.39} ），而当使用基于拉格朗日的方法时，我们通过对状态变量微分$\mathscr{L}$来获得它。当对最优控制$p(u)$进行计算时，邻接变量$u$与拉格朗日乘数相对应。一般来说，Lions方法和基于使用拉格朗日的方法并不导致相同的邻接问题定义，因此它们产生的数值方法可能表现得不同。因此，为了正确解决最优控制问题，必须与我们正在考虑的那种方法保持一致。另一个关键问题是邻接问题的边界条件的推导；两种不同的方法可能导致不同类型的边界条件。特别是，基于拉格朗日的方法会自动产生邻接问题的边界条件，而另一种方法则不是这样的。

\subsection{Iterative solution of the optimal control problem}

对于最优控制问题的数值解决，可以采用两种不同的范式。

- 先优化后离散：我们首先应用迭代方法，然后对算法的各个步骤进行离散，或

- 离散--然后--优化：我们首先将我们的最优控制问题离散化，然后应用迭代算法来解决其离散版本。

这一讨论将推迟到第18.12节。在这一节中，我们说明了如何使用迭代算法来生成一个希望收敛到最优控制函数的序列 $u$ 。

如前所述，一个最优控制问题可以根据Lions方法制定，产生方程组\ref{18.43} ，或者通过拉格朗日，在这种情况下，要解决的方程是\ref{18.60} 。无论哪种情况，我们最终都会得到一个由以下内容组成的优化系统。

i）状态方程。

ii) 毗连方程。

iii）表达优化条件的方程。

特别是，第三个方程与成本函数的变化有关，在Lions方法中是明确的，在使用Lagrangian方法时是隐含的（通过Riesz表示定理）。事实上，在前面研究的线性椭圆方程的情况下，我们分别得到了

- $\frac{1}{2} J^{\prime}(u)=B^{\prime} p(u)+\Lambda_{\mathscr{U}} N u

- $\mathscr{L}_{u}[\phi]=b(\phi, p)+2 n(u, \phi) \quad \forall \phi \in \mathscr{U}

为了简化我们的符号，在本节的其余部分，我们将使用符号$J^{\prime}$不仅表示成本函数的导数，还表示拉格朗日的导数$\mathscr{L}_{u}[\phi]$。在控制区域$(\Omega, \Gamma,$的某一点（或其子集之一）对$J^{\prime}$的评估提供了成本函数$J$（在该点）对控制函数$u$变化的敏感性。否则，控制的无限小的变化$\delta u$关于一个给定的值$u$，意味着，直到高阶的无限小，成本函数的变化$\delta J$是与$J^{\prime}(u)$成比例的。这表明可以使用以下最陡峭下降迭代算法。如果$u^{k}$表示控制函数在步骤$k$的值，那么在下一步骤$k+1$的控制函数可以通过以下方式获得

!!!!
u^{k+1}=u^{k}-\tau^{k} J^{\prime}\left(u^{k}\right)
\label{18.61}\end{equation}

其中$J^{\prime}$代表下降方向，$\tau^{k}$是加速参数。尽管不一定是最有效的，但选择\ref{18.61} 对于理解$J^{\prime}$以及邻接变量$p$的作用在教学上是有用的。因此，可以用下面的迭代算法来设计一种搜索最优控制的方法。

1. 通过两种方法（Lions或Lagrangian）中的任何一种，找到邻接方程和导数$J^{\prime}$的表达。

2. 提供控制功能$u^{0}$的初始猜测 $u$ 。

3. 用上述猜测求解$y$中的状态方程。

4. 知道状态变量和观测目标$z_{d}$，评估成本函数J。

5. 求解$p$的邻接方程，知道$y$和$z_{d}$ 。

6. 知道邻接变量，计算$J^{\prime}$ 。

7. 如果所选择的停止测试得到满足（达到一个给定的公差），则退出（跳到第10点），否则继续。

8. 计算用于加速迭代算法的参数（例如$\tau^{k}$）。

9. 计算新的控制函数，例如通过方程\ref{18.61} ，并返回到点3。

10. 取最后一个计算的变量来生成 "收敛 "的未知数 $u, y$ 和 $p$ 。


![](https://cdn.mathpix.com/snip/images/4rFSF6hJGSdWUW253DtwnnyLJZ9JKPAVaFmpGgORXzU.original.fullsize.png)
在图$18.10$中，我们显示了一个说明上述算法的流程图。

备注18.4。一个方便的停止测试可以建立在对观察变量$z$和（期望的）目标观察$z_{d}$之间距离的测量上，在一个合适的准则下，比如说

!!!!
\left\|z^{k}-z_{d}\right\|_{\mathscr{Z}} \leq \text { Tol. }
$$

然而，在一般情况下，这并不能保证$J\left(u^{k}\right) \rightarrow 0$如$k \rightarrow \infty$。也就是说，$J$可能不会收敛到0。一个不同的停止标准是基于对成本函数的导数的评估

!!!!
\left\|J^{\prime}\left(u^{k}\right)\right\|_{\mathscr{U}^{\prime}} \leq \text { Tol } .
$$

相对于初始控制上的||$J^{\prime}\left(u^{0}\right) \|$值和我们想要实现的目标观测的接近程度，公差的值必须足够小。

![](https://cdn.mathpix.com/cropped/991f5db518e324d299c1ff4972bba9fb-151.jpg?height=689&width=371&top_left_y=112&top_left_x=271)

图 18.10.解决最优控制问题的可能迭代算法的流程图

备注18.5。邻接变量是在整个计算域上定义的。对于$J^{\prime}(u)$的评估，有必要将邻接变量$p$限制在控制函数$u$所定义的域的那部分或其边界上。参见表$18.1$和$18.2$的几个例子。

血统迭代法需要确定一个合适的参数 $\tau^{k}$ 。后者应保证成本函数收敛到其最小值

!!!!
J_{*}=\inf _{u \in \mathscr{Y}} J(u) \geq 0
$$

是单调的，即

!!!!
J\left(u^{k}-\tau^{k} J^{\prime}\left(u^{k}\right)\right)<J\left(u^{k}\right)
$$

在那些已知$J_{*}$值的情况下（例如$J_{*}=0$），那么可以按以下方式选择参数（见，例如[Ago03]和[Vas81] )

!!!!
\tau^{k}=\frac{\left(J\left(u^{k}\right)-J_{*}\right)}{\left\|J^{\prime}\left(u^{k}\right)\right\|_{\mathscr{U}^{\prime}}^{2}}
\label{18.62}\end{equation}

作为一个例子，考虑以下控制问题

!!!!
\left\{\begin{array}{l}
A y=f+B u \\
\inf J(u), \quad \text { where } J(u)=v\|u\|_{\mathscr{U}}^{2}+\left\|C y-z_{d}\right\|_{\mathscr{Z}}^{2}, \quad v \geq 0
\end{array}\right.
$$

前面的迭代方法变成了。

!!!!
\left\{\begin{array}{l}
A y^{k}=f+B u^{k} \\
A^{*} p^{k}=C^{\prime}\left(C y^{k}-z_{d}\right) \\
u^{k+1}=u^{k}-\tau^{k} 2\left(v u^{k}+B^{\prime} p^{k}\right)
\end{array}\right.
$$

如果$\operatorname{Ker}\left(B^{\prime} A^{*-1} C^{\prime}\right)=\{0\}$这个问题有解，而且$J(u) \rightarrow 0$如果$v \rightarrow 0$因此，如果$v \simeq 0^{+}$我们可以假设$J_{*} \simeq 0$，由此，由于\ref{18.62}。

!!!!
\tau^{k}=\frac{J\left(u^{k}\right)}{\left\|J^{\prime}\left(u^{k}\right)\right\|_{\mathscr{U}^{\prime}}^{2}}=\frac{v\left\|u^{k}\right\|_{\mathscr{\mathscr}}^{2}+\left\|C y^{k}-z_{d}\right\|_{\mathscr{\mathscr { Z }}}^{2}}{\left\|2 v u^{k}+B^{\prime} p^{k}\right\|_{\mathscr{U}^{\prime}}^{2}}
\label{18.63}\end{equation}

当考虑离散化的最优控制问题时，例如使用Galerkin-finite element方法，正如我们将在第18.12节中看到的，不是寻找$J(u)$的最小值，而是寻找$J: \mathscr{U} \mapsto \mathbb{R}$的最小值，其中$J: \mathbb{R}^{n} \mapsto \mathbb{R}$和$\mathbf{u} \in \mathbb{R}^{n}$是其组成部分为控制的节点值的向量$u \in \mathscr{U}$。我们将在本节的其余部分做出这一假设。

如前所述，最陡峭下降法\ref{18.61} 是可用于解决最优控制问题的几种迭代算法之一。事实上，这种方法是梯度法的一个特例。

!!!!
\mathbf{u}^{k+1}=\mathbf{u}^{k}+\tau^{k} \mathbf{d}^{k}
\label{18.64}\end{equation}

其中$\mathbf{d}^{k}$代表一个下降方向，即一个满足以下条件的向量

!!!!
\mathbf{d}^{k^{T}} \cdot J^{\prime}\left(\mathbf{u}^{k}\right)<0 \quad \text { if } \nabla J\left(\mathbf{u}^{k}\right) \neq \mathbf{0}
$$

根据选择$\mathbf{d}^{k}$的标准，我们得到几个特殊情况。

- 牛顿法，对于该方法

!!!!
\mathbf{d}^{k}=-H\left(\mathbf{u}^{k}\right)^{-1} \nabla J\left(\mathbf{u}^{k}\right)
$$

其中$H\left(\mathbf{u}^{k}\right)$是在$\mathbf{u}=\mathbf{u}^{k}$计算的$J(\mathbf{u})$的Hessian矩阵。

!!!!
\mathbf{d}^{k}=-B_{k} \nabla J\left(\mathbf{u}^{k}\right)
$$

其中$B_{k}$是$H\left(\mathbf{u}^{k}\right)$的逆的近似值。

- 共轭梯度法，对于该方法

!!!!
\mathbf{d}^{k}=-\nabla J\left(\mathbf{u}^{k}\right)+\beta_{k} \mathbf{d}^{k-1}
$$

其中$\beta_{k}$是一个标量，将以这样的方式选择$\mathbf{d}^{k^{T}} \mathbf{d}^{k-1}=0$ 。(参见第7章)。

一旦$\mathbf{d}^{k}$被计算出来，参数$\tau^{k}$的选择就应该保证单调性属性

!!!!
J\left(\mathbf{u}^{k}+\tau^{k} \mathbf{d}^{k}\right)<J\left(\mathbf{u}^{k}\right)
\label{18.65}\end{equation}

一个更严格的要求是要解决以下标量最小化问题

!!!!
\text { find } \tau^{k}: \phi\left(\tau^{k}\right)=J\left(\mathbf{u}^{k}+\tau^{k} \mathbf{d}^{k}\right) \text { minimum; }
$$

这将保证以下正交属性

!!!!
\mathbf{d}^{k^{T}} \cdot \nabla J\left(\mathbf{u}^{k}\right)=0
$$

通常，$\tau^{k}$的计算是基于启发式方法的。一种方法是从一个相对较大的参数$\tau^{k}$值开始，然后将其减半，直到\ref{18.65}被验证。然而，这种方法并不总是成功的。因此，我们的想法是在选择$\tau^{k}$时采用比\ref{18.65}更严格的标准，目的是一方面实现高收敛率，另一方面避免步长过小。第一个目标是通过以下要求实现的

!!!!
J\left(\mathbf{u}^{k}\right)-J\left(\mathbf{u}^{k}+\tau^{k} \mathbf{d}^{k}\right) \geq-\sigma \tau^{k} \mathbf{d}^{k^{T}} \cdot \nabla J\left(\mathbf{u}^{k}\right)
\label{18.66}\end{equation}

对于一个合适的$\sigma \in(0,1 / 2)$。这个不等式确保$J$在$\mathbf{u}^{k+1}$处沿$\mathbf{d}^{k}$方向的平均下降率至少等于$\mathbf{u}^{k}$处初始下降率的一个特定分数。另一方面，通过要求以下几点来避免过小的步骤

!!!!
\left|\mathbf{d}^{k^{T}} \cdot \nabla J\left(\mathbf{u}^{k}+\tau^{k} \mathbf{d}^{k}\right)\right| \leq \beta\left|\mathbf{d}^{k^{T}} \cdot \nabla J\left(\mathbf{u}^{k}\right)\right|
\label{18.67}\end{equation}

对于一个合适的$\beta \in(\sigma, 1)$，所以要保证\ref{18.66} 也被满足。在实践中，$\sigma \in\left[10^{-5}, 10^{-1}\right]$ 和$\beta \in\left[10^{-1}, 1 / 2\right]$ 。对于$\tau^{k}$的选择，可以选择几个符合条件\ref{18.66} 和\ref{18.67} 的策略。一个流行的策略是基于Armijo公式（例如，见[MP01]）：对于固定的$\sigma \in(0,1 / 2), \beta \in(0,1)$和$\bar{\tau}>0$，我们选择$\tau^{k}=\beta^{m_{k}} \bar{\tau}, m_{k}$作为满足\ref{18.66} 的第一个非负整数。我们甚至可以用$\tau^{k}=\bar{\tau}$来代替所有的$k$，至少在那些成本函数$J$的评估是非常复杂的情况下。

关于这个问题的更全面的讨论，请参见，例如[GMSW89, KPTZ00, MP01, NW06]。

\subsection{Numerical examples}

在这一节中，我们说明了两个受现实应用启发的控制问题的例子。这两个问题都是通过第18.8.2节中概述的拉格朗日方法来分析的；为了简单起见，最佳控制函数实际上是一个标量值。

\subsubsection{Heat dissipation by a thermal fin}

散热片是用来驱散一些设备产生的热量，目的是将其温度保持在某些极限值以下。通常情况下，它们用于电子装置，如晶体管；当活动时，并取决于电功率，当工作温度上升时，后者可能会产生更高频率的故障。这代表了设计耗散器时的一个主要问题，耗散器通常与风扇结合使用，能够通过强制对流大大改善热耗散，从而控制设备的温度。关于进一步的细节，我们请读者参考[Ç07]；关于参数化问题领域的另一个例子，见[OP07] 。

在我们的例子中，我们的目的是调节与风扇相关的强制对流的强度，以保持晶体管的温度尽可能接近一个理想值。控制由强制对流的标量系数表示，而观察是与晶体管接触的散热片边界上的温度。

让我们考虑以下状态问题，其解$y$（以开尔文度为单位$[K]$）代表散热片的温度

!!!!
\begin{cases}-\nabla \cdot(k \nabla y)=0 & \text { in } \Omega \\ -k \frac{\partial y}{\partial n}=-q & \text { on } \Gamma_{N} \\ -k \frac{\partial y}{\partial n}=(h+U)\left(y-y_{\infty}\right) & \text { on } \Gamma_{R}=\partial \Omega \backslash \Gamma_{N}\end{cases}
\label{18.68}\end{equation}

其中域$\Omega$和其边界在图18.11中报告。系数$k$ $([W /(m m K)])$代表热导率（本例中考虑铝），而$h$和$U$（我们的控制变量）分别为自然和强制对流系数$\left(\left[W /\left(m m^{2} K\right)\right]\right)$。让我们注意，当风扇活动时，$U$的值大于零；如果$U=0$的散热只是由于自然对流。温度$y_{\infty}$对应于远离散热器的空气温度，而$q\left(\left[W / m m^{2}\right]\right)$是晶体管发出的、通过边界$\Gamma_{N}$进入散热片的单位面积热量。

问题\ref{18.68} 的弱形式为，对于一个给定的$U \in \mathscr{U}=\mathbb{R}$，读作

!!!!
\text { find } y \in \mathscr{V}: a(y, \varphi ; U)=b(U, \varphi) \quad \forall \varphi \in \mathscr{V},
\label{18.69}\end{equation}

其中$\mathscr{V}=H^{1}(\Omega), a(\varphi, \psi ; \phi)=\int_{\Omega} k \nabla \varphi \cdot \nabla \psi d \Omega+\int_{\Gamma_{R}}(h+\phi) \varphi \psi d \gamma$和$b(\phi, \psi)=$ $\int_{\Gamma_{R}}(h+\phi) y_{\infty} \psi d \gamma+\int_{\Gamma_{N}} q \psi d \gamma$ 。Robin-Neumann问题\ref{18.69} 的解的存在性和唯一性由Peetre-Tartar定理保证（见备注3.5）。

![](https://cdn.mathpix.com/cropped/991f5db518e324d299c1ff4972bba9fb-155.jpg?height=263&width=337&top_left_y=112&top_left_x=288)

图18.11.热鳍：计算域；单位为$\mathrm{mm}$。

最佳控制问题包括找到强制对流系数$U$的值，使以下成本函数$J(y, U)$最小，$y \in \mathscr{V}$是\ref{18.69}的解。

!!!!
J(y, U)=v_{1} \int_{\Gamma_{N}}\left(y-z_{d}\right)^{2} d \gamma+v_{2} U^{2}
\label{18.70}\end{equation}

这导致保持晶体管的温度尽可能地接近所需的值 $z_{d}([K])$ 和强制对流系数接近零，这取决于系数 $v_{2}>0 ;$ 的值，特别是我们假设 $v_{1}=1 / \int_{\Gamma_{N}} z_{d}^{2} d \gamma$ 和 $v_{2}=v_{2}^{0} / h^{2}$ ，对于一个合适的 $v_{2}^{0}$ 问题的分析是通过拉格朗日函数 $\mathscr{L}(y, p, U)=J(y, U)+b(p ; U)-a(y, p ; U)$ 进行的。特别是，对于给定的$U \in \mathbb{R}$和相应的$y=!!!!y(U) \in \mathscr{V}$，我们通过对$\mathscr{L}(\cdot)$的微分得到以下邻接方程

!!!!
\text { find } p \in \mathscr{V} \quad: a(\psi, p ; U)=c(y, \psi) \quad \forall \psi \in \mathscr{V},
\label{18.71}\end{equation}

其中$c(\varphi, \psi)=2 v_{1} \int_{\Gamma_{N}}\left(\varphi-z_{d}\right) \psi d \gamma$ 。同样，从最优性条件中我们推导出

!!!!
J^{\prime}(U)=2 v_{2} U-\int_{\Gamma_{R}}\left(y(U)-y_{\infty}\right) p(U) d \gamma
\label{18.72}\end{equation}

我们现在假设 $k=2.20 W /(m m K), h=15.0 \cdot 10^{-6} W /\left(m m^{2} K\right), y_{\infty}=298.15 K$ $\left(=25^{\circ} \mathrm{C}\right), z_{d}=353.15 \mathrm{~K}\left(=80{ }^{\circ} \mathrm{C}\right)$ 和 $v_{2}^{0}=10^{-3}$ 。该问题是通过有限元方法解决的，在具有1608个元素和934个自由度的三角形网格上使用片状二次方基函数。最陡峭的下降迭代法被用于优化$\tau^{k}=\tau=10^{-9}$（见\ref{18.61} ）；当$\left|J^{\prime}\left(U^{k}\right)\right| /\left|J^{\prime}\left(U^{0}\right)\right|<t o l=10^{-6}$时，迭代程序停止。在初始步骤中，我们考虑用自然对流来散热，这样$U=0.0$，与之对应的是一个成本函数$J=0.0377$ 。经过132次迭代后达到最佳，得到强制对流系数的最佳值的最佳成本函数 $J=0.00132$ 。理想情况下，风扇的设计应该保证强制对流系数的这个值。在图中 $18.12$ 。
 ![](https://cdn.mathpix.com/cropped/991f5db518e324d299c1ff4972bba9fb-156.jpg?height=208&width=722&top_left_y=113&top_left_x=95)

图18.12.热翅：初始阶段（自然对流）（左）和最佳阶段（右）的状态解（温度$\left[{ }^{\circ} \mathrm{C}\right]$）。

我们显示初始步骤的状态解和最佳状态的解；我们观察到$\Gamma_{N}$上的温度不等于$z_{d}$，因为$v_{2}^{0} \neq 0$。

\subsubsection{Thermal pollution in a river}

工业活动往往与污染现象有关，在设计新工厂或规划其运作时需要适当考虑。在这一领域，热污染往往会影响到河流或用于冷却工业厂房产生的热液的渠道，从而影响到重要的动植物。

在这种情况下，目标可能包括调节河流分支的热量排放，以保持河流的温度接近所需的阈值，而不严重影响工厂的理想热量排放率。

我们引入以下状态问题，其解$y$代表所考虑的河流的渠道和分支的温度

!!!!
\begin{cases}\nabla \cdot(-k \nabla y+\mathbf{V} y)=f \chi_{1}+U \chi_{2} & \text { in } \Omega \\ y=0 & \text { on } \Gamma_{I N} \\ (-k \nabla y+\mathbf{V} y) \cdot \mathbf{n}=0 & \text { on } \Gamma_{N}\end{cases}
\label{18.73}\end{equation}

域$\Omega$和边界$\Gamma_{I N}$在图18.13中表示，而$\Gamma_{N}=\partial \Omega \backslash \Gamma_{I N}$（注意，图18.13中显示的流出边界$\Gamma_{O U T}$是$\Gamma_{N}$的一部分）。  $\chi_{1}, \chi_{2}$和$\chi_{O B S}$分别代表子域$\Omega_{1}, \Omega_{2}$和$\Omega_{O B S}$的特征函数。在这个测试案例中，考虑了无尺寸的量。系数$k$是热扩散系数，它也是对湍流现象扩散的贡献，而$\mathbf{V}$是描述域$\Omega$中水的运动的平流场（我们在后面评论找到它的方法）。源项$f \in \mathbb{R}$和控制项$U \in \mathscr{U}=\mathbb{R}$代表两个工业工厂的热排放率；$f$是给定的，而$U$必须根据最优控制问题的解决方案来决定。特别是，我们希望最小化以下成本函数

!!!!
J(y, U)=\int_{\Omega_{O B S}}\left(y-z_{d}\right)^{2} d \Omega+v\left(U-U_{d}\right)^{2}
\label{18.74}\end{equation}



![](https://cdn.mathpix.com/cropped/991f5db518e324d299c1ff4972bba9fb-157.jpg?height=266&width=517&top_left_y=112&top_left_x=198)

图18.13.河流中的污染：计算域

其中$z_{d}$是$\Omega_{O B S}, U_{d}$中的理想温度，$v>0$是方便选择的理想热发射率。

最佳控制问题是通过拉格朗日方法设置的。为此，\ref{18.73}以弱形式重写，对于一个给定的$U$，为

!!!!
\text { find } y \in \mathscr{V}: a(y, \varphi)=b(U, \varphi) \quad \forall \varphi \in \mathscr{V}
\label{18.75}\end{equation}

其中$\mathscr{V}=H_{\Gamma_{N}}^{1}(\Omega), a(\varphi, \psi)=\int_{\Omega} k \nabla \varphi \cdot \nabla \psi d \Omega$和$b(U, \psi)=f \int_{\Omega_{1}} \psi d \Omega+$ $U \int_{\Omega}, \psi d \Omega$ 。问题\ref{18.75}的解的存在性和唯一性可以通过在第1节中指出的步骤来证明。  $3.4$ .

拉格朗日函数是 $\mathscr{L}(y, p, U)=J(y, U)+b(U, p)-a(y, p)$ 。将$\mathscr{L}(\cdot)$在$y \in \mathscr{V}$中微分，我们得到邻接方程

!!!!
\text { find } p \in \mathscr{V}: a(\psi, p)=c(y, \psi) \quad \forall \psi \in \mathscr{V},
\label{18.76}\end{equation}

其中$c(\varphi, \psi)=2 \int_{\Omega_{O B S}}\left(\varphi-z_{d}\right) \psi d \Omega$ 。同样地，我们推导出成本函数的以下导数

!!!!
J^{\prime}(U)=2 v\left(U-U_{d}\right)+\int_{\Omega_{2}} p(U) d \Omega
\label{18.77}\end{equation}

我们现在假设$k=0.01, f=10.0, z_{d}=0$和$U_{d}=f$ 。平流场$\mathbf{V}$是通过求解域$\Omega$中的纳维-斯托克斯方程（见第17章）推导出来的，边界条件如下：在$\Gamma_{I N}$上，规定了速度的抛物线轮廓，最大速度等于1。$\Gamma_{I N}$上规定了速度的抛物线，最大速度等于1；在$\Gamma_{O U T}$上假定法线方向上没有应力条件，同时规定了滑移条件$\mathbf{V} \cdot \mathbf{n}=0 ;$，最后在$\partial \Omega \backslash\left(\Gamma_{I N} \cup \Gamma_{O U T}\right)$上规定了无滑移条件。符号是图18.13中显示的符号。雷诺数等于$\mathbb{R} e=500$ 。纳维-斯托克斯问题通过Taylor-Hood$\mathbb{P}^{2}-\mathbb{P}^{1}$（见第17.4节）对有限元进行求解，网格由32248个三角形和15989个节点组成。在图$18.14$中，我们报告了平流场的强度$\mathbf{V}$和相应的流线。

最佳控制问题是通过有限元方法解决的，该方法在一个具有32812个元素和16771个度的三角形网格上具有$\mathbb{P}^{2}$的基础函数。
 ![](https://cdn.mathpix.com/cropped/991f5db518e324d299c1ff4972bba9fb-158.jpg?height=118&width=702&top_left_y=113&top_left_x=102)

图 18.14.河流中的污染：平流场的强度$\mathbf{V}$，模数（左）和流线（右）。

![](https://cdn.mathpix.com/cropped/991f5db518e324d299c1ff4972bba9fb-158.jpg?height=112&width=298&top_left_y=316&top_left_x=103)
 ![](https://cdn.mathpix.com/cropped/991f5db518e324d299c1ff4972bba9fb-158.jpg?height=112&width=708&top_left_y=316&top_left_x=102) and at the optimum (right)

我们选择$\tau^{k}=\tau=5$（见\ref{18.61} ），停止的标准是$\left|J^{\prime}\left(U^{k}\right)\right| /\left|J^{\prime}\left(U^{0}\right)\right|<$ tol $=10^{-6}$ 。通过解纳维-斯托克斯方程得到的平流场$\mathbf{V}$在这个新网格上插值。在初始步骤中，我们假设$U=U_{d}$ ，从而得到一个成本函数$J=1.884$ 。15次迭代后得到最优解，相应的最优成本函数为$J=1.817$，得到的最优热排放率为$U=6.685$ 。在实践中，为了保持$\Omega_{O B S}$的温度较低，应该减少$\Omega_{2}$中工厂的热量。在图18.15中，我们报告了优化前后的状态解决方案$y$（温度）。

\subsection{A few considerations about observability and controllability}

对于我们正在解决的那种最优控制问题，特别是对于我们正在观察哪种变量$z$，以及我们正在使用哪种控制函数$u$，可以对迭代方法的行为进行一些考虑。简而言之，关于可观察性和可控制性之间的关系。我们警告读者，我们将要得出的结论没有一般理论的支持，也不适用于任何一种数值离散化方法。

- 在这里我们观察到。一般来说，基于分布在域中的观察变量的最优控制问题比观察变量集中在域边界上的问题享有更高的收敛率。

- 我们控制的地方。一般来说，如果控制函数也分布在域中（作为状态方程的源项，或作为支配状态方程的微分算子的系数），而不是集中在域的边界上，那么优化过程会更加稳健。更确切地说，分布式控制问题的收敛率更高，对加速参数选择的敏感性低于边界控制问题，当然，前提是所有其他参数都相同。

- 我们观察到的东西。同时，我们观察的变量种类也会影响迭代方案的收敛行为。例如，观察状态变量不如观察它的梯度或它的一些高阶导数来得关键。后一种情况发生在流体动力学问题中，例如，对于势能问题，我们观察速度场，对于纳维-斯托克斯方程，我们观察流体涡度或其应力。

- 形状优化。形状优化问题是一类特殊的优化控制问题：事实上，在这种情况下，控制函数不仅在边界上，它是$t$边界本身。要最小化的成本函数被称为形状函数，因为它取决于域本身。我们要寻找

!!!!
J\left(\Omega_{o p t}\right) \leq J(\Omega) \quad \forall \Omega \in \mathscr{D}_{a d}
$$

其中$\mathscr{D}_{a d}$是一个可接受域的集合。形状优化问题在理论上难以分析，在数值上难以解决。数值网格在每次迭代时都需要改变。此外，除非施加额外的几何约束，否则在迭代过程中可能会产生不允许的边界形状。此外，在特别复杂的问题中，可能需要特殊的稳定化和正则化技术来防止数值震荡。更为普遍的是，形状优化问题对表征控制问题的各种参数的变化更为敏感。

- 邻接问题和状态问题。对于像本章所考虑的稳态椭圆问题，使用邻接问题可以在与状态问题相同的计算成本下提供代价函数的梯度。这种方法可以被认为是对那些基于成本函数的不精确或自动微分的方法的一种替代。在形状优化问题的情况下，与基于形状敏感性分析的方法相比，使用邻接问题可以节省计算量，因为后者取决于表征形状（控制点）的参数的数量（通常令人望而却步）。例如，见 [KAJ02] 。

\subsection{Two alternative paradigms for numerical approximation}

让我们首先考虑一个简单的例子，说明在数值解决最优控制问题时出现的一些额外困难。关于最优控制问题的数值离散化的更深刻的分析，请看，例如，[FCZ03, Gun03]。再考虑一下状态方程\ref{18.1} 和最优控制问题

!!!!
\begin{gathered}
\text { "find } u \in \mathscr{U}_{a d} \text { such that } \\
J(u) \leq J(v) \quad \forall v \in \mathscr{U}_{a d}
\end{gathered}
\label{18.78}\end{equation}

!!!!
\text { where } J \text { is a given cost functional". }
$$

问题是："这个问题如何方便地进行近似？"正如在本节开始时已经预料到的那样。  $18.8$，至少可以采取两种替代策略。

1) Discretize-then-optimize

根据这一策略，我们首先用有限维空间$\mathscr{U}_{a d}$离散控制空间$\mathscr{U}_{a d, h}$，用离散方程\ref{18.1} 简写为

!!!!
A_{h} y_{h}\left(u_{h}\right)=f_{h} \text {. }
\label{18.79}\end{equation}

在有限元背景下，参数$h$表示有限元网格大小。我们假设每个 "可接受的 "离散控制$y_{h}\left(v_{h}\right)$都存在一个 "离散状态"$v_{h} \in \mathscr{U}_{a d, h}$。

在这个阶段，我们要寻找一个离散的最优控制，即一个函数$u_{h} \in \mathscr{U}_{a d, h}$，使得

!!!!
J\left(u_{h}\right) \leq J\left(v_{h}\right) \quad \forall v_{h} \in \mathscr{U}_{a d, h}
\label{18.80}\end{equation}

或者，更确切地说。

!!!!
J\left(y_{h}\left(u_{h}\right), u_{h}\right) \leq J\left(y_{h}\left(v_{h}\right), v_{h}\right) \quad \forall v_{h} \in \mathscr{U}_{a d, h} .
\label{18.81}\end{equation}

这对应于以下计划

!!!!
\mathrm{MODEL} \longrightarrow \text { DISCRETIZATION } \longrightarrow \text { CONTROL }
$$

为其创造了 "离散--然后--优化 "的表达方式。

2) Optimize-then-discretize

或者，我们可以按以下方式进行。我们从控制问题\ref{18.1} ，\ref{18.78} 开始，根据欧拉-拉格朗日方程写出相应的最优性系统。

!!!!
\begin{gathered}
A y(u)=f \\
A^{\prime} p=G(y(u)),
\end{gathered}
\label{18.82}\end{equation}

为一个合适的$G$，它取决于状态$y(u)$，代表了邻接问题的右手边，加上一个额外的方程（形式上对应于\ref{18.56} 的第三个方程），与三个变量$y, p$和$u$有关

!!!!
Q(y, p, u)=0
\label{18.83}\end{equation}

在这个阶段，我们将系统\ref{18.82} 、\ref{18.83} 离散化，并进行数值求解。这对应于以下程序。

$\mathrm{MODEL} \longrightarrow \mathrm{CONTROL} \longrightarrow$ DISCRETIZATION，其中使用了 "优化-然后-分化 "的表达。关于前一种方法，这里我们把最后两个步骤对调了。

这两种策略不一定产生相同的结果。例如，在[IZ99]中表明，如果状态方程是一个描述弹性结构振动的动态问题，并且使用了有限元近似，那么第一种策略就会产生错误的结果。这可以归因于有限元方法对波浪方程的高频解缺乏准确性（见[Zie00] ）。

同时，人们还观察到，对于优化设计中的几个形状优化问题，前一种策略应该是首选；例如，见[MP01, Pir84]。

选择的策略当然取决于手头的微分问题的性质。在这方面，由椭圆或抛物线PDEs支配的控制问题比由双曲方程支配的问题要少，因为它们具有内在的耗散性质。讨论见 [Zua03] 。然而，读者应该紧跟这一领域在未来几年内的许多重要发展。

\subsection{A numerical approximation of an optimal control problem for advection-diffusion equations}

在本节中，我们考虑了一个用拉格朗日方法制定的平流-扩散方程的最优控制问题。对于其数值离散化，有两种不同的策略。我们将考虑 "先离散后优化 "和 "先优化后离散 "两种不同的策略。数值逼近将基于稳定的有限元方法，如第 $13$ 章中所见。此外，将根据第 $4$ 章中说明的准则进行后验误差分析。关于更多的细节，我们参考了[QRDQ06, DQ05]，以及其中的参考文献。

我们考虑以下平流-扩散的边界值问题。

!!!!
\begin{cases}L(y)=-\nabla \cdot(\mu \nabla y)+\mathbf{V} \cdot \nabla y=u & \text { in } \Omega \\ y=0 & \text { on } \Gamma_{D} \\ \mu \frac{\partial y}{\partial n}=0 & \text { on } \Gamma_{N}\end{cases}
\label{18.84}\end{equation}

其中$\Omega$是一个二维域，$\Gamma_{D}$和$\Gamma_{N}$提供了一个不相交的域边界分区$\partial \Omega, u \in L^{2}(\Omega)$是控制变量，而$\mu$和$\mathbf{V}$是两个给定函数（前者是一个正黏度）。这里$\Gamma_{D}=\{\mathbf{x} \in \partial \Omega: \mathbf{V}(\mathbf{x}) \cdot \mathbf{n}(\mathbf{x})<!!!!0\}$是流入的边界，$\mathbf{n}(\mathbf{x})$是向外的单位法线，而$\Gamma_{N}=\partial \Omega \backslash \Gamma_{D}$是流出的边界。

我们假设观察函数被限制在一个子域$D \subseteq \Omega$，最优控制问题为

!!!!
\text { find } u: J(u)=\int_{D}\left(g y(u)-z_{d}\right)^{2} d D \text { minimum, }
\label{18.85}\end{equation}

其中$g \in C^{\infty}(\Omega)$将变量$y$映射到观察空间，$z_{d}$是期望的观察（目标）。通过设置

!!!!
\mathscr{V}=H_{\Gamma_{D}}^{1}=\left\{v \in H^{1}(\Omega): v_{\mid \Gamma_{D}}=0\right\} \text { and } \mathscr{U}=L^{2}(\Omega)
$$

中介绍的拉格朗日函数。  $18.8$中介绍的拉格朗日函数成为

!!!!
\mathscr{L}(y, p, u)=J(u)+F(p ; u)-a(y, p)
\label{18.86}\end{equation}

其中。

!!!!
a(\varphi, \psi)=\int_{\Omega} \mu \nabla \varphi \cdot \nabla \psi d \Omega+\int_{\Omega} \mathbf{V} \cdot \nabla \varphi \psi d \Omega 
\label{18.87}\end{equation}

!!!!
F(\varphi ; u)=\int_{\Omega} u \varphi d \Omega
\label{18.88}\end{equation}

通过将$\mathscr{L}$与状态变量$y$进行微分，我们得到邻接方程（弱形式）。

!!!!
\text { find } p \in \mathscr{V}: a^{a d}(p, \psi)=F^{a d}(\psi ; \varphi) \quad \forall \psi \in \mathscr{V}
\label{18.89}\end{equation}

其中。

!!!!
a^{a d}(p, \psi)=\int_{\Omega} \mu \nabla p \cdot \nabla \psi d \Omega+\int_{\Omega} \mathbf{V} \cdot \nabla \psi p d \Omega 
\label{18.90}\end{equation}

!!!!
F^{a d}(\psi ; y)=\int_{D} 2\left(g y-z_{d}\right) g \psi d D
\label{18.91}\end{equation}

它的微分（分配）对应关系为

!!!!
\begin{cases}L^{a d}(p)=-\nabla \cdot(\mu \nabla p+\mathbf{V} p)=\chi_{D} g\left(g y-z_{d}\right) & \text { in } \Omega \\ p=0 & \text { on } \Gamma_{D} \\ \mu \frac{\partial p}{\partial n}+\mathbf{V} \cdot \mathbf{n} p=0 & \text { on } \Gamma_{N}\end{cases}
\label{18.92}\end{equation}

其中$\chi_{D}$表示区域$D$的特征函数。通过对$\mathscr{L}$与控制函数$u$进行微分，我们得到最优方程（见\ref{18.56})的第三个方程，即

!!!!
\int_{\Omega} \phi p d \Omega=0 \quad \forall \phi \in L^{2}(\Omega)
$$

这个方程提供了成本函数对控制变量的敏感性$J^{\prime}(u)$。为简单起见，用$\delta u$表示这种敏感性，在这种情况下，我们得到$\delta u=p(u)=p$。最后，通过对$\mathscr{L}$与邻接变量$p$的微分，像往常一样，我们得到状态方程（弱形式）。

!!!!
\text { find } y \in \mathscr{V}: a(y, \varphi)=F(\varphi ; u) \quad \forall \varphi \in \mathscr{V}
\label{18.94}\end{equation}



\subsection{The strategies "optimize-then-discretize" and "discretize-then-optimize"}。

从数值的角度来看，第1节中介绍的最小化算法。  $18.9$要求在每一步都对状态和邻接边界值问题进行数值逼近。对于这两个问题，我们可以使用第13.8.6节中介绍的稳定的Galerkin-LeastSquares有限元公式。相应的离散方程分别为：

!!!!
\text { find } y_{h} \in \mathscr{V}_{h}: a\left(y_{h}, \varphi_{h}\right)+\bar{s}_{h}\left(y_{h}, \varphi_{h}\right)=F\left(\varphi_{h} ; u_{h}\right) \quad \forall \varphi_{h} \in \mathscr{V}_{h}
\label{18.95}\end{equation}


!!!!
\bar{s}_{h}\left(y_{h}, \varphi_{h}\right)=\sum_{K \in \mathscr{T}_{h}} \int_{K} \delta_{K} R\left(y_{h} ; u_{h}\right) L\left(\varphi_{h}\right) d K
\label{18.96}\end{equation}

!!!!
\text { find } p_{h} \in \mathscr{V}_{h}: a^{a d}\left(p_{h}, \psi_{h}\right)+\bar{s}_{h}^{a d}\left(p_{h}, \psi_{h}\right)=F^{a d}\left(\psi_{h} ; y_{h}\right) \quad \forall \psi_{h} \in \mathscr{V}_{h}
\label{18.97}\end{equation}

!!!!
\bar{s}_{h}^{a d}\left(p_{h}, \psi_{h}\right)=\sum_{K \in \mathscr{T}_{h}} \int_{K} \delta_{K} R^{a d}\left(p_{h} ; y_{h}\right) L^{a d}\left(\psi_{h}\right) d K
\label{18.98}\end{equation}






其中$\delta_{K}$是一个稳定参数，$R(y ; u)=L(y)-u, R^{a d}(p ; y)=L^{a d}(p)-G(y)$ ，有$G(y)=2 \chi_{D} g\left(g y-z_{d}\right)$。这就是 "优化--然后--具体化 "的范式；见第1节。  $18.12$，对于当前的具体问题，见[Bec01, CH01, Gun03]。

在 "离散--然后--优化 "的范式中，我们将在下文中采用，我们首先离散（通过相同的稳定的GLS公式（公式\ref{18.95} 和\ref{18.96} ），然后引入离散的拉格朗日函数

!!!!
\mathscr{L}_{h}\left(y_{h}, p_{h}, u_{h}\right)=J\left(y_{h}, u_{h}\right)+F\left(p_{h} ; u_{h}\right)-a\left(y_{h}, p_{h}\right)-\bar{s}_{h}\left(y_{h}, p_{h}\right)
\label{18.99}\end{equation}

在这个阶段，通过对$y_{h}$进行微分，我们得到离散的邻接方程\ref{18.97} ，然而这一次的稳定项是不同的，准确的说是

!!!!
\overline{\bar{s}}_{h}^{a d}\left(p_{h}, \psi_{h}\right)=\sum_{K \in \mathscr{T}_{h}} \int_{K} \delta_{K} L\left(\psi_{h}\right) L\left(p_{h}\right) d K
\label{18.100}\end{equation}

现在，通过对$\mathscr{L}_{h}$与$u_{h}$进行微分，并使用里兹表示定理（定理2.1），我们得到，注意到$u_{h} \in \mathscr{V}_{h}$ 。

!!!!
\delta u_{h}=p_{h}+\sum_{K \in \mathscr{T}_{h}} \int_{K} \delta_{K} L\left(p_{h}\right) d K
$$

特别是，新的稳定拉格朗日为[DQ05]。

!!!!
\mathscr{L}_{h}^{s}\left(y_{h}, p_{h}, u_{h}\right)=\mathscr{L}\left(y_{h}, p_{h}, u_{h}\right)+S_{h}\left(y_{h}, p_{h}, u_{h}\right)
\label{18.101}\end{equation}

其中我们设定了

!!!!
S_{h}(y, p, u)=\sum_{K \in \mathscr{T}_{h}} \int_{K} \delta_{K} R(y ; u) R^{a d}(p ; y) d K
\label{18.102}\end{equation}

通过微分$\mathscr{L}_{h}^{s}$，我们得到新的离散状态和邻接问题，仍然可以写成\ref{18.95} 和\ref{18.97} ，然而这一次稳定化项分别为：。

!!!!
s_{h}\left(y_{h}, \varphi_{h} ; u_{h}\right)=-\sum_{K \in \mathscr{T}_{h}} \int_{K} \delta_{K} R\left(y_{h} ; u_{h}\right) L^{a d}\left(\varphi_{h}\right) d K
\label{18.103}\end{equation}

!!!!
s_{h}^{a d}\left(p_{h}, \psi_{h} ; y_{h}\right)=-\sum_{K \in \mathscr{T}_{h}} \int_{K} \delta_{K}\left(R^{a d}\left(p_{h} ; y_{h}\right) L\left(\psi_{h}\right)-R\left(y_{h} ; u_{h}\right) G^{\prime}\left(\psi_{h}\right)\right) d K
\label{18.104}\end{equation}

设为$G^{\prime}(\psi)=2 \chi_{D} g^{2} \psi$ 。最后，成本函数的敏感性现在变成了

!!!!
\delta u_{h}\left(p_{h}, y_{h}\right)=p_{h}-\sum_{K \in \mathscr{T}_{h}} \delta_{K} R^{a d}\left(p_{h} ; y_{h}\right)
\label{18.105}\end{equation}

\subsubsection{A posteriori error estimates}

为了获得一个合适的最优控制问题的后验误差估计，我们将使用成本函数的误差作为误差指标，正如在 [BKR00] 中所做的那样。此外，我们将把这个误差分成两个条款，我们将确定为迭代误差和离散化误差。特别是，对于离散化误差，我们将利用[BKR00]中倡导的网格适应性的二重性原则。

\section{Iteration error and discretization error}

在成本函数最小化的迭代算法的每一步$k$，我们考虑误差

!!!!
\varepsilon^{(k)}=J\left(y^{*}, u^{*}\right)-J\left(y_{h}^{k}, u_{h}^{k}\right)
\label{18.106}\end{equation}

其中符号$*$标识了对应于控制的最优值的变量，而$y_{h}^{k}$表示步骤$k$的离散状态变量。(变量$y_{h}^{k}$和$u_{h}^{k}$具有类似的含义。)我们称离散化误差$\varepsilon_{D}^{(k)}$ [DQ05]为步骤$k$产生的总误差$\varepsilon^{(k)}$的组成部分，而迭代误差$\varepsilon_{I T}^{(k)}[\mathrm{DQ} 05]$ 是$\varepsilon^{(k)}$的组成部分，表示在步骤$k$对精确变量计算的成本函数值与最佳时的成本函数值$J^{*}=J\left(y^{*}, u^{*}\right)$之间的差异。总之，总误差$\varepsilon^{(k)}$ \ref{18.106}可以写为

!!!!
\varepsilon^{(k)}=\left(J\left(y^{*}, u^{*}\right)-J\left(y^{k}, u^{k}\right)\right)+\left(J\left(y^{k}, u^{k}\right)-J\left(y_{h}^{k}, u_{h}^{k}\right)\right)=\varepsilon_{I T}^{(k)}+\varepsilon_{D}^{(k)}
\label{18.107}\end{equation}

下面我们将只对$\varepsilon_{D}^{(k)}$应用后验误差估计，这是$\varepsilon^{(k)}$中唯一可以通过网格细化程序减少的部分。由于$\mathscr{L}(\mathbf{x}), \mathbf{x}=(y, p, u)$的梯度在$\mathbf{x}$中是线性的，当使用算法\ref{18.61} 时，$\tau^{k}=\tau=$不变，迭代误差$\varepsilon_{I T}^{(k)}$变为$\varepsilon_{I T}^{(k)}=\frac{1}{2}\left(\delta u\left(p^{k}, u^{k}\right), u^{*}-u^{k}\right)$，在当前情况下变为（ [DQ05] )

!!!!
\varepsilon_{I T}^{(k)}=-\frac{1}{2} \tau\left\|p^{k}\right\|_{L^{2}(\Omega)}^{2}-\frac{1}{2} \tau \sum_{r=k+1}^{\infty}\left(p^{k}, p^{r}\right)_{L^{2}(\Omega)}
\label{18.108}\end{equation}

由于迭代误差不能由这个公式精确定义，我们将把$\varepsilon_{I T}^{(k)}$近似为

!!!!
\left|\varepsilon_{I T}^{(k)}\right| \approx \frac{1}{2} \tau\left\|p^{k}\right\|_{L^{2}(\Omega)}^{2}
$$

或者，更简单地说。

!!!!
\left|\varepsilon_{I T}^{(k)}\right| \approx\left\|p^{k}\right\|_{L^{2}(\Omega)}^{2}
$$

这就产生了通常的停顿标准

!!!!
\left|\varepsilon_{I T}^{(k)}\right| \approx\left\|\delta u\left(p^{k}\right)\right\|_{L^{2}(\Omega)}
\label{18.109}\end{equation}

在实践中，$\varepsilon_{I T}^{(k)}$是在离散变量上计算的，也就是$\left|\varepsilon_{I T}^{(k)}\right| \approx\left\|\delta u_{h}\left(p_{h}^{k}\right)\right\|$ 。假设在给定的迭代$k$中，网格被自适应地细化，用$\mathbf{x}_{h}=$( $\left.y_{h}, p_{h}, u_{h}\right)$表示在旧网格（细化前）计算的变量$\mathscr{T}_{h}$，用$\mathbf{x}_{h, r e f}=\left(y_{h}^{\text {ref }}, p_{h}^{\text {ref }}, u_{h}^{\text {ref }}\right)$表示细化后的网格$\mathscr{T}_{h, r e f}$ 。然后在步骤$k$中，与网格$\mathscr{T}_{h, \text { ref }}$相关的离散化误差比与$\mathscr{T}_{h}$相关的误差低。然而，在$\mathbf{x}_{h, r e f}$上计算的离散化误差$\varepsilon_{I T}^{(k)}$，低于在$\mathbf{x}_{h}$上计算的迭代误差。

\section{A posteriori error estimate and adaptive strategy}

离散化误差$\varepsilon_{D}^{(k)}$的后验误差估计可以表征如下（[DQ05]）。


Theorem 18.5. For the linear advection-diffusion control problem under exam, with stabilized Lagrangian $\mathscr{L}_{h}^{s}$ (Eq. \ref{18.101} and Eq. \ref{18.102}), the discretization error at step $k$ of the iterative optimization algorithm can be written as

!!!!
\varepsilon_{D}^{(k)}=\frac{1}{2}\left(\delta u\left(p^{k}, u^{k}\right), u^{k}-u_{h}^{k}\right)+\frac{1}{2} \nabla \mathscr{L}_{h}^{s}\left(\mathbf{x}_{h}^{k}\right) \cdot\left(\mathbf{x}^{k}-\mathbf{x}_{h}^{k}\right)+\Lambda_{h}\left(\mathbf{x}_{h}^{k}\right)
\label{18.110}\end{equation}


where $\mathbf{x}_{h}^{k}=\left(y_{h}^{k}, p_{h}^{k}, u_{h}^{k}\right)$ represents the GLS linear finite element solution, $\Lambda_{h}\left(\mathbf{x}_{h}^{k}\right)=S_{h}\left(\mathbf{x}_{h}^{k}\right)+s_{h}\left(y_{h}^{k}, p_{h}^{k} ; u_{h}^{k}\right)$, and $s_{h}\left(w_{h}^{k}, p_{h}^{k} ; u_{h}^{k}\right)$ is the stabilization term \ref{18.103}.

通过将\ref{18.110）调整到手头的具体问题，并表示在不同的有限元上的贡献$K \in \mathscr{T}_{h}$ （[BKR00]），可以得到以下估算

!!!!
\left|\varepsilon_{D}^{(k)}\right| \leq \eta_{D}^{(k)}=\frac{1}{2} \sum_{K \in \mathscr{T}_{h}}\left\{\left(\omega_{K}^{p} \rho_{K}^{y}+\omega_{K}^{y} \rho_{K}^{p}+\omega_{K}^{u} \rho_{K}^{u}\right)+\lambda_{K}\right\}
\label{18.111}\end{equation}

其中。

!!!!
\begin{aligned}
&\rho_{K}^{y}=\left\|R\left(y_{h}^{k} ; u_{h}^{k}\right)\right\|_{L^{2}(K)}+h_{K}^{-\frac{1}{2}}\left\|r\left(y_{h}^{k}\right)\right\|_{L^{2}(\partial K)} \\
&\omega_{K}^{p}=\left\|\left(p^{k}-p_{h}^{k}\right)-\delta_{K} L^{a d}\left(p^{k}-p_{h}^{k}\right)+\delta_{K} G^{\prime}\left(y^{k}-y_{h}^{k}\right)\right\|_{L^{2}(K)}+h_{K}^{\frac{1}{2}}\left\|p^{k}-p_{h}^{k}\right\|_{L^{2}(\partial K)} \\
&\rho_{K}^{p}=\left\|R^{a d}\left(p_{h}^{k} ; y_{h}^{k}\right)\right\|_{L^{2}(K)}+h_{K}^{-\frac{1}{2}}\left\|r^{a d}\left(p_{h}^{k}\right)\right\|_{L^{2}(\partial K)} \\
&\omega_{K}^{y}=\left\|\left(y^{k}-y_{h}^{k}\right)-\delta_{K} L\left(y^{k}-y_{h}^{k}\right)\right\|_{L^{2}(K)}+h_{K}^{\frac{1}{2}}\left\|y^{k}-y_{h}^{k}\right\|_{L^{2}(\partial K)} \\
&\rho_{K}^{u}=\left\|\delta u_{h}\left(p_{h}^{k}, y_{h}^{k}\right)+\delta u\left(p^{k}\right)\right\|_{L^{2}(K)}=\left\|p^{k}+p_{h}^{k}-\delta_{K} R^{a d}\left(p_{h}^{k} ; y_{h}^{k}\right)\right\|_{L^{2}(K)} \\
&\omega_{K}^{u}=\left\|u^{k}-u_{h}^{k}\right\|_{L^{2}(K)}, \\
&\lambda_{K}=2 \delta_{K}\left\|R\left(y_{h}^{k} ; u_{h}^{k}\right)\right\|_{L^{2}(K)}\left\|G\left(y_{h}^{k}\right)\right\|_{L^{2}(K)}, \\
&r\left(y_{h}^{k}\right)=\left\{\begin{array}{l}
-\frac{1}{2}\left[\mu \frac{\partial y_{h}^{k}}{\partial n}\right], \text { on } \partial K \backslash \partial \Omega, \\
-\mu \frac{\partial y_{h}^{k}}{\partial n}, \text { on } \partial K \subset \Gamma_{N},
\end{array}\right. \\
&r^{a d}\left(p_{h}^{k}\right)=\left\{\begin{array}{l}
-\frac{1}{2}\left[\mu \frac{\partial p_{h}^{k}}{\partial n}+\mathbf{V} \cdot \mathbf{n} p_{h}^{k}\right], \text { on } \partial K \backslash \partial \Omega \\
-\left(\mu \frac{\partial p_{h}^{k}}{\partial n}+\mathbf{V} \cdot \mathbf{n} p_{h}^{k}\right), \text { on } \partial K \subset \Gamma_{N} .
\end{array}\right.
\end{aligned}
\label{18.112}\end{equation}



通常，$\partial K$表示$K \in \mathscr{T}_{h}$的边界，而[.]是跨越$\partial K$的跳跃运算符。

为了实际使用估计值 \ref{18.111} ，有必要评估 $y^{k}, p^{k}$ 和 $u^{k}$ 。考虑到这一点，我们用它们的二次重建$\left(y_{h}^{k}\right)^{q}$和$\left(p_{h}^{k}\right)^{q}$代替$y^{k}$和$p^{k}$，而$u^{k}$被$\left(u_{h}^{k}\right)^{q}=u_{h}^{k}-\tau\left(\delta u_{h}\left(\left(p_{h}^{k}\right)^{q},\left(y_{h}^{k}\right)^{q}\right)-\delta u_{h}\left(p_{h}^{k}, y_{h}^{k}\right)\right)$代替，根据最陡峭下降法，加速参数不变$\tau^{k}=\tau$。考虑以下迭代优化算法的适应性策略。

1.使用粗略的网格，迭代到达到迭代误差的公差$\operatorname{Tol}_{I T}$。

2.调整网格，通过在不同元素$K \in \mathscr{T}_{h}$上等分误差，根据估计\ref{18.111），直到离散化误差收敛在一个公差范围内$\operatorname{Tol}_{D}$ 。

3.重新评估变量以及$\varepsilon_{I T}^{(k)}$的细化网格：如果$\varepsilon_{I T}^{(k)} \geq T o l_{I T}$返回到点1并重复程序，如果$\varepsilon_{I T}^{(k)}<T o l_{I T}$停止算法。

\subsubsection{A test problem on control of pollutant emission}

作为一个例子，我们将应用关于离散化误差的后验估计\ref{18.111）$\eta_{D}^{(k)}$和第1节中说明的策略。  $18.13 .2$中说明的策略应用于一个关于向大气排放污染物的测试案例。具体问题是如何调节工业烟囱的排放，使污染物在某一关键区域的浓度低于规定的可接受阈值。

为此，我们考虑一个状态方程，该方程由准三维平流扩散边界值问题[DQ05]给出。源头（排放高度）$y$的污染物浓度$\mathrm{z}=H$由\ref{18.84} 描述，而地面的浓度则通过应用投影函数$g(\mathrm{x}, \mathrm{y})$获得。扩散系数$\mu(x, y)$和$g(x, y)$的形式既取决于源与地面的距离$H$，也取决于大气的稳定性等级（稳定、中性或不稳定）。我们将提到一个中性大气，参照图18.16所示的领域，我们假设风场是$\mathbf{V}=V\left(\cos \frac{\pi}{30}, \sin \frac{\pi}{30}\right)$与$V=2.5 \mathrm{~m} / \mathrm{s}$ 。此外，我们假设有三个烟囱（由图18.16中三个对齐的小圆圈表示），都在同一高度$H=100 \mathrm{~m}$，每个烟囱允许的最大排放量为$u_{\max }=800 \mathrm{~g} / \mathrm{s}$。我们假设排放的污染物是$S O_{2}$，我们在$z_{d}=100 \mu \mathrm{g} / \mathrm{m}^{3}$（我们控制问题中的目标观测点）固定观测区域的期望浓度，这是计算域的一个圆形区域，我们在图18.16中用$D$表示。在\ref{18.84} 中，我们考虑了整个计算域$u$的分布式控制的情况，而在目前的例子中$u=\sum_{i=1}^{N} u_{i} \chi_{i}$，其中$\chi_{i}$是代表第$i$个烟囱位置的（微小）区域的特征函数。

最后，我们选择

!!!!
g(\mathbf{x})=2 e^{-\frac{1}{2}\left(\frac{H}{0.04 r\left(1+2 \cdot 10^{-4} r\right)^{-1 / 2}}\right)}
$$

其中$r$是与源头的距离（以mt计）。

在图18.17（a）中，我们显示了每个烟囱的地面浓度，相当于可能的最高排放$\left(u_{\max }=800 \mathrm{~g} / \mathrm{s}\right.$），而在图18.17（b）中，我们显示了应用最佳控制程序后的浓度（成本函数是与目标浓度$\left.z_{d}\right)$的距离$L^{2}(D)$的平方。我们观察到，"最佳 "排放率为$u_{1}=0.0837 \cdot u_{\max }, u_{2}=0.0908 \cdot u_{\max }$和$u_{3}=1.00 \cdot u_{\max }$ 。

![](https://cdn.mathpix.com/cropped/991f5db518e324d299c1ff4972bba9fb-167.jpg?height=260&width=318&top_left_y=931&top_left_x=288)

图 18.16.污染物控制测试问题的计算域

![](https://cdn.mathpix.com/cropped/991f5db518e324d299c1ff4972bba9fb-168.jpg?height=303&width=333&top_left_y=115&top_left_x=115)

(a)

![](https://cdn.mathpix.com/cropped/991f5db518e324d299c1ff4972bba9fb-168.jpg?height=303&width=335&top_left_y=115&top_left_x=464)

(b)

图18.17.在$\left[\mu g / m^{3}\right]$的地面上测量的污染物浓度。(a)调节烟囱排放之前和(b)调节之后

在图18.18（a）中，我们报告了通过对$\eta_{D}^{(k)}$的后验估计得到的网格，而在图18.18(b)是由以下能量规范误差指标$\left(\eta_{E}\right)^{(k)}=\Sigma_{K \in \mathscr{T}_{h}} h_{K} \rho_{K}^{y}$得到的网格。采用的符号是$(18.112)$的符号。

然后将这些结果与用大约80000个元素的极细网格得到的结果进行比较。由误差指标$\eta_{D}^{(k)}$驱动的网格适应性倾向于将节点集中在那些与最优控制更相关的区域。这一点通过比较使用相同数量网格点的成本函数上的误差得到了证实。例如，指标$\eta_{D}^{(k)}$产生的误差约为$20 \%$，而在约4000个元素的网格上使用指标$\left(\eta_{E}\right)^{(k)}$会得到$55 \%$，而在约14000个元素的网格上，会是$6 \%$对$15 \%$ 。

![](https://cdn.mathpix.com/cropped/991f5db518e324d299c1ff4972bba9fb-168.jpg?height=276&width=335&top_left_y=868&top_left_x=114)

(a)

![](https://cdn.mathpix.com/cropped/991f5db518e324d299c1ff4972bba9fb-168.jpg?height=273&width=335&top_left_y=868&top_left_x=464)

(b)

图18.18.使用误差指标$\eta_{D}^{(j)}$获得的适应性网格（约14000个元素）（见$(18.111))$（a）和$\left(\eta_{E}\right)^{(j)}$ )

\subsection{Exercises}

1.考虑有边界控制的最优控制问题

!!!!
\begin{cases}-\nabla \cdot(\alpha \nabla y)+\beta \cdot \nabla y+\gamma y=f & \text { in } \Omega=(0,1)^{2} \\ \frac{\partial y}{\partial n}=u & \text { on } \partial \Omega\end{cases}
\ref{18.113}
$$

$u \in L^{2}(\Omega)$是控制函数，$f \in L^{2}(\Omega)$是给定函数。考虑成本函数

!!!!
J(u)=\frac{1}{2}\left\|\eta y-z_{d}\right\|_{L^{2}(\Omega)}^{2}+v\|u\|_{L^{2}(\partial \Omega)}^{2}
\ref{18.114}
$$

与 $\eta \in L^{\infty}(\Omega)$ 。

写出基于拉格朗日方法的最优控制问题\ref{18.113）-\ref{18.114）的方程（状态方程、邻接方程和最优方程），以及基于Lions方法的方程。

2.考虑最优控制问题

!!!!
\begin{cases}-\nabla \cdot(\alpha \nabla y)+\beta \cdot \nabla y+\gamma y=f+c u & \text { in } \Omega=(0,1)^{2} \\ \frac{\partial y}{\partial n}=g & \text { on } \partial \Omega\end{cases}
\ref{18.115}
$$

其中$u \in L^{2}(\Omega)$是一个分布式控制，$c$是一个给定的常数，$f \in L^{2}(\Omega)$和$g \in!!!!H^{-1 / 2}(\partial \Omega)$两个给定函数。考虑成本函数

!!!!
J(u)=\frac{1}{2}\left\|\eta y-z_{d}\right\|_{L^{2}(\Omega)}^{2}+v\|u\|_{L^{2}(\Omega)}^{2}
\ref{18.116}
$$

与 $\eta \in L^{\infty}(\Omega)$ 。

通过基于拉格朗日的方法找到最优控制问题\ref{18.115）-\ref{18.116）的表述，然后是基于Lions的表述。

\section{Domain decomposition methods}

在本章中，我们将介绍领域分解法（简称DD）。在其最常见的版本中，DD可用于任何偏微分方程的离散化方法（如有限元、有限体积、有限差分或谱元方法）的框架中，以使其代数解在并行计算机平台上更有效率。此外，DD方法允许将任何给定的边界值问题重新表述在计算域的子域分区上。因此，它为解决异质或多物理问题提供了一个非常方便的框架，即那些在计算域的不同子区域由不同种类的微分方程所支配的问题。

DD方法的基本思想是将设定了边界值问题的计算域$\Omega$细分为两个或更多的子域，在这些子域上求解较小维度的离散问题，其进一步的潜在优势是使用并行求解算法。更具体地说，有两种将计算域细分为子域的方式：一种是不相交的子域，另一种是重叠的子域（例子见图19.1）。相应地，将设置不同的DD算法。关于DD方法的参考讲座，我们参考了[BGS96, QV99, TW05]。

![](https://cdn.mathpix.com/cropped/991f5db518e324d299c1ff4972bba9fb-170.jpg?height=217&width=719&top_left_y=934&top_left_x=97)

图19.1.对域$\Omega$进行细分的两个例子，有重叠和无重叠。



\subsection{Some classical iterative DD methods}

在这一节中，我们从模型问题出发，介绍了四种不同的迭代方案：找到$u: \Omega \rightarrow \mathbb{R}$，以便于。

!!!!
\begin{cases}L u=f & \text { in } \Omega \\ u=0 & \text { on } \partial \Omega\end{cases}
\ref{19.1}
$$

$L$是一个通用的二阶椭圆算子，其弱表述为

!!!!
\text { find } u \in V=H_{0}^{1}(\Omega): a(u, v)=(f, v) \quad \forall v \in V,
\ref{19.2}
$$

是$a(\cdot, \cdot)$与$L$相关的双线性形式，$(\cdot, \cdot)$是$L^{2}(\Omega)$的标量积。

\subsubsection{Schwarz method}

考虑将域$\Omega$分解为两个子域$\Omega_{1}$和$\Omega_{2}$，这样$\bar{\Omega}=\bar{\Omega}_{1} \cup \bar{\Omega}_{2}, \Omega_{1} \cap \Omega_{2}=\Omega_{12} \neq \emptyset\left(\right.$见图19.1），并让$\Gamma_{i}=\partial \Omega_{i} \backslash\left(\partial \Omega \cap \partial \Omega_{i}\right)$ 考虑以下迭代方法。给定$u_{2}^{(0)}$在$\Gamma_{1}$上，解决$k \geq 1$的以下问题。

!!!!
\begin{cases}L u_{1}^{(k)}=f & \text { in } \Omega_{1} \\ u_{1}^{(k)}=u_{2}^{(k-1)} & \text { on } \Gamma_{1} \\ u_{1}^{(k)}=0 & \text { on } \partial \Omega_{1} \backslash \Gamma_{1}\end{cases}
\label{19.3}\end{equation}



!!!!
\begin{cases}L u_{2}^{(k)}=f & \text { in } \Omega_{2} \\ u_{2}^{(k)}= \begin{cases}u_{1}^{(k)} & \\ u_{1}^{(k-1)} & & \text { on } \Gamma_{2} \\ u_{2}^{(k)}=0 & & \text { on } \partial \Omega_{2} \backslash \Gamma_{2}\end{cases} \end{cases}
\label{19.4}\end{equation}


在\ref{19.4} 中选择$u_{1}^{(k)}$对$\Gamma_{2}$的情况下，该方法被称为乘法施瓦茨，而我们选择$u_{1}^{(k-1)}$的情况被称为加法施瓦茨。原因将在第19.6节阐明。因此，我们有两个椭圆边界值问题，在两个子域$\Omega_{1}$和$\Omega_{2}$上有迪里希条件，我们希望两个序列$\left\{u_{1}^{(k)}\right\}$和$\left\{u_{2}^{(k)}\right\}$收敛到问题\ref{19.1} 的解$u$的限制，也就是说

!!!!
\lim _{k \rightarrow \infty} u_{1}^{(k)}=\left.u\right|_{\Omega_{1}} \text { and } \quad \lim _{k \rightarrow \infty} u_{2}^{(k)}=\left.u\right|_{\Omega_{2}}
$$

可以证明，应用于问题\ref{19.1} 的施瓦兹方法总是收敛的，其速度随着重叠区域$\left|\Omega_{12}\right|$的度量增加而增加。让我们在一个简单的一维案例上展示这个结果。
 ![](https://cdn.mathpix.com/cropped/991f5db518e324d299c1ff4972bba9fb-172.jpg?height=196&width=702&top_left_y=115&top_left_x=97)

图19.2.维度1的重叠分解的例子（左）。问题\ref{19.7} 的乘法施瓦茨方法的几次迭代（右）。

例19.1.设$\Omega=(a, b)$和$\gamma_{1}, \gamma_{2} \in(a, b)$是这样的：$a<\gamma_{2}<\gamma_{1}<b$（见图19.2）。两个问题\ref{19.3} 和\ref{19.4} 变成。

!!!!
\begin{cases}L u_{1}^{(k)}=f, & a<x<\gamma_{1} \\ u_{1}^{(k)}=u_{2}^{(k-1)}, & x=\gamma_{1} \\ u_{1}^{(k)}=0, & x=a\end{cases}
\label{19.5}\end{equation}


!!!!
\begin{cases}L u_{2}^{(k)}=f, & \gamma_{2}<x<b \\ u_{2}^{(k)}=u_{1}^{(k)}, & x=\gamma_{2} \\ u_{2}^{(k)}=0, & x=b\end{cases}
\label{19.6}\end{equation}


为了证明这个方案是收敛的，让我们把自己限定在更简单的问题上

!!!!
\begin{cases}-u^{\prime \prime}(x)=0, & a<x<b \\ u(a)=u(b)=0, & \end{cases}
\label{19.7}\end{equation}

这就是模型问题\ref{19.1} ，有$L=-d^{2} / d x^{2}$和$f=0$，其解显然是$u=0$在$(a, b)$中。这不是限制性的，因为在每一步都有误差。  $u-u_{1}^{(k)}$在$\Omega_{1}$中，$u-u_{2}^{(k)}$在$\Omega_{2}$中，满足类似于(19.5)-(19.6)的空强制项问题。

让$k=1$；因为$\left(u_{1}^{(1)}\right)^{\prime \prime}=0, u_{1}^{(1)}(x)$是一个线性函数；此外，它在$x=a$处消失，在$x=\gamma_{1}$处取值$u_{2}^{(0)}$ 。由于我们知道$u_{1}^{(1)}$在$\gamma_{2}$的值，我们可以解决(19.6)的问题，而这个问题的特点是线性解。然后我们以类似的方式进行。在图$19.2$中，我们展示了几个迭代：我们清楚地看到，该方法收敛了，而且收敛率随着区间$\left(\gamma_{2}, \gamma_{1}\right)$的长度变小而降低。

在每个迭代中，施瓦兹迭代方法\ref{19.3}-(19.4)$需要解决两个子问题，其边界条件与原问题的边界条件相同：事实上，通过从$\Omega$中的迪里希特边界值问题开始，我们最终得到两个在$\Omega_{1}$和$\Omega_{2}$边界的迪里希特条件的子问题。

如果微分问题\ref{19.1} 由整个边界上的诺伊曼边界条件来完成 $\partial \Omega$ ，我们就会被引向任一子域上的混合迪里希勒-诺伊曼边界值问题的解决 $\Omega_{1}$ 和 $\Omega_{2}$ 。

\subsubsection{Dirichlet-Neumann method}

让我们将域$\Omega$划分为两个互不相干的子域（如图19.1）：然后让$\Omega_{1}$和$\Omega_{2}$成为提供$\Omega$的分区的两个子域，即$\bar{\Omega}_{1} \cup \bar{\Omega}_{2}=\bar{\Omega}, \bar{\Omega}_{1} \cap \bar{\Omega}_{2}=\Gamma$和$\Omega_{1} \cap \Omega_{2}=\emptyset$ 。我们用$\mathbf{n}_{i}$表示$\Omega_{i}$的外向单位法向量，并将使用以下符号惯例。  $\mathbf{n}=\mathbf{n}_{1}=-\mathbf{n}_{2}$ .

以下结果成立（其证明见[QV99]）。

Theorem $19.1$ (of equivalence).\} The solution u of problem \ref{19.1} is such that $u_{\mid \Omega_{i}}=u_{i}$ for $i=1,2$, where $u_{i}$ is the solution to the problem:

!!!!
\begin{cases}L u_{i}=f & \text { in } \Omega_{i} \\ u_{i}=0 & \text { on } \partial \Omega_{i} \backslash \Gamma\end{cases}
\label{19.8}\end{equation}

with interface conditions

!!!!
u_{1}=u_{2}
\label{19.9}\end{equation}

and

!!!!
\frac{\partial u_{1}}{\partial n_{L}}=\frac{\partial u_{2}}{\partial n_{L}}
\label{19.10}\end{equation}

on $\Gamma$, having denoted with $\partial / \partial n_{L}$ the conormal derivative (see (3.34)).





由于这个结果，我们可以通过将界面条件\ref{19.9} -\ref{19.10} 指定为界面$\Gamma$上两个子问题的 "边界条件 "来分割问题\ref{19.1} 。特别是，我们可以设置以下迪里希-诺曼（DN）迭代算法：给定$u_{2}^{(0)}$在$\Gamma$上，对于$k \geq 1$解决问题。

!!!!
\begin{cases}L u_{1}^{(k)}=f & \text { in } \Omega_{1} \\ u_{1}^{(k)}=u_{2}^{(k-1)} & \text { on } \Gamma \\ u_{1}^{(k)}=0 & \text { on } \partial \Omega_{1} \backslash \Gamma\end{cases}
\label{19.11}\end{equation}


!!!!
\begin{cases}L u_{2}^{(k)}=f & \text { in } \Omega_{2} \\ \frac{\partial u_{2}^{(k)}}{\partial n_{L}}=\frac{\partial u_{1}^{(k)}}{\partial n_{L}} & \text { on } \Gamma \\ u_{2}^{(k)}=0 & \text { on } \partial \Omega_{2} \backslash \Gamma\end{cases}
\label{19.12}\end{equation}


对于$\Omega_{1}$中的子问题，条件\ref{19.9} 在$\Gamma$上产生了一个迪里希特边界条件，而\ref{19.10} 对于$\Gamma$中的子问题，在$\Omega_{2}$上产生了一个诺伊曼边界条件。

与施瓦茨的方法不同，DN算法在子域$\Omega_{2}$上得到了一个诺伊曼边界值问题。定理$19.1$保证当两个序列$\left\{u_{1}^{(k)}\right\}$和$\left\{u_{2}^{(k)}\right\}$收敛时，它们的极限将强制为精确问题\ref{19.1} 的解。因此，DN算法是一致的。然而，它的收敛性并不总是被保证的，正如我们在下面的简单例子中可以看到的那样。

例19.2.设 $\Omega=(a, b), \gamma \in(a, b), L=-d^{2} / d x^{2}$ 和 $f=0$ .在每一个$k \geq 1$，DN算法都会产生两个子问题。

!!!!
\begin{cases}-\left(u_{1}^{(k)}\right)^{\prime \prime}=0, & a<x<\gamma \\ u_{1}^{(k)}=0, & x=a \\ u_{1}^{(k)}=u_{2}^{(k-1)}, & x=\gamma\end{cases}
\label{19.13}\end{equation}


!!!!
\begin{cases}-\left(u_{2}^{(k)}\right)^{\prime \prime}=0, \quad \gamma<x<b \\ \left(u_{2}^{(k)}\right)^{\prime}=\left(u_{1}^{(k)}\right)^{\prime}, & x=\gamma \\ u_{2}^{(k)}=0, & x=b\end{cases}
\label{19.14}\end{equation}


按照例19.1的做法，我们可以证明，只有在$\gamma>(a+b) / 2$的情况下，两个序列才会收敛，如图19.3所示。

一般来说，对于任意维度的问题$d>1$，"Dirichlet "子域$\Omega_{1}$的度量必须大于 "Neumann "子域$\Omega_{2}$的度量，以保证\ref{19.11} -\ref{19.12} 的收敛性。然而，这产生了一个严重的约束，特别是如果将使用几个子域的话。

为了克服这种限制，可以通过将第一子域中的迪里希特条件\ref{19.11}_{2}$替换成DN算法的一个变体来建立

!!!!
u_{1}^{(k)}=\theta u_{2}^{(k-1)}+(1-\theta) u_{1}^{(k-1)} \quad \text { on } \Gamma
\label{19.15}\end{equation}

也就是通过引入一个取决于正参数$\theta$的松弛。通过这种方式，总是有可能减少两个后续迭代之间的误差。
 ![](https://cdn.mathpix.com/cropped/991f5db518e324d299c1ff4972bba9fb-174.jpg?height=238&width=524&top_left_y=926&top_left_x=195)

图 19.3.$1 \mathrm{D}$中DN方法的收敛（左）和发散（右）迭代实例 在图$19.3$所示的情况下，我们可以很容易地验证，通过选择

!!!!
\theta_{o p t}=-\frac{u_{1}^{(k-1)}}{u_{2}^{(k-1)}-u_{1}^{(k-1)}}
\label{19.16}\end{equation}

该算法在一次迭代中就收敛到了精确解（这并不奇怪！）。

更一般地说，可以证明在任何维度$d \geq 1$中，存在一个合适的值$\theta_{\max }<1$，使DN算法在区间$\left(0, \theta_{\max }\right)$中任何可能的松弛参数$\theta$的选择都收敛。

\subsubsection{Neumann-Neumann algorithm}

再次考虑将$\Omega$划分为两个互不相干的子域，用$\lambda$表示解$u$在其界面$\Gamma$的（未知）值。考虑以下迭代算法：对于$\lambda^{(0)}$上任何给定的$\Gamma$，对于$k \geq 0$和$i=1,2$解决以下问题。

!!!!
\begin{cases}L u_{i}^{(k+1)}=f & \text { in } \Omega_{i} \\ u_{i}^{(k+1)}=\lambda^{(k)} & \text { on } \Gamma \\ u_{i}^{(k+1)}=0 & \text { on } \partial \Omega_{i} \backslash \Gamma\end{cases}
\label{19.17}\end{equation}

!!!!
\begin{cases}L \psi_{i}^{(k+1)}=0 & \text { in } \Omega_{i} \\ \frac{\partial \psi_{i}^{(k+1)}}{\partial n}=\sigma_{i}\left(\frac{\partial u_{1}^{(k+1)}}{\partial n_{L}}-\frac{\partial u_{2}^{(k+1)}}{\partial n_{L}}\right) & \text { on } \Gamma \\ \psi_{i}^{(k+1)}=0 & \text { on } \partial \Omega_{i} \backslash \Gamma\end{cases}
\label{19.18}\end{equation}


与

!!!!
\lambda^{(k+1)}=\lambda^{(k)}-\theta\left(\sigma_{1} \psi_{1 \mid \Gamma}^{(k+1)}-\sigma_{2} \psi_{2 \mid \Gamma}^{(k+1)}\right)
\label{19.19}\end{equation}

其中$\theta$是一个正的加速参数，而$\sigma_{1}$和$\sigma_{2}$是两个正的系数，使得$\sigma_{1}+\sigma_{2}=1$ 。这种迭代算法被命名为Neumann-Neumann（NN）。请注意，在第一阶段\ref{19.17} ，我们关心的是函数$\Gamma$和$u_{2}^{(k+1)}$在$u_{1}^{(k+1)}$上的连续性，而不是它们的同法导数的连续性。后者在第二阶段\ref{19.18} 、\ref{19.19} 通过校正函数$\psi_{1}^{(k+1)}$和$\psi_{2}^{(k+1)}$来解决。

\subsubsection{Robin-Robin algorithm}

最后，我们考虑以下迭代算法，命名为Robin-Robin（RR）。对于每一个$k \geq 0$解决以下问题。

!!!!
\begin{cases}L u_{1}^{(k+1)}=f & \text { in } \Omega_{1} \\ u_{1}^{(k+1)}=0 & \text { on } \partial \Omega_{1} \cap \partial \Omega \\ \frac{\partial u_{1}^{(k+1)}}{\partial n_{L}}+\gamma_{1} u_{1}^{(k+1)}=\frac{\partial u_{2}^{(k)}}{\partial n_{L}}+\gamma_{1} u_{2}^{(k)} & \text { on } \Gamma\end{cases}
\label{19.20}\end{equation}

然后

!!!!
\begin{cases}-\triangle u_{2}^{(k+1)}=f & \text { in } \Omega_{2} \\ u_{2}^{(k+1)}=0 & \text { on } \partial \Omega_{2} \cap \partial \Omega \\ \frac{\partial u_{2}^{(k+1)}}{\partial n_{L}}+\gamma_{2} u_{2}^{(k+1)}=\frac{\partial u_{1}^{(k+1)}}{\partial n_{L}}+\gamma_{2} u_{1}^{(k+1)} & \text { on } \Gamma\end{cases}
\label{19.21}\end{equation}

其中$u_{0}$被分配，$\gamma_{1}, \gamma_{2}$是满足$\gamma_{1}+\gamma_{2}>0$的非负加速参数。为了实现算法的并行化，在\ref{19.21} 中我们可以使用$u_{1}^{(k)}$而不是$u_{1}^{(k+1)}$，条件是在这种情况下也要为$u_{1}^{0}$指定一个初始值。

\subsection{Multi-domain formulation of Poisson problem and interface conditions}

在本节中，为了便于阐述，我们选择$L=-\triangle$，并考虑具有同质Dirichlet边界条件的泊松问题\ref{3.13} 。对具有不同边界条件的任意二阶椭圆算子的推广是有序的。

在第19.1.2节所述的域被划分为两个互不相干的子域的情况下，等价定理19.1允许对问题\ref{19.1} 进行如下多域表述，其中$u_{i}=\left.u\right|_{\Omega_{i}}, i=1,2$ 。

!!!!
\begin{cases}-\triangle u_{1}=f & \text { in } \Omega_{1} \\ u_{1}=0 & \text { on } \partial \Omega_{1} \backslash \Gamma, \\ -\Delta u_{2}=f & \text { in } \Omega_{2}, \\ u_{2}=0 & \text { on } \partial \Omega_{2} \backslash \Gamma, \\ u_{1}=u_{2} & \text { on } \Gamma \\ \frac{\partial u_{1}}{\partial n}=\frac{\partial u_{2}}{\partial n} & \text { on } \Gamma\end{cases}
\label{19.22}\end{equation}



\subsection{The Steklov-Poincaré operator}.

我们再次用$\lambda$表示问题\ref{3.13} 的解$u$在界面$\Gamma$上的未知值，即$\lambda=u_{\Gamma}$ 。如果我们预先知道$\lambda$在$\Gamma$上的值，我们可以解决以下两个独立的边界值问题，在$\Gamma(i=1,2):$上有迪里希特条件。

!!!!
\left\{\begin{array}{lll}
-\Delta w_{i}=f & & \text { in } \Omega_{i} \\
w_{i}=0 & & \text { on } \partial \Omega_{i} \backslash \Gamma \\
w_{i}=\lambda & & \text { on } \Gamma
\end{array}\right.
\label{19.23}\end{equation}

为了获得$\lambda$在$\Gamma$上的值，让我们把$w_{i}$分割如下

!!!!
w_{i}=w_{i}^{*}+u_{i}^{0}
$$

其中$w_{i}^{*}$和$u_{i}^{0}$代表以下问题的解$(i=1,2)$ 。

!!!!
\left\{\begin{array}{lll}
-\Delta w_{i}^{*}=f & & \text { in } \Omega_{i} \\
w_{i}^{*}=0 & & \text { on } \partial \Omega_{i} \cap \partial \Omega \\
w_{i}^{*}=0 & & \text { on } \Gamma
\end{array}\right.
\label{19.24}\end{equation}

和

!!!!
\left\{\begin{array}{lll}
-\Delta u_{i}^{0}=0 & \text { in } \Omega_{i} \\
u_{i}^{0}=0 & & \text { on } \partial \Omega_{i} \cap \partial \Omega \\
u_{i}^{0}=\lambda & & \text { on } \Gamma
\end{array}\right.
\label{19.25}\end{equation}

分别。请注意，函数$w_{i}^{*}$只取决于源数据$f$，而$u_{i}^{0}$只取决于$\Gamma$上的值$\lambda$，因此我们可以写成$w_{i}^{*}=G_{i} f$和$u_{i}^{0}=H_{i} \lambda$ 。两个算子$G_{i}$和$H_{i}$都是线性的；$H_{i}$是$\lambda$在域$\Omega_{i}$上的所谓谐波扩展算子。

通过对问题\ref{19.22} 和问题\ref{19.23} 的正式比较，我们推断出，平等的

!!!!
u_{i}=w_{i}^{*}+u_{i}^{0}, i=1,2,
$$

如果满足\ref{19.22}_{6}$关于法线导数的条件$\Gamma$，则成立，即：如果

!!!!
\frac{\partial w_{1}}{\partial n}=\frac{\partial w_{2}}{\partial n} \quad \text { on } \Gamma
$$

通过使用前面介绍的符号，后一个条件可以重新表述为

!!!!
\frac{\partial}{\partial n}\left(G_{1} f+H_{1} \lambda\right)=\frac{\partial}{\partial n}\left(G_{2} f+H_{2} \lambda\right)
$$

因此

!!!!
\left(\frac{\partial H_{1}}{\partial n}-\frac{\partial H_{2}}{\partial n}\right) \lambda=\left(\frac{\partial G_{2}}{\partial n}-\frac{\partial G_{1}}{\partial n}\right) f \quad \text { on } \Gamma
$$



![](https://cdn.mathpix.com/cropped/991f5db518e324d299c1ff4972bba9fb-178.jpg?height=169&width=338&top_left_y=113&top_left_x=286)

图19.4.一维的谐波扩展

这样我们就得到了界面$\lambda$上的未知数$\Gamma$的方程，名为斯特克洛夫-波因卡雷方程，可以用紧凑形式重写为

!!!!
S \lambda=\chi \quad \text { on } \Gamma
\label{19.26}\end{equation}

$S$是Steklov-Poincaré伪微分算子；其正式定义为

!!!!
S \mu=\frac{\partial}{\partial n} H_{1} \mu-\frac{\partial}{\partial n} H_{2} \mu=\sum_{i=1}^{2} \frac{\partial}{\partial n_{i}} H_{i} \mu=\sum_{i=1}^{2} S_{i} \mu
\label{19.27}\end{equation}

而$\chi$是一个线性函数，取决于$f$。

!!!!
\chi=\frac{\partial}{\partial n} G_{2} f-\frac{\partial}{\partial n} G_{1} f=-\sum_{i=1}^{2} \frac{\partial}{\partial n_{i}} G_{i} f
\label{19.28}\end{equation}

The operator

!!!!
S_{i}: \mu \rightarrow S_{i} \mu=\left.\frac{\partial}{\partial n_{i}}\left(H_{i} \mu\right)\right|_{\Gamma}, \quad i=1,2
\label{19.29}\end{equation}

被称为局部斯特克洛夫-波因卡雷算子。请注意，$S, S_{1}$和$S_{2}$在痕量空间之间操作

!!!!
\Lambda=\left\{\mu|\exists v \in V: \mu=v|_{\Gamma}\right\}
\label{19.30}\end{equation}

(即$H_{00}^{1 / 2}(\Gamma)$，见[QV99]$)$，及其对偶$\Lambda^{\prime}$，而$\chi \in \Lambda^{\prime}$ 。

例19.3.为了提供一个运算符$S$的实际（初级）例子，让我们考虑一个简单的一维问题。让$\Omega=(a, b) \subset \mathbb{R}$如图19.4所示和$L u=-u^{\prime \prime}$ 。通过将$\Omega$细分为两个互不相干的子域，界面$\Gamma$减少为一个点$\gamma \in(a, b)$，而Steklov-Poincaré算子$S$变成了

!!!!
S \lambda=\left(\frac{d H_{1}}{d x}-\frac{d H_{2}}{d x}\right) \lambda=\left(\frac{1}{l_{1}}+\frac{1}{l_{2}}\right) \lambda
$$

与 $l_{1}=\gamma-a$ 和 $l_{2}=b-\gamma$ 。

\subsubsection{Equivalence between Dirichlet-Neumann and Richardson methods}

第19.1.2节中介绍的迪里希勒-诺曼（DN）方法可以重新解释为解决斯特克洛夫-波因卡雷界面方程的（预设条件）理查德森方法。为了验证这一说法，为简单起见，再次考虑将域$\Omega$划分为两个不相交的子域$\Omega_{1}$和$\Omega_{2}$，界面$\Gamma$。然后我们在算子$L=-\Delta$的情况下重写DN算法\ref{19.11} ，\ref{19.12} ，\ref{19.15} ：对于给定的$\lambda^{0}$，对于$k \geq 1$解决。

!!!!
\begin{cases}-\triangle u_{1}^{(k)}=f_{1} & \text { in } \Omega_{1} \\ u_{1}^{(k)}=\lambda^{(k-1)} & \text { on } \Gamma \\ u_{1}^{(k)}=0 & \text { on } \partial \Omega_{1} \backslash \Gamma\end{cases}
\label{19.31}\end{equation}


!!!!
\begin{cases}-\triangle u_{2}^{(k)}=f_{2} & \text { in } \Omega_{2} \\ \frac{\partial u_{2}^{(k)}}{\partial n_{2}}=\frac{\partial u_{1}^{(k)}}{\partial n_{2}} & \text { on } \Gamma \\ u_{2}^{(k)}=0 & \text { on } \partial \Omega_{2} \backslash \Gamma\end{cases}
\label{19.32}\end{equation}

!!!!
\lambda^{(k)}=\theta u_{2}^{(k)}{ }_{\Gamma}+(1-\theta) \lambda^{(k-1)}
\label{19.33}\end{equation}

以下结果成立。


Theorem 19.2. The Dirichlet-Neumann iterative algorithm \ref{19.31}-\ref{19.33} is equivalent to the preconditioned Richardson algorithm

!!!!
P_{D N}\left(\lambda^{(k)}-\lambda^{(k-1)}\right)=\theta\left(\chi-S \lambda^{(k-1)}\right)
\label{19.34}\end{equation}

The preconditioning operator is $P_{D N}=S_{2}$.

证明。(19.31)的解$u_{1}^{(k)}$可写为

!!!!
u_{1}^{(k)}=H_{1} \lambda^{(k-1)}+G_{1} f_{1}
\label{19.35}\end{equation}

由于$G_{2} f_{2}$满足微分问题

!!!!
\begin{cases}-\triangle\left(G_{2} f_{2}\right)=f_{2} & \text { in } \Omega_{2}, \\ G_{2} f_{2}=0 & \text { on } \partial \Omega_{2},\end{cases}
$$

由于\ref{19.32}，函数$u_{2}^{(k)}-G_{2} f_{2}$满足微分问题

!!!!
\begin{cases}-\Delta\left(u_{2}^{(k)}-G_{2} f_{2}\right)=0 \quad \text { in } \Omega_{2} \\ \frac{\partial}{\partial n_{2}}\left(u_{2}^{(k)}-G_{2} f_{2}\right)=-\frac{\partial u_{1}^{(k)}}{\partial n}+\frac{\partial}{\partial n}\left(G_{2} f_{2}\right) & \text { on } \Gamma \\ u_{2}^{(k)}-G_{2} f_{2}=0 & \text { on } \partial \Omega_{2} \backslash \Gamma\end{cases}
\label{19.36}\end{equation}

特别是$u_{2}^{(k)}{\mid r}=\left(u_{2}^{(k)}-G_{2} f_{2}\right)_{\mid \Gamma}$ 。由于算子$S_{i}$\ref{19.29} 将$\Gamma$上的迪里希特数据映射为诺伊曼数据，其逆$S_{i}^{-1}$将$\Gamma$上的诺伊曼数据转换为迪里希特数据。否则，$S_{2}^{-1} \eta=\left.w_{2}\right|_{\Gamma}$，其中$w_{2}$是$\Gamma$的解。

!!!!
\begin{cases}-\Delta w_{2}=0 & \text { in } \Omega_{2} \\ \frac{\partial w_{2}}{\partial n}=\eta & \text { on } \Gamma \\ w_{2}=0 \quad & \text { on } \partial \Omega_{2} \backslash \Gamma\end{cases}
\label{19.37}\end{equation}

现在设置

!!!!
\eta=-\frac{\partial u_{1}^{(k)}}{\partial n}+\frac{\partial}{\partial n}\left(G_{2} f_{2}\right)
$$

并将(19.36)与(19.37)相比较，我们得出结论，即

!!!!
u_{2}^{(k)}{ }_{\Gamma}=\left(u_{2}^{(k)}-G_{2} f_{2}\right)_{\mid \Gamma}=S_{2}^{-1}\left(-\frac{\partial u_{1}^{(k)}}{\partial n}+\frac{\partial}{\partial n}\left(G_{2} f_{2}\right)\right)
$$

另一方面，由于\ref{19.35}和$\chi$的定义\ref{19.28} ，我们可以得到

!!!!
\begin{aligned}
u_{2}^{(k)}{ }_{\Gamma} &=S_{2}^{-1}\left(-\frac{\partial}{\partial n}\left(H_{1} \lambda^{(k-1)}\right)-\frac{\partial}{\partial n}\left(G_{1} f_{1}\right)+\frac{\partial}{\partial n}\left(G_{2} f_{2}\right)\right) \\
&=S_{2}^{-1}\left(-S_{1} \lambda^{(k-1)}+\chi\right)
\end{aligned}
$$

因此，利用\ref{19.33} 我们可以写出

!!!!
\lambda^{(k)}=\theta\left[S_{2}^{-1}\left(-S_{1} \lambda^{(k-1)}+\chi\right)\right]+(1-\theta) \lambda^{(k-1)}
$$

就是说

!!!!
\lambda^{(k)}-\lambda^{(k-1)}=\theta\left[S_{2}^{-1}\left(-S_{1} \lambda^{(k-1)}+\chi\right)-\lambda^{(k-1)}\right]
$$

由于$-S_{1}=S_{2}-S$，我们最后得到

!!!!
\begin{aligned}
\lambda^{(k)}-\lambda^{(k-1)} &=\theta\left[S_{2}^{-1}\left(\left(S_{2}-S\right) \lambda^{(k-1)}+\chi\right)-\lambda^{(k-1)}\right] \\
&=\theta S_{2}^{-1}\left(\chi-S \lambda^{(k-1)}\right)
\end{aligned}
$$

也就是\ref{19.34} 。因此，预设的$D N$算子是$S_{2}^{-1} S=I+S_{2}^{-1} S_{1}$。

![](https://cdn.mathpix.com/cropped/991f5db518e324d299c1ff4972bba9fb-180.jpg?height=26&width=34&top_left_y=1212&top_left_x=762)

使用与定理19.2的证明类似的论证，诺伊曼-诺伊曼（NN）算法\ref{19.17} -\ref{19.19} 也可以被解释为预设条件的理查德森算法，即

!!!!
P_{N N}\left(\lambda^{(k)}-\lambda^{(k-1)}\right)=\theta\left(\chi-S \lambda^{(k-1)}\right)
$$

这次的前置条件是$P_{N N}=\left(D_{1} S_{1}^{-1} D_{1}+D_{2} S_{2}^{-1} D_{2}\right)^{-1}$，其中$D_{i}$是一个对角矩阵，其条目等于$\sigma_{i}$ 。请注意，预处理运算符变成（如果$\left.D_{i}=I\right) S_{2}^{-1} S_{1}+2 I+\left(S_{2}^{-1} S_{1}\right)^{-1}$ .最后考虑一下罗宾-罗宾迭代算法 \ref{19.20}-(19.21)$ 。用$\mu_{i}^{(k)} \in \Lambda$表示$k$步骤中$u_{i}^{(k)}$在界面$\Gamma, i=1,2$上的轨迹的近似值，可以证明\ref{19.20}-(19.21)$等同于以下交替方向（ADI）算法。

!!!!
\begin{aligned}
&\left(\gamma_{1} i_{\Lambda}+S_{1}\right) \mu_{1}^{(k)}=\chi+\left(\gamma_{1} i_{\Lambda}+S_{2}\right) \mu_{2}^{(k-1)} \\
&\left(\gamma_{2} i_{\Lambda}+S_{2}\right) \mu_{2}^{(k)}=\chi+\left(\gamma_{2} i_{\Lambda}+S_{1}\right) \mu_{1}^{(k-1)}
\end{aligned}
$$

其中$i_{\Lambda}: \Lambda \rightarrow \Lambda^{\prime}$在此表示希尔伯特空间$\Lambda$与其对偶$\Lambda^{\prime}$之间的里兹同构（见$(2.5)$；不过，注意不同的符号）。

如果对于两个参数$\gamma_{1}$和$\gamma_{2}$的方便选择，算法应该收敛到两个极限函数$\mu_{1}$和$\mu_{2}$，然后$\mu_{1}=\mu_{2}=\lambda$，后一个函数是斯特克洛夫-波恩卡雷方程的解\ref{19.26}。

RR预处理程序读作 $P_{R R}=\left(\gamma_{1}+\gamma_{2}\right)^{-1}\left(\gamma_{1} i_{\Lambda}+S_{1}\right)\left(\gamma_{2} i_{\Lambda}+S_{2}\right)$ 。

备注19.1。在Dirichlet-Neumann算法中，解$\lambda$在界面$\Gamma$的值是主要的未知数。一旦它被确定，我们就可以把它作为迪里切特数据来恢复整个域中的原始解。或者，我们可以使用$\eta=\frac{\partial u}{\partial n}$上的法向导数$\Gamma$作为主未知数（或者，对于更一般的偏微分算子，法向导数--或通量）。通过上述步骤，我们可以证明$\eta$满足新的斯特克洛夫-波因卡雷方程

!!!!
\left(S_{1}^{-1}+S_{2}^{-1}\right) \eta=T_{1} f_{1}+T_{2} f_{2} \quad \text { on } \Gamma
\label{19.38}\end{equation}

其中对于$i=1,2, T_{i} f_{i}$是以下诺伊曼问题的解

!!!!
\begin{cases}-\triangle\left(T_{i} f_{i}\right)=f_{i} & \text { in } \Omega_{i} \\ \frac{\partial}{\partial n_{i}}\left(T_{i} f_{i}\right)=0 & \text { on } \Gamma \\ T_{i} f_{i}=0 & \text { on } \partial \Omega \backslash \Gamma\end{cases}
\label{19.39}\end{equation}

所谓的FETI算法（见第19.5.4节）是为解决类似\ref{19.38} 问题而设计的迭代算法的例子。FETI的预处理程序是$P_{F E T I}=S_{1}+S_{2}$，因此预处理的FETI算子是$\left(S_{1}+S_{2}\right)\left(S_{1}^{-1}+S_{2}^{-1}\right)$。

\subsection{Multidomain formulation of the finite element approximation of the Poisson problem}

到目前为止，所看到的可以被视为边界值问题的数值解法的先导。在本节中，我们将看到如何在数值离散化方法的框架内重塑前面的想法。虽然我们将只讨论有限元离散化的情况，但这并不是限制性的。例如，我们可以参考[CHQZ07]和[TW05]中关于谱或谱元离散的情况，以及[Woh01]中关于基于DG和砂浆方法的离散情况。

考虑泊松问题(3.13)、其弱式(3.18)及其在三角形$\mathscr{T}_{h}$上的Galerkin有限元近似\ref{4.40} 。回顾一下，$V_{h}=\dot{X}_{h}^{r}=\left\{v_{h} \in\right.$ $\left.X_{h}^{r}:\left.v_{h}\right|_{\partial \Omega}=0\right\}$是在$r$上消失的度数为$\partial \Omega$的有限元函数空间，其基础是$\left\{\varphi_{j}\right\}_{j=1}^{N_{h}}$（见4.5.1节）。

对于域$\Omega$中的有限元节点，我们考虑以下分区：让$\left\{x_{j}^{(1)}, 1 \leq j \leq N_{1}\right\}$为位于子域$\Omega_{1},\left\{x_{j}^{(2)}, 1 \leq j \leq N_{2}\right\}$中的节点，$\Omega_{2}$中的节点，最后，$\left\{x_{j}^{(\Gamma)}, 1 \leq j \leq N_{\Gamma}\right\}$为位于界面$\Gamma$上的节点 。让我们相应地分割基函数。  $\varphi_{j}^{(1)}$将表示那些与节点相关的$x_{j}^{(1)}, \varphi_{j}^{(2)}$，那些与节点$x_{j}^{(2)}$相关的，以及$\varphi_{j}^{(\Gamma)}$那些与位于界面上的节点$x_{j}^{(\Gamma)}$相关的。这就产生了

!!!!
\varphi_{j}^{(\alpha)}\left(x_{j}^{(\beta)}\right)=\delta_{i j} \delta_{\alpha \beta}, \quad 1 \leq i \leq N_{\alpha}, \quad \leq j \leq \mathbb{N}_{\beta}
\label{19.40}\end{equation}

与$\alpha, \beta=1,2, \Gamma ; \delta_{i j}$是克朗克符号。

通过让$v_{h}$中的\ref{4.40}与一个测试函数重合，\ref{4.40}可以得到以下等效的表述：找到$u_{h} \in V_{h}$，使之。

!!!!
\begin{cases}a\left(u_{h}, \varphi_{i}^{(1)}\right)=F\left(\varphi_{i}^{(1)}\right) & \forall i=1, \ldots, N_{1} \\ a\left(u_{h}, \varphi_{j}^{(2)}\right)=F\left(\varphi_{j}^{(2)}\right) & \forall j=1, \ldots, N_{2} \\ a\left(u_{h}, \varphi_{k}^{(\Gamma)}\right)=F\left(\varphi_{k}^{(\Gamma)}\right) & \forall k=1, \ldots, N_{\Gamma}\end{cases}
\label{19.41}\end{equation}

有集$F(v)=\int_{\Omega} f v d \Omega$ 。现在让

!!!!
a_{i}(v, w)=\int_{\Omega_{i}} \nabla_{v} \cdot \nabla w d \Omega \quad \forall v, w \in V, i=1,2
$$

是双线性形式$a(., .)$对子域$\Omega_{i}$的限制，并在$\left.\partial \Omega_{i} \backslash \Gamma\right\}(i=1,2)$上定义$V_{i, h}=\{v \in!!!!H^{1}\left(\Omega_{i}\right) \mid v=0$ 。同样，我们设定$F_{i}(v)=\int_{\Omega_{i}} f v d \Omega$，用$u_{h}^{(i)}=\left.u_{h}\right|_{\Omega_{i}}$表示$u_{h}$对子域$\Omega_{i}$的限制，用$i=1,2$ 表示。问题\ref{19.41} 可以改写为等价形式：找到$u_{h}^{(1)} \in V_{1, h}, u_{h}^{(2)} \in V_{2, h}$，使得

!!!!
\begin{cases}a_{1}\left(u_{h}^{(1)}, \varphi_{i}^{(1)}\right)=F_{1}\left(\varphi_{i}^{(1)}\right) & \forall i=1, \ldots, N_{1} \\ a_{2}\left(u_{h}^{(2)}, \varphi_{j}^{(2)}\right)=F_{2}\left(\varphi_{j}^{(2)}\right) & \forall j=1, \ldots, N_{2} \\ a_{1}\left(u_{h}^{(1)},\left.\varphi_{k}^{(\Gamma)}\right|_{\Omega_{1}}\right)+a_{2}\left(u_{h}^{(2)},\left.\varphi_{k}^{(\Gamma)}\right|_{\Omega_{2}}\right) & \\ =F_{1}\left(\left.\varphi_{k}^{(\Gamma)}\right|_{\Omega_{1}}\right)+F_{2}\left(\left.\varphi_{k}^{(\Gamma)}\right|_{\Omega_{2}}\right) & \forall k=1, \ldots, N_{\Gamma}\end{cases}
\label{19.42}\end{equation}

由于函数$u_{h}^{(i)}$的连续性，界面连续性条件\ref{19.22}_{5}$被自动满足。此外，方程\ref{19.42}_{1}-(19.42)_{3}$分别对应于方程\ref{19.22}_{1}-(19.22)_{6}$的有限元离散化。特别是，方程\ref{19.42}中的第三个必须被视为条件(19.22)$_{6}$的离散对应物，表示$\Gamma$上法向导数的连续性。

让我们将解$u_{h}$与基函数$V_{h}$进行扩展

!!!!
u_{h}(x)=\sum_{j=1}^{N_{1}} u_{h}\left(x_{j}^{(1)}\right) \varphi_{j}^{(1)}(x)+\sum_{j=1}^{N_{2}} u_{h}\left(x_{j}^{(2)}\right) \varphi_{j}^{(2)}(x)+\sum_{j=1}^{N_{\Gamma}} u_{h}\left(x_{j}^{(\Gamma)}\right) \varphi_{j}^{(\Gamma)}(x)
\label{19.43}\end{equation}

从现在开始，节点值$u_{h}\left(x_{j}^{(\alpha)}\right)$ ，对于$\alpha=1,2, \Gamma$和$j=1, \ldots, N_{\alpha}$，也就是膨胀系数，将用速记符号$u_{j}^{(\alpha)}$表示。使用\ref{19.43} ，我们可以将\ref{19.42} 重写如下。

!!!!
\begin{aligned}
&\sum_{j=1}^{N_{1}} u_{j}^{(1)} a_{1}\left(\varphi_{j}^{(1)}, \varphi_{i}^{(1)}\right)+\sum_{j=1}^{N_{\Gamma}} u_{j}^{(\Gamma)} a_{1}\left(\varphi_{j}^{(\Gamma)}, \varphi_{i}^{(1)}\right)=F_{1}\left(\varphi_{i}^{(1)}\right) \quad \forall i=1, \ldots, N_{1} \\
&\sum_{j=1}^{N_{2}} u_{j}^{(2)} a_{2}\left(\varphi_{j}^{(2)}, \varphi_{i}^{(2)}\right)+\sum_{j=1}^{N_{\Gamma}} u_{j}^{(\Gamma)} a_{2}\left(\varphi_{j}^{(\Gamma)}, \varphi_{i}^{(2)}\right)=F_{2}\left(\varphi_{i}^{(2)}\right) \quad \forall i=1, \ldots, N_{2} \\
&\sum_{j=1}^{N_{\Gamma}} u_{j}^{(\Gamma)}\left[a_{1}\left(\varphi_{j}^{(\Gamma)}, \varphi_{i}^{(\Gamma)}\right)+a_{2}\left(\varphi_{j}^{(\Gamma)}, \varphi_{i}^{(\Gamma)}\right)\right] \\
&\quad+\sum_{j=1}^{N_{1}} u_{j}^{(1)} a_{1}\left(\varphi_{j}^{(1)}, \varphi_{i}^{(\Gamma)}\right)+\sum_{j=1}^{N_{2}} u_{j}^{(2)} a_{2}\left(\varphi_{j}^{(2)}, \varphi_{i}^{(\Gamma)}\right) \\
&=F_{1}\left(\left.\varphi_{i}^{(\Gamma)}\right|_{\Omega_{1}}\right)+F_{2}\left(\left.\varphi_{i}^{(\Gamma)}\right|_{\Omega_{2}}\right) \quad \forall i=1, \ldots, N_{\Gamma}
\end{aligned}
\label{19.44}\end{equation}

让我们介绍一下下列数组。

!!!!
\begin{array}{ll}
\left(A_{11}\right)_{i j}=a_{1}\left(\varphi_{j}^{(1)}, \varphi_{i}^{(1)}\right), & \left(A_{1 \Gamma}\right)_{i j}=a_{1}\left(\varphi_{j}^{(\Gamma)}, \varphi_{i}^{(1)}\right) \\
\left(A_{22}\right)_{i j}=a_{2}\left(\varphi_{j}^{(2)}, \varphi_{i}^{(2)}\right), & \left(A_{2 \Gamma}\right)_{i j}=a_{2}\left(\varphi_{j}^{(\Gamma)}, \varphi_{i}^{(2)}\right) \\
\left(A_{\Gamma \Gamma}^{1}\right)_{i j}=a_{1}\left(\varphi_{j}^{(\Gamma)}, \varphi_{i}^{(\Gamma)}\right), & \left(A_{\Gamma \Gamma}^{2}\right)_{i j}=a_{2}\left(\varphi_{j}^{(\Gamma)}, \varphi_{i}^{(\Gamma)}\right), \\
\left(A_{\Gamma 1}\right)_{i j}=a_{1}\left(\varphi_{j}^{(1)}, \varphi_{i}^{(\Gamma)}\right), & \left(A_{\Gamma 2}\right)_{i j}=a_{2}\left(\varphi_{j}^{(2)}, \varphi_{i}^{(\Gamma)}\right) \\
\left(\mathbf{f}_{1}\right)_{i}=F_{1}\left(\varphi_{i}^{(1)}\right), & \left(\mathbf{f}_{2}\right)_{i}=F_{2}\left(\varphi_{i}^{(2)}\right) \\
\left(\mathbf{f}_{1}^{\Gamma}\right)_{i}=F_{1}\left(\varphi_{i}^{(\Gamma)}\right), & \left(\mathbf{f}_{2}^{\Gamma}\right)_{i}=F_{2}\left(\varphi_{i}^{(\Gamma)}, \varphi_{i}^{(1)}\right),
\end{array}
$$

然后设置

!!!!
\mathbf{u}=\left(\mathbf{u}_{1}, \mathbf{u}_{2}, \boldsymbol{\lambda}\right)^{T}, \text { with } \mathbf{u}_{1}=\left(u_{j}^{(1)}\right), \mathbf{u}_{2}=\left(u_{j}^{(2)}\right) \text { and } \boldsymbol{\lambda}=\left(u_{j}^{(\Gamma)}\right)
\label{19.45}\end{equation}

问题\ref{19.44} 可以用下面的代数形式来表示

!!!!
\left\{\begin{array}{l}
A_{11} \mathbf{u}_{1}+A_{1 \Gamma} \boldsymbol{\lambda}=\mathbf{f}_{1} \\
A_{22} \mathbf{u}_{2}+A_{2 \Gamma} \boldsymbol{\lambda}=\mathbf{f}_{2} \\
A_{\Gamma 1} \mathbf{u}_{1}+A_{\Gamma 2} \mathbf{u}_{2}+\left(A_{\Gamma \Gamma}^{(1)}+A_{\Gamma \Gamma}^{(2)}\right) \boldsymbol{\lambda}=\mathbf{f}_{1}^{\Gamma}+\mathbf{f}_{2}^{\Gamma}
\end{array}\right.
\label{19.46}\end{equation}

或者，等同于。

!!!!
A \mathbf{u}=\mathbf{f}, \text { that is }\left[\begin{array}{ccc}
A_{11} & 0 & A_{1 \Gamma} \\
0 & A_{22} & A_{2 \Gamma} \\
A_{\Gamma 1} & A_{\Gamma 2} & A_{\Gamma \Gamma}
\end{array}\right]\left[\begin{array}{l}
\mathbf{u}_{1} \\
\mathbf{u}_{2} \\
\lambda
\end{array}\right]=\left[\begin{array}{l}
\mathbf{f}_{1} \\
\mathbf{f}_{2} \\
\mathbf{f}_{\Gamma}
\end{array}\right]
\label{19.47}\end{equation}

集$A_{\Gamma \Gamma}=\left(A_{\Gamma \Gamma}^{(1)}+A_{\Gamma \Gamma}^{(2)}\right)$和$\mathbf{f}_{\Gamma}=\mathbf{f}_{1}^{\Gamma}+\mathbf{f}_{2}^{\Gamma} .(19.47)$只不过是有限元系统\ref{4.46}的块状表示，这些块由未知数矢量的划分\ref{19.45} 决定。

更确切地说，\ref{19.46} 的第一个和第二个方程是$\Omega_{1}$和$\Omega_{2}$中给定泊松问题的离散化，分别为内部值$\mathbf{u}_{1}$和$\mathbf{u}_{2}$，Dirichlet数据在$\partial \Omega_{i} \backslash \Gamma$上消失，并等于$\Gamma$的公共值。另外，通过设置（从\ref{19.46}的第三个方程中），可以看出

!!!!
A_{\Gamma_{1}} \mathbf{u}_{1}+A_{\Gamma \Gamma}^{(1)} \boldsymbol{\lambda}-\mathbf{f}_{\Gamma}^{1}=-\left(A_{\Gamma_{2}} \mathbf{u}_{2}+A_{\Gamma \Gamma}^{(2)} \boldsymbol{\lambda}-\mathbf{f}_{\Gamma}^{2}\right) \equiv \boldsymbol{\eta}
\label{19.48}\end{equation}

(19.46)的第一个和第三个方程提供了$\Omega_{1}$中泊松问题的离散化，其中$\partial \Omega_{1} \backslash \Gamma$上的迪里希特数据消失，$\eta$上的诺伊曼数据消失。

类似的考虑适用于\ref{19.46} 的第二和第三个方程：它们代表了$\Omega_{2}$中泊松问题的离散化，在$\partial \Omega_{2} \backslash \Gamma$中的迪里希特数据为零，在$\Gamma$上的诺伊曼数据等于$\eta$ 。

\subsubsection{The Schur complement}

现在考虑Steklov-Poincaré界面方程\ref{19.26} ，并寻找其有限元对应物。由于$\lambda$代表$u$在$\Gamma$上的未知值，它的有限元对应物是$\lambda$在界面节点的值的向量。

通过对系统\ref{19.47} 进行高斯消除，我们可以得到一个新的关于唯一未知数$\boldsymbol{\lambda}$的还原系统。

矩阵$A_{11}$和$A_{22}$是可逆的，因为它们与拉普拉斯算子的两个同质迪里切特边界值问题相关，因此

!!!!
\mathbf{u}_{1}=A_{11}^{-1}\left(\mathbf{f}_{1}-A_{1 \Gamma} \boldsymbol{\lambda}\right) \quad \text { and } \quad \mathbf{u}_{2}=A_{22}^{-1}\left(\mathbf{f}_{2}-A_{2 \Gamma} \boldsymbol{\lambda}\right)
\label{19.49}\end{equation}

从\ref{19.46} 中的第三个方程，我们得到

!!!!
\begin{aligned}
&{\left[\left(A_{\Gamma \Gamma}^{(1)}-A_{\Gamma 1} A_{11}^{-1} A_{1 \Gamma}\right)+\left(A_{\Gamma \Gamma}^{(2)}-A_{\Gamma 2} A_{22}^{-1} A_{2 \Gamma}\right)\right] \boldsymbol{\lambda}} \\
&=\mathbf{f}_{\Gamma}-A_{\Gamma 1} A_{11}^{-1} \mathbf{f}_{1}-A_{\Gamma 2} A_{22}^{-1} \mathbf{f}_{2}=\left(\mathbf{f}_{\Gamma}^{(1)}-A_{\Gamma_{1}} A_{11}^{-1} \mathbf{f}_{1}\right)+\left(\mathbf{f}_{\Gamma}^{(2)}-A_{\Gamma_{2}} A_{22}^{-1} \mathbf{f}_{2}\right)
\end{aligned}
\label{19.50}\end{equation}

使用以下定义。

!!!!
\Sigma=\Sigma_{1}+\Sigma_{2}, \quad \Sigma_{i}=A_{\Gamma \Gamma}^{(i)}-A_{\Gamma i} A_{i i}^{-1} A_{i \Gamma}, \quad i=1,2
\label{19.51}\end{equation}

和

!!!!
\chi_{\Gamma}=\chi_{\Gamma}^{(1)}+\chi_{\Gamma}^{(2)}, \quad \chi_{\Gamma}^{(i)}=\mathbf{f}_{\Gamma}^{(i)}-A_{\Gamma_{i}} A_{i i} \mathbf{f}_{i}
\label{19.52}\end{equation}

(19.50)变成

!!!!
\Sigma \boldsymbol{\lambda}=\chi_{\Gamma}
\label{19.53}\end{equation}

由于$\Sigma$和$\chi_{\Gamma}$分别近似于$S$和$\chi$，\ref{19.53} 可以被认为是Steklov-Poincaré方程\ref{19.26} 的有限元近似。矩阵$\Sigma$是$A$关于$\mathbf{u}_{1}$和$\mathbf{u}_{2}$的所谓Schur补，而矩阵$\Sigma_{i}$是与子域$\Omega_{i}(i=1,2)$有关的Schur补。

一旦系统\ref{19.53} 解决了未知数$\lambda$，根据\ref{19.49} 我们可以计算出$\mathbf{u}_{1}$和$\mathbf{u}_{2}$。这种计算相当于在两个子域$\Omega_{1}$和$\Omega_{2}$上数值解决两个泊松问题，在界面$\left.u_{h}^{(i)}\right|_{\Gamma}=\lambda_{h}(i=!!!!1,2)$上有迪里希特的边界条件。

舒尔补码$\Sigma$继承了其生成矩阵$A$的一些特性，如下结果所述。

Lemma 19.1. Matrix $\Sigma$ satisfies the following properties:
1. if A is singular, so is $\Sigma$;
2. if A (respectively, $A_{i i}$ ) is symmetric, then $\Sigma$ (respectively, $\Sigma_{i}$ ) is symmetric too;
3. if $A$ is positive definite, so is $\Sigma$.

回顾一下，有限元刚度矩阵$A$的条件数满足$K_{2}(A) \simeq C h^{-2}$（见\ref{4.50}）。至于$\Sigma$，可以证明的是

!!!!
K_{2}(\Sigma) \simeq C h^{-1} .
\label{19.54}\end{equation}

在所考虑的具体情况下，$A$（以及因此$\Sigma$，由于Lemma 19.1）是对称和正定的。因此，使用共轭梯度法（带有合适的预处理程序）来解决系统\ref{19.53} 是很方便的。在每次迭代中，残差的计算将涉及到子域上两个独立的Dirichlet边界值问题的有限元解 $\Omega_{i}$ 。通过采用类似的程序，我们可以推导出\ref{19.53} 中引入的通量$\eta$的界面方程来代替\ref{19.48} 。从\ref{19.47} 和\ref{19.48} 我们可以得出

!!!!
\left[\begin{array}{cc}
A_{11} & A_{1 \Gamma} \\
A_{\Gamma 1} & A_{\Gamma \Gamma}^{(1)}
\end{array}\right]\left[\begin{array}{c}
\mathbf{u}_{1} \\
\boldsymbol{\lambda}
\end{array}\right]=\left[\begin{array}{c}
\mathbf{f}_{1} \\
\mathbf{f}_{\Gamma}^{(1)}+\boldsymbol{\eta}
\end{array}\right]
\label{19.55}\end{equation}

通过消除第一行中的$\mathbf{u}_{1}$并将其替换到第二行中，我们可以得到

!!!!
\Sigma_{1} \boldsymbol{\lambda}=\chi_{\Gamma}^{(1)}+\boldsymbol{\eta}, \text { that is } \boldsymbol{\lambda}=\Sigma_{1}^{-1}\left(\chi_{\Gamma}^{(1)}+\boldsymbol{\eta}\right)
\label{19.56}\end{equation}

以类似方式进行，我们得到

!!!!
\Sigma_{2} \boldsymbol{\lambda}=\chi_{\Gamma}^{(2)}-\boldsymbol{\eta}, \text { that is } \boldsymbol{\lambda}=\Sigma_{2}^{-1}\left(\chi_{\Gamma}^{(2)}-\boldsymbol{\eta}\right)
\label{19.57}\end{equation}

通过将最后两个方程（其共同值为$\boldsymbol{\lambda}$）等价，我们最终得到通量的舒尔补足方程 $\eta$ 。

!!!!
T \eta=\psi_{\Gamma}, \quad \text { with } T=\Sigma_{1}^{-1}+\Sigma_{2}^{-1}, \psi_{\Gamma}=\Sigma_{2}^{-1} \chi_{\Gamma}^{(2)}-\Sigma_{1}^{-1} \chi_{\Gamma}^{(1)}
\label{19.58}\end{equation}

这个代数方程可以被看作是通量\ref{19.38} 的Steklov-Poincaré问题的直接离散化。

\subsection{The discrete Steklov-Poincaré operator}.

在本节中，我们将找到与舒尔补数相关的离散算子。为此，除了前面介绍的空间$V_{i, h}$外，我们还需要由专门与子域$\Omega_{i}$的内部节点相关的函数$\left\{\varphi_{j}^{(i)}\right\}$产生的空间$V_{i, h}^{0}$，以及由函数集$\left.\left\{\varphi_{j}^{(\Gamma)}\right\}_{\Gamma}\right\}$产生的空间$\Lambda_{h}$。我们有 $\Lambda_{h}=\left\{\mu_{h}\left|\exists v_{h} \in V_{h}: v_{h}\right|_{\Gamma}=\mu_{h}\right\}$ ，因此 $\Lambda_{h}$ 代表 \ref{19.30} 中介绍的跟踪函数空间 $\Lambda$ 的一个有限元子空间。

现在考虑这个问题：找到$H_{i, h} \eta_{h} \in V_{i, h}$，与$H_{i, h} \eta_{h}=\eta_{h}$在$\Gamma$上，以便

!!!!
\int_{\Omega_{i}} \nabla\left(H_{i, h} \eta_{h}\right) \cdot \nabla v_{h} d \Omega_{i}=0 \quad \forall v_{h} \in V_{i, h}^{0}
\label{19.59}\end{equation}

显然，$H_{i, h} \eta_{h}$代表了谐波扩展$H_{i} \eta_{h}$的有限元近似，而算子$H_{i, h}: \eta_{h} \rightarrow H_{i, h} \eta_{h}$可以被视为$H_{i}$的近似。通过将$H_{i, h} \eta_{h}$以基函数的形式展开

!!!!
H_{i, h} \eta_{h}=\sum_{j=1}^{N_{i}} u_{j}^{(i)} \varphi_{j}^{(i)}+\left.\sum_{k=1}^{N_{\Gamma}} \eta_{k} \varphi_{k}^{(\Gamma)}\right|_{\Omega_{i}}
$$

我们可以用矩阵形式重写(19.59)

!!!!
A_{i i} \mathbf{u}^{(i)}=-A_{i \Gamma} \boldsymbol{\eta}
\label{19.60}\end{equation}

下面的结果，称为均匀离散扩展定理，是成立的。


Theorem 19.3. There exist two constants $\hat{C}_{1}, \hat{C}_{2}>0$, independent of $h$, such t hat
!!!!
\hat{C}_{1}\left\|\eta_{h}\right\|_{\Lambda} \leq\left\|H_{i, h} \eta_{h}\right\|_{H^{1}\left(\Omega_{i}\right)} \leq \hat{C}_{2}\left\|\eta_{h}\right\|_{\Lambda} \quad \forall \eta_{h} \in \Lambda_{h} i=1,2
\label{19.61}\end{equation}

Consequently, there exist two constants $K_{1}, K_{2}>0$, independent of $h$, such that

!!!!
K_{1}\left\|H_{1, h} \eta_{h}\right\|_{H^{1}\left(\Omega_{1}\right)} \leq\left\|H_{2, h} \eta_{h}\right\|_{H^{1}\left(\Omega_{2}\right)} \leq K_{2}\left\|H_{1, h} \eta_{h}\right\|_{H^{1}\left(\Omega_{1}\right)} \quad \forall \eta_{h} \in \Lambda_{h}
\label{19.62}\end{equation}

证明见，例如， [QV99] 。

现在对于$i=1,2$的（局部）离散斯特克洛夫-波因卡雷算子$S_{i, h}: \Lambda_{h} \rightarrow \Lambda_{h}^{\prime}$定义如下

!!!!
\left\langle S_{i, h} \eta_{h}, \mu_{h}\right\rangle=\int_{\Omega_{i}} \nabla\left(H_{i, h} \eta_{h}\right) \cdot \nabla\left(H_{i, h} \mu_{h}\right) d \Omega_{i} \quad \forall \eta_{h}, \mu_{h} \in \Lambda_{h}
\label{19.63}\end{equation}

那么我们定义（全局）离散Steklov-Poincaré算子为 $S_{h}=S_{1, h}+S_{2, h}$ 。


Lemma 19.2. The local discrete Steklov-Poincaré operator can be expressed in terms of the local Schur complement as

!!!!
\left\langle S_{i, h} \eta_{h}, \mu_{h}\right\rangle=\boldsymbol{\mu}^{T} \Sigma_{i} \eta \quad \forall \eta_{h}, \mu_{h} \in \Lambda_{h}, i=1,2
\label{19.64}\end{equation}

where

!!!!
\eta_{h}=\sum_{k=1}^{N_{\Gamma}} \eta_{k} \varphi_{k}^{(\Gamma)}{ }_{\Gamma}, \quad \mu_{h}=\sum_{k=1}^{N_{\Gamma}} \mu_{k} \varphi_{k}^{(\Gamma)}{ }_{\Gamma}
$$

and

!!!!
\boldsymbol{\eta}=\left(\eta_{1}, \ldots, \eta_{N_{\Gamma}}\right)^{T}, \quad \boldsymbol{\mu}=\left(\mu_{1}, \ldots, \mu_{N_{\Gamma}}\right)^{T}
$$

Therefore the global discrete Steklov-Poincaré operator $S_{h}=S_{1, h}+S_{2, h}$ satisfies the relation

!!!!
\left\langle S_{h} \eta_{h}, \mu_{h}\right\rangle=\boldsymbol{\mu}^{T} \Sigma \boldsymbol{\eta} \quad \forall \eta_{h}, \mu_{h} \in \Lambda_{h}
\label{19.65}\end{equation}





证明。对于$i=1,2$我们有

!!!!
\begin{aligned}
\left\langle S_{i, h} \eta_{h}, \mu_{h}\right\rangle &=a_{i}\left(H_{i, h} \eta_{h}, H_{i, h} \mu_{h}\right) \\
&=a_{i}\left(\sum_{j=1}^{N_{\Gamma}} u_{j} \varphi_{j}^{(i)}+\left.\sum_{k=1}^{N_{\Gamma}} \eta_{k} \varphi_{k}^{(\Gamma)}\right|_{\Omega_{i}}, \sum_{l=1}^{N_{\Gamma}} w_{l} \varphi_{l}^{(i)}+\left.\sum_{m=1}^{N_{\Gamma}} \mu_{m} \varphi_{m}^{(\Gamma)}\right|_{\Omega_{i}}\right)
\end{aligned}
$$



!!!!
\begin{aligned}
=& \sum_{j, l=1}^{N_{\Gamma}} w_{l} a_{i}\left(\varphi_{j}^{(i)}, \varphi_{l}^{(i)}\right) u_{j}+\sum_{j, m=1}^{N_{\Gamma}} \mu_{m} a_{i}\left(\varphi_{j}^{(i)},\left.\varphi_{m}^{(\Gamma)}\right|_{\Omega_{i}}\right) u_{j} \\
&+\sum_{k, l=1}^{N_{\Gamma}} w_{l} a_{i}\left(\left.\varphi_{k}^{(\Gamma)}\right|_{\Omega_{i}}, \varphi_{l}^{(i)}\right) \eta_{k}+\sum_{k, m=1}^{N_{\Gamma}} \mu_{m} a_{i}\left(\left.\varphi_{k}^{(\Gamma)}\right|_{\Omega_{i}},\left.\varphi_{m}^{(\Gamma)}\right|_{\Omega_{i}}\right) \eta_{k} \\
=& \mathbf{w}^{T} A_{i i} \mathbf{u}+\boldsymbol{\mu}^{T} A_{\Gamma i} \mathbf{u}+\mathbf{w}^{T} A_{i \Gamma} \boldsymbol{\eta}+\boldsymbol{\mu}^{T} A_{\Gamma \Gamma}^{(i)} \boldsymbol{\eta}
\end{aligned}
$$

感谢\ref{19.60}，我们得到了

!!!!
\begin{aligned}
\left\langle S_{i, h} \eta_{h}, \mu_{h}\right\rangle &=-\mathbf{w}^{T} A_{i \Gamma} \eta-\boldsymbol{\mu}^{T} A_{\Gamma i} A_{i i}^{-1} A_{i \Gamma} \boldsymbol{\eta}+\mathbf{w}^{T} A_{i \Gamma} \boldsymbol{\eta}+\boldsymbol{\mu}^{T} A_{\Gamma \Gamma}^{(i)} \boldsymbol{\eta} \\
&=\boldsymbol{\mu}^{T}\left(A_{\Gamma \Gamma}^{(i)}-A_{\Gamma i} A_{i i}^{-1} A_{i \Gamma}\right) \eta \\
&=\boldsymbol{\mu}^{T} \Sigma_{i} \boldsymbol{\eta}
\end{aligned}
$$

从定理$19.3$和感谢表示\ref{19.63} ，我们推断出存在两个独立于$h$的常数$\hat{K}_{1}, \hat{K}_{2}>0$，使得

!!!!
\hat{K}_{1}\left\langle S_{1, h} \mu_{h}, \mu_{h}\right\rangle \leq\left\langle S_{2, h} \mu_{h}, \mu_{h}\right\rangle \leq \hat{K}_{2}\left\langle S_{1, h} \mu_{h}, \mu_{h}\right\rangle \quad \forall \mu_{h} \in \Lambda_{h}
\label{19.66}\end{equation}

由于\ref{19.64} ，我们可以推断出存在两个常数$\tilde{K}_{1}, \tilde{K}_{2}>0$，独立于$h$，从而

!!!!
\tilde{K}_{1}\left(\boldsymbol{\mu}^{T} \Sigma_{1} \boldsymbol{\mu}\right) \leq \boldsymbol{\mu}^{T} \Sigma_{2} \boldsymbol{\mu} \leq \tilde{K}_{2}\left(\boldsymbol{\mu}^{T} \Sigma_{1} \boldsymbol{\mu}\right) \quad \forall \boldsymbol{\mu} \in \mathbb{R}^{N_{\Gamma}}
\label{19.67}\end{equation}

这相当于说，两个矩阵$\Sigma_{1}$和$\Sigma_{2}$是光谱等价的，即它们的光谱条件数与$h$具有相同的渐近行为。因此，$\Sigma_{1}$和$\Sigma_{2}$都提供了舒尔补码$\Sigma$的最佳预处理，即存在一个独立于$h$的常数$C$，使得

!!!!
K_{2}\left(\Sigma_{i}^{-1} \Sigma\right) \leq C, \quad i=1,2
\label{19.68}\end{equation}

正如我们将在第19.3.3节中看到的那样，这个属性使我们能够证明离散版的Dirichlet-Neumann算法以独立于$h$的速率收敛。类似的结果也适用于离散的Neumann-Neumann和Robin-Robin算法。

\subsubsection{Equivalence between the Dirichlet-Neumann algorithm and a preconditioned Richardson algorithm in the discrete case}

现在让我们来证明代数情况下的等价定理$19.2$的类似物。Dirichlet问题(19.31)的有限元近似有以下代数形式

!!!!
A_{11} \mathbf{u}_{1}^{(k)}=\mathbf{f}_{1}-A_{1 \Gamma} \boldsymbol{\lambda}^{(k-1)}
\label{19.69}\end{equation}

而诺伊曼问题\ref{19.32} 的内容为

!!!!
\left[\begin{array}{cc}
A_{22} & A_{2 \Gamma} \\
A_{\Gamma 2} & A_{\Gamma \Gamma}^{(2)}
\end{array}\right]\left[\begin{array}{c}
\mathbf{u}_{2}^{(k)} \\
\boldsymbol{\lambda}^{(k-1 / 2)}
\end{array}\right]=\left[\begin{array}{c}
\mathbf{f}_{2} \\
\mathbf{f}_{\Gamma}-A_{\Gamma 1} \mathbf{u}_{1}^{(k)}-A_{\Gamma \Gamma}^{(1)} \boldsymbol{\lambda}^{(k-1)}
\end{array}\right]
\label{19.70}\end{equation}

反过来，\ref{19.33} 成为

!!!!
\boldsymbol{\lambda}^{(k)}=\theta \boldsymbol{\lambda}^{(k-1 / 2)}+(1-\theta) \boldsymbol{\lambda}^{(k-1)}
\label{19.71}\end{equation}

通过从\ref{19.70} 中消除$\mathbf{u}_{2}^{(k)}$，我们得到

!!!!
\left(A_{\Gamma \Gamma}^{(2)}-A_{\Gamma 2} A_{22}^{-1} A_{2 \Gamma}\right) \boldsymbol{\lambda}^{(k-1 / 2)}=\mathbf{f}_{\Gamma}-A_{\Gamma 1} \mathbf{u}_{1}^{(k)}-A_{\Gamma \Gamma}^{(1)} \boldsymbol{\lambda}^{(k-1)}-A_{\Gamma 2} A_{22}^{-1} \mathbf{f}_{2}
$$

根据$\Sigma_{2}$的定义\ref{19.51} 和\ref{19.69} ，我们有

!!!!
\Sigma_{2} \boldsymbol{\lambda}^{(k-1 / 2)}=\mathbf{f}_{\Gamma}-A_{\Gamma 1} A_{11}^{-1} \mathbf{f}_{1}-A_{\Gamma 2} A_{22}^{-1} \mathbf{f}_{2}-\left(A_{\Gamma \Gamma}^{(1)}-A_{\Gamma 1} A_{11}^{-1} A_{1 \Gamma}\right) \boldsymbol{\lambda}^{(k-1)}
$$

也就是说，由于$\Sigma_{1}$的定义\ref{19.51} 和\ref{19.52}。

!!!!
\boldsymbol{\lambda}^{(k-1 / 2)}=\Sigma_{2}^{-1}\left(\chi_{\Gamma}-\Sigma_{1} \boldsymbol{\lambda}^{(k-1)}\right)
$$

现在，根据\ref{19.71} 我们推导出

!!!!
\boldsymbol{\lambda}^{(k)}=\theta \Sigma_{2}^{-1}\left(\chi_{\Gamma}-\Sigma_{1} \boldsymbol{\lambda}^{(k-1)}\right)+(1-\theta) \boldsymbol{\lambda}^{(k-1)}
$$

也就是说，自$-\Sigma_{1}=-\Sigma+\Sigma_{2}$以来

!!!!
\boldsymbol{\lambda}^{(k)}=\theta \Sigma_{2}^{-1}\left(\chi_{\Gamma}-\Sigma \boldsymbol{\lambda}^{(k-1)}+\Sigma_{2} \boldsymbol{\lambda}^{(k-1)}\right)+(1-\theta) \boldsymbol{\lambda}^{(k-1)}
$$

从何而来

!!!!
\Sigma_{2}\left(\boldsymbol{\lambda}^{(k)}-\boldsymbol{\lambda}^{(k-1)}\right)=\theta\left(\chi_{\Gamma}-\Sigma \boldsymbol{\lambda}^{(k-1)}\right)
$$

后者只不过是用局部舒尔补码$\Sigma_{2}$作为预处理，对系统\ref{19.53} 进行Richardson迭代。

备注19.2。由Dirichlet-Neumann算法引起的Richardson预处理实际上是与我们解决Neumann问题的那个子域相关的局部Schur补集。因此，在所谓的Neumann-Dirichlet算法中，在每个迭代中，我们在$\Omega_{2}$中解决一个Dirichlet问题，在$\Omega_{1}$中解决一个Neumann问题，相关Richardson算法的预处理将是$\Sigma_{1}$而不是$\Sigma_{2}

备注 19.3.对于第19.1.3节中介绍的Neumann-Neumann算法的离散版，可以证明一个类似的结果。准确地说，Neumann-Neumann算法等同于应用于系统(19.53)的Richardson算法，其预处理器的倒数由$P_{h}^{-1}=\sigma_{1} \Sigma_{1}^{-1}+\sigma_{2} \Sigma_{2}^{-1}, \sigma_{1}$和$\sigma_{2}$给出，是用于对应于(19.19)的(离散)界面方程的系数。此外，我们可以证明存在一个常数$C>0$，独立于$h$，从而

!!!!
K_{2}\left(\left(\sigma_{1} \Sigma_{1}^{-1}+\sigma_{2} \Sigma_{2}^{-1}\right) \Sigma\right) \leq C
$$

以类似的方式进行，我们可以证明Robin-Robin算法的离散版\ref{19.20} -\ref{19.21} 也等同于\ref{19.53} 的Richardson算法，这次使用矩阵$\left(\gamma_{1}+\gamma_{2}\right)^{-1}\left(\gamma_{1} I+\Sigma_{1}\right)\left(\gamma_{2} I+\Sigma_{2}\right)$作为前置条件。让我们回顾一下，如果$P_{h}^{-1} \Sigma$的条件数与矩阵$N$的维数$\Sigma$（因此在$\Sigma$来自有限元离散化的情况下，来自$h$）一致，那么矩阵$P_{h}$是$\Sigma$的最佳预处理器。

因此，我们可以总结说，对于系统$\Sigma \boldsymbol{\lambda}=\chi_{\Gamma}$的求解，我们可以利用以下预处理，它们都是最佳的。


!!!!
P_{h}= \begin{cases}\Sigma_{2} & \text { for the Dirichlet-Neumann algorithm, } \\ \Sigma_{1} & \text { for the Neumann-Dirichlet algorithm, } \\ \left(\sigma_{1} \Sigma_{1}^{-1}+\sigma_{2} \Sigma_{2}^{-1}\right)^{-1} & \text { for the Neumann-Neumann algorithm, } \\ \left(\gamma_{1}+\gamma_{2}\right)^{-1}\left(\gamma_{1} I+\Sigma_{1}\right)\left(\gamma_{2} I+\Sigma_{2}\right) & \text { for the Robin-Robin algorithm. }\end{cases}
\label{19.72}\end{equation}



当求解通量方程(19.58)时，FETI预处理程序读作$P_{h}=\left(\Sigma_{1}+\right.$ $\left.\Sigma_{2}\right)^{-1}$ ，将预处理矩阵$\left(\Sigma_{1}+\Sigma_{2}\right)\left(\Sigma_{1}^{-1}+\Sigma_{2}^{-1}\right)$ 屏蔽。对于所有这些预处理程序，最优性来自于谱等价\ref{19.67}，因此$K_{2}\left(P_{h}^{-1} \Sigma\right)$独立于$h$是有边界的。

从Richardson方法的收敛理论我们知道，如果$\Sigma$和$P_{h}$都是对称的和正定的，就有$\left\|\boldsymbol{\lambda}^{n}-\boldsymbol{\lambda}\right\|_{\Sigma} \leq \rho^{n}\left\|\boldsymbol{\lambda}^{0}-\boldsymbol{\lambda}\right\|_{\Sigma}, n \geq 0$ ，即$\|\boldsymbol{v}\|_{\Sigma}=\left(\boldsymbol{v}^{T} \Sigma \boldsymbol{v}\right)^{1 / 2}$。最佳收敛率由以下公式给出

!!!!
\rho=\frac{K_{2}\left(P_{h}^{-1} \Sigma\right)-1}{K_{2}\left(P_{h}^{-1} \Sigma\right)+1}
$$

因此与$h$无关。

\subsection{Generalization to the case of many subdomains}

为了将前面的DD算法推广到域$\Omega$被划分为任意数量的$M>2$子域的情况，我们的步骤如下。让$\Omega_{i}, i=1, \ldots, M$，表示一个不相交的子域族，这样$\cup \bar{\Omega}_{i}=\bar{\Omega}$，表示$\Gamma_{i}=\partial \Omega_{i} \backslash \partial \Omega$和$\Gamma=\cup \Gamma_{i}$（骨架）。

让我们考虑泊松问题\ref{3.13} 。在当前情况下，等价定理$19.1$概括如下。

!!!!
\begin{cases}-\Delta u_{i}=f & \text { in } \Omega_{i}, \\ u_{i}=u_{k} \quad & \text { on } \Gamma_{i k}, \quad \forall k \in \mathscr{A}(i) \\ \frac{\partial u_{i}}{\partial n_{i}}=\frac{\partial u_{k}}{\partial n_{i}} & \text { on } \Gamma_{i k}, \forall k \in \mathscr{A}(i) \\ u_{i}=0 & \text { on } \partial \Omega_{i} \cap \partial \Omega\end{cases}
\label{19.73}\end{equation}

为$i=1, \ldots, M$，即$\Gamma_{i k}=\partial \Omega_{i} \cap \partial \Omega_{k} \neq \emptyset, \mathscr{A}(i)$是指数$k$的集合，使$\Omega_{k}$与$\Omega_{i}$相邻；通常，$\mathbf{n}_{i}$表示向外的单位法向$\Omega_{i}$ 。

现在假设\ref{3.13} 已经用有限元方法进行了近似。按照第19.3节的思路，用$\mathbf{u}=\left(\mathbf{u}_{I}, \mathbf{u}_{\Gamma}\right)^{T}$表示分成两个子向量的未知数向量，一个$\left(\mathbf{u}_{I}\right)$与内部节点有关，另一个$\left(\mathbf{u}_{\Gamma}\right.$）与位于骨架$\Gamma$上的节点有关，有限元代数系统可以用顺时针的形式重新表述如下

!!!!
\left[\begin{array}{cc}
A_{I I} & A_{I \Gamma} \\
A_{\Gamma I} & A_{\Gamma \Gamma}
\end{array}\right]\left[\begin{array}{c}
\mathbf{u}_{I} \\
\mathbf{u}_{\Gamma}
\end{array}\right]=\left[\begin{array}{c}
\mathbf{f}_{I} \\
\mathbf{f}_{\Gamma}
\end{array}\right]
\label{19.74}\end{equation}

是$A_{\Gamma I}=A_{I \Gamma}^{T}$。矩阵$A_{I \Gamma}$是带状的，而$A_{I I}$具有块状对角线形式

!!!!
A_{I I}=\left[\begin{array}{cccc}
A_{\Omega_{1}, \Omega_{1}} & 0 & \ldots & 0 \\
0 & \ddots & & \vdots \\
\vdots & & \ddots & 0 \\
0 & \ldots & 0 & A_{\Omega_{M}, \Omega_{M}}
\end{array}\right]
\label{19.75}\end{equation}

我们使用的是以下符号。

!!!!
\begin{array}{ll}
\left(A_{\Omega_{i}, \Omega_{i}}\right)_{l j}=a_{i}\left(\varphi_{j}, \varphi_{l}\right), & 1 \leq l, j \leq N_{i} \\
\left(A_{\Gamma \Gamma}^{(i)}\right)_{s r}=a_{i}\left(\psi_{r}, \psi_{s}\right), \quad 1 \leq r, s \leq N_{\Gamma_{i}} \\
\left(A_{\Omega_{i}, \Gamma}\right)_{l r}=a_{i}\left(\psi_{r}, \varphi_{l}\right), & 1 \leq r \leq N_{\Gamma_{i}}, \quad 1 \leq l \leq N_{i}
\end{array}
$$

其中$N_{i}$是内部节点的数量，$\Omega_{i}, N_{\Gamma_{i}}$是坐在界面上的节点的数量$\Gamma_{i}, \varphi_{j}$和$\psi_{r}$分别是与内部节点和界面节点相关的基础函数。

让我们注意，在每个子域$\Omega_{i}$上，矩阵

!!!!
A_{i}=\left[\begin{array}{cc}
A_{\Omega_{i}, \Omega_{i}} & A_{\Omega_{i}, \Gamma} \\
A_{\Gamma, \Omega_{i}} & A_{\Gamma \Gamma}^{(i)}
\end{array}\right]
\label{19.76}\end{equation}

代表与$\Omega_{i}$上的诺伊曼问题相关的局部有限元刚度矩阵。由于$A_{I I}$是非星形的，从\ref{19.74} 中我们可以正式得出

!!!!
\mathbf{u}_{I}=A_{I I}^{-1}\left(\mathbf{f}_{I}-A_{I \Gamma} \mathbf{u}_{\Gamma}\right)
\label{19.77}\end{equation}

通过消除系统\ref{19.74} 中的未知数$\mathbf{u}_{I}$，可知

!!!!
A_{\Gamma \Gamma} \mathbf{u}_{\Gamma}=\mathbf{f}_{\Gamma}-A_{\Gamma I} A_{I I}^{-1}\left(\mathbf{f}_{I}-A_{I \Gamma} \mathbf{u}_{\Gamma}\right)
$$

就是说

!!!!
\left(\begin{array}{cc}
A_{I I} & A_{I \Gamma} \\
0 & \Sigma
\end{array}\right)\left(\begin{array}{c}
u_{I} \\
u_{\Gamma}
\end{array}\right)=\left(\begin{array}{c}
\mathbf{f}_{I} \\
\chi_{\Gamma}
\end{array}\right)
\label{19.78}\end{equation}

已设定

!!!!
\Sigma=A_{\Gamma \Gamma}-A_{\Gamma I} A_{I I}^{-1} A_{I \Gamma} \text { and } \chi_{\Gamma}=\mathbf{f}_{\Gamma}-A_{\Gamma I} A_{I I}^{-1} \mathbf{f}_{I}
$$

像往常一样，用$\boldsymbol{\lambda}=\mathbf{u}_{\Gamma},(19.78)$来表示，可以得到

!!!!
\Sigma \boldsymbol{\lambda}=\chi_{\Gamma}
\label{19.79}\end{equation}

这是多域情况下的Schur补充系统。它可以被看作是$M$子域情况下界面Steklov-Poincaré问题的有限元近似。

局部舒尔补数定义为

!!!!
\Sigma_{i}=A_{\Gamma \Gamma}^{(i)}-A_{\Gamma, \Omega_{i}} A_{\Omega_{i}, \Omega_{i}}^{-1} A_{\Omega_{i}, \Gamma}, \quad i=1, \ldots M
\label{19.80}\end{equation}

因此

!!!!
\Sigma=R_{\Gamma_{1}}^{T} \Sigma_{1} R_{\Gamma_{1}}+\ldots+R_{\Gamma_{M}}^{T} \Sigma_{M} R_{\Gamma_{M}}
\label{19.81}\end{equation}

其中$R_{\Gamma_{i}}$是一个限制算子，即一个零和一的矩形矩阵，将$\Gamma$上的值映射到$\Gamma_{i}, i=1, \ldots, M$上。请注意，\ref{19.79}的r.h.s.可以写成一个局部贡献的总和。

!!!!
\chi_{\Gamma}=\sum_{i=1}^{M} R_{\Gamma_{i}}^{T}\left(\mathbf{f}_{\Gamma}^{(i)}-A_{\Gamma, \Omega_{i}} A_{\Omega_{i}, \Omega_{i}}^{-1} \mathbf{f}_{I}^{(i)}\right)
\label{19.82}\end{equation}

解决$\Omega$中有限元泊松问题的一般算法可表述如下。

1.计算\ref{19.79} 的解，得到骨架$\lambda$上的值。

2.求解(19.77)；由于$A_{I I}$是块对角线，这一步可以得到$M$独立的降维子问题$A_{\Omega_{i}, \Omega_{i}} \mathbf{u}_{I}^{i}=\mathbf{g}^{i}, i=1, \ldots, M$的解。

关于$\Sigma$的条件数，可以证明以下估计：存在一个独立于$h$和$H_{\min }, H_{\max }$的常数$C>0$，使得

!!!!
K_{2}(\Sigma) \leq C \frac{H_{\max }}{h H_{\min }^{2}}
\label{19.83}\end{equation}

$H_{\max }$是子域的最大直径，$H_{\min }$是最小直径。

备注19.4（$\boldsymbol{A}$的逆值的近似）。(19.74)中的块状矩阵$A$的逆值可以用下面的LDU分解法来表示

!!!!
A^{-1}=\left[\begin{array}{cc}
I & -A_{I I}^{-1} A_{I \Gamma} \\
0 & I
\end{array}\right]\left[\begin{array}{cc}
A_{I I}^{-1} & 0 \\
0 & \Sigma^{-1}
\end{array}\right]\left[\begin{array}{cc}
I & 0 \\
-A_{\Gamma I} A_{I I}^{-1} & I
\end{array}\right]
\label{19.84}\end{equation}

如果我们有合适的$B_{I I}$的$A_{I I}$和$\Sigma$的$P$的前置条件，那么$A^{-1}$的近似值将由以下公式给出

!!!!
P_{A}^{-1}=\left[\begin{array}{cc}
I & -B_{I I}^{-1} A_{I \Gamma} \\
0 & I
\end{array}\right]\left[\begin{array}{cc}
B_{I I}^{-1} & 0 \\
0 & P^{-1}
\end{array}\right]\left[\begin{array}{cc}
I & 0 \\
-A_{\Gamma I} B_{I I}^{-1} & I
\end{array}\right]
\label{19.85}\end{equation}

对于一个给定的向量，$P_{A}^{-1}$的应用涉及到$B_{I I}^{-1}$的两个矩阵-向量乘法，而$P^{-1}$只涉及一个矩阵-向量乘法（见[TW05，第4.3节]）。备注19.5（鞍点系统）。如果是像\ref{17.58}中的鞍点(块)矩阵，可以得到如下的LDU因式分解

!!!!
K=\left[\begin{array}{cc}
A & B^{T} \\
B & -C
\end{array}\right]=\left[\begin{array}{cc}
I_{A} & 0 \\
B A^{-1} & I_{C}
\end{array}\right]\left[\begin{array}{cc}
A & 0 \\
0 & S
\end{array}\right]\left[\begin{array}{cc}
I_{A} & A^{-1} B^{T} \\
0 & I_{C}
\end{array}\right]
\label{19.86}\end{equation}

其中$S=-C-B A^{-1} B^{T}$是相对于第二变量计算的舒尔补（例如，在系统\ref{17.58} 的情况下，$\mathbf{P}$）。$K$的倒数可得为

!!!!
K^{-1}=\left[\begin{array}{cc}
A^{-1} & 0 \\
0 & 0
\end{array}\right]+Q S^{-1} Q^{T}, \quad Q=\left[\begin{array}{c}
-A^{-1} B^{T} \\
I
\end{array}\right]
\label{19.87}\end{equation}

分别为$I_{A}$和$I_{C}$两个大小为$A$和$C$的同一矩阵。通过用合适的$A$和$S$的域分解预处理分别替换\ref{19.87} A^{-1}$和$S^{-1}$，可以构建$K$的预处理。

这一观察是设计所谓FETI-DP和BDDC预处理程序的基础，见第19.5.5和19.5.6节。19.5.5和19.5.6节。

\subsubsection{Some numerical results}

考虑域$\Omega=(0,1)^{2}$上的泊松问题\ref{3.13}，其有限元近似在\ref{4.40}中给出。

让我们将$\Omega$划分为$M$个不相交的方块$\Omega_{i}$，其边长为$H$，这样$\cup_{i=1}^{M} \overline{\Omega_{i}}=!!!!\bar{\Omega}$ 。图$19.5$（左）中显示了一个有四个子域的例子。

在表$19.1$中，我们报告了手头问题的$K_{2}(\Sigma)$的数值，对于有限元网格大小$h$的几个值；它随着$1 / h$和$1 / H$线性增长，正如公式\ref{19.83} 所预测的。在图$19.5$（右）中，我们显示了在$h=1 / 8$和$H=1 / 2$的特定情况下舒尔补码矩阵$\Sigma$的模式。该矩阵有一个顺时针的结构，说明了界面$\Gamma_{1}, \Gamma_{2}, \Gamma_{3}$和$\Gamma_{4}$，加上交叉点$\Gamma_{c}$产生的贡献。由于$\Sigma$是一个密集的矩阵，当解决线性系统\ref{19.79} 时，明确计算其条目并不方便。相反，我们可以使用下面的算法$18.1$来计算矩阵向量积$\sum \mathbf{x}_{\Gamma}$，对于任何向量$\mathbf{x}_{\Gamma}$（因此在迭代算法的每一步都有残差）。我们用$R_{\Gamma_{i}}$表示与$\mathbf{x}_{\Gamma}$相关的矩形矩阵。

表19.1.舒尔补数的条件数$\Sigma

\begin{tabular}{lccc} （中文）。
\hline $K_{2}(\Sigma)$ & $H=1 / 2$ & $H=1 / 4$ & $H=1 / 8$ \hline $K_{2}(\Sigma)$ & $H=1 / 2$ & $H=1 / 4$ & $H=1 / 8$ \
\Hline $h=1 / 8$ & $9.77$ & $14.83$ & $25.27$ （$h=1 / 8$）。
 $h=1 / 16$ & $21.49$ & $35.25$ & $58.60$。
 $h=1 / 32$ & $44.09$ & $75.10$ & $137.73$。
 $h=1 / 64$ & $91.98$ & $155.19$ & $290.43$。
\hline
\end{tabular}


![](https://cdn.mathpix.com/cropped/991f5db518e324d299c1ff4972bba9fb-194.jpg?height=270&width=584&top_left_y=116&top_left_x=164)

图19.5.将$\Omega=(0,1)^{2}$划分为四个方形子域的例子（左）。舒尔补数$\Sigma$的模式（右）对应于左边显示的域分区

限制运算$R_{\Gamma_{i}}: \Gamma \rightarrow \Gamma_{i}=\partial \Omega_{i} \backslash \partial \Omega$ ，而$\mathbf{x} \leftarrow \mathbf{y}$ 表示代数运算$\mathbf{x}=\mathbf{x}+\mathbf{y}$ 。

![](https://cdn.mathpix.com/cropped/991f5db518e324d299c1ff4972bba9fb-194.jpg?height=352&width=729&top_left_y=540&top_left_x=87)

由于子域之间不需要通信，这是一个完全并行的算法。

在第一次使用舒尔补码之前，需要进行算法18.2中描述的启动阶段。请注意，这是一个离线程序。


![](https://cdn.mathpix.com/snip/images/ONFb9jrPX08LMyn1IgJitSOIZ-mAGKFuo77hihA098A.original.fullsize.png)

\subsection{DD preconditioners in case of many subdomains}

在介绍$\Omega$被分割成许多子域的情况下舒尔补码的预处理方法之前，我们回顾一下以下定义。


Definition 19.1. A preconditioner $P_{h}$ of $\Sigma$ is said to be scalable if the condition number of the preconditioned matrix $P_{h}^{-1} \Sigma$ is independent of the number of subdomains.



使用可扩展的前置条件的迭代方法从此可以实现与子域数量无关的收敛率。在使用大量子域的情况下，这是一个非常理想的特性。

让$R_{i}$成为一个限制算子，对于全域$\Omega$上的任何节点值向量$\mathbf{v}_{h}$，将其限制与子域$\Omega_{i}$相关联。

!!!!
R_{i}: \mathbf{v}_{h \mid} \rightarrow \mathbf{v}_{\left.h\right|_{\Omega_{i} \cup \Gamma_{i}} ^{i}}
$$

此外，让

!!!!
R_{i}^{T}: \mathbf{v}_{h \mid}^{i} \rightarrow \mathbf{v}_{\left.h\right|_{\Omega_{i} \cup I_{i}}}^{i}
$$

是延长（或逐零延长）算子。在代数形式中$R_{i}$可以用一个与子域$\Omega_{i}$对应的身份矩阵相吻合的矩阵来表示

!!!!
R_{i}=\left[\begin{array}{ccc|c|ccc}
0 & \ldots & 0 \\
\vdots & \ddots & \vdots & 1 & 0 & \ldots & 0 \\
0 & \ldots & 0 & & \left.{\Omega_{i}} \mid \begin{array}{cccc}
0 & \ddots & \vdots \\
0 & \ldots & 0
\end{array}\right]
\end{array}\right.
$$

同样，我们可以定义限制和延长算子$R_{\Gamma_{i}}$和$R_{\Gamma_{i}}^{T}$，分别作用于界面节点值的向量（如\ref{19.81} ）。为了找到$\Sigma$的预处理程序，其策略是将局部子域预处理程序的贡献与全球贡献相结合，后者指的是粗网格，其元素是子域本身。如果没有后一个粗网格项，预处理程序就不能扩展，因为它缺乏在每个迭代步骤中跨域信息的全球通信机制。这个想法可以通过以下关系来正式确定，该关系提供了预处理程序的逆向性

!!!!
\left(P_{h}\right)^{-1}=\sum_{i=1}^{M} R_{\Gamma_{i}}^{T} P_{i, h}^{-1} R_{\Gamma_{i}}+R_{\Gamma}^{T} P_{H}^{-1} R_{\Gamma}
$$

.
 ![](https://cdn.mathpix.com/cropped/991f5db518e324d299c1ff4972bba9fb-196.jpg?height=324&width=678&top_left_y=128&top_left_x=126)

图19.6.分解为9个子域（左），在小三角形中进行精细三角化，在大四边形中进行粗略三角化（9个子域）（右）。

我们用$H$表示子域$\Omega_{i}$的直径$H_{i}$的最大值；此外，$P_{i, h}$是局部舒尔补数$\Sigma_{i}$，或者（更经常）是$\Sigma_{i}$的合适预处理，而$R_{\Gamma}$和$P_{H}$是指作用于全球尺度（粗略网格）的算子。

局部舒尔补码预处理器可以有许多不同的选择$P_{i, h}$；它们将引起预处理矩阵的不同条件数$P_{h}^{-1} \Sigma

\subsubsection{Jacobi preconditioner}

让$\left\{e_{1}, \ldots, e_{m}\right\}$成为$\Omega$分割为子域的边和$\left\{v_{1}, \ldots, v_{n}\right\}$顶点的集合（见图$19.6$的例子）。

舒尔补数$\Sigma$的特点是：顺时针表示法

!!!!
\Sigma=\left[\begin{array}{cc}
\Sigma_{e e} & \Sigma_{e v} \\
\Sigma_{e v}^{T} & \Sigma_{v v}
\end{array}\right]
$$

已设定

!!!!
\Sigma_{e e}=\left[\begin{array}{ccc}
\Sigma_{e_{1} e_{1}} & \ldots & \Sigma_{e_{1} e_{m}} \\
\vdots & \ddots & \vdots \\
\Sigma_{e_{m} e_{1}} & \ldots & \Sigma_{e_{m} e_{m}}
\end{array}\right], \quad \Sigma_{e v}=\left[\begin{array}{ccc}
\Sigma_{e_{1} v_{1}} & \ldots & \Sigma_{e_{1} v_{n}} \\
\vdots & \ddots & \vdots \\
\Sigma_{e_{m} v_{1}} & \ldots & \Sigma_{e_{m} v_{n}}
\end{array}\right]
$$

和

!!!!
\Sigma_{v v}=\left[\begin{array}{cccc}
\Sigma_{v_{1} v_{1}} & 0 & \ldots & 0 \\
0 & \ddots & & \vdots \\
\vdots & & \ddots & 0 \\
0 & \ldots & 0 & \Sigma_{v_{n} v_{n}}
\end{array}\right]
$$

在$3 \mathrm{D}$中，由于面的存在，应该还有一个块的行和列。

舒尔补码$\Sigma$的雅可比预处理是一个块对角线矩阵，定义为

!!!!
P_{h}^{J}=\left[\begin{array}{cc}
\hat{\Sigma}_{e e} & 0 \\
0 & \Sigma_{v v}
\end{array}\right]
\label{19.88}\end{equation}

其中$\hat{\Sigma}_{e e}$是$\Sigma_{e e}$或它的一个合适的近似值。这个预处理程序没有考虑到与边相关的基函数和与顶点相关的基函数之间的相互作用。矩阵$\hat{\Sigma}_{e e}$也是对角线的

!!!!
\hat{\Sigma}_{e e}=\left[\begin{array}{cccc}
\hat{\Sigma}_{e_{1} e_{1}} & 0 & \ldots & 0 \\
0 & \ddots & & \vdots \\
\vdots & & \ddots & 0 \\
0 & \ldots & 0 & \hat{\Sigma}_{e_{m} e_{m}}
\end{array}\right]
$$

这里$\hat{\Sigma}_{e_{k} e_{k}}$表示$\Sigma_{e_{k} e_{k}}$或它的适当近似值。

预处理程序$P_{h}^{J}$也可以用限制和延长算子表示如下

!!!!
\left(P_{h}^{J}\right)^{-1}=\sum_{k=1}^{m} R_{e_{k}}^{T} \hat{\Sigma}_{e_{k} e_{k}}^{-1} R_{e_{k}}+R_{v}^{T} \Sigma_{v v}^{-1} R_{v}
$$

其中$R_{e_{k}}$和$R_{v}$分别表示边和顶点的限制算子。

关于预设舒尔补码的条件数，存在一个常数$C>0$，与$h$和$H$无关，这样就可以

!!!!
K_{2}\left(\left(P_{h}^{J}\right)^{-1} \Sigma\right) \leq C H^{-2}\left(1+\log \frac{H}{h}\right)^{2}
$$

如果用共轭梯度法解决带有预处理程序$P_{h}^{J}$的预处理Schur补数系统\ref{19.79} ，收敛所需的迭代次数（在规定的容限内）将与$H^{-1}$成比例。$H$的存在表明雅可比预处理器是不可扩展的。

此外，我们注意到，对数项$\log (H / h)$的存在引入了子域的大小与计算网格的大小之间的关系$\mathscr{T}_{h}$ 。这就产生了信息在子域之间的传播，其特点是传播速度有限（而不是无限）。请注意，比率$H / h$衡量的是任何子域的最大元素数。

\subsubsection{Bramble-Pasciak-Schatz preconditioner}

为了加快信息在子域间的传播速度，我们可以设计一种子域间的全局耦合机制。正如已经预料到的那样，子域家族可以被看作是原域的一个粗大的网格，例如$\mathscr{T}_{H}$。例如，图中$19.6 \mathscr{T}_{H}$是由9个（宏观）元素和4个内部节点组成的。它确定了一个片状双线性元素的刚度矩阵，例如$A_{H}$ ，维度为$4 \times 4$，保证了$\Omega$中的全局耦合。我们现在可以引入一个限制算子，为了简单起见，我们表示为$R_{H}: \Gamma_{h} \rightarrow \Gamma_{H}$ 。更确切地说，这个算子将骨架$\Gamma_{h}$上的节点值向量转化为粗网格内部顶点上的节点值向量（本例中为4）。它的转置$R_{H}^{T}$是一个扩展算子。矩阵$P_{h}^{B P S}$，其inverse为

!!!!
\left(P_{h}^{B P S}\right)^{-1}=\sum_{k=1}^{m} R_{e_{k}}^{T} \hat{\Sigma}_{e_{k} e_{k}}^{-1} R_{e_{k}}+R_{H}^{T} A_{H}^{-1} R_{H}
\label{19.89}\end{equation}

被命名为Bramble-Pasciak-Schatz预处理器。与Jacobi预处理程序\ref{19.88}的主要区别在于全局（粗网格）刚度矩阵$A_{H}$的存在，而不是对角线顶点矩阵$\Sigma_{v v}$ 。以下结果成立。

!!!!
\begin{gathered}
K_{2}\left(\left(P_{h}^{B P S}\right)^{-1} \Sigma\right) \leq C\left(1+\log \frac{H}{h}\right)^{2} \text { in } 2 \mathrm{D} \\
K_{2}\left(\left(P_{h}^{B P S}\right)^{-1} \Sigma\right) \leq C \frac{H}{h} \text { in } 3 \mathrm{D}
\end{gathered}
$$

请注意，因子$H^{-2}$不再出现了。带有预处理程序$P_{h}^{B P S}$的共轭梯度法的迭代次数现在与$2 \mathrm{D}$中的$\log (H / h)$和$3 \mathrm{D}$中的$(\mathrm{H} / \mathrm{h})^{1 / 2}$成正比。

\subsubsection{Neumann-Neumann preconditioner}

尽管Bramble-Pasciak-Schatz预处理器比Jacobi的预处理器有更好的特性，然而在$3 \mathrm{D}$中，预处理的Schur补数的条件数仍然包含对$H / h$的线性依赖。在这方面，使用所谓的Neumann-Neumann预处理器可以实现进一步的改进，其逆向是

!!!!
\left(P_{h}^{N N}\right)^{-1}=\sum_{i=1}^{M} R_{\Gamma_{i}}^{T} D_{i} \Sigma_{i}^{*} D_{i} R_{\Gamma_{i}}
\label{19.90}\end{equation}

如前所述，$R_{\Gamma_{i}}$表示从整个骨架$\Gamma$上的节点值到局部界面$\Gamma_{i}$上的节点值的限制，而$\Sigma_{i}^{*}$是$\Sigma_{i}^{-1}$（如果存在局部逆）或$\Sigma_{i}^{-1}$的近似值，例如$\Sigma_{i}$的伪逆$\Sigma_{i}^{+}$ 。矩阵$D_{i}$是一个正权$d_{j}>0$的对角矩阵，因为$j=1, \ldots, n, n$是$\Gamma_{i}$上的节点数。例如，$d_{j}$与共享$j-t h$节点的子域数量的倒数相吻合。如果我们仍然考虑图19.6的4个内部顶点，我们将有$d_{j}=1 / 4$ ，对于$j=1, \ldots, 4$ 。

对于预处理程序\ref{19.90}，以下估计（类似于雅可比预处理程序）成立：存在一个常数$C>0$，与$h$和$H$无关，使得

!!!!
K_{2}\left(\left(P_{h}^{N N}\right)^{-1} \Sigma\right) \leq C H^{-2}\left(1+\log \frac{H}{h}\right)^{2}
$$

在子域分区没有交叉点的情况下，最后一个（对数）因素就会消失。

(19.90)中$D_{i}$和$R_{\Gamma_{i}}$的存在只需要矩阵-矩阵乘法。另一方面，如果$\Sigma_{i}^{*}=\Sigma_{i}^{-1}$，将$\Sigma_{i}^{-1}$应用于一个给定的向量，可以重导为使用局部倒数。事实上，让$\mathbf{q}$是一个向量，其成分是本地界面$\Gamma_{i}$上的节点值；那么

!!!!
\Sigma_{i}^{-1} \mathbf{q}=[0, I] A_{i}^{-1}[0, I]^{T} \mathbf{q}
$$

特别是，$[0, I]^{T} \mathbf{q}=[0, \mathbf{q}]^{T}$ ，以及矩阵-向量积

![](https://cdn.mathpix.com/cropped/991f5db518e324d299c1ff4972bba9fb-199.jpg?height=167&width=312&top_left_y=382&top_left_x=298)

对应于Neumann边界值问题在$\Omega_{i}$上的解。

!!!!
\begin{cases}-\Delta w_{i}=0 & \text { in } \Omega_{i} \\ \frac{\partial w_{i}}{\partial n}=q & \text { on } \Gamma_{i}\end{cases}
\label{19.91}\end{equation}

![](https://cdn.mathpix.com/cropped/991f5db518e324d299c1ff4972bba9fb-199.jpg?height=324&width=724&top_left_y=740&top_left_x=88)

在这种情况下，还需要一个启动阶段，包括准备解决具有局部刚度矩阵$A_{i}$ 的线性系统。请注意，在模型问题\ref{3.13} 的情况下，如果$A_{i}$是一个内部子域，即如果$\partial \Omega_{i} \backslash \partial \Omega=\emptyset$ 是奇异的。应采取以下策略之一。

1. 计算$A_{i}+\varepsilon I$的（LU或Cholesky）因式分解，对于给定的$\varepsilon>0$足够小；表19.2。预处理矩阵$\left(P_{h}^{N N}\right)^{-1} \Sigma$的条件数

\begin{tabular}{lcccc}
\hline $K_{2}\left(\left(P_{h}^{N N}\right)^{-1} \Sigma\right)$ & $H=1 / 2$ & $H=1 / 4$ & $H=1 / 8$ & $H=1 / 16$ \hline $K_{2}\left(\left(P_{h}^{N N}\right)^{-1} \Sigma\right)$ & $H=1 / 2$ & $H=1 / 4$ & $H=1 / 16$ \hline
\hline $h=1 / 16$ & $2.55$ & $15.20$ & $47.60$ & $-$ \hline
 $h=1 / 32$ & $3.45$ & $20.67$ & $76.46$ & $194.65$ （$h=1 / 32$）。
 $h=1 / 64$ & $4.53$ & $26.25$ & $105.38$ & $316.54$ （$h=1 / 64$） & $4.53$ & $26.25$ & $105.38$ & $316.54$
 $h=1 / 128$ & $5.79$ & $31.95$ & $134.02$ & $438.02$ （$h=1 / 128$）。
\hline
\end{tabular}

2. 计算$A_{i}+\frac{1}{H^{2}} M_{i}$的因式分解，其中$M_{i}$是质量矩阵。

!!!!
\left(M_{i}\right)_{k, j}=\int_{\Omega_{i}} \varphi_{k} \varphi_{j} d \Omega_{i}
$$

3. 计算$A_{i}$的奇异值分解。

矩阵$\Sigma_{i}^{*}$是相应定义的。在我们的数值结果中，我们采用了第三种方法。

图19.7显示了在$h=1 / 32$情况下带有预处理器$P_{h}^{N N}$的预处理共轭梯度方法的收敛历史。在表$19.2$中，我们报告了$\left(P_{h}^{N N}\right)^{-1} \Sigma$的条件数在$H$的几个数值下的数值。

正如已经指出的那样，舒尔互补矩阵的Neumann-Neumann预处理器是不可扩展的。通过增加一个粗略的网格修正机制，可以实现对\ref{19.90}的大幅改进，产生以下新的预处理器

![](https://cdn.mathpix.com/cropped/991f5db518e324d299c1ff4972bba9fb-200.jpg?height=425&width=513&top_left_y=745&top_left_x=200)

图 19.7.当$P_{h}^{N N}$的预处理Schur互补矩阵时，带有预处理器$h=1 / 32$的预处理共轭梯度方法的收敛历史（例如，见[TW05，第6.2.1节]）。

!!!!
\left(P_{h}^{B N N}\right)^{-1} \Sigma=P_{0}+\left(I-P_{0}\right)\left(\left(P_{h}^{N N}\right)^{-1} \Sigma\right)\left(I-P_{0}\right)
\label{19.92}\end{equation}

其中，我们使用了速记符号$P_{0}=\bar{R}_{0}^{T} \Sigma_{0}^{-1} \bar{R}_{0} \Sigma, \Sigma_{0}=\bar{R}_{0} \Sigma \bar{R}_{0}^{T}$，$\bar{R}_{0}$表示从$\Gamma$到粗略层次骨架的限制。矩阵$P_{h}^{B N N}$被称为平衡的Neumann-Neumann预处理器。可以证明，存在一个独立于$h$和$H$的常数$C>0$，使得

!!!!
K_{2}\left(\left(P_{h}^{B N N}\right)^{-1} \Sigma\right) \leq C\left(1+\log \frac{H}{h}\right)^{2}
$$

在$2 \mathrm{D}$和三维中都是如此。因此，平衡的Neumann-Neumann预处理程序保证了最佳的可扩展性，直至对$H$和$h$的轻度对数依赖。

作为$\Sigma_{H}$的组成部分的粗网格矩阵$\Sigma_{0}$可以用算法18.4建立起来。

![](https://cdn.mathpix.com/cropped/991f5db518e324d299c1ff4972bba9fb-201.jpg?height=258&width=720&top_left_y=533&top_left_x=89)

该算法的步骤a.在计算上非常便宜，而步骤$\mathrm{b}$ .需要几个（例如，$\ell$）涉及舒尔互补矩阵$\Sigma$的矩阵-向量产品。由于$\Sigma$从未明确建立，这涉及到$\ell \times M$迪里切特边界值问题的有限元解，以生成$A_{H}$。此外，请注意，在步骤a中引入的限制算子隐含地定义了一个粗略的空间，其函数在每个$\Gamma_{i}$上都是片状常数。由于这个原因，当有限元网格或子域划分（或两者）非结构化时，平衡的Neumann-Neumann预处理器特别方便，如图19.8）。一个算法，即

表19.3.几个$\left(P_{h}^{B N N}\right)^{-1} \Sigma$值的$H$的条件编号

\begin{tabular}{lcccc} （注："lcccc "是指 "lcccc"）。
\hline $K_{2}\left(\left(P_{h}^{B N N}\right)^{-1} \Sigma\right)$ & $H=1 / 2$ & $H=1 / 4$ & $H=1 / 8$ & $H=1 / 16$ `hline $h=1 / 16$ & $1.67$ & $1.48$ & $H=1 / 16$ `hline
\$h=1 / 16$ & $1.67$ & $1.48$ & $1.27$ & $-$。
 $h=1 / 32$ & $2.17$ & $2.03$ & $1.47$ & $1.29$ （1个月）。
 $h=1 / 64$ & $2.78$ & $2.76$ & $2.08$ & $1.55$ $h=1 / 128$ & $3.51$ & $3.67$。
 $h=1 / 128$ & $3.51$ & $3.67$ & $2.81$ & $2.07$ （$h=1 / 128$）。
\hline
\end{tabular}


![](https://cdn.mathpix.com/cropped/991f5db518e324d299c1ff4972bba9fb-202.jpg?height=288&width=714&top_left_y=110&top_left_x=100)

图 19.8.8个子域中的非结构化子域划分实例，适用于结构化（左）或非结构化（右）的有限元网格

TW05，第6.2.2节]报告了在共轭梯度法中补充BNN预处理程序以解决界面问题\ref{19.79} 的方法。

通过比较使用Neumann-Neumann预处理程序（有平衡和无平衡）得到的结果，可以得出以下结论。

- 尽管它的条件数比$A, \Sigma$好，但仍然是条件不良。因此，必须使用一个合适的预处理程序。

- Neumann-Neumann预处理程序可以令人满意地用于具有中等数量子域的分区。

- 平衡Neumann-Neumann预处理程序几乎是最佳的可扩展性，因此推荐用于具有大量子域的分区。

\subsection{FETI（有限元撕裂$\&$互连）方法}

在本节中，我们将用$H_{i}=\operatorname{diam}\left(\Omega_{i}\right), W_{i}=W^{h}\left(\partial \Omega_{i}\right)$表示（有限元函数在边界上的痕迹空间$\partial \Omega_{i}$），用$W=\prod_{i=1}^{M} W_{i}$表示这种痕迹空间的积空间。

在以后的阶段，我们还需要两个有限元轨迹空间，$\widehat{W} \subset W$是跨越骨架的连续轨迹的子空间$\Gamma$，以及$\widetilde{W}$，一个可能的中间空间$\widehat{W} \subset \widetilde{W} \subset W$，将满足数量较少的连续性约束。

我们将考虑变系数的椭圆问题。

!!!!
\begin{cases}-\operatorname{div}(\rho \nabla u)=f & \text { in } \Omega \\ u=0 & \text { on } \partial \Omega\end{cases}
\label{19.93}\end{equation}

其中$\rho$是片状常数，$\rho=\rho_{i} \in \mathbb{R}^{+}$在$\Omega_{i}$。

最后，我们将用$\Omega_{i h}$表示$\Omega_{i}, \partial \Omega_{i h}$中的节点，$\partial \Omega_{i}, \partial \Omega_{h}$中的节点，$\partial \Omega$中的节点，以及$\Gamma_{h}$中的节点。见图19.9。
 ![](https://cdn.mathpix.com/cropped/991f5db518e324d299c1ff4972bba9fb-203.jpg?height=384&width=534&top_left_y=115&top_left_x=187)

图19.9.节点$\partial \Omega_{h}, \Gamma_{h}, \Omega_{i h}$，和$\partial \Omega_{i h}$的有限元集

让我们介绍一下以下的缩放计数函数。  $\forall x \in \Gamma_{h} \cup \partial \Omega_{h}

!!!!
\delta_{i}(x)=\left\{\begin{array}{cl}
1 & x \in \partial \Omega_{i h} \cap\left(\partial \Omega_{h} \backslash \Gamma_{h}\right) \\
\sum_{j \in N_{x}} \rho_{j}^{\gamma}(x) / \rho_{i}^{\gamma}(x) & x \in \partial \Omega_{i h} \cap \Gamma_{h} \\
0 & \text { elsewhere }
\end{array}\right.
\label{19.94}\end{equation}

其中$\gamma \in[1 / 2,+\infty)$和$N_{x}$是其边界上有$x$的子区域的指数集。然后我们设定

!!!!
\delta_{i}^{\dagger}(x) \quad(=\text { pseudo inverses })=\left\{\begin{array}{cl}
\delta_{i}^{-1}(x) & \text { if } \delta_{i}(x) \neq 0 \\
0 & \text { if } \delta_{i}(x)=0
\end{array}\right.
\label{19.95}\end{equation}

基于\ref{19.93} 的有限元近似，让我们考虑局部Schur补数\ref{19.80} ，它是正半无限矩阵。在这一节中，我们将表示$\partial \Omega_{i}$上的界面节点值为$\mathbf{u}_{i}$，我们设置$\mathbf{u}=\left(\mathbf{u}_{1}, \ldots, \mathbf{u}_{M}\right)$，$\partial \Omega_{i}$上的局部载荷向量为$\chi_{i}$，我们设置$\chi_{\Delta}=\left(\chi_{1}, \ldots, \chi_{M}\right)$ 。最后，我们设定

!!!!
\Sigma_{\Delta}=\operatorname{diag}\left(\Sigma_{1}, \ldots, \Sigma_{M}\right)=\left[\begin{array}{cccc}
\Sigma_{1} & 0 & \cdots & 0 \\
\vdots & \Sigma_{2} & & \vdots \\
& & \ddots & \\
0 & 0 & \cdots & \Sigma_{M}
\end{array}\right]
$$

一个块状对角线矩阵。原先的有限元问题，当减少到界面$\Gamma$时，读作：找到$\mathbf{u} \in W$，以便

!!!!
\left\{\begin{aligned}
J(\mathbf{u}) &=\frac{1}{2}\left\langle\Sigma_{\Delta} \mathbf{u}, \mathbf{u}\right\rangle-\left\langle\chi_{\Delta}, \mathbf{u}\right\rangle \rightarrow \min \\
B_{\Gamma} \mathbf{u} &=\mathbf{0}
\end{aligned}\right.
\label{19.96}\end{equation}

$B_{\Gamma}$不是唯一的，所以当$\mathbf{u}$属于一个以上的子域时，我们应该施加连续性；$B_{\Gamma}$是由$\{0,-1,1\}$组成的，因为它在接口的节点上执行连续性的约束。在这里，我们使用相同的符号$W$来表示有限元空间轨迹和它们在$\Gamma_{h}$点上的节点值。

在$2 \mathrm{D}$中，对于坐在边上的点的连续性的约束如何写有一点选择，对于顶点有很多选择。对于边缘节点，我们只需要选择符号，而对于顶点节点，例如4个子域共有的一个节点，可以用许多不同的方式选择一组最小的三个约束来保证有关节点的连续性。参见，例如，图19.10。
 ![](https://cdn.mathpix.com/cropped/991f5db518e324d299c1ff4972bba9fb-204.jpg?height=180&width=448&top_left_y=380&top_left_x=232)

图 19.10.左边由3个（非冗余）条件执行的连续性约束，右边由6个（冗余）条件执行的连续性约束

如果$\operatorname{Ker}\left\{\Sigma_{\Delta}\right\} \cap \operatorname{Ker}\left\{B_{\Gamma}\right\}=0$，即$\Sigma_{\Delta}$在$\operatorname{Ker}\left(B_{\Gamma}\right)$上是可逆的，则问题(19.96)有一个唯一的解决方案。

我们可以用拉格朗日乘法器重新计算\ref{19.96} ：找到$(\mathbf{u}, \boldsymbol{\lambda}) \in W \times U$，以便

!!!!
\begin{cases}\Sigma_{\Delta} \mathbf{u}+B_{\Gamma}^{T} \boldsymbol{\lambda} & =\boldsymbol{\chi}_{\Delta} \\ B_{\Gamma} \mathbf{u} & =\mathbf{0}\end{cases}
\label{19.97}\end{equation}

由于inf-sup（LBB）条件（见第17章），$\boldsymbol{\lambda}$的解的分量\ref{19.97}是唯一的，直到$\operatorname{Ker}\left(B_{\Gamma}^{T}\right)$的加性向量，所以我们选择$U=!!!!\operatorname{range}\left(B_{\Gamma}\right)$ 。

让$R=\operatorname{diag}\left(R^{(1)}, \ldots, R^{(M)}\right)$由$\Sigma_{\Delta} .\left(\right.$的无效空间元素组成，例如，$R^{(i)}$对应于$\Omega_{i}$的刚体运动，在线性弹性算子的情况下。)

$R$是一个全列级矩阵。如果\ref{19.97}的第一个方程的解存在，那么$\chi_{\Delta}-B_{\Gamma}^{T} \boldsymbol{\lambda} \in \operatorname{range}\left(\Sigma_{\Delta}\right)$，这个限制将通过引入一个合适的投影算子$P$来解决。那么。

!!!!
\mathbf{u}=\Sigma_{\Delta}^{\dagger}\left(\chi_{\Delta}-B_{\Gamma}^{T} \boldsymbol{\lambda}\right)+R \alpha \quad \text { if } \chi_{\Delta}-B_{\Gamma}^{T} \boldsymbol{\lambda} \perp \operatorname{Ker}\left(\Sigma_{\Delta}\right)
$$

其中$\alpha$是一个任意向量，$\Sigma_{\Delta}^{\dagger}$是$\Sigma_{\Delta}$的一个伪逆。 (即使一个给定的矩阵有几个伪逆，下面的算法将不受具体选择的影响。)选择一个对称的$\Sigma_{\Delta}^{\dagger}, \mathrm{e} . \mathrm{g}$ .MoorePenrose的，见[QSS07] .很方便。将$\mathbf{u}$代入\ref{19.97} 的第二个方程，得到

!!!!
B_{\Gamma} \Sigma_{\Delta}^{\dagger} B_{\Gamma}^{T} \boldsymbol{\lambda}=B_{\Gamma} \Sigma_{\Delta}^{\dagger} \chi_{\Delta}+B_{\Gamma} R \boldsymbol{\alpha}
\label{19.98}\end{equation}

让我们设定 $F=B_{\Gamma} \Sigma_{\Delta}^{\dagger} B_{\Gamma}^{T}$ 和 $\mathbf{d}=B_{\Gamma} \Sigma_{\Delta}^{\dagger} \chi_{\Delta}$ 。然后选择 $P^{T}$ 作为合适的投影矩阵，例如 $P^{T}=I-G\left(G^{T} G\right)^{-1} G^{T}$ ，与 $G=B_{\Gamma} R$ 。然后。

!!!!
\begin{cases}P^{T} F \boldsymbol{\lambda} & =P^{T} \mathbf{d} \\ G^{T} \boldsymbol{\lambda} & =\mathbf{e}\left(=R^{T} \chi_{\Delta}\right)\end{cases}
\label{19.99}\end{equation}

更一般地说，我们可以引入一个s.p.d.矩阵$Q$，并设定

!!!!
P^{T}=I-G\left(G^{T} Q G\right)^{-1} G^{T} Q
$$

算子$P^{T}$是从$U$投影到对$\operatorname{range}(G)$为Q正交的拉格朗日乘数空间，而$P=I-Q G\left(G^{T} Q G\right)^{-1} G^{T}$是从$U$投影到$\operatorname{Ker}\left(G^{T}\right)$（它实际上是相对于$Q^{-1}$-内$\left.\operatorname{product}(\boldsymbol{\lambda}, \boldsymbol{\mu})_{Q^{-1}}=\left(\boldsymbol{\lambda}, \boldsymbol{Q}^{-1} \boldsymbol{\mu}\right)\right)$而言的正交投影）。

将\ref{19.98} 乘以$H=\left(G^{T} Q G\right)^{-1} G^{T} Q$后，我们发现

!!!!
\boldsymbol{\alpha}=H(\mathbf{d}-F \boldsymbol{\lambda})
$$

这完全决定了在$\boldsymbol{\lambda}$方面的原始变量。

如果微分算子有恒定系数，选择$Q=I$就够了。在系数跳跃的情况下，$Q$通常被选为缩放对角线矩阵，可以视为从矩阵$B_{\Gamma}$的左边开始缩放$Q^{1 / 2}$ 。

原始的单级FETI方法是空间$V$中的CG方法，适用于

!!!!
P^{T} F \boldsymbol{\lambda}=P^{T} \mathbf{d}, \quad \boldsymbol{\lambda} \in \boldsymbol{\lambda}_{0}+V
\label{19.100}\end{equation}

有一个初始$\boldsymbol{\lambda}_{0}$，以便$G^{T} \boldsymbol{\lambda}_{0}=\mathbf{e}$ 。这里

!!!!
V=\left\{\boldsymbol{\lambda} \in U:\langle\boldsymbol{\lambda}, B \mathbf{z}\rangle=0, \mathbf{z}=\operatorname{Ker}\left(\Sigma_{\Delta}\right)\right\}
$$

是所谓的可接受增量空间，$\operatorname{Ker}\left(G^{T}\right)=\operatorname{range}(P)$和

!!!!
V^{\prime}=\left\{\boldsymbol{\mu} \in U:\langle\boldsymbol{\mu}, B \mathbf{z}\rangle_{Q}=0, \mathbf{z} \in \operatorname{Ker}\left(\Sigma_{\Delta}\right)\right\}=\operatorname{range}\left(P^{T}\right)
$$

上述最简单的FETI版本在子域中没有预处理程序（或只有对角线预处理程序），可以随着子域数量的增加而扩展，但条件数会随着每个子域元素数量的增加而呈多项式增长。原始的、最基本的FETI预处理器是

!!!!
P_{h}^{-1}=B_{\Gamma} \Sigma_{\Delta} B_{\Gamma}^{T}=\sum_{i=1}^{M} B^{(i)} \Sigma_{i} B^{(i)^{T}}
\label{19.101}\end{equation}

它被称为Dirichlet预处理程序，因为它对一个给定矢量的应用涉及到解决$M$独立的Dirichlet问题，每个子域都有一个。FETI中的粗略空间由每个子结构上的空域组成。为了使所得的预设条件$\mathrm{CG}$方法的搜索方向保持在空间$V$中，在应用$P_{h}^{-1}$之后，还要应用投影$P$。因此，所谓的FETI方法的Dirichlet变体是应用于修正方程的CG算法

!!!!
P P_{h}^{-1} P^{T} F \boldsymbol{\lambda}=P P_{h}^{-1} P^{T} \mathbf{d}, \quad \boldsymbol{\lambda} \in \boldsymbol{\lambda}_{0}+V
\label{19.102}\end{equation}

因为对于$\boldsymbol{\lambda} \in V, P P_{h}^{-1} P^{T} F \boldsymbol{\lambda}=P P_{h}^{-1} P^{T} P^{T} F P \boldsymbol{\lambda}$，\ref{19.102}左边的矩阵可以被看作是两个对称矩阵的乘积。在$B_{\Gamma}$具有全行秩的情况下，即约束条件是线性独立的，没有多余的拉格朗日乘数，一个更好的预处理程序可以定义如下

!!!!
\widehat{P}_{h}^{-1}=\left(B_{\Gamma} D^{-1} B_{\Gamma}^{T}\right)^{-1} B_{\Gamma} D^{-1} \Sigma_{\Delta} D^{-1} B_{\Gamma}^{T}\left(B_{\Gamma} D^{-1} B_{\Gamma}^{T}\right)^{-1}
\label{19.103}\end{equation}

其中$D$是一个块状对角线矩阵$D=\operatorname{diag}\left(D^{(1)}, \ldots, D^{(M)}\right)$，每个块$D^{(i)}$是一个对角线矩阵，其元素是$\delta_{i}^{\dagger}(x)$（见\ref{19.95} ），对应于$\partial \Omega_{i, h}$的点$x

由于$B_{\Gamma} D^{-1} B_{\Gamma}^{T}$是块对角线，它的逆值可以很容易地通过反转小块来计算，其大小为$n_{x}$，即用于在点$x$处强制执行连续性的拉格朗日乘数的数量。

矩阵$D$，对乘积空间$W$的元素进行操作，可以被视为从$B_{\Gamma}$的右边按$D^{-1 / 2}$进行缩放。在这种选择下

!!!!
K_{2}\left(P \widehat{P}_{h}^{-1} P^{T} F\right) \leq C(1+\log (H / h))^{2}
\label{19.104}\end{equation}

其中$K_{2}(\cdot)$是光谱条件数，$C$是独立于$h, H$、$\gamma$和$\rho_{i}$的值的常数。

\subsubsection{FETI-DP (Dual Primal FETI) methods}

FETI-DP方法是在[FLT $\left.^{+} 01\right]$中引入的一种域分解方法，它通过拉格朗日乘法器在子域界面上强制实现解的相等，除了子域角上，这仍然是原始变量。该方法的第一个数学分析是由Mandel和Tezaur [MT01] 提供的。该方法通过强制执行子域界面上的边或面的平均数相等而得到进一步改进 [FLP00] , [KWD02] 。这对并行可扩展性很重要。

为了简单起见，让我们考虑$2 \mathrm{D}$的情况。正如第19.5.4节开头所预计的，这个想法是通过引入一个额外的空间$\widetilde{W}$来实现的，比如$\widehat{W} \subset \widetilde{W} \subset W$，对于这个空间，我们有子域顶点的原始变量的连续性，也有界面所有边上的平均数的共同值。然而，为了简单起见，我们将只限于与子域顶点相关的原始变量的情况。这个空间可以写成两个子空间的总和

!!!!
\widetilde{W}=\widehat{W}_{\Pi} \oplus \widetilde{W}_{\Delta}
\label{19.105}\end{equation}

其中$\widehat{W}_{\Pi} \subset \widehat{W}$是连续界面函数的空间，在$\Gamma_{h}$的所有节点上都消失，除了子域顶点。  $\widehat{W}_{\Pi}$是以顶点变量和界面节点集的各个边上的平均值给出的 $\Gamma_{h} . \widetilde{W}_{\Delta}$是局部子空间的直接和 $\widetilde{W}_{\Delta, i}$ 。

!!!!
\widetilde{W}_{\Delta}=\prod_{i=1}^{M} \widetilde{W}_{\Delta, i}
\label{19.106}\end{equation}

其中$\widetilde{W}_{\Delta, i} \subset W_{i}$由$\partial \Omega_{i}$上的局部函数组成，这些函数在$\Omega_{i}$的顶点消失，在每条单独的边上的平均值为零。

根据这种空间分割，与子域顶点和子空间$\widehat{W}_{\Pi}$相关的连续自由度被称为原始自由度$(\Pi)$，而那些与子空间$\Gamma$和子域边缘内部相关的（可能是不连续的）自由度被称为$\operatorname{dual}(\Delta)$。

子空间$\widehat{W}_{\Pi}$，与内部子空间一起，定义了子系统，该系统在每个迭代步骤中被完全组装、因子化和存储。

在这个阶段，第一个子空间的所有未知数以及内部变量都被消除，得到一个新的舒尔补数 $\widetilde{\Sigma}_{\Delta}$ 。更确切地说，我们的步骤如下。

让$\widetilde{A}$表示通过限制$\operatorname{diag}\left(A_{1}, \ldots, A_{M}\right)(\mathrm{see}(19.76))$从$\prod_{i=1}^{M} W^{h}\left(\Omega_{i}\right)$到$\widetilde{W}^{h}(\Omega)$得到的刚度矩阵（这些空间现在指的是子域，而不是其边界）。那么$A$就不再是块状对角线了，因为共享一个共同顶点的子域之间现在存在耦合。根据之前的空间分解，$\widetilde{A}$可以被分割成如下形式

!!!!
\widetilde{A}=\left[\begin{array}{ccc}
A_{I I} & A_{I \Pi} & A_{I \Delta} \\
A_{I \Pi}^{T} & A_{\Pi \Pi} & A_{\Pi \Delta} \\
A_{I \Delta}^{T} & A_{\Pi \Delta}^{T} & A_{\Delta \Delta}
\end{array}\right]
$$

这里的下标$I$指的是子域的内部自由度，$\Pi$指的是与子域顶点相关的自由度，$\Delta$指的是子域边缘内部的自由度，见图19.11，右侧。矩阵$A_{I I}$和$A_{\Delta \Delta}$是块对角线（每个子域一个块）。$A_{I \Delta}$的任何非零条目代表与同一子域相关的自由度之间的耦合。在消除$I$和$\Pi$集的变量后，得到与$\Delta$集（内部和边缘）的变量相关的舒尔补数，如下所示

!!!!
\tilde{\Sigma}=A_{\Delta \Delta}-\left[A_{I \Delta}^{T} A_{\Pi \Delta}^{T}\right]\left[\begin{array}{cc}
A_{I I} & A_{I \Pi} \\
A_{I \Pi}^{T} & A_{\Pi \Pi}
\end{array}\right]^{-1}\left[\begin{array}{c}
A_{I \Delta} \\
A_{\Pi \Delta}
\end{array}\right]
\label{19.107}\end{equation}

相应地，我们得到一个减少的右手边 $\tilde{\chi}_{\Delta}$ 。通过用$\mathbf{u}_{\Delta} \in \widetilde{W}_{\Delta}$表示与边相关的自由度向量，与(19.96)中对FETI所做的类似，有限元问题可以被重新表述为一个最小化问题，其约束条件是在所有$\Gamma:$中的连续性要求，找到$\mathbf{u}_{\Delta} \in \widetilde{W}_{\Delta}

!!!!
\left\{\begin{aligned}
J\left(\mathbf{u}_{\Delta}\right) &=\frac{1}{2}\left\langle\widetilde{\Sigma} \mathbf{u}_{\Delta}, \mathbf{u}_{\Delta}\right\rangle-\left\langle\tilde{\chi}_{\Delta}, \mathbf{u}_{\Delta}\right\rangle \rightarrow \min \\
B_{\Delta} \mathbf{u}_{\Delta} &=\mathbf{0}
\end{aligned}\right.
\label{19.108}\end{equation}


![](https://cdn.mathpix.com/cropped/991f5db518e324d299c1ff4972bba9fb-208.jpg?height=240&width=576&top_left_y=114&top_left_x=164)

图19.11.单层FETI空间$W$的自由度（左）和单层FETI-DP空间$W$的自由度（右）在只有原始顶点的情况下的自由度

矩阵$B_{\Delta}$是由$\{0,-1,1\}$组成的，就像$B_{\Gamma}$那样。但是请注意，这次与顶点节点相关的约束被放弃了，因为它们被分配到了原始集。还要注意的是，由于所有的约束都是指边缘点，所以不需要区分冗余和非冗余的约束和拉格朗日乘数。

通过引入一组拉格朗日乘数$\boldsymbol{\lambda} \in V=\operatorname{range}\left(B_{\Delta}\right)$，可以得到\ref{19.108}的鞍点公式，与\ref{19.97} 类似。事实上，由于$\widetilde{A}$是s.p.d.，所以$\widetilde{\Sigma}:$也是如此，通过消除子向量$\mathbf{u}_{\Delta}$，我们得到简化系统

!!!!
F_{\Delta} \boldsymbol{\lambda}=\mathbf{d}_{\Delta}
\label{19.109}\end{equation}

其中$F_{\Delta}=B_{\Delta} \widetilde{\Sigma}^{-1} B_{\Delta}^{T}$和$\mathbf{d}_{\Delta}=B_{\Delta} \widetilde{\Sigma}^{-1} \tilde{\chi}_{\Delta}

请注意，一旦找到$\boldsymbol{\lambda}$，$\mathbf{u}_{\Delta}=\widetilde{\Sigma}^{-1}\left(\tilde{\chi}_{\Delta}-B_{\Delta}^{T} \boldsymbol{\lambda}\right) \in \widetilde{W}_{\Delta}$，而内部变量$\mathbf{u}_{I}$和顶点变量$\mathbf{u}_{\Pi}$是通过反解与$\widetilde{A}$相关的系统得到的。

为$F$引入了一个预处理程序，正如在(19.103)中为FETI所做的那样（在非冗余拉格朗日乘子的情况下）。

!!!!
P_{\Delta}^{-1}=\left(B_{\Delta} D_{\Delta}^{-1} B_{\Delta}^{T}\right)^{-1} B_{\Delta} D_{\Delta}^{-1} S_{\Delta \Delta} D_{\Delta}^{-1} B_{\Delta}^{T}\left(B_{\Delta} D_{\Delta}^{-1} B_{\Delta}^{T}\right)^{-1}
\label{19.110}\end{equation}

这里$D_{\Delta}$是一个具有块$D_{\Delta}^{(i)}$的块对角线缩放矩阵：它们的每个对角线元素都对应于一个拉格朗日乘数，在某一点$w_{i} \in W_{i}$和$w_{j} \in W_{j}$的节点值之间执行连续性，它是由$\delta_{j}^{\dagger}(x)$给出。此外，$\Sigma_{\Delta \Delta}=\operatorname{diag}\left(\Sigma_{1, \Delta \Delta}, \ldots, \Sigma_{M, \Delta \Delta}\right)$与$\Sigma_{i, \Delta \Delta}$是局部舒尔补数$\Sigma_{i}$对$\widetilde{W}_{\Delta, i} \subset W_{i}$的限制。

当对预设系统使用共轭梯度法时

!!!!
P_{\Delta}^{-1} F_{\Delta} \boldsymbol{\lambda}=P_{\Delta}^{-1} \mathbf{d}_{\Delta}
$$

与一级FETI方法相比，我们可以使用一个任意的初始猜测 $\boldsymbol{\lambda}^{0}$ 。

关于这个算法的有效实现，见[TW05，第6.4.1节]。另外，在这种情况下，我们有一个条件数，它以多项式扩展，即

!!!!
K_{2}\left(P_{\Delta}^{-1} F_{\Delta}\right) \leq C(1+\log (H / h))^{2}
$$

其中$C$独立于$h, H, \gamma$和$\rho_{i}$的值。关于全面的介绍和分析，见 [KWD02] 和 [TW05] 。

为了对FETI和FETI-DP方法进行结论性的比较，按照[TW05]，我们可以注意到FETI-DP算法不需要对局部Neumann问题的核进行描述（如单级方法所要求的），因为在每次迭代中执行附加约束总是使局部问题非星形化，同时提供一个基本的粗略的全局问题。FETI-DP方法不需要引入缩放矩阵$Q$，这在构建单级FETI算法的粗解器中是有的。

最后，值得注意的是，一级FETI方法是投影共轭梯度算法，不能从任意的初始猜测开始。相比之下，FETI-DP方法是标准的先决条件共轭算法，因此可以采用任意的初始猜测 $\boldsymbol{\lambda}^{0}$ 。

\subsubsection{BDDC (Balancing Domain Decomposition with Constraints) methods}

这个方法是由Dohrmann[Doh03]提出的，作为FETI-DP领域分解方法的一个更简单的原始选择。BDDC这个名字是由Mandel和Dohrmann创造的，因为它可以被理解为平衡域分解方法[Man93]的进一步发展，BDDC算法的粗略的、全局的部分用一组原始约束来表示。

与最初的Neumann-Neumann和一列维FETI方法相比，FETIDP和BDDC算法不需要解决任何奇异的线性方程组（那些与纯Neumann问题有关的方程组）。事实上，任何给定的原始变量集的选择都决定了一个FETI-DP方法和一个相关的BDDC方法。这对方法定义了二重性，并且具有相同的特征值谱（直到特征值0和1为止）（见[LW06]）。当然，为了获得高效的FETI-DP或BDDC算法，原始约束的选择是一个关键问题。

BDDC被用作共轭梯度法的预处理工具。BDDC的一个具体版本的特点是选择粗大的自由度，它可以是子域角落的数值，也可以是子域之间界面边缘的平均数。然后，BDDC预处理程序的一个应用是将每个子域上的局部问题的解决与以粗自由度为未知数的全局粗问题的解决相结合。不同子域上的局部问题是完全相互独立的，因此该方法适合于并行计算。一个BDDC预处理程序读作

!!!!
P_{B D D C}^{-1}=\widetilde{R}_{D \Gamma}^{T} \widetilde{\Sigma}^{-1} \widetilde{R}_{D \Gamma}
$$

其中$\widetilde{R}_{\Gamma}: \widehat{W} \rightarrow \widetilde{W}$是一个限制矩阵，$\widetilde{R}_{D \Gamma}$是$\widetilde{R}_{\Gamma}$的比例变体，比例系数为$\delta_{i}^{\top}$（具有与$R_{\Gamma}$相同的稀疏性模式）。这个比例的选择是为了使$\widetilde{R}_{\Gamma} \widetilde{R}_{D \Gamma}^{T}$是一个投影（那么它与它的平方重合）。

BDDC预处理的理论分析（及其与FETIDP预处理的频谱类比）首先在[MDT05]中提供，后来在[LW06]和[BS07] 中提供。
 ![](https://cdn.mathpix.com/cropped/991f5db518e324d299c1ff4972bba9fb-210.jpg?height=228&width=576&top_left_y=103&top_left_x=170)

图19.12.经典形式的施瓦兹方法适用的两个例子

\subsection{Schwarz iterative methods}

第19.1.1节中描述的施瓦兹方法，其原始形式是由H.施瓦兹[Sch69]提出的，作为一种迭代方案，用于证明在形状抑制直接应用傅里叶级数的域中设置的椭圆方程解的存在。图19.12中显示了两个基本的例子。这种方法在某些方面仍被用作任意形状域中的椭圆方程的求解方法。然而，现在它主要用于一个不同的版本，即共轭梯度（或更普遍的，Krylov）迭代的DD预处理，用于解决由边界值问题的有限元（或其他类型）离散化产生的代数系统。

正如在第19.1.1节中所看到的，施瓦兹方法的显著特点是它是基于原域的重叠细分。让我们仍然表示$\left\{\Omega_{m}\right\}$这些子域。

首先，在下面的小节中，我们将展示施瓦兹方法如何被表述为一种迭代算法来解决与问题\ref{19.1} 的有限元离散化相关的代数系统。

\subsubsection{Algebraic form of Schwarz method for finite element discretizations}

像往常一样考虑域$\mathscr{T}_{h}$的有限元三角化$\Omega$ 。然后假设$\Omega$被分解为两个重叠的子域，$\Omega_{1}$和$\Omega_{2}$，如图$19.1$（左）所示。

用$N_{h}$表示三角形内部的节点总数（即它们不在其边界上），用$N_{1}$和$N_{2}$分别表示$\Omega_{1}$和$\Omega_{2}$的内部节点，如第19.3节所做。请注意，$N_{h} \leq N_{1}+N_{2}$和平等只有在重叠部分减少到单层元素时才成立。事实上，如果我们用$I=\left\{1, \ldots, N_{h}\right\}$表示$\Omega$的节点索引集，用$I_{1}$和$I_{2}$分别表示与$\Omega_{1}$和$\Omega_{2}$的内部节点相关的索引，就有$I=I_{1} \cup I_{2}$ ，而$I_{1} \cap I_{2} \neq \emptyset$除非重叠部分由单层元素组成。

让我们以这样的方式排列节点，第一块对应于$\Omega_{1} \backslash \Omega_{2}$中的节点，第二块对应于$\Omega_{1} \cap \Omega_{2}$中的节点，第三块对应于$\Omega_{2} \backslash \Omega_{1}$ 中的节点。有限元离散化的刚度矩阵$A$包含两个子矩阵，$A_{1}$和$A_{2}$，分别对应于$\Omega_{1}$和$\Omega_{2}$的局部刚度矩阵（见图19.13）。它们与$A$的关系如下

![](https://cdn.mathpix.com/cropped/991f5db518e324d299c1ff4972bba9fb-211.jpg?height=235&width=285&top_left_y=204&top_left_x=315)

图19.13.刚度矩阵$A_{1}$和$A_{2}$的子矩阵$A$ 。

!!!!
A_{1}=R_{1} A R_{1}^{T} \in \mathbb{R}^{N_{1} \times N_{1}} \quad \text { and } \quad A_{2}=R_{2} A R_{2}^{T} \in \mathbb{R}^{N_{2} \times N_{2}}
\label{19.111}\end{equation}

分别为$R_{i}$和$R_{i}^{T}$，为$i=1,2$，是限制和延长算子。后者的矩阵表示为

!!!!
R_{1}^{T}=\left[\begin{array}{ccc}
1 & \ldots & 0 \\
\vdots & \ddots & \vdots \\
0 & \ldots & 1 \\
0 &
\end{array}\right] \in \mathbb{R}^{N_{h} \times N_{1}}, \quad R_{2}^{T}=\left[\begin{array}{ccc} 
& 0 & \\
1 & \ldots & 0 \\
\vdots & \ddots & \vdots \\
0 & \ldots & 1
\end{array}\right] \in \mathbb{R}^{N_{h} \times N_{2}}
\label{19.112}\end{equation}

如果$\mathbf{v}$是$\mathbb{R}^{N_{h}}$的一个向量，那么$R_{1} \mathbf{v}$是$\mathbb{R}^{N_{1}}$的一个向量，其分量与$N_{1}$的第一个分量重合。如果$\mathbf{v}$是一个$\mathbb{R}^{N_{1}}$的向量，那么$R_{1}^{T} \mathbf{v}$将是一个维度为$N_{h}$的向量，其最后的$N_{h}-N_{1}$成分都是零。

通过使用这些定义，应用于系统$A \mathbf{u}=\mathbf{f}$的乘法施瓦茨方法的迭代可以表示如下。

!!!!
\mathbf{u}^{(k+1 / 2)}=\mathbf{u}^{(k)}+R_{1}^{T} A_{1}^{-1} R_{1}\left(\mathbf{f}-A \mathbf{u}^{(k)}\right)
\label{19.113}\end{equation}

!!!!
\mathbf{u}^{(k+1)}=\mathbf{u}^{(k+1 / 2)}+R_{2}^{T} A_{2}^{-1} R_{2}\left(\mathbf{f}-A \mathbf{u}^{(k+1 / 2)}\right)
\label{19.114}\end{equation}

等价地，通过设置

!!!!
P_{i}=R_{i}^{T} A_{i}^{-1} R_{i} A, \quad i=1,2,
\label{19.115}\end{equation}

我们有

!!!!
\begin{gathered}
\mathbf{u}^{(k+1 / 2)}=\left(I-P_{1}\right) \mathbf{u}^{(k)}+P_{1} \mathbf{u} \\
\mathbf{u}^{(k+1)}=\left(I-P_{2}\right) \mathbf{u}^{(k+1 / 2)}+P_{2} \mathbf{u}=\left(I-P_{2}\right)\left(I-P_{1}\right) \mathbf{u}^{(k)}+\left(P_{1}+P_{2}-P_{2} P_{1}\right) \mathbf{u}
\end{gathered}
$$

同样地，加法施瓦茨方法的迭代结果为

!!!!
\mathbf{u}^{(k+1)}=\mathbf{u}^{(k)}+\left(R_{1}^{T} A_{1}^{-1} R_{1}+R_{2}^{T} A_{2}^{-1} R_{2}\right)\left(\mathbf{f}-A \mathbf{u}^{(k)}\right)
\label{19.116}\end{equation}

就是说

!!!!
\mathbf{u}^{(k+1)}=\left(I-P_{1}-P_{2}\right) \mathbf{u}^{(k)}+\left(P_{1}+P_{2}\right) \mathbf{u} .
\label{19.117}\end{equation}

介绍一下矩阵

!!!!
Q_{i}=R_{i}^{T} A_{i}^{-1} R_{i}=P_{i} A^{-1}, i=1,2
$$

从(19.113)和(19.114)中，我们推导出以下乘法施瓦茨方法的递归公式

!!!!
\begin{aligned}
\mathbf{u}^{(k+1)} &=\mathbf{u}^{(k)}+Q_{1}\left(\mathbf{f}-A \mathbf{u}^{(k)}\right)+Q_{2}\left[\mathbf{f}-A\left(\mathbf{u}^{(k)}+Q_{1}\left(\mathbf{f}-A \mathbf{u}^{(k)}\right)\right)\right] \\
&=\mathbf{u}^{(k)}+\left(Q_{1}+Q_{2}-Q_{2} A Q_{1}\right)\left(\mathbf{f}-A \mathbf{u}^{(k)}\right)
\end{aligned}
$$

而对于加法施瓦茨方法，我们从\ref{19.116}中得到，即

!!!!
\mathbf{u}^{(k+1)}=\mathbf{u}^{(k)}+\left(Q_{1}+Q_{2}\right)\left(\mathbf{f}-A \mathbf{u}^{(k)}\right)
\label{19.118}\end{equation}

这最后一个公式可以很容易地扩展到将$\Omega$分解为$M \geq 2$重叠子域$\left\{\Omega_{i}\right\}$的情况（见图19.14的例子）。在这种情况下，我们有

!!!!
\mathbf{u}^{(k+1)}=\mathbf{u}^{(k)}+\left(\sum_{i=1}^{M} Q_{i}\right)\left(\mathbf{f}-A \mathbf{u}^{(k)}\right)
\label{19.119}\end{equation}

\subsubsection{Schwarz preconditioners}

用来表示

!!!!
P_{a s}=\left(\sum_{i=1}^{M} Q_{i}\right)^{-1}
\label{19.120}\end{equation}

从(19.119)可以看出，加法施瓦茨方法的迭代对应于以$P_{a s}$为预处理的线性系统$A \mathbf{u}=\mathbf{f}$的解的预处理Richardson方法的迭代（见7.2.1节）。由于这个原因，矩阵$P_{a s}$被命名为加性施瓦茨预处理。

在子域不相交（无重叠）的情况下，$P_{a s}$与块状雅可比预处理器相吻合。

!!!!
P_{J}=\left[\begin{array}{ccc}
A_{1} & & 0 \\
& \ddots & \\
0 & & A_{M}
\end{array}\right], \quad P_{J}^{-1}=\left[\begin{array}{ccc}
A_{1}^{-1} & & 0 \\
& \ddots & \\
0 & & A_{M}^{-1}
\end{array}\right]
\label{19.121}\end{equation}

其中，我们删除了$A$的非对角线块。等价地，加法施瓦茨方法的一次迭代相当于Richardson方法对预设线性系统$Q_{a} \mathbf{u}=\mathbf{g}_{a}$的一次迭代，其中$\mathbf{g}_{a}=P_{a s}^{-1} \mathbf{f}$，预设的矩阵$Q_{a}$为

!!!!
Q_{a}=P_{a s}^{-1} A=\sum_{i=1}^{M} P_{i}
$$

通过类似的方法，使用乘法施瓦茨方法将得到以下预设的矩阵

!!!!
Q_{M}=P_{m s}^{-1} A=I-\left(I-P_{M}\right) \ldots\left(I-P_{1}\right)
$$

Lemma 19.3. Matrices $P_{i}$ defined in (19.115) are symmetric and non-negative w.r.t the following scalar product induced by A

!!!!
(\mathbf{w}, \mathbf{v})_{A}=(A \mathbf{w}, \mathbf{v}) \quad \forall \mathbf{w}, \mathbf{v} \in \mathbb{R}^{N_{h}}
$$


证明。对于$i=1,2$，我们有

!!!!
\begin{aligned}
\left(P_{i} \mathbf{w}, \mathbf{v}\right)_{A} &=\left(A P_{i} \mathbf{w}, \mathbf{v}\right)=\left(R_{i}^{T} A_{i}^{-1} R_{i} A \mathbf{w}, A \mathbf{v}\right)=\left(A \mathbf{w}, R_{i}^{T} A_{i}^{-1} R_{i} A \mathbf{v}\right) \\
&=\left(\mathbf{w}, P_{i} \mathbf{v}\right)_{A} \quad \forall \mathbf{v}, \mathbf{w} \in \mathbb{R}^{N_{h}}
\end{aligned}
$$

此外，$\forall \mathbf{v} \in \mathbb{R}^{N_{h}}$。

!!!!
\left(P_{i} \mathbf{v}, \mathbf{v}\right)_{A}=\left(A P_{i} \mathbf{v}, \mathbf{v}\right)=\left(R_{i}^{T} A_{i}^{-1} R_{i} A \mathbf{v}, A \mathbf{v}\right)=\left(A_{i}^{-1} R_{i} A \mathbf{v}, R_{i} A \mathbf{v}\right) \geq 0
$$

定理19.4。加法施瓦茨方法的预处理矩阵$Q_{a}$是对称和正定的，与$A$所引起的标量积有关。

证明。我们首先证明对称性：对于所有的$\mathbf{u}, \mathbf{v} \in \mathbb{R}^{N_{h}}$，由于$A$和$P_{i}$都是对称的，我们得到

!!!!
\begin{aligned}
\left(Q_{a} \mathbf{u}, \mathbf{v}\right)_{A} &=\left(A Q_{a} \mathbf{u}, \mathbf{v}\right)=\left(Q_{a} \mathbf{u}, A \mathbf{v}\right)=\sum_{i}\left(P_{i} \mathbf{u}, A \mathbf{v}\right) \\
&=\sum_{i}\left(P_{i} \mathbf{u}, \mathbf{v}\right)_{A}=\sum_{i}\left(\mathbf{u}, P_{i} \mathbf{v}\right)_{A}=\left(\mathbf{u}, Q_{a} \mathbf{v}\right)_{A}
\end{aligned}
$$

关于积极性，选择前者的特征$\mathbf{u}=\mathbf{v}$，我们得到

!!!!
\left(Q_{a} \mathbf{v}, \mathbf{v}\right)_{A}=\sum_{i}\left(P_{i} \mathbf{v}, \mathbf{v}\right)_{A}=\sum_{i}\left(R_{i}^{T} A_{i}^{-1} R_{i} A \mathbf{v}, A \mathbf{v}\right)=\sum_{i}\left(A_{i}^{-1} \mathbf{q}_{i}, \mathbf{q}_{i}\right) \geq 0
$$

有集$\mathbf{q}_{i}=R_{i} A \mathbf{v}$ 。由此可见，$\left(Q_{a} \mathbf{v}, \mathbf{v}\right)_{A}=0$ iff $\mathbf{q}_{i}=\mathbf{0}$ 对于每一个$i$ ，即 iff $A \mathbf{v}=\mathbf{0}$ 。由于$A$是正定的，所以$\mathbf{i f f} \mathbf{v}=\mathbf{0}$成立。根据前面的特性，我们可以推断出，通过用预设条件的共轭梯度迭代代替预设条件的Richardson迭代，但使用相同的加性Schwarz预设条件，可以产生一个更有效的迭代方法 $P_{a s}$ 。不幸的是，这个预处理程序是不可扩展的。事实上，预处理矩阵的条件数$Q_{a}$只能被限定为

!!!!
K_{2}\left(P_{a s}^{-1} A\right) \leq C \frac{1}{\delta H}
\label{19.122}\end{equation}

是$C$一个独立于$h, H$和$\delta ;$的常数，这里$\delta$是重叠区域的一个特征线性度量，像通常一样，$H=\max _{i=1, \ldots, M}\left\{\operatorname{diam}\left(\Omega_{i}\right)\right\}$ 。这是由于信息的交换只发生在相邻的子域之间，因为$\left(P_{a s}\right)^{-1}$的应用只涉及局部求解器。在当前情况下，可以通过引入一个定义在整个域$\Omega$上的全局粗略求解器来克服这一限制，并且能够保证所有子域之间的全局交流。这导致了两级域分解策略的设计，见第19.6.3节。

让我们来谈谈一些算法方面的问题。让我们将域$\Omega$细分为$M$子域$\left\{\Omega_{i}\right\}_{i=1}^{M}$，这样$\cup_{i=1}^{M} \bar{\Omega}_{i}=\bar{\Omega}$ 。对于一个合适的$\xi \in \mathbb{N}$，相邻的子域共享一个大小至少等于$\delta=\xi h$的重叠区域。特别是，$\xi=1$对应于最小重叠的情况，即重叠带减少为单层的有限元。可以使用以下算法。

![](https://cdn.mathpix.com/cropped/991f5db518e324d299c1ff4972bba9fb-214.jpg?height=196&width=717&top_left_y=663&top_left_x=100)

在图$19.14$中，一个矩形的二维域被细分为9个不相交的子域$\hat{\Omega}_{i}$（在左边）；还显示了其中一个扩展（重叠）的子域（在右边）。

为了应用施瓦兹预处理\ref{19.120}，我们可以按照算法18.5所示进行。我们记得$N_{i}$是$\Omega_{i}, R_{i}^{T}$和$R_{i}$的内部节点数，分别是\ref{19.112}中引入的延长矩阵和限制矩阵，$A_{i}$是\ref{19.111}中引入的局部刚度矩阵。在图19.15中，我们展示了$R_{i}$的一个稀疏模式的例子。

![](https://cdn.mathpix.com/cropped/991f5db518e324d299c1ff4972bba9fb-214.jpg?height=155&width=547&top_left_y=1094&top_left_x=97)



![](https://cdn.mathpix.com/cropped/991f5db518e324d299c1ff4972bba9fb-215.jpg?height=150&width=712&top_left_y=114&top_left_x=100)

对算法$18.5$和算法$18.6$的一些一般性评论是有必要的。

- 算法$18.5$的步骤a.和b.可以按相反的顺序进行，也就是说，我们可以先将计算域细分为子域（例如基于物理考虑），然后建立一个三角测量。

- 根据一般的代码结构，算法$18.6$的步骤b.和c.可以被粘在一起，以优化内存需求和CPU时间。

在其他情况下，我们可以互换步骤 $b$ . 和 $c$ . ，即可以先建立局部刚度矩阵 $A_{i}$ （使用单处理器），然后再组装以构建全局刚度矩阵 $A$ 。

事实上，有效利用并行计算机平台的一个关键因素是保持数据定位，因为在大多数情况下，在处理器之间移动数据所需的时间可能高于计算所需的时间。

其他代码（如AztecOO、Trilinos、IFPACK）则从全局刚度出发。
 ![](https://cdn.mathpix.com/cropped/991f5db518e324d299c1ff4972bba9fb-215.jpg?height=238&width=538&top_left_y=683&top_left_x=186)

图19.14.将一个矩形区域$\Omega$分割成9个不相交的子区域$\hat{\Omega}_{i}$（在左边），以及一个扩展子域$\Omega_{5}$的例子（在右边）。

![](https://cdn.mathpix.com/cropped/991f5db518e324d299c1ff4972bba9fb-215.jpg?height=216&width=534&top_left_y=1006&top_left_x=190)

图19.15.矩阵$R_{i}$在4个子域中的分区的稀疏模式 表19.4.$P_{a s}^{-1} A$的几个值$h$和$H$的条件数

\begin{tabular}{lcccc}
\hline $K_{2}\left(P_{a s}^{-1} A\right)$ & $H=1 / 2$ & $H=1 / 4$ & $H=1 / 8$ & $H=1 / 16$ `hline $K_{2}\left(P_{a s}^{-1} A\right)$ & $H=1 / 2$ & $H=1 / 4$ & $H=1 / 16$ `hline
\hline $h=1 / 16$ & $15.95$ & $27.09$ & $52.08$ & $-$ （$h=1 / 16$）。
 $h=1 / 32$ & $31.69$ & $54.52$ & $104.85$ & $207.67$ （$207.67$）。
 $h=1 / 64$ & $63.98$ & $109.22$ & $210.07$ & $416.09$ （$h=1 / 64$）。
 $h=1 / 128$ & $127.99$ & $218.48$ & $420.04$ & $832.57$。
\hline
\end{tabular}

在MATLAB中，首先建立$A$矩阵，然后是限制矩阵$R_{i}$，最后是矩阵乘法，这样就可以得出局部刚度矩阵$A_{i}$。然而，在MATLAB中，首先建立$A$，接下来建立限制矩阵$R_{i}$，最后进行矩阵乘法$R_{i} A R_{i}^{T}$以生成$A_{i}$，似乎更方便。

在表$19.4$中，我们分析了最小重叠$(\delta=$ $h$的分解的情况），考虑了子域数量$M$的几个值。子域$\Omega_{i}$是面积为$H^{2}$的重叠方块。请注意，理论估计\ref{19.122}被我们的结果所满足。

\subsubsection{Two-level Schwarz preconditioners}

正如第19.6.2节所预计的，Schwarz方法的主要限制是只在相邻的子域之间传播信息。至于Neumann-Neumann方法，一个可能的补救措施是引入一个粗大的网格机制，允许在整个域中突然进行信息扩散 $\Omega$ 。这个想法仍然是将子域视为新的粗网格的宏观元素 $\mathscr{T}_{H}$ 并建立一个相应的刚度矩阵 $A_{H}$ 。该矩阵

!!!!
Q_{H}=R_{H}^{T} A_{H}^{-1} R_{H}
$$

其中$R_{H}$是细格到粗格的限制算子，表示新的两级预处理器的粗级修正。更确切地说，为方便记述，设定$Q_{0}=Q_{H}$，两级预处理$P_{\text {cas }}$通过其逆向定义为

!!!!
P_{c a s}^{-1}=\sum_{i=0}^{M} Q_{i}
\label{19.123}\end{equation}

以下结果可以在$2 \mathrm{D}$中得到证明：存在一个常数$C>0$，独立于$h$和$H$，使得

!!!!
K_{2}\left(P_{\text {cas }}^{-1} A\right) \leq C\left(1+\frac{H}{\delta}\right) .
$$

比率$H / \delta$衡量相邻重叠子域之间的相对重叠。对于 "慷慨的 "重叠，即如果$\delta$是$H$的一小部分，预处理程序$P_{\text {cas }}$是可以扩展的。因此，使用预处理程序$P_{\text {cas }}$对原始有限元系统进行共轭梯度迭代，其收敛速度与$h$和$H$（以及子域的数量）无关。此外，由于加法结构\ref{19.123}，预处理步骤是完全并行的，因为它涉及到$M$独立系统的解决，每个局部矩阵$A_{i}$一个。

在$3 \mathrm{D}$中，我们会得到一个系数为$H / h$的约束，除非椭圆微分算子有常数系数（或变化不太大的可变系数）。

使用$P_{\text {cas }}$涉及到$P_{a s}$所要求的相同类型的操作，再加上以下算法的操作。

Algorit\}

hm $18.7$ （使用 $\boldsymbol{P}_{\text {cas }}$ 的启动阶段）。

![](https://cdn.mathpix.com/cropped/991f5db518e324d299c1ff4972bba9fb-217.jpg?height=32&width=93&top_left_y=349&top_left_x=121)

a.执行算法$\mathbf{1 8 . 6}

!!!!
A_{H}(i, j)=a\left(\Phi_{j}, \Phi_{i}\right)=\int_{\Omega} \sum_{\ell=1}^{d} \frac{\partial \Phi_{i}}{\partial x_{\ell}} \frac{\partial \Phi_{j}}{\partial x_{\ell}}
$$

![](https://cdn.mathpix.com/cropped/991f5db518e324d299c1ff4972bba9fb-217.jpg?height=22&width=14&top_left_y=794&top_left_x=775)

!!!!
A_{H}=R_{H} A R_{H}^{T}
!!!!
 ![](https://cdn.mathpix.com/cropped/991f5db518e324d299c1ff4972bba9fb-217.jpg?height=220&width=490&top_left_y=918&top_left_x=213)

图 19.16.左边是基于结构化网格的二维领域的粗大网格的例子。精细网格的三角形有薄的边缘；厚的边缘标识了粗网格元素的边界。右边是一个类似的结构，这次是一个非结构化的细网格 对于一个形状简单的计算域（比如我们考虑的这个），通常先生成粗网格$\mathscr{T}_{H}$，然后通过多次细化，生成细网格$\mathscr{T}_{h}$ 。在其他情况下，当领域具有复杂的形状和/或已经有了非结构化的细网格$\mathscr{T}_{h}$时，生成粗网格可能是困难的或计算上昂贵的。第一个选择是通过连续取消细网格的定义来生成$\mathscr{T}_{H}$，在这种情况下，粗网格的节点将代表细网格的一个子集。然而，这种方法在$3 \mathrm{D}$中可能不是很有效。

或者，我们可以独立地生成两个（不一定是嵌套的）网格$\mathscr{T}_{h}$和$\mathscr{T}_{H}$，然后从细网格到粗网格生成相应的限制和延长算子，$R_{H}$和$R_{H}^{T}$ 。

因此，$P_{\text {cas }}$的最终实现可以做成如下样子。

![](https://cdn.mathpix.com/cropped/991f5db518e324d299c1ff4972bba9fb-218.jpg?height=467&width=727&top_left_y=439&top_left_x=90)

在表$19.5$中，我们报告了最小重叠$\delta=h$情况下$P_{\text {cas }}^{-1} A$的条件数。请注意，在每个NW-SE对角线上的条件数几乎是相同的（即对于比率的固定值$H / \delta$）。

表19.5.$P_{\text {cas }}^{-1} A$和$H$的几个值的条件数

\begin{tabular}{lcccc}
\hline $K_{2}\left(P_{\text {cas }}^{-1} A\right)$ & $H=1 / 4$ & $H=1 / 8$ & $H=1 / 16$ & $H=1 / 32$ \hline $h=1 / 32$ & $7.03$ & $4.94$ & $H=1 / 32$ \hline
\Hline $h=1 / 32$ & $7.03$ & $4.94$ & $-$ & $-$（1）。
 
 $h=1 / 128$ & $23.62$ & $13.17$ & $7.66$ & $4.99$（1）。
 $h=1 / 256$ & $45.33$ & $24.34$ & $13.28$ & $-$ $-$。
\hline
\end{tabular}

可以设计出一种替代粗略网格校正的方法，如下所示。假设限制矩阵的系数为

!!!!
\hat{R}_{H}(i, j)= \begin{cases}1 & \text { if the } j-t h \text { node is in } \Omega_{i} \\ 0 & \text { otherwise }\end{cases}
$$

那么我们设置 $\hat{A}_{H}=\hat{R}_{H} A \hat{R}_{H}^{T}$ 。这个过程被命名为聚合，因为$\hat{A}_{H}$的元素是通过简单地将$A$的条目相加得到的。请注意，在这种情况下，我们不需要构建一个粗大的网格。相应的预处理程序，用$P_{\text {aggre }}$表示，它的逆运算为

!!!!
P_{\text {aggre }}^{-1}=\hat{R}_{H}^{T} \hat{A}_{H}^{-1} \hat{R}_{H}+P_{a s}
$$

可以证明的是

!!!!
K_{2}\left(P_{\text {aggre }}^{-1} A\right) \leq C\left(1+\frac{H}{\delta}\right)
$$

在表 $19.6$ 中，我们报告了不同的 $h$ 和 $H$ 值的条件数的几个数值。

表19.6.$P_{\text {aggre }}^{-1} A$和$H$的几个值的条件数

\begin{tabular}{lccc} （中文）。
\hline $P_{a g g r e}^{-1} A$ & $H=1 / 4$ & $H=1 / 8$ & $H=1 / 16$ \hline $P_{a g g r e}^{-1} A$ & $H=1 / 4$ & $H=1 / 8$ & $H=1 / 16$
\$h=1 / 16$ & $13.37$ & $8.87$ & $-$ $-$。
 $h=1 / 32$ & $26.93$ & $17.71$ & $9.82$。
 $h=1 / 64$ & $54.33$ & $35.21$ & $19.70$。
 $h=1 / 128$ & $109.39$ & $70.22$ & $39.07$。
\hline
\end{tabular}

如果$H / \delta=$恒定，这个两级预处理程序既是最优的，也是可扩展的，即预处理的刚度矩阵的条件数与$h$和$H$都无关。

在本节结束时，我们可以用以下的实际指示来总结。

- 对于具有少量子域的分解，单级施瓦茨预处理程序$P_{a s}$非常有效。

- 当子域的数量$M$变大时，使用两级预处理变得至关重要；在难以生成粗网格的情况下，可以采用聚集技术来替代粗网格的使用。

\subsection{An abstract convergence result}

对重叠和非重叠域分解预处理的分析是基于以下抽象理论，是由P.L. Lions, J. Bramble, M. Dryja, O. Wildlund提出。让$V_{h}$是一个有限维的希尔伯特空间。在我们的应用中，$V_{h}$是有限元空间或谱元空间之一。让$V_{h}$被分解如下。

!!!!
V_{h}=V_{0}+V_{1}+\cdots+V_{M}
$$

设$F \in V^{\prime}$和$a: V \times V \rightarrow \mathbb{R}$是一个对称的、连续的和胁迫的双线性形式。考虑问题

!!!!
\text { find } u_{h} \in V_{h}: a\left(u_{h}, v_{h}\right)=F\left(v_{h}\right) \quad \forall v_{h} \in V_{h} .
\label{19.124}\end{equation}

设$P_{i}: V_{h} \rightarrow V_{i}$是一个投影算子，定义为

!!!!
b_{i}\left(P_{i} u_{h}, v_{h}\right)=a\left(u_{h}, v_{h}\right) \quad \forall v_{h} \in V_{i}
$$

与$b_{i}: V_{i} \times V_{i} \rightarrow \mathbb{R}$是每个子空间$V_{i}$上的局部对称、连续和胁迫的双线性形式。假设以下属性成立。

a. 稳定的子空间分解。

$\exists C_{0}>0$，使每一个$u_{h} \in V_{h}$都有一个$u_{h}=\sum_{i=0}^{M} u_{i}$与$u_{i} \in V_{i}$的分解，并且

!!!!
\sum_{i=0}^{M} b_{i}\left(u_{i}, u_{i}\right) \leq C_{0}^{2} a\left(u_{h}, u_{h}\right)
$$

b. 加强Cauchy-Schwarz不等式。

$\exists \varepsilon_{i j} \in[0,1], i, j=0, \ldots, M$，以便

!!!!
a\left(u_{i}, u_{i}\right) \leq \varepsilon_{i j} \sqrt{a\left(u_{i}, u_{i}\right)} \sqrt{a\left(u_{j}, u_{j}\right)} \quad \forall u_{i} \in V_{i}, u_{j} \in V_{j}
$$

c. 局部稳定。

$\exists \omega \geq 1$ 这样，$\forall i=0, \ldots, M$ 。

!!!!
a\left(u_{i}, u_{i}\right) \leq \omega b_{i}\left(u_{i}, u_{i}\right) \quad \forall u_{i} \in \operatorname{Range}\left(P_{i}\right) \subset V_{i} .
$$

那么，$\forall u_{h} \in V_{h}$ 。

!!!!
C_{0}^{-2} a\left(u_{h}, u_{h}\right) \leq a\left(P_{a s} u_{h}, u_{h}\right) \leq \omega(\rho(E)+1) a\left(u_{h}, u_{h}\right)
\label{19.125}\end{equation}

其中$\rho(E)$是矩阵$E=\left(\varepsilon_{i j}\right)$的谱半径，$P_{a s}=P_{0}+\cdots+P_{M}$是域分解预处理器。

从不等式(19.125)来看，预处理系统有如下约束

!!!!
K\left(B^{-1} A\right) \leq C_{0}^{2} \omega(\rho(E)+1)
$$

其中$K(\cdot)$表示光谱条件数，$A$是与原系统相关的矩阵\ref{19.124}, B$是与算子相关的矩阵$P_{a s}$ 。关于证明，见例如 [TW05] 。

\subsection{ 其他微分问题的接口条件}

第19.1.2节中的定理$19.1$允许二阶椭圆问题\ref{19.1} 被重新表述为DD版本，这要归功于合适的接口条件\ref{19.9} 和\ref{19.10} 。另一方面，正如我们已经广泛讨论过的，这种重述为几个不相交的DD分区的迭代算法奠定了基础。它们包括Dirichlet-Neumann、Neumann-Neumann、Robin-Robin算法，更广泛地说，Schur补数系统\ref{19.53} 的所有预处理迭代算法都使用了合适的DD预处理器。

在这一节中，我们考虑其他类型的边界值问题并制定相关的接口条件。表$19.7$显示了这些问题的接口条件。对于更多的细节，分析和研究相关的迭代DD算法，感兴趣的读者可以参考 [QV99] 。在此，我们只限于提供一些关于平流和斯托克斯方程的额外见解。

平流（传输）问题。考虑微分问题

!!!!
L u=\nabla \cdot(\mathbf{b} u)+a_{0} u=f \quad \text { in } \Omega
\label{19.126}\end{equation}

辅以边界上的适当条件 $\partial \Omega$ 。考虑将计算域$\Omega$划分为两个不相交的子域，其界面为$\Gamma$ 。让我们对后者进行如下划分（见图19.17）。  $\Gamma=\Gamma_{\text {in }} \cup \Gamma_{\text {out }}$ ，其中

!!!!
\Gamma_{i n}=\{x \in \Gamma \mid \mathbf{b}(x) \cdot \mathbf{n}(x)>0\} \text { and } \Gamma_{\text {out }}=\Gamma \backslash \Gamma_{\text {in }} .
$$

![](https://cdn.mathpix.com/cropped/991f5db518e324d299c1ff4972bba9fb-221.jpg?height=309&width=351&top_left_y=890&top_left_x=275)

图 19.17.平流问题\ref{19.126}的域划分和界面分割 例19.4.对于手头的问题，Dirichlet-Neumann方法可以被概括为：被给定的两个函数$u_{1}^{(0)}, u_{2}^{(0)}$在$\Gamma, \forall k \geq 0$上解。

!!!!
\begin{aligned}
& \begin{cases}L u_{1}^{(k+1)}=f & \text { in } \Omega_{1} \\
(\mathbf{b} \cdot \mathbf{n}) u_{1}^{(k+1)}=(\mathbf{b} \cdot \mathbf{n}) u_{2}^{(k)} & \text { on } \Gamma_{o u t}\end{cases} \\
&\left\{\begin{array}{ll}
L u_{2}^{(k+1)}=f & \text { in } \Omega_{2} \\
(\mathbf{b} \cdot \mathbf{n}) u_{2}^{(k+1)}=\theta(\mathbf{b} \cdot \mathbf{n}) u_{1}^{(k+1)}+(1-\theta)(\mathbf{b} \cdot \mathbf{n}) u_{2}^{(k)}
\end{array} \text { on } \Gamma_{i n}\right.
\end{aligned}
$$

其中$\theta>0$表示一个合适的松弛参数。适应有限元离散化的情况是直截了当的。

斯托克斯问题。斯托克斯方程\ref{17.11} 有两个变量场：流体速度和流体压力。当考虑DD分区时，在子域界面只有速度场被要求是连续的。压力不一定是连续的，因为在斯托克斯方程的弱式表述中，"只 "要求它在$L^{2}$。此外，在界面$\Gamma$上，法向Cauchy应力$v \frac{\partial \mathrm{u}}{\partial n}-p \mathbf{n}$的连续性只需要以弱（自然）形式满足。

例19.5.斯托克斯问题的Dirichlet-Neumann算法在每次迭代时都需要解决以下子问题（我们用简短的符号$\mathscr{S}$来表示斯托克斯算子）。

!!!!
\begin{cases}\mathscr{S}\left(\mathbf{u}_{2}^{(k+1)}, p_{2}^{(k+1)}\right)=\mathbf{f} & \text { in } \Omega_{2} \\ v \frac{\partial \mathbf{u}_{2}^{(k+1)}}{\partial n}-p_{2}^{(k+1)}=v \frac{\partial \mathbf{u}_{1}^{(k)}}{\partial n}-p_{1}^{(k)} & \text { on } \Gamma \\ \mathbf{u}_{2}^{(k+1)}=\mathbf{0} & \text { on } \partial \Omega_{2} \backslash \Gamma\end{cases}
\label{19.127}\end{equation}

!!!!
\begin{cases}\mathscr{S}\left(\mathbf{u}_{1}^{(k+1)}, p_{1}^{(k+1)}\right)=\mathbf{f} & \text { in } \Omega_{1} \\ \mathbf{u}_{1}^{(k+1)}=\theta \mathbf{u}_{2}^{(k+1)}+(1-\theta) \mathbf{u}_{1}^{(k)} & \text { on } \Gamma \\ \mathbf{u}_{1}^{(k+1)}=\mathbf{0} & \text { on } \partial \Omega_{1} \backslash \Gamma\end{cases}
\label{19.128}\label{19.128}\end{equation}



如果原问题的边界条件是在速度场上规定的，例如$\mathbf{u}=\mathbf{0}$，那么压力$p$将只定义到一个加法常数，这可以通过例如施加约束$\int_{\Omega} p d \Omega=0$来固定。

为了满足这一约束，我们可以按如下步骤进行。在子域$\Omega_{2}$上求解Neumann问题\ref{19.127}时，速度$\mathbf{u}_{2}^{(k+1)}$和压力$p_{2}^{(k+1)}$都是统一确定的。当求解$\Omega_{1}$上的Dirichlet问题(19.128)时，压力只定义为一个加法常数；我们通过施加附加方程来固定它

!!!!
\int_{\Omega_{1}} p_{1}^{(k+1)} d \Omega_{1}=-\int_{\Omega_{2}} p_{2}^{(k+1)} d \Omega_{2}
$$

如果四个序列$\left\{\mathbf{u}_{1}^{(k)}\right\},\left\{\mathbf{u}_{2}^{(k)}\right\},\left\{p_{1}^{(k)}\right\}$和$\left\{p_{2}^{(k)}\right\}$收敛，压力的空平均条件就会自动得到验证。

例19.6.假设施瓦兹迭代法用于图19.1左图的重叠子域分解上。在每一步，我们必须解决两个Stokes方程的Dirichlet问题。


!!!!
\begin{cases}\mathscr{S}\left(\mathbf{u}_{1}^{(k+1)}, p_{1}^{(k+1)}\right)=\mathbf{f} & \text { in } \Omega_{1} \\ \mathbf{u}_{1}^{(k+1)}=\mathbf{u}_{2}^{(k)} & \text { on } \Gamma_{1} \\ \mathbf{u}_{1}^{(k+1)}=0 & \text { on } \partial \Omega_{1} \backslash \Gamma_{1}\end{cases}
\label{19.129}\end{equation}



!!!!
\begin{cases}\mathscr{S}\left(\mathbf{u}_{2}^{(k+1)}, p_{2}^{(k+1)}\right)=\mathbf{f} & \text { in } \Omega_{2} \\ \mathbf{u}_{2}^{(k+1)}=\mathbf{u}_{1}^{(k+1)} & \text { on } \Gamma_{2} \\ \mathbf{u}_{2}^{(k+1)}=0 & \text { on } \partial \Omega_{2} \backslash \Gamma_{2}\end{cases}
\label{19.130}\end{equation}


在子域边界的压力场不需要连续性。

在整个域$\Omega$上对流体速度的约束是无发散的，这需要特别注意。事实上，在解决了\ref{19.129}之后，我们在$\Omega_{1}$中有$\operatorname{div} \mathbf{u}_{1}^{(k+1)}=0$，因此，由于格林公式。

!!!!
\int_{\partial \Omega_{1}} \mathbf{u}_{1}^{(k+1)} \cdot \mathbf{n} d \gamma=0
$$

这种关系意味着$\mathbf{u}_{2}^{(k)}$中\ref{19.129}_{2}$的类似关系；实际上

!!!!
0=\int_{\partial \Omega_{1}} \mathbf{u}_{1}^{(k+1)} \cdot \mathbf{n} d \gamma=\int_{\Gamma_{1}} \mathbf{u}_{1}^{(k+1)} \cdot \mathbf{n} d \gamma=\int_{\Gamma_{1}} \mathbf{u}_{2}^{(k)} \cdot \mathbf{n} d \gamma
\label{19.131}\end{equation}

在第一次迭代时，我们可以选择$\mathbf{u}_{2}^{(0)}$，使其满足兼容性条件\ref{19.131}，然而在随后的迭代过程中，这种控制会先验地消失。出于同样的原因，\ref{19.130}的解产生了兼容性条件

!!!!
\int_{\Gamma_{2}} \mathbf{u}_{1}^{(k+1)} \cdot \mathbf{n} d \gamma=0
\label{19.132}\end{equation}

幸运的是，施瓦兹方法自动保证了这个条件的成立。事实上，在$\Gamma_{12}=\Omega_{1} \cap \Omega_{2}$中，我们有$\operatorname{divu}_{1}^{(k+1)}=0$，而且在$\Gamma_{12} \backslash\left(\Gamma_{1} \cup \Gamma_{2}\right), \mathbf{u}_{1}^{(k+1)}=\mathbf{0}$上，因为给定了同质的迪里希特边界条件。因此


!!!!
0=\int_{\partial \Gamma_{12}} \mathbf{u}_{1}^{(k+1)} \cdot \mathbf{n} d \gamma=\int_{\Gamma_{1}} \mathbf{u}_{1}^{(k+1)} \cdot \mathbf{n} d \gamma+\int_{\Gamma_{2}} \mathbf{u}_{1}^{(k+1)} \cdot \mathbf{n} d \gamma
$$

由于\ref{19.131}，右侧的第一个积分消失，因此\ref{19.132}得到满足。


表19.7.几种微分算子的界面连续性条件；D代表Dirichlet条件，$\mathrm{N}$ 代表Neumann条件

![](https://cdn.mathpix.com/snip/images/VLtCYbN1fiqu_FG7a9dBUAYtUB_jaqd2zAtV7ie4BwU.original.fullsize.png)
![](https://cdn.mathpix.com/snip/images/A09vdWQBeDRzYnnSWlukEMo79rF1xXrOIHw0EClR6UU.original.fullsize.png)


 


\subsection{ 练习}

1.考虑一维平流-传输-反应问题

!!!!
\begin{cases}-\left(\alpha u_{x}\right)_{x}+(\beta u)_{x}+\gamma u=f & \text { in } \Omega=(a, b) \\ u(a)=0, \quad \alpha u_{x}(b)-\beta u(b)=g\end{cases}
\label{19.133}\end{equation}

与$\alpha$和$\gamma \in \mathrm{L}^{\infty}(a, b), \beta \in \mathrm{W}^{1, \infty}(a, b)$和$f \in L^{2}(a, b)$ 。

a) 在两个重叠区间$\Omega_{1}=\left(a, \gamma_{2}\right)$和$\Omega_{2}=\left(\gamma_{1}, b\right)$上写出加法施瓦茨迭代法，然后写出乘法，其中$a<\gamma_{1}<\gamma_{2}<!!!!b$ 。

b) 将这些方法解释为解决给定微分问题的合适的Richardson算法。

c) 如果我们用有限元方法近似(19.133)，请写出相应的加性施瓦兹预处理，包括和不包括粗网格部分。然后提供两种情况下预处理矩阵的条件数的估计。

2.考虑一维扩散-传输-反应问题

!!!!
\begin{cases}-\left(\alpha u_{x}\right)_{x}+(\beta u)_{x}+\delta u=f & \text { in } \Omega=(a, b) \\ \alpha u_{x}(a)-\beta u(a)=g, \quad u_{x}(b)=0\end{cases}
\label{19.134}\end{equation}

与$\alpha$和$\gamma \in \mathrm{L}^{\infty}(a, b), \alpha(x) \geq \alpha_{0}>0, \beta \in \mathrm{W}^{1, \infty}(a, b), f \in L^{2}(a, b)$和$g$一个特定的实数。

a) 考虑$\Omega, \Omega_{1}=(a, \gamma)$和$\Omega_{2}=(\gamma, b)$的两个不相连的子域，其中 $a<\gamma<b$ 。用Steklov-Poincaré算子来表述问题\ref{19.134}，包括微分和变分形式。从与问题\ref{19.134}相关的双线性形式开始，分析该算子的特性。

b) 对问题\ref{19.134}应用迪里希-诺曼方法，使用在a点引入的相同的域分区。

c) 在有限元逼近的情况下，推导出舒尔补充矩阵的Dirichlet-Neumann先决条件的表达。

3.考虑一维泊松问题

!!!!
\begin{cases}-u_{x x}(x)=f(x) & \text { in } \Omega=(0,1) \\ u(0)=0, \quad u_{x}(1)=0, & \end{cases}
\label{19.135}\end{equation}

与 $f \in L^{2}(\Omega)$ 。

a) 如果$\mathscr{T}_{h}$表示区间$\Omega$的一个分区，步长为$h$，写出问题\ref{19.135}的Galerkinfinite element近似。

b) 现在考虑将$\Omega$划分为$\Omega_{1}=(0, \gamma)$和$\Omega_{2}=(\gamma, 1)$两个子区间，将$0<\gamma<1$作为分区$\mathscr{T}_{h}$的节点（见图19.18）。写出相对于这个子域分区的Galerkin-finite element刚度矩阵的代数块状形式。

c) 推导出与b)点的DD公式相对应的离散Steklov-Poincaré界面方程。哪个是舒尔补数的维度？

d) 现在考虑两个重叠的子域$\Omega_{1}=\left(0, \gamma_{2}\right)$和$\Omega_{2}=\left(\gamma_{1}, 1\right)$，其中$0<\gamma_{1}<\gamma_{2}<1$，重叠部分被简化为分区$\mathscr{T}_{h}$的单一有限元（见图19.19）。提供加法施瓦茨迭代法的代数表述。

e) 提供两级加法Shwarz预处理的一般表达式，通过假设只与两个元素相关的粗略矩阵$A_{H}$，如图19.20所示。

4.考虑扩散-传输-反应问题

!!!!
\begin{cases}L u=-\nabla \cdot(\alpha \nabla u)+\nabla \cdot(\boldsymbol{\beta} u)+\gamma u=f & \text { in } \Omega=(0,2) \times(0,1) \\ u=0 & \text { on } \Gamma_{D} \\ \alpha \frac{\partial u}{\partial n}+\delta u=0 & \text { on } \Gamma_{R}\end{cases}
\label{19.136}\end{equation}

其中$\alpha=\alpha(\mathbf{x}), \boldsymbol{\beta}=\boldsymbol{\beta}(\mathbf{x}), \gamma=\gamma(\mathbf{x}), \delta=\delta(\mathbf{x})$和$f=f(\mathbf{x})$为给定函数，$\partial \Omega=\bar{\Gamma}_{D} \cup \bar{\Gamma}_{R}$ ，$\Gamma_{D} \cap \Gamma_{R}=\emptyset$为给定函数。

让\ref{19.136}中的$\Omega$被划分为两个不相连的子域$\Omega_{1}=(0,1) \times(0,1)$和$\Omega_{2}=(1,2) \times(0,1)$ 。

a) 用Steklov-Poincaré算子来表述问题\ref{19.136}，包括微分和变量形式。

b) 对问题\ref{19.136}采用之前介绍的同样的分解方法，应用迪里希勒-努曼方法。

c) 在\ref{19.136}中设定$\mathrm{b}$和$\Gamma_{R}=\emptyset$后，证明在点$\mathrm{b}$处的Dirichlet-Neumann方法与合适的预处理Richardson算子之间的等效性。对Neumann-Neumann方法做同样的处理。

5.考虑二维扩散-传输-反应问题

!!!!
\begin{cases}L u=-\nabla \cdot(\mu \nabla u)+b \cdot \nabla u+\sigma u=f & \text { in } \Omega=(a, c) \times(d, e) \\ u=0 & \text { on } \partial \Omega .\end{cases}
\label{19.137}\end{equation}

考虑由重叠子域$\Omega_{3}=(a, f) \times!!!!(d, e)$和$\Omega_{4}=(g, c) \times(d, e)$组成的$\Omega$的分解，其中有$g<f$。在这样的分解上，为问题\ref{19.137}写出施瓦茨方法的乘法和加法版本。

图19.18. 区间$\mathscr{T}_{h}$的子域分区$(0,1)$ 。

![](https://cdn.mathpix.com/cropped/991f5db518e324d299c1ff4972bba9fb-227.jpg?height=96&width=327&top_left_y=115&top_left_x=293)

图19.19.区间$(0,1)$的重叠分解

![](https://cdn.mathpix.com/cropped/991f5db518e324d299c1ff4972bba9fb-227.jpg?height=170&width=364&top_left_y=274&top_left_x=273)

图19.20.用于构建矩阵$A_{H}$和与节点$\gamma$相关的拉格朗日特征函数的由两个宏观元素组成的粗网格分区。

然后将这些方法解释为合适的预设条件的理查德森迭代算法。最后，评论一下这些方法的收敛特性。


\section{Reduced basis approximation for parametrized partial differential equations}

精简基础（RB）方法是用于快速和可靠评估输入-输出关系的计算精简技术：输出表示为参数化偏微分方程（PDE）解决方案的函数，输入为参数集。

参数化的PDEs可以模拟几个与应用相关的过程，例如，稳定和非稳定的热量和质量传递、声学、固体和流体力学，也包括电磁学甚至金融。输入参数向量可以描述几何配置，或一些物理特性，或边界条件和源条款。感兴趣的输出可能是最大的系统温度、附加质量系数、裂纹应力强度系数、有效的构成属性、声波导引的传输损耗、或通道流速或压力下降，仅举几例。最后，连接输入参数和输出的场变量可以代表分布函数、温度或浓度、位移、压力或速度等。

RB近似的目标是通过提高计算性能和(ii)控制减阶解和全阶解（参数化的PDE）之间的近似误差来捕捉系统的输入/输出行为的基本特征$(i)$。特别是，我们的目标是用少量的自由度来近似PDE的解，而不是全阶近似所需要的许多自由度（数千，或数百万，有时甚至数十亿）。事实上，计算缩减策略的核心思想是假设（经常被验证），即系统的行为可以被少量的主导模式很好地描述。

这样一来，我们只需要通过计算要求较高的离线阶段解决少数输入实例的全阶问题，以构建一个基解的缩减空间。这使得在一个非常便宜的在线阶段对新的输入实例进行许多低成本的减序模拟成为可能，方法是将减序解表达为基础解的线性组合，并利用Galerkin投影到这个减序空间。

RB方法并不取代Galerkin方法（或任何其他适合近似PDEs的方法）。相反，它们建立在一个给定的近似方法之上，例如有限元方法（FEM）：RB解决方案不是直接近似精确的解决方案，而是一个（通常）非常大的维度$N_{h}$的 "给定 "的有限元离散化。

特别是，我们将在这一章中考虑仿生参数化线性椭圆胁迫PDEs的线性函数输出情况。这类问题相对简单，但与许多重要的应用相关，如传导和对流-扩散、线性弹性等。- 这类问题被证明是该方法的一个方便的说明工具，它可以被应用于更多的一般方程，直到适当的扩展。我们请对线性抛物线PDEs感兴趣的读者参考[QRM11]中的评论，比如说。

虽然我们的重点是仿生线性椭圆胁迫情况，但我们在本章讨论的减基近似和后验误差估计是更普遍的，它们的结合是减法技术在计算上成功的关键因素。我们还指出，尽管现在计算机能力的提高使得大尺寸问题的数值解决和/或复杂现象的建模变得非常重要，但只要对实时模拟和/或对某些感兴趣的输入的不同值的重复输出评估感兴趣，计算上的减少仍然是关键。典型的情况是，例如，实时可视化，PDE解决方案对参数的敏感性分析，或在PDE约束下的优化问题（如第18章中讨论的最优控制问题）。

我们在下面概述了本章的内容。在第1节。  $20.1$我们介绍了在所谓顺应问题的情况下的仿线性椭圆胁迫设置；最相关的参数化例子将在第20.9节中讨论。在第20.9节中，将讨论最相关的参数化例子。  $20.2$我们说明了几种计算还原方法所共有的一些基本成分。然后，我们在第20.3节中描述了参数化问题的减基方法的主要特征：减少的空间、Galerkin投影和确保计算效率的离线/在线程序。此外，我们在第20.4节中提供了  $20.4$提供了减基近似问题的代数和几何解释。我们在第1节中讨论了  $20.5$构建快照（即基函数）和缩减空间的最流行策略：贪婪算法（$\mathrm{RB}$参数化PDEs方法的核心）和适当正交分解，POD。在这一节中，我们可以看到  $20.6$中，我们概述了一些与先验收敛理论相关的想法，而在$20.7$中，我们则概述了与先验收敛理论相关的想法。  $20.7$我们为RB逼近提出了严格的、相对尖锐的后验输出误差界限。在第20.8节中，我们将RB近似和后验误差界线扩展到不符合要求的问题上。我们在第20.10节中讨论了一个简单的数字测试案例，并对更多的一般问题类别进行了简要的概述。

\subsection{Elliptic coercive parametric PDEs}

在介绍计算还原的主要特征之前，让我们描述一下我们在整个章节中处理的一类问题；更多的细节将在第20.9节给出。我们用$\mathscr{D} \subset \mathbb{R}^{p}$表示，对于一个整数$p \geq 1$，一组输入参数，可以描述系统的物理特性，以及边界项、源项或计算域的几何形状。我们关注的问题可以写成以下形式。

给定$\mu \in \mathscr{D}$，评估感兴趣的输出$s(\mu)=J(u(\mu))$，其中$u(\mu) \in V=!!!!V(\Omega)$是以下参数化PDE的解。

!!!!
L(\mu) u(\mu)=F(\mu)
\label{20.1}\end{equation}

这里$\Omega \subset \mathbb{R}^{d}, d=1,2,3$是一个规则域，$V$是一个合适的希尔伯特空间，$V^{\prime}$是其对偶，$L(\mu): V \rightarrow V^{\prime}$是一个二阶微分算子和$F(\mu) \in V^{\prime}$ 。问题\ref{20.1}的弱表述为：找到$u(\mu) \in V=V(\Omega)$，使得

!!!!
a(u(\mu), v ; \mu)=f(v ; \mu) \quad \forall v \in V,
\label{20.2}\end{equation}

其中双线性形式 $^{1}$ 由 $L(\mu)$ 得到。

!!!!
a(u, v ; \mu)={v^{\prime}}\langle L(\mu) u, v\rangle_{V} \quad \forall u, v \in V,
\label{20.3}\end{equation}

而

!!!!
f(v ; \mu)={ }_{V^{\prime}}\langle F(\mu), v\rangle_{V}
!!!!
\label{20.4}\end{equation}

是一个连续的线性形式。我们假设，对于每个$\mu \in \mathscr{D}, a(\cdot, \cdot ; \mu)$都是连续的和强制的，即$\exists \bar{\gamma}<+\infty, \alpha_{0}>0$ 。

!!!!
\gamma(\mu)=\sup _{u \in V} \sup _{v \in V} \frac{a(u, v ; \mu)}{\|u\|_{V}\|v\|_{V}}<\bar{\gamma}, \quad \alpha(\mu)=\inf _{u \in V} \frac{a(u, u ; \mu)}{\|u\|_{V}^{2}} \geq \alpha_{0}
\label{20.5}\end{equation}

如果不满足coercivity假设，我们就有由inf-sup条件保证的更一般意义上的稳定性。  $J$（输出函数）是$V$上的一个线性和有界形式。在这些标准假设下，$a$和$f,(20.2)$有一个唯一的解决方案，这是由于Lax-Milgram法则。我们将专门考虑二阶椭圆偏微分方程，在这种情况下$V=H_{\Gamma_{D}}^{1}(\Omega)-$见$(3.26)$ 。此外，我们假设$a$是对称的，$J=f$ 。后者只是一个简化的假设，它意味着我们处于所谓的顺应情况[PR07]，这种情况在工程问题中经常出现（见第20.1.1节）。在非顺应情况下，$a$可能是非对称的，$J$可能是$V$上的任何有界线性函数，对非顺应情况的概括将在第20节提供。  $20.8$ .

${ }^{1}$ 为了严谨起见，我们应该引入里兹识别算子$R: V^{\prime} \rightarrow V$，通过它来识别$V$和它的对偶，这样，给定一个第三希尔伯特空间$H$，使$V \hookrightarrow H^{\prime}$和$H^{\prime} \hookrightarrow V^{\prime}, V^{\prime}\langle L(\mu) u, v\rangle_{V}=(R L(\mu) u, v)_{H} ;$也见2.1节。然而，为了简单起见，我们将省略雷兹算子。我们做了最后一个假设，对提高计算效率至关重要：我们要求参数化双线性形式$a$和参数化线性形式$f$相对于参数$\mu$都是仿射的，也就是说。

!!!!
a(w, v ; \mu)=\sum_{q=1}^{Q_{a}} \Theta_{a}^{q}(\mu) a^{q}(w, v) \quad \forall v, w \in V, \mu \in \mathscr{D} 
\label{20.6}\end{equation}

!!!!
f(v ; \mu)=\sum_{q=1}^{Q_{f}} \Theta_{f}^{q}(\mu) f^{q}(w) \quad \forall w \in V, \mu \in \mathscr{D}
\label{20.7}\end{equation}

这里$\Theta_{a}^{q}: \mathscr{D} \rightarrow \mathbb{R}, q=1, \ldots, Q_{a}$和$\Theta_{f}^{q}: \mathscr{D} \rightarrow \mathbb{R}, q=1, \ldots, Q_{f}$，是$\mu$的相关函数，而$a^{q}: V \times V \rightarrow \mathbb{R}, f^{q^{\prime}}: V \rightarrow \mathbb{R}$是$\mu$的独立函数。作为一般原则，与参数无关的条款将被离线计算，从而使在线计算变得更轻。

让我们也注意到，由于$a$是对称的，我们可以为$V$的元素定义能量内积和能量准则如下。

!!!!
(w, v)_{\mu} &=a(w, v ; \mu) & \forall w, v \in V, 
\label{20.8}\end{equation}

!!!!
\|w\|_{\mu} &=(w, w)_{\mu}^{1 / 2} & \forall w \in V .
\label{20.9}\end{equation}

接下来，对于给定的$\bar{\mu} \in \mathscr{D}$和非负实数$\tau

!!!!
(w, v)_{V} &=(w, v)_{\mu}+\tau(w, v)_{L^{2}(\Omega)} & & \forall w, v \in V 
\label{20.10}\end{equation}


!!!!
\|w\|_{V} &=(w, w)_{V}^{1 / 2} & \forall w \in V
\label{20.11}\end{equation}

将分别定义我们的$V$上的内积和规范。这个标量积的作用将在第20.5节中明确。

\subsubsection{Two simple examples}

在描述几种计算还原方法所共有的主要特征之前，我们提供两个简单的参数化问题的例子，它们符合本章提出的框架和方法。更多的例子，以及满足RB方法关键假设的物理和/或几何参数化的一般表述，将在后面的第20.9节讨论。

我们可能想到的最简单的椭圆胁迫参数化问题是一个泊松问题，定义在一个域$\Omega$上，模拟例如污染物的扩散/反应。这里$u=u(\mu)$表示污染物浓度，扩散系数$\mu$起着输入参数的作用；感兴趣的输出是域上浓度的平均值。

!!!!
s(\mu)=\int_{\Omega} u(\mu) d \Omega .
$$

考虑$\partial \Omega$上的同质诺伊曼边界条件，域$\Omega$上的单位源项，以及集$V=H^{1}(\Omega)$。我们通过定义来恢复\ref{20.2}的抽象表述

!!!!
a(w, v ; \mu)=\mu \int_{\Omega} \nabla w \cdot \nabla v d \Omega+\int_{\Omega} w v d \Omega, \quad f(v ; \mu)=\int_{\Omega} v d \Omega
\label{20.12}\end{equation}

这个问题是强制性的、对称性的、合规的。在这种情况下，我们处理$p=1$参数，编码一个物理属性；$f$不依赖于$\mu$，而$a$在$\mu ;$中是仿生的，我们有$Q_{a}=2, Q_{f}=1, \Theta_{a}^{1}(\mu)=\mu, \Theta_{a}^{2}(\mu)=\Theta_{f}^{1}(\mu)=1$，并且

!!!!
a^{1}(w, v)=\int_{\Omega} \nabla w \cdot \nabla v d \Omega, \quad a^{2}(w, v)=\int_{\Omega} w v d \Omega, \quad f^{1}(v)=\int_{\Omega} v d \Omega
$$

一个稍微复杂的案例，仍然只处理物理参数，由一个方形域$\Omega$中的热传导问题给出，该域由$B_{1} \times B_{2}$块组成，每个块代表一个具有（先验不同的）恒定热导率的子区域；图20.1中描述了几何形状。这里

!!!!
\bar{\Omega}=\bigcup_{i=1}^{P+1} \overline{\mathscr{R}}_{i}
$$

其中$\mathscr{R}_{i}, i=1 \ldots, P+1$,对应于具有电导率等于$\mu_{i}>0$的子区域。在$\Gamma_{\text {base }}$上施加非均质诺伊曼（非零流量）边界条件，在$\Gamma_{\text {top }}$上施加均质迪里切特（温度）条件，在两个垂直方向上施加均质（零流量）诺伊曼条件。所关注的输出是$\Gamma_{\text {base }}$上的平均温度。

参数$\mu=\left(\mu_{1}, \ldots, \mu_{P}\right)$是前$P=B_{1} B_{2}-$1个块的电导率（块的编号如图20.1所示）；最后一个块的电导率是1，用于归一化。通过设置$V=\left\{v \in H^{1}(\Omega)|v|_{\Gamma_{\text {top }}}=0\right\}$，我们恢复了抽象的公式\ref{20.2），其中有

!!!!
a(w, v ; \mu)=\sum_{i=1}^{P} \mu_{i} \int_{\mathscr{R}_{i}} \nabla w \cdot \nabla v d \Omega+\int_{\mathscr{R}_{P+1}} \nabla w \cdot \nabla v d \Omega
\label{20.13}\end{equation}

![](https://cdn.mathpix.com/cropped/991f5db518e324d299c1ff4972bba9fb-232.jpg?height=319&width=317&top_left_y=880&top_left_x=295)

图20.1.$B_{1}=B_{2}=3$的热阻问题，该问题与拉普拉斯算子相关，具有同质诺伊曼条件（以及内部通量连续性条件），并且

!!!!
f(v ; \mu)=\int_{\Gamma_{\text {base }}} v d \Gamma
\label{20.14}\end{equation}

其中施加了不均匀的诺伊曼条件，并得到了平均温度。此外，$F$与$\mu$无关。\ref{20.13}对参数的依赖是仿生的；通过直接检查，我们注意到$Q_{a}=P+1, Q_{f}=1, \Theta_{a}^{q}(\mu)=\mu_{q}, 1 \leq q \leq P$、$\Theta_{a}^{P+1}=1, \Theta_{f}^{1}(\mu)=1$和

!!!!
a^{q}(w, v)=\int_{\mathscr{R}_{q}} \nabla w \cdot \nabla v d \Omega, \quad 1 \leq q \leq P+1, \quad f^{1}(v)=\int_{\Gamma_{\text {base }}} v d \Gamma
$$

\subsection{Main components of computational reduction techniques}

通过计算还原技术（CRT），我们表示依赖于问题的方法，其目的是减少由给定的PDE问题离散化产生的代数系统的维度，例如 \ref{20.2}。

缩减后的解是通过投射到一个由全局基函数构成的小子空间获得的，该子空间是为手头的具体问题而构建的，而不是投射到一个大的通用基函数空间（无论是局部的，如有限元还是全局的，如频谱方法）。

为了突出CRT的基本特征，在本节中，我们依赖于PDE问题的强形式\ref{20.1）。事实上，我们将要介绍的CRT可以建立在全书描述的任何离散化技术之上，而不一定是基于PDE问题的弱形式。

参数化PDE问题的计算还原技术的目标是以一种廉价的方式计算PDE解的低维近似值。最常见的选择，如适当的正交分解（POD）或（贪婪的）减基（RB）方法，通过投射到合适的低维子空间来寻求减解 $^{2}$ 。计算性还原技术的基本组成可以描述如下。

- 高保真离散技术：如前所述，CRT不是为了取代高保真（有时被称为真理）离散方法（例如通过任何种类的Galerkin方法获得）。

在问题\ref{20.1）的情况下，真实的、高保真的近似可以用以下紧凑的方式表示：给定$\mu \in \mathscr{D}$，评估$s_{h}(\mu)=f\left(u_{h}(\mu)\right)$，其中$u_{h}(\mu) \in V^{N_{h}}$是使

!!!!
L_{h}(\mu) u_{h}(\mu)=F_{h}(\mu)
\label{20.15}\end{equation}

${ }^{2}$ 事实上，一些CRT，如POD，最初是为了加速解决复杂的时间依赖性问题，如模拟湍流的问题，而不是专门为参数化问题设计的（否则说，时间被认为是唯一的参数）。这里$V^{N_{h}} \subset V$是一个维度很大的有限维空间$N_{h}, L_{h}(\mu)$一个合适的离散算子和$F_{h}(\mu)$一个给定项。回顾一下，遵从意味着$J=f$ 。

例如，假设真值近似是基于以下Galerkin高保真近似问题\ref{20.2}:$找到$u_{h}(\mu) \in V^{N_{h}}$，从而

!!!!
a\left(u_{h}(\mu), v_{h} ; \mu\right)=f\left(v_{h} ; \mu\right) \quad \forall v_{h} \in V^{N_{h}} .
\label{20.16}\end{equation}

此外，让我们介绍一下对偶空间之间的注入算子$Q_{h}: V^{N_{h}} \rightarrow V$，以及它的副算子$Q_{h}^{\prime}: V^{\prime} \rightarrow\left(V^{N_{h}}\right)^{\prime}$。Galerkin问题\ref{20.15} 读作

!!!!
Q_{h}^{\prime}\left(L(\mu) Q_{h} u_{h}(\mu)-F(\mu)\right)=0
\label{20.17}\end{equation}

这对应于\ref{20.15}，在定义了

!!!!
L_{h}(\mu)=Q_{h}^{\prime} L(\mu) Q_{h}, \quad F_{h}(\mu)=Q_{h}^{\prime} F(\mu)
\label{20.18}\end{equation}

请注意，$\left(L_{h}(\mu)\right)^{-1}=\Pi_{h}(L(\mu))^{-1} \Pi_{h}^{\prime}$ ，其中$\Pi_{h}: V \rightarrow V^{N_{h}}$是$L^{2}$的投影算子，$\Pi_{h}^{\prime}:\left(V^{N_{h}}\right)^{\prime} \rightarrow V^{\prime}$是其邻接算子。从我们对$a, f$和$V^{N_{h}}$的假设可以直接看出，\ref{20.16} 有一个唯一的解。让我们假设

!!!!
\left\|u(\mu)-u_{h}(\mu)\right\|_{V} \leq \mathscr{E}(h) \quad \forall \mu \in \mathscr{D},
\label{20.19}\end{equation}

$\mathscr{E}(h)$是对离散化误差的估计，通过选择合适的离散化空间，可以使其变得尽可能小。此外，我们定义了矫顽力和连续性常数（与子空间$\left.V^{N_{h}}\right)$有关）为

!!!!
\alpha^{N_{h}}(\mu)=\inf _{w \in V^{N_{h}}} \frac{a(w, w ; \mu)}{\|w\|_{V}^{2}}, \quad \gamma^{N_{h}}(\mu)=\sup _{w \in V^{N_{h}}} \sup _{v \in V^{N_{h}}} \frac{a(w, v ; \mu)}{\|w\|_{V}\|v\|_{V}}
\label{20.20}\end{equation}

分别。根据\ref{20.5}，从$a$的连续性和矫捷性可以看出

!!!!
\alpha^{N_{h}}(\mu) \geq \alpha(\mu), \quad \gamma^{N_{h}}(\mu) \leq \gamma(\mu) \quad \forall \mu \in \mathscr{D}
$$

- Galerkin）投影：CRT通常包括选择少数高保真PDE解$\left\{u_{h}\left(\mu^{i}\right)\right\}_{i=1}^{N}$的缩减基础（称为快照），并寻求表示为这些基础函数的线性组合的缩减近似$u_{N}(\mu)$。这个组合的系数是通过方程在缩减空间的投影来确定的

!!!!
V_{N}=\operatorname{span}\left\{u_{h}\left(\mu^{i}\right), i=1, \ldots, N\right\}
$$

与$N=\operatorname{dim}\left(V_{N}\right) \ll N_{h}$。因此，减少的问题是：给定$\mu \in \mathscr{D}$，评估$s_{N}(\mu)=f\left(u_{N}(\mu)\right)$，其中$u_{N}(\mu) \in V_{N}$解决了

!!!!
a\left(u_{N}(\mu), v_{N} ; \mu\right)=f\left(v_{N} ; \mu\right) \quad \forall v_{N} \in V_{N}
\label{20.21}\end{equation}

$N$越小，减少的问题就越容易解决。我们注意到，对于给定的$\mathrm{RB}$，我们的$N_{h}$场和RB输出近似于高保真解$u_{h}(\mu)$和输出$s_{h}(\mu)$（因此，间接地，$u(\mu)$和$\left.s(\mu)\right)$ 。

如前所述，我们可以借助合适的运算符将\ref{20.21}解释为

!!!!
L_{N}(\mu) u_{N}(\mu)=F_{N}(\mu)
\label{20.22}\end{equation}

事实上，让我们引入注入算子$Q_{N}: V_{N} \rightarrow V^{N_{h}}$，及其在对偶空间之间操作的副算子$Q_{N}^{\prime}$ : $\left(V^{N_{h}}\right)^{\prime} \rightarrow V_{N}^{\prime}$。那么，由于

!!!!
Q_{N}^{\prime}\left(L_{h}(\mu) Q_{N} u_{N}(\mu)-F_{h}(\mu)\right)=0
\label{20.23}\end{equation}

我们可以从\ref{20.23} 中得到\ref{20.22}，通过确定

!!!!
L_{N}(\mu)=Q_{N}^{\prime} L_{h}(\mu) Q_{N}
$$

!!!!
F_{N}(\mu)=Q_{N}^{\prime} F_{h}(\mu)
\label{20.24}\end{equation}

与之前的做法类似，这里$\left(L_{N}(\mu)\right)^{-1}=\Pi_{N}\left(L_{h}(\mu)\right)^{-1} \Pi_{N}^{\prime}$ ，其中$\Pi_{N}: V^{N_{h}} \rightarrow V_{N}$ 是$L^{2}$ -投影算子，$\Pi_{N}^{\prime}: V_{N}^{\prime} \rightarrow\left(V^{N_{h}}\right)^{\prime}$ 。

- 离线/在线程序：在适当的假设下（见第20.3.3节），快照数据库的大量生成可以在离线时进行一次，并与随后的每个新的输入输出在线查询完全脱钩。显然，在联机阶段，目标是解决在离线阶段没有选择的参数实例$\mu \in \mathscr{D}$的减少问题。此外，昂贵的离线计算必须在在线阶段摊销$-$，在RB背景下，通常通过$\mathscr{O}\left(10^{2}\right)$在线查询达到收支平衡点。

- 误差估计程序：尖锐的、廉价的界限$\Delta_{N}(\mu)$，以便于

!!!!
\left\|u_{h}(\mu)-u_{N}(\mu)\right\|_{V} \leq \Delta_{N}(\mu) \quad \forall \mu \in \mathscr{D}, N=1, \ldots, N_{\max }
\label{20.25}\end{equation}

可能有[PR07]，以及输出误差界限$\Delta_{N}^{s}(\mu)$，以便

!!!!
\left|s_{h}(\mu)-s_{N}(\mu)\right| \leq \Delta_{N}^{s}(\mu)
$$

正如我们将在第20.5.1节中看到的那样，这些误差估计器也可能被用来在构建还原空间的过程中产生一个聪明的参数采样。它们在椭圆胁迫问题中的构造将在第20节中详细描述。  $20.7$ .

通过将\ref{20.19} 和\ref{20.25} 放在一起，我们最终得到，对于所有的$\mu \in \mathscr{D}$，误差约束

!!!!
\left\|u(\mu)-u_{N}(\mu)\right\|_{V} \leq\left\|u(\mu)-u_{h}(\mu)\right\|_{V}+\left\|u_{h}(\mu)-u_{N}(\mu)\right\|_{V} \leq \mathscr{E}(h)+\Delta_{N}(\mu)
$$

在下一节中，我们将进一步提供关于减基近似的构造细节，这也是本章的主要目标。

\subsection{The reduced basis method}

我们现在具体说明在第1节中提出的一般特征。  $20.2$中介绍的减基方法的一般特征。简而言之，减基（RB）离散化是Galerkin（有时是彼得罗夫-Galerkin）在$N$-维近似空间$V_{N}$上的投影，该空间近似流形

!!!!
\mathscr{M}_{h}=\left\{u_{h}(\mu) \in V^{N_{h}}: \mu \in \mathscr{D}\right\}
\label{20.26}\end{equation}

由输入在整个参数域中变化时产生的场集给出 $\mathscr{D}$ 。我们假设这个流形是足够平滑的；在单一参数的情况下，参数诱导的流形是无限维空间内的一个一维丝线，该空间表征了对给定 $\mathrm{PDE}$ 的所有可能解。我们在图中描述了保留的快照 $20.2$ 。

如果流形确实是低维和平滑的（这一点我们将在后面讨论），我们希望流形的任何一点$-$对$\mu$中的某些$\mathscr{D}$的任何解$u_{h}(\mu)$都能用相对较少的保留快照来近似。然而，我们必须确保我们不仅可以最佳地选择我们的保留快照（见第$20.5$节），而且可以$(i)$选择可用的保留快照的良好组合，$(i i)$在稳定的减基中表示保留快照，以及（iii）有效获得相关的基系数。这三点将在下一节讨论。

![](https://cdn.mathpix.com/cropped/991f5db518e324d299c1ff4972bba9fb-236.jpg?height=338&width=607&top_left_y=784&top_left_x=153)

图20.2."快照"$u_{h}\left(\mu^{n}\right), 1 \leq n \leq N$，在参数流形$\mathscr{M}_{h}$上。

\subsubsection{RB Spaces}

我们将注意力限制在由代表$\mathrm{PDE}^{3}$的高保真解的快照产生的还原空间，并回顾了椭圆情况下RB近似的构造，也是从代数的角度。给定一个正整数$N_{\max }$，我们定义一个RB空间$V_{N}^{R B}, 1 \leq N \leq N_{\max }$的（分层）序列，使得每个$V_{N}^{R B}$是$N$的一个$V^{N_{h}}$维子空间。我们进一步假设

!!!!
V_{1}^{R B} \subset V_{2}^{R B} \subset \cdots V_{N_{\max }}^{R B} \subset V^{N_{h}}
\label{20.27}\end{equation}

正如我们将看到的，嵌套或层次条件\ref{20.27}对于确保所产生的RB近似的内存效率很重要。

为了定义一个（分层的）空间序列$V_{N}^{R B}, 1 \leq N \leq N_{\max }$，我们首先介绍，对于给定的$N \in\left\{1, \ldots, N_{\max }\right\}$，一个样本

!!!!
S_{N}=\left\{\mu^{1}, \ldots, \mu^{N}\right\}
\label{20.28}\end{equation}

的参数点$\mu^{n} \in \mathscr{D}, 1 \leq n \leq N$，要进行适当的选择（例如通过第20.5.1节将介绍的贪婪程序）。这将产生相应的快照$u_{h}\left(\mu^{n}\right) \in V^{N_{h}}$ 。因此，相关的贪婪-RB空间由以下内容给出

!!!!
V_{N}^{R B}=\operatorname{span}\left\{u_{h}\left(\mu^{n}\right), 1 \leq n \leq N\right\}
\label{20.29}\end{equation}

在本节的其余部分，为了便于记述，上标${ }^{R B}$将经常被省略。我们观察到，根据结构，空间$V_{N}$满足\ref{20.27}-$，即RB空间\ref{20.29} 是分层的--而样本\ref{20.28}是嵌套的，即$S_{1}=\left\{\mu^{1}\right\} \subset S_{2}=!!!!\left\{\mu^{1}, \mu^{2}\right\} \subset \cdots \subset S_{N_{\max }}

\subsubsection{Galerkin projection}

对于我们这类特殊的方程，Galerkin投影是一个自然的选择。因此，给定$\mu \in \mathscr{D}$，我们评估$s_{N}(\mu)=J\left(u_{N}(\mu)\right)$，其中$u_{N}(\mu) \in V_{N} \subset V^{N_{h}}$是这样的

!!!!
a\left(u_{N}(\mu), v_{N} ; \mu\right)=f\left(v_{N} ; \mu\right) \quad \forall v_{N} \in V_{N} .
\label{20.30}\end{equation}

从现在开始，问题\ref{20.30} 将被称为给定问题\ref{20.2）的Galerkin Reduced Basis（G-RB）近似。通过比较\ref{20.16}和\ref{20.30}，我们立即得到以下属性

!!!!
a\left(u_{h}(\mu)-u_{N}(\mu), v_{N} ; \mu\right)=0 \quad \forall v_{N} \in V_{N}
\label{20.31}\end{equation}

这是还原问题的Galerkin正交特性（见第四章）。

${ }^{3}$ 这是构建还原子空间的最常见方法，也被称为拉格朗日RB空间。其他已知的方法是基于泰勒[Por85]和赫米特[IR98]空间。此外，我们从(20.31)和Céa's lemma得到--见Section.  $4.2$--能量准则中的经典最优结果\ref{20.9} 。

!!!!
\left\|u_{h}(\mu)-u_{N}(\mu)\right\| \mu \leq \inf _{w \in V_{N}}\left\|u_{h}(\mu)-w\right\| \mu
\label{20.32}\end{equation}

换句话说，在能量准则中，Galerkin程序会自动选择快照的最佳组合。同样明显的是

!!!!
s_{h}(\mu)-s_{N}(\mu)=\left\|u_{h}(\mu)-u_{N}(\mu)\right\|_{\mu}^{2},
\label{20.33}\end{equation}

即输出收敛为能量误差的 "平方"。事实上，利用顺应性假设，我们可以写出

!!!!
\begin{aligned}
s_{h}(\mu) &-s_{N}(\mu)=a\left(u_{h}(\mu), u_{h}(\mu) ; \mu\right)-a\left(u_{N}(\mu), u_{N}(\mu) ; \mu\right) \\
&=a\left(u_{h}(\mu), u_{h}(\mu)-u_{N}(\mu) ; \mu\right)+a\left(u_{h}(\mu), u_{N}(\mu) ; \mu\right)-a\left(u_{N}(\mu), u_{N}(\mu) ; \mu\right) \\
&=a\left(u_{h}(\mu)-u_{N}(\mu), u_{h}(\mu)-u_{N}(\mu) ; \mu\right)+a\left(u_{h}(\mu)-u_{N}(\mu), u_{N}(\mu) ; \mu\right)
\end{aligned}
$$

其中最后一行的第二项由于\ref{20.31} 而消失。虽然这个结果主要取决于顺应性假设，但通过邻接近似法对非顺应性情况的概括是可能的；见第$20.8$节。  $20.8$ .

让我们注意到，如果选择$V$准则\ref{20.11} 而不是\ref{20.32}，我们将发现

!!!!
\left\|u_{h}(\mu)-u_{N}(\mu)\right\|_{V} \leq\left(\frac{\bar{\gamma}}{\alpha_{0}}\right)^{1 / 2} \inf _{w \in V_{N}}\left\|u_{h}(\mu)-w\right\|_{V}
\label{20.34}\end{equation}

$\bar{\gamma}$和$\alpha_{0}$是在\ref{20.5} 中定义的统一连续性和矫顽力常数。

我们现在考虑与Galerkin近似相关的离散方程 \ref{20.30} 。我们必须首先为我们的空间选择一个合适的基；注意，对RB基的不明智的选择会导致条件非常差的系统。此外，如果$V_{N}$提供快速收敛，那么随着$N$的增加，\ref{20.29}的快照将越来越共线，这是结构上的问题。为了避免这种情况（并产生一个独立的快照集），我们在$(\cdot, \cdot)_{V}$的内积中对快照$u_{h}\left(\mu^{n}\right), 1 \leq n \leq N_{\max }$应用Gram-Schmidt过程[Mey00, TI97]，得到相互正交的函数$\zeta_{n}, 1 \leq n \leq N_{\max }:\left(\zeta_{n}, \zeta_{m}\right)_{V}=\delta_{n m}, 1 \leq n, m \leq N_{\max }$，其中$\delta_{n m}$是Kronecker△符号。然后我们选择$\left\{\zeta_{n}\right\}_{n=1, \ldots, N}$作为$V_{N}, 1 \leq N \leq N_{\max }$的基础。

我们现在插入

!!!!
u_{N}(\mu)=\sum_{m=1}^{N} u_{N}^{(m)}(\mu) \zeta_{m}
\label{20.35}\end{equation}

然后$v_{N}=\zeta_{n}, 1 \leq n \leq N$，进入\ref{20.30}，得到RB代数系统

!!!!
\sum_{m=1}^{N} a\left(\zeta_{m}, \zeta_{n} ; \mu\right) u_{N}^{(m)}(\mu)=f\left(\zeta_{n} ; \mu\right)
\label{20.36}\end{equation}

为RB系数 $u_{N}^{(m)}(\mu), 1 \leq m, n \leq N$ 。我们随后可以评估$\mathrm{RB}$的输出预测为

!!!!
s_{N}(\mu)=\sum_{m=1}^{N} u_{N}^{(m)}(\mu) f\left(\zeta_{m} ; \mu\right)
\label{20.37}\end{equation}

通过使用瑞利商，如\ref{4.51}所解释的，我们可以证明，由于$\left\{\zeta_{n}\right\}$和\ref{20.5}的正交性，矩阵$a\left(\zeta_{m}, \zeta_{n} ; \mu\right), 1 \leq n, m \leq N$的条件数由$\gamma(\mu) / \alpha(\mu)$约束，独立于$N$和$N_{h}$；进一步细节见例如[PR07] 。为了简单起见，从现在开始我们考虑$f$不依赖于参数$\mu$的情况。

\subsubsection{Offline-Online computational procedure}

系统\ref{20.36} 名义上是小规模的，但是它涉及到实体$\zeta_{n}, 1 \leq n \leq N$，与我们的$N_{h}$维高保真近似空间相关。如果我们不得不调用高保真场，以便为每个$\mu$的新值形成RB刚度矩阵，那么每次输入-输出评估的边际成本$\mu \rightarrow s_{N}(\mu)$将仍然大得令人无法接受。幸运的是，仿生参数依赖的关键假设将导致计算速度的大幅提高。特别是，由于\ref{20.6} ，系统\ref{20.36} 可以被表达为

!!!!
\sum_{m=1}^{N}\left(\sum_{q=1}^{Q_{a}} \Theta_{a}^{q}(\mu) \mathbb{A}_{N}^{q}\right) \mathbf{u}_{N}(\mu)=\mathbf{f}_{N}
\label{20.38}\end{equation}

而\ref{20.37}的内容是

!!!!
s_{N}(\mu)=\mathbf{f}_{N} \cdot \mathbf{u}_{N}(\mu)
\label{20.39}\end{equation}

其中$\left(\mathbf{u}_{N}(\mu)\right)_{m}=u_{N}^{(m)}(\mu),\left(\mathbb{A}_{N}^{q}\right)_{m n}=a^{q}\left(\zeta_{n}, \zeta_{m}\right),\left(\mathbf{f}_{N}\right)_{n}=f\left(\zeta_{n}\right)$ ，为$1 \leq m, n \leq N$ 。

因此，计算需要一个昂贵的 $\mu$ 独立的离线阶段，只执行一次，而对于任何选定的参数值，则需要一个便宜的在线阶段 $\mu \in \mathscr{D}$ 。

- 在离线阶段，我们首先计算$u_{h}\left(\mu^{n}\right)$，然后通过GramSchmidt正交化计算$\zeta_{n}$，$1 \leq n \leq N_{\max } ;$然后我们形成并存储条款

!!!!
f\left(\zeta_{n}\right), \quad 1 \leq n \leq N_{\max} 
\label{20.40}\end{equation}


!!!!
a^{q}\left(\zeta_{n}, \zeta_{m}\right), \quad 1 \leq n, m \leq N_{\max }, 1 \leq q \leq Q_{a}
\label{20.41}\end{equation}

脱机操作数取决于 $N_{\max }, Q_{a}$ ，以及 $N_{h}$ 。

- 在在线阶段，我们检索了\ref{20.41}，以形成

!!!!
\sum_{q=1}^{Q_{a}} \Theta_{a}^{q}(\mu) a^{q}\left(\zeta_{n}, \zeta_{m}\right), \quad 1 \leq n, m \leq N
\label{20.42}\end{equation}

我们解决所产生的 $N \times N$ 刚度系统 \ref{20.38} 以获得 $u_{N}^{(m)}(\mu)$ ， $1 \leq m \leq N ;$ 最后，我们访问 \ref{20.40} 以评估输出 \ref{20.37} 。在线操作计数为 $O\left(Q_{a} N^{2}\right)$ 执行和 \ref{20.42}, O\left(N^{3}\right)$ 反转 \ref{20.38} 注意RB刚度矩阵是满的 - 最后 $O(N)$ 评估内积 \ref{20.37} 。在线存储（离线阶段存档的数据）只有$O\left(Q_{a} N_{\max }^{2}\right)+O\left(N_{\max }\right)$，因为层次条件\ref{20.27}：对于任何给定的$N$，我们提取必要的$N \times N$RB矩阵（或者$N$-向量）作为相应$N_{\max } \times N_{\max }\left(\right.$或者$\left.N_{\max }\right)$数量的主子矩阵（或者次子矩阵）。

因此，评估$\mu \rightarrow s_{N}(\mu)$的在线成本（操作数和存储）与$N_{h}$无关。其结果有两个方面：首先，如果$N$确实很小，我们将在实时和多查询的情况下实现非常快的响应；其次，我们可以选择$N_{h}$足够大，以确保误差$\left\|u(\mu)-u_{h}(\mu)\right\|_{V}$非常小，而不影响在线边际成本。

\subsection{Algebraic and geometric interpretations of the RB problem}

现在我们从代数和几何的角度讨论Galerkin Reduced Basis(G-RB)近似(20.30)和Galerkin高保真近似(20.16)之间的关系。

让我们用$\mathbf{u}_{h}(\mu) \in \mathbb{R}^{N_{h}}$和$\mathbf{u}_{N}(\mu) \in \mathbb{R}^{N}$表示与函数$u_{h}(\mu) \in V^{N_{h}}$和$u_{N}(\mu) \in V_{N}$相关的自由度向量，它们分别由以下公式给出

!!!!
\mathbf{u}_{h}(\mu)=\left(u_{h}^{(1)}(\mu), \ldots, u_{h}^{\left(N_{h}\right)}(\mu)\right)^{T}, \quad \mathbf{u}_{N}(\mu)=\left(u_{N}^{(1)}(\mu), \ldots, u_{N}^{(N)}(\mu)\right)^{T}
$$

让$\left\{\tilde{\varphi}^{r}\right\}_{r=1}^{N_{h}}$表示标准的FE基，相对于离散标量乘积而言是正交的。

!!!!
\left(u_{h}, v_{h}\right)_{h}=\sum_{r=1}^{N_{h}} w_{r} u_{h}\left(\mathbf{x}_{r}\right) v_{h}\left(\mathbf{x}_{r}\right)
$$

$\left\{\mathbf{x}_{r}\right\}_{r=1}^{N_{h}}$是$\mathrm{FE}$节点的集合，这样$\tilde{\varphi}^{r}\left(\mathbf{x}_{s}\right)=\delta_{r s}$和$\left\{w_{r}\right\}_{r=1}^{N_{h}}$是权重的集合，这样$\sum_{r=1}^{N_{h}} w_{r}=|\Omega|$ ，对于$r, s=1, \ldots, N_{h} ;$注意，可以对标量积进行其他选择。通过定义将这些基函数归一化是很有用的

!!!!
\varphi^{r}=\frac{1}{\sqrt{w_{r}}} \tilde{\varphi}^{r}, \quad\left(\varphi^{r}, \varphi^{s}\right)_{h}=\delta_{r s}, \quad r, s=1, \ldots, N_{h}
\label{20.43}\end{equation}

正如我们在第$4-$章看到的关系\ref{4.7}--我们可以考虑空间$\mathbb{R}^{N_{h}}$和$V^{N_{h}}$之间的以下双射。

!!!!
\left\{\begin{array}{l}
\mathbf{v}_{h} \in \mathbb{R}^{N_{h}} \leftrightarrow v_{h} \in V^{N_{h}} \\
\mathbf{v}_{h}=\left(v_{h}^{(1)}, \ldots, v_{h}^{\left(N_{h}\right)}\right)^{T} \leftrightarrow v_{h}(\mathbf{x})=\sum_{r=1}^{N_{h}} v_{h}^{(r)} \varphi^{r}(\mathbf{x})
\end{array}\right.
\label{20.44}\end{equation}

为了便于记述，我们将把\ref{20.44}的双射关系表达如下。  $\mathbf{v}_{h} \in \mathbb{R}^{N_{h}} \rightarrow$ $I_{h} \mathbf{v}_{h}=v_{h} \in V_{h}, I_{h}^{T} v_{h}=\mathbf{v}_{h}$ 。同样地，对于减基近似，我们使用符号$\mathbf{v}_{N} \in \mathbb{R}^{N} \rightarrow I_{N} \mathbf{v}_{N}=v_{N} \in V_{N}, I_{N}^{T} v_{N}=\mathbf{v}_{N}$ 。由于基函数的正则性，$v_{h}^{(r)}=\left(v_{h}, \varphi^{r}\right)_{h}, \quad r=1, \ldots, N_{h}$ 。

使用双射\ref{20.44} ，以下代数关系成立。

!!!!
\left.\left(\mathbf{u}_{h}, \mathbf{v}_{h}\right)_{2}=\left(u_{h}, v_{h}\right)_{h} \quad \forall \mathbf{u}_{h}, \mathbf{v}_{h} \in \mathbb{R}^{N_{h}} \text { (equivalently, } \forall u_{h}, v_{h} \in V^{N_{h}}\right) .
\label{20.45}\end{equation}

的确如此。

!!!!
\begin{aligned}
\left(u_{h}, v_{h}\right)_{h} &=\left(\sum_{r=1}^{N_{h}} u_{h}^{(r)} \varphi^{r}, \sum_{s=1}^{N_{h}} v_{h}^{(s)} \varphi^{s}\right)_{h} \\
&=\sum_{r, s=1}^{N_{h}} u_{h}^{(r)} v_{h}^{(s)}\left(\varphi^{r}, \varphi^{s}\right)_{h}=\sum_{r, s=1}^{N_{h}} u_{h}^{(r)} v_{h}^{(r)}=\left(\mathbf{u}_{h}, \mathbf{v}_{h}\right)_{2}
\end{aligned}
$$

\subsubsection{Algebraic interpretation of the (G-RB) problem}

我们首先讨论(G-RB)问题(20.30)和Galerkin高保真近似(20.16)之间的代数联系，这对与RB方法有关的计算方面有很大影响。

在矩阵形式中，（G-RB）问题\ref{20.36} 可以写成

!!!!
\mathbb{A}_{N}(\mu) \mathbf{u}_{N}(\mu)=\mathbf{f}_{N}
\label{20.46}\end{equation}

与$\mathbf{f}_{N}=\left(f_{N}^{(1)}, \ldots, f_{N}^{(N)}\right)^{T}, f_{N}^{(k)}=f\left(\zeta_{k}\right),\left(\mathbb{A}_{N}(\mu)\right)_{k m}=a\left(\zeta_{m}, \zeta_{k} ; \mu\right)$ ，对于$k, m=$ $1, \ldots, N$ 。另一方面，Galerkin高保真近似\ref{20.16} 的矩阵形式为

!!!!
\mathbb{A}_{h}(\mu) \mathbf{u}_{h}(\mu)=\mathbf{f}_{h}
\label{20.47}\end{equation}

与 $\mathbf{f}_{h}=\left(f_{h}^{(1)}, \ldots, f_{h}^{\left(N_{h}\right)}\right)^{T}, f_{h}^{(r)}=f\left(\varphi^{r}\right),\left(\mathbb{A}_{h}(\mu)\right)_{r s}=a\left(\varphi^{s}, \varphi^{r} ; \mu\right)$ ，为 $r, s=$ $1, \ldots, N_{h}$ 。

为了符号的缘故，我们在本节的其余部分省略了对$\mu$的依赖。

让$\mathbb{V} \in \mathbb{R}^{N_{h} \times N}$为变换矩阵，其条目为

!!!!
(\mathbb{V})_{r k}=\left(\zeta_{k}, \varphi^{r}\right)_{h}, \quad r=1, \ldots, N_{h}, k=1, \ldots, N
\label{20.48}\end{equation}

利用这个矩阵，我们可以很容易地得到以下代数特性。

!!!!
\mathbf{f}_{N}=\mathbb{V}^{T} \mathbf{f}_{h}, \quad \mathbb{A}_{N}=\mathbb{V}^{T} \mathbb{A}_{h} \mathbb{V}
\label{20.49}\end{equation}

它们代表了算子特性的代数对应物\ref{20.24}（见图20.3）。的确如此。

!!!!
\begin{aligned}
\left(\mathbb{V}^{T} \mathbb{A}_{h} \mathbb{V}\right)_{k m} &=\sum_{r, s=1}^{N_{h}}(\mathbb{V})_{k r}^{T}\left(\mathbb{A}_{h}\right)_{r s}(\mathbb{V})_{s m}=\sum_{r, s=1}^{N_{h}}\left(\zeta_{k}, \varphi^{r}\right)_{h} a\left(\varphi^{s}, \varphi^{r}\right)\left(\zeta_{m}, \varphi^{s}\right)_{h} \\
&=a\left(\sum_{s=1}^{N_{h}}\left(\zeta_{m}, \varphi^{s}\right)_{h} \varphi^{s}, \sum_{r=1}^{N_{h}}\left(\zeta_{k}, \varphi^{r}\right)_{h} \varphi^{r}\right)=a\left(\zeta_{m}, \zeta_{k}\right)=\left(\mathbb{A}_{N}\right)_{k m}
\end{aligned}
$$



![](https://cdn.mathpix.com/cropped/991f5db518e324d299c1ff4972bba9fb-242.jpg?height=157&width=439&top_left_y=112&top_left_x=238)

图20.3.如何组装RB "刚度" 矩阵的示意图

而且，以同样的方式。

!!!!
\begin{aligned}
\left(\mathbb{V}^{T} \mathbf{f}_{h}\right)^{(k)} &=\sum_{r=1}^{N_{h}}(\mathbb{V})_{k r}^{T}\left(\mathbf{f}_{h}\right)^{(r)}=\sum_{r=1}^{N_{h}}\left(\zeta_{k}, \varphi^{r}\right)_{h} f\left(\varphi^{r}\right) \\
&=f\left(\sum_{r=1}^{N_{h}}\left(\zeta_{k}, \varphi^{r}\right)_{h} \varphi^{r}\right)=f\left(\zeta_{k}\right)=\left(\mathbf{f}_{N}\right)_{k} .
\end{aligned}
\label{20.50}\end{equation}

由于\ref{20.49}，每个$\mu$独立的$\mathrm{RB}$"刚度 "矩阵$\mathbb{A}_{N}^{q}$一旦被计算出相应的高保真 "刚度 "矩阵$\mathbb{A}_{h}^{q}$，就可以被组装起来。

(G-RB)问题的解决方案和Galerkin高保真近似值之间的（矢量表示）误差是

!!!!
\mathbf{e}_{N}=\mathbf{u}_{h}-\mathbb{V} \mathbf{u}_{N}
\label{20.51}\end{equation}

同样地，（G-RB）解决方案的高保真残差的（矢量表示）为

!!!!
\mathbf{r}_{h}\left(\mathbf{u}_{N}\right)=\mathbf{f}_{h}-\mathbb{A}_{h} \mathbb{V} \mathbf{u}_{N}
\label{20.52}\end{equation}

下面的定理提供了$(\mathrm{G}-\mathrm{RB})$问题和Galerkin高保真近似之间的主要代数联系:

Lemma 20.1. The following algebraic relations hold:

!!!!
\mathbb{A}_{h} \mathbf{e}_{N}=\mathbf{r}_{h}\left(\mathbf{u}_{N}\right)
\label{20.53}\end{equation}

!!!!
\mathbb{V}^{T} \mathbb{A}_{h} \mathbf{u}_{h}=\mathbf{f}_{N}
\label{20.54}\end{equation}

!!!!
\mathbb{V}^{T} \mathbf{r}_{h}\left(\mathbf{u}_{N}\right)=\mathbf{0}
\label{20.55}\end{equation}

$\mathbf{e}_{N}$ and $\mathbf{r}_{h}\left(\mathbf{u}_{N}\right)$ being defined by \ref{20.51} and \ref{20.52}, respectively.


证明。方程\ref{20.53} 直接来自于\ref{20.51} 和\ref{20.47}。

通过\ref{20.47}左乘以$\mathbb{V}^{T}$，我们立即得到\ref{20.54}，感谢\ref{20.49} 。

最后，\ref{20.55}由\ref{20.52}得出，使用相同的\ref{20.49}和问题\ref{20.46}。请注意，条件\ref{20.53}是Galerkin正交特性\ref{20.31}的代数对应，对（G-RB）问题有效。

总之，对于一个给定的矩阵$\mathbb{V}$的减基，Galerkin减基（G-RB）问题\ref{20.46} 可以正式得到如下:


Galerkin Reduced Basis (G-RB) problem
1. consider the Galerkin high-fidelity problem \ref{20.47};
2. set $\mathbf{u}_{h}=\mathbb{V} \mathbf{u}_{N}+\mathbf{e}_{N}$, where $\mathbf{u}_{N} \in \mathbb{R}^{N}$ has to be determined and the error $\mathbf{e}_{N}$ is the difference between $\mathbf{u}_{h}$ and $\mathbb{V} \mathbf{u}_{N}$
3. left multiply \ref{20.47} by $\mathbb{V}^{T}$ to obtain $\mathbb{A}_{N} \mathbf{u}_{N}-\mathbf{f}_{N}=-\mathbb{V}^{T} \mathbb{A}_{h} \mathbf{e}_{N}$, that is
!!!!
\mathbb{A}_{N} \mathbf{u}_{N}-\mathbf{f}_{N}=-\mathbb{V}^{T} \mathbf{r}_{h}\left(\mathbf{u}_{N}\right)
$$
4. require $\mathbf{u}_{N}$ to satisfy $\mathbb{V}^{T} \mathbf{r}_{h}\left(\mathbf{u}_{N}\right)=\mathbf{0}$, or equivalently
!!!!
\mathbb{A}_{N} \mathbf{u}_{N}=\mathbf{f}_{N}
$$


如果$\mathbb{A}_{h}$是对称和正定的，那么G-RB解满足以下残差最小化属性。

!!!!
\mathbf{u}_{N}=\arg \min _{\tilde{\mathbf{u}}_{N} \in \mathbb{R}^{N}}\left\|\mathbf{r}_{h}\left(\tilde{\mathbf{u}}_{N}\right)\right\|_{\mathbb{A}_{h}^{-1}}^{2}
\label{20.56}\end{equation}

事实上，通过用$\mathbb{K}^{1 / 2}$表示一个（对称和正定）矩阵$\mathbb{K}$的平方根，我们有

!!!!
\begin{aligned}
\left\|\mathbf{r}_{h}\left(\tilde{\mathbf{u}}_{N}\right)\right\|_{\mathbb{A}_{h}^{-1}}^{2} &=\left(\mathbf{f}_{h}-\mathbb{A}_{h} \mathbb{V} \mathbf{u}_{N}, \mathbf{f}_{h}-\mathbb{A}_{h} \mathbb{V} \mathbf{u}_{N}\right)_{\mathbb{A}_{h}^{-1}}=\\
&=\left(\mathbb{A}_{h}^{-1 / 2} \mathbf{f}_{h}-\mathbb{A}_{h}^{1 / 2} \mathbb{V} \mathbf{u}_{N}, \mathbb{A}_{h}^{-1 / 2} \mathbf{f}_{h}-\mathbb{A}_{h}^{1 / 2} \mathbb{V} \mathbf{u}_{N}\right)
\end{aligned}
$$

这可以被视为系统$\mathbb{A}_{h}^{1/2} \mathbb{V} \mathbf{u}_{N}=\mathbb{A}_{h}^{-1 / 2} \mathbf{f}_{h}$的最小二乘解，其对应的法线方程${ }^{4}$为

!!!!
\mathbb{V}^{T} \mathbb{A}_{h}^{1 / 2} \mathbb{A}_{h}^{1 / 2} \mathbb{V} \mathbf{u}_{N}=\mathbb{V}^{T} \mathbb{A}_{h}^{1 / 2} \mathbb{A}_{h}^{-1 / 2} \mathbf{f}_{h}=\mathbb{V}^{T} \mathbf{f}_{h}
$$

请注意，后者与（G-RB）问题\ref{20.46} 相吻合。

\subsubsection{Geometric interpretation of the (G-RB) problem}

我们还可以从几何学的角度来描述通过解决（G-RB）问题得到的RB近似，以及（G-RB）问题的解决和Galerkin高保真近似之间的误差$\mathbf{e}_{N}=\mathbf{u}_{h}-\mathbb{V} \mathbf{u}_{N}$。



为此，我们利用这样一个事实：由\ref{20.48}定义的变换矩阵$\mathbb{V}$确定了由矩阵$\mathbb{V}$的列向量生成的$\mathbf{V}_{N}=\operatorname{span}\left\{\mathbf{v}_{1}, \ldots, \mathbf{v}_{N}\right\}$的缩小子空间上的正交投影。那么$\operatorname{dim}\left(\mathbf{V}_{N}\right)=N$因为$\mathbb{V}$的列的线性独立性。

假设基函数$\left\{\zeta_{k}\right\}_{k=1, \ldots, N}$相对于标量积$(\cdot, \cdot)_{h}$是正态的，即

!!!!
\left(\zeta_{k}, \zeta_{m}\right)_{h}=\sum_{j=1}^{N_{h}} w_{j} \zeta_{k}\left(x_{j}\right) \zeta_{m}\left(x_{j}\right)=\delta_{k m}
\label{20.57}\end{equation}

那么

!!!!
\mathbb{V}^{T} \mathbb{V} \in \mathbb{R}^{N \times N}, \quad \mathbb{V}^{T} \mathbb{V}=\mathbb{I}_{N}
\label{20.58}\end{equation}

其中$\mathbb{I}_{N}$表示维度为$N$的身份矩阵。

作为一个事实

!!!!
\left(\mathbb{V}^{T} \mathbb{V}\right)_{m k}=\left(\zeta_{m}, \zeta_{k}\right)_{h} \quad \forall k, m=1, \ldots, N
\label{20.59}\end{equation}

Lemma 20.2. The following results hold:
1. The matrix $\boldsymbol{\Pi}=\mathbb{V} \mathbf{V}^{T} \in \mathbb{R}^{N_{h} \times N_{h}}$ is a projection matrix from the whole space $\mathbb{R}^{N_{h}}$ onto the subspace $\mathbf{V}_{N}$
2. The matrix $\mathbb{I}_{N_{h}}-\boldsymbol{\Pi}=\mathbb{I}_{N_{h}}-\mathbb{V} \mathbb{V}^{T} \in \mathbb{R}^{N_{h} \times N_{h}}$ is a projection matrix from the whole space $\mathbb{R}^{N_{h}}$ onto the space $\mathbf{V}_{N}^{\perp}$, which is the subspace of $\mathbb{R}^{N_{h}}$ orthogonal to $\mathbf{V}_{N}$
3. The residual $\mathbf{r}_{h}\left(\mathbf{u}_{N}\right)$ satisfies
!!!!
\boldsymbol{\Pi} \mathbf{r}_{h}\left(\mathbf{u}_{N}\right)=\mathbf{0}
\label{20.60}\end{equation}
that is, it belongs to the orthogonal space $\mathbf{V}_{N}^{\perp}$.



证明。属性1是正则属性\ref{20.58} 的直接结果。事实上。

!!!!
\forall \mathbf{w}_{N} \in \mathbf{V}_{N} \text { there exists } \mathbf{v}_{N} \in \mathbb{R}^{N} \text { s.t. } \mathbf{w}_{N}=\mathbb{V} \mathbf{v}_{N} .
$$

然后，$\forall \mathbf{v}_{h} \in \mathbb{R}^{N_{h}}, \forall \mathbf{w}_{N} \in \mathbf{V}_{N}

!!!!
\left(\boldsymbol{\Pi} \mathbf{v}_{h}, \mathbf{w}_{N}\right)_{2}=\left(\boldsymbol{\Pi} \mathbf{v}_{h}, \mathbb{V} \mathbf{v}_{N}\right)_{2}=\left(\mathbb{V}^{T} \mathbf{v}_{h}, \mathbb{V}^{T} \mathbb{V} \mathbf{v}_{N}\right)_{2}=\left(\mathbf{v}_{h}, \mathbb{V} \mathbf{v}_{N}\right)_{2}=\left(\mathbf{v}_{h}, \mathbf{w}_{N}\right)_{2}
$$

属性2由属性1得出。最后，\ref{20.60}由\ref{20.55} 得出。

如果我们假设基是正交的，那么误差$\mathbf{e}_{N}=\mathbf{u}_{h}-\mathbb{V} \mathbf{u}_{N}$可以被分解成两个正交项。

!!!!
\begin{aligned}
\mathbf{e}_{N} &=\mathbf{u}_{h}-\mathbb{V} \mathbf{u}_{N}=\left(\mathbf{u}_{h}-\Pi \mathbf{u}_{h}\right)+\left(\Pi \mathbf{u}_{h}-\mathbb{V} \mathbf{u}_{N}\right) \\
&=\left(\mathbb{I}_{N_{h}}-\Pi\right) \mathbf{u}_{h}+\mathbb{V}\left(\mathbb{V}^{T} \mathbf{u}_{h}-\mathbf{u}_{N}\right)=\mathbf{e}_{\mathbf{V}_{N}^{\perp}}+\mathbf{e}_{\mathbf{V}_{N}}
\end{aligned}
$$



![](https://cdn.mathpix.com/cropped/991f5db518e324d299c1ff4972bba9fb-245.jpg?height=306&width=436&top_left_y=116&top_left_x=240)

图20.4.$\mathbf{V}_{N}$的子空间$\mathbb{R}^{N_{h}}$以及向量$\mathbf{u}_{N} \in \mathbb{R}^{N}, \mathbb{V} \mathbf{u}_{N} \in \mathbf{V}_{N}$和$\mathbf{u}_{h} \in \mathbb{R}^{N_{h}}$。

第一个项，与$\mathbf{V}_{N}$正交，说明高保真解决方案并不严格属于缩小的子空间$\mathbf{V}_{N}$，而第二个项，与$\mathbf{V}_{N}$平行，说明解决的问题与原始问题（略有不同）；见图$20.4$ 。

我们注意到，这个结果\ref{20.58}来自于减基函数$h$的正交性的属性\ref{20.57}。实际上，正交可以通过不同的标量积来完成，我们一般表示为$(\cdot, \cdot)_{N}$ ，即

!!!!
\left(\zeta_{k}, \zeta_{m}\right)_{N}=\delta_{k m} \quad \forall k, m=1, \ldots, N
$$

在这种情况下，代替\ref{20.59}我们有

!!!!
\delta_{k m}=\left(\zeta_{k}, \zeta_{m}\right)_{N}=\sum_{r=1}^{N_{h}} \sum_{s=1}^{N_{h}}\left(\mathbb{V}_{r k} \varphi^{r}, \mathbb{V}_{s m} \varphi^{s}\right)_{N}=\sum_{r=1}^{N_{h}} \sum_{s=1}^{N_{h}} \mathbb{V}_{m s} \mathbb{M}_{s r} \mathbb{V}_{r k}
$$

其中我们使用了\ref{20.48} 并定义了$(\cdot, \cdot)_{N}$的质量矩阵为

!!!!
\mathbb{M}_{s r}=\left(\varphi^{r}, \varphi^{s}\right)_{N}, \quad 1 \leq r, s \leq N
$$

因此，代替\ref{20.58} ，我们得到新的正交关系

!!!!
\mathbb{Y}^{T} \mathbb{Y}=\mathbb{V}^{T} \mathbb{M} \mathbb{V}=\mathbb{I}_{N}
$$

其中$\mathbb{Y}^{T}=\mathbb{V}^{T} \mathbb{M}^{1 / 2}, \mathbb{Y}=\mathbb{M}^{1 / 2} \mathbb{V}$ 。以同样的方式，投影矩阵为 $\Pi=$ $\mathbb{Y} \mathbb{Y}^{T}$ 。只要用$\mathbb{Y}$替换矩阵$\mathbb{V}$，用$\mathbf{Y}_{N}=\mathbb{Y} \mathbf{V}_{N}$替换子空间$\mathbf{V}_{N}$，上面证明的结果1 .和2.仍将成立。

\subsubsection{Alternative formulations: Least-Squares and Petrov-Galerkin RB problems}

导致迄今为止所讨论的(G-RB)问题的Galerkin投影是建立减序方法的最常见的策略，因为在常数范围内，它可以得到关于能量准则的最佳近似值。在这种情况下，试验空间（即我们寻求解决方案的空间）和测试空间是相同的；从代数的角度来看，这反映在(20.49)中，我们对高保真刚度矩阵进行前乘和后乘的矩阵是相同的。然而，试验和测试空间可以以不同的方式选择，产生了我们所说的Petrov-Galerkin公式。在这一节中，我们提供一些关于这种方法的想法。

\textbf{The Least Squares Reduced Basis method}

(G-RB)的另一种方法是所谓的最小二乘法(LSRB)--有时也称为最小残差法，其中(LS-RB)解满足

!!!!
\mathbf{u}_{N}=\arg \min _{\tilde{\mathbf{u}}_{N} \in \mathbb{R}^{N}}\left\|\mathbf{r}_{h}\left(\tilde{\mathbf{u}}_{N}\right)\right\|_{2}^{2}
\label{20.61}\end{equation}

请注意，最小化准则\ref{20.61} 适用于任何矩阵$\mathbb{A}_{h}$，而\ref{20.56} ，即（G-RB）方法的特点，要求$\mathbb{A}_{h}$是对称和正定的。\ref{20.61}的解与法线方程的解相吻合

!!!!
\left(\mathbb{A}_{h} \mathbb{V}\right)^{T} \mathbb{A}_{h} \mathbb{V} \mathbf{u}_{N}=\left(\mathbb{A}_{h} \mathbb{V}\right)^{T} \mathbf{f}_{h}
$$

就是说

!!!!
\left(\mathbb{A}_{h} \mathbb{V}\right)^{T} \mathbf{r}_{h}\left(\mathbf{u}_{N}\right)=\mathbf{0}
\label{20.62}\end{equation}

对于一个给定的矩阵$\mathbb{V}$，因此可以得到最小二乘法（最小残差）RB问题如下:

Least Squares Reduced Basis (LS-RB) problem
1. consider the Galerkin high-fidelity problem \ref{20.47};
2. set $\mathbf{u}_{h}=\mathbb{V} \mathbf{u}_{N}+\mathbf{e}_{N}$, where $\mathbf{u}_{N} \in \mathbb{R}^{N}$ has to be determined and the error $\mathbf{e}_{N}$ is the difference between $\mathbf{u}_{h}$ and $\mathbb{V} \mathbf{u}_{N}$
3. left multiply \ref{20.47} by $\left(\mathbb{A}_{h} \mathbb{V}\right)^{T}$ to obtain
$$
\left(\mathbb{A}_{h} \mathbb{V}\right)^{T} \mathbb{A}_{h} \mathbb{V} \mathbf{u}_{N}=\left(\mathbb{A}_{h} \mathbb{V}\right)^{T} \mathbf{f}_{h}-\left(\mathbb{A}_{h} \mathbb{V}\right)^{T} \mathbf{r}_{h}\left(\mathbf{u}_{N}\right)
$$
4. require $\mathbf{u}_{N}$ to satisfy $\left(\mathbb{A}_{h} \mathbb{V}\right)^{T} \mathbf{r}_{h}\left(\mathbf{u}_{N}\right)=\mathbf{0}$, that is, equivalently,
!!!!
\left(\mathbb{A}_{h} \mathbb{V}\right)^{T} \mathbb{A}_{h} \mathbb{V} \mathbf{u}_{N}=\left(\mathbb{A}_{h} \mathbb{V}\right)^{T} \mathbf{f}_{h}
\label{20.63}\end{equation}



注意\ref{20.63} 可以改写为\ref{20.46} 的形式，只要我们设定

!!!!
\mathbf{f}_{N}=\left(\mathbb{A}_{h} \mathbb{V}\right)^{T} \mathbf{f}_{h}, \quad \mathbb{A}_{N}=\left(\mathbb{A}_{h} \mathbb{V}\right)^{T} \mathbb{A}_{h} \mathbb{V}
$$



\section{The Petrov-Galerkin Reduced Basis method}

问题\ref{20.63} 可被视为以下Petrov-Galerkin（而不是Galerkin）方法的一个特殊实例：找到$u_{N}(\mu) \in V_{N}$，以便

!!!!
a\left(u_{N}(\mu), w_{N} ; \mu\right)=f\left(w_{N} ; \mu\right) \quad \forall w_{N} \in W_{N}
\label{20.64}\end{equation}

其中$W_{N} \subset V^{N_{h}}$是一个维度为$N$的子空间，与$V_{N}$不同。如果我们用$\left\{\eta_{k}, k=1, \ldots, N\right\}$表示$W_{N}$的基础，用$\mathbb{W} \in \mathbb{R}^{N_{h} \times N}$表示矩阵，其条目为

!!!!
(\mathbb{W})_{r k}=\left(\eta_{k}, \varphi^{r}\right)_{h}, \quad r=1, \ldots, N_{h}, k=1, \ldots, N
$$

我们仍然可以用代数形式\ref{20.46} 来表达\ref{20.64} ；然而，这一次，我们不需要\ref{20.49}，而是有

!!!!
\mathbf{f}_{N}=\mathbb{W}^{T} \mathbf{f}_{h}, \quad \mathbb{A}_{N}=\mathbb{W}^{T} \mathbb{A}_{h} \mathbb{V}
\label{20.65}\end{equation}

对于两个给定的矩阵$\mathbb{V}$和$\mathbb{W}$，Petrov-Galerkin$\mathrm{RB}$（PG-RB）方法可以得到如下结果。


Petrov-Galerkin Reduced Basis (PG-RB) problem
1. consider the Galerkin high-fidelity problem (20.47);
2. set $\mathbf{u}_{h}=\mathbb{V} \mathbf{u}_{N}+\mathbf{e}_{N}$, where $\mathbf{u}_{N} \in \mathbb{R}^{N}$ has to be determined and the error $\mathbf{e}_{N}$ is the difference between $\mathbf{u}_{h}$ and $\mathbb{V} \mathbf{u}_{N}$
3. left multiply \ref{20.47} by $\mathbb{W}^{T}$ to obtain
$$
\mathbb{W}^{T} \mathbb{A}_{h} \mathbb{V} \mathbf{u}_{N}=\mathbb{W}^{T} \mathbf{f}_{h}-\mathbb{W}^{T} \mathbf{r}_{h}\left(\mathbf{u}_{N}\right)
$$
4. require $\mathbf{u}_{N}$ to satisfy $\mathbb{W}^{T} \mathbf{r}_{h}\left(\mathbf{u}_{N}\right)=\mathbf{0}$, that is, equivalently,
!!!!
\mathbb{W}^{T} \mathbb{A}_{h} \mathbb{V} \mathbf{u}_{N}=\mathbb{W}^{T} \mathbf{f}_{h}
\label{20.66}\end{equation}



正如已经预料的那样，（LS-RB）问题\ref{20.63} 是（PGRB）问题的一个特例 \ref{20.66} ，对应于选择 $\mathbb{W}=\mathbb{A}_{h} \mathbb{V}$ 。事实上，我们可以证明（见练习1）以下结果。

Property 20.1. The (LS-RB) formulation corresponds to the following problem in variational form: find $u_{N}(\mu) \in V_{N}$ such that

!!!!
\left\{\begin{array}{lc}
a\left(u_{N}(\mu), y_{h}^{\mu}\left(v_{N}\right) ; \mu\right)=f\left(y_{h}^{\mu}\left(v_{N}\right) ; \mu\right) & \forall v_{N} \in V_{N} \\
\text { where } y_{h}^{\mu}\left(v_{N}\right) \in V_{h} \text { is the solution to } & \text { the following problem : } \\
\left(y_{h}^{\mu}\left(v_{N}\right), z_{h}\right)_{h}=a\left(v_{N}, z_{h} ; \mu\right) & \forall z_{h} \in V^{N_{h}}
\end{array}\right.
\label{20.67}\end{equation}


因此，（LS-RB）方法等同于Petrov-Galerkin方法\ref{20.64} ，条件是测试空间

!!!!
W_{N}=\operatorname{span}\left\{\eta_{k}^{\mu}, k=1, \ldots, N\right\} \subset V^{N_{h}}
$$

是通过将$\eta_{k}^{\mu}=\eta_{k}^{\mu}\left(\zeta_{k}\right)$作为$\eta_{k}^{\mu}=\eta_{k}^{\mu}\left(\zeta_{k}\right)$的解来定义的。

!!!!
\left(\eta_{k}^{\mu}, z_{h}\right)_{h}=a\left(\zeta_{k}, z_{h} ; \mu\right) \quad \forall z_{h} \in V^{N_{h}}
\label{20.68}\end{equation}

备注 $20.1$ .选择\ref{20.68}是最佳的，因为(PG-RB)问题的误差等于最佳近似误差--即连续性常数与稳定性常数之比为1--只要我们赋予试验空间以合适的能量准则；感兴趣的读者可以参考，例如[DG11] 。

我们还注意到，在(LS-RB)情况下，测试空间的基函数取决于$\mu$，因为双线性形式的参数依赖性 $a(\cdot, \cdot ; \mu)$ 。在这种情况下，有几种有效的构造和正则化的选择；进一步的细节见[RHM13]。

\subsection{Construction of reduced spaces}

我们现在描述如何对参数空间进行抽样，以计算出实际形成减基的保留快照。我们首先说明一种抽样策略，即贪婪算法，它是在[PR07, RHP08]中引入的，基于在每一步选择局部最优元素的想法。接下来我们将讨论另一种程序，即所谓的适当正交分解。

\subsubsection{Greedy algorithm}

我们首先在一个抽象的环境中提出这个算法，然后通过提供一个可计算的版本来描述减基方法的情况。

贪婪算法是一个一般的程序，在希尔伯特空间$K$中，用适当选择的$K$元素的子空间来近似紧凑集$V$的每个元素。对于一个给定的$N \geq 1$，我们寻求函数$\left\{f_{1}, f_{1}, \ldots, f_{N}\right\}$，使每个$f \in K$都能被子空间$K_{N}=\operatorname{span}\left\{f_{1}, \ldots, f_{N}\right\}$的元素很好地近似。该算法可以描述如下。


!!!!
\begin{aligned}
&\mu_{1}=\arg \max _{\mu \in \mathscr{D}}\left\|u_{h}(\mu)\right\|_{V} \\
&\text { given the samples } \mu^{1}, \ldots, \mu^{N-1} \\
&\qquad \begin{aligned}
\text { consider } V_{N-1}=\operatorname{span}\left\{u_{h}\left(\mu^{1}\right), \ldots, u_{h}\left(\mu^{N-1}\right)\right\} \\
\text { construct } \mu_{N}=\arg \sup _{\mu \in \mathscr{D}}\left\|u_{h}(\mu)-\Pi_{N-1}^{\mu} u_{h}(\mu)\right\|_{V}
\end{aligned} \\
&\text { iterate until } \sup _{\mu \in \mathscr{D}}\left\|u_{h}(\mu)-\Pi_{N}^{\mu} u_{h}(\mu)\right\|_{V}<\varepsilon_{\mathrm{tol}}^{*} .
\end{aligned}
\label{20.69}\end{equation}


$\Pi_{K_{N-1}}$是相对于标量积$(\cdot, \cdot)_{V}$在$K_{N-1}$上的正交投影算子，$\varepsilon_{\mathrm{tol}}^{*}$是选择的公差；$f_{N}$被称为最坏情况元素，即在$K$上投影误差最大化的元素。在每一步，前面的算法所提供的元素通过以下Gram-Schmidt程序进行正交：我们定义

!!!!
\zeta_{1}=\frac{f_{1}}{\left\|f_{1}\right\|_{V}}, \quad \zeta_{N}=\frac{f_{N}-\Pi_{K_{N-1}} f_{N}}{\left\|f_{N}-\Pi_{K_{N-1}} f_{N}\right\|_{V}}, \quad N=2, \ldots, N_{\max }
$$

并假设当$N=N_{\max }$时，该构造结束。特别是，对于任何$f \in V$ ,

!!!!
\Pi_{K_{N}} f=\sum_{n=1}^{N} \pi_{K_{N}}^{n}(f) \zeta_{n}, \quad \text { with } \quad \pi_{K_{N}}^{n}(f)=\left(f, \zeta_{n}\right)_{V}
$$

我们对$K$是参数诱导流形\ref{20.26} 的情况感兴趣；参数选择的贪婪算法采取以下形式。

![](https://cdn.mathpix.com/cropped/991f5db518e324d299c1ff4972bba9fb-249.jpg?height=216&width=716&top_left_y=431&top_left_x=94)

这里$\Pi_{N-1}^{\mu}: V^{N_{h}} \rightarrow V_{N-1}$表示椭圆（Galerkin）对$V_{N-1}$的投射。

!!!!
a\left(\Pi_{N-1}^{\mu} u_{h}, v_{h} ; \mu\right)=a\left(u_{h}, v_{h} ; \mu\right) \quad \forall v \in V_{N-1}
$$

请注意，由于\ref{20.16}和\ref{20.21}, \Pi_{N}^{\mu} u_{h}(\mu)=u_{N}(\mu)$对所有$\mu \in \mathscr{D}$ .然后，上面生成的$\left\{u_{h}\left(\mu^{1}\right), \ldots, u_{h}\left(\mu^{N}\right)\right\}$集合相对于标量积$(\cdot, \cdot)_{V}$被正则化，产生了$V_{N}$的新正则基础$\left\{\zeta_{1} \ldots, \zeta_{N}\right\}$ 。

在Gram-Schmidt正则化过程中，我们不能使用椭圆（Galerkin）投影$\Pi_{N}^{\mu}$，因为后者取决于$\mu$；相反，我们采用正交投影$\Pi_{N}: V^{N_{h}} \rightarrow V_{N}$，相对于与$\bar{\mu}$的特定值对应的标量积$(\cdot, \cdot)_{V}$，见\ref{20.10} 。正则化过程给出了。

!!!!
\zeta_{1}=\frac{u_{h}\left(\mu^{1}\right)}{\left\|u_{h}\left(\mu^{1}\right)\right\|_{V}}, \quad \zeta_{N}=\frac{u_{h}\left(\mu^{N}\right)-\Pi_{N-1} u_{h}\left(\mu^{N}\right)}{\left\|u_{h}\left(\mu^{N}\right)-\Pi_{N-1} u_{h}\left(\mu^{N}\right)\right\|_{V}}, \quad N=2, \ldots, N_{\max }
$$

特别是。

!!!!
\Pi_{N} u_{h}(\mu)=\sum_{n=1}^{N} \pi_{N}^{n}(\mu) \zeta_{n}, \quad \text { with } \quad \pi_{N}^{n}(\mu)=\left(u_{h}(\mu), \zeta_{n}\right)_{V}
$$

在计算上，贪婪算法\ref{20.69} 相当昂贵：在每一步，寻求最佳快照需要解决一个优化问题，其中近似误差$\left\|u_{h}(\mu)-\Pi_{N-1}^{\mu} u_{h}(\mu)\right\|_{V}$的评估需要对高保真解$u_{h}(\mu)$进行许多昂贵的评估。在实践中，通过用一个非常精细的样本$^{5} \Xi_{\text {train }} \subset \mathscr{D}$代替$\mathscr{D}$的超值，来减轻这一成本，该样本的cardinality为$\left|\Xi_{\text {train }}\right|=n_{\text {train }}$，用于选择我们的RB空间--或训练我们的RB近似值。但这仍然需要解决几个高保真的近似问题。

然后采用进一步的简化，包括用一个廉价的后验误差估计器$\Delta_{N-1}(\mu)$代替近似误差，这样

!!!!
\left\|u_{h}(\mu)-\Pi_{N-1}^{\mu} u_{h}(\mu)\right\|_{V} \leq \Delta_{N-1}(\mu) \quad \forall \mu \in \mathscr{D}
$$

完整的贪婪算法如下。


!!!!
\begin{aligned}
&S_{1}=\left\{\mu^{1}\right\} \\
&\text { compute } u_{h}\left(\mu^{1}\right) \\
&V_{1}=\operatorname{span}\left\{u_{h}\left(\mu^{1}\right)\right\} \\
&\text { for } \quad N=2, \ldots \\
&\quad \mu^{N}=\arg \max \mu \in \Xi_{t r a i n} \Delta_{N-1}(\mu) \\
&\varepsilon_{N-1}=\Delta_{N-1}\left(\mu^{N}\right) \\
&\text { if } \varepsilon_{N-1} \leq \varepsilon_{t \mathrm{tol}}^{*} \\
&\quad N_{\max }=N-1 \\
&\text { end; } \\
&\text { compute } u_{h}\left(\mu^{N}\right) \\
&S_{N}=S_{N-1} \cup\left\{\mu^{N}\right\} \\
&V_{N}=V_{N-1} \cup \operatorname{span}\left\{u_{h}\left(\mu^{N} \mid\right)\right\} \\
&\text { end. }
\end{aligned}
\label{20.70}\end{equation}


否则，在这个算法的第$N$次迭代中，在所有可能的候选$u_{h}(\mu), \mu \in \Xi_{\text {train }}$中，我们将后验误差约束\ref{20.96} 预测的特定候选快照附加到与$V_{N-1}$相关的RB预测中，这将是最差的近似。

对于能量准则[RHP08]也可以开发类似的贪婪程序。这在顺应的情况下尤其重要，因为能量准则的误差与输出的误差直接相关（见第20.3.2节）。

5 通常，这些样本是通过蒙特卡洛方法选择的，与均匀或对数均匀密度有关。  然而，$\Xi$是足够大的，以确保报告的结果对参数样本的进一步细化是不敏感的。我们通常区分测试样本$\Xi$和训练样本$\Xi_{\text {train }}$，前者用于在线评估RB近似和后验误差估计的质量，后者用于生成RB近似；后者的选择具有重要的计算意义（包括离线和在线）。

\subsubsection{Proper Orthogonal Decomposition}

在参数化系统的计算还原中，替代贪婪$\mathrm{RB}$算法构建还原空间的技术是适当正交分解（POD）。POD在多变量统计分析（它被称为主成分分析）或随机过程理论（以Karhunen-Loève分解的名义）中也很流行。POD在科学计算中的第一个应用是关于湍流的模拟，可以追溯到90年代初 [Aub91, BHL93]；感兴趣的读者可以在 [HLB98] 中找到进一步的细节。

POD技术$^{6}$通过将原始变量转化为一组新的不相关的变量（称为POD模式，或主成分）来降低系统的维度，前几个模式理想地保留了所有原始变量中存在的大部分能量。

POD方法依赖于奇异值分解（SVD）算法的使用，我们在下面简要介绍一下。考虑一组属于$n_{\text {train }}$的离散的快照向量$\left\{\mathbf{u}_{1}, \ldots, \mathbf{u}_{n_{\text {train }}}\right\}$，并形成以它们为列向量的快照矩阵$\mathbb{U} \in \mathbb{R}^{N_{h} \times n_{\text {train }}}$。

!!!!
\mathbb{U}=\left[\begin{array}{llll}
\mathbf{u}_{1} & \mathbf{u}_{2} & \ldots & \mathbf{u}_{n_{\text {train }}}
\end{array}\right]
$$

与 $n_{\text {train }}=\left|\Xi_{\text {train }}\right| \ll N_{h}($ 见 \ref{20.44})$ 。

!!!!
\mathbf{u}_{j}=\left(u_{j}^{(1)}, \ldots, u_{j}^{\left(N_{h}\right)}\right) \in \mathbb{R}^{N_{h}}, \quad u_{j}^{(r)}=u_{h}\left(x_{r} ; \mu^{j}\right) \Leftrightarrow u_{h}\left(x ; \mu^{j}\right)=\sum_{r=1}^{N_{h}} u_{j}^{(r)} \varphi^{r}(\mathbf{x})
\label{20.71}\end{equation}

$\mathbb{U}$的SVD分解为

!!!!
\mathbb{V}^{T} \mathbb{U Z}=\left(\begin{array}{cc}
\Sigma & 0 \\
0 & 0
\end{array}\right)
$$

其中$\mathbb{V}=\left[\begin{array}{llll}\boldsymbol{\zeta}_{1} & \zeta_{2} & \ldots & \zeta_{N^{h}}\end{array}\right] \in \mathbb{R}^{N_{h} \times N_{h}}$和$\mathbb{Z}=\left[\begin{array}{llll}\boldsymbol{\psi}_{1} & \boldsymbol{\psi}_{2} & \ldots & \psi_{n_{\text {train }}}\end{array}\right] \in \mathbb{R}^{n_{\text {train }} \times n_{\text {train }}}$是正交矩阵，$\Sigma=\operatorname{diag}\left(\sigma_{1}, \ldots, \sigma_{r}\right)$与$\sigma_{1} \geq \sigma_{2} \geq \ldots \geq \sigma_{r}$；这里$r \leq n_{\text {train }}$是$\mathbb{U}$的等级，如果快照向量并非全部线性独立，则严格小于$n_{\text {train }}$。

然后，我们可以写出

!!!!
\mathbb{U} \boldsymbol{\psi}_{i}=\sigma_{i} \zeta_{i} \quad \text { and } \quad \mathbb{U}^{T} \zeta_{i}=\sigma_{i} \psi_{i}, \quad i=1, \ldots, r
\label{20.72}\end{equation}

或者，等同于。

!!!!
\mathbb{U}^{T} \mathbb{U} \psi_{i}=\sigma_{i}^{2} \psi_{i} \quad \text { and } \quad \mathbb{U U}^{T} \zeta_{i}=\sigma_{i}^{2} \zeta_{i}, \quad i=1, \ldots, r
$$

${ }^{6}$ 关于POD技术的一般和简明的介绍，用于减少（与时间有关的）动态系统$-$这一策略的第一个（和最常用的）应用$-$，感兴趣的读者可以参考[Pin08, Voll1]。另外两种生成缩减空间的技术--实际上与POD相当接近--是中心沃洛尼镶嵌法（见第9章，[BGL06a, BGL06b]）和适当广义分解法（例如，见[CAC10, CLC11, Nou10]）。]是矩阵$\mathbb{U}^{T} \mathbb{U}$（也包括$\mathbb{U U}^{T}$）的非零特征值，按非递减顺序排列；$\mathbb{C}=\mathbb{U}^{T} \mathbb{U}$是相关矩阵

!!!!
\mathbb{C}_{i j}=\mathbf{u}_{i}^{T} \mathbf{u}_{j}, \quad 1 \leq i, j \leq n_{\text {train }}
$$

对于任何$N \leq n_{\text {train }}$，维度为$N$的POD基被定义为$N$的第一个$\zeta_{1}, \ldots, \zeta_{N}$左奇异向量的集合，或者说，向量的集合

!!!!
\zeta_{j}=\frac{1}{\sigma_{j}} \mathbb{U} \psi_{j}, \quad 1 \leq j \leq N
\label{20.73}\end{equation}

从相关矩阵$N$的第一个$\psi_{1}, \ldots, \psi_{N}$特征向量中获得。

根据构造，POD基是正交的。此外，如果$\left\{\mathbf{z}_{1}, \ldots, \mathbf{z}_{N}\right\}$是$\mathbb{R}^{N_{h}}$中$N$正态向量的任意集合，而$\Pi_{Z_{N}} \mathbf{w}$是向量$\mathbf{w} \in \mathbb{R}^{N_{h}}$对$Z_{N}=\operatorname{span}\left\{\mathbf{z}_{1}, \ldots, \mathbf{z}_{N}\right\}$的投影，即

!!!!
\Pi_{Z_{N}} \mathbf{u}=\sum_{n=1}^{N} \pi_{Z_{N}}^{n}(\mathbf{u}) \mathbf{z}_{n}, \quad \text { with } \quad \pi_{Z_{N}}^{n}(\mathbf{u})=\mathbf{u}^{T} \mathbf{z}_{n}
$$

从快照向量集$\mathbf{u}_{1}, \ldots, \mathbf{u}_{n_{\text {train }}}$生成的POD基础\ref{20.73}解决了以下最小化问题。

!!!!
\left\{\begin{array}{c}
\min \left\{E\left(\mathbf{z}_{1}, \ldots, \mathbf{z}_{N}\right), \mathbf{z}_{i} \in \mathbb{R}^{N_{h}}, \mathbf{z}_{i}^{T} \mathbf{z}_{j}=\delta_{i j}, \forall 1 \leq i, j \leq N\right\} \\
\text { with } E\left(\mathbf{z}_{1}, \ldots, \mathbf{z}_{N}\right)=\sum_{i=1}^{n_{\operatorname{train}}}\left\|\mathbf{u}_{i}-\Pi_{Z_{N}} \mathbf{u}_{i}\right\|_{2}^{2}
\end{array}\right.
\label{20.74}\end{equation}

因此，在所有可能的$N$-维正交集$\left\{\mathbf{z}_{1}, \ldots, \mathbf{z}_{N}\right\}$中，POD基础最小化，每个快照矢量$\mathbf{u}_{i}$与其在子空间$Z_{N} . E\left(\mathbf{z}_{1}, \ldots, \mathbf{z}_{N}\right)$上的投影$\Pi_{Z_{N}} \mathbf{u}_{i}$之间的误差平方之和通常被称为POD能量。

以前对POD方法的建设性介绍是基于所谓的快照方法，由Sirovich引入 [Sir87] 。另外，对应于一组快照向量的POD基 $\mathbf{u}_{1}, \ldots, \mathbf{u}_{n_{\text {train }}}$ 可以（而且经常是）由 \ref{20.74} 定义。在这种情况下，它与相关矩阵的SVD的联系以及关系(20.72)是通过强加POD基$\left\{\zeta_{1}, \ldots, \zeta_{N}\right\}$满足一阶必要最优条件而得到的（见练习2）。

此外，可以证明的是

!!!!
E\left(\zeta_{1}, \ldots, \zeta_{N}\right)=\sum_{i=N+1}^{r} \sigma_{i}^{2}
\label{20.75}\end{equation}

以便POD基础的误差等于被忽略的POD模式所对应的奇异值的平方。这样，我们可以选择$N_{\max }$，以便$E\left(\zeta_{1}, \ldots, \zeta_{N}\right) \leq \varepsilon_{\text {tol }}^{*}$，对于规定的公差$\varepsilon_{\text {tol }}^{*}

要做到这一点，只需选择$N_{\max }$作为最小的$N$，以便

!!!!
I(N)=\sum_{i=1}^{N} \sigma_{i}^{2} / \sum_{i=1}^{r} \sigma_{i}^{2} \geq 1-\delta
\label{20.76}\end{equation}

即最后$r-N_{\max }$个模式所保留的能量等于$\delta>0$，尽可能的小；$I(N)$被称为POD基础的相对信息含量。

一个关键的特点是，尽管$\delta$被选得非常小，例如$\delta=10^{-\beta}$与$\beta=!!!!3,4, \ldots$，在几个问题中$N_{\max }$相对较小（尤其是比$r$小得多）。发生这种情况的原因是，很多时候，快照矩阵的奇异值减少得非常快（例如，以指数速度）。

现在让我们把到目前为止描述的POD方法投到减基的背景中。正如已经指出的，见 \ref{20.71} ，快照向量集是由属于空间 $\left\{u_{h}\left(\mu^{1}\right), \ldots, u_{h}\left(\mu^{n}\right.\right.$ 的高保真近似函数集 $\left.)\right\}$ 获得的。在这种情况下，最小化问题\ref{20.74} 可以等效地重新表述为：找到能解决最小化问题的POD基$\left\{\zeta_{1}, \ldots, \zeta_{N}\right\}$。

!!!!
\left\{\begin{array}{c}
\min \left\{E\left(z_{1}, \ldots, z_{N}\right), z_{i} \in V^{N_{h}},\left(z_{i}, z_{j}\right)_{L^{2}(\Omega)}=\delta_{i j}, \forall 1 \leq i, j \leq N\right\} \\
\text { with } E\left(z_{1}, \ldots, z_{N}\right)=\sum_{i=1}^{n_{\text {train }}}\left\|u_{h}\left(\mu^{i}\right)-\Pi_{z} u_{h}\left(\mu^{i}\right)\right\|_{L^{2}(\Omega)}^{2}
\end{array}\right.
\label{20.77}\end{equation}

其中$\Pi_{z}: V^{N_{h}} \rightarrow Z_{N}$是$L^{2}(\Omega)$对$Z_{N}=\operatorname{span}\left\{z_{1}, \ldots, z_{N}\right\}$的投影。

为了解决\ref{20.77} ，我们的步骤如下。

- 我们形成等级$r\left(\leq n_{\text {train }}\right)$的相关矩阵

!!!!
\mathbb{C}_{i j}=\left(u_{h}\left(\mu^{i}\right), u_{h}\left(\mu^{j}\right)\right)_{L^{2}(\Omega)}, \quad 1 \leq i, j \leq n_{\text {train }}
$$

- 我们解决$n_{\text {train }} \times n_{\text {train }}$的特征值问题：对于$i=1, \ldots, r$ ,

!!!!
\mathbb{C} \psi_{i}=\sigma_{i}^{2} \psi_{i}, \quad \boldsymbol{\psi}_{i}^{T} \boldsymbol{\psi}_{j}=\delta_{i j}, \quad 1 \leq i, j \leq r
$$

- 最后我们设定

!!!!
\zeta_{i}=\sum_{j=1}^{n_{\text {train }}} \frac{1}{\sigma_{i}} \psi_{i}^{(j)} u_{h}\left(\mu^{j}\right), \quad 1 \leq i \leq N
\label{20.78}\end{equation}

$\psi_{i}^{(j)}$是特征向量$j$的第-个分量$\psi_{i}$和$\sigma_{i} \geq \sigma_{i-1}>0$ 。

相关矩阵分解为$\mathbb{C}=\mathbb{U}^{T} \tilde{\mathbb{M}} \mathbb{U}$ ，其中$\mathbb{U}$是快照矩阵，而

!!!!
(\tilde{\mathbf{M}})_{i j}=\left(\varphi^{i}, \varphi^{j}\right)_{L^{2}(\Omega)}, \quad 1 \leq i, j \leq N_{h}
$$

是高保真近似空间的质量矩阵$\tilde{\mathbb{M}}$。这使得我们可以再次利用SVD来计算POD的基础函数。通过使用Cholesky因子化$\tilde{\mathbb{M}}=\mathbb{H}^{T} \mathbb{H}$，其中$\mathbb{H} \in \mathbb{R}^{N_{h} \times N_{h}}$是$\tilde{\mathbb{M}}$的Cholesky因子，我们发现$\tilde{U}=\mathbb{H U}$，因此$\mathbb{C}=\mathbb{U}^{T} \tilde{\mathbb{M}} \mathbb{U}=\tilde{\mathbb{U}}^{T} \tilde{\mathbb{U}}$和$\psi_{i}, i=1, \ldots, N$代表$N$的第一个$\tilde{U}$奇异矢量。

通常，建立$\mathrm{RB}$空间的POD方法比贪婪方法更昂贵。在后者中，我们只需要计算$N$--通常是非常少的--高保真保留快照，而在POD方法中，我们必须计算所有$n_{\text {train }}-$通常/最好是非常多的--高保真候选快照，以及相关矩阵$\mathbb{C} \in \mathbb{R}^{N_{h} \times N_{h}}$的特征问题解。注意\ref{20.76} 提供了关于被选择的POD模式所忽略的能量量的信息，这是在$L^{2}$-norm而不是在$V$-norm中的指示，因为它是在贪婪算法中使用的后验误差估计。

\subsection{Convergence of RB approximations}

在本节中，我们说明了一些取决于一个或几个参数的问题的收敛结果。

\subsubsection{A priori convergence theory: a simple case}

关于基函数的数量$N$，一个先验的指数收敛结果在取决于一维参数的椭圆PDEs的情况下是已知的，例如在[MPT02a, MPT02b]中；此外，一些计算测试显示，例如在[RHP08]中提供了对这种行为的数值评估，也适用于参数空间的较大维度。这里我们描述最简单的情况，与特定的非层次空间相关$V_{N}^{\ln }, 1 \leq N \leq N_{\max }$，由以下内容给出

!!!!
V_{N}^{\ln }=\operatorname{span}\left\{u_{h}\left(\mu_{N}^{n}\right), \quad 1 \leq n \leq N\right\} 
\label{20.79}\end{equation}

!!!!
\mu_{N}^{n}=\mu^{\min } \exp \left\{\frac{n-1}{N-1} \ln \left(\frac{\mu^{\max }}{\mu^{\min }}\right)\right\}, \quad 1 \leq n \leq N, 1 \leq N \leq N_{\max } .
\label{20.80}\end{equation}

我们用$u_{N}^{\ln }(\mu)$表示相应的RB近似值。下面描述的先验理论表明，空间\ref{20.79}-$--我们将称之为 "等值 "空间--确实显示了最优性特征；正如我们在下一小节所看到的，贪婪的选择也会起到同样的作用。在这里，我们考虑第1节的热块问题。  $20.1 .1$的情况，如图$20.5$所示，$B_{1}=2, B_{2}=1$ 。

![](https://cdn.mathpix.com/cropped/991f5db518e324d299c1ff4972bba9fb-254.jpg?height=255&width=234&top_left_y=944&top_left_x=335)

图20.5.热力块问题：$B_{1}=2, B_{2}=1$ 然后，对于两个块/区域$\mathscr{R}_{1}$和$\mathscr{R}_{2}$的治理方程由\ref{20.13} 和\ref{20.14} 给出，单个参数$\mu=\mu_{1}$代表区域$\mathscr{R}_{1}$（区域$\mathscr{R}_{2}$的电导率为1），以及$\mu_{r}=100 ;$的参数域$\mathscr{D}=\left[\mu^{\min }, \mu^{\max }\right]=\left[1 / \sqrt{\mu_{r}}, \sqrt{\mu_{r}}\right]$，相关的仿射展开\ref{20.6）现在只包括$Q_{a}=2$项。

事实上，这里的分析与一大类单参数胁迫问题有关。对于这个问题的RB近似，以下结果成立。

Property 20.2. Given general data $F$ (of which $F^{\text {Neu }}$ from (20.14) is a particular example), we obtain that for any $N \geq 1+C_{\mu}$, and every $\mu \in \mathscr{D}$,

!!!!
\frac{\left\|u_{h}(\mu)-u_{N}^{\ln }(\mu)\right\| \mu}{\left\|u_{h}(\mu)\right\| \mu} \leq \exp \left\{-\frac{N-1}{C_{\mu_{r}}}\right\}
\label{20.81}\end{equation}

where $C_{\mu_{r}}=\left[2 e \ln \mu_{r}\right]_{+}$and []$_{+}$denotes the smallest integer greater than or equal to its real argument.



该证明是第4章标准（有限元）变分论证的 "参数化 "版本。 特别是，我们首先引用\ref{20.32}，并将$w$的参数$\mu$中的高阶多项式内插作为我们的候选参数。]；接下来我们应用标准的拉格朗日插值余数公式；最后，我们采用特征函数扩展来约束参数（敏感性）导数，并优化多项式插值的顺序。

关于完整的证明和更多的考虑，见 [PR07] 。我们注意到，相对于我们所考虑的模型问题，RB收敛估计\ref{20.81} 依赖于参数的平稳性，而不是计算网格（通过 $N_{h}$ ）；收敛率中的指数取决于 $N$ ，对数取决于 $\mu_{r}$ 。

\subsubsection{A priori convergence theory: greedy algorithms}

最近的几个结果在通过贪婪算法建立的缩小空间的更一般情况下进行了先验收敛分析。下面我们提供一些初步的结果，解释为什么以这种方式建立的近似空间$V_{N}$在$N$中表现出指数收敛性；进一步的细节见例如$\left[\mathrm{BMP}^{+} 12, \mathrm{BCD}^{+} 11\right]$。

让我们表示，对于任何$u_{h} \in \mathscr{M}_{h}$ ,

!!!!
\sigma_{N}\left(u_{h}, \mathscr{M}_{h}\right)=\inf _{v_{N} \in V_{N}}\left\|u_{h}-v_{N}\right\|_{V}=\left\|u_{h}-\Pi_{N}^{\mu} u_{h}\right\|_{V}
$$

其中$\Pi_{N}^{\mu}$表示对$V_{N}$的投影。那么

!!!!
\sigma_{N}\left(\mathscr{M}_{h}\right)=\sup _{u_{h} \in \mathscr{M}_{h}} \sigma_{N}\left(u_{h}, \mathscr{M}_{h}\right)
$$

是用$u$逼近$u$集时的最佳近似误差。事实上，这是在贪婪算法的每一步中必须最大化的数量，以便选择当前的快照。例如，参考第20.6.1节中的案例，如果选择\ref{20.80}，我们可以实现指数收敛，即

!!!!
\sigma_{N}\left(\mathscr{M}_{h}\right) \leq C \exp \left(-N^{\alpha}\right), \quad \text { for some } \alpha>0
$$

先验收敛分析的目的是为序列$\sigma_{N}\left(\mathscr{M}_{h}\right)$提供最佳$N$维子空间的上界，即在所有$N$维子空间中，使整个$\mathscr{M}_{h}$集的投影误差最小。这个最小误差由科尔莫戈罗夫$N$-宽度给出，它被定义为

!!!!
d_{N}\left(\mathscr{M}_{h}\right)=\inf _{Z_{N} \subset V} \sup _{u_{h} \in \mathscr{M}_{h}} \operatorname{dist}\left(u_{h}, Z_{N}\right)
\label{20.82}\end{equation}

其中

!!!!
\operatorname{dist}\left(u_{h}, Z_{N}\right)=\min _{w_{N} \in Z_{N}}\left\|u_{h}-w_{N}\right\|_{V}=\left\|u_{h}-\Pi_{Z_{N}} u_{h}\right\|_{V}
$$

并在维数为$Z_{N} \subset V$的所有线性子空间上取第一下限。关于Kolmogorov宽度的一般讨论，我们请读者参考[LvGM96, Pin85]。

$d_{N}\left(\mathscr{M}_{h}\right)$衡量空间$V$的一个子集可以用有限维子空间$Z_{N}$近似的程度。如果$\sigma_{N}\left(\mathscr{M}_{h}\right)$的衰减速度与$d_{N}\left(\mathscr{M}_{h}\right)$相当，那么贪婪选择基本上可以提供$N$-维子空间所能达到的最佳精度。

一般来说，关于Kolmogorov $N$ -width \ref{20.82} 的最佳子空间不被被逼近的集合 $\mathscr{M}_{h}$ 的元素所跨越，因此我们可能有 $d_{N}\left(\mathscr{M}_{h}\right) \ll \sigma_{N}\left(\mathscr{M}_{h}\right)$ 。然而，如果$N$的宽度以指数速度收敛，那么$V_{N}$中最佳近似的误差也会收敛。这就是$\left[\mathrm{BMP}^{+} 12\right]$中显示的以下结果的意义；我们记得$\gamma(\mu)$和$\alpha(\mu)$是双线性形式$a(\cdot, \cdot ; \mu)$的连续性和矫捷性常数。

Theorem 20.1. Assume that the set of all solutions $\mathscr{M}_{h}=\left\{u_{h}(\mu): \mu \in \mathscr{D}\right\}$ has an exponentially small Kolmogorov $N$-width, i.e.

!!!!
d_{N}\left(\mathscr{M}_{h}\right) \leq c e^{-\delta N} \quad \text { with } \quad \delta>\log \left(1+\left(\frac{\bar{\gamma}}{\alpha_{0}}\right)^{1 / 2}\right)=\log \delta_{0}
$$

where we have assumed that $\gamma(\mu) \leq \bar{\gamma}$ and $\alpha(\mu) \geq \alpha_{0}$ for all $\mu \in \mathscr{D}$. Then the reduced basis method built using the greedy algorithm (20.69) converges exponentially, that is, there exists $\eta>0$ such that

!!!!
\left\|u_{h}(\mu)-u_{N}(\mu)\right\|_{V} \leq C e^{-\eta N} \quad \forall \mu \in \mathscr{D}
$$

where $C=c N \delta_{0}^{N}$ is independent of $h$ and $\mu$, and $\delta_{0}>2 .$ The same result holds if we replace the error $\left\|u_{h}(\mu)-\Pi_{N}^{\mu} u_{h}(\mu)\right\|_{V}$ with the error estimate $\Delta_{N}(\mu)$ in (20.69) provided that

!!!!
\delta>\log \left(1+\frac{\bar{\gamma}}{\alpha_{0}^{N_{h}}}\left(\frac{\bar{\gamma}}{\alpha_{0}}\right)^{1 / 2}\right)
$$

Above, $\alpha_{0}^{N_{h}}>0$ is a computable, uniform lower bound of the high-fidelity coercivity constant $\alpha^{N_{h}}(\mu)$, hence such that $\alpha^{N_{h}}(\mu) \geq \alpha_{0}^{N_{h}}$ for any $\mu \in \mathscr{D}$.



虽然从理论上看很有趣，但只有在$d_{N}\left(\mathscr{M}_{h}\right)$比$N^{-1} \delta_{0}^{-N}$更快地衰减为零时，前面的比较才有用。我们注意到，$\sqrt{\bar{\gamma} / \alpha_{0}}$这个系数与$V$这个准则有关，这个准则被用来衡量贪婪算法的误差。此外，(20.96)中定义的后验误差估计$\Delta_{N}(\mu)$的表达涉及高保真矫捷性常数$\alpha^{N_{h}}(\mu)$的可计算($\mu$相关)下限$\alpha_{\mathrm{LB}}^{N_{h}}(\mu) \leq \alpha^{N_{h}}(\mu)$；特别是，参数下限均匀地被$\alpha_{0}^{N_{h}}>0$所约束。

事实上，当对参数的依赖是分析性的时候，我们有Kolmogorov $N$ -width的指数收敛性'。这个结果在$\left[\mathrm{BCD}^{+} 11\right]$中得到了进一步的改进，它表明如果$d_{N}\left(\mathscr{M}_{h}\right) \leq C \exp \left(-c N^{\beta}\right)$对所有$N>0$和一些$C, c>0$，那么，对一些$\widetilde{C}, \widetilde{c}>0$我们有。

!!!!
\sigma_{N}\left(\mathscr{M}_{h}\right) \leq \widetilde{C} \exp \left(-\widetilde{c} N^{\beta /(\beta+1)}\right)
\label{20.83}\end{equation}

与$\widetilde{C}$无关的$N$ 。在代数收敛的情况下，$d_{N}\left(\mathscr{M}_{h}\right) \leq M N^{-\alpha}$对于所有$N>0$和一些$M, \alpha>0$，被证明为

!!!!
\sigma_{N}\left(\mathscr{M}_{h}\right) \leq C M N^{-\alpha}, \quad C=C\left(\gamma, \alpha_{0}\right)
\label{20.84}\end{equation}

此外，有研究表明

!!!!
\sigma_{N}\left(\mathscr{M}_{h}\right) \leq \frac{2^{N+1}}{\sqrt{3}} d_{N}\left(\mathscr{M}_{h}\right)
$$

而这一估计一般来说是无法改进的。

最后，本书的读者会想到，数值逼近的快速（指数）收敛是谱法的一个明显特征（见第10章）。减基方法确实与频谱方法有一些共同点：与后者类似，它利用了具有全局支持的基函数（在RB情况下，这些基函数与问题有关，而在纯频谱情况下，是全局正交多项式）。

${ }^{7}$然而，解流形$\mathscr{M}_{h}$的分析正则性并不是应用减基方法的必要条件。总的来说，对有规律系数的椭圆方程的解进行减基逼近确实非常成功。贪婪算法的进一步收敛分析和这些结果的数字证明，扩展了[MPT02a, MPT02b]中提出的结果，例如可以在[LMQR13]中找到。

\subsection{A posteriori error estimation}

对感兴趣的场变量和输出的有效后验误差界线对于RB近似的效率和可靠性都是至关重要的。在效率方面，后验误差估计允许控制误差，并通过控制RB空间的维度来最小化计算工作量。不仅如此，对于贪婪算法来说，误差边界的应用（作为实际误差的替代物）允许更大的训练样本$\Xi_{\text {train }} \subset \mathscr{D}$和更好的参数空间探索，大大降低了离线计算成本。关于可靠性，后验误差界线允许自信地利用$\mathrm{RB}$近似的快速预测能力，并为在线阶段的每个新参数值$\mu$提供误差量化。

反过来，误差界限必须是严格的--对所有$N$和参数域$\mathscr{D}$中的所有参数值有效：非严格的误差指标将不能确保可靠性。其次，界限必须合理尖锐：过于保守的误差界限会产生低效的近似值（$N$太大），甚至是危险的次优工程结果（不必要的安全系数）。第三，界限必须非常有效：计算RB误差界限的在线操作数和存储量--边际平均成本$-$必须与$N_{h}$无关（并且与RB输出预测的相关成本相称）。

\subsubsection{Some preliminary estimates}

后验误差估计的中心方程是误差-残差关系（见4.6.2节）。从$u_{h}(\mu),(20.16)$和$u_{N}(\mu),(20.30)$的问题陈述中可以看出，通过引入残差$r(v ; \mu) \in\left(V^{N_{h}}\right)^{\prime}

!!!!
r(v ; \mu)=f(v ; \mu)-a\left(u_{N}(\mu), v ; \mu\right) \quad \forall v \in V^{N_{h}}
\label{20.85}\end{equation}

即错误$e_{h}(\mu)=u_{h}(\mu)-u_{N}(\mu) \in V^{N_{h}}$满足于

!!!!
a\left(e_{h}(\mu), v ; \mu\right)=r(v ; \mu) \quad \forall v \in V^{N_{h}}
\label{20.86}\end{equation}

$\hat{e}_{h}(\mu) \in V^{N_{h}}$的里兹表示$r(\cdot ; \mu)$（见定理2.1）满足于

!!!!
\left(\hat{e}_{h}(\mu), v\right)_{V}=r(v ; \mu) \quad \forall v \in V^{N_{h}}
\label{20.87}\end{equation}

从误差残差方程\ref{20.86} 我们得到

!!!!
a\left(e_{h}(\mu), v ; \mu\right)=\left(\hat{e}_{h}(\mu), v\right)_{V} \quad \forall v \in V^{N_{h}}
\label{20.88}\end{equation}

因此

!!!!
\|r(\cdot ; \mu)\|_{\left(V^{\left.N_{h}\right)^{\prime}}\right.}=\sup _{v \in V^{N_{h}}} \frac{r(v ; \mu)}{\|v\|_{V}}=\left\|\hat{e}_{h}(\mu)\right\|_{V}
\label{20.89}\end{equation}

通过Riesz代表定理计算残差的对偶准则，可以开发一个合适的Offline-Online程序，用于评估误差边界，如下所述。

我们回顾一下精确的和$\mathrm{FE}$的矫顽力常数的定义，分别是\ref{20.5）和\ref{20.20} 。此外，我们将要求对（参数）矫顽力常数$\alpha_{\mathrm{LB}}^{N_{h}}$：$\mathscr{D} \rightarrow \mathbb{R}$设定一个（参数）下限$\alpha^{N_{h}}(\mu)$ 。

!!!!
0<\alpha_{\mathrm{LB}}^{N_{h}}(\mu) \leq \alpha^{N_{h}}(\mu) \quad \forall \mu \in \mathscr{D}
$$

\subsubsection{Error bounds}

我们对能量准则和输出的误差估计分别定义为

!!!!
\Delta_{N}^{\mathrm{en}}(\mu)=\frac{\left\|\hat{e}_{h}(\mu)\right\|_{V}}{\left(\alpha_{\mathrm{LB}}^{N_{h}}(\mu)\right)^{1 / 2}} \quad \text { and } \quad \Delta_{N}^{s}(\mu)=\frac{\left\|\hat{e}_{h}(\mu)\right\|_{V}^{2}}{\alpha_{\mathrm{LB}}^{N_{h}}(\mu)}
\label{20.90}\end{equation}

我们接下来介绍与这些误差估计器相关的效果系数为

!!!!
\eta_{N}^{\mathrm{en}}(\mu)=\frac{\Delta_{N}^{\mathrm{en}}(\mu)}{\left\|u_{h}(\mu)-u_{N}(\mu)\right\|_{\mu}} \quad \text { and } \quad \eta_{N}^{s}(\mu)=\frac{\Delta_{N}^{s}(\mu)}{\left(s_{h}(\mu)-s_{N}(\mu)\right)}
$$

分别。为了实现严谨性，我们将坚持使用效果系数$\geq 1$；为了尖锐性，我们希望它们尽可能地接近1。已经证明[RHP08, PR07]，即

Property 20.3. For any $N=1, \ldots, N_{\max }$, the effectivity factors satisfy

!!!!
1 \leq \eta_{N}^{\mathrm{en}}(\mu) \leq \sqrt{\frac{\gamma(\mu)}{\alpha_{\mathrm{LB}}^{N_{h}}(\mu)}} \quad \forall \mu \in \mathscr{D}
\label{20.91}\end{equation}


!!!!
1 \leq \eta_{N}^{s}(\mu) \leq \frac{\gamma(\mu)}{\alpha_{\mathrm{LB}}^{N_{h}}(\mu)} \quad \forall \mu \in \mathscr{D}
\label{20.92}\end{equation}

证明。从\ref{20.88}直接得出$v=e_{h}(\mu)$，并从考奇-施瓦茨不等式得出

!!!!
\left\|e_{h}(\mu)\right\|_{\mu}^{2} \leq\left\|\hat{e}_{h}(\mu)\right\|_{V}\left\|e_{h}(\mu)\right\|_{V}
\label{20.93}\end{equation}

但是$\left(\alpha^{N_{h}}(\mu)\right)^{\frac{1}{2}}\left\|e_{h}(\mu)\right\|_{V} \leq\left(a\left(e_{h}(\mu), e_{h}(\mu) ; \mu\right)\right)^{\frac{1}{2}}=\left\|e_{h}(\mu)\right\|_{\mu}$ ，因此从\ref{20.93}得到$\left\|e_{h}(\mu)\right\|_{\mu} \leq \Delta_{N}^{\mathrm{en}}(\mu)$或$\eta_{N}^{\text {en }}(\mu) \geq 1$ 。我们再考虑\ref{20.88}和$-$，但现在对$v=\hat{e}_{h}(\mu)-$和考奇-施瓦茨不等式，得到

!!!!
\left\|\hat{e}_{h}(\mu)\right\|_{V}^{2} \leq\left\|\hat{e}_{h}(\mu)\right\|_{\mu}\left\|e_{h}(\mu)\right\|_{\mu}
\label{20.94}\end{equation}

由于连续性，$\left\|\hat{e}_{h}(\mu)\right\|_{\mu} \leq(\gamma(\mu))^{\frac{1}{2}}\left\|\hat{e}_{h}(\mu)\right\|_{V}$，因此从\ref{20.94} 中可以看出

!!!!
\Delta_{N}^{\mathrm{en}}(\mu)=\left(\alpha_{\mathrm{LB}}^{N_{h}}(\mu)\right)^{-\frac{1}{2}}\left\|\hat{e}_{h}(\mu)\right\|_{V} \leq\left(\alpha_{\mathrm{LB}}^{N_{h}}(\mu)\right)^{-\frac{1}{2}}(\gamma(\mu))^{\frac{1}{2}}\left\|e_{h}(\mu)\right\|_{\mu}
$$

即为$\eta_{N}^{\text {en }}(\mu) \leq \sqrt{\gamma(\mu) / \alpha_{\mathrm{LB}}^{N_{h}}(\mu)}$ 。接下来，从\ref{20.33} 中，我们有$s_{h}(\mu)-s_{N}(\mu)=$ $\left\|e_{h}(\mu)\right\|_{\mu}^{2}$ ，因此，由于$\Delta_{N}^{s}(\mu)=\left(\Delta_{N}^{\text {en }}(\mu)\right)^{2}:$ 。

!!!!
\eta_{N}^{s}(\mu)=\frac{\Delta_{N}^{s}(\mu)}{s_{h}(\mu)-s_{N}(\mu)}=\frac{\left(\Delta_{N}^{\mathrm{en}}(\mu)\right)^{2}}{\|e(\mu)\|_{\mu}^{2}}=\left(\eta_{N}^{\mathrm{en}}(\mu)\right)^{2}
\label{20.95}\end{equation}

最后，\ref{20.92} 直接由\ref{20.91} 和\ref{20.95} 得出。

对于$V$准则中的后验误差界限也可以得到类似的结果，它被定义为

!!!!
\Delta_{N}(\mu)=\frac{\left\|\hat{e}_{h}(\mu)\right\|_{V}}{\alpha_{\mathrm{LB}}^{N_{h}}(\mu)}
\label{20.96}\end{equation}

事实上，按照命题$20.3$中的相同论证，可以证明。

Property 20.4. For any $N=1, \ldots, N_{\max }$

!!!!
1 \leq \frac{\Delta_{N}(\mu)}{\left\|u_{h}(\mu)-u_{N}(\mu)\right\|_{V}} \leq \frac{\gamma(\mu)}{\alpha_{\mathrm{LB} B}^{N_{h}}(\mu)} \quad \forall \mu \in \mathscr{D}
\label{20.97}\end{equation}


效力上界\ref{20.91},(20.92)$和\ref{20.97}，与$N$无关，因此对$R B$的细化来说是稳定的。

最后，我们指出，如果没有相应的离线-在线计算方法，上一节的误差界线就没有什么用处。上一节所有误差界线的关键计算部分是$\left\|\hat{e}_{h}(\mu)\right\|_{V}$，即残差\ref{20.85}的对偶准则，其表达式可以根据\ref{20.35}和\ref{20.6}展开，从而产生预先计算离线的参数无关量的可能性，然后对于$\mu$的任何新值，只评估一些参数无关量。有兴趣的读者可以在[QRM11, RHP08]中找到进一步的细节。

构建矫顽力常数下限的方法是 $-$ 中介绍的连续约束法（SCM），它是一种广义的最小特征值 [HRSP07] 。该方法--基于离线-在线策略--将在线（实时）计算简化为一个小的线性程序，对于该程序，操作数与 $N_{h}$ 无关。更多细节见 [RHP08] 。

\subsection{Non-compliant problems}。

为了简单起见，我们在第$20.7$节中处理了顺应情况下的仿生参数化胁迫问题的RB近似。  $20.7$中讨论了顺应情况下的仿生参数化胁迫问题的RB近似。现在我们考虑椭圆情况和更普遍的非顺应性问题：给定$\mu \in \mathscr{D}$，求

!!!!
s(\mu)=J(u(\mu)),
\label{20.98}\end{equation}

其中$u(\mu) \in V$满足

!!!!
a(u(\mu), v ; \mu)=f(v ; \mu) \quad \forall v \in V
\label{20.99}\end{equation}

我们假设$a$是胁迫的和连续的，但不一定是对称的；我们进一步假设$J$和$f$都是有界线性函数${ }^{8}$ ，但我们不再要求$J=f$ 。此外，我们假设$a$和$f$都是仿射，见\ref{20.6}-\ref{20.7} 。

按照第20.7节的方法（和符号），我们可以很容易地找到$s_{N}(\mu):$的后验误差界限，通过标准论证我们得到

!!!!
\left|s_{h}(\mu)-s_{N}(\mu)\right| \leq\|J\|_{\left(V^{\left.N_{h}\right)^{\prime}}\right.} \Delta_{N}^{\text {en }}(\mu)
$$

其中$\left\|u_{h}(\mu)-u_{N}(\mu)\right\| \mu \leq \Delta_{N}^{\text {en }}(\mu)$和$\Delta_{N}^{\text {en }}(\mu)$在\ref{20.90} 中定义；进一步的细节见[RHP08, PR07]。我们将这种方法命名为 "纯原始"。尽管对于许多输出来说，只用原始方法也许是最好的方法（每一个额外的输出和相关的误差约束都是一个简单的 "附加"），但这种方法有两个缺点。

1. 我们失去了输出的 "二次收敛 "效果\ref{20.33}（除非$J=f$和$a$是对称性的）。

2. 效力系数$\Delta_{N}^{s}(\mu) /\left|s(\mu)-s_{N}(\mu)\right|$可能是无界的：如果$J=f$，那么我们从\ref{20.33} 知道，$\left|s_{h}(\mu)-s_{N}(\mu)\right| \sim\left\|\hat{e}_{h}(\mu)\right\|_{V}^{2}$，因而

!!!!
\frac{\Delta_{N}^{s}(\mu)}{\left|s_{h}(\mu)-s_{N}(\mu)\right|} \sim \frac{1}{\left\|\hat{e}_{h}(\mu)\right\|_{V}} \rightarrow \infty \quad \text { as } N \rightarrow \infty
$$

即\ref{20.90} 中定义的输出误差约束$\Delta_{N}^{s}$的有效性趋于无穷大，因为$(N \rightarrow \infty$和$) u_{N}(\mu) \rightarrow u_{h}(\mu)$ 。

我们可以期待任何$J$"接近"$f:$的类似行为，问题是$\Delta_{N}^{s}(\mu)$并不反映测试空间对输出收敛的贡献。

引入RB原始-对偶近似可以克服以前的问题$-$，并确保稳定的极限为$N \rightarrow \infty$。让我们引入与$J$相关的对偶问题，其内容如下：找到$\psi(\mu) \in V$，以便

!!!!
a(v, \psi(\mu) ; \mu)=-J(v) \quad \forall v \in V
$$

$\psi$被称为邻接或对偶场。让我们分别定义原始问题和对偶问题的RB空间。

!!!!
\begin{gathered}
V_{N_{p r}}=\operatorname{span}\left\{u_{h}\left(\mu^{k, p r}\right), 1 \leq k \leq N_{p r}\right\}, \quad 1 \leq N_{p r} \leq N_{p r, m a x} \\
V_{N_{d u}}=\operatorname{span}\left\{\Psi_{h}\left(\mu^{k, d u}\right), 1 \leq k \leq N_{d u}\right\}, \quad 1 \leq N_{d u} \leq N_{d u, \max } .
\end{gathered}
$$

${ }^{8}$ 典型的输出函数对应于$u(\mu)$场在一个区域或线（特别是边界段）上的 "积分" 。然而，通过适当的提升技术，也可以考虑$f$勒克斯在边界段上的 "积分"。为了我们的目的，一个单一的FE空间就足以满足原始和对偶的要求，即使在实践中FE原始和对偶空间可能是不同的。由此产生的$\mathrm{RB}$近似值$u_{N_{p r}}(\mu) \in V_{N_{p r}}, \Psi_{N_{d u}}(\mu) \in V_{N_{d u}}$可以解决

!!!!
\begin{aligned}
&a\left(u_{N_{p r}}(\mu), v ; \mu\right)=f(v ; \mu) \quad \forall v \in V_{N_{p r}}, \\
&a\left(v, \Psi_{N_{d u}}(\mu) ; \mu\right)=-J(v) \quad \forall v \in V_{N_{d u}}
\end{aligned}
$$

那么，RB输出可以被评估为

!!!!
s_{N_{p r}, N_{d u}}(\mu)=J\left(u_{N_{p r}}\right)-r^{p r}\left(\Psi_{N_{d u}} ; \mu\right)
$$

其中

!!!!
\begin{aligned}
r^{p r}(v ; \mu) &=f(v ; \mu)-a\left(u_{N_{p r}}, v ; \mu\right) \\
r^{d u}(v ; \mu) &=-J(v)-a\left(v, \Psi_{N_{d u}} ; \mu\right)
\end{aligned}
$$

分别为原始残差和对偶残差。如$r^{p r}\left(\Psi_{N_{d u}} ; \mu\right)$所述，术语$s_{h}(\mu)$允许获得一个更好的收敛到高保真输出[PG00]。

因此，输出误差约束采取以下形式。

!!!!
\Delta_{N}^{s}(\mu)=\frac{\left\|r^{\mathrm{pr}}(\cdot ; \mu)\right\|_{\left(V^{\left.N_{h}\right)}\right.}}{\left(\alpha_{\mathrm{LB}}^{N_{h}}(\mu)\right)^{1 / 2}} \frac{\left\|r^{\mathrm{du}}(\cdot ; \mu)\right\|_{\left(V^{\left.N_{h}\right)}^{\prime}\right.}}{\left(\alpha_{\mathrm{LB}}^{N_{h}}(\mu)\right)^{1 / 2}}
\label{20.100}\end{equation}

在不符合要求的情况下，我们能够恢复 "二次 "的输出效果。请注意，"离线-在线 "程序与 "只做原始 "的情况非常相似，但现在我们需要同时做原始和对偶的所有事情；此外，我们需要同时评估一个原始和对偶的残差，以确定后验误差的界限。

\subsection{Parametrized geometries and operators}

在这一节中，我们将介绍属于第1节中抽象表述的标量问题的一般类别。  $20.1$，通过扩展$20.1 .1$一节中描述的简单例子，介绍标量问题的一般类别。  $20.1 .1$中描述的简单例子扩展到参数可能描述的情况下。

- 物理属性（材料系数、源项、边界数据），可能在计算域的不同子区域有所变化。

- 计算域的几何配置。

按照复杂程度的递增，我们首先讨论了参数化物理特性的情况；然后我们描述了一个考虑到不同子区域物理特性变化的概括；最后，我们提出了处理参数化几何的更困难的情况。

为了便于阐述，让我们区分$d_{p}$物理参数成分和$d_{g}$几何参数成分：我们用$\mu_{p}$表示前者，用$\mu_{g}$表示后者，分别表示$\mu=\left(\mu_{p}, \mu_{g}\right) \in \mathscr{D}_{p} \times \mathscr{D}_{g}=: \mathscr{D}$和$\mathscr{D}_{p} \subset \mathbb{R}^{d p}, \mathscr{D}_{g} \subset \mathbb{R}^{d_{g}}$，用$p=d_{p}+d_{g}$。我们重点研究以下的平流-扩散-反应问题。

!!!!
\begin{cases}-\frac{\partial}{\partial x_{i}}\left(v_{i j}\left(\mathbf{x} ; \mu_{p}\right) \frac{\partial}{\partial x_{j}} u(\mu)\right)+\left(b_{i}\left(\mathbf{x} ; \mu_{p}\right) \frac{\partial}{\partial x_{i}}\right) u(\mu) \\ u+\gamma\left(\mathbf{x} ; \mu_{p}\right) u(\mu)=F\left(\mathbf{x} ; \mu_{p}\right), & \mathbf{x} \in \Omega\left(\mu_{g}\right) \\ u(\mu)=0, & \mathbf{x} \in \Gamma_{D} \\ v_{i j}\left(\mathbf{x} ; \mu_{p}\right) \frac{\partial}{\partial x_{j}} u(\mu)=g_{N}\left(\mathbf{x} ; \mu_{p}\right), & \mathbf{x} \in \Gamma_{N}\end{cases}
$$

其中，我们假设所有的系数（如热导率、弹性系数等）可能取决于空间坐标和物理参数的向量$\mu_{p}$。域$\Omega\left(\mu_{g}\right) \subset \mathbb{R}^{d}, d=1,2,3$，可能反而取决于一个几何参数的向量$\mu_{g}$。为了简单起见，在下面我们考虑在二维域$(d=2)$上定义的问题。

这里我们假设只有施加在$\Gamma_{N}$上的诺伊曼数据受到物理参数的影响，而在$\Gamma_{D}=\partial \Omega\left(\mu_{g}\right) \backslash \Gamma_{N}$上我们施加了同质的狄里奇条件。Parametrized Dirichlet数据，虽然经历了类似的处理，但涉及适当的（可能是参数化的）提升函数。

\subsubsection{Physical parameters}

在最简单的情况下，输入参数$\mu=\mu_{p}$代表物理属性，而计算域$\Omega$是参数无关的。此外，我们假设物理系数的参数依赖性在计算域上没有变化。域被分割成与不同物理属性相关的子区域的情况将在后面涉及。

在这种情况下，出现在\ref{20.2}中的双线性形式和线性形式由以下方式给出

!!!!
a\left(w, v ; \mu_{p}\right)=\int_{\Omega} \frac{\partial w}{\partial x_{i}} v_{i j}\left(\mathbf{x} ; \mu_{p}\right) \frac{\partial v}{\partial x_{j}} d \Omega+\int_{\Omega} b_{i}\left(\mathbf{x} ; \mu_{p}\right) \frac{\partial w}{\partial x_{i}} v d \Omega+\int_{\Omega} \gamma\left(\mathbf{x} ; \mu_{p}\right) w v d \Omega 
\label{20.101}\end{equation}

!!!!
f(v ; \mu)=\int_{\Omega} F\left(\mathbf{x} ; \mu_{p}\right) v d \Omega+\int_{\Gamma_{N}} g_{N}\left(\mathbf{x} ; \mu_{p}\right) v d \Gamma
\label{20.102}\end{equation}

其中$V=H_{\Gamma_{D}}^{1}(\Omega)$；对重复指数的求和可以理解。

为了确保\ref{20.101}的仿射展开，我们假设$\mu_{p}$和$\mathbf{x}$可以被视为独立的变量，即每个系数应表示为两个函数的乘积。

!!!!
v_{i j}\left(\mathbf{x} ; \mu_{p}\right)=K_{i j}\left(\mu_{p}\right) \psi_{i j}(\mathbf{x}), \quad 1 \leq i, j \leq 2 
\label{20.103}\end{equation}

!!!!
b_{i}\left(\mathbf{x} ; \mu_{p}\right)=K_{i 3}\left(\mu_{p}\right) \psi_{i 3}(\mathbf{x}), \quad i=1,2 
\label{20.104}\end{equation}

!!!!
\gamma\left(\mathbf{x} ; \mu_{p}\right)=K_{33}\left(\mu_{p}\right) \psi_{33}(\mathbf{x})
\label{20.105}\end{equation}

这样，通过将取决于参数$\mu_{p}$的项从积分中取出，我们可以将\ref{20.101）重写如下。

!!!!
a(w, v ; \mu)=\sum_{i, j=1}^{3} K_{i j}\left(\mu_{p}\right) \int_{\Omega}\left[\begin{array}{ccc}
\frac{\partial w}{\partial x_{1}} & \frac{\partial w}{\partial x_{2}} & w
\end{array}\right] \psi_{i j}(\mathbf{x})\left[\begin{array}{c}
\frac{\partial v}{\partial x_{1}} \\
\frac{\partial v}{\partial x_{2}} \\
v
\end{array}\right] d \Omega
\label{20.106}\end{equation}

其中$\mathbf{x}=\left(x_{1}, x_{2}\right)$表示$\Omega$中的一个点。这里$K: \mathscr{D}_{p} \rightarrow \mathbb{R}^{3 \times 3}$和$\Psi: \Omega \rightarrow \mathbb{R}^{3 \times 3}$是给定的$-$分量$K_{i j}\left(\mu_{p}\right)$和$\psi_{i j}(\mathbf{x})$的矩阵，分别为$-$，要求对任何$\mathbf{x} \in \Omega, \mu_{p} \in \mathscr{D}_{p}$都是对称和正定的，以保证双线性形式的矫顽性。

特别是，$2 \times 2$的上层主子矩阵$K$和$\Psi$给出了通常的传导性/扩散性张量；$(3,3)$项允许考虑一个反应（或质量）项。$(3,1),(3,2)$（和$(1,3),(2,3))!!!!K$和$\Psi$的元素与一阶导数（或对流）项有关；特别是，为了恢复\ref{20.101），我们假设$K_{31}\left(\mu_{p}\right)=K_{32}\left(\mu_{p}\right)=0$ .

为了简单起见，在下文中我们假设 $g_{N}=0$ 。我们注意到，在纯物理参数化的情况下，亲和力假设\ref{20.6）很容易满足；见练习 $3$ 。

现在让我们考虑这样的情况，即领域

!!!!
\bar{\Omega}=\bigcup_{k=1}^{K_{\mathrm{reg}}} \mathscr{R}_{k}
$$

被分成几个区域$^{9} \mathscr{R}_{k}$，每个区域都与不同的物理性质有关。因此，我们可以用以下公式代替\ref{20.101），即

!!!!
\begin{aligned}
a\left(w, v ; \mu_{p}\right)=\sum_{k=1}^{K_{\text {reg }}} \int_{\mathscr{R}_{k}} & \frac{\partial w}{\partial x_{i}} v_{i j}^{k}\left(\mathbf{x} ; \mu_{p}\right) \frac{\partial v}{\partial x_{j}} d \Omega \\
&+\sum_{k=1}^{K_{\text {reg }}} \int_{\mathscr{R}_{k}} b_{i}^{k}\left(\mathbf{x} ; \mu_{p}\right) \frac{\partial w}{\partial x_{i}} v d \Omega+\sum_{k=1}^{K_{\text {reg }}} \int_{\mathscr{R}_{k}} \gamma^{k}\left(\mathbf{x} ; \mu_{p}\right) w v d \Omega
\end{aligned}
\label{20.107}\end{equation}

与

!!!!
v_{i j}^{k}\left(\mathbf{x} ; \mu_{p}\right)=K_{i j}^{k}\left(\mu_{p}\right) \psi_{i j}^{k}(\mathbf{x}), \quad 1 \leq i, j \leq 2
\label{20.108}\end{equation}


!!!!
b_{i}^{k}\left(\mathbf{x} ; \mu_{p}\right)=K_{i 3}^{k}\left(\mu_{p}\right) \psi_{i 3}(\mathbf{x}), \quad i=1,2, \quad \gamma^{k}\left(\mathbf{x} ; \mu_{p}\right)=K_{33}^{k}\left(\mu_{p}\right) \psi_{33}^{k}(\mathbf{x})
\label{20.109}\end{equation}

${ }^{9}$我们对$(i)$计算域的划分进行了区分，即在不同的子区域上说明不同的物理特性，以及(ii)为了几何表示而在不同的子域中进行域的分解，如第20.9.2小节所示，对于任何$1 \leq k \leq K_{\mathrm{reg}}$，因此

!!!!
a(w, v ; \mu)=\sum_{k=1}^{K_{\text {reg }}} \sum_{i, j=1}^{3} K_{i j}^{k}\left(\mu_{p}\right) \int_{\mathscr{R}_{k}}\left[\begin{array}{lll}
\frac{\partial w}{\partial x_{1}} & \frac{\partial w}{\partial x_{2}} & w
\end{array}\right] \psi_{i j}^{k}(x)\left[\begin{array}{c}
\frac{\partial v}{\partial x_{1}} \\
\frac{\partial v}{\partial x_{2}} \\
v
\end{array}\right] d \Omega
\label{20.110}\end{equation}

其中，对于任何$k=1, \ldots, K_{\mathrm{reg}}, K^{k}: \mathscr{D}_{p} \rightarrow \mathbb{R}^{3 \times 3}$和$\Psi^{k}: \Omega \rightarrow \mathbb{R}^{3 \times 3}$是给定的矩阵。按照我们之前的做法，在这种情况下也有可能恢复仿生扩展。

\subsubsection{Geometrical parameters}

我们现在转向更困难的几何参数化的情况。在这种情况下，定义在参数化域$\Omega_{\mathrm{o}}\left(\mu_{g}\right)$上的原始参数化问题需要转化为定义在与参数无关的域$\Omega$上的等价问题。这是$\mathrm{RB}$方法的一个要求：如果我们希望考虑预先计算的解决方案（快照）的线性组合，后者必须参考一个共同的空间配置。

因此，为了允许几何变化，我们的参数无关的参考域$\Omega$必须被视为$\Omega_{0}\left(\mu_{g}\right)$的前像，即参数有关的 "实际 "或 "原始 "域。几何变换将产生参考域中线性和双线性形式的可变（取决于参数）系数，在下面要讨论的适当假设下，将采取必要的仿生形式\ref{20.6}。

我们将首先定义一个 "原始 "问题（下标$o$），在参数依赖域$\Omega_{\mathrm{o}}=\Omega_{\mathrm{o}}\left(\mu_{g}\right) ;$上，我们表示$V_{\mathrm{o}}$是定义在$\Omega_{\mathrm{o}}\left(\mu_{g}\right)$上的合适希尔伯特空间。我们还将考虑到可能的物理参数，因此，$\mu=\left(\mu_{p}, \mu_{g}\right) \in \mathscr{D}=\mathscr{D}_{p} \times \mathscr{D}_{g}$和$\mathscr{D}_{p} \subset \mathbb{R}^{d_{p}}, \mathscr{D}_{g} \subset \mathbb{R}^{d_{g}}$ ，与$p=d_{p}+d_{g}$ 。

在椭圆情况下，原问题如下：给定$\mu \in \mathscr{D}$，评估

!!!!
s_{\mathrm{o}}(\mu)=J_{\mathrm{o}}\left(u_{\mathrm{o}}(\mu)\right),
$$

其中$u_{\mathrm{o}}(\mu) \in V_{\mathrm{o}}$满足于

!!!!
a_{\mathrm{o}}\left(u_{\mathrm{o}}(\mu), v ; \mu\right)=F_{\mathrm{o}}(v ; \mu) \quad \forall v \in V_{\mathrm{o}}
$$

因此，参考域$\Omega$通过参数映射$T\left(\cdot ; \mu_{g}\right)$与原域$\Omega_{\mathrm{o}}\left(\mu_{g}\right)$相关，这样$\Omega_{\mathrm{o}}\left(\mu_{g}\right)=T\left(\Omega ; \mu_{g}\right) ;$特别是，我们可以设置$\Omega=\Omega_{\mathrm{o}}\left(\mu_{g}^{\text {ref }}\right)$，用于选定参数值$\mu_{g}^{\text {ref }} \in \mathscr{D}_{g}$。为了建立一个与几何特性相关的参数映射，我们将引入$\Omega_{\mathrm{o}}\left(\mu_{g}\right)$的符合域分解。

!!!!
\bar{\Omega}_{\mathrm{o}}\left(\mu_{g}\right)=\bigcup_{k=1}^{K_{\mathrm{dom}}} \bar{\Omega}_{\mathrm{o}}^{k}\left(\mu_{g}\right)
\label{20.111}\end{equation}

由相互不相交的开放子域组成 $\Omega_{\mathrm{o}}^{k}\left(\mu_{g}\right)$ 。

!!!!
\Omega_{\mathrm{o}}^{k}\left(\mu_{g}\right) \cap \Omega_{\mathrm{o}}^{k^{\prime}}\left(\mu_{g}\right)=\emptyset, \quad 1 \leq k<k^{\prime} \leq K_{\mathrm{dom}}
$$

如果与用作输入参数的几何属性（例如长度、厚度、直径或角度）有关，参数化映射可以以相当直观的方式定义。我们指出，在结合物理/几何参数化的情况下，领域分解\ref{20.111）不仅可以用于算法目的，以确保良好的映射，而且可以代表不同的物理系数，如第20.9.1节所述的情况。

因此，原始子域和参考子域在一个映射下是相关的$T\left(\cdot ; \mu_{g}\right):$ $\Omega^{k} \rightarrow \Omega_{\mathrm{o}}^{k}\left(\mu_{g}\right), 1 \leq k \leq K_{\mathrm{dom}}$ 。

!!!!
\Omega_{\mathrm{o}}^{k}\left(\mu_{g}\right)=T^{k}\left(\Omega^{k} ; \mu_{g}\right), \quad 1 \leq k \leq K_{\mathrm{dom}}
\label{20.112}\end{equation}

这些映射必须是单独的双射，共同的连续，并且使$T^{k}\left(\mathbf{x} ; \mu_{g}\right)=T^{k^{\prime}}\left(\mathbf{x} ; \mu_{g}\right) \forall \mathbf{x} \in \Omega^{k} \cap \Omega^{k^{\prime}}$，对于$1 \leq k<k^{\prime} \leq K_{\text {dom }}$。这里我们处理更简单的仿生情况，对于任何$\mu \in \mathscr{D}, \mathbf{x} \in \Omega^{k}$来说，转换是由以下方式给出的

!!!!
T_{i}^{k}\left(\mathbf{x}, \mu_{g}\right)=c_{i}^{k}\left(\mu_{g}\right)+\sum_{j=1}^{d} G_{i j}^{k}\left(\mu_{g}\right) x_{j}, 1 \leq i \leq d
\label{20.113}\end{equation}

对于给定的平移矢量$\mathbf{c}^{k}: \mathscr{D}_{g} \rightarrow \mathbb{R}^{d}$和线性变换矩阵$\mathbb{G}^{k}$：$\mathscr{D}_{g} \rightarrow \mathbb{R}^{d \times d}$，也被称为 "映射系数"。线性变换矩阵可以表达旋转、缩放和/或剪切。然后，我们可以定义相关的雅各布系数

!!!!
J^{k}\left(\mu_{g}\right)=\left|\operatorname{det}\left(\mathbb{G}^{k}\left(\mu_{g}\right)\right)\right|, \quad 1 \leq k \leq K_{\text {dom }}
\label{20.114}\end{equation}

通过假设几何变换是仿生的（即由\ref{20.113})$给出的雅各布系数在每个子域的空间中是常数。我们进一步定义，对于任何$\mu_{g} \in \mathscr{D}_{g}$ ,

!!!!
\mathbb{D}^{k}\left(\mu_{g}\right)=\left(\mathbb{G}^{k}\left(\mu_{g}\right)\right)^{-1}, \quad 1 \leq k \leq K_{\mathrm{dom}}
\label{20.115}\end{equation}

这个矩阵将在随后涉及导数的变换中被证明是方便的。在假设映射是可逆的情况下，我们知道\ref{20.114}的雅各布系数$J\left(\mu_{g}\right)$是严格的正数，并且$\mathbb{D}\left(\mu_{g}\right)=!!!!\left(\mathbb{G}\left(\mu_{g}\right)\right)^{-1}$的导数变换矩阵存在。

我们回顾一下，在二维空间中，仿射变换将直线映射为直线，将平行线映射为平行线，实际上将等长的平行线段映射为等长的平行线段：由此可见，三角形映射为三角形，平行四边形映射为平行四边形。我们还记得，一个仿生变换将椭圆映射到椭圆。这些特性对于描述工程背景下的相关领域至关重要，因此，基于标准、椭圆和弯曲三角形的领域分解的分片仿生映射[RHP08]，可以被用来处理更大的几何变化类别，仍然满足对于降低计算复杂性至关重要的亲和性假设。进一步的细节见[RHP08]。

现在让我们对$a_{0}$和$F_{\mathrm{o}}$设置一些条件，以便结合仿生几何假设，确保双线性形式的仿生扩展。与我们在$20.9 .1$节所做的类似。  与我们在$20.9 .1$中对物理参数所做的类似，我们要求$a_{0}(\cdot, \cdot ; \mu)$：$V_{\mathrm{o}} \times V_{\mathrm{o}} \rightarrow \mathbb{R}$被表达为

!!!!
a_{\mathrm{o}}(w, v ; \mu)=\sum_{k=1}^{K_{\mathrm{dom}}} \int_{\Omega_{0}^{k}\left(\mu_{g}\right)}\left[\begin{array}{lll}
\frac{\partial w}{\partial x_{\mathrm{ol}}} & \frac{\partial w}{\partial x_{\mathrm{o} 2}} & w
\end{array}\right] \mathscr{K}_{\mathrm{o}, i j}^{k}\left(\mathbf{x}_{\mathrm{o}} ; \mu_{p}\right)\left[\begin{array}{c}
\frac{\partial v}{\partial x_{\mathrm{ol}}} \\
\frac{\partial v}{\partial x_{\mathrm{o} 2}} \\
v
\end{array}\right] d \Omega_{\mathrm{o}}
\label{20.116}\end{equation}

其中 $\mathbf{x}_{0}=\left(x_{\mathrm{ol}}, x_{\mathrm{o} 2}\right)$ 表示 $\Omega_{\mathrm{o}}\left(\mu_{g}\right)$ 中的一个点。这里，对于 $1 \leq k \leq K_{\mathrm{dom}}, \mathscr{K}_{\mathrm{o}}^{k}: \Omega_{o}^{k} \times \mathscr{D}_{p} \rightarrow \mathbb{R}^{3 \times 3}$ 是给定的矩阵，其组成部分取决于空间坐标和物理参数。如果参数化同时涉及物理和几何元素，矩阵$\mathscr{K}_{\mathrm{o}}^{k}$编码与前者相关的属性；这些术语的含义与第20.9.1节中相同。

同样地，我们要求$F_{\mathrm{o}}(\cdot ; \mu): V_{\mathrm{o}} \rightarrow \mathbb{R}$可以表示为

!!!!
F_{\mathrm{o}}(v ; \mu)=\sum_{k=1}^{K_{\mathrm{dom}}} \int_{\Omega_{0}^{k}\left(\mu_{g}\right)} \mathscr{F}_{\mathrm{o}}^{k}\left(\mathbf{x}_{0} ; \mu_{p}\right) v d \Omega_{\mathrm{o}}
$$

其中，对于$1 \leq k \leq K_{\text {dom }}, \mathscr{F}_{0}^{k}: \Omega_{o}^{k} \times \mathscr{D}_{p} \rightarrow \mathbb{R}$是给定的函数，它可能编码与源项和/或边界数据有关的可能的物理参数。

我们现在将原域上的问题转化为参考域上的等效问题：给定$\mu \in \mathscr{D}$，评估

!!!!
s(\mu)=F(u(\mu))
$$

其中$u(\mu) \in V$满足

!!!!
a(u(\mu), v ; \mu)=F(v ; \mu) \quad \forall v \in V
$$

然后我们可以确定$s(\mu)=s_{0}(\mu)$和$u(\mu)=u_{\mathrm{o}}(\mu) \circ T\left(\cdot ; \mu_{g}\right)$，而

!!!!
a(w, v ; \mu)=\sum_{k=1}^{K_{\mathrm{dom}}} \int_{\Omega^{k}}\left[\begin{array}{lll}
\frac{\partial w}{\partial x_{1}} & \frac{\partial w}{\partial x_{2}} & w
\end{array}\right] \mathscr{K}_{i j}^{k}(\mathbf{x} ; \mu)\left[\begin{array}{c}
\frac{\partial v}{\partial x_{1}} \\
\frac{\partial v}{\partial x_{2}} \\
v
\end{array}\right] d \Omega
\label{20.117}\end{equation}

是转换后的双线性形式。这里的$\mathscr{K}^{k}: \Omega^{k} \times \mathscr{D} \rightarrow \mathbb{R}^{3 \times 3}, 1 \leq k \leq K_{\mathrm{dom}}$,是对称的正定矩阵，其成分既取决于空间坐标$\mathbf{x}=\left(x_{1}, x_{2}\right)$，也取决于参数$\mu=\left(\mu_{p}, \mu_{g}\right) \in \mathscr{D}$ 。

!!!!
\mathscr{K}^{k}(\mathbf{x} ; \mu)=J^{k}\left(\mu_{g}\right) \mathscr{G}^{k}\left(\mu_{g}\right) \mathscr{K}_{\mathrm{o}}^{k}\left(T^{k}\left(\mathbf{x} ; \mu_{g}\right) ; \mu_{p}\right)\left(\mathscr{G}^{k}\left(\mu_{g}\right)\right)^{\mathrm{T}}
\label{20.118}\end{equation}

为$1 \leq k \leq K_{\mathrm{dom}}$ 。矩阵$\mathscr{G}^{k}: \mathscr{D}_{g} \rightarrow \mathbb{R}^{3 \times 3}, 1 \leq k \leq K_{\mathrm{dom}}$，由以下公式给出

!!!!
\mathscr{G}^{k}(\mu)=\left(\begin{array}{cc|c}
\mathbb{D}^{k}\left(\mu_{g}\right) & \begin{array}{l}
0 \\
0
\end{array} \\
\hline 0 & 0 & 1
\end{array}\right)
\label{20.119}\end{equation}

$J^{k}\left(\mu_{g}\right)$和$\mathbb{D}^{k}\left(\mu_{g}\right), 1 \leq k \leq K_{\mathrm{dom}}$ ，分别由\ref{20.114}和\ref{20.115}给出。

同样地，新的线性形式可以表示为

!!!!
F(v ; \mu)=\sum_{k=1}^{K_{\text {dom }}} \int_{\Omega^{k}} \mathscr{F}^{k}(\mathbf{x} ; \mu) v d \Omega
$$

其中$\mathscr{F}^{k}: \Omega^{k} \times \mathscr{D} \rightarrow \mathbb{R}, 1 \leq k \leq K_{\mathrm{dom}}$，由以下公式给出

!!!!
\mathscr{F}^{k}(\mathbf{x} ; \mu)=J^{k}\left(\mu_{g}\right) \mathscr{F}_{\mathrm{o}}^{k}\left(T^{k}\left(\mathbf{x} ; \mu_{g}\right) ; \mu_{p}\right), \quad 1 \leq k \leq K_{\mathrm{dom}}
$$

我们指出，与纯物理参数化\ref{20.110）相比，几何参数化产生了一个类似的但更涉及双线性形式中出现的张量结构。为了在这种情况下恢复双线性形式$a$的仿射展开\ref{20.6），一旦在参考域$\Omega$上读出原始问题，我们可以像物理参数化的情况那样进行。特别是，我们要求几何映射$T\left(\cdot ; \mu_{g}\right)$在每个子域$\Omega^{k}$上是仿射的，即它的形式是\ref{20.113}，并且参数化的物理系数仿射地依赖于物理参数$\mu_{p}$，即它们可以被表达为\ref{20.108）-\ref{20.109）中。在这些条件下，双线性形式满足仿射参数依赖\ref{20.6）；$F$经历了类似的处理。一个同时考虑到几何和物理参数的例子将在本章末尾得到彻底的解释，见第1节。  $20.10$ .

我们最后指出，我们提供的条件是充分的，但不是必要的。例如，我们可以在$\mathscr{K}_{\mathrm{o}}^{k}\left(\mathbf{x}_{0} ; \mu\right)$和$\mathscr{F}_{\mathrm{o}}^{k}\left(\mathbf{x}_{0} ; \mu\right)$中允许对$\mathbf{x}_{0}$的仿生多项式依赖，并且仍然确保在\ref{20.6}形式下的仿生展开；此外，在没有几何变化的情况下，$\mathscr{K}_{\mathrm{o}}^{k}\left(\mathbf{x}_{0} ; \mu\right)$和$\mathscr{F}_{\mathrm{o}}^{k}\left(\mathbf{x}_{0} ; \mu\right)$可以采取$\mathbf{x}_{0}, \mu$中任何 "可分离 "形式 。然而，仿生扩展\ref{20.6}绝不是完全通用的：对于更多涉及的数据参数依赖，必须调用非仿生技术[BNMP04, GMNP07, Roz09]。

\subsection{A working example: a diffusion-convection problem}

为了在一个真实的例子上说明前面的概念，在这一节$^{10}$我们讨论一个稳定的热扩散/对流问题。确切地说，我们考虑热对流与直管中的热扩散相结合，直管壁可以保持均匀的温度绝缘，也可以以热交换为特征。

这个例子描述了一类具有多功能配置的流体设备的传热问题。特别是，作为轴向传输速度场的量度的贝克莱特数（对问题的物理学进行建模），以及管道非绝缘部分的长度，仅仅是为了提取平均温度而可能改变的两个参数。此外，诺伊曼边界条件的不连续性（不同的热通量）和热边界层也是需要研究的有趣现象。

我们考虑图20.6所示的物理域$\Omega_{\mathrm{o}}(\mu)$；所有长度相对于单位长度$\tilde{h}$（维度通道宽度）都是无维度的；此外，让我们表示$\tilde{k}$在管道中流动的空气的维度（热）传导系数，$\tilde{\rho}$其密度和$\tilde{c}_{p}$恒压下的具体热容量。我们引入（热）扩散系数$\tilde{D}=\tilde{k} / \tilde{\rho} \tilde{c}_{p}$，以及贝克莱特数$\mathbb{P e}=\tilde{U} \tilde{h} / \tilde{D}, \tilde{U}$作为对流场的参考尺寸速度（见第12章）。我们考虑$P=2$参数。  $\mu_{1}$是管道非隔热底部的长度（单位热流），而$\mu_{2}$代表贝氏数本身；参数域由$\mathscr{D}=[1,10] \times[0.1,100]$给出。

解决方案$u(\mu)$ ，定义为非维度温度$u(\mu)=(\tau(\mu)-$ $\left.\tau_{i n}\right) / \tau_{i n}$（其中$\tau(\mu)$是维度温度，$\tau_{i n}$是空气在流入口和风道第一部分的维度温度），满足以下条件
 ![](https://cdn.mathpix.com/cropped/991f5db518e324d299c1ff4972bba9fb-269.jpg?height=174&width=682&top_left_y=854&top_left_x=110)

图20.6.参数化的几何形状和域的边界

10 在整个章节中，$\Omega_{0}(\mu)$表示原始（物理）域，其通用点由$\left(x_{1}, x_{2}\right)$表示；为了简单起见，我们在原始域中制定所有问题，但去掉了下标o。 此外，twiddle表示维量，而没有它则表示非维量。

!!!!
\left\{\begin{aligned}
-\frac{1}{\mu_{2}} \Delta u(\mu)+x_{2} \frac{\partial}{\partial x_{1}} u(\mu) &=0 & & \text { in } \Omega_{\mathrm{o}}(\mu) \\
\frac{1}{\mu_{2}} \frac{\partial u}{\partial n}(\mu) &=0 & & \text { on } \Gamma_{1} \cup \Gamma_{3} \\
\frac{1}{\mu_{2}} \frac{\partial u}{\partial n}(\mu) &=1 & & \text { on } \Gamma_{2} \\
u(\mu) &=0, & & \text { on } \Gamma_{4} \cup \Gamma_{5} \cup \Gamma_{6}
\end{aligned}\right.
$$

用重复指数求和$(i, j=1,2)$；因此，我们规定了顶壁和管道 "流入 "区的温度$\left(\Gamma_{6}\right)$，而我们考虑隔热墙（$\Gamma_{1}$和$\Gamma_{3}$上的热通量为零）或其他边界上的固定速率的热交换（即$\Gamma_{2}$上的一个）。我们注意到，强制对流场是由线性速度曲线$x_{2} \tilde{U}$给出的（库伊特型流，[Pan05]）。

感兴趣的输出是管道底壁非绝缘部分的流体的平均温度，由以下公式给出

!!!!
s(\mu)=T_{\mathrm{av}}(\mu)=\frac{1}{\mu_{1}} \int_{\Gamma_{2}} u(\mu)
\label{20.120}\end{equation}

然后这个问题被映射到固定的参考域$\Omega$，并被具有片状线性元素的Galerkin FEM离散化；相应空间的尺寸为$N_{h}=5433$ 。由于我们处在一个不符合要求的情况下，为了获得更好的输出评估和相应的误差界限，必须解决一个进一步的对偶问题，见第20.8节。特别是，我们在图$20.7$中显示了与我们问题相关的双线性形式的矫顽常数的下限。

我们在图$20.8$中绘制了贪婪算法对原始问题和对偶问题的收敛情况；在固定的容限下$\varepsilon_{\text {tol }}^{*}=10^{-2}, N_{p r, \max }=21$和$N_{d u, \max }=30$分别选择了基函数。

在图$20.9$中，显示了原始问题的选定参数值$S_{N_{p r}}$和对偶问题的$S_{N_{d u}}$；在每种情况下，$\Xi_{\text {train }}$是一个大小为$n_{\text {train }}=1000$的均匀随机样本。

此外，在图$20.10$中报告了一些有代表性的解决方案（为$\left.N=N_{\max }\right)$计算的选定参数值。

热边界层在这四种情况下看起来非常不同。特别是，温度的巨大变化，以及沿下壁的大梯度--在高佩切特数的情况下是显著的，此时强迫对流支配着稳定的传导；此外，边界层宽度的标准行为--通常由$O(1 / \mathbb{P e})-$给出，被正确捕捉到。

在图$20.11$中，感兴趣的输出的RB评价（对于$\left.N=N_{\max }\right)$）被报告为参数的函数，以及相应的误差界限。我们可以看到，对于$\mu_{2}$的低值（Péclet数），输出对$\mu_{1}$的依赖性。

![](https://cdn.mathpix.com/cropped/991f5db518e324d299c1ff4972bba9fb-271.jpg?height=401&width=557&top_left_y=113&top_left_x=180)

图20.7.矫顽力常数$\alpha_{\mathrm{LB}}^{N_{h}}(\mu)$的下限作为$\mu$的函数
 ![](https://cdn.mathpix.com/cropped/991f5db518e324d299c1ff4972bba9fb-271.jpg?height=390&width=718&top_left_y=598&top_left_x=94)

图20.8.相对误差$\max _{\mu \in \mathbb{E}_{\text {train }}}\left(\Delta_{N_{p r}}(\mu) /\left\|u_{N_{p r}}(\mu)\right\|_{X}\right)$和$\max _{\mu \in \Xi_{\text {train }}}\left(\Delta_{N_{d u}}(\mu) /\right.$ $\left.\left\|\psi_{N_{d u}}(\mu)\right\|_{X}\right)$分别作为$N^{p r}$和$N^{d u}$的函数，用于贪婪程序中计算的$\mathrm{RB}$近似值，用于原始（左）和对偶（右）问题。这里$\Xi_{\text {train }}$是大小为$n_{\text {train }}=1000$的均匀随机样本，RB容忍度为$\varepsilon_{\mathrm{tol}}^{*}=10^{-2}$ 。

(几何方面)是相当温和的；对于$\mu_{2}$的高值，相反，输出显示出相对于$\mu_{1}$的较大变化。同样，对于较长/较短的通道，对贝克莱特数的依赖性更高/更低。
 ![](https://cdn.mathpix.com/cropped/991f5db518e324d299c1ff4972bba9fb-272.jpg?height=258&width=712&top_left_y=113&top_left_x=100)

图20.9.在参数空间中，原始参数$S_{N_{p r}}$（左）和对偶参数$S_{N_{d u}}$（右）的选定参数值

![](https://cdn.mathpix.com/cropped/991f5db518e324d299c1ff4972bba9fb-272.jpg?height=239&width=351&top_left_y=454&top_left_x=94)
 ![](https://cdn.mathpix.com/cropped/991f5db518e324d299c1ff4972bba9fb-272.jpg?height=240&width=726&top_left_y=454&top_left_x=94) $(10,100)$ (bottom)

![](https://cdn.mathpix.com/cropped/991f5db518e324d299c1ff4972bba9fb-272.jpg?height=224&width=297&top_left_y=777&top_left_x=124)

![](https://cdn.mathpix.com/cropped/991f5db518e324d299c1ff4972bba9fb-272.jpg?height=224&width=297&top_left_y=774&top_left_x=494)
 ![](https://cdn.mathpix.com/cropped/991f5db518e324d299c1ff4972bba9fb-272.jpg?height=226&width=666&top_left_y=774&top_left_x=124) in the parameter space

最后，我们在表$20.1$中收集了与这里考虑的RB近似值有关的所有数据。

在结束本章之前，我们提醒读者，减基方法，以及更普遍的计算减基技术，仍然是一个快速发展的研究领域。表20.1.所介绍的测试案例的数字细节。RB空间是通过贪婪程序建立的，使用了一个公差$\varepsilon_{\mathrm{tol}}^{\mathrm{RB}}=10^{-2}$和一个大小为$\mathrm{RB}$的均匀的贪婪训练样本。报告了在线$\mathrm{RB}$评估和相应的FE模拟之间的计算时间比较。这里$t_{R B}^{\text {offline }}$是离线$\mathrm{RB}$构建和存储的时间，$t_{R B}^{\text {online }}$是在线$\mathrm{RB}$计算的时间，而$t_{F E}$是FE计算的时间，一旦FE矩阵构建完毕

\begin{tabular}{lc}。
\Approximation data & ǞǞ
\Number of parameters $P$ & 2 （参数数量）。
Affine op.component $Q_{a}$ & 4 `Affine rhs components
Affine rhs components $Q_{f}$ & 1 （Affine rhs组件）。
FE空间尺寸。  $\mathscr{N}$ & 5433 \\
RB primal space dim.  $N_{\max }^{p r}$ & 21 \\
RB dual space dim.  $N_{\max }^{d u}$ & 30 \\
\hline
\end{tabular}

\begin{tabular}{lc}。
\hline Approximation data & 호환성
\RB construction $t_{R B}^{\text {offline }}$ (s) & $362.8 \mathrm{~s}$ （RB建设）。
RB evaluation $t_{R B}^{\text {online }}(\mathrm{s})$ & $0.107 \mathrm{~s}$ （RB评价）。
FE评价$t_{F E}(\mathrm{~s})$和$14.3$。
Computational speedup $\mathscr{S}$ & 133 （计算速度加快
Break-even point $\mathscr{Q}_{B E}$ & 26 （平衡点）。
&
\end{tabular}

在这一章中，我们提供了一个简短的介绍，指出了建立减基方法所需的所有基本要素，即使只是针对稳定、椭圆、胁迫PDEs的简单情况。在过去的十年中，RB方法和更普遍的计算还原技术已经被应用于一些由非参数化和/或非线性和/或非胁迫和/或时间依赖性问题所模拟的问题（例如见[AF12, AZF12]），如Stokes[RHM13]和Navier-Stokes[VP05, QR07]流，弹性问题等等。关于这些问题类别的最新调查，以及关于其他计算还原技术，可以在[QR13] 中找到。

\section{Exercises}

1.证明性质19.1；按照以下步骤进行（为简单起见，我们省略对$\mu$的依赖）。

(i) 将(19.63)改写为

!!!!
\left(\mathbb{A}_{h} \mathbb{V} \mathbf{u}_{N}, \mathbb{A}_{h} \mathbb{V} \mathbf{v}_{N}\right)_{2}=\left(\mathbf{f}_{h}, \mathbb{A}_{h} \mathbb{V} \mathbf{v}_{N}\right)_{2} \quad \forall \mathbf{v}_{N} \in \mathbb{R}^{N}
$$

(ii) 通过使用双射\ref{19.44} 并观察到$\left(\mathbb{V} \mathbf{v}_{N}\right)^{(p)}=\left(v_{N}, \varphi^{p}\right)_{h}$，表明

!!!!
\left(\mathbb{A}_{h} \mathbb{V} \mathbf{v}_{N}, \mathbf{z}_{h}\right)_{2}=a\left(v_{N}, z_{h}\right) \quad \forall \mathbf{v}_{N} \in \mathbb{R}^{N}, \mathbf{z}_{h} \in \mathbb{R}^{N_{h}}
$$

其中 $z_{h}=I_{h} \mathbf{z}_{h} \in V^{N_{h}}$ ，即 $z_{h}(\mathbf{x})=\sum_{r=1}^{N_{h}} z_{h}^{(r)} \varphi^{r}(\mathbf{x})$ 和 $v_{N}=I_{N} \mathbf{v}_{N} \in V_{N}$ 。

即$v_{N}(\mathbf{x})=\sum_{k=1}^{N} v_{N}^{(k)} \zeta_{k}(\mathbf{x})$ 。

(iii) 定义$\mathbf{y}_{h}=\mathbf{y}_{h}\left(\mathbf{v}_{N}\right)=\mathbb{A}_{h} \mathbb{V} \mathbf{v}_{N} \in \mathbb{R}^{N_{h}} ;$，那么

!!!!
\left(\mathbf{f}_{h}, \mathbb{A}_{h} \mathbb{V} \mathbf{v}_{N}\right)_{2}=\left(\mathbf{f}_{h}, \mathbf{y}_{h}\left(\mathbf{v}_{N}\right)\right)_{2}
$$

注意，$y_{h}\left(\mathbf{v}_{N}\right)=I_{h} \mathbf{y}_{h}\left(\mathbf{v}_{N}\right) \in V_{h}$是这样的，即

!!!!
\left(y_{h}\left(\mathbf{v}_{N}\right), z_{h}\right)_{h}=\left(\mathbf{y}_{h}\left(\mathbf{v}_{N}\right), \mathbf{z}_{h}\right)_{2}=\left(\mathbb{A}_{h} \mathbb{V} \mathbf{v}_{N}, \mathbf{z}_{h}\right)_{2} \quad \forall z_{h} \in V^{N_{h}}
$$

并通过使用（ii），表明$y_{h}\left(\mathbf{v}_{N}\right)$满足\ref{19.67} 。

(iv) 显示

!!!!
\left(\mathbf{f}_{h}, \mathbf{y}_{h}\left(\mathbf{v}_{N}\right)\right)_{2}=\left(f_{h}, y_{h}\left(\mathbf{v}_{N}\right)\right)_{h}=f\left(y_{h}\left(\mathbf{v}_{N}\right)\right),
$$

其中$f_{h}=I_{h} \mathbf{f}_{h} \in V^{N_{h}}$，即$f_{h}(\mathbf{x})=\sum_{r=1}^{N_{h}} f_{h}^{(r)} \varphi^{r}(\mathbf{x})$，和$f_{h}^{(r)}=f\left(\varphi^{r}\right)$（五）最后，恢复以下变异形式。

!!!!
a\left(u_{N}, y_{h}\left(v_{N}\right)\right)=f\left(y_{h}\left(v_{N}\right)\right) \quad \forall v_{N} \in V_{N}
$$

2.通过引入拉格朗日函数

!!!!
L\left(\mathbf{z}_{1}, \ldots, \mathbf{z}_{N}, \tilde{\lambda}_{11}, \ldots, \tilde{\lambda}_{i j}, \ldots, \tilde{\lambda}_{N N}\right)=E\left(\mathbf{z}_{1}, \ldots, \mathbf{z}_{N}\right)+\sum_{i, j=1}^{N} \tilde{\lambda}_{i j}\left(\mathbf{z}_{i}^{T} \mathbf{z}_{j}-\delta_{i j}\right)
$$

并写出一阶必要最优条件，表明问题\ref{20.74} 的解满足\ref{20.72} ，特别是。

!!!!
\mathbb{U}^{T} \mathbb{U} \psi_{i}=\sigma_{i}^{2} \psi_{i} \quad i=1, \ldots, r
$$

此外，通过表示$\lambda_{i}=\tilde{\lambda}_{i i}$，表明

!!!!
\lambda_{i}=\sigma_{i}^{2}=\sum_{j=1}^{n_{\text {train }}}\left(\mathbf{u}_{j}^{T} \zeta_{i}\right)^{2}
$$

此外，表明

!!!!
\sum_{i=1}^{n_{\text {train }}}\left\|\mathbf{u}_{i}-\sum_{j=1}^{k}\left(\mathbf{u}_{i}^{T} \zeta_{j}\right) \zeta_{j}\right\|_{2}^{2}=\sum_{i=1}^{n_{\text {train }}} \sum_{j=N+1}^{r}\left(\mathbf{u}_{i}^{T} \zeta_{j}\right)^{2}=\sum_{i=N+1}^{r} \lambda_{i}
$$

因此，\ref{20.75} 。

3.通过考虑参数化的双线性形式\ref{20.106}

!!!!
\begin{aligned}
&a\left(w, v ; \mu_{p}\right)=K_{11}\left(\mu_{p}\right) \int_{\Omega} \psi_{11}(x) \frac{\partial w}{\partial x_{1}} \frac{\partial v}{\partial x_{1}} d \Omega \\
&\quad+K_{12}\left(\mu_{p}\right) \int_{\Omega} \psi_{12}(x) \frac{\partial w}{\partial x_{1}} \frac{\partial v}{\partial x_{2}} d \Omega+\cdots+\mathscr{K}_{33}\left(\mu_{p}\right) \int_{\Omega} \psi_{33}(x) w v d \Omega
\end{aligned}
\label{20.121}\end{equation}

恢复仿生展开\ref{20.6）。仿生展开是由多少个项（最多）组成的？现在做同样的事情，但对于分成$K_{\text {reg regions, each }}$的域，与不同的物理性质有关。4.4. 参考第20.1.1节中的问题（热块），考虑一个各向异性的导电性的例子。每个块上的相关双线性形式为

!!!!
a^{q}(w, v ; \mu)=\sum_{i, j=1}^{2} \mu_{x_{i} x_{j}}^{q} \int_{\mathscr{R}_{q}} \frac{\partial w}{\partial x_{i}} \frac{\partial v}{\partial x_{j}} d \Omega
\label{20.122}\end{equation}

其中$\left\{\mu_{x_{i} x_{j}}^{q}, i, j=1,2\right\}$代表在块$\mathscr{R}_{q}$中模拟各向异性热传递的电导率。提供参数化问题的弱式表述；通过像(20.13)那样的仿射分解来表达$a(w, v ; \mu)$，并指出a)$B_{1}=B_{2}=3$、b)$B_{1}=!!!!B_{2}=5$和c)$B_{1}=3$和$B_{2}=5$情况下的参数总数$P$和数量$Q_{a}$ 。

5. a) 考虑第$20.1 .1$节的热力块的几何参数化。  [a. 考虑第$20.1 .1$节的热力模块的几何参数化，基于文本中已经提供的带有$P=8$物理参数（即$\mu_{s}$为$\left.s=1, \ldots, 8\right)$，代表每个子块中的各向同性的热传递。考虑$3 \times 3$子块的情况，有额外的$P_{g}=6$几何参数（即$\mu_{x_{1}}^{i}$和$\mu_{x_{2}}^{i}$为$\left.i=1,2,3\right)$ 。热块的长度在$x_{1}$方向为$\mu_{x_{1}}^{1}+\mu_{x_{1}}^{2}+\mu_{x_{1}}^{3}=1$，在$x_{2}$方向为$\mu_{x_{2}}^{1}+\mu_{x_{2}}^{2}+\mu_{x_{2}}^{3}=1$；这样，第一个子块$\mathscr{R}_{1}$（见图20.1）具有尺寸$\mu_{x_{1}}^{1} \times \mu_{x_{2}}^{1}$，而子块$\mathscr{R}_{9}$具有尺寸$\mu_{x_{1}}^{3} \times \mu_{x_{2}}^{3}$ 。以$a(w, v ; \mu)$给出的形式写出\ref{20.13}的完整表述，并指出形式$a^{q}(w, v ; \mu)$的数量$Q_{a}$。然后报告所有依赖参数的函数$\Theta^{q}(\mu)$的完整公式，以物理参数（即$\mu_{s}$的$\left.s=1, \ldots, 8\right)$和几何参数（即$\mu_{x_{1}}^{i}$和$\mu_{x_{2}}^{i}$）的形式。

b) 通过尊重给定的约束条件（即$\mu_{x_{1}}^{1}+\mu_{x_{1}}^{2}+\mu_{x_{1}}^{3}=1$和$\left.\mu_{x_{2}}^{1}+\mu_{x_{2}}^{2}+\mu_{x_{2}}^{3}=1\right)$以及热块配置的一致性，并通过避免某些元素的几何退化$\mathscr{R}_{q}$，提出每个几何参数的变化范围。

6.a) 考虑第1节的平流-扩散例子。  $20.10$，写出问题\ref{20.120）的弱表述，定义在原始域上。

b) 提出一个合适的$\Omega$的域分解，并定义一组仿射图，以描述每个子域上的几何变形，考虑$\mu_{\mathrm{ref}}=(1,1)$，它反过来定义了参考域$\Omega=\Omega_{\mathrm{o}}\left(\mu_{\mathrm{ref}}\right)$。然后写出参考域$\Omega$上相应的弱表述。

c) 描述对解$\left\|u_{h}(\mu)-u_{N}(\mu)\right\| \mu$的误差（能量准则）的后验估计$\Delta_{N}^{\text {en }}(\mu)$的表达，以及对输出$\left|s_{h}(\mu)-s_{N}(\mu)\right|, s(\mu)$的后验估计$\Delta_{N}^{S}(\mu)$的表达，即在\ref{20.120}中定义的数量。

a) 考虑第1节的稳定斯托克斯问题$16.2$（公式\ref{16.12} ）和第16.6节的盖子驱动的空腔流动。  $16.2$（公式\ref{16.12} ）和第16.6节的盖子驱动的空腔流动。作为腔体的可能几何参数，长宽比$\mu=L / D$ ，其中$L$是腔体的长度，$D$是腔体的高度。

b) Stokes问题的减基近似空间是由速度的$V_{N, \mathbf{u}}=\left\{\mathbf{u}_{h}\left(\mu^{n}\right), \sigma_{h}\left(\mu^{n}\right), 1 \leq n \leq N\right\} \subset V_{\mathbf{u}}^{N_{h}}$和压力的$V_{N, p}=$ $\left\{p_{h}\left(\mu^{n}\right), 1 \leq n \leq N\right\} \subset V_{p}^{N_{h}}$给出的，其中，对于$N$所选的$\mu^{n}, \mathbf{u}_{h}\left(\mu^{n}\right)$和$p_{h}\left(\mu^{n}\right)$分别代表速度和压力的有限元解，$\sigma_{h}\left(\mu^{n}\right) \in V_{\mathbf{u}}^{N_{h}}$是一个辅助问题的解，称为至上问题，在原域中读作

!!!!
\int_{\Omega_{0}} \nabla \sigma_{h} \cdot \nabla \mathbf{v} d \Omega=\int_{\Omega_{0}} p_{h}\left(\mu^{n}\right) \operatorname{div}(\mathbf{v}) d \Omega \quad \forall \mathbf{v} \in V_{\mathbf{u}}^{N_{h}}
\label{20.123}\end{equation}

上位机对速度空间的充实保证了RB近似的稳定性和满足等效的$\inf$ -sup条件（见[RV07, RHM13]）。

写出斯托克斯问题的减基公式；观察从RB Galerkin投影得到的代数系统具有块状结构。观察到这次的矩阵是满的，与有限元方法的情况相反。

c) 做同样的练习，考虑纳维-斯托克斯方程的稳定版本（第16.1节），也包括仿生变换和随后的三线对流项的参数化（第16.7节）$c(\mathbf{w}, \mathbf{z}, \mathbf{v} ; \mu)$ ，例如，在[VP05, QR07]中考虑。

\section{References}

$\left[\mathrm{AAH}^{+} 98\right]$ Achdou Y., Abdoulaev G., Hontand $\mathrm{J}$ ., Kuznetsov Y., Pironneau O., and Prud'homme C. (1998) Nonmatching grid for fluids.In Domain Decomposition Methods, 10 (Boulder; $\mathrm{CO}$ , 1997), volume 218 of Contemp.Math., pages 3-22.Amer.Math.Soc., Providence, RI.

[ABBS17] Antolin P., Bressan A., Buffa A., and Sangalli G. (2017) An isogeometric method for linear nearly incompressible elasticity with local stress projection.Comput.Methods Appli.Mech.工程。316: 694-719.

$\left[\mathrm{ABC}^{+} 08\right] \quad$ Akkerman I., Bazilevs Y., Calo V., Hughes T., and Hulshoff S. (2008) The role of continuity in residual based variational multiscale modeling of turbulence.Comput.Mech.41(3): 371-378.

[ABCM02] Arnold D. N., Brezzi F., Cockburn B., and Marini L. D. (2001/02) Unified analysis of discontinuous Galerkin methods for elliptic problems.SIAM J. Numer.分析。39(5): 1749-1779.

$\left[\mathrm{ABH}^{+} 10\right] \quad$ Auricchio F., Beirão da Veiga L., Hughes T., Reali A., and Sangalli G. (2010) Isogeometric collocation methods.Math.Models Meth.Appl. Sci. 20(11): 2075 $2107$ 。

[ABKF11] Akkerman I., Bazilevs Y., Kees C., and Farting M. (2011) Isogeometric analysis of free-surface flow.J. Comput.物理学》230(11)。  $4137-4152$ .

[ABM09] Antonietti P. F., Brezzi F., and Marini L. D. (2009) Bubble stabilization of discontinuous Galerkin methods.Comput.Methods Appl. Mech.Engrg.198(21-26):  $1651-1659$ .

$\left[\mathrm{ACH}^{+} 12\right] \quad$ Auricchio F., Calabrò F., Hughes T., Reali A., and Sangalli G. (2012) A simple algorithm for obtaining nearly optimal quadrature rules for NURBS based Isogeometric Analysis.Comput.Methods Appli.Mech.Eng. 249-252: 15-27.

[Ada75]

Adams R. A. (1975) Sobolev Spaces.Academic Press, New York.

[AF03]

Adams R. A. and Fournier J. J. F. (2003) Sobolev Spaces Academic Press.

[AF12] Amsallem D. and Farhat C. (2012) Stabilization of projection-based reducedorder models.Int.J. Numer.91(4): 358-377.

[AFG $\left.^{+} 00\right] \quad$ Almeida R. C., Feijóo R. A., Galeão A. C., Padra C., and Silva R. S. (2000) Adaptive finite element computational fluid dynamics using an anisotropic error estimator.Comput.Methods Appl. Mech.Engrg.182:379-400.

[Ago03] Agoshkov V. (2003) Optimal Control Methods and Adjoint Equations in Mathematical Physics Problems.俄罗斯科学院数值数学研究所，莫斯科。

[Aki94] Akin J. E. (1994) Finite Elements for Analysis and Design.学术出版社，伦敦。

[AM09] Ayuso B. and Marini L. D. (2009) Discontinuous Galerkin methods for advectiondiffusion-reaction problems.SIAM J. Numer.Anal.47(2):  $1391-1420$ .

[AMW99] Achdou Y., Maday Y., and Widlund O. (1999) Iterative substructuring preconditioners for mortar element methods in two dimensions.SIAM J. Numer.Anal.36(2):  $551-580$（电子版）。

[AO00] Ainsworth M. and Oden J. T. (2000) A posteriori error estimation in finite element analysis.纯粹与应用数学。John Wiley and Sons, New York.

[Ape99] Apel T. (1999) Anisotropic Finite Elements:局部估计和应用。书籍系列。Advanced in Numerical Mathematics.Teubner, Stuttgart.

[APV98] Achdou Y., Pironneau O., and Valentin F. (1998) Équations aux dérivées partielles et applications, chapter Shape control vers the boundary control, pages 118.Éd.Sci. Méd.Elsevier，巴黎。

[Arn82] Arnold D. N. (1982) An interior penalty finite element method with discontinuous elements.SIAM J. Numer.分析。19(4): 742-760.

[AS55] Allen D. N. G. and Southwell R. V. (1955) Relaxation methods applied to determine the motion, in two dimensions, of a viscous fluid past a fixed cylinder.Quart.J. Mech.Appl.Math.8: 129-145.

[AS99] Adalsteinsson D. and Sethian J. A. (1999) The fast construction of extension velocities in level set methods.J. Comput.物理学》148(1): 2-22.

[ATF87] Alekseev V., Tikhominov V., and Fomin S. (1987) Optimal Control.顾问局，纽约。

[Aub67] Aubin J. P. (1967) Behavior of the error of the approximate solutions of boundary value problems for linear elliptic operators by Galerkin's and finite difference methods.Ann.Scuola Norm.Sup. Pisa 21: 599-637.

[Aub91] Aubry N. (1991) On the hidden beauty of the proper orthogonal decomposition.\T h e o r ... ...Mathrm{{}.~ C o m p .~ F l u i d .~ D y n .~ 2 :~3 3 9 - 3 5 2 .~

[AWB71] Aziz A., Wingate J., and Balas M. (1971) Control Theory of Systems Governed by Partial Differential Equations.学术出版社。

[AZF12] Amsallem D., Zahr M., and Farhat C. (2012) Nonlinear model order reduction based on local reduced-order base.Int.J. Numer.Methods Engr. $92(10): 891-$ $916$ 。

[Bab71] Babuška I. (1971) 有限元方法的误差界限。Numer.Math.16: 322-333.

[BBC $\left.^{+} 06\right]$ Bazilevs Y., Beirão da Veiga L., Cottrell J., Hughes T., and Sangalli G. (2006) Isogeometric Analysis: approximation, stability, and error estimates for $h$ -refinedmeshes.Math.Models Meth.Appl. Sci. 16(7): 1031-1090.

[BBF13] Boffi D., Brezzi F. and Fortin M. (2013) Mixed Finite Element Methods and Applications, Springer.

[BBHH10] Benson D., Bazilevs Y., Hsu M.-C., and Hughes T. (2010) Isogeometric shell analysis:Reissner-Mindlin壳。Comput.Methods Appli.Mech.工程。199(5): 276-289.

[BBHH11] Benson D., Bazilevs Y., Hsu M.-C., and Hughes T. (2011) A large deformation, rotfree, isogeometric shell.Comput.Methods Appli.Mech.工程。 200(13): 1367-1378。

[BBRS11] Beirão da Veiga L., Buffa A., Rivas J., and Sangalli G. (2011) Some estimates for h-p-k-refinement in Isogeometric Analysis.Numer.Mathematik $118(2)$ : $271-$ $305$ 。  [BC13] Bornemann P. and Cirak F. (2013) A subdivision-based implementation of the hierarchical B-spline finite element method.Comput.Methods Appli.Mech.Eng. 253: 584-598.

[BCC $\left.^{+} 10\right]$ Bazilevs Y., Calo V., Cottrell J., Evans J., Hughes T., Lipton S., Scott M., and Sederberg T. (2010) Isogeometric analysis using T-splines.Comput.Methods Appli.Mech.工程。199(5-8): 229-263.

$\left[\mathrm{BCD}^{+} 11\right] \quad$ Binev P., Cohen A., Dahmen W., DeVore R., Petrova G., and Wojtaszczyk $\mathrm{P}$ 。(2011)减基方法中贪婪算法的收敛率。SIAM J. Math.Anal.43(3): 1457-1472.

[BCS10] Buffa A., Cho D., and Sangalli G. (2010) 与某些特定T-meshes有关的T-spline混合函数的线性独立性。Comput.Methods Appli.Mech.工程。199(23-24): 1437-1445.

[BCZH06] Bazilevs Y., Calo V., Zhang Y., and Hughes T. (2006) Isogeometric fluid-structure interaction analysis with applications to arterial blood flow.Comput.Mech.38(45):  $310-322$ .

[BDQ15] Bartezzaghi A., Dedè L., and Quarteroni A.(2015) Isogeometric Analysis for high order Partial Differential Equations on surfaces.Comput.Methods Appli.Mech.Eng. 295:446-469.

[BDQ16] Bartezzaghi A., Dedè L., and Quarteroni A.(2016) Isogeometric Analysis of geometric partial differential equations.Comput.Methods Appli.Mech.Eng.311:  $625-647

[BDR92] Babuška I., Durán R., and Rodríguez R. (1992) Analysis of an a posteriori error estimator for linear triangular finite elements.SIAM J. Numer.分析。29(4): 947-964.

[BE92] Bern M. and Eppstein D. (1992) Mesh generation and optimal triangulation.In Du D.-Z. and Hwang F. (eds) Computing in Euclidean Geometry.世界科学，新加坡。

[Bec01] Becker R. (2001) Mesh adaptation for stationary flow control.J. Math.Fluid Mech.3: 317-341.

[BHS12] Bazilevs Y., Hsu M.-C., and Scott M. (2012) Isogeometric fluid-structure interaction analysis with emphasis on nonmatching discretizations, and with application to wind turbines.Comput.Methods Appli.Mech.Eng. 249-252: 28-41.

[Bel99] Belgacem F. B. (1999) The mortar finite element method with Lagrange multipliers.Numer.Math.84(2): 173-197.

[BEMS07] Burman E., Ern A., Mozolevski I., and Stamm B. (2007) 对称的非连续Galerkin方法在一维中不需要稳定化的多项式阶数 $p \geq 2$ 。C. R. Math.Acad.Sci. Paris 345(10): 599-602.

[BF91a] Brezzi F. and Fortin M. (1991) Mixed and Hybrid Finite Element Methods.Springer-Verlag, New York.

[BF91b] Brezzi F. and Fortin M. (1991) Mixed and Hybrid Finite Element Methods, volume 15 of Springer Series in Computational Mathematics.Springer-Verlag, New York.

[BFHR97] Brezzi F., Franca L. P., Hughes T. J. R., and Russo A. (1997) $b=\int g$ 。计算。Methods Appl. Mech.Engrg.145: 329-339.

[BG87] Brezzi F. and Gilardi G. (1987) Functional Analysis and Functional Spaces.McGraw Hill，纽约。

[BG98] Bernardi C. and Girault V. (1998) A local regularisation operator for triangular and quadrilateral finite elements.SIAM J. Numer.分析。  $35(5)$ : $1893-1916$ 。

[BGL05] Benzi M., Golub G. H., and Liesen J. (2005) Numerical solution of saddle point problems.Acta Numer.14: 1-137.  [BGL06a] Burkardt J., Gunzburger M., and Lee H. (2006) Centroidal voronoi tessellation based reduced-order modeling of complex systems.SIAM J. Sci. Comput.  $28(2)$ : 459-484.

[BGL06b] Burkardt J., Gunzburger M., and Lee H. (2006) POD and CVT-based reduced order modeling of Navier-Stokes flows.Comput.Meth.Appl. Mech.Engrg.  $196(1-3):$ 337-355.

[BGS96] Bjòrstad P., Gropp P., and Smith B. (1996) Domain Decomposition, Parallel Multilevel Methods for Elliptic Partial Differential Equations.Univ. Cambridge Press, Cambridge.

[BHL93] Berkooz G., Holmes P., and Lumley J. (1993) The proper orthogonal decomposition in analysis of turbulent flows.Annu.Rev. Fluid Mech.  $25(1): 539-575$ .

[BHS06] Buffa A., Hughes T. J. R., and Sangalli G. (2006) Analysis of a multiscale discontinuous Galerkin method for convection-diffusion problems.SIAM J. Numer.分析。44(4): 1420-1440.

[BIL06] Berselli L. C., Iliescu T., and Layton W. J. (2006) Mathematics of Large Eddy Simulation of Turbulent Flows。Springer, Berlin Heidelberg.

[BLR12] Beirão da Veiga L., Lovadina C., and Reali A. (2012) 通过等距配位方法避免蒂莫申科梁问题的剪切锁定。Comput.Methods Appli.Mech.工程 241: 38-51.

[BKR00] Becker R., Kapp H., and Rannacher R. (2000) Adaptive finite element methods for optimal control of partial differential equations:基本概念。SIAM, J. Control Opt. 39 (1):  $113-132$ .

[Bla02] Blanckaert K. (2002) Flow and turbulence in sharp open-channel bends。博士论文，洛桑联邦理工学院。

[BLM14] Beirao da Veiga L., Lipnikov K. and Manzini G. (2014) The mimetic finite difference method for elliptic problems, MS/A Series, volume 11, Springer。

[BM92] Bernardi C. and Maday Y. (1992) Approximations Spectrales de Problèmes aux Limites Elliptiques.Springer-Verlag, Berlin Heidelberg.

[BM94] Belgacem F. B. and Maday Y. (1994) A spectral element methodology tuned to parallel implementationations.Comput.Methods Appl. Mech.Engrg.116(1-4): 59-67.ICOSAHOM'92（蒙彼利埃，1992）。

[BM06] Brezzi F. and Marini L. D. (2006) Bubble stabilization of discontinuous Galerkin methods.In Advances in numerical mathematics, Proceedings International Conference on the occasion of 60 th birthday of Y.A. Kuznetsov, September 16-17, 2005, pages 25-36.俄罗斯科学院数值数学研究所，莫斯科。

[BMMP06] Bottasso C. L., Maisano G., Micheletti S., and Perotto S. (2006) On some new recovery based a posteriori error estimators.Comput.Methods Appl. Mech.Engrg.  $195(37-40):$ 4794-4815.

[BMP94] Bernardi C., Maday Y., and Patera A. (1994) A new nonconforming approach to domain decomposition: the mortar element method.In Nonlinear partial differential equations and their applications.Collège de France Seminar; Vol. XI (Paris, 1989-1991), volume 299 of Pitman Res. Notes Math.Ser，第13-51页。Longman Sci. Tech., Harlow.

[BMP$^{+}$12] 。  Buffa A., Maday Y., Patera A. T., Prud'homme C., and Turinici G. (2012) A priori convergence of the greedy algorithm for the parametrized reduced basis method.ESAIM Math.模型。Numer.分析。  $46(3)$ : $595-603$ 。

[BMS04] Brezzi F., Marini L. D., and Süli E. (2004) Discontinuos Galerkin methods for first-order hyperbolic problems.Math.14: $1893-$ $1903$ 。  [BN83] Boland J. and Nicolaides R. (1983) Stability of finite elements under divergence constraints.SIAM J. Numer.Anal.20: 722-731.

[BNMP04] Barrault M., Nguyen N. C., Maday Y., and Patera A. T. (2004) An "empirical interpolation" method:应用于偏微分方程的高效减基离散化。C. R. Acad.Sci. Paris, Série I. 339: 667-672.

[BO06] Benzi M. and Olshanskii M. (2006) An augmented lagrangian based approach to the oseen problem.SIAM J. on Scientific Computing 28 (6): 2095-2113.

[Bre15] Brezzi F.(2015) The great beauty of VEMs, ProceedingsICM 1: 214-235 (2014).  [BSV14] Buffa A., Sangalli G., and Vázquez R. (2014) Isogeometric methods for computational electromagnetics:B-spline和T-spline离散化。J. Comput.Phys.257, Part B: 1291-1320.

[BVS$^{+}$12] 。Borden M., Verhoosel C., Scott M., Hughes T., and Landis C. (2012) A phasefield description of dynamic brittle fracture.Comput.Methods Appli.Mech.工程。217-220: 77-95。

[Bre74] Brezzi F.(1974) On the existence, uniqueness and approximation of saddle-point problems arising from Lagrange multipliers.R.A.I.R.O. Anal.Numér.8: 129-151.  [Bre86] Brezis H. (1986) Analisi Funzionale.Liguori, Napoli.

[Bre00] Bressan A. (2000) Hyperbolic Systems of Conservation Laws:The Onedimensional Cauchy Problem.Oxford Lecture Series in Mathematics and its Applications.The Clarendon Press Oxford University Press, New York.

[BRM$^{+}$97] 。  Bassi F., Rebay S., Mariotti G., Pedinotti S., and Savini M．(1997) 用于非粘性和粘性涡轮机械流的高阶精确非连续有限元方法。In Decuypere R. and Dibelius G. (eds) Proceedings of the $2 n d$ European Conference on Turbomachinery Fluid Dynamics and Thermodynamics, pages 99-108.Technologisch Instituut, Antwerpen, Belgium.

[BS94] Brenner S. C. and Scott L. R. (1994) The Mathematical Theory of Finite Element 訃告方法。Springer-Verlag, New York.

[BS07] Brenner S. and Sung L. (2007) Bddc and feti-dp without matrices or vectors.Comput.Methods Appl. Mech.Engrg.196: 1429-1435.

[BS08] Burman E. and Stamm B. (2008) Symmetric and nonsymmetric discontinuous Galerkin methods stabilized using bubble enrichment.C. R. Math.Acad.Sci. Paris 346(1-2): 103-106.

[BS12] A. Borzi和V. Schultz, (2012) Computational Optimization of Systems Governed by Partial Differential Equations, SIAM, Philadelphia.

[Cab03] Caboussat A. (2003) 自由表面流的分析和数值模拟。博士论文，洛桑联邦理工学院。

[CAC10] Chinesta F., Ammar A., and Cueto E. (2010) Recent advances and new challenges in the use of the proper generalized decomposition for solving multidimensional models.Arch.Comput.Methods Engrg 17: 327-350.

[Ç07] Çengel Y. (2007) Introduction to Thermodynamics and Heat Transfer.McGrawHill，纽约。

[CH01] Collis S. and Heinkenschloss M. (2001) Analysis of the streamline upwind/petrov galerkin method applied to the solution of optimal control problems.  $C A A M$ 报告TR02-01。

[CHQZ06] Canuto C., Hussaini M., Quarteroni A., and Zang T. A. (2006) Spectral Methods.单一领域的基本原理。Springer-Verlag, Berlin Heidelberg.

[CHQZ07] Canuto C., Hussaini M. Y., Quarteroni A., and Zang T. A. (2007) Spectral Methods.复杂几何的演变和在流体动力学中的应用。Springer-Verlag, Berlin Heidelberg.  [CHB09] Cottrell J., Hughes T., and Bazilevs Y. (2009) Isogeometric Analysis.争取整合 $C A D$ 和 $F E A$ 。Wiley.

[CHR07] Cottrell J., Hughes T., and Reali A. (2007) Studies of refinement and continuity in Isogeometric structural analysis.Comput.Methods Appli.Mech.工程。196(4144): 4160-4183.

[Cia78] Ciarlet P．G. (1978) The Finite Element Method for Elliptic Problems.NorthHolland, Amsterdam.

[CFL28] Courant R., Friedrichs K., and Lewy H. (1928), Über die partiellen differenzengeichungen der mathematischen physik, Mathematische Annalen 100 (1): 32-74.

[CJRT01] Cohen G., Joly P., Roberts J. E., and Tordjman N. (2001) Higher order triangular finite elements with mass lumping for the wave equation.SIAM J. Numer.分析。38(6): 2047-2078（电子版）。

[CLC11] Chinesta F., Ladeveze P., and Cueto E. (2011) A short review on model order reduction based on proper generalized decomposition.Arch.Comput.Methods Engrg.18: 395-404.

[Clé75] Clément P. (1975) 利用局部正则化的有限元函数进行逼近。RAIRO, Anal.Numér 2 pages 77-84.

[Coc98] Cockburn B. (1998) An introduction to the discontinuous Galerkin method for convection-dominated problems.In Quarteroni A.(ed) Advanced Numerical Approximation of Nonlinesr Hyperbolic Equations, volume 1697 of $L N M$ , pages 151-268.Springer-Verlag, Berlin Heidelberg.

[Coc99] Cockburn B. (1999) Discontinuous Galerkin methods for convection-dominated problems.In High-order methods for computational physics, volume 9 of Lect.计算科学工程》第9卷。Sci. Eng.第9卷，第69-224页。Springer, Berlin.

[CFL28] Courant R., Friedrichs K., and Lewy H. (1928), Über die partiellen differenzengeichungen der mathematischen physik, Mathematische Annalen 100 (1): 32-74。

[CRBH06] Cottrell J., Reali A., Bazilevs Y., and Hughes T. (2006) Isogeometric analysis of structural vibrations.Comput.Methods Appli.Mech.工程。195(41-43): 5257 $5296$ .

[dB01] de Boor C. (2001) A Practical Guide to Splines, volume 27 of Applied Mathematical Sciences.Springer-Verlag.

[DBH12] Dedè L., Borden M., and Hughes T. (2012) Isogeometric Analysis for topology optimization with a phase field model.Arch.Comput.Methods Engng.19(3):  $427-465$ .

[DCV] Dalcin L., Collier N., Vignal P., Côrtes A., and Calo V. (2016) PetIGA: A framework for high-performance isogeometric analysis.Comput.Methods Appli.Mech.工程。308: 151-181.

[Ded04] Dedé L. (2004) Controllo Ottimale e Adattività per Equazioni alle Derivate Parziali and Applicazioni.Tesi di Laurea, Politecnico di Milano.

[DG11] Demkowicz L. and Gopalakrishnan J. (2011) A class of discontinuous PetrovGalerkin methods.II. 最佳测试函数.Numer.Methods Partial Differential Equations 27(1): 70-105.

[dFRV11] de Falco C., Reali A., and Vázquez R. (2011) Geopdes:一个用于对 $\{$ PDEs $\}$ 进行等距分析的研究工具。Advances Eng.软件42(12): 1020-1034.

[DJQ15] Dedè L., Jäggli C., and Quarteroni A.(2015) Isogeometric numerical dispersion analysis for two-dimensional elastic wave propagation.Comput.Methods Appli.Mech.Eng. 284(320-348).

[DJS10] Dörfel M., Jüttler B., and Simeon B. (2010) Adaptive isogeometric analysis by local h-refinement with T-splines。Comput.Methods Appli.Mech.工程。199 (58): 264-275.  [DQ15] Dedè L. and Quarteroni A.(2015) Isogeometric Analysis for second order Partial Differential Equations on surfaces.Comput.Methods Appli.Mech.Eng. 284: 807-834.

[DS11] Dedè L. and Santos H. (2011) B-spline goal-oriented error estimators for geometrically nonlinear rods.Comput.Mech.  $49(1): 35-52$ .

[Doh03] Dohrmann R. (2003) A preconditioner for substructuring based on constrained energy minimization.SIAM J. Sci. Comput.25: 246-258.

[DPQ08] Detomi D., Parolini N., and Quarteroni A.(2008) Mathematics in the wind.MOX报告（25）。见网页http：//mox.polimi. it.

[DQ05] Dedè L. and Quarteroni A.(2005) Optimal control and numerical adaptivity for advection-diffusion equations.M2AN Math.模型。Numer.Anal.  $39(5)$ : 1019 $1040$ .

[DSW04] Dawson C., Sun S., and Wheeler M. F. (2004) Compatible algorithms for coupled flow and transport.Comput.Methods Appl. Mech.Engrg.193(23-26): 2565 2580 .

[DT80] Dervieux A. and Thomasset F. (1980) Approximation Methods for Navier-Stokes Problems, volumes 771 of Lecture Notes in Mathematics, chapter A finite element method for simulation of Rayleigh-Taylor instability, pages $145-158$ .Springer-Verlag, 柏林。

[Dub91] Dubiner M. (1991) 三角形和其他域上的光谱方法。J. Sci. Com

[DV02] Darmofal D. L.和Venditti D. A. (2002)功能输出的网格适应。银应用于二维无iscid流动。J. Comput.176: 40-69.

[DV09] Di Pietro D. A. and Veneziani A.(2009) 连续和非连续Galerkin方法的表达式模板实现。科学中的计算和可视化12(8): 421-436.

[DZ06] Dáger R. and Zuazua E. (2006) Wave Propagation, Observation and Control in 1-d Flexible Multi-Structures.Mathématiques et Applications.Springer, Paris.

[EBBH09] Evans J., Bazilevs Y., Babuška I., and Hughes T. (2009) $n$ Isogeometric有限元方法的$k$版本的宽度、超因数和最优率。Comput.Methods Appli.Mech.工程。198(21-26): 1726-1741.

[EG04] Ern A. and Guermond J. L. (2004) Theory and Practice of Finite Elements, volume 159 of Applied Mathematics Sciences.Springer-Verlag, New York.

[EGH00] Eynard R., Gallouët T. and Herbin R. (2000) Finite Volume Methods.In Ciarlet P.G., Lions J.L. (eds.) Handbook of Numerical Analysis, volume 7, 713-1018.

[EHS+] \quad$ Elman H. C., Howte V. E., Shadid J., Shuttleworth R., and Tuminaro R. (2006) Block Preconditioners based on approximate commutators.SIAM J. on Scientific Computing 27 (5): 1651-1668.

[EJ88] Eriksson E. and Johnson C. (1988) An adaptive method for linear elliptic problems.Math.Comp.50: 361-383.

[Emb99] Embree M. (1999) Convergence of Krylov subspace methods for nonnormal matrices.博士论文，牛津大学计算实验室。

[Emb03] Embree M. (2003) The tortoise and the hare restart GMRES.SIAM Rev. 45 (2): 259-266.

[ESLT15] Evans E., Scott M., Li X., and Thomas D. (2015) Hierarchical T-splines:分析-适用性、贝塞尔提取以及作为等值线分析的自适应基础的应用。Comput.Methods Appli.Mech.Engineering. 284: 1-20.

[ESW05] Elman H., Silvester D., and Wathen A. (2005) Finite Elements and Fast Iterative Solvers.牛津科学出版社，牛津。  [Eva98] Evans L. (1998) Partial differential equations.American Mathematical Society, Providence.

[FCZ03] Fernández-Cara E. and Zuazua E. (2003) Control theory: History, mathematical achievements and perspectives.Bol.Soc. Esp. Mat.Apl. 26: 79-140.

[FCZ04] Fernández-Cara E. and Zuazua E. (2004) On the history and perspectives of control theory.Matapli 74: 47-73.

[FLP00] Farhat C., Lesoinne M., and Pierson K. (2000) A scalable dual-primal domain decomposition method.Numer.Linear Algebra Appl. 7: 687-714.

[FLT01] \quad$ Farhat C., Lesoinne M., Tallec P. L., Pierson K., and Rixen D. (2001) Feti-dp: a dual-primal unified feti method. I. a faster alternative to two-level feti method.Intern.J. Numer.Methods Engrg.50: 1523-1544.

[FMP04] Formaggia L., Micheletti S., and Perotto S. (2004) Anisotropic mesh adaptation in computational fluid dynamics: application to the advection-diffusion-reaction and the stokes problems.Appl. Numer:Math.51(4):  $511-533$ .

[FMRT01] Foias C., Manley O., Rosa R., and Temam R. (2001) Navier-Stokes Equations and Turbulence.剑桥大学出版社，剑桥。

[For77] Fortin M. (1977) An analysis of the convergence of mixed finite element methods.R.A.I.R.O. Anal.Numér.  $11$ .

[FP01] Formaggia L. and Perotto S. (2001) New anisotropic a priori error estimates.Numer.Math.89: 641-667.

[FP02] Ferziger J. H. and Peric M. (2002) Computational Methods for Fluid Dynamics.Springer, Berlino, III版。

[FSV05] Formaggia L., Saleri F., and Veneziani A.(2005) Applicazioni ed esercizi di modellistica numerica per problemi differenziali.Springer Italia, Milano.

[FSV12] Formaggia L., Saleri F., and Veneziani A.(2012) Solving Numerical PDEs:问题，应用，练习。Springer Italia, Milano.

[Fun92] Funaro D. (1992) Polynomial Approximation of Differential Equations.SpringerVerlag, Berlin Heidelberg.

[Fun97] Funaro D. (1997) Spectral Elements for Transport-Dominated Equations.Springer-Verlag, Berlin Heidelberg.

[Fur97] Furnish G.(1997年5月/6月) Disambigated glommable expression templates.Compuers in Physics 11(3): 263-269.

[GaAML04] Galeão A., Almeida R., Malta S., and Loula A. (2004) 连接主导的反应-扩散问题的有限元分析。Applied Numerical Mathematics 48: 205-222.

[GB98] George P. L. and Borouchaki H.(1998) Delaunay Triangulation and Meshing.Editions Hermes, Paris.

[Ger08] Gervasio P. (2008) Convergence analysis of high order algebraic fractional step schemes for time-dependent Stokes equations.SIAM J. Numer.分析。  $\mathbf{4 6}(4)$ , 1682-1703.

[GCBH08] Gómez H., Calo V., Bazilevs Y., and Hughes T. (2008) Isogeometric analysis of the Cahn-Hilliard phase-field model.Comput.Methods Appli.Mech.工程。197(49-50): 4333-4352.

[GHNC10] Gómez H., Hughes T., Nogúeira X., and Calo V. (2010) Isogeometric analysis of the Navier-Stokes-Korteweg equations.Comput.Methods Appli.Mech.工程。  $199(25-28): 1828-1840$ .

[GJS12] Giannelli C., Jüttler B., and Speleers H. (2012) THB-splines。分层花键的截断基础。Comp.Aided Geom.Design 29(7): 485-498.

[GL16] Gómez H. and Lorenzis L. D. (2016) The variational collocation method.Comput.Methods Appli.Mech.Eng.309: 152-181.  [GMNP07] Grepl M. A., Maday Y., Nguyen N. C., and Patera A. T. (2007) Efficient reducedbasis treatment of nffona and nonlinear partial differential equations.  $M 2 A N$ (Math. Model. Numer: Anal. ) 31(3): 575-605.

[GMS06] Guermond J. L. , Minev P. and Shen J. (2006), An overview of projection methods for incomprensible flows.Comput.Meth.应用。Mech.Engnrng195: 6011 $6045$ 。

[GMSW89] Gill P., Murray W., Saunders M., and Wright M. (1989) Constrained nonlinear programming.Elsevier Handbooks In Operations Research And Management Science Optimization.Elsevier North-Holland, Inc., New York.

[GN12] Gomez H. and Nogueira X. (2012) An unonditionally energy-stable method for the phase field crystal equation.Comput.Methods Appli.Mech.Eng. 249-252: 52-61.

[GR96] Godlewski E. and Raviart P. A. (1996) Hyperbolic Systems of Conservations Laws, volume 118.Springer-Verlag, New York.


[Gri11] Grisvard P. (2011) Elliptic Problems in Nonsmooth Domains.SIAM.

[GRS07] Grossmann C., Ross H., and Stynes M. (2007) Numerical treatment of Partial即微分方程.Springer, Heidelberg, Heidelberg.

[GS05] Georgoulis E. H. and Süli E. (2005) Optimal error estimates for the $h p$ -version interior penalty discontinuous Galerkin finite element method.IMA J. Numer.分析。25(1): 205-220.

[GSD14] Gahalaut K., Satyendra K., and Douglas C. (2014) 基于NURBS的椭圆偏微分方程的等轴离散化中出现的矩阵的条件数估计。 arXiv [math.NA] $1406.6808$ 。

[GSV06] Gervasio P., Saleri F., and Veneziani A.(2006) 代数分步方案与不可压缩纳维-斯托克斯方程的谱系方法。J. Comput.214(1): 347-365.

[Gun03] Gunzburger M. D. (2003) Perspectives in Flow Control and Optimization.设计和控制的进展。SIAM.

[HAB11] Hsu M.-C., Akkerman I., and Bazilevs Y. (2011) High-performance computing of wind turbine aerodynamics using isogeometric analysis.Comput.\计算与流体 $49(1): 93-100$ 。

[Hac] Hackbush W.

[HB76] Hnat J. and Buckmaster J. (1976) Spherical cap bubbles and skirt formation.Phys. Fluids 19: 162-194.

[HCB05] Hughes T., Cottrell J., and Bazilevs Y. (2005) Isogeometric Analysis:CAD、有限元、NURBS、精确几何和网格细化。Comput.Methods Appli.Mech.工程。194(39-41): 4135-4195.

[HCSH17] Hiemstra R., Calabrò F., Schillinger D., and Hughes T. (2017) 等距分析中张量积和分层细化样条的最佳和减少正交规则。Comput.Methods Appli.Mech.Engineering.316:  $966-1004$ .

[HER14] Hughes T., Evans J., and Reali A. (2014) 特征值、边界值和初始值问题的有限元和NURBS近似。Comput.Methods Appli.Mech.Engineering. 272: 290-320.

[Hir88] Hirsh C. (1988) Numerical Computation of Internal and External Flows, volume 1.John Wiley and Sons, Chichester.

[HLB98] Holmes P., Lumley J., and Berkooz G. (1998) Turbulence, coherent structures, dynamical systems and symmetry.Cambridge Univ. Press.

[HN81] Hirt C. W. and Nichols B. D. (1981) Volume of fluid (VOF) method for the dynamics of free boundaries.J. Comp.39: 201-225.  [Hou95] Hou T. Y. (1995) Numerical solutions to free boundary problems.ACTA Numerica 4: 335-415.

[HPUU09] Hinze M., Pinnau R., Ulbrich M. and Ulbrich S. (2009) Optimization with PDE Constraints.Springer.

[HRS08] Hughes T., Reali A., and Sangalli G. (2008) Duality and unified analysis of discrete approximations in structural dynamics and wave propagation: comparison of p-method finite elements with k-method nurbs.Comput.Methods Appli.Mech.Engineering.194(49-50): 4104-4124.

[HRS10] Hughes T., Reali A., and Sangalli G. (2010) Efficient quadrature for NURBS based isogeometric analysis.Comput.Methods Appli.Mech.工程。199(5-8): 301 $313$ .

[HRSP07] Huynh D. B. P., Rozza G., Sen S., and Patera A. T. (2007) A successive constraint linear optimization method for lower bounds of parametric coercivity and inf-sup stability constants.C. R. Acad.Sci. Paris, Analyse Numérique, Series I 345, pp. $473-478$ 。

[HRT96] Heywood J. G., Rannacher R., and Turek S. (1996) Artificial boundaries and flux and pressure conditions for the incompressible Navier-Stokes equations.Internat.J. Numer.Methods Fluids $22(5)$ : 325-352.

[HSS02] Houston P., Schwab C., and Süli E. (2002) Discontinuous $h p$ -finite element methods for advection - diffusion-reaction problems.SIAM J. Numer.分析。  $39(6)$ : 2133-2163（电子版）。

[Hug00] Hughes T. J. R. (2000) The Finite Element Method.Linear Static and Dynamic Finite Element Analysis.Dover Publishers, New York.

[HVZ97] Hamacher V. C., Vranesic Z. G., and Zaky S. 。G. (1997) Introduzione 6 all'architettura dei calcolatori.McGraw Hill Italia, Milano.

[HW65] Harlow F. H. and Welch J. E. (1965) Numerical calculation of time-dependent viscous incompressible flow of fluid with free surface.流体物理学 $8(12)$ : 2182-2189.

[HW08] Hesthaven J. S. and Warburton T. (2008) Nodal discontinuous Galerkin methods, volume 54 of Texts in Applied Mathematics.Springer, New York.算法、分析和应用。

[HYR08] Hou T. Y., Yang D. P., and Ran H. (2008) Multiscale analysis and computation for the 3 d incompressible Navier-Stokes equations.SIAM多尺度建模与模拟6 (4): 1317-1346.

[IK08] Ito K. and Kunisch K. (2008) On the Lagrange Multiplier Approach to Variational Problems and Applications.SIAM, Philadelphia.

[IR98] Ito K. and Ravindran S. S. (1998) A reduced-order method for simulation and control of fluid flows.计算物理学杂志》143(2): 403-425.

[IZ99] Infante J. and Zuazua E. (1999) Boundary observability for the space semidiscretizations of the 1 -d wave equation.M2AN Math.模型。Numer.分析。  $33(2):$ 407-438.

[Jam88] Jamenson A. (1988) Optimum aerodynamic design using cfd and control theory.AIAA论文95-1729-CP第233-260页。

[JKD14] Johannessen K., Kvamsdal T., and Dokken T. (2014) Isogeometric analysis using \{LR \}.B-Splines.Comput.Methods Appli.Mech.Eng. 269:471-514.

[JK07] John V. and Knobloch P. (2007) On spurious oscillations at layers diminishing (SOLD) methods for convection-diffusion equations.I. A review.Comput.Methods Appl. Mech.Engrg.196(17-20): 2197-2215.

[Joe05] Joerg M. (2005) Numerical investigations of wall boundary conditions for twofluid flows.硕士学位论文，洛桑联邦理工学院。  [Joh87] Johnson C. (1987) Numerical Solution of Partial Differential Equations by the Finite Element Method.剑桥大学出版社，剑桥。

[KA00] Knabner P. and Angermann L. (2000) Numerical Methods for Elliptic and Parabolic Partial Differential Equations, volume 44 of $T A M$ 。Springer-Verlag, New York.

[KAJ02] Kim S., Alonso J., and Jameson A. (2002) 使用粘性连续邻接法优化高升力配置的设计。AIAA论文，第40届AIAA航空航天科学会议和展览，1月14-17日 $20020844$ 。

[KBH+] \quad$ Kiendl J., Bazilevs Y., Hsu M.-C., Wüchner R., and Bletzinger K.-U.(2010)用于对由多个斑块组成的Kirchhoff-Love壳结构进行等效分析的弯曲条方法。Comput.Methods Appli.Mech.工程。199(37-40): 2403-2416.

![](https://cdn.mathpix.com/cropped/991f5db518e324d299c1ff4972bba9fb-287.jpg?height=13&width=18&top_left_y=371&top_left_x=186)

[KF89] Kolmogorov A. and Fomin S. (1989) Elements of the Theory of Functions and Functional Analysis.V.M. Tikhominov, Nauka - Moscow.

[KMI+] Kajitani H., Miyata H., Ikehata M., Tanaka H., Adachi H., Namimatzu M., and Ogiwara S. (1983) Summary of the cooperative experiment on Wigley Parabolic model in Japan.In Proc. of the 2nd DTNSRDC Workshop on Ship Wave Resistance Computations (Bethesda, USA), pages 5-35.

[KPTZ00] Kawohl B., Pironneau O., Tartar L., and Zolesio J. (2000) Optimal Shape Design.Springer-Verlag, 柏林。

[Kro97] Kroener D. (1997) Numerical Schemes for Conservation Laws.Wiley-Teubner, 即Chichester.

[KS05] Karniadakis G. E. and Sherwin S. J. (2005) Spectral/hp Element Methods for Computational Fluid Dynamics。牛津大学出版社，纽约，第二版。

[KSWB14] Kiendl J., Schmidt R., Wüchner R., and Bletzinger K.-U.(2014) 使用半分析敏感性分析和敏感性加权的壳的等效形状优化。Comput.Methods Appli.Mech.Engineering. 274: 148-167.

[KVvdZvB14] Kuru G., Verhoosel C., van der Zee K., and van Brummelen E. (2014) Goaladaptive isogeometric analysis with hierarchical splines。Comput.Methods Appli.Mech.Eng. 270: 270-292.

[KWD02] Klawonn A., Widlund O., and Dryja M. (2002) Dual-primal feti methods for three-dimensional elliptic problems with heterogeneous coefficient.SIAM J. Numer.Anal.40: $159-179$ .

[LDE+]  Liu J., Dedè L., Evans J., Borden M., and Hughes T. (2013) Isogeometric Analysis of the advective Cahn-Hilliard equation: spinodal decomposition under shear flow.J. Comput.物理学》242: 321-350。

[Le05] Le Bris C. (2005) Systèmes multiiéchelles: modélisation et simulation, volume 47 of Mathématiques et Applications.Springer, Paris.

[LEB $^{+}$ 10] 。Lipton S., Evans J., Bazilevs Y., Elguedj T., and Hughes T. (2010) Robustness of Isogeometric structural discretizations under severe mesh distortion.Comput.Methods Appli.Mech.工程。199(5-8): 357-373.

[LeF02] Lefloch Ph. G (2002), Hyperbolic Systems of Conservation Laws: the theory of classical and nonclassical shock wave, Springer.

[LeV02a] LeVeque R. J. (2002) Finite Volume Methods for Hyperbolic Problems.Cambridge Texts in Applied Mathematics.

[LeV02b] LeVeque R. J. (2002) Numerical Methods for Conservation Laws.Birkhäuser Verlag, Basel, II edition.

[LeV07] LeVeque R. J. (2007) Finite Difference Methods for Ordinary and Partial Differential Equations:稳态和随时间变化的问题。SIAM, Philadelphia.  [Lio71] Lions J. (1971) Optimal Control of Systems Governed by Partial Differential Equations.Springer-Verlag, New York.

[Lio72] Lions J. (1972) Some Aspects of the Optimal Control of Distribuited Parameter Systems.SIAM, Philadelphia.

[Lio96] Lions P.-L. (1996) Mathematical topics in fluid mechanics.第一卷，牛津大学数学及其应用系列讲座第三卷。The Clarendon Press牛津大学出版社，纽约。不可压缩的模型，牛津科学出版社。

[LH16] Liu J. and Hughes T. R. (2016) Isogeometric Phase-Field Simulation of Boiling, 䬴页217-228。Springer International Publishing, Cham.

[LL59] Landau L．D. 和 Lifshitz E. M. (1959) 流体力学。由J.B.Sykes和W.H.Reid从俄文翻译。理论物理学课程，第6卷。Pergamon出版社，伦敦。

[LL00] Lippman S. B. and Lajoie J. (2000) C++ Corso di Programmazione.Addison Wesley Longman Italia, Milano, III版。

[LM68] Lions J. L. and Magenes E. (1968) Quelques Méthodes des Résolution des Problémes aux Limites non Linéaires.Dunod, Paris.

[LMQR13] Lassila T., Manzoni A., Quarteroni A., and Rozza G. (2013) Generalized reduced basis methods and $\mathrm{n}$ -width estimates for the approximation of the solution manifold of parametric PDEs.In Brezzi F., Colli Franzone P., Gianazza U., and Gilardi G. (eds) Analysis and Numerics of Partial Differential Equations, Volume 4 of Springer INdAM Series, pages 307-329.斯普林格，米兰。

[LR98] Lin S. P. and Reitz R. D. (1998) Drop and spray formation from a liquid jet.Annu.Rev. Fluid Mech.30: 85-105.

[LvGM96] Lorentz G., von Golitschek M., and Makovoz Y. (1996) Constructive approximation: advanced problems.Springer-Verlag, New York.

[LW94] Li X.D. and Wiberg N. E. (1994) A posteriori error estimate by element patch post-processing, adaptive analysis in energy and $\mathrm{L}_{2}$ norms.Comp.Struct.53: $907-919$ .

[LW06] Li J. and Widlund O. (2006) Feti-dp, bddc, and block cholesky methods.Internat.

银 J. Numer.Methods Engrg.66: 250-271.

[LWH14] Lorenzis L. D., Wriggers P., and Hughes T. (2014) Isogeometric contact: a review.GAMM-Mitteilungen 37(1): 85-123.

[LZZ13] Li X., Zhang J., and Zheng Y.(2013) 基于NURBS的梁和板的等值分析，使用高阶剪切变形理论。Math.Problems Eng. 2013:1-9.

[Man93] Mandel J. (1993) Balancing domain decomposition.Comm.Numer.Methods Engrg.9: 233-241.

[Mar95] Marchuk G. I. (1995) Adjoint Equations and Analysis of Complex Systems.Kluwer Academic Publishers, Dordrecht.

[Mau81] Maurer H. (1981) 数学编程和优化控制中的一阶和二阶充分最优性条件。Mathematical Programming Study 14: 163-177.

[Max76] Maxworthy T. (1976) 关于孤波之间碰撞的实验。流体力学杂志》76: 177-185。

[MDT05] Mandel J., Dohrmann R., and Tezaur R. (2005) An algebraic theory for primal and dual substructuring methods by contraints.Appl. Numer.Math.54: $167-193$ .

[Mey00] Meyer C. D. (2000) Matrix Analysis and Applied Linear Algebra.SIAM.

[MOS92] Mulder W., Osher S., and Sethian J. (1992) 计算可压缩气体动力学的界面运动。计算物理学杂志》100（2）：209-228。  [MP94] Mohammadi B. and Pironneau O. (1994) Analysis of the K-Epsilon Turbulence Model.John Wiley\& Sons, Chichester.

[MP97] Muzaferija S. and Peric M. (1997) Computation of free-surface flows using finite volume method and moving grids.Numer.Heat Trans., Part B 32: 369-384.

[MP01] Mohammadi B. and Pironneau O. (2001) Applied Shape Optimization for Fluids.Clarendon出版社，牛津。

[MPT02a] Maday Y., Patera A. T., and Turinici G. (2002) Global a priori convergence theory for reduced-bas approximation of single-parameter symmetric coercive elliptic partial differential equations.C. R. Acad.Sci. Paris, Série I 335(3): 289-294.

[MPT02b] Maday Y., Patera A., and Turinici G. (2002) A Priori convergence theory for reduced-bas approximations of single-parameter elliptic partial differential equations.科学计算杂志》17（1-4）：437-446。

[MST17] Montardini M., Sangalli G., and Tamellini L. (2017) Optimal-order isogeometric collocation at Galerkin superconvergent points.Comput.Methods Appli.Mech.

![](https://cdn.mathpix.com/cropped/991f5db518e324d299c1ff4972bba9fb-289.jpg?height=17&width=21&top_left_y=442&top_left_x=181)
英。316:  $741-757$ .

[MT01] Mandel J. and Tezaur R. (2001) On the convergence of a dual-primal substructuring method.Numerische Mathematik 88: 543-558.

[NAG10] Nagy A., Abdalla M., and Gürdal Z.(2010)梁结构的等效尺寸和形状优化。Comput.Methods Appli.Mech.工程。199(17): 1216 1230 .

[NG13] Nörtoft P. and Gravesen J. (November 2013) Isogeometric shape optimization in fluid mechanics.Struct.Multidiscip.Optim.48(5): 909-925.

[Nit68] Nitsche J. A. (1968) Ein kriterium für die quasi-optimalitat des Ritzchen Verfahrens.Numer.Math.11: 346-348.

[Nit71] Nitsche J. (1971) Über ein Variationsprinzip zur Lösung von Dirichlet-Problemen bei Verwendung von Teilräumen, die keinen Randbedingungen unterworfen sind.Abh.Math.Sem.汉堡大学 36: 9-15.献给Lothar Collatz的60岁生日的文章集。

[Nou10] Nouy A. (2010) Proper generalized decompositions and separated representations for the numerical solution of high dimensional stochastic problems.Arch.Comput.Methods Engrg.17: 403-434.

[NW06] Nocedal J. and Wright S. (2006) Numerical Optimization.斯普林格运筹学和金融工程系列。Springer, New York.

[NZ04] Naga A. and Zhang Z. (2004) A posteriori error estimates based on the polynomial preserving recovery.SIAM J. Numer.Anal.42: 1780-1800.

[OBB98] Oden J. T., Babuška I., and Baumann C. E. (1998) A discontinuous $h p$ finite element method for diffusion problems.J. Comput.Phys. 146(2):  $491-519$ .

[OP07] Oliveira I. and Patera A. (2007) Reduced-bas techniques for rapid reliable optimization of systems described by affinely parametrized coercive elliptic partial differential equations.优化与工程8(1): 43-65.

[OS88] Osher S. and Sethian J. A. (1988) Fronts propagating with curvature-dependent speed: algorithms based on Hamilton-Jacobi formulations.J. Comput.$79(1): 12-49$ 。

[Pan05] Panton R. (2005) Incompressible Flow.Wiley /& Sons，第3版。

[Pat80] Patankar S. V. (1980) Numerical Heat Transfer and Fluid Flow.Hemisphere, Washington.

[Pat84] Patera A.T. (1984) A spectral element method for fluid dynamics: laminar flow in a channel expansion.J. Comput.物理学》54: 468-488。

[Pet] www.mcs. anl.gov/petsc/.  [PG00] Pierce N. and Giles M. B. (2000) Adjoint recovery of superconvergent functionals from PDE approximations.SIAM Review 42(2): 247-264.

[Pin85] Pinkus A. (1985) $n$ -Widths in Approximation Theory.Springer-Verlag, Ergebnisse.

[Pin08] Pinnau R. (2008) Model Reduction via proper orthogonal decomposition.In Schilder W. and van der Vorst H. (eds) Model Order Reduction:Theory, Research Aspects and Applications, pages $96-109$ .Springer.

[Pir84] Pironneau O. (1984) Optimal Shape Design for Elliptic Systems.Springer-Verlag, New York.

[Por85] Porsching T. A. (1985) Estimation of the error in the reduced basis method solution of nonlinear equations.Mathematics of Computation 45(172): 487-496.

[PQ05] Parolini N. and Quarteroni A.(2005) Mathematical models and numerical simulations for the America's cup.Comput.Methods Appl. Mech.Engrg.194(9-11):  $1001-1026$ .

[PQ07] Parolini N. and Quarteroni A.(2007) Modelling and numerical simulation for yacht engineering.In Proceedings of the 26th Symposium on Naval Hydrodynamics.战略分析公司，阿灵顿，弗吉尼亚州，美国。

[PR07] Patera A. T. and Rozza G. (2006-2007) Reduced Basis Approximation and A Posteriori Error Estimation for Parametrized Partial Differential Equations.麻省理工学院版权所有。将出现在MIT Pappalardo机械工程专著中。  [Pro97] Prohl A. (1997) Projection and Quasi-Compressibility Methods for Solving the Incompressible Navier-Stokes Equations.数值数学的进展》。B.G. Teubner, Stuttgart.

[Pru06] Prud'homme C. (2006) A domain specific embedded language in $\mathrm{c}++$ for automatic differentiation, projection, integration and variational formulations.科学编程14(2): 81-110.

[PS03] Perugia I. and Schötzau D. (2003) The $h p$ -local discontinuous Galerkin method for low-frequency time-harmonic Maxwell equations.Math.Comp.  $72(243)$ : 1179-1214.

[PT97] Piegl L. and Tiller W. (1997) The NURBS book.Springer-Verlag, New York.

[PWY90] Pawlak T. P., Wheeler M. J., and Yunus S. M. (1990) Zienkiewicz-Zhu误差估计器在板和壳分析中的应用。Int.J. Numer.方法工程。 29: 1281-1298。

[Qia10] Qian X. (2010) Full analytical sensitivities in NURBS based isogeometric shape optimization.Comput.Methods Appli.Mech.工程。199(29-32): 2059-2071.

[QR07] Quarteroni A. and Rozza G. (2007) Numerical solution of parametrized NavierStokes equations by reduced basis method.Num. Meth.PDEs 23: 923-948.

[QRDQ06] Quarteroni A., Rozza G., Dedè L., and Quaini A.(2006) 平流-扩散过程的控制问题的数值近似。系统建模和优化。IFIP Int.Fed.Inf.Process.199: 261-273.

[QRM11] Quarteroni A., Rozza G., and Manzoni A.(2011) 经认证的工业应用中参数化偏微分方程的减基近似法。J. Math.Ind.1(3).

[QR13] Quarteroni A. and Rozza G. E. (2014, in press) Reduced Order Methods for Modeling and Computational Reduction.MS/&A建模、仿真和应用系列。Springer-Verlag Italia, Milano.

[QSS07] Quarteroni A., Sacco R., and Saleri F. (2007) Numerical Mathematics.Springer, Berlin and Heidelberg, II edition.  [QSV00] Quarteroni A., Saleri F., and Veneziani A. (2000).(2000) Factorization methods for the numerical approximation of Navier-Stokes equations.Comput.Methods Appl. Mech.Engrg.188(1-3): 505-526.

[Qu02] Qu Z. (2002) Unsteady open-channel flow over a mobile bed.博士论文，洛桑联邦理工学院。

[Qua93] Quartapelle L. (1993) Numerical Solution of the Incompressible Navier-Stokes Equations.Birkhäuser Verlag, Basel.

[QV94] Quarteroni A. and Valli A. (1994) Numerical Approximation of Partial Differential Equations.Springer, Berlin Heidelberg.

[QV99] Quarteroni A. and Valli A. (1999) Domain Decomposition Methods for Partial Differential Equations.牛津科学出版社，牛津。

[Ran99] Rannacher R. (1999) 有限元计算的误差控制。误差估计和网格大小适应的介绍。在科学计算中的误差控制和适应性（安塔利亚，1998），第247-278页。Kluwer Acad.Publ., Dordrecht.

[RC83] Rhie C. M.和Chow W. L. (1983) 经过有后缘分离的机翼的湍流的数值研究。AIAA杂志 $21(11): 1525-1532$ 。

[RH15] Reali A. and Hughes T. (2015) An introduction to isogeometric collocation methods.Isogeometric Methods for Numerical Simulation第173-204页。

[RHM13] Rozza G., Huynh D.P.B., and Manzoni A.(2013)参数化几何中斯托克斯流的减基近似和后验误差估计：inf-sup稳定常数的作用。Num. Math.125(1), 115-152..

[RHP08] Rozza G., Huynh D.B.P., and Patera A. T. (2008) 减基近似和后验误差估计用于仿生参数化的椭圆强迫性偏微分方程。应用于运输和连续力学。Archives Computational Methods in Engineering 15(3): 229-275.

[Riv08] Rivière B. (2008) Discontinuous Galerkin methods for solving elliptic and parabolic equations, volume 35 of Frontiers in Applied Mathematics.工业与应用数学学会（SIAM），费城，宾夕法尼亚州。理论和实现。

[Rod94] Rodríguez R. (1994) Some remarks on Zienkiewicz-Zhu estimator.Numer.Methods Part.Diff.Eq. 10: 625-635.

[Roz09] Rozza G. (2009) 具有非参数依赖性的域中斯托克斯方程的减基方法。Comp.Vis.Science 12: 23-35.

[RR04] Renardy M. 和 Rogers R. C. (2004) An Introduction to Partial Differential Equations.Springer-Verlag，纽约，第二版。

[RST96] Ross H. G., Stynes M., and Tobiska L. (1996) Numerical Methods for Singularly Perturbed Differential Equations.对流-扩散和流动问题。Springer-Verlag, Berlin Heidelberg.

[Rud91] Rudin W. (1991) Analyse Rèelle et Complexe.Masson, Paris.

[RV07]

Rozza G. and Veroy K. (2007) On stability of reduced basis method for Stokes equations in parametrized domains.Comp.Meth.Appl. Mech. and Eng.196: 1244-1260.

[RVS08] Rehman M., Vuik C., and Segal G. (2008) A comparison of preconditioners for incompressible Navier-Stokes solvers.Int.J. Numer.Meth.Fluids 57: 1731-1751.  [RVS09] Rehman M., Vuik C., and Segal G. (2009) Preconditioners for the steady incompressible Navier-Stokes problem.Int.J. Applied Math.38 (4).

[RWG99] Rivière B., Wheeler M.F., and Girault V. (1999) 椭圆问题的内部惩罚、约束和不连续Galerkin方法的改进能量估计。I. Comput.Geosci.3(3-4): 337-360 (2000).  [RWG01] Rivière B., Wheeler M. F., and Girault V. (2001) A priori error estimates for finite element methods based on discontinuous approximation spaces for elliptic problems.SIAM J. Numer.分析。39(3): 902-931.

[Saa96] Saad Y. (1996) Iterative Methods for Sparse Linear Systems.PWS出版公司，波士顿。

[Sag06] Sagaut P. (2006) Large Eddy Simulation for Incompressible Flows: an Introduction.Springer-Verlag, Berlin Heidelberg, 第三版。

[Sal08] Salsa S. (2008) Partial Differential Equations in Action - From Modeling to Theory.Springer，米兰。

[SBV $\left.^{+} 11\right] \quad$ Scott M., Borden M., Verhoosel C., Sederberg T., and Hughes T. (2011) Isogeometric finite element data structures based on Bézier extraction of $\mathrm{T}$ -spline.Internat.J. Numer.方法工程。88(2): 126-156.

[Sch69] Schwarz H. (1869) Über einige abbildungsdufgaben.J. Reine Agew.Math.70: $105-120$ .

[Sch98] Schwab C. (1998) $p$ 和 $h p$ - Finite Element Methods。牛津科学出版社，牛津。

[SDS$^{+}$12] 。Schillinger D., Dedè L., Scott M., Evans J., Borden M., Rank E., and Hughes T. (2012) 基于Nurbs、沉没边界方法和T-spline CAD曲面的自适应分层细化的等效测绘设计通过分析方法。Comput.Methods Appli.Mech.工程. 249-252:  $116-150$ .

[SER $\left.^{+} 13\right]$ Schillinger D., Evans J., Reali A., Scott M., and Hughes.T. (2013) Isogeometric collocation: cost comparison with Galerkin methods and extension to adaptive hierarchical NURBS discretizations.Comput.Methods Appli.Mech.Engineering. 267: 170-232.

[SF73] Strang G. and Fix G.J. (1973) An Analysis of the Finite Element Method.Wellesley-Cambridge Press, Wellesley, MA.

[SGT01] S. Gottlieb C. S. and Tadmor E. (2001) Strong stability preserving high order time discretization methods.SIAM review 43 (1): 89-112.

[She] Shewchuk J. R.www.cs.cmu.edu/ quake/triangle.html。

[SHH14] Schillinger D., Hossain S., and Hughes T. (2014) Reduced Bézier elements quadrature rules for quadratic and cubic splines in isogeometric analysis.Comput.Methods Appli.Mech.Eng. 277:1-45.

[Shu88] Shu C. (1988) Total-variation-mininishing time discretizations.SIAM Journal on

"科学和统计计算9: 1073-1084.

[Sir87] Sirovich L. (1987) Turbulence and the dynamics of coherent structures, part I。连贯性结构。Quart.Appl.Math.  $45(3)$ : $561-571$ 。

[SLSH12] Scott M., Li X., Sederberg T., and Hughes T. (2012) Local refinement of analysissuitable T-splines。Comput.Methods Appli.Mech.工程。213: 206-222.

[Smo01] Smolianski A. (2001) Numerical Modeling of Two-Fluid Interfacial Flows.Jyväskylä大学的博士论文。

[SO88] Shu C. and Osher S. (1988) Efficient implementation of essentially nonoscillatory shock-capuring schemes.计算物理学杂志》77: 439 471 。

[SO89] Shu C. and Osher S. (1989) Efficient implementation of essentially nonoscillatory shock-capuring schemes ii.计算物理学杂志 83: 32-78.

[Spi99] Spivak M. (1999) A comprehensive introduction to differential geometry.第二卷。Publish or Perish Inc., Houston, Tex., iii edition.  [Ste98] Stenberg R. (1998) Mortaring by a method of J. A. Nitsche.在计算力学（布宜诺斯艾利斯，1998年），页数CD-ROM文件。Centro Internac.Métodos Numér.Ing., Barcelona.

$\begin{aligned}&\text { [Str71] } & \text { Stroud A. H. (1971) Approximate calculation of multiple integrals. Prentice-Hall, }\end{aligned}$ Inc., Englewood Cliffs, N.J.

[Str89] Strickwerda J. C. (1989) Finite Difference Schemes and Partial Differential Equations.Wadworth /& Brooks/Cole, Pacific Grove.

[Str00] Strostroup B. (2000) C++ Linguaggio, Libreria Standard, Principi di Programmazione.Addison Welsey Longman Italia, Milano, III版。

[SV05] Saleri F. and Veneziani A.(2005)不可压缩的Navier-Stokes方程的压力校正代数分割方法。SIAM J. Numer.分析。  $43(1)$ : 174-194.

[SW10] Stamm B. and Wihler T. P. (2010) $h p$ -线性椭圆问题的最优非连续Galerkin方法䬴。Math.Comp.79(272): 2117-2133.

[SZ91] Sokolowski J. and Zolesio J. (1991) Introduction to Shape Optimization (Shape Sensitivity Analysis) 。Springer-Verlag, New York.

[SZBN03] Sederberg T., Zheng J., Bakenov A., and Nasri A. (2003) T-splines and TNURCCs.在ACM图形交易 $(T O G)$ 中，第22:3卷，第477-484页。ACM.

[Tan93] Tanaka N. (1993) Global existence of two phase nonhomogeneous viscous incompressible fluid flow.Comm.Partial Differential Equations $18(1-2)$ : 41-81.

[TDQ14] Tagliabue A., Dedè L., and Quarteroni A.(2014) Isogeometric Analysis and error estimates for high order partial differential equations in fluid dynamics.Comput.\Comput.& Fluids 102: 277-303.

[TE05] Trefethen L. and Embree M. (2005) Spectra and pseudospectra.非正常矩阵和运算符的行为。普林斯顿大学出版社，普林斯顿。

[Tem01] Temam R. (2001) Navier Stokes Equations.North-Holland, Amsterdam.

[TF88] Tsuchiya K. and Fan L.-S.(1988) 二维液-固流化床中单个气泡的近醒结构：涡流脱落和醒目尺寸变化。Chem.Engrg.Sci. $43(5)$ : $1167-1181$ .

[Tho84] Thomee V. (1984) Galerkin Finite Element Methods for Parabolic Problems.

即Springer, Berlin and Heidelberg.

[TI97] Trefethen L. and III D. B. (1997) Numerical Linear Algebra.SIAM.

[TL58] Taylor A. and Lay D. (1958) Introduction to Functional Analysis.J.Wiley\&Sons, New York.

[Tor09] Toro E. F. (2009) Riemann Solvers and Numerical Methods for Fluid Dynamics:A Practical Introduction.Springer-Verlag, Berlin Heidelberg.

[Tri]

㟍

软件.sandia.gov/trilinos/。

[Tro10] F. Tröltzch (2010), Optimal Central of Partial Differential Equations:理论、方法和应用.AMS, Providence.

[TSHH17] Toshniwal D., Speleers H., Hiemstra R., and Hughes T. (2017) Multi-degree smooth polar splines:一个用于几何建模和等距分析的框架。Comput.Methods Appli.Mech.工程。316: 1005-1061.

[TSW99] Thompson J. F., Soni B. K., and Weatherill N. P. (eds) (1999) Handook of Grid Generation.CRC出版社，Boca Raton。

[TW05] Toselli A. and Widlund O. (2005) Domain Decomposition Methods - Algorithms and Theory.Springer-Verlag, Berlin Heidelberg.

[TWM85] Thompson J. F., Warsi Z. U. A., and Mastin C. W. (1985) Numerical Grid Generation, Foundations and Applications.North-Holland, New York.  [UMF]

www.cise.ufl.edu/research/sparse/umfpack/。

[Vas81] Vasiliev F. (1981) Methods for Solving the Extremum Problems.Nauka，莫斯科。

[vdV03] van der Vorst H. A. (2003) Iterative Krylov Methods for Large Linear Systems.剑桥大学出版社，剑桥。

[Vel95] Veldhuizen T. (1995) Expression templates.C++报告杂志7(5): 26-31。另见网页http://osl.iu.edu/ tveldhui 。

[Ven98] Veneziani A.(1998) Mathematical and Numerical Modeling of Blood Flow Problems.博士论文，米兰大学。

[Ver84] Verfürth R. (1984)Stokes方程的混合有限元近似的误差估计。R.A.I.R.O. Anal.Numér.18: 175-182.

[Ver96] Verführth R. (1996) A Review of a Posteriori Error Estimation and Adaptive Mesh Refinement Techniques.Wiley-Teubner, New York.

[VGJS11] Vuong A.-V., Giannelli C., Jüttler B., and Simeon B. (2011) A hierarchical approach to adaptive local refinement in isogeometric analysis.Comput.Methods Appli.Mech.Eng. 200(49-52): 3554-3567.

[VM96] Versteeg H. and Malalasekra W. (1996) An Introduction to Computational Fluid Dynamics: the Finite Volume Method Approach.Prentice-Hall.

[Vol11] Volkwein S. (2011) Model reduction using proper orthogonal decomposition.康斯坦茨大学讲义。

[VP05] Veroy K.和Patera A.T.(2005)参数化稳定不可压缩的Navier-Stokes方程的认证实时解决方案：严格的减基后验误差界限。Int.J. Numer.Meth.Fluids 47(8-9): 773-788.

[Wes01] Wesseling P. (2001) Principles of Computational Fluid Dynamics.SpringerVerlag, Berlin Heidelberg New York.

[Whe78] Wheeler M. F. (1978) An elliptic collocation-finite element method with interior penalties.SIAM J. Numer.Anal.15(1): 152-161.

[Wil98] Wilcox D．C. (1998) CFD中的湍流建模。DCW Industries, La Cañada, CA, II版。

[Win07] Winkelmann C. (2007) NavierStokes方程的内部惩罚有限元近似和对自由表面流的应用。博士论文，洛桑联邦理工学院。

[WFC08] Wall W., Frenzel M., and Cyron C. (2008) Isogeometric structural shape optimization.Comput.Methods Appli.Mech.工程。197(33-40): 2976-2988.

[WZLH17] Wei X., Zhang Y., Liu L., and Hughes T. (2017) Truncated t-splines:基本原理和方法。Comput.Methods Appli.Mech.工程。316:  $349-372$ .

[Woh01] Wohlmuth B. (2001) Discretization Methods and Iterative Solvers Based on Domain Decomposition.Springer.

[Wya00] Wyatt D. C. (2000) 开发和评估水面船只的非线性波浪预测方法。船舶研究杂志44: 96 .

[Yos74] Yosida K. (1974) Functional Analysis.Springer-Verlag, Berlin Heidelberg.

[ZBG $\left.^{+} 07\right]$ Zhang Y., Bazilevs Y., Goswami S., Bajaj C., and Hughes T. (2007) Patientspecific vascular NURBS modeling for Isogeometric Analysis of blood flow.Comput.Methods Appli.Mech.工程。196(29): 2943-2959.

[Zie00] Zienkiewicz O. (2000) Achievements and some unsolved problems of the finite element method.Int.J. Numer.Meth.Eng.47: 9-28.

[ZT00] Zienkiewicz O. C. 和 Taylor R. L. (2000) The Finite Element Method, Vol. 1, The Basis.Butterworth-Heinemann, Oxford, V版。

[Zua03] Zuazua E. (2003) Propagation, observation, control and numerical approximation of waves.Bol.Soc. Esp. Mat.Apl. 25: 55-126.  [Zua05] Zuazua E. (2005) Propagation, observation, and control of waves approximated by finite difference methods.SIAM Review 47 (2): 197-243.

[Zua06] Zuazua E. (2006) 偏微分方程的可控性和可观测性。一些结果和未决问题。In Dafermos C. and Feiteisl E. (eds) Handbook of Differential Equations:演化微分方程，第3卷，第527-621页。Elsevier Science.

[ZZ87] Zienkiewicz O. C. and Zhu J. Z. (1987) A simple error estimator and adaptive procedure for practical engineering analysis.Int.J. Numer.Meth.Engng.24: 337-357.

[ZZ92] Zienkiewicz O. C. and Zhu J. Z. (1992) The superconvergent patch recovery and a posteriori error estimates.I:恢复技术。Int.J. Numer.Meth.Engng.33: $1331-1364$ .



