<!-- HTML header for doxygen 1.8.13-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<link rel="canonical" href="https://www.dealii.org/current/doxygen/deal.II/step-67_8h_source.html" />
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.13"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>The deal.II Library: doc/doxygen/tutorial/step-67.h Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js", "TeX/AMSmath.js", "TeX/AMSsymbols.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
</script><script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="stylesheet.css" rel="stylesheet" type="text/css"/>
<link rel="SHORTCUT ICON" href="deal.ico"></link>
<script type="text/javascript" src="custom.js"></script>
<meta name="author" content="The deal.II Authors <authors@dealii.org>"></meta>
<meta name="copyright" content="Copyright (C) 1998 - 2021 by the deal.II authors"></meta>
<meta name="deal.II-version" content="10.0.0-pre"></meta>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="logo200.png"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">
   &#160;<span id="projectnumber">Reference documentation for deal.II version 10.0.0-pre</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!--Extra macros for MathJax:-->
<div style="display:none">
\(\newcommand{\dealvcentcolon}{\mathrel{\mathop{:}}}\)
\(\newcommand{\dealcoloneq}{\dealvcentcolon\mathrel{\mkern-1.2mu}=}\)
\(\newcommand{\jump}[1]{\left[\!\left[ #1 \right]\!\right]}\)
\(\newcommand{\average}[1]{\left\{\!\left\{ #1 \right\}\!\right\}}\)
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_e68e8157741866f444e17edd764ebbae.html">doc</a></li><li class="navelem"><a class="el" href="dir_04f2ecc425faf0d475a3caf484e551f3.html">doxygen</a></li><li class="navelem"><a class="el" href="dir_7f921e14d817774bc32ca4338fe11225.html">tutorial</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">step-67.h</div>  </div>
</div><!--header-->
<div class="contents">
<a href="step-67_8h.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;</div><div class="line"><a name="l00580"></a><span class="lineno">  580</span>&#160; * </div><div class="line"><a name="l00581"></a><span class="lineno">  581</span>&#160; * </div><div class="line"><a name="l00582"></a><span class="lineno">  582</span>&#160; *     stage_5_order_4, <span class="comment">/* Kennedy, Carpenter, Lewis, 2000 */</span> </div><div class="line"><a name="l00583"></a><span class="lineno">  583</span>&#160; * </div><div class="line"><a name="l00584"></a><span class="lineno">  584</span>&#160; * </div><div class="line"><a name="l00585"></a><span class="lineno">  585</span>&#160; *     stage_7_order_4, <span class="comment">/* Tselios, Simos, 2007 */</span> </div><div class="line"><a name="l00586"></a><span class="lineno">  586</span>&#160; * </div><div class="line"><a name="l00587"></a><span class="lineno">  587</span>&#160; * </div><div class="line"><a name="l00588"></a><span class="lineno">  588</span>&#160; *     stage_9_order_5, <span class="comment">/* Kennedy, Carpenter, Lewis, 2000 */</span> </div><div class="line"><a name="l00589"></a><span class="lineno">  589</span>&#160; * </div><div class="line"><a name="l00590"></a><span class="lineno">  590</span>&#160; * </div><div class="line"><a name="l00591"></a><span class="lineno">  591</span>&#160; *   }; </div><div class="line"><a name="l00592"></a><span class="lineno">  592</span>&#160; *   constexpr LowStorageRungeKuttaScheme lsrk_scheme = stage_5_order_4; </div><div class="line"><a name="l00593"></a><span class="lineno">  593</span>&#160; * </div><div class="line"><a name="l00594"></a><span class="lineno">  594</span>&#160; * <span class="keyword">@end</span>code</div><div class="line"><a name="l00595"></a><span class="lineno">  595</span>&#160; * </div><div class="line"><a name="l00596"></a><span class="lineno">  596</span>&#160; * 最终，我们选择了空间离散化的一个细节，即单元间面的数值通量（黎曼求解器）。在这个程序中，我们实现了Lax--Friedrichs通量和Harten--Lax--van Leer(HLL)通量的一个改进版本。</div><div class="line"><a name="l00597"></a><span class="lineno">  597</span>&#160; * </div><div class="line"><a name="l00598"></a><span class="lineno">  598</span>&#160;</div><div class="line"><a name="l00599"></a><span class="lineno">  599</span>&#160; * </div><div class="line"><a name="l00600"></a><span class="lineno">  600</span>&#160; * </div><div class="line"><a name="l00601"></a><span class="lineno">  601</span>&#160; * @code</div><div class="line"><a name="l00602"></a><span class="lineno">  602</span>&#160; *   <span class="keyword">enum</span> EulerNumericalFlux </div><div class="line"><a name="l00603"></a><span class="lineno">  603</span>&#160; *   { </div><div class="line"><a name="l00604"></a><span class="lineno">  604</span>&#160; *     lax_friedrichs_modified, </div><div class="line"><a name="l00605"></a><span class="lineno">  605</span>&#160; *     harten_lax_vanleer, </div><div class="line"><a name="l00606"></a><span class="lineno">  606</span>&#160; *   }; </div><div class="line"><a name="l00607"></a><span class="lineno">  607</span>&#160; *   constexpr EulerNumericalFlux numerical_flux_type = lax_friedrichs_modified; </div><div class="line"><a name="l00608"></a><span class="lineno">  608</span>&#160; * </div><div class="line"><a name="l00609"></a><span class="lineno">  609</span>&#160; * <span class="keyword">@end</span>code</div><div class="line"><a name="l00610"></a><span class="lineno">  610</span>&#160; * </div><div class="line"><a name="l00611"></a><span class="lineno">  611</span>&#160; * </div><div class="line"><a name="l00612"></a><span class="lineno">  612</span>&#160; * &lt;a name=<span class="stringliteral">&quot;Equationdata&quot;</span>&gt;&lt;/a&gt; </div><div class="line"><a name="l00613"></a><span class="lineno">  613</span>&#160; * &lt;h3&gt;Equation data&lt;/h3&gt;</div><div class="line"><a name="l00614"></a><span class="lineno">  614</span>&#160; * </div><div class="line"><a name="l00615"></a><span class="lineno">  615</span>&#160;</div><div class="line"><a name="l00616"></a><span class="lineno">  616</span>&#160; * </div><div class="line"><a name="l00617"></a><span class="lineno">  617</span>&#160; * 我们现在定义了一个带有测试情况0的精确解的类和一个带有测试情况1的通道背景流场的类。鉴于欧拉方程是一个在 @f$d@f$ 维度上有 @f$d+2@f$ 个方程的问题，我们需要告诉函数基类正确的分量数量。</div><div class="line"><a name="l00618"></a><span class="lineno">  618</span>&#160; * </div><div class="line"><a name="l00619"></a><span class="lineno">  619</span>&#160;</div><div class="line"><a name="l00620"></a><span class="lineno">  620</span>&#160; * </div><div class="line"><a name="l00621"></a><span class="lineno">  621</span>&#160; * </div><div class="line"><a name="l00622"></a><span class="lineno">  622</span>&#160; * @code</div><div class="line"><a name="l00623"></a><span class="lineno">  623</span>&#160; *   <span class="keyword">template</span> &lt;<span class="keywordtype">int</span> dim&gt; </div><div class="line"><a name="l00624"></a><span class="lineno">  624</span>&#160; *   <span class="keyword">class </span>ExactSolution : <span class="keyword">public</span> <a class="code" href="classFunction.html">Function</a>&lt;dim&gt; </div><div class="line"><a name="l00625"></a><span class="lineno">  625</span>&#160; *   { </div><div class="line"><a name="l00626"></a><span class="lineno">  626</span>&#160; *   <span class="keyword">public</span>: </div><div class="line"><a name="l00627"></a><span class="lineno">  627</span>&#160; *     ExactSolution(<span class="keyword">const</span> <span class="keywordtype">double</span> time) </div><div class="line"><a name="l00628"></a><span class="lineno">  628</span>&#160; *       : <a class="code" href="classFunction.html">Function&lt;dim&gt;</a>(dim + 2, <a class="code" href="classFunctionTime.html#a8932e3ec9ed7b6f6d6a91c23f82e36d8">time</a>) </div><div class="line"><a name="l00629"></a><span class="lineno">  629</span>&#160; *     {} </div><div class="line"><a name="l00630"></a><span class="lineno">  630</span>&#160; * </div><div class="line"><a name="l00631"></a><span class="lineno">  631</span>&#160; *     <span class="keyword">virtual</span> <span class="keywordtype">double</span> <a class="code" href="classFunction.html#acbfcab66b2fc63bfea59268f40772bb4">value</a>(<span class="keyword">const</span> <a class="code" href="classPoint.html">Point&lt;dim&gt;</a> &amp; p, </div><div class="line"><a name="l00632"></a><span class="lineno">  632</span>&#160; *                          <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> component = 0) <span class="keyword">const override</span>; </div><div class="line"><a name="l00633"></a><span class="lineno">  633</span>&#160; *   }; </div><div class="line"><a name="l00634"></a><span class="lineno">  634</span>&#160; * </div><div class="line"><a name="l00635"></a><span class="lineno">  635</span>&#160; * <span class="keyword">@end</span>code</div><div class="line"><a name="l00636"></a><span class="lineno">  636</span>&#160; * </div><div class="line"><a name="l00637"></a><span class="lineno">  637</span>&#160; * 就实际实现的函数而言，分析性测试案例是一个等熵涡旋案例（例如参见Hesthaven和Warburton的书，第209页第6.6节中的例6.1），它满足欧拉方程，右侧的力项为零。考虑到这个定义，我们返回密度、动量或能量，这取决于所要求的成分。请注意，密度的原始定义涉及一些表达式的 @f$\frac{1}{<a class="code" href="namespaceinternal_1_1QGaussLobatto.html#ac1aec52fdbb26c78e2d32fc0bed659c7">\gamma</a> -1}@f$ -次方。由于 `<a class="code" href="vectorization_8h.html#ae5c8b2cd70b2640bab8f1ee4ccb7f4cc">std::pow</a>()` 在某些系统上的实现相当慢，我们用对数和指数（以2为底）来代替它，这在数学上是等价的，但通常优化得更好。与 `<a class="code" href="vectorization_8h.html#ae5c8b2cd70b2640bab8f1ee4ccb7f4cc">std::pow</a>()`, 相比，对于非常小的数字，这个公式可能会在最后一位数字上失去准确性，但我们还是很高兴，因为小数字映射为接近1的数据。</div><div class="line"><a name="l00638"></a><span class="lineno">  638</span>&#160; * </div><div class="line"><a name="l00639"></a><span class="lineno">  639</span>&#160;</div><div class="line"><a name="l00640"></a><span class="lineno">  640</span>&#160; * </div><div class="line"><a name="l00641"></a><span class="lineno">  641</span>&#160; * 对于通道测试案例，我们简单地选择密度为1， @f$x@f$ 方向的速度为0.4，其他方向的速度为0，以及对应于背景速度场测量的1.3声速的能量，根据关系 @f$E = \frac{c^2}{<a class="code" href="namespaceinternal_1_1QGaussLobatto.html#ac1aec52fdbb26c78e2d32fc0bed659c7">\gamma</a> (\<a class="code" href="namespaceinternal_1_1QGaussLobatto.html#ac1aec52fdbb26c78e2d32fc0bed659c7">gamma</a> -1)} + \frac 12 \rho \|u\|^2@f$ 计算得出。</div><div class="line"><a name="l00642"></a><span class="lineno">  642</span>&#160; * </div><div class="line"><a name="l00643"></a><span class="lineno">  643</span>&#160;</div><div class="line"><a name="l00644"></a><span class="lineno">  644</span>&#160; * </div><div class="line"><a name="l00645"></a><span class="lineno">  645</span>&#160; * </div><div class="line"><a name="l00646"></a><span class="lineno">  646</span>&#160; * @code</div><div class="line"><a name="l00647"></a><span class="lineno">  647</span>&#160; *   <span class="keyword">template</span> &lt;<span class="keywordtype">int</span> dim&gt; </div><div class="line"><a name="l00648"></a><span class="lineno">  648</span>&#160; *   <span class="keywordtype">double</span> ExactSolution&lt;dim&gt;::value(<span class="keyword">const</span> <a class="code" href="classPoint.html">Point&lt;dim&gt;</a> &amp; x, </div><div class="line"><a name="l00649"></a><span class="lineno">  649</span>&#160; *                                    <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> component) <span class="keyword">const</span> </div><div class="line"><a name="l00650"></a><span class="lineno">  650</span>&#160; *   { </div><div class="line"><a name="l00651"></a><span class="lineno">  651</span>&#160; *     <span class="keyword">const</span> <span class="keywordtype">double</span> t = this-&gt;<a class="code" href="classFunctionTime.html#ae7d37ddb04314b38cf67c6cba22923f6">get_time</a>(); </div><div class="line"><a name="l00652"></a><span class="lineno">  652</span>&#160; * </div><div class="line"><a name="l00653"></a><span class="lineno">  653</span>&#160; *     <span class="keywordflow">switch</span> (testcase) </div><div class="line"><a name="l00654"></a><span class="lineno">  654</span>&#160; *       { </div><div class="line"><a name="l00655"></a><span class="lineno">  655</span>&#160; *         <span class="keywordflow">case</span> 0: </div><div class="line"><a name="l00656"></a><span class="lineno">  656</span>&#160; *           { </div><div class="line"><a name="l00657"></a><span class="lineno">  657</span>&#160; *             <a class="code" href="group__Exceptions.html#ga70a0bb353656e704acf927945277bbc6">Assert</a>(dim == 2, <a class="code" href="group__Exceptions.html#ga7b52b286796c23ef9ff178faf7a4b68f">ExcNotImplemented</a>()); </div><div class="line"><a name="l00658"></a><span class="lineno">  658</span>&#160; *             <span class="keyword">const</span> <span class="keywordtype">double</span> beta = 5; </div><div class="line"><a name="l00659"></a><span class="lineno">  659</span>&#160; * </div><div class="line"><a name="l00660"></a><span class="lineno">  660</span>&#160; *             <a class="code" href="classPoint.html">Point&lt;dim&gt;</a> x0; </div><div class="line"><a name="l00661"></a><span class="lineno">  661</span>&#160; *             x0[0] = 5.; </div><div class="line"><a name="l00662"></a><span class="lineno">  662</span>&#160; *             <span class="keyword">const</span> <span class="keywordtype">double</span> radius_sqr = </div><div class="line"><a name="l00663"></a><span class="lineno">  663</span>&#160; *               (x - x0).norm_square() - 2. * (x[0] - x0[0]) * t + t * t; </div><div class="line"><a name="l00664"></a><span class="lineno">  664</span>&#160; *             <span class="keyword">const</span> <span class="keywordtype">double</span> factor = </div><div class="line"><a name="l00665"></a><span class="lineno">  665</span>&#160; *               beta / (<a class="code" href="namespacenumbers.html#a3e24f194a9cb9b6ff4442b8a7a877d4a">numbers::PI</a> * 2) * std::exp(1. - radius_sqr); </div><div class="line"><a name="l00666"></a><span class="lineno">  666</span>&#160; *             <span class="keyword">const</span> <span class="keywordtype">double</span> density_log = std::log2( </div><div class="line"><a name="l00667"></a><span class="lineno">  667</span>&#160; *               std::abs(1. - (<a class="code" href="namespaceinternal_1_1QGaussLobatto.html#ac1aec52fdbb26c78e2d32fc0bed659c7">gamma</a> - 1.) / <a class="code" href="namespaceinternal_1_1QGaussLobatto.html#ac1aec52fdbb26c78e2d32fc0bed659c7">gamma</a> * 0.25 * factor * factor)); </div><div class="line"><a name="l00668"></a><span class="lineno">  668</span>&#160; *             <span class="keyword">const</span> <span class="keywordtype">double</span> density = std::exp2(density_log * (1. / (<a class="code" href="namespaceinternal_1_1QGaussLobatto.html#ac1aec52fdbb26c78e2d32fc0bed659c7">gamma</a> - 1.))); </div><div class="line"><a name="l00669"></a><span class="lineno">  669</span>&#160; *             <span class="keyword">const</span> <span class="keywordtype">double</span> u       = 1. - factor * (x[1] - x0[1]); </div><div class="line"><a name="l00670"></a><span class="lineno">  670</span>&#160; *             <span class="keyword">const</span> <span class="keywordtype">double</span> v       = factor * (x[0] - t - x0[0]); </div><div class="line"><a name="l00671"></a><span class="lineno">  671</span>&#160; * </div><div class="line"><a name="l00672"></a><span class="lineno">  672</span>&#160; *             <span class="keywordflow">if</span> (component == 0) </div><div class="line"><a name="l00673"></a><span class="lineno">  673</span>&#160; *               <span class="keywordflow">return</span> density; </div><div class="line"><a name="l00674"></a><span class="lineno">  674</span>&#160; *             <span class="keywordflow">else</span> <span class="keywordflow">if</span> (component == 1) </div><div class="line"><a name="l00675"></a><span class="lineno">  675</span>&#160; *               <span class="keywordflow">return</span> density * u; </div><div class="line"><a name="l00676"></a><span class="lineno">  676</span>&#160; *             <span class="keywordflow">else</span> <span class="keywordflow">if</span> (component == 2) </div><div class="line"><a name="l00677"></a><span class="lineno">  677</span>&#160; *               <span class="keywordflow">return</span> density * v; </div><div class="line"><a name="l00678"></a><span class="lineno">  678</span>&#160; *             <span class="keywordflow">else</span> </div><div class="line"><a name="l00679"></a><span class="lineno">  679</span>&#160; *               { </div><div class="line"><a name="l00680"></a><span class="lineno">  680</span>&#160; *                 <span class="keyword">const</span> <span class="keywordtype">double</span> pressure = </div><div class="line"><a name="l00681"></a><span class="lineno">  681</span>&#160; *                   std::exp2(density_log * (<a class="code" href="namespaceinternal_1_1QGaussLobatto.html#ac1aec52fdbb26c78e2d32fc0bed659c7">gamma</a> / (<a class="code" href="namespaceinternal_1_1QGaussLobatto.html#ac1aec52fdbb26c78e2d32fc0bed659c7">gamma</a> - 1.))); </div><div class="line"><a name="l00682"></a><span class="lineno">  682</span>&#160; *                 <span class="keywordflow">return</span> pressure / (<a class="code" href="namespaceinternal_1_1QGaussLobatto.html#ac1aec52fdbb26c78e2d32fc0bed659c7">gamma</a> - 1.) + </div><div class="line"><a name="l00683"></a><span class="lineno">  683</span>&#160; *                        0.5 * (density * u * u + density * v * v); </div><div class="line"><a name="l00684"></a><span class="lineno">  684</span>&#160; *               } </div><div class="line"><a name="l00685"></a><span class="lineno">  685</span>&#160; *           } </div><div class="line"><a name="l00686"></a><span class="lineno">  686</span>&#160; * </div><div class="line"><a name="l00687"></a><span class="lineno">  687</span>&#160; *         <span class="keywordflow">case</span> 1: </div><div class="line"><a name="l00688"></a><span class="lineno">  688</span>&#160; *           { </div><div class="line"><a name="l00689"></a><span class="lineno">  689</span>&#160; *             <span class="keywordflow">if</span> (component == 0) </div><div class="line"><a name="l00690"></a><span class="lineno">  690</span>&#160; *               <span class="keywordflow">return</span> 1.; </div><div class="line"><a name="l00691"></a><span class="lineno">  691</span>&#160; *             <span class="keywordflow">else</span> <span class="keywordflow">if</span> (component == 1) </div><div class="line"><a name="l00692"></a><span class="lineno">  692</span>&#160; *               <span class="keywordflow">return</span> 0.4; </div><div class="line"><a name="l00693"></a><span class="lineno">  693</span>&#160; *             <span class="keywordflow">else</span> <span class="keywordflow">if</span> (component == dim + 1) </div><div class="line"><a name="l00694"></a><span class="lineno">  694</span>&#160; *               <span class="keywordflow">return</span> 3.097857142857143; </div><div class="line"><a name="l00695"></a><span class="lineno">  695</span>&#160; *             <span class="keywordflow">else</span> </div><div class="line"><a name="l00696"></a><span class="lineno">  696</span>&#160; *               <span class="keywordflow">return</span> 0.; </div><div class="line"><a name="l00697"></a><span class="lineno">  697</span>&#160; *           } </div><div class="line"><a name="l00698"></a><span class="lineno">  698</span>&#160; * </div><div class="line"><a name="l00699"></a><span class="lineno">  699</span>&#160; *         <span class="keywordflow">default</span>: </div><div class="line"><a name="l00700"></a><span class="lineno">  700</span>&#160; *           <a class="code" href="group__Exceptions.html#ga70a0bb353656e704acf927945277bbc6">Assert</a>(<span class="keyword">false</span>, <a class="code" href="group__Exceptions.html#ga7b52b286796c23ef9ff178faf7a4b68f">ExcNotImplemented</a>()); </div><div class="line"><a name="l00701"></a><span class="lineno">  701</span>&#160; *           <span class="keywordflow">return</span> 0.; </div><div class="line"><a name="l00702"></a><span class="lineno">  702</span>&#160; *       } </div><div class="line"><a name="l00703"></a><span class="lineno">  703</span>&#160; *   } </div><div class="line"><a name="l00704"></a><span class="lineno">  704</span>&#160; * </div><div class="line"><a name="l00705"></a><span class="lineno">  705</span>&#160; * <span class="keyword">@end</span>code</div><div class="line"><a name="l00706"></a><span class="lineno">  706</span>&#160; * </div><div class="line"><a name="l00707"></a><span class="lineno">  707</span>&#160; * </div><div class="line"><a name="l00708"></a><span class="lineno">  708</span>&#160; * &lt;a name=<span class="stringliteral">&quot;LowstorageexplicitRungeKuttatimeintegrators&quot;</span>&gt;&lt;/a&gt; </div><div class="line"><a name="l00709"></a><span class="lineno">  709</span>&#160; * &lt;h3&gt;Low-storage <span class="keyword">explicit</span> Runge--Kutta time integrators&lt;/h3&gt;</div><div class="line"><a name="l00710"></a><span class="lineno">  710</span>&#160; * </div><div class="line"><a name="l00711"></a><span class="lineno">  711</span>&#160;</div><div class="line"><a name="l00712"></a><span class="lineno">  712</span>&#160; * </div><div class="line"><a name="l00713"></a><span class="lineno">  713</span>&#160; * 接下来的几行实现了一些低存储量的Runge--Kutta方法的变体。这些方法有特定的布彻表，系数为 @f$b_i@f$ 和 @f$a_i@f$ ，如介绍中所示。如同Runge--Kutta方法的惯例，我们可以从这些系数中推导出时间步骤 @f$c_i = \sum_{j=1}^{i-2} b_i + a_{i-1}@f$ 。这种方案的主要优点是每个阶段只需要两个向量，即解的累积部分 @f$\mathbf{<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a6b25dd8f005063d8d2b0a4bdb0d277f3">w</a>}@f$ （在最后一个阶段后的新时间 @f$t^{n+1}@f$ 保持解 @f$\mathbf{<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a6b25dd8f005063d8d2b0a4bdb0d277f3">w</a>}^{n+1}@f$ ），在各阶段被评估的更新向量 @f$\mathbf{r}_i@f$ ，加上一个向量 @f$\mathbf{k}_i@f$ 来保持算子评估。这样的Runge--Kutta设置减少了内存存储和内存访问。由于内存带宽通常是现代硬件上的性能限制因素，当微分算子的评估得到很好的优化时，性能可以比标准的时间积分器得到改善。考虑到传统的Runge--Kutta方案可能允许稍大的时间步长，因为更多的自由参数可以获得更好的稳定性，这一点也是真实的。</div><div class="line"><a name="l00714"></a><span class="lineno">  714</span>&#160; * </div><div class="line"><a name="l00715"></a><span class="lineno">  715</span>&#160;</div><div class="line"><a name="l00716"></a><span class="lineno">  716</span>&#160; * </div><div class="line"><a name="l00717"></a><span class="lineno">  717</span>&#160; * 在本教程中，我们集中讨论Kennedy, Carpenter和Lewis(2000)文章中定义的低存储方案的几个变体，以及Tselios和Simos(2007)描述的一个变体。还有一大系列的其他方案，可以通过额外的系数集或稍微不同的更新公式来解决。</div><div class="line"><a name="l00718"></a><span class="lineno">  718</span>&#160; * </div><div class="line"><a name="l00719"></a><span class="lineno">  719</span>&#160;</div><div class="line"><a name="l00720"></a><span class="lineno">  720</span>&#160; * </div><div class="line"><a name="l00721"></a><span class="lineno">  721</span>&#160; * 我们为这四种积分器定义了一个单一的类，用上述的枚举来区分。对每个方案，我们再将 @f$b_i@f$ 和 @f$a_i@f$ 的向量填充到类中的给定变量。</div><div class="line"><a name="l00722"></a><span class="lineno">  722</span>&#160; * </div><div class="line"><a name="l00723"></a><span class="lineno">  723</span>&#160;</div><div class="line"><a name="l00724"></a><span class="lineno">  724</span>&#160; * </div><div class="line"><a name="l00725"></a><span class="lineno">  725</span>&#160; * </div><div class="line"><a name="l00726"></a><span class="lineno">  726</span>&#160; * @code</div><div class="line"><a name="l00727"></a><span class="lineno">  727</span>&#160; *   class LowStorageRungeKuttaIntegrator </div><div class="line"><a name="l00728"></a><span class="lineno">  728</span>&#160; *   { </div><div class="line"><a name="l00729"></a><span class="lineno">  729</span>&#160; *   <span class="keyword">public</span>: </div><div class="line"><a name="l00730"></a><span class="lineno">  730</span>&#160; *     LowStorageRungeKuttaIntegrator(<span class="keyword">const</span> LowStorageRungeKuttaScheme scheme) </div><div class="line"><a name="l00731"></a><span class="lineno">  731</span>&#160; *     { </div><div class="line"><a name="l00732"></a><span class="lineno">  732</span>&#160; *       <a class="code" href="namespaceTimeStepping.html#abff97b5326e452552f108a379dd6cff4">TimeStepping::runge_kutta_method</a> lsrk; </div><div class="line"><a name="l00733"></a><span class="lineno">  733</span>&#160; * </div><div class="line"><a name="l00734"></a><span class="lineno">  734</span>&#160; * <span class="keyword">@end</span>code</div><div class="line"><a name="l00735"></a><span class="lineno">  735</span>&#160; * </div><div class="line"><a name="l00736"></a><span class="lineno">  736</span>&#160; * 首先是Kennedy等人（2000）提出的三阶方案。虽然它的稳定区域比其他方案小得多，但它只涉及三个阶段，所以在每个阶段的工作方面很有竞争力。</div><div class="line"><a name="l00737"></a><span class="lineno">  737</span>&#160; * </div><div class="line"><a name="l00738"></a><span class="lineno">  738</span>&#160;</div><div class="line"><a name="l00739"></a><span class="lineno">  739</span>&#160; * </div><div class="line"><a name="l00740"></a><span class="lineno">  740</span>&#160; * </div><div class="line"><a name="l00741"></a><span class="lineno">  741</span>&#160; * @code</div><div class="line"><a name="l00742"></a><span class="lineno">  742</span>&#160; *       <span class="keywordflow">switch</span> (scheme) </div><div class="line"><a name="l00743"></a><span class="lineno">  743</span>&#160; *         { </div><div class="line"><a name="l00744"></a><span class="lineno">  744</span>&#160; *           <span class="keywordflow">case</span> stage_3_order_3: </div><div class="line"><a name="l00745"></a><span class="lineno">  745</span>&#160; *             { </div><div class="line"><a name="l00746"></a><span class="lineno">  746</span>&#160; *               lsrk = <a class="code" href="namespaceTimeStepping.html#abff97b5326e452552f108a379dd6cff4aba5c997ffa7c63d0c0f6b046a53d63bf">TimeStepping::LOW_STORAGE_RK_STAGE3_ORDER3</a>; </div><div class="line"><a name="l00747"></a><span class="lineno">  747</span>&#160; *               <span class="keywordflow">break</span>; </div><div class="line"><a name="l00748"></a><span class="lineno">  748</span>&#160; *             } </div><div class="line"><a name="l00749"></a><span class="lineno">  749</span>&#160; * </div><div class="line"><a name="l00750"></a><span class="lineno">  750</span>&#160; * <span class="keyword">@end</span>code</div><div class="line"><a name="l00751"></a><span class="lineno">  751</span>&#160; * </div><div class="line"><a name="l00752"></a><span class="lineno">  752</span>&#160; * 下一个方案是四阶的五级方案，同样在Kennedy等人（2000）的论文中定义。</div><div class="line"><a name="l00753"></a><span class="lineno">  753</span>&#160; * </div><div class="line"><a name="l00754"></a><span class="lineno">  754</span>&#160;</div><div class="line"><a name="l00755"></a><span class="lineno">  755</span>&#160; * </div><div class="line"><a name="l00756"></a><span class="lineno">  756</span>&#160; * </div><div class="line"><a name="l00757"></a><span class="lineno">  757</span>&#160; * @code</div><div class="line"><a name="l00758"></a><span class="lineno">  758</span>&#160; *           <span class="keywordflow">case</span> stage_5_order_4: </div><div class="line"><a name="l00759"></a><span class="lineno">  759</span>&#160; *             { </div><div class="line"><a name="l00760"></a><span class="lineno">  760</span>&#160; *               lsrk = <a class="code" href="namespaceTimeStepping.html#abff97b5326e452552f108a379dd6cff4af4a68ccb74e043ac956cddf23fa57e48">TimeStepping::LOW_STORAGE_RK_STAGE5_ORDER4</a>; </div><div class="line"><a name="l00761"></a><span class="lineno">  761</span>&#160; *               <span class="keywordflow">break</span>; </div><div class="line"><a name="l00762"></a><span class="lineno">  762</span>&#160; *             } </div><div class="line"><a name="l00763"></a><span class="lineno">  763</span>&#160; * </div><div class="line"><a name="l00764"></a><span class="lineno">  764</span>&#160; * <span class="keyword">@end</span>code</div><div class="line"><a name="l00765"></a><span class="lineno">  765</span>&#160; * </div><div class="line"><a name="l00766"></a><span class="lineno">  766</span>&#160; * 下面这个七级和四阶的方案已经明确地推导出用于声学问题。它在四阶方案中兼顾了虚特征值的精度，并结合了一个大的稳定区域。由于DG方案在最高频率之间是耗散的，这不一定转化为每级可能的最高时间步长。在本教程方案的背景下，数值通量在耗散中起着至关重要的作用，因此也是最大的稳定时间步长。对于修改后的Lax--Friedrichs通量，如果只考虑稳定性，该方案在每级步长方面与`stage_5_order_4`方案相似，但对于HLL通量来说，效率稍低。</div><div class="line"><a name="l00767"></a><span class="lineno">  767</span>&#160; * </div><div class="line"><a name="l00768"></a><span class="lineno">  768</span>&#160;</div><div class="line"><a name="l00769"></a><span class="lineno">  769</span>&#160; * </div><div class="line"><a name="l00770"></a><span class="lineno">  770</span>&#160; * </div><div class="line"><a name="l00771"></a><span class="lineno">  771</span>&#160; * @code</div><div class="line"><a name="l00772"></a><span class="lineno">  772</span>&#160; *           <span class="keywordflow">case</span> stage_7_order_4: </div><div class="line"><a name="l00773"></a><span class="lineno">  773</span>&#160; *             { </div><div class="line"><a name="l00774"></a><span class="lineno">  774</span>&#160; *               lsrk = <a class="code" href="namespaceTimeStepping.html#abff97b5326e452552f108a379dd6cff4af34241e1b27c2f0f2f90715ee9f97bdb">TimeStepping::LOW_STORAGE_RK_STAGE7_ORDER4</a>; </div><div class="line"><a name="l00775"></a><span class="lineno">  775</span>&#160; *               <span class="keywordflow">break</span>; </div><div class="line"><a name="l00776"></a><span class="lineno">  776</span>&#160; *             } </div><div class="line"><a name="l00777"></a><span class="lineno">  777</span>&#160; * </div><div class="line"><a name="l00778"></a><span class="lineno">  778</span>&#160; * <span class="keyword">@end</span>code</div><div class="line"><a name="l00779"></a><span class="lineno">  779</span>&#160; * </div><div class="line"><a name="l00780"></a><span class="lineno">  780</span>&#160; * 这里包括的最后一个方案是Kennedy等人（2000）的五阶九级方案。它是这里使用的方案中最精确的，但是较高的精度牺牲了一些稳定性，所以每级的归一化步长比四阶方案要小。</div><div class="line"><a name="l00781"></a><span class="lineno">  781</span>&#160; * </div><div class="line"><a name="l00782"></a><span class="lineno">  782</span>&#160;</div><div class="line"><a name="l00783"></a><span class="lineno">  783</span>&#160; * </div><div class="line"><a name="l00784"></a><span class="lineno">  784</span>&#160; * </div><div class="line"><a name="l00785"></a><span class="lineno">  785</span>&#160; * @code</div><div class="line"><a name="l00786"></a><span class="lineno">  786</span>&#160; *           <span class="keywordflow">case</span> stage_9_order_5: </div><div class="line"><a name="l00787"></a><span class="lineno">  787</span>&#160; *             { </div><div class="line"><a name="l00788"></a><span class="lineno">  788</span>&#160; *               lsrk = <a class="code" href="namespaceTimeStepping.html#abff97b5326e452552f108a379dd6cff4a6a1cbeb6dd2a5ed5ac2e3efe3293e941">TimeStepping::LOW_STORAGE_RK_STAGE9_ORDER5</a>; </div><div class="line"><a name="l00789"></a><span class="lineno">  789</span>&#160; *               <span class="keywordflow">break</span>; </div><div class="line"><a name="l00790"></a><span class="lineno">  790</span>&#160; *             } </div><div class="line"><a name="l00791"></a><span class="lineno">  791</span>&#160; * </div><div class="line"><a name="l00792"></a><span class="lineno">  792</span>&#160; *           <span class="keywordflow">default</span>: </div><div class="line"><a name="l00793"></a><span class="lineno">  793</span>&#160; *             <a class="code" href="group__Exceptions.html#gafc0ca7ad85b3ebd64e8e51689ac85caf">AssertThrow</a>(<span class="keyword">false</span>, <a class="code" href="group__Exceptions.html#ga7b52b286796c23ef9ff178faf7a4b68f">ExcNotImplemented</a>()); </div><div class="line"><a name="l00794"></a><span class="lineno">  794</span>&#160; *         } </div><div class="line"><a name="l00795"></a><span class="lineno">  795</span>&#160; *       <a class="code" href="classTimeStepping_1_1LowStorageRungeKutta.html">TimeStepping::LowStorageRungeKutta</a>&lt; </div><div class="line"><a name="l00796"></a><span class="lineno">  796</span>&#160; *         <a class="code" href="classLinearAlgebra_1_1distributed_1_1Vector.html">LinearAlgebra::distributed::Vector&lt;Number&gt;</a>&gt; </div><div class="line"><a name="l00797"></a><span class="lineno">  797</span>&#160; *         rk_integrator(lsrk); </div><div class="line"><a name="l00798"></a><span class="lineno">  798</span>&#160; *       rk_integrator.get_coefficients(ai, bi, ci); </div><div class="line"><a name="l00799"></a><span class="lineno">  799</span>&#160; *     } </div><div class="line"><a name="l00800"></a><span class="lineno">  800</span>&#160; * </div><div class="line"><a name="l00801"></a><span class="lineno">  801</span>&#160; *     <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> n_stages() const </div><div class="line"><a name="l00802"></a><span class="lineno">  802</span>&#160; *     { </div><div class="line"><a name="l00803"></a><span class="lineno">  803</span>&#160; *       <span class="keywordflow">return</span> bi.size(); </div><div class="line"><a name="l00804"></a><span class="lineno">  804</span>&#160; *     } </div><div class="line"><a name="l00805"></a><span class="lineno">  805</span>&#160; * </div><div class="line"><a name="l00806"></a><span class="lineno">  806</span>&#160; * <span class="keyword">@end</span>code</div><div class="line"><a name="l00807"></a><span class="lineno">  807</span>&#160; * </div><div class="line"><a name="l00808"></a><span class="lineno">  808</span>&#160; * 时间积分器的主要功能是通过阶段，评估算子，为下一次评估准备  @f$\mathbf{r}_i@f$  矢量，并更新解决方案矢量  @f$\mathbf{<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a6b25dd8f005063d8d2b0a4bdb0d277f3">w</a>}@f$  。我们把工作交给所涉及的`pde_operator`，以便能够把Runge--Kutta设置的矢量操作与微分算子的评估合并起来，以获得更好的性能，所以我们在这里所做的就是委托矢量和系数。</div><div class="line"><a name="l00809"></a><span class="lineno">  809</span>&#160; * </div><div class="line"><a name="l00810"></a><span class="lineno">  810</span>&#160;</div><div class="line"><a name="l00811"></a><span class="lineno">  811</span>&#160; * </div><div class="line"><a name="l00812"></a><span class="lineno">  812</span>&#160; * 我们单独调用第一阶段的算子，因为我们需要稍微修改一下那里的参数。我们从旧的解决方案 @f$\mathbf{<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a6b25dd8f005063d8d2b0a4bdb0d277f3">w</a>}^n@f$ 而不是 @f$\mathbf r_i@f$ 向量中评估解决方案，所以第一个参数是`solution`。我们在这里让阶段向量 @f$\mathbf{r}_i@f$ 也持有评估的临时结果，因为它在其他情况下不会被使用。对于所有后续阶段，我们使用向量`vec_ki`作为第二个向量参数来存储运算符的求值结果。最后，当我们到了最后一个阶段，我们必须跳过对向量 @f$\mathbf{r}_{s+1}@f$ 的计算，因为没有系数 @f$a_s@f$ 可用（也不会用到）。</div><div class="line"><a name="l00813"></a><span class="lineno">  813</span>&#160; * </div><div class="line"><a name="l00814"></a><span class="lineno">  814</span>&#160;</div><div class="line"><a name="l00815"></a><span class="lineno">  815</span>&#160; * </div><div class="line"><a name="l00816"></a><span class="lineno">  816</span>&#160; * </div><div class="line"><a name="l00817"></a><span class="lineno">  817</span>&#160; * @code</div><div class="line"><a name="l00818"></a><span class="lineno">  818</span>&#160; *     <span class="keyword">template</span> &lt;<span class="keyword">typename</span> VectorType, <span class="keyword">typename</span> Operator&gt; </div><div class="line"><a name="l00819"></a><span class="lineno">  819</span>&#160; *     <span class="keywordtype">void</span> perform_time_step(<span class="keyword">const</span> Operator &amp;pde_operator, </div><div class="line"><a name="l00820"></a><span class="lineno">  820</span>&#160; *                            <span class="keyword">const</span> <span class="keywordtype">double</span>    current_time, </div><div class="line"><a name="l00821"></a><span class="lineno">  821</span>&#160; *                            <span class="keyword">const</span> <span class="keywordtype">double</span>    time_step, </div><div class="line"><a name="l00822"></a><span class="lineno">  822</span>&#160; *                            <a class="code" href="classVectorType.html">VectorType</a> &amp;    solution, </div><div class="line"><a name="l00823"></a><span class="lineno">  823</span>&#160; *                            <a class="code" href="classVectorType.html">VectorType</a> &amp;    vec_ri, </div><div class="line"><a name="l00824"></a><span class="lineno">  824</span>&#160; *                            <a class="code" href="classVectorType.html">VectorType</a> &amp;    vec_ki) <span class="keyword">const</span> </div><div class="line"><a name="l00825"></a><span class="lineno">  825</span>&#160; *     { </div><div class="line"><a name="l00826"></a><span class="lineno">  826</span>&#160; *       <a class="code" href="group__Exceptions.html#ga9442b63275c9ef3fab29bc222831c49c">AssertDimension</a>(ai.size() + 1, bi.size()); </div><div class="line"><a name="l00827"></a><span class="lineno">  827</span>&#160; * </div><div class="line"><a name="l00828"></a><span class="lineno">  828</span>&#160; *       pde_operator.perform_stage(current_time, </div><div class="line"><a name="l00829"></a><span class="lineno">  829</span>&#160; *                                  bi[0] * time_step, </div><div class="line"><a name="l00830"></a><span class="lineno">  830</span>&#160; *                                  ai[0] * time_step, </div><div class="line"><a name="l00831"></a><span class="lineno">  831</span>&#160; *                                  solution, </div><div class="line"><a name="l00832"></a><span class="lineno">  832</span>&#160; *                                  vec_ri, </div><div class="line"><a name="l00833"></a><span class="lineno">  833</span>&#160; *                                  solution, </div><div class="line"><a name="l00834"></a><span class="lineno">  834</span>&#160; *                                  vec_ri); </div><div class="line"><a name="l00835"></a><span class="lineno">  835</span>&#160; * </div><div class="line"><a name="l00836"></a><span class="lineno">  836</span>&#160; *       <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> stage = 1; stage &lt; bi.size(); ++stage) </div><div class="line"><a name="l00837"></a><span class="lineno">  837</span>&#160; *         { </div><div class="line"><a name="l00838"></a><span class="lineno">  838</span>&#160; *           <span class="keyword">const</span> <span class="keywordtype">double</span> c_i = ci[stage]; </div><div class="line"><a name="l00839"></a><span class="lineno">  839</span>&#160; *           pde_operator.perform_stage(current_time + c_i * time_step, </div><div class="line"><a name="l00840"></a><span class="lineno">  840</span>&#160; *                                      bi[stage] * time_step, </div><div class="line"><a name="l00841"></a><span class="lineno">  841</span>&#160; *                                      (stage == bi.size() - 1 ? </div><div class="line"><a name="l00842"></a><span class="lineno">  842</span>&#160; *                                         0 : </div><div class="line"><a name="l00843"></a><span class="lineno">  843</span>&#160; *                                         ai[stage] * time_step), </div><div class="line"><a name="l00844"></a><span class="lineno">  844</span>&#160; *                                      vec_ri, </div><div class="line"><a name="l00845"></a><span class="lineno">  845</span>&#160; *                                      vec_ki, </div><div class="line"><a name="l00846"></a><span class="lineno">  846</span>&#160; *                                      solution, </div><div class="line"><a name="l00847"></a><span class="lineno">  847</span>&#160; *                                      vec_ri); </div><div class="line"><a name="l00848"></a><span class="lineno">  848</span>&#160; *         } </div><div class="line"><a name="l00849"></a><span class="lineno">  849</span>&#160; *     } </div><div class="line"><a name="l00850"></a><span class="lineno">  850</span>&#160; * </div><div class="line"><a name="l00851"></a><span class="lineno">  851</span>&#160; *   <span class="keyword">private</span>: </div><div class="line"><a name="l00852"></a><span class="lineno">  852</span>&#160; *     std::vector&lt;double&gt; bi; </div><div class="line"><a name="l00853"></a><span class="lineno">  853</span>&#160; *     std::vector&lt;double&gt; ai; </div><div class="line"><a name="l00854"></a><span class="lineno">  854</span>&#160; *     std::vector&lt;double&gt; ci; </div><div class="line"><a name="l00855"></a><span class="lineno">  855</span>&#160; *   }; </div><div class="line"><a name="l00856"></a><span class="lineno">  856</span>&#160; * </div><div class="line"><a name="l00857"></a><span class="lineno">  857</span>&#160; * <span class="keyword">@end</span>code</div><div class="line"><a name="l00858"></a><span class="lineno">  858</span>&#160; * </div><div class="line"><a name="l00859"></a><span class="lineno">  859</span>&#160; * </div><div class="line"><a name="l00860"></a><span class="lineno">  860</span>&#160; * &lt;a name=<span class="stringliteral">&quot;ImplementationofpointwiseoperationsoftheEulerequations&quot;</span>&gt;&lt;/a&gt; </div><div class="line"><a name="l00861"></a><span class="lineno">  861</span>&#160; * &lt;h3&gt;Implementation of <a class="code" href="namespaceOpenCASCADE.html#a9509efa83e3b2fa42616fe0623cba696">point</a>-wise operations of the Euler equations&lt;/h3&gt;</div><div class="line"><a name="l00862"></a><span class="lineno">  862</span>&#160; * </div><div class="line"><a name="l00863"></a><span class="lineno">  863</span>&#160;</div><div class="line"><a name="l00864"></a><span class="lineno">  864</span>&#160; * </div><div class="line"><a name="l00865"></a><span class="lineno">  865</span>&#160; * 在下面的函数中，我们实现了与欧拉方程有关的各种特定问题的运算。每个函数都作用于我们在解向量中持有的守恒变量向量 @f$[\rho, \rho\mathbf{u}, <a class="code" href="namespacenumbers.html#a3c7239f00d5e87dfcf6dd19cbc3ddc74">E</a>]@f$ ，并计算各种派生量。</div><div class="line"><a name="l00866"></a><span class="lineno">  866</span>&#160; * </div><div class="line"><a name="l00867"></a><span class="lineno">  867</span>&#160;</div><div class="line"><a name="l00868"></a><span class="lineno">  868</span>&#160; * </div><div class="line"><a name="l00869"></a><span class="lineno">  869</span>&#160; * 首先是速度的计算，我们从动量变量 @f$\rho \mathbf{u}@f$ 除以 @f$\rho@f$ 得出。这里需要注意的是，我们用关键字`<a class="code" href="config_8h.html#a1d1d58e8be15e5c4285f6892e5f33136">DEAL_II_ALWAYS_INLINE</a>`来装饰所有这些函数。这是一个特殊的宏，映射到一个编译器专用的关键字，告诉编译器永远不要为这些函数创建一个函数调用，而是将实现&lt;a href=<span class="stringliteral">&quot;https:en.wikipedia.org/wiki/Inline_function&quot;</span>&gt;<span class="keyword">inline</span>&lt;/a&gt;移到它们被调用的地方。这对性能至关重要，因为我们对其中一些函数的调用达到了几百万甚至几十亿次。例如，我们既使用速度来计算通量，也使用速度来计算压力，而这两个地方都要在每个单元的每个正交点进行评估。确保这些函数是内联的，不仅可以确保处理器不必执行跳转指令进入函数（以及相应的返回跳转），而且编译器可以在调用函数的地方之后的代码中重新使用一个函数的上下文的中间信息。(我们注意到，编译器通常很善于自己找出哪些函数要内联。这里有一个地方，编译器可能是自己想出来的，也可能不是，但我们可以肯定的是，内联是一种胜利。)</div><div class="line"><a name="l00870"></a><span class="lineno">  870</span>&#160; * </div><div class="line"><a name="l00871"></a><span class="lineno">  871</span>&#160;</div><div class="line"><a name="l00872"></a><span class="lineno">  872</span>&#160; * </div><div class="line"><a name="l00873"></a><span class="lineno">  873</span>&#160; * 我们应用的另一个技巧是为反密度设置一个单独的变量  @f$\frac{1}{\rho}@f$  。这使得编译器只对通量进行一次除法，尽管除法在多个地方使用。由于除法的费用大约是乘法或加法的10到20倍，避免多余的除法对性能至关重要。我们注意到，由于四舍五入的影响，在浮点运算中，先取反数，后与之相乘并不等同于除法，所以编译器不允许用标准的优化标志来交换一种方式。然而，以正确的方式编写代码也不是特别困难。</div><div class="line"><a name="l00874"></a><span class="lineno">  874</span>&#160; * </div><div class="line"><a name="l00875"></a><span class="lineno">  875</span>&#160;</div><div class="line"><a name="l00876"></a><span class="lineno">  876</span>&#160; * </div><div class="line"><a name="l00877"></a><span class="lineno">  877</span>&#160; * 总而言之，所选择的总是内联和仔细定义昂贵的算术运算的策略使我们能够写出紧凑的代码，而不需要将所有的中间结果传递出去，尽管要确保代码映射到优秀的机器码。</div><div class="line"><a name="l00878"></a><span class="lineno">  878</span>&#160; * </div><div class="line"><a name="l00879"></a><span class="lineno">  879</span>&#160;</div><div class="line"><a name="l00880"></a><span class="lineno">  880</span>&#160; * </div><div class="line"><a name="l00881"></a><span class="lineno">  881</span>&#160; * </div><div class="line"><a name="l00882"></a><span class="lineno">  882</span>&#160; * @code</div><div class="line"><a name="l00883"></a><span class="lineno">  883</span>&#160; *   <span class="keyword">template</span> &lt;<span class="keywordtype">int</span> dim, <span class="keyword">typename</span> Number&gt; </div><div class="line"><a name="l00884"></a><span class="lineno">  884</span>&#160; *   <span class="keyword">inline</span> <a class="code" href="config_8h.html#a1d1d58e8be15e5c4285f6892e5f33136">DEAL_II_ALWAYS_INLINE</a> <span class="comment">// </span></div><div class="line"><a name="l00885"></a><span class="lineno">  885</span>&#160; *     <a class="code" href="classTensor.html">Tensor&lt;1, dim, Number&gt;</a> </div><div class="line"><a name="l00886"></a><span class="lineno">  886</span>&#160; *     euler_velocity(<span class="keyword">const</span> <a class="code" href="classTensor.html">Tensor&lt;1, dim + 2, Number&gt;</a> &amp;conserved_variables) </div><div class="line"><a name="l00887"></a><span class="lineno">  887</span>&#160; *   { </div><div class="line"><a name="l00888"></a><span class="lineno">  888</span>&#160; *     <span class="keyword">const</span> Number inverse_density = Number(1.) / conserved_variables[0]; </div><div class="line"><a name="l00889"></a><span class="lineno">  889</span>&#160; * </div><div class="line"><a name="l00890"></a><span class="lineno">  890</span>&#160; *     <a class="code" href="classTensor.html">Tensor&lt;1, dim, Number&gt;</a> velocity; </div><div class="line"><a name="l00891"></a><span class="lineno">  891</span>&#160; *     <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a15728437b942dab0b0042eb06a407d2c">d</a> = 0; <a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a15728437b942dab0b0042eb06a407d2c">d</a> &lt; dim; ++<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a15728437b942dab0b0042eb06a407d2c">d</a>) </div><div class="line"><a name="l00892"></a><span class="lineno">  892</span>&#160; *       velocity[<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a15728437b942dab0b0042eb06a407d2c">d</a>] = conserved_variables[1 + <a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a15728437b942dab0b0042eb06a407d2c">d</a>] * inverse_density; </div><div class="line"><a name="l00893"></a><span class="lineno">  893</span>&#160; * </div><div class="line"><a name="l00894"></a><span class="lineno">  894</span>&#160; *     <span class="keywordflow">return</span> velocity; </div><div class="line"><a name="l00895"></a><span class="lineno">  895</span>&#160; *   } </div><div class="line"><a name="l00896"></a><span class="lineno">  896</span>&#160; * </div><div class="line"><a name="l00897"></a><span class="lineno">  897</span>&#160; * <span class="keyword">@end</span>code</div><div class="line"><a name="l00898"></a><span class="lineno">  898</span>&#160; * </div><div class="line"><a name="l00899"></a><span class="lineno">  899</span>&#160; * 下一个函数从保守变量的矢量中计算压力，使用公式  @f$p = (<a class="code" href="namespaceinternal_1_1QGaussLobatto.html#ac1aec52fdbb26c78e2d32fc0bed659c7">\gamma</a> - 1) \left(<a class="code" href="namespacenumbers.html#a3c7239f00d5e87dfcf6dd19cbc3ddc74">E</a> - \frac 12 \rho \mathbf{u}\cdot \mathbf{u}\right)@f$  。如上所述，我们使用来自`euler_velocity()`函数的速度。注意，我们需要在这里指定第一个模板参数`dim`，因为编译器无法从张量的参数中推导出它，而第二个参数（数字类型）可以自动推导出来。</div><div class="line"><a name="l00900"></a><span class="lineno">  900</span>&#160; * </div><div class="line"><a name="l00901"></a><span class="lineno">  901</span>&#160;</div><div class="line"><a name="l00902"></a><span class="lineno">  902</span>&#160; * </div><div class="line"><a name="l00903"></a><span class="lineno">  903</span>&#160; * </div><div class="line"><a name="l00904"></a><span class="lineno">  904</span>&#160; * @code</div><div class="line"><a name="l00905"></a><span class="lineno">  905</span>&#160; *   <span class="keyword">template</span> &lt;<span class="keywordtype">int</span> dim, <span class="keyword">typename</span> Number&gt; </div><div class="line"><a name="l00906"></a><span class="lineno">  906</span>&#160; *   <span class="keyword">inline</span> <a class="code" href="config_8h.html#a1d1d58e8be15e5c4285f6892e5f33136">DEAL_II_ALWAYS_INLINE</a> <span class="comment">// </span></div><div class="line"><a name="l00907"></a><span class="lineno">  907</span>&#160; *     Number </div><div class="line"><a name="l00908"></a><span class="lineno">  908</span>&#160; *     euler_pressure(<span class="keyword">const</span> <a class="code" href="classTensor.html">Tensor&lt;1, dim + 2, Number&gt;</a> &amp;conserved_variables) </div><div class="line"><a name="l00909"></a><span class="lineno">  909</span>&#160; *   { </div><div class="line"><a name="l00910"></a><span class="lineno">  910</span>&#160; *     <span class="keyword">const</span> <a class="code" href="classTensor.html">Tensor&lt;1, dim, Number&gt;</a> velocity = </div><div class="line"><a name="l00911"></a><span class="lineno">  911</span>&#160; *       euler_velocity&lt;dim&gt;(conserved_variables); </div><div class="line"><a name="l00912"></a><span class="lineno">  912</span>&#160; * </div><div class="line"><a name="l00913"></a><span class="lineno">  913</span>&#160; *     Number rho_u_dot_u = conserved_variables[1] * velocity[0]; </div><div class="line"><a name="l00914"></a><span class="lineno">  914</span>&#160; *     <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a15728437b942dab0b0042eb06a407d2c">d</a> = 1; <a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a15728437b942dab0b0042eb06a407d2c">d</a> &lt; dim; ++<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a15728437b942dab0b0042eb06a407d2c">d</a>) </div><div class="line"><a name="l00915"></a><span class="lineno">  915</span>&#160; *       rho_u_dot_u += conserved_variables[1 + <a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a15728437b942dab0b0042eb06a407d2c">d</a>] * velocity[<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a15728437b942dab0b0042eb06a407d2c">d</a>]; </div><div class="line"><a name="l00916"></a><span class="lineno">  916</span>&#160; * </div><div class="line"><a name="l00917"></a><span class="lineno">  917</span>&#160; *     <span class="keywordflow">return</span> (<a class="code" href="namespaceinternal_1_1QGaussLobatto.html#ac1aec52fdbb26c78e2d32fc0bed659c7">gamma</a> - 1.) * (conserved_variables[dim + 1] - 0.5 * rho_u_dot_u); </div><div class="line"><a name="l00918"></a><span class="lineno">  918</span>&#160; *   } </div><div class="line"><a name="l00919"></a><span class="lineno">  919</span>&#160; * </div><div class="line"><a name="l00920"></a><span class="lineno">  920</span>&#160; * <span class="keyword">@end</span>code</div><div class="line"><a name="l00921"></a><span class="lineno">  921</span>&#160; * </div><div class="line"><a name="l00922"></a><span class="lineno">  922</span>&#160; * 这里是欧拉通量函数的定义，也就是实际方程的定义。考虑到速度和压力（编译器的优化将确保只做一次），考虑到介绍中所说的方程，这是直截了当的。</div><div class="line"><a name="l00923"></a><span class="lineno">  923</span>&#160; * </div><div class="line"><a name="l00924"></a><span class="lineno">  924</span>&#160;</div><div class="line"><a name="l00925"></a><span class="lineno">  925</span>&#160; * </div><div class="line"><a name="l00926"></a><span class="lineno">  926</span>&#160; * </div><div class="line"><a name="l00927"></a><span class="lineno">  927</span>&#160; * @code</div><div class="line"><a name="l00928"></a><span class="lineno">  928</span>&#160; *   <span class="keyword">template</span> &lt;<span class="keywordtype">int</span> dim, <span class="keyword">typename</span> Number&gt; </div><div class="line"><a name="l00929"></a><span class="lineno">  929</span>&#160; *   <span class="keyword">inline</span> <a class="code" href="config_8h.html#a1d1d58e8be15e5c4285f6892e5f33136">DEAL_II_ALWAYS_INLINE</a> <span class="comment">// </span></div><div class="line"><a name="l00930"></a><span class="lineno">  930</span>&#160; *     <a class="code" href="classTensor.html">Tensor&lt;1, dim + 2, Tensor&lt;1, dim, Number&gt;</a>&gt; </div><div class="line"><a name="l00931"></a><span class="lineno">  931</span>&#160; *     euler_flux(<span class="keyword">const</span> <a class="code" href="classTensor.html">Tensor&lt;1, dim + 2, Number&gt;</a> &amp;conserved_variables) </div><div class="line"><a name="l00932"></a><span class="lineno">  932</span>&#160; *   { </div><div class="line"><a name="l00933"></a><span class="lineno">  933</span>&#160; *     <span class="keyword">const</span> <a class="code" href="classTensor.html">Tensor&lt;1, dim, Number&gt;</a> velocity = </div><div class="line"><a name="l00934"></a><span class="lineno">  934</span>&#160; *       euler_velocity&lt;dim&gt;(conserved_variables); </div><div class="line"><a name="l00935"></a><span class="lineno">  935</span>&#160; *     <span class="keyword">const</span> Number pressure = euler_pressure&lt;dim&gt;(conserved_variables); </div><div class="line"><a name="l00936"></a><span class="lineno">  936</span>&#160; * </div><div class="line"><a name="l00937"></a><span class="lineno">  937</span>&#160; *     <a class="code" href="classTensor.html">Tensor&lt;1, dim + 2, Tensor&lt;1, dim, Number&gt;</a>&gt; flux; </div><div class="line"><a name="l00938"></a><span class="lineno">  938</span>&#160; *     <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a15728437b942dab0b0042eb06a407d2c">d</a> = 0; <a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a15728437b942dab0b0042eb06a407d2c">d</a> &lt; dim; ++<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a15728437b942dab0b0042eb06a407d2c">d</a>) </div><div class="line"><a name="l00939"></a><span class="lineno">  939</span>&#160; *       { </div><div class="line"><a name="l00940"></a><span class="lineno">  940</span>&#160; *         flux[0][<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a15728437b942dab0b0042eb06a407d2c">d</a>] = conserved_variables[1 + <a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a15728437b942dab0b0042eb06a407d2c">d</a>]; </div><div class="line"><a name="l00941"></a><span class="lineno">  941</span>&#160; *         <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a9587d5229555daa5b1fa1ba2f8a40adb">e</a> = 0; <a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a9587d5229555daa5b1fa1ba2f8a40adb">e</a> &lt; dim; ++<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a9587d5229555daa5b1fa1ba2f8a40adb">e</a>) </div><div class="line"><a name="l00942"></a><span class="lineno">  942</span>&#160; *           flux[<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a9587d5229555daa5b1fa1ba2f8a40adb">e</a> + 1][<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a15728437b942dab0b0042eb06a407d2c">d</a>] = conserved_variables[<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a9587d5229555daa5b1fa1ba2f8a40adb">e</a> + 1] * velocity[<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a15728437b942dab0b0042eb06a407d2c">d</a>]; </div><div class="line"><a name="l00943"></a><span class="lineno">  943</span>&#160; *         flux[<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a15728437b942dab0b0042eb06a407d2c">d</a> + 1][<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a15728437b942dab0b0042eb06a407d2c">d</a>] += pressure; </div><div class="line"><a name="l00944"></a><span class="lineno">  944</span>&#160; *         flux[dim + 1][<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a15728437b942dab0b0042eb06a407d2c">d</a>] = </div><div class="line"><a name="l00945"></a><span class="lineno">  945</span>&#160; *           velocity[<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a15728437b942dab0b0042eb06a407d2c">d</a>] * (conserved_variables[dim + 1] + pressure); </div><div class="line"><a name="l00946"></a><span class="lineno">  946</span>&#160; *       } </div><div class="line"><a name="l00947"></a><span class="lineno">  947</span>&#160; * </div><div class="line"><a name="l00948"></a><span class="lineno">  948</span>&#160; *     <span class="keywordflow">return</span> flux; </div><div class="line"><a name="l00949"></a><span class="lineno">  949</span>&#160; *   } </div><div class="line"><a name="l00950"></a><span class="lineno">  950</span>&#160; * </div><div class="line"><a name="l00951"></a><span class="lineno">  951</span>&#160; * <span class="keyword">@end</span>code</div><div class="line"><a name="l00952"></a><span class="lineno">  952</span>&#160; * </div><div class="line"><a name="l00953"></a><span class="lineno">  953</span>&#160; * 接下来的这个函数是一个简化数值通量实现的助手，它实现了一个张量的张量（具有大小为`dim + 2`的非标准外维，所以deal.II的张量类提供的标准重载在此不适用）与另一个相同内维的张量的作用，即一个矩阵-向量积。</div><div class="line"><a name="l00954"></a><span class="lineno">  954</span>&#160; * </div><div class="line"><a name="l00955"></a><span class="lineno">  955</span>&#160;</div><div class="line"><a name="l00956"></a><span class="lineno">  956</span>&#160; * </div><div class="line"><a name="l00957"></a><span class="lineno">  957</span>&#160; * </div><div class="line"><a name="l00958"></a><span class="lineno">  958</span>&#160; * @code</div><div class="line"><a name="l00959"></a><span class="lineno">  959</span>&#160; *   <span class="keyword">template</span> &lt;<span class="keywordtype">int</span> n_components, <span class="keywordtype">int</span> dim, <span class="keyword">typename</span> Number&gt; </div><div class="line"><a name="l00960"></a><span class="lineno">  960</span>&#160; *   <span class="keyword">inline</span> <a class="code" href="config_8h.html#a1d1d58e8be15e5c4285f6892e5f33136">DEAL_II_ALWAYS_INLINE</a> <span class="comment">// </span></div><div class="line"><a name="l00961"></a><span class="lineno">  961</span>&#160; *     <a class="code" href="classTensor.html">Tensor&lt;1, n_components, Number&gt;</a> </div><div class="line"><a name="l00962"></a><span class="lineno">  962</span>&#160; *     <a class="code" href="complex__overloads_8h.html#a285c79b547d28de482e34d02cee71bb2">operator*</a>(<span class="keyword">const</span> <a class="code" href="classTensor.html">Tensor</a>&lt;1, n_components, <a class="code" href="classTensor.html">Tensor&lt;1, dim, Number&gt;</a>&gt; &amp;<a class="code" href="namespaceLAPACKSupport.html#a1a9009db0d9a77923a7031b549b9b638a5bc7c54a9c20485772672825c6a73003">matrix</a>, </div><div class="line"><a name="l00963"></a><span class="lineno">  963</span>&#160; *               <span class="keyword">const</span> <a class="code" href="classTensor.html">Tensor&lt;1, dim, Number&gt;</a> &amp;                         vector) </div><div class="line"><a name="l00964"></a><span class="lineno">  964</span>&#160; *   { </div><div class="line"><a name="l00965"></a><span class="lineno">  965</span>&#160; *     <a class="code" href="classTensor.html">Tensor&lt;1, n_components, Number&gt;</a> result; </div><div class="line"><a name="l00966"></a><span class="lineno">  966</span>&#160; *     <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a15728437b942dab0b0042eb06a407d2c">d</a> = 0; <a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a15728437b942dab0b0042eb06a407d2c">d</a> &lt; <a class="code" href="classFunction.html#a7248c7e11dc434fb7d16cdc5e41e3770">n_components</a>; ++<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a15728437b942dab0b0042eb06a407d2c">d</a>) </div><div class="line"><a name="l00967"></a><span class="lineno">  967</span>&#160; *       result[<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a15728437b942dab0b0042eb06a407d2c">d</a>] = <a class="code" href="namespaceLAPACKSupport.html#a1a9009db0d9a77923a7031b549b9b638a5bc7c54a9c20485772672825c6a73003">matrix</a>[<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a15728437b942dab0b0042eb06a407d2c">d</a>] * vector; </div><div class="line"><a name="l00968"></a><span class="lineno">  968</span>&#160; *     <span class="keywordflow">return</span> result; </div><div class="line"><a name="l00969"></a><span class="lineno">  969</span>&#160; *   } </div><div class="line"><a name="l00970"></a><span class="lineno">  970</span>&#160; * </div><div class="line"><a name="l00971"></a><span class="lineno">  971</span>&#160; * <span class="keyword">@end</span>code</div><div class="line"><a name="l00972"></a><span class="lineno">  972</span>&#160; * </div><div class="line"><a name="l00973"></a><span class="lineno">  973</span>&#160; * 这个函数实现了数值通量（黎曼求解器）。它从一个界面的两边获得状态，并获得法向量，从解的一边  @f$\mathbf{<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a6b25dd8f005063d8d2b0a4bdb0d277f3">w</a>}^-@f$  向解  @f$\mathbf{<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a6b25dd8f005063d8d2b0a4bdb0d277f3">w</a>}^+@f$  的方向。在依赖片断恒定数据的有限体积方法中，数值通量是核心成分，因为它是唯一输入物理信息的地方。在DG方法中，由于元素内部的多项式和那里使用的物理通量，数值通量就不那么核心了。由于在连续解的极限中，两边的数值一致的高阶插值，数值通量可以被看作是对两边解的跳跃的控制，以弱化连续性。必须认识到，在存在冲击的情况下，仅靠数值通量是无法稳定高阶DG方法的，因此任何DG方法都必须与进一步的冲击捕捉技术相结合，以处理这些情况。在本教程中，我们将重点讨论欧拉方程在没有强不连续的亚声速体系中的波状解，我们的基本方案已经足够了。</div><div class="line"><a name="l00974"></a><span class="lineno">  974</span>&#160; * </div><div class="line"><a name="l00975"></a><span class="lineno">  975</span>&#160;</div><div class="line"><a name="l00976"></a><span class="lineno">  976</span>&#160; * </div><div class="line"><a name="l00977"></a><span class="lineno">  977</span>&#160; * 尽管如此，数值通量对整个方案的数值耗散起着决定性作用，并影响到显式Runge-Kutta方法的可接受的时间步长。我们考虑两种选择，一种是改良的Lax-Friedrichs方案，另一种是广泛使用的Harten-Lax-van Leer（HLL）通量。对于这两种方案，我们首先需要得到界面两边的速度和压力，并评估物理欧拉通量。</div><div class="line"><a name="l00978"></a><span class="lineno">  978</span>&#160; * </div><div class="line"><a name="l00979"></a><span class="lineno">  979</span>&#160;</div><div class="line"><a name="l00980"></a><span class="lineno">  980</span>&#160; * </div><div class="line"><a name="l00981"></a><span class="lineno">  981</span>&#160; * 对于局部Lax--Friedrichs通量，其定义是 @f$\hat{\mathbf{<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#aa87528a28ad8a95fa89a3876e6f986c8">F</a>}}</div><div class="line"><a name="l00982"></a><span class="lineno">  982</span>&#160; * =\frac{\mathbf{<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#aa87528a28ad8a95fa89a3876e6f986c8">F</a>}(\mathbf{<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a6b25dd8f005063d8d2b0a4bdb0d277f3">w</a>}^-)+\mathbf{<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#aa87528a28ad8a95fa89a3876e6f986c8">F</a>}(\mathbf{<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a6b25dd8f005063d8d2b0a4bdb0d277f3">w</a>}^+)}{2} +</div><div class="line"><a name="l00983"></a><span class="lineno">  983</span>&#160; * \frac{\lambda}{2}\left[\mathbf{<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a6b25dd8f005063d8d2b0a4bdb0d277f3">w</a>}^--\mathbf{<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a6b25dd8f005063d8d2b0a4bdb0d277f3">w</a>}^+\right]\otimes</div><div class="line"><a name="l00984"></a><span class="lineno">  984</span>&#160; * \mathbf{n^-}@f$  ，其中因子 @f$\lambda =</div><div class="line"><a name="l00985"></a><span class="lineno">  985</span>&#160; * \max\left(\|\mathbf{u}^-\|+c^-, \|\mathbf{u}^+\|+c^+\right)@f$ 给出了最大波速， @f$c = \sqrt{<a class="code" href="namespaceinternal_1_1QGaussLobatto.html#ac1aec52fdbb26c78e2d32fc0bed659c7">\gamma</a> p / \rho}@f$ 是音速。在这里，考虑到通量对解的影响很小，为了计算效率的原因，我们选择了该表达式的两个修改。对于上述因子 @f$\lambda@f$ 的定义，我们需要取四个平方根，两个用于两个速度规范，两个用于两侧的声速。因此，第一个修改是宁可使用 @f$\sqrt{\|\mathbf{u}\|^2+c^2}@f$ 作为最大速度的估计（如介绍中所示，它与实际最大速度最多相差2倍）。这使我们能够从最大速度中提取平方根，并且只需进行一次平方根计算就可以了。第二个修改是进一步放宽参数 @f$\lambda@f$ --它越小，耗散系数就越小（与 @f$\mathbf{<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a6b25dd8f005063d8d2b0a4bdb0d277f3">w</a>}@f$ 的跳跃相乘，最终可能导致耗散变小或变大）。这使得我们可以用更大的时间步长将频谱纳入显式Runge--Kutta积分器的稳定区域。然而，我们不能使耗散太小，因为否则假想的特征值会越来越大。最后，目前的保守公式在 @f$\lambda\to 0@f$ 的极限中不是能量稳定的，因为它不是偏斜对称的，在这种情况下需要额外的措施，如分裂形式的DG方案。</div><div class="line"><a name="l00986"></a><span class="lineno">  986</span>&#160; * </div><div class="line"><a name="l00987"></a><span class="lineno">  987</span>&#160;</div><div class="line"><a name="l00988"></a><span class="lineno">  988</span>&#160; * </div><div class="line"><a name="l00989"></a><span class="lineno">  989</span>&#160; * 对于HLL通量，我们遵循文献中的公式，通过一个参数 @f$s@f$ 引入Lax--Friedrichs的两个状态的额外加权。它是由欧拉方程的物理传输方向得出的，以当前的速度方向和声速为准。对于速度，我们在此选择一个简单的算术平均数，这对危险情况和材料参数的适度跳跃是足够的。</div><div class="line"><a name="l00990"></a><span class="lineno">  990</span>&#160; * </div><div class="line"><a name="l00991"></a><span class="lineno">  991</span>&#160;</div><div class="line"><a name="l00992"></a><span class="lineno">  992</span>&#160; * </div><div class="line"><a name="l00993"></a><span class="lineno">  993</span>&#160; * 由于数值通量在弱形式下是与法向量相乘的，因此我们对方程中的所有项都用法向量来乘以结果。在这些乘法中，上面定义的 <span class="stringliteral">&quot;操作符*&quot;</span>可以实现类似于数学定义的紧凑符号。</div><div class="line"><a name="l00994"></a><span class="lineno">  994</span>&#160; * </div><div class="line"><a name="l00995"></a><span class="lineno">  995</span>&#160;</div><div class="line"><a name="l00996"></a><span class="lineno">  996</span>&#160; * </div><div class="line"><a name="l00997"></a><span class="lineno">  997</span>&#160; * 在这个函数和下面的函数中，我们使用变量后缀`_m`和`_p`来表示从 @f$\mathbf{<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a6b25dd8f005063d8d2b0a4bdb0d277f3">w</a>}^-@f$ 和 @f$\mathbf{<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a6b25dd8f005063d8d2b0a4bdb0d277f3">w</a>}^+@f$ 得出的量，即在观察相邻单元时相对于当前单元的 <span class="stringliteral">&quot;这里 &quot;</span>和 <span class="stringliteral">&quot;那里 &quot;</span>的数值。</div><div class="line"><a name="l00998"></a><span class="lineno">  998</span>&#160; * </div><div class="line"><a name="l00999"></a><span class="lineno">  999</span>&#160;</div><div class="line"><a name="l01000"></a><span class="lineno"> 1000</span>&#160; * </div><div class="line"><a name="l01001"></a><span class="lineno"> 1001</span>&#160; * </div><div class="line"><a name="l01002"></a><span class="lineno"> 1002</span>&#160; * @code</div><div class="line"><a name="l01003"></a><span class="lineno"> 1003</span>&#160; *   <span class="keyword">template</span> &lt;<span class="keywordtype">int</span> dim, <span class="keyword">typename</span> Number&gt; </div><div class="line"><a name="l01004"></a><span class="lineno"> 1004</span>&#160; *   <span class="keyword">inline</span> <a class="code" href="config_8h.html#a1d1d58e8be15e5c4285f6892e5f33136">DEAL_II_ALWAYS_INLINE</a> <span class="comment">// </span></div><div class="line"><a name="l01005"></a><span class="lineno"> 1005</span>&#160; *     <a class="code" href="classTensor.html">Tensor&lt;1, dim + 2, Number&gt;</a> </div><div class="line"><a name="l01006"></a><span class="lineno"> 1006</span>&#160; *     euler_numerical_flux(<span class="keyword">const</span> <a class="code" href="classTensor.html">Tensor&lt;1, dim + 2, Number&gt;</a> &amp;u_m, </div><div class="line"><a name="l01007"></a><span class="lineno"> 1007</span>&#160; *                          <span class="keyword">const</span> <a class="code" href="classTensor.html">Tensor&lt;1, dim + 2, Number&gt;</a> &amp;u_p, </div><div class="line"><a name="l01008"></a><span class="lineno"> 1008</span>&#160; *                          <span class="keyword">const</span> <a class="code" href="classTensor.html">Tensor&lt;1, dim, Number&gt;</a> &amp;    normal) </div><div class="line"><a name="l01009"></a><span class="lineno"> 1009</span>&#160; *   { </div><div class="line"><a name="l01010"></a><span class="lineno"> 1010</span>&#160; *     <span class="keyword">const</span> <span class="keyword">auto</span> velocity_m = euler_velocity&lt;dim&gt;(u_m); </div><div class="line"><a name="l01011"></a><span class="lineno"> 1011</span>&#160; *     <span class="keyword">const</span> <span class="keyword">auto</span> velocity_p = euler_velocity&lt;dim&gt;(u_p); </div><div class="line"><a name="l01012"></a><span class="lineno"> 1012</span>&#160; * </div><div class="line"><a name="l01013"></a><span class="lineno"> 1013</span>&#160; *     <span class="keyword">const</span> <span class="keyword">auto</span> pressure_m = euler_pressure&lt;dim&gt;(u_m); </div><div class="line"><a name="l01014"></a><span class="lineno"> 1014</span>&#160; *     <span class="keyword">const</span> <span class="keyword">auto</span> pressure_p = euler_pressure&lt;dim&gt;(u_p); </div><div class="line"><a name="l01015"></a><span class="lineno"> 1015</span>&#160; * </div><div class="line"><a name="l01016"></a><span class="lineno"> 1016</span>&#160; *     <span class="keyword">const</span> <span class="keyword">auto</span> flux_m = euler_flux&lt;dim&gt;(u_m); </div><div class="line"><a name="l01017"></a><span class="lineno"> 1017</span>&#160; *     <span class="keyword">const</span> <span class="keyword">auto</span> flux_p = euler_flux&lt;dim&gt;(u_p); </div><div class="line"><a name="l01018"></a><span class="lineno"> 1018</span>&#160; * </div><div class="line"><a name="l01019"></a><span class="lineno"> 1019</span>&#160; *     <span class="keywordflow">switch</span> (numerical_flux_type) </div><div class="line"><a name="l01020"></a><span class="lineno"> 1020</span>&#160; *       { </div><div class="line"><a name="l01021"></a><span class="lineno"> 1021</span>&#160; *         <span class="keywordflow">case</span> lax_friedrichs_modified: </div><div class="line"><a name="l01022"></a><span class="lineno"> 1022</span>&#160; *           { </div><div class="line"><a name="l01023"></a><span class="lineno"> 1023</span>&#160; *             <span class="keyword">const</span> <span class="keyword">auto</span> <a class="code" href="namespaceDifferentiation_1_1SD.html#a841a7b84dc17bf2ba675522093a97e8ba945f3fc449518a73b9f5f32868db466c">lambda</a> = </div><div class="line"><a name="l01024"></a><span class="lineno"> 1024</span>&#160; *               0.5 * <a class="code" href="vectorization_8h.html#a303f564e3c189251976da401ee2e44fa">std::sqrt</a>(<a class="code" href="namespaceVectorTools_1_1EvaluationFlags.html#ac6721740e24732d6afabcf28ddfc1ffda8e7f5b8545162dccd5ed717792bdf420">std::max</a>(velocity_p.norm_square() + </div><div class="line"><a name="l01025"></a><span class="lineno"> 1025</span>&#160; *                                          <a class="code" href="namespaceinternal_1_1QGaussLobatto.html#ac1aec52fdbb26c78e2d32fc0bed659c7">gamma</a> * pressure_p * (1. / u_p[0]), </div><div class="line"><a name="l01026"></a><span class="lineno"> 1026</span>&#160; *                                        velocity_m.norm_square() + </div><div class="line"><a name="l01027"></a><span class="lineno"> 1027</span>&#160; *                                          <a class="code" href="namespaceinternal_1_1QGaussLobatto.html#ac1aec52fdbb26c78e2d32fc0bed659c7">gamma</a> * pressure_m * (1. / u_m[0]))); </div><div class="line"><a name="l01028"></a><span class="lineno"> 1028</span>&#160; * </div><div class="line"><a name="l01029"></a><span class="lineno"> 1029</span>&#160; *             <span class="keywordflow">return</span> 0.5 * (flux_m * normal + flux_p * normal) + </div><div class="line"><a name="l01030"></a><span class="lineno"> 1030</span>&#160; *                    0.5 * lambda * (u_m - u_p); </div><div class="line"><a name="l01031"></a><span class="lineno"> 1031</span>&#160; *           } </div><div class="line"><a name="l01032"></a><span class="lineno"> 1032</span>&#160; * </div><div class="line"><a name="l01033"></a><span class="lineno"> 1033</span>&#160; *         <span class="keywordflow">case</span> harten_lax_vanleer: </div><div class="line"><a name="l01034"></a><span class="lineno"> 1034</span>&#160; *           { </div><div class="line"><a name="l01035"></a><span class="lineno"> 1035</span>&#160; *             <span class="keyword">const</span> <span class="keyword">auto</span> avg_velocity_normal = </div><div class="line"><a name="l01036"></a><span class="lineno"> 1036</span>&#160; *               0.5 * ((velocity_m + velocity_p) * normal); </div><div class="line"><a name="l01037"></a><span class="lineno"> 1037</span>&#160; *             <span class="keyword">const</span> <span class="keyword">auto</span>   avg_c = <a class="code" href="vectorization_8h.html#a303f564e3c189251976da401ee2e44fa">std::sqrt</a>(std::abs( </div><div class="line"><a name="l01038"></a><span class="lineno"> 1038</span>&#160; *               0.5 * <a class="code" href="namespaceinternal_1_1QGaussLobatto.html#ac1aec52fdbb26c78e2d32fc0bed659c7">gamma</a> * </div><div class="line"><a name="l01039"></a><span class="lineno"> 1039</span>&#160; *               (pressure_p * (1. / u_p[0]) + pressure_m * (1. / u_m[0])))); </div><div class="line"><a name="l01040"></a><span class="lineno"> 1040</span>&#160; *             <span class="keyword">const</span> Number s_pos = </div><div class="line"><a name="l01041"></a><span class="lineno"> 1041</span>&#160; *               <a class="code" href="namespaceVectorTools_1_1EvaluationFlags.html#ac6721740e24732d6afabcf28ddfc1ffda8e7f5b8545162dccd5ed717792bdf420">std::max</a>(Number(), avg_velocity_normal + avg_c); </div><div class="line"><a name="l01042"></a><span class="lineno"> 1042</span>&#160; *             <span class="keyword">const</span> Number s_neg = </div><div class="line"><a name="l01043"></a><span class="lineno"> 1043</span>&#160; *               <a class="code" href="namespaceVectorTools_1_1EvaluationFlags.html#ac6721740e24732d6afabcf28ddfc1ffdaeb244a97c0c9e9e7ca4765e096f0badc">std::min</a>(Number(), avg_velocity_normal - avg_c); </div><div class="line"><a name="l01044"></a><span class="lineno"> 1044</span>&#160; *             <span class="keyword">const</span> Number inverse_s = Number(1.) / (s_pos - s_neg); </div><div class="line"><a name="l01045"></a><span class="lineno"> 1045</span>&#160; * </div><div class="line"><a name="l01046"></a><span class="lineno"> 1046</span>&#160; *             <span class="keywordflow">return</span> inverse_s * </div><div class="line"><a name="l01047"></a><span class="lineno"> 1047</span>&#160; *                    ((s_pos * (flux_m * normal) - s_neg * (flux_p * normal)) - </div><div class="line"><a name="l01048"></a><span class="lineno"> 1048</span>&#160; *                     s_pos * s_neg * (u_m - u_p)); </div><div class="line"><a name="l01049"></a><span class="lineno"> 1049</span>&#160; *           } </div><div class="line"><a name="l01050"></a><span class="lineno"> 1050</span>&#160; * </div><div class="line"><a name="l01051"></a><span class="lineno"> 1051</span>&#160; *         <span class="keywordflow">default</span>: </div><div class="line"><a name="l01052"></a><span class="lineno"> 1052</span>&#160; *           { </div><div class="line"><a name="l01053"></a><span class="lineno"> 1053</span>&#160; *             <a class="code" href="group__Exceptions.html#ga70a0bb353656e704acf927945277bbc6">Assert</a>(<span class="keyword">false</span>, <a class="code" href="group__Exceptions.html#ga7b52b286796c23ef9ff178faf7a4b68f">ExcNotImplemented</a>()); </div><div class="line"><a name="l01054"></a><span class="lineno"> 1054</span>&#160; *             <span class="keywordflow">return</span> {}; </div><div class="line"><a name="l01055"></a><span class="lineno"> 1055</span>&#160; *           } </div><div class="line"><a name="l01056"></a><span class="lineno"> 1056</span>&#160; *       } </div><div class="line"><a name="l01057"></a><span class="lineno"> 1057</span>&#160; *   } </div><div class="line"><a name="l01058"></a><span class="lineno"> 1058</span>&#160; * </div><div class="line"><a name="l01059"></a><span class="lineno"> 1059</span>&#160; * <span class="keyword">@end</span>code</div><div class="line"><a name="l01060"></a><span class="lineno"> 1060</span>&#160; * </div><div class="line"><a name="l01061"></a><span class="lineno"> 1061</span>&#160; * 这个函数和下一个函数是辅助函数，提供紧凑的评估调用，因为多个点通过VectorizedArray参数被分批放在一起（详见 @ref step_37 <span class="stringliteral">&quot;step-37&quot;</span> 教程）。这个函数用于亚音速外流边界条件，我们需要将能量分量设置为一个规定值。下一个函数请求所有分量上的解，用于流入边界，其中解的所有分量都被设置。</div><div class="line"><a name="l01062"></a><span class="lineno"> 1062</span>&#160; * </div><div class="line"><a name="l01063"></a><span class="lineno"> 1063</span>&#160;</div><div class="line"><a name="l01064"></a><span class="lineno"> 1064</span>&#160; * </div><div class="line"><a name="l01065"></a><span class="lineno"> 1065</span>&#160; * </div><div class="line"><a name="l01066"></a><span class="lineno"> 1066</span>&#160; * @code</div><div class="line"><a name="l01067"></a><span class="lineno"> 1067</span>&#160; *   <span class="keyword">template</span> &lt;<span class="keywordtype">int</span> dim, <span class="keyword">typename</span> Number&gt; </div><div class="line"><a name="l01068"></a><span class="lineno"> 1068</span>&#160; *   <a class="code" href="classVectorizedArray.html">VectorizedArray&lt;Number&gt;</a> </div><div class="line"><a name="l01069"></a><span class="lineno"> 1069</span>&#160; *   evaluate_function(<span class="keyword">const</span> <a class="code" href="classFunction.html">Function&lt;dim&gt;</a> &amp;                      <span class="keyword">function</span>, </div><div class="line"><a name="l01070"></a><span class="lineno"> 1070</span>&#160; *                     <span class="keyword">const</span> <a class="code" href="classPoint.html">Point</a>&lt;dim, <a class="code" href="classVectorizedArray.html">VectorizedArray&lt;Number&gt;</a>&gt; &amp;p_vectorized, </div><div class="line"><a name="l01071"></a><span class="lineno"> 1071</span>&#160; *                     <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span>                         component) </div><div class="line"><a name="l01072"></a><span class="lineno"> 1072</span>&#160; *   { </div><div class="line"><a name="l01073"></a><span class="lineno"> 1073</span>&#160; *     <a class="code" href="classVectorizedArray.html">VectorizedArray&lt;Number&gt;</a> result; </div><div class="line"><a name="l01074"></a><span class="lineno"> 1074</span>&#160; *     <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> v = 0; v &lt; VectorizedArray&lt;Number&gt;::size(); ++v) </div><div class="line"><a name="l01075"></a><span class="lineno"> 1075</span>&#160; *       { </div><div class="line"><a name="l01076"></a><span class="lineno"> 1076</span>&#160; *         <a class="code" href="classPoint.html">Point&lt;dim&gt;</a> p; </div><div class="line"><a name="l01077"></a><span class="lineno"> 1077</span>&#160; *         <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a15728437b942dab0b0042eb06a407d2c">d</a> = 0; <a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a15728437b942dab0b0042eb06a407d2c">d</a> &lt; dim; ++<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a15728437b942dab0b0042eb06a407d2c">d</a>) </div><div class="line"><a name="l01078"></a><span class="lineno"> 1078</span>&#160; *           p[<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a15728437b942dab0b0042eb06a407d2c">d</a>] = p_vectorized[<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a15728437b942dab0b0042eb06a407d2c">d</a>][v]; </div><div class="line"><a name="l01079"></a><span class="lineno"> 1079</span>&#160; *         result[v] = <span class="keyword">function</span>.value(p, component); </div><div class="line"><a name="l01080"></a><span class="lineno"> 1080</span>&#160; *       } </div><div class="line"><a name="l01081"></a><span class="lineno"> 1081</span>&#160; *     <span class="keywordflow">return</span> result; </div><div class="line"><a name="l01082"></a><span class="lineno"> 1082</span>&#160; *   } </div><div class="line"><a name="l01083"></a><span class="lineno"> 1083</span>&#160; * </div><div class="line"><a name="l01084"></a><span class="lineno"> 1084</span>&#160; *   <span class="keyword">template</span> &lt;<span class="keywordtype">int</span> dim, <span class="keyword">typename</span> Number, <span class="keywordtype">int</span> n_components = dim + 2&gt; </div><div class="line"><a name="l01085"></a><span class="lineno"> 1085</span>&#160; *   <a class="code" href="classTensor.html">Tensor&lt;1, n_components, VectorizedArray&lt;Number&gt;</a>&gt; </div><div class="line"><a name="l01086"></a><span class="lineno"> 1086</span>&#160; *   evaluate_function(<span class="keyword">const</span> <a class="code" href="classFunction.html">Function&lt;dim&gt;</a> &amp;                      <span class="keyword">function</span>, </div><div class="line"><a name="l01087"></a><span class="lineno"> 1087</span>&#160; *                     <span class="keyword">const</span> <a class="code" href="classPoint.html">Point</a>&lt;dim, <a class="code" href="classVectorizedArray.html">VectorizedArray&lt;Number&gt;</a>&gt; &amp;p_vectorized) </div><div class="line"><a name="l01088"></a><span class="lineno"> 1088</span>&#160; *   { </div><div class="line"><a name="l01089"></a><span class="lineno"> 1089</span>&#160; *     <a class="code" href="group__Exceptions.html#ga9442b63275c9ef3fab29bc222831c49c">AssertDimension</a>(<span class="keyword">function</span>.n_components, n_components); </div><div class="line"><a name="l01090"></a><span class="lineno"> 1090</span>&#160; *     <a class="code" href="classTensor.html">Tensor&lt;1, n_components, VectorizedArray&lt;Number&gt;</a>&gt; result; </div><div class="line"><a name="l01091"></a><span class="lineno"> 1091</span>&#160; *     <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> v = 0; v &lt; VectorizedArray&lt;Number&gt;::size(); ++v) </div><div class="line"><a name="l01092"></a><span class="lineno"> 1092</span>&#160; *       { </div><div class="line"><a name="l01093"></a><span class="lineno"> 1093</span>&#160; *         <a class="code" href="classPoint.html">Point&lt;dim&gt;</a> p; </div><div class="line"><a name="l01094"></a><span class="lineno"> 1094</span>&#160; *         <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a15728437b942dab0b0042eb06a407d2c">d</a> = 0; <a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a15728437b942dab0b0042eb06a407d2c">d</a> &lt; dim; ++<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a15728437b942dab0b0042eb06a407d2c">d</a>) </div><div class="line"><a name="l01095"></a><span class="lineno"> 1095</span>&#160; *           p[<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a15728437b942dab0b0042eb06a407d2c">d</a>] = p_vectorized[<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a15728437b942dab0b0042eb06a407d2c">d</a>][v]; </div><div class="line"><a name="l01096"></a><span class="lineno"> 1096</span>&#160; *         <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a15728437b942dab0b0042eb06a407d2c">d</a> = 0; <a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a15728437b942dab0b0042eb06a407d2c">d</a> &lt; <a class="code" href="classFunction.html#a7248c7e11dc434fb7d16cdc5e41e3770">n_components</a>; ++<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a15728437b942dab0b0042eb06a407d2c">d</a>) </div><div class="line"><a name="l01097"></a><span class="lineno"> 1097</span>&#160; *           result[<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a15728437b942dab0b0042eb06a407d2c">d</a>][v] = <span class="keyword">function</span>.<a class="code" href="classFunction.html#acbfcab66b2fc63bfea59268f40772bb4">value</a>(p, <a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a15728437b942dab0b0042eb06a407d2c">d</a>); </div><div class="line"><a name="l01098"></a><span class="lineno"> 1098</span>&#160; *       } </div><div class="line"><a name="l01099"></a><span class="lineno"> 1099</span>&#160; *     <span class="keywordflow">return</span> result; </div><div class="line"><a name="l01100"></a><span class="lineno"> 1100</span>&#160; *   } </div><div class="line"><a name="l01101"></a><span class="lineno"> 1101</span>&#160; * </div><div class="line"><a name="l01102"></a><span class="lineno"> 1102</span>&#160; * <span class="keyword">@end</span>code</div><div class="line"><a name="l01103"></a><span class="lineno"> 1103</span>&#160; * </div><div class="line"><a name="l01104"></a><span class="lineno"> 1104</span>&#160; * </div><div class="line"><a name="l01105"></a><span class="lineno"> 1105</span>&#160; * &lt;a name=<span class="stringliteral">&quot;TheEulerOperationclass&quot;</span>&gt;&lt;/a&gt; </div><div class="line"><a name="l01106"></a><span class="lineno"> 1106</span>&#160; * &lt;h3&gt;The EulerOperation <span class="keyword">class</span>&lt;/h3&gt;</div><div class="line"><a name="l01107"></a><span class="lineno"> 1107</span>&#160; * </div><div class="line"><a name="l01108"></a><span class="lineno"> 1108</span>&#160;</div><div class="line"><a name="l01109"></a><span class="lineno"> 1109</span>&#160; * </div><div class="line"><a name="l01110"></a><span class="lineno"> 1110</span>&#160; * 这个类实现了欧拉问题的评估器，类似于  @ref step_37 <span class="stringliteral">&quot;step-37&quot;</span>  或  @ref step_59 <span class="stringliteral">&quot;step-59&quot;</span>  的 `LaplaceOperator` 类。由于本算子是非线性的，不需要矩阵接口（交给预处理程序），我们跳过了无矩阵算子中的各种`vmult`函数，只实现了`<a class="code" href="namespacestd__cxx17.html#aa2fc1031c06af4aea4de90c5a1905473">apply</a>`函数以及`<a class="code" href="namespacestd__cxx17.html#aa2fc1031c06af4aea4de90c5a1905473">apply</a>`与上述低存储Runge-Kutta时间积分器所需的矢量更新的组合（称为`perform_stage`）。此外，我们还增加了三个涉及无矩阵例程的额外函数，即一个是根据元素中的速度和声速计算时间步长的估计值（与实际时间步长的Courant数相结合），一个是解的投影（专门针对DG情况的 <a class="code" href="namespaceVectorTools.html#ac6b404bf03cb2a742b290421cc2789fe">VectorTools::project</a>() ），还有一个是计算与可能的分析解或与某些背景状态的规范的误差。</div><div class="line"><a name="l01111"></a><span class="lineno"> 1111</span>&#160; * </div><div class="line"><a name="l01112"></a><span class="lineno"> 1112</span>&#160;</div><div class="line"><a name="l01113"></a><span class="lineno"> 1113</span>&#160; * </div><div class="line"><a name="l01114"></a><span class="lineno"> 1114</span>&#160; * 该课的其余部分与其他无矩阵教程相似。正如介绍中所讨论的，我们提供了几个函数，允许用户在由 <a class="code" href="namespacetypes.html">types</a>::<a class="code" href="namespacetypes.html#aed8813fee8c8a2edcc6005e6a48c321a">boundary_id</a> 变量标记的领域边界的不同部分传递各种形式的边界条件，以及可能的体力。</div><div class="line"><a name="l01115"></a><span class="lineno"> 1115</span>&#160; * </div><div class="line"><a name="l01116"></a><span class="lineno"> 1116</span>&#160;</div><div class="line"><a name="l01117"></a><span class="lineno"> 1117</span>&#160; * </div><div class="line"><a name="l01118"></a><span class="lineno"> 1118</span>&#160; * </div><div class="line"><a name="l01119"></a><span class="lineno"> 1119</span>&#160; * @code</div><div class="line"><a name="l01120"></a><span class="lineno"> 1120</span>&#160; *   template &lt;<span class="keywordtype">int</span> dim, <span class="keywordtype">int</span> degree, <span class="keywordtype">int</span> n_points_1d&gt; </div><div class="line"><a name="l01121"></a><span class="lineno"> 1121</span>&#160; *   class EulerOperator </div><div class="line"><a name="l01122"></a><span class="lineno"> 1122</span>&#160; *   { </div><div class="line"><a name="l01123"></a><span class="lineno"> 1123</span>&#160; *   <span class="keyword">public</span>: </div><div class="line"><a name="l01124"></a><span class="lineno"> 1124</span>&#160; *     <span class="keyword">static</span> constexpr <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> n_quadrature_points_1d = n_points_1d; </div><div class="line"><a name="l01125"></a><span class="lineno"> 1125</span>&#160; * </div><div class="line"><a name="l01126"></a><span class="lineno"> 1126</span>&#160; *     EulerOperator(<a class="code" href="classTimerOutput.html">TimerOutput</a> &amp;timer_output); </div><div class="line"><a name="l01127"></a><span class="lineno"> 1127</span>&#160; * </div><div class="line"><a name="l01128"></a><span class="lineno"> 1128</span>&#160; *     <span class="keywordtype">void</span> <a class="code" href="namespaceinternal.html#a38181f4582ff69679bda7d8e31c37291">reinit</a>(<span class="keyword">const</span> <a class="code" href="classMapping.html">Mapping&lt;dim&gt;</a> &amp;   mapping, </div><div class="line"><a name="l01129"></a><span class="lineno"> 1129</span>&#160; *                 <span class="keyword">const</span> <a class="code" href="classDoFHandler.html">DoFHandler&lt;dim&gt;</a> &amp;dof_handler); </div><div class="line"><a name="l01130"></a><span class="lineno"> 1130</span>&#160; * </div><div class="line"><a name="l01131"></a><span class="lineno"> 1131</span>&#160; *     <span class="keywordtype">void</span> set_inflow_boundary(<span class="keyword">const</span> <a class="code" href="classunsigned_01int.html">types::boundary_id</a>       <a class="code" href="namespacetypes.html#aed8813fee8c8a2edcc6005e6a48c321a">boundary_id</a>, </div><div class="line"><a name="l01132"></a><span class="lineno"> 1132</span>&#160; *                              std::unique_ptr&lt;<a class="code" href="classFunction.html">Function&lt;dim&gt;</a>&gt; inflow_function); </div><div class="line"><a name="l01133"></a><span class="lineno"> 1133</span>&#160; * </div><div class="line"><a name="l01134"></a><span class="lineno"> 1134</span>&#160; *     <span class="keywordtype">void</span> set_subsonic_outflow_boundary( </div><div class="line"><a name="l01135"></a><span class="lineno"> 1135</span>&#160; *       <span class="keyword">const</span> <a class="code" href="classunsigned_01int.html">types::boundary_id</a>       <a class="code" href="namespacetypes.html#aed8813fee8c8a2edcc6005e6a48c321a">boundary_id</a>, </div><div class="line"><a name="l01136"></a><span class="lineno"> 1136</span>&#160; *       std::unique_ptr&lt;<a class="code" href="classFunction.html">Function&lt;dim&gt;</a>&gt; outflow_energy); </div><div class="line"><a name="l01137"></a><span class="lineno"> 1137</span>&#160; * </div><div class="line"><a name="l01138"></a><span class="lineno"> 1138</span>&#160; *     <span class="keywordtype">void</span> set_wall_boundary(<span class="keyword">const</span> <a class="code" href="classunsigned_01int.html">types::boundary_id</a> <a class="code" href="namespacetypes.html#aed8813fee8c8a2edcc6005e6a48c321a">boundary_id</a>); </div><div class="line"><a name="l01139"></a><span class="lineno"> 1139</span>&#160; * </div><div class="line"><a name="l01140"></a><span class="lineno"> 1140</span>&#160; *     <span class="keywordtype">void</span> set_body_force(std::unique_ptr&lt;<a class="code" href="classFunction.html">Function&lt;dim&gt;</a>&gt; body_force); </div><div class="line"><a name="l01141"></a><span class="lineno"> 1141</span>&#160; * </div><div class="line"><a name="l01142"></a><span class="lineno"> 1142</span>&#160; *     <span class="keywordtype">void</span> <a class="code" href="namespacestd__cxx17.html#aa2fc1031c06af4aea4de90c5a1905473">apply</a>(<span class="keyword">const</span> <span class="keywordtype">double</span>                                      current_time, </div><div class="line"><a name="l01143"></a><span class="lineno"> 1143</span>&#160; *                <span class="keyword">const</span> <a class="code" href="classLinearAlgebra_1_1distributed_1_1Vector.html">LinearAlgebra::distributed::Vector&lt;Number&gt;</a> &amp;src, </div><div class="line"><a name="l01144"></a><span class="lineno"> 1144</span>&#160; *                <a class="code" href="classLinearAlgebra_1_1distributed_1_1Vector.html">LinearAlgebra::distributed::Vector&lt;Number&gt;</a> &amp;      dst) <span class="keyword">const</span>; </div><div class="line"><a name="l01145"></a><span class="lineno"> 1145</span>&#160; * </div><div class="line"><a name="l01146"></a><span class="lineno"> 1146</span>&#160; *     <span class="keywordtype">void</span> </div><div class="line"><a name="l01147"></a><span class="lineno"> 1147</span>&#160; *     perform_stage(<span class="keyword">const</span> Number cur_time, </div><div class="line"><a name="l01148"></a><span class="lineno"> 1148</span>&#160; *                   <span class="keyword">const</span> Number factor_solution, </div><div class="line"><a name="l01149"></a><span class="lineno"> 1149</span>&#160; *                   <span class="keyword">const</span> Number factor_ai, </div><div class="line"><a name="l01150"></a><span class="lineno"> 1150</span>&#160; *                   <span class="keyword">const</span> <a class="code" href="classLinearAlgebra_1_1distributed_1_1Vector.html">LinearAlgebra::distributed::Vector&lt;Number&gt;</a> &amp;current_ri, </div><div class="line"><a name="l01151"></a><span class="lineno"> 1151</span>&#160; *                   <a class="code" href="classLinearAlgebra_1_1distributed_1_1Vector.html">LinearAlgebra::distributed::Vector&lt;Number&gt;</a> &amp;      vec_ki, </div><div class="line"><a name="l01152"></a><span class="lineno"> 1152</span>&#160; *                   <a class="code" href="classLinearAlgebra_1_1distributed_1_1Vector.html">LinearAlgebra::distributed::Vector&lt;Number&gt;</a> &amp;      solution, </div><div class="line"><a name="l01153"></a><span class="lineno"> 1153</span>&#160; *                   <a class="code" href="classLinearAlgebra_1_1distributed_1_1Vector.html">LinearAlgebra::distributed::Vector&lt;Number&gt;</a> &amp;next_ri) <span class="keyword">const</span>; </div><div class="line"><a name="l01154"></a><span class="lineno"> 1154</span>&#160; * </div><div class="line"><a name="l01155"></a><span class="lineno"> 1155</span>&#160; *     <span class="keywordtype">void</span> <a class="code" href="namespaceVectorTools.html#ac6b404bf03cb2a742b290421cc2789fe">project</a>(<span class="keyword">const</span> <a class="code" href="classFunction.html">Function&lt;dim&gt;</a> &amp;                       <span class="keyword">function</span>, </div><div class="line"><a name="l01156"></a><span class="lineno"> 1156</span>&#160; *                  <a class="code" href="classLinearAlgebra_1_1distributed_1_1Vector.html">LinearAlgebra::distributed::Vector&lt;Number&gt;</a> &amp;solution) <span class="keyword">const</span>; </div><div class="line"><a name="l01157"></a><span class="lineno"> 1157</span>&#160; * </div><div class="line"><a name="l01158"></a><span class="lineno"> 1158</span>&#160; *     std::array&lt;double, 3&gt; compute_errors( </div><div class="line"><a name="l01159"></a><span class="lineno"> 1159</span>&#160; *       <span class="keyword">const</span> <a class="code" href="classFunction.html">Function&lt;dim&gt;</a> &amp;                             <span class="keyword">function</span>, </div><div class="line"><a name="l01160"></a><span class="lineno"> 1160</span>&#160; *       <span class="keyword">const</span> <a class="code" href="classLinearAlgebra_1_1distributed_1_1Vector.html">LinearAlgebra::distributed::Vector&lt;Number&gt;</a> &amp;solution) <span class="keyword">const</span>; </div><div class="line"><a name="l01161"></a><span class="lineno"> 1161</span>&#160; * </div><div class="line"><a name="l01162"></a><span class="lineno"> 1162</span>&#160; *     <span class="keywordtype">double</span> compute_cell_transport_speed( </div><div class="line"><a name="l01163"></a><span class="lineno"> 1163</span>&#160; *       <span class="keyword">const</span> <a class="code" href="classLinearAlgebra_1_1distributed_1_1Vector.html">LinearAlgebra::distributed::Vector&lt;Number&gt;</a> &amp;solution) <span class="keyword">const</span>; </div><div class="line"><a name="l01164"></a><span class="lineno"> 1164</span>&#160; * </div><div class="line"><a name="l01165"></a><span class="lineno"> 1165</span>&#160; *     <span class="keywordtype">void</span> </div><div class="line"><a name="l01166"></a><span class="lineno"> 1166</span>&#160; *     initialize_vector(<a class="code" href="classLinearAlgebra_1_1distributed_1_1Vector.html">LinearAlgebra::distributed::Vector&lt;Number&gt;</a> &amp;vector) <span class="keyword">const</span>; </div><div class="line"><a name="l01167"></a><span class="lineno"> 1167</span>&#160; * </div><div class="line"><a name="l01168"></a><span class="lineno"> 1168</span>&#160; *   <span class="keyword">private</span>: </div><div class="line"><a name="l01169"></a><span class="lineno"> 1169</span>&#160; *     <a class="code" href="classMatrixFree.html">MatrixFree&lt;dim, Number&gt;</a> data; </div><div class="line"><a name="l01170"></a><span class="lineno"> 1170</span>&#160; * </div><div class="line"><a name="l01171"></a><span class="lineno"> 1171</span>&#160; *     <a class="code" href="classTimerOutput.html">TimerOutput</a> &amp;timer; </div><div class="line"><a name="l01172"></a><span class="lineno"> 1172</span>&#160; * </div><div class="line"><a name="l01173"></a><span class="lineno"> 1173</span>&#160; *     std::map&lt;types::boundary_id, std::unique_ptr&lt;Function&lt;dim&gt;&gt;&gt; </div><div class="line"><a name="l01174"></a><span class="lineno"> 1174</span>&#160; *       inflow_boundaries; </div><div class="line"><a name="l01175"></a><span class="lineno"> 1175</span>&#160; *     std::map&lt;types::boundary_id, std::unique_ptr&lt;Function&lt;dim&gt;&gt;&gt; </div><div class="line"><a name="l01176"></a><span class="lineno"> 1176</span>&#160; *                                    subsonic_outflow_boundaries; </div><div class="line"><a name="l01177"></a><span class="lineno"> 1177</span>&#160; *     std::set&lt;types::boundary_id&gt;   wall_boundaries; </div><div class="line"><a name="l01178"></a><span class="lineno"> 1178</span>&#160; *     std::unique_ptr&lt;Function&lt;dim&gt;&gt; body_force; </div><div class="line"><a name="l01179"></a><span class="lineno"> 1179</span>&#160; * </div><div class="line"><a name="l01180"></a><span class="lineno"> 1180</span>&#160; *     <span class="keywordtype">void</span> local_apply_inverse_mass_matrix( </div><div class="line"><a name="l01181"></a><span class="lineno"> 1181</span>&#160; *       <span class="keyword">const</span> <a class="code" href="classMatrixFree.html">MatrixFree&lt;dim, Number&gt;</a> &amp;                   data, </div><div class="line"><a name="l01182"></a><span class="lineno"> 1182</span>&#160; *       <a class="code" href="classLinearAlgebra_1_1distributed_1_1Vector.html">LinearAlgebra::distributed::Vector&lt;Number&gt;</a> &amp;      dst, </div><div class="line"><a name="l01183"></a><span class="lineno"> 1183</span>&#160; *       <span class="keyword">const</span> <a class="code" href="classLinearAlgebra_1_1distributed_1_1Vector.html">LinearAlgebra::distributed::Vector&lt;Number&gt;</a> &amp;src, </div><div class="line"><a name="l01184"></a><span class="lineno"> 1184</span>&#160; *       <span class="keyword">const</span> std::pair&lt;unsigned int, unsigned int&gt; &amp;     cell_range) <span class="keyword">const</span>; </div><div class="line"><a name="l01185"></a><span class="lineno"> 1185</span>&#160; * </div><div class="line"><a name="l01186"></a><span class="lineno"> 1186</span>&#160; *     <span class="keywordtype">void</span> local_apply_cell( </div><div class="line"><a name="l01187"></a><span class="lineno"> 1187</span>&#160; *       <span class="keyword">const</span> <a class="code" href="classMatrixFree.html">MatrixFree&lt;dim, Number&gt;</a> &amp;                   data, </div><div class="line"><a name="l01188"></a><span class="lineno"> 1188</span>&#160; *       <a class="code" href="classLinearAlgebra_1_1distributed_1_1Vector.html">LinearAlgebra::distributed::Vector&lt;Number&gt;</a> &amp;      dst, </div><div class="line"><a name="l01189"></a><span class="lineno"> 1189</span>&#160; *       <span class="keyword">const</span> <a class="code" href="classLinearAlgebra_1_1distributed_1_1Vector.html">LinearAlgebra::distributed::Vector&lt;Number&gt;</a> &amp;src, </div><div class="line"><a name="l01190"></a><span class="lineno"> 1190</span>&#160; *       <span class="keyword">const</span> std::pair&lt;unsigned int, unsigned int&gt; &amp;     cell_range) <span class="keyword">const</span>; </div><div class="line"><a name="l01191"></a><span class="lineno"> 1191</span>&#160; * </div><div class="line"><a name="l01192"></a><span class="lineno"> 1192</span>&#160; *     <span class="keywordtype">void</span> local_apply_face( </div><div class="line"><a name="l01193"></a><span class="lineno"> 1193</span>&#160; *       <span class="keyword">const</span> <a class="code" href="classMatrixFree.html">MatrixFree&lt;dim, Number&gt;</a> &amp;                   data, </div><div class="line"><a name="l01194"></a><span class="lineno"> 1194</span>&#160; *       <a class="code" href="classLinearAlgebra_1_1distributed_1_1Vector.html">LinearAlgebra::distributed::Vector&lt;Number&gt;</a> &amp;      dst, </div><div class="line"><a name="l01195"></a><span class="lineno"> 1195</span>&#160; *       <span class="keyword">const</span> <a class="code" href="classLinearAlgebra_1_1distributed_1_1Vector.html">LinearAlgebra::distributed::Vector&lt;Number&gt;</a> &amp;src, </div><div class="line"><a name="l01196"></a><span class="lineno"> 1196</span>&#160; *       <span class="keyword">const</span> std::pair&lt;unsigned int, unsigned int&gt; &amp;     face_range) <span class="keyword">const</span>; </div><div class="line"><a name="l01197"></a><span class="lineno"> 1197</span>&#160; * </div><div class="line"><a name="l01198"></a><span class="lineno"> 1198</span>&#160; *     <span class="keywordtype">void</span> local_apply_boundary_face( </div><div class="line"><a name="l01199"></a><span class="lineno"> 1199</span>&#160; *       <span class="keyword">const</span> <a class="code" href="classMatrixFree.html">MatrixFree&lt;dim, Number&gt;</a> &amp;                   data, </div><div class="line"><a name="l01200"></a><span class="lineno"> 1200</span>&#160; *       <a class="code" href="classLinearAlgebra_1_1distributed_1_1Vector.html">LinearAlgebra::distributed::Vector&lt;Number&gt;</a> &amp;      dst, </div><div class="line"><a name="l01201"></a><span class="lineno"> 1201</span>&#160; *       <span class="keyword">const</span> <a class="code" href="classLinearAlgebra_1_1distributed_1_1Vector.html">LinearAlgebra::distributed::Vector&lt;Number&gt;</a> &amp;src, </div><div class="line"><a name="l01202"></a><span class="lineno"> 1202</span>&#160; *       <span class="keyword">const</span> std::pair&lt;unsigned int, unsigned int&gt; &amp;     face_range) <span class="keyword">const</span>; </div><div class="line"><a name="l01203"></a><span class="lineno"> 1203</span>&#160; *   }; </div><div class="line"><a name="l01204"></a><span class="lineno"> 1204</span>&#160; * </div><div class="line"><a name="l01205"></a><span class="lineno"> 1205</span>&#160; *   <span class="keyword">template</span> &lt;<span class="keywordtype">int</span> dim, <span class="keywordtype">int</span> degree, <span class="keywordtype">int</span> n_po<span class="keywordtype">int</span>s_1d&gt; </div><div class="line"><a name="l01206"></a><span class="lineno"> 1206</span>&#160; *   EulerOperator&lt;dim, degree, n_points_1d&gt;::EulerOperator(<a class="code" href="classTimerOutput.html">TimerOutput</a> &amp;timer) </div><div class="line"><a name="l01207"></a><span class="lineno"> 1207</span>&#160; *     : timer(timer) </div><div class="line"><a name="l01208"></a><span class="lineno"> 1208</span>&#160; *   {} </div><div class="line"><a name="l01209"></a><span class="lineno"> 1209</span>&#160; * </div><div class="line"><a name="l01210"></a><span class="lineno"> 1210</span>&#160; * <span class="keyword">@end</span>code</div><div class="line"><a name="l01211"></a><span class="lineno"> 1211</span>&#160; * </div><div class="line"><a name="l01212"></a><span class="lineno"> 1212</span>&#160; * 对于欧拉算子的初始化，我们设置了类中包含的MatrixFree变量。这可以通过给定一个描述可能的弯曲边界的映射以及一个描述自由度的DoFHandler对象来完成。由于我们在这个教程程序中使用的是不连续的Galerkin离散化，没有对解场施加强烈的约束，所以我们不需要传入AffineConstraints对象，而是使用一个假的来构造。关于正交，我们要选择两种不同的方式来计算基础积分。第一种是灵活的，基于模板参数`n_points_1d`（将被分配到本文件顶部指定的`n_q_points_1d`值）。更精确的积分是必要的，以避免由于欧拉算子中的可变系数而产生的混叠问题。第二个不太精确的正交公式是一个基于`fe_degree+1`的严密公式，需要用于反质量矩阵。虽然该公式只在仿生元素形状上提供了精确的反，而在变形元素上则没有，但它可以通过张量积技术快速反转质量矩阵，这对于确保整体的最佳计算效率是必要的。</div><div class="line"><a name="l01213"></a><span class="lineno"> 1213</span>&#160; * </div><div class="line"><a name="l01214"></a><span class="lineno"> 1214</span>&#160;</div><div class="line"><a name="l01215"></a><span class="lineno"> 1215</span>&#160; * </div><div class="line"><a name="l01216"></a><span class="lineno"> 1216</span>&#160; * </div><div class="line"><a name="l01217"></a><span class="lineno"> 1217</span>&#160; * @code</div><div class="line"><a name="l01218"></a><span class="lineno"> 1218</span>&#160; *   <span class="keyword">template</span> &lt;<span class="keywordtype">int</span> dim, <span class="keywordtype">int</span> degree, <span class="keywordtype">int</span> n_po<span class="keywordtype">int</span>s_1d&gt; </div><div class="line"><a name="l01219"></a><span class="lineno"> 1219</span>&#160; *   <span class="keywordtype">void</span> <a class="code" href="namespaceinternal.html#a38181f4582ff69679bda7d8e31c37291">EulerOperator&lt;dim, degree, n_points_1d&gt;::reinit</a>( </div><div class="line"><a name="l01220"></a><span class="lineno"> 1220</span>&#160; *     <span class="keyword">const</span> <a class="code" href="classMapping.html">Mapping&lt;dim&gt;</a> &amp;   mapping, </div><div class="line"><a name="l01221"></a><span class="lineno"> 1221</span>&#160; *     <span class="keyword">const</span> <a class="code" href="classDoFHandler.html">DoFHandler&lt;dim&gt;</a> &amp;dof_handler) </div><div class="line"><a name="l01222"></a><span class="lineno"> 1222</span>&#160; *   { </div><div class="line"><a name="l01223"></a><span class="lineno"> 1223</span>&#160; *     <span class="keyword">const</span> std::vector&lt;const DoFHandler&lt;dim&gt; *&gt; dof_handlers = {&amp;dof_handler}; </div><div class="line"><a name="l01224"></a><span class="lineno"> 1224</span>&#160; *     <span class="keyword">const</span> <a class="code" href="classAffineConstraints.html">AffineConstraints&lt;double&gt;</a>            dummy; </div><div class="line"><a name="l01225"></a><span class="lineno"> 1225</span>&#160; *     <span class="keyword">const</span> std::vector&lt;const AffineConstraints&lt;double&gt; *&gt; constraints = {&amp;dummy}; </div><div class="line"><a name="l01226"></a><span class="lineno"> 1226</span>&#160; *     <span class="keyword">const</span> std::vector&lt;Quadrature&lt;1&gt;&gt; quadratures = {<a class="code" href="classQGauss.html">QGauss&lt;1&gt;</a>(n_q_points_1d), </div><div class="line"><a name="l01227"></a><span class="lineno"> 1227</span>&#160; *                                                     <a class="code" href="classQGauss.html">QGauss&lt;1&gt;</a>(fe_degree + 1)}; </div><div class="line"><a name="l01228"></a><span class="lineno"> 1228</span>&#160; * </div><div class="line"><a name="l01229"></a><span class="lineno"> 1229</span>&#160; *     <span class="keyword">typename</span> <a class="code" href="structMatrixFree_1_1AdditionalData.html">MatrixFree&lt;dim, Number&gt;::AdditionalData</a> additional_data; </div><div class="line"><a name="l01230"></a><span class="lineno"> 1230</span>&#160; *     additional_data.<a class="code" href="structMatrixFree_1_1AdditionalData.html#aa5d597e6c4441d273f4100b6139a2552">mapping_update_flags</a> = </div><div class="line"><a name="l01231"></a><span class="lineno"> 1231</span>&#160; *       (<a class="code" href="group__feaccess.html#ggaa94b67d2fdcc390690c523f28019e52facbcc430975fa6af05f75ca786dc6fe20">update_gradients</a> | <a class="code" href="group__feaccess.html#ggaa94b67d2fdcc390690c523f28019e52fa714204722e9eeb43aadbd0d5ddc48c85">update_JxW_values</a> | <a class="code" href="group__feaccess.html#ggaa94b67d2fdcc390690c523f28019e52fad5c9ff886b9615349a5d04a6c782df4a">update_quadrature_points</a> | </div><div class="line"><a name="l01232"></a><span class="lineno"> 1232</span>&#160; *        <a class="code" href="group__feaccess.html#ggaa94b67d2fdcc390690c523f28019e52fa4057ca2f127aa619c65886a9d3ad4aea">update_values</a>); </div><div class="line"><a name="l01233"></a><span class="lineno"> 1233</span>&#160; *     additional_data.<a class="code" href="structMatrixFree_1_1AdditionalData.html#a5c25759917955940e0b2b74a6704012c">mapping_update_flags_inner_faces</a> = </div><div class="line"><a name="l01234"></a><span class="lineno"> 1234</span>&#160; *       (<a class="code" href="group__feaccess.html#ggaa94b67d2fdcc390690c523f28019e52fa714204722e9eeb43aadbd0d5ddc48c85">update_JxW_values</a> | <a class="code" href="group__feaccess.html#ggaa94b67d2fdcc390690c523f28019e52fad5c9ff886b9615349a5d04a6c782df4a">update_quadrature_points</a> | <a class="code" href="group__feaccess.html#ggaa94b67d2fdcc390690c523f28019e52fa5e7366a91c84a50ca4e7dbd43ca6369f">update_normal_vectors</a> | </div><div class="line"><a name="l01235"></a><span class="lineno"> 1235</span>&#160; *        <a class="code" href="group__feaccess.html#ggaa94b67d2fdcc390690c523f28019e52fa4057ca2f127aa619c65886a9d3ad4aea">update_values</a>); </div><div class="line"><a name="l01236"></a><span class="lineno"> 1236</span>&#160; *     additional_data.<a class="code" href="structMatrixFree_1_1AdditionalData.html#aa326b1a098e1c037334cc05bdc2decc6">mapping_update_flags_boundary_faces</a> = </div><div class="line"><a name="l01237"></a><span class="lineno"> 1237</span>&#160; *       (<a class="code" href="group__feaccess.html#ggaa94b67d2fdcc390690c523f28019e52fa714204722e9eeb43aadbd0d5ddc48c85">update_JxW_values</a> | <a class="code" href="group__feaccess.html#ggaa94b67d2fdcc390690c523f28019e52fad5c9ff886b9615349a5d04a6c782df4a">update_quadrature_points</a> | <a class="code" href="group__feaccess.html#ggaa94b67d2fdcc390690c523f28019e52fa5e7366a91c84a50ca4e7dbd43ca6369f">update_normal_vectors</a> | </div><div class="line"><a name="l01238"></a><span class="lineno"> 1238</span>&#160; *        <a class="code" href="group__feaccess.html#ggaa94b67d2fdcc390690c523f28019e52fa4057ca2f127aa619c65886a9d3ad4aea">update_values</a>); </div><div class="line"><a name="l01239"></a><span class="lineno"> 1239</span>&#160; *     additional_data.<a class="code" href="structMatrixFree_1_1AdditionalData.html#a0bcce2facca91b925d3e1a5a00c7704b">tasks_parallel_scheme</a> = </div><div class="line"><a name="l01240"></a><span class="lineno"> 1240</span>&#160; *       <a class="code" href="classMatrixFree.html">MatrixFree&lt;dim, Number&gt;::AdditionalData::none</a>; </div><div class="line"><a name="l01241"></a><span class="lineno"> 1241</span>&#160; * </div><div class="line"><a name="l01242"></a><span class="lineno"> 1242</span>&#160; *     data.<a class="code" href="classMatrixFree.html#adb324d469b296f2a6921b41208732ddf">reinit</a>( </div><div class="line"><a name="l01243"></a><span class="lineno"> 1243</span>&#160; *       mapping, dof_handlers, constraints, quadratures, additional_data); </div><div class="line"><a name="l01244"></a><span class="lineno"> 1244</span>&#160; *   } </div><div class="line"><a name="l01245"></a><span class="lineno"> 1245</span>&#160; * </div><div class="line"><a name="l01246"></a><span class="lineno"> 1246</span>&#160; *   <span class="keyword">template</span> &lt;<span class="keywordtype">int</span> dim, <span class="keywordtype">int</span> degree, <span class="keywordtype">int</span> n_po<span class="keywordtype">int</span>s_1d&gt; </div><div class="line"><a name="l01247"></a><span class="lineno"> 1247</span>&#160; *   <span class="keywordtype">void</span> EulerOperator&lt;dim, degree, n_points_1d&gt;::initialize_vector( </div><div class="line"><a name="l01248"></a><span class="lineno"> 1248</span>&#160; *     <a class="code" href="classLinearAlgebra_1_1distributed_1_1Vector.html">LinearAlgebra::distributed::Vector&lt;Number&gt;</a> &amp;vector) <span class="keyword">const</span> </div><div class="line"><a name="l01249"></a><span class="lineno"> 1249</span>&#160; *   { </div><div class="line"><a name="l01250"></a><span class="lineno"> 1250</span>&#160; *     data.initialize_dof_vector(vector); </div><div class="line"><a name="l01251"></a><span class="lineno"> 1251</span>&#160; *   } </div><div class="line"><a name="l01252"></a><span class="lineno"> 1252</span>&#160; * </div><div class="line"><a name="l01253"></a><span class="lineno"> 1253</span>&#160; * <span class="keyword">@end</span>code</div><div class="line"><a name="l01254"></a><span class="lineno"> 1254</span>&#160; * </div><div class="line"><a name="l01255"></a><span class="lineno"> 1255</span>&#160; * 随后的四个成员函数是必须从外部调用的，以指定各种类型的边界。对于一个流入的边界，我们必须以密度  @f$\rho@f$  、动量  @f$\rho \mathbf{u}@f$  和能量  @f$E@f$  来指定所有成分。考虑到这些信息，我们将函数与各自的边界ID一起存储在这个类的地图成员变量中。同样，我们对亚音速外流边界（我们也要求一个函数，用来检索能量）和壁面（无穿透）边界进行处理，在壁面上我们施加零法线速度（不需要函数，所以我们只要求边界ID）。对于目前的DG代码来说，边界条件只作为弱形式的一部分被应用（在时间积分期间），设置边界条件的调用可以出现在对这个类的`<a class="code" href="namespaceinternal.html#a38181f4582ff69679bda7d8e31c37291">reinit</a>()`调用之前或之后。这与连续有限元代码不同，在连续有限元代码中，边界条件决定了被送入MatrixFree初始化的AffineConstraints对象的内容，因此需要在无矩阵数据结构的初始化之前设置。</div><div class="line"><a name="l01256"></a><span class="lineno"> 1256</span>&#160; * </div><div class="line"><a name="l01257"></a><span class="lineno"> 1257</span>&#160;</div><div class="line"><a name="l01258"></a><span class="lineno"> 1258</span>&#160; * </div><div class="line"><a name="l01259"></a><span class="lineno"> 1259</span>&#160; * 在四个函数中的每一个中添加的检查是用来确保边界条件在边界的各个部分是相互排斥的，也就是说，用户不会意外地将一个边界既指定为流入边界，又指定为亚声速流出边界。</div><div class="line"><a name="l01260"></a><span class="lineno"> 1260</span>&#160; * </div><div class="line"><a name="l01261"></a><span class="lineno"> 1261</span>&#160;</div><div class="line"><a name="l01262"></a><span class="lineno"> 1262</span>&#160; * </div><div class="line"><a name="l01263"></a><span class="lineno"> 1263</span>&#160; * </div><div class="line"><a name="l01264"></a><span class="lineno"> 1264</span>&#160; * @code</div><div class="line"><a name="l01265"></a><span class="lineno"> 1265</span>&#160; *   <span class="keyword">template</span> &lt;<span class="keywordtype">int</span> dim, <span class="keywordtype">int</span> degree, <span class="keywordtype">int</span> n_po<span class="keywordtype">int</span>s_1d&gt; </div><div class="line"><a name="l01266"></a><span class="lineno"> 1266</span>&#160; *   <span class="keywordtype">void</span> EulerOperator&lt;dim, degree, n_points_1d&gt;::set_inflow_boundary( </div><div class="line"><a name="l01267"></a><span class="lineno"> 1267</span>&#160; *     <span class="keyword">const</span> <a class="code" href="classunsigned_01int.html">types::boundary_id</a>       <a class="code" href="namespacetypes.html#aed8813fee8c8a2edcc6005e6a48c321a">boundary_id</a>, </div><div class="line"><a name="l01268"></a><span class="lineno"> 1268</span>&#160; *     std::unique_ptr&lt;<a class="code" href="classFunction.html">Function&lt;dim&gt;</a>&gt; inflow_function) </div><div class="line"><a name="l01269"></a><span class="lineno"> 1269</span>&#160; *   { </div><div class="line"><a name="l01270"></a><span class="lineno"> 1270</span>&#160; *     <a class="code" href="group__Exceptions.html#gafc0ca7ad85b3ebd64e8e51689ac85caf">AssertThrow</a>(subsonic_outflow_boundaries.find(<a class="code" href="namespacetypes.html#aed8813fee8c8a2edcc6005e6a48c321a">boundary_id</a>) == </div><div class="line"><a name="l01271"></a><span class="lineno"> 1271</span>&#160; *                     subsonic_outflow_boundaries.end() &amp;&amp; </div><div class="line"><a name="l01272"></a><span class="lineno"> 1272</span>&#160; *                   wall_boundaries.find(<a class="code" href="namespacetypes.html#aed8813fee8c8a2edcc6005e6a48c321a">boundary_id</a>) == wall_boundaries.end(), </div><div class="line"><a name="l01273"></a><span class="lineno"> 1273</span>&#160; *  </div><div class="line"><a name="l01274"></a><span class="lineno"> 1274</span>&#160; *  </div><div class="line"><a name="l01275"></a><span class="lineno"> 1275</span>&#160; *  </div><div class="line"><a name="l01276"></a><span class="lineno"> 1276</span>&#160; *  </div><div class="line"><a name="l01277"></a><span class="lineno"> 1277</span>&#160; *  </div><div class="line"><a name="l01278"></a><span class="lineno"> 1278</span>&#160; *                 <a class="code" href="group__Exceptions.html#gae9a45f517af1401c50811a11083f9114">ExcMessage</a>(<span class="stringliteral">&quot;Expected function with dim+2 components&quot;</span>)); </div><div class="line"><a name="l01279"></a><span class="lineno"> 1279</span>&#160; * </div><div class="line"><a name="l01280"></a><span class="lineno"> 1280</span>&#160; *     inflow_boundaries[<a class="code" href="namespacetypes.html#aed8813fee8c8a2edcc6005e6a48c321a">boundary_id</a>] = std::move(inflow_function); </div><div class="line"><a name="l01281"></a><span class="lineno"> 1281</span>&#160; *   } </div><div class="line"><a name="l01282"></a><span class="lineno"> 1282</span>&#160; * </div><div class="line"><a name="l01283"></a><span class="lineno"> 1283</span>&#160; *   <span class="keyword">template</span> &lt;<span class="keywordtype">int</span> dim, <span class="keywordtype">int</span> degree, <span class="keywordtype">int</span> n_po<span class="keywordtype">int</span>s_1d&gt; </div><div class="line"><a name="l01284"></a><span class="lineno"> 1284</span>&#160; *   <span class="keywordtype">void</span> EulerOperator&lt;dim, degree, n_points_1d&gt;::set_subsonic_outflow_boundary( </div><div class="line"><a name="l01285"></a><span class="lineno"> 1285</span>&#160; *     <span class="keyword">const</span> <a class="code" href="classunsigned_01int.html">types::boundary_id</a>       <a class="code" href="namespacetypes.html#aed8813fee8c8a2edcc6005e6a48c321a">boundary_id</a>, </div><div class="line"><a name="l01286"></a><span class="lineno"> 1286</span>&#160; *     std::unique_ptr&lt;<a class="code" href="classFunction.html">Function&lt;dim&gt;</a>&gt; outflow_function) </div><div class="line"><a name="l01287"></a><span class="lineno"> 1287</span>&#160; *   { </div><div class="line"><a name="l01288"></a><span class="lineno"> 1288</span>&#160; *     <a class="code" href="group__Exceptions.html#gafc0ca7ad85b3ebd64e8e51689ac85caf">AssertThrow</a>(inflow_boundaries.find(<a class="code" href="namespacetypes.html#aed8813fee8c8a2edcc6005e6a48c321a">boundary_id</a>) == </div><div class="line"><a name="l01289"></a><span class="lineno"> 1289</span>&#160; *                     inflow_boundaries.end() &amp;&amp; </div><div class="line"><a name="l01290"></a><span class="lineno"> 1290</span>&#160; *                   wall_boundaries.find(<a class="code" href="namespacetypes.html#aed8813fee8c8a2edcc6005e6a48c321a">boundary_id</a>) == wall_boundaries.end(), </div><div class="line"><a name="l01291"></a><span class="lineno"> 1291</span>&#160; *                 <a class="code" href="group__Exceptions.html#gae9a45f517af1401c50811a11083f9114">ExcMessage</a>(<span class="stringliteral">&quot;You already set the boundary with id &quot;</span> + </div><div class="line"><a name="l01292"></a><span class="lineno"> 1292</span>&#160; *                            <a class="code" href="namespacePatterns_1_1Tools.html#a72743302dcb1a0fb1f2f8dc5122d299e">std::to_string</a>(static_cast&lt;int&gt;(<a class="code" href="namespacetypes.html#aed8813fee8c8a2edcc6005e6a48c321a">boundary_id</a>)) + </div><div class="line"><a name="l01293"></a><span class="lineno"> 1293</span>&#160; *                            <span class="stringliteral">&quot; to another type of boundary before now setting &quot;</span> + </div><div class="line"><a name="l01294"></a><span class="lineno"> 1294</span>&#160; *                            <span class="stringliteral">&quot;it as subsonic outflow&quot;</span>)); </div><div class="line"><a name="l01295"></a><span class="lineno"> 1295</span>&#160; *     <a class="code" href="group__Exceptions.html#gafc0ca7ad85b3ebd64e8e51689ac85caf">AssertThrow</a>(outflow_function-&gt;n_components == dim + 2, </div><div class="line"><a name="l01296"></a><span class="lineno"> 1296</span>&#160; *                 <a class="code" href="group__Exceptions.html#gae9a45f517af1401c50811a11083f9114">ExcMessage</a>(<span class="stringliteral">&quot;Expected function with dim+2 components&quot;</span>)); </div><div class="line"><a name="l01297"></a><span class="lineno"> 1297</span>&#160; * </div><div class="line"><a name="l01298"></a><span class="lineno"> 1298</span>&#160; *     subsonic_outflow_boundaries[<a class="code" href="namespacetypes.html#aed8813fee8c8a2edcc6005e6a48c321a">boundary_id</a>] = std::move(outflow_function); </div><div class="line"><a name="l01299"></a><span class="lineno"> 1299</span>&#160; *   } </div><div class="line"><a name="l01300"></a><span class="lineno"> 1300</span>&#160; * </div><div class="line"><a name="l01301"></a><span class="lineno"> 1301</span>&#160; *   <span class="keyword">template</span> &lt;<span class="keywordtype">int</span> dim, <span class="keywordtype">int</span> degree, <span class="keywordtype">int</span> n_po<span class="keywordtype">int</span>s_1d&gt; </div><div class="line"><a name="l01302"></a><span class="lineno"> 1302</span>&#160; *   <span class="keywordtype">void</span> EulerOperator&lt;dim, degree, n_points_1d&gt;::set_wall_boundary( </div><div class="line"><a name="l01303"></a><span class="lineno"> 1303</span>&#160; *     <span class="keyword">const</span> <a class="code" href="classunsigned_01int.html">types::boundary_id</a> <a class="code" href="namespacetypes.html#aed8813fee8c8a2edcc6005e6a48c321a">boundary_id</a>) </div><div class="line"><a name="l01304"></a><span class="lineno"> 1304</span>&#160; *   { </div><div class="line"><a name="l01305"></a><span class="lineno"> 1305</span>&#160; *     <a class="code" href="group__Exceptions.html#gafc0ca7ad85b3ebd64e8e51689ac85caf">AssertThrow</a>(inflow_boundaries.find(<a class="code" href="namespacetypes.html#aed8813fee8c8a2edcc6005e6a48c321a">boundary_id</a>) == </div><div class="line"><a name="l01306"></a><span class="lineno"> 1306</span>&#160; *                     inflow_boundaries.end() &amp;&amp; </div><div class="line"><a name="l01307"></a><span class="lineno"> 1307</span>&#160; *                   subsonic_outflow_boundaries.find(<a class="code" href="namespacetypes.html#aed8813fee8c8a2edcc6005e6a48c321a">boundary_id</a>) == </div><div class="line"><a name="l01308"></a><span class="lineno"> 1308</span>&#160; *                     subsonic_outflow_boundaries.end(), </div><div class="line"><a name="l01309"></a><span class="lineno"> 1309</span>&#160; *                 <a class="code" href="group__Exceptions.html#gae9a45f517af1401c50811a11083f9114">ExcMessage</a>(<span class="stringliteral">&quot;You already set the boundary with id &quot;</span> + </div><div class="line"><a name="l01310"></a><span class="lineno"> 1310</span>&#160; *                            <a class="code" href="namespacePatterns_1_1Tools.html#a72743302dcb1a0fb1f2f8dc5122d299e">std::to_string</a>(static_cast&lt;int&gt;(<a class="code" href="namespacetypes.html#aed8813fee8c8a2edcc6005e6a48c321a">boundary_id</a>)) + </div><div class="line"><a name="l01311"></a><span class="lineno"> 1311</span>&#160; *                            <span class="stringliteral">&quot; to another type of boundary before now setting &quot;</span> + </div><div class="line"><a name="l01312"></a><span class="lineno"> 1312</span>&#160; *                            <span class="stringliteral">&quot;it as wall boundary&quot;</span>)); </div><div class="line"><a name="l01313"></a><span class="lineno"> 1313</span>&#160; * </div><div class="line"><a name="l01314"></a><span class="lineno"> 1314</span>&#160; *     wall_boundaries.insert(<a class="code" href="namespacetypes.html#aed8813fee8c8a2edcc6005e6a48c321a">boundary_id</a>); </div><div class="line"><a name="l01315"></a><span class="lineno"> 1315</span>&#160; *   } </div><div class="line"><a name="l01316"></a><span class="lineno"> 1316</span>&#160; * </div><div class="line"><a name="l01317"></a><span class="lineno"> 1317</span>&#160; *   <span class="keyword">template</span> &lt;<span class="keywordtype">int</span> dim, <span class="keywordtype">int</span> degree, <span class="keywordtype">int</span> n_po<span class="keywordtype">int</span>s_1d&gt; </div><div class="line"><a name="l01318"></a><span class="lineno"> 1318</span>&#160; *   <span class="keywordtype">void</span> EulerOperator&lt;dim, degree, n_points_1d&gt;::set_body_force( </div><div class="line"><a name="l01319"></a><span class="lineno"> 1319</span>&#160; *     std::unique_ptr&lt;<a class="code" href="classFunction.html">Function&lt;dim&gt;</a>&gt; body_force) </div><div class="line"><a name="l01320"></a><span class="lineno"> 1320</span>&#160; *   { </div><div class="line"><a name="l01321"></a><span class="lineno"> 1321</span>&#160; *     <a class="code" href="group__Exceptions.html#ga9442b63275c9ef3fab29bc222831c49c">AssertDimension</a>(body_force-&gt;n_components, dim); </div><div class="line"><a name="l01322"></a><span class="lineno"> 1322</span>&#160; * </div><div class="line"><a name="l01323"></a><span class="lineno"> 1323</span>&#160; *     this-&gt;body_force = std::move(body_force); </div><div class="line"><a name="l01324"></a><span class="lineno"> 1324</span>&#160; *   } </div><div class="line"><a name="l01325"></a><span class="lineno"> 1325</span>&#160; * </div><div class="line"><a name="l01326"></a><span class="lineno"> 1326</span>&#160; * <span class="keyword">@end</span>code</div><div class="line"><a name="l01327"></a><span class="lineno"> 1327</span>&#160; * </div><div class="line"><a name="l01328"></a><span class="lineno"> 1328</span>&#160; * </div><div class="line"><a name="l01329"></a><span class="lineno"> 1329</span>&#160; * &lt;a name=<span class="stringliteral">&quot;Localevaluators&quot;</span>&gt;&lt;/a&gt; </div><div class="line"><a name="l01330"></a><span class="lineno"> 1330</span>&#160; * &lt;h4&gt;Local evaluators&lt;/h4&gt;</div><div class="line"><a name="l01331"></a><span class="lineno"> 1331</span>&#160; * </div><div class="line"><a name="l01332"></a><span class="lineno"> 1332</span>&#160;</div><div class="line"><a name="l01333"></a><span class="lineno"> 1333</span>&#160; * </div><div class="line"><a name="l01334"></a><span class="lineno"> 1334</span>&#160; * 现在我们开始研究欧拉问题的局部评估器。评估器相对简单，遵循  @ref step_37 <span class="stringliteral">&quot;step-37&quot;</span>  、  @ref step_48 <span class="stringliteral">&quot;step-48&quot;</span>  或  @ref step_59 <span class="stringliteral">&quot;step-59&quot;</span>  中提出的内容。第一个显著的区别是，我们使用的是具有非标准正交点数量的FEE评估。以前我们总是将正交点的数量设置为等于多项式度数加1（确保在仿生元素形状上的精确积分），现在我们将正交点的数量设置为一个单独的变量（例如多项式度数加多项式度数的二分之一或三分之一），以更准确地处理非线性项。由于评估器通过模板参数输入了适当的循环长度，并在变量 <a class="code" href="classFEEvaluation.html#a1b8934d6ae273d7b3f91994eddcad239">FEEvaluation::n_q_points</a>, 中保留了整个单元格的正交点数量，所以我们现在自动操作更精确的公式，而无需进一步修改。</div><div class="line"><a name="l01335"></a><span class="lineno"> 1335</span>&#160; * </div><div class="line"><a name="l01336"></a><span class="lineno"> 1336</span>&#160;</div><div class="line"><a name="l01337"></a><span class="lineno"> 1337</span>&#160; * </div><div class="line"><a name="l01338"></a><span class="lineno"> 1338</span>&#160; * 第二个区别是由于我们现在评估的是一个多分量系统，而不是之前考虑的标量系统。无矩阵框架提供了几种方法来处理多成分的情况。这里显示的变体是利用一个嵌入了多个分量的FEEvaluation对象，由第四个模板参数`dim + 2`指定欧拉系统中的分量。因此， <a class="code" href="classFEEvaluationBase.html#aeecc76ffeff6b36816f6af20af1398a8">FEEvaluation::get_value</a>() 的返回类型不再是一个标量（这将返回一个VectorizedArray类型，收集几个元素的数据），而是一个`dim+2`组件的张量。该功能与标量的情况类似；它由一个基类的模板专业化处理，称为FEEvaluationAccess。另一个变体是使用几个FEEvaluation对象，一个标量对象用于密度，一个带`dim`分量的矢量值对象用于动量，另一个标量评价器用于能量。为了确保这些分量指向解决方案的正确部分，FEEvaluation的构造函数在所需的MatrixFree字段之后需要三个可选的整数参数，即多DoFHandler系统的DoFHandler编号（默认取第一个），如果有多个Quadrature对象，则取正交点的编号（见下文），以及作为第三个参数的矢量系统中的分量。由于我们有一个单一的矢量来表示所有的分量，我们将使用第三个参数，并将其设置为`0`表示密度，`1`表示矢量值的动量，`dim+1`表示能量槽。然后FEEvaluation在 <a class="code" href="classFEEvaluationBase.html">FEEvaluationBase</a>::read_dof_values() 和 <a class="code" href="classFEEvaluation.html">FEEvaluation</a>::distributed_local_to_global() 或更紧凑的 <a class="code" href="classFEEvaluation.html">FEEvaluation</a>::gather_evaluate() 和 <a class="code" href="classFEEvaluation.html">FEEvaluation</a>::integrate_scatter() 调用中挑选适当的解矢量子范围。</div><div class="line"><a name="l01339"></a><span class="lineno"> 1339</span>&#160; * </div><div class="line"><a name="l01340"></a><span class="lineno"> 1340</span>&#160;</div><div class="line"><a name="l01341"></a><span class="lineno"> 1341</span>&#160; * </div><div class="line"><a name="l01342"></a><span class="lineno"> 1342</span>&#160; * 当涉及到身体力向量的评估时，为了效率，我们区分了两种情况。如果我们有一个常数函数（源自 <a class="code" href="namespaceFunctions.html">Functions</a>::<a class="code" href="classFunctions_1_1ConstantFunction.html">ConstantFunction</a>), ），我们可以在正交点的循环外预先计算出数值，并简单地在所有地方使用该数值。对于一个更通用的函数，我们反而需要调用我们上面提供的`evaluate_function()`方法；这个路径更昂贵，因为我们需要访问与正交点数据有关的内存。</div><div class="line"><a name="l01343"></a><span class="lineno"> 1343</span>&#160; * </div><div class="line"><a name="l01344"></a><span class="lineno"> 1344</span>&#160;</div><div class="line"><a name="l01345"></a><span class="lineno"> 1345</span>&#160; * </div><div class="line"><a name="l01346"></a><span class="lineno"> 1346</span>&#160; * 其余部分沿用其他教程的程序。由于我们已经在单独的`euler_flux()`函数中实现了欧拉方程的所有物理学，我们在这里所要做的就是给定在正交点评估的当前解，由`phi.get_value(q)`返回，并告诉FEEvaluation对象，通过形状函数的梯度（这是一个外部`dim+2`分量的张量，每个张量持有一个`dim`分量的 @f$x,y,z@f$  ] 欧拉通量的分量）。) 最后值得一提的是，在我们得到一个外部函数的情况下，我们通过测试函数`phi.submit_value()`的值来排队测试数据的顺序。我们必须在调用`phi.get_value(q)&#39;之后进行，因为`get_value()&#39;（读取解决方案）和`submit_value()&#39;（排队等待测试函数的乘法和正交点的求和）访问同一个底层数据域。这里很容易实现没有临时变量`w_q`，因为值和梯度之间没有混合。对于更复杂的设置，必须首先复制出例如正交点的值和梯度，然后通过 <a class="code" href="classFEEvaluationBase.html">FEEvaluationBase</a>::submit_value() 和 <a class="code" href="classFEEvaluationBase.html">FEEvaluationBase</a>::submit_gradient(). 再次排列结果。</div><div class="line"><a name="l01347"></a><span class="lineno"> 1347</span>&#160; * </div><div class="line"><a name="l01348"></a><span class="lineno"> 1348</span>&#160;</div><div class="line"><a name="l01349"></a><span class="lineno"> 1349</span>&#160; * </div><div class="line"><a name="l01350"></a><span class="lineno"> 1350</span>&#160; * 作为最后的说明，我们提到我们没有使用这个函数的第一个MatrixFree参数，这是一个来自 <a class="code" href="classMatrixFree.html">MatrixFree</a>::<a class="code" href="group__MeshWorker.html#gad10f528ab87f39fbb0531d24f238b2f3">loop</a>(). 的回调，接口规定了现在的参数列表，但是由于我们在一个成员函数中，MatrixFree对象已经可以作为`data`变量，我们坚持使用，以避免混淆。</div><div class="line"><a name="l01351"></a><span class="lineno"> 1351</span>&#160; * </div><div class="line"><a name="l01352"></a><span class="lineno"> 1352</span>&#160;</div><div class="line"><a name="l01353"></a><span class="lineno"> 1353</span>&#160; * </div><div class="line"><a name="l01354"></a><span class="lineno"> 1354</span>&#160; * </div><div class="line"><a name="l01355"></a><span class="lineno"> 1355</span>&#160; * @code</div><div class="line"><a name="l01356"></a><span class="lineno"> 1356</span>&#160; *   template &lt;<span class="keywordtype">int</span> dim, <span class="keywordtype">int</span> degree, <span class="keywordtype">int</span> n_points_1d&gt; </div><div class="line"><a name="l01357"></a><span class="lineno"> 1357</span>&#160; *   <span class="keywordtype">void</span> EulerOperator&lt;dim, degree, n_points_1d&gt;::local_apply_cell( </div><div class="line"><a name="l01358"></a><span class="lineno"> 1358</span>&#160; *     const <a class="code" href="classMatrixFree.html">MatrixFree</a>&lt;dim, Number&gt; &amp;, </div><div class="line"><a name="l01359"></a><span class="lineno"> 1359</span>&#160; *     <a class="code" href="namespaceLinearAlgebra.html">LinearAlgebra</a>::distributed::<a class="code" href="classVector.html">Vector</a>&lt;Number&gt; &amp;      dst, </div><div class="line"><a name="l01360"></a><span class="lineno"> 1360</span>&#160; *     const <a class="code" href="namespaceLinearAlgebra.html">LinearAlgebra</a>::distributed::<a class="code" href="classVector.html">Vector</a>&lt;Number&gt; &amp;src, </div><div class="line"><a name="l01361"></a><span class="lineno"> 1361</span>&#160; *     const <a class="code" href="namespacestd.html">std</a>::pair&lt;<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span>, <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span>&gt; &amp;     cell_range) const </div><div class="line"><a name="l01362"></a><span class="lineno"> 1362</span>&#160; *   { </div><div class="line"><a name="l01363"></a><span class="lineno"> 1363</span>&#160; *     <a class="code" href="classFEEvaluation.html">FEEvaluation&lt;dim, degree, n_points_1d, dim + 2, Number&gt;</a> phi(data); </div><div class="line"><a name="l01364"></a><span class="lineno"> 1364</span>&#160; * </div><div class="line"><a name="l01365"></a><span class="lineno"> 1365</span>&#160; *     <a class="code" href="classTensor.html">Tensor&lt;1, dim, VectorizedArray&lt;Number&gt;</a>&gt; constant_body_force; </div><div class="line"><a name="l01366"></a><span class="lineno"> 1366</span>&#160; *     <span class="keyword">const</span> <a class="code" href="classFunctions_1_1ConstantFunction.html">Functions::ConstantFunction&lt;dim&gt;</a> *constant_function = </div><div class="line"><a name="l01367"></a><span class="lineno"> 1367</span>&#160; *       <span class="keyword">dynamic_cast&lt;</span><a class="code" href="classFunctions_1_1ConstantFunction.html">Functions::ConstantFunction&lt;dim&gt;</a> *<span class="keyword">&gt;</span>(body_force.get()); </div><div class="line"><a name="l01368"></a><span class="lineno"> 1368</span>&#160; * </div><div class="line"><a name="l01369"></a><span class="lineno"> 1369</span>&#160; *     <span class="keywordflow">if</span> (constant_function) </div><div class="line"><a name="l01370"></a><span class="lineno"> 1370</span>&#160; *       constant_body_force = evaluate_function&lt;dim, Number, dim&gt;( </div><div class="line"><a name="l01371"></a><span class="lineno"> 1371</span>&#160; *         *constant_function, <a class="code" href="classPoint.html">Point&lt;dim, VectorizedArray&lt;Number&gt;</a>&gt;()); </div><div class="line"><a name="l01372"></a><span class="lineno"> 1372</span>&#160; * </div><div class="line"><a name="l01373"></a><span class="lineno"> 1373</span>&#160; *     <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> cell = cell_range.first; cell &lt; cell_range.second; ++cell) </div><div class="line"><a name="l01374"></a><span class="lineno"> 1374</span>&#160; *       { </div><div class="line"><a name="l01375"></a><span class="lineno"> 1375</span>&#160; *         phi.reinit(cell); </div><div class="line"><a name="l01376"></a><span class="lineno"> 1376</span>&#160; *         phi.gather_evaluate(src, <a class="code" href="namespaceEvaluationFlags.html#a9b7c6d689cb76386839d0d13640f59aeaf9825c682f693a6a200094641a0d6a58">EvaluationFlags::values</a>); </div><div class="line"><a name="l01377"></a><span class="lineno"> 1377</span>&#160; * </div><div class="line"><a name="l01378"></a><span class="lineno"> 1378</span>&#160; *         <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> q = 0; q &lt; phi.n_q_points; ++q) </div><div class="line"><a name="l01379"></a><span class="lineno"> 1379</span>&#160; *           { </div><div class="line"><a name="l01380"></a><span class="lineno"> 1380</span>&#160; *             <span class="keyword">const</span> <span class="keyword">auto</span> w_q = phi.get_value(q); </div><div class="line"><a name="l01381"></a><span class="lineno"> 1381</span>&#160; *             phi.submit_gradient(euler_flux&lt;dim&gt;(w_q), q); </div><div class="line"><a name="l01382"></a><span class="lineno"> 1382</span>&#160; *             <span class="keywordflow">if</span> (body_force.get() != <span class="keyword">nullptr</span>) </div><div class="line"><a name="l01383"></a><span class="lineno"> 1383</span>&#160; *               { </div><div class="line"><a name="l01384"></a><span class="lineno"> 1384</span>&#160; *                 <span class="keyword">const</span> <a class="code" href="classTensor.html">Tensor&lt;1, dim, VectorizedArray&lt;Number&gt;</a>&gt; force = </div><div class="line"><a name="l01385"></a><span class="lineno"> 1385</span>&#160; *                   constant_function ? constant_body_force : </div><div class="line"><a name="l01386"></a><span class="lineno"> 1386</span>&#160; *                                       evaluate_function&lt;dim, Number, dim&gt;( </div><div class="line"><a name="l01387"></a><span class="lineno"> 1387</span>&#160; *                                         *body_force, phi.quadrature_point(q)); </div><div class="line"><a name="l01388"></a><span class="lineno"> 1388</span>&#160; * </div><div class="line"><a name="l01389"></a><span class="lineno"> 1389</span>&#160; *                 <a class="code" href="classTensor.html">Tensor&lt;1, dim + 2, VectorizedArray&lt;Number&gt;</a>&gt; forcing; </div><div class="line"><a name="l01390"></a><span class="lineno"> 1390</span>&#160; *                 <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a15728437b942dab0b0042eb06a407d2c">d</a> = 0; <a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a15728437b942dab0b0042eb06a407d2c">d</a> &lt; dim; ++<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a15728437b942dab0b0042eb06a407d2c">d</a>) </div><div class="line"><a name="l01391"></a><span class="lineno"> 1391</span>&#160; *                   forcing[<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a15728437b942dab0b0042eb06a407d2c">d</a> + 1] = w_q[0] * force[<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a15728437b942dab0b0042eb06a407d2c">d</a>]; </div><div class="line"><a name="l01392"></a><span class="lineno"> 1392</span>&#160; *                 <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a15728437b942dab0b0042eb06a407d2c">d</a> = 0; <a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a15728437b942dab0b0042eb06a407d2c">d</a> &lt; dim; ++<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a15728437b942dab0b0042eb06a407d2c">d</a>) </div><div class="line"><a name="l01393"></a><span class="lineno"> 1393</span>&#160; *                   forcing[dim + 1] += force[<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a15728437b942dab0b0042eb06a407d2c">d</a>] * w_q[<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a15728437b942dab0b0042eb06a407d2c">d</a> + 1]; </div><div class="line"><a name="l01394"></a><span class="lineno"> 1394</span>&#160; * </div><div class="line"><a name="l01395"></a><span class="lineno"> 1395</span>&#160; *                 phi.submit_value(forcing, q); </div><div class="line"><a name="l01396"></a><span class="lineno"> 1396</span>&#160; *               } </div><div class="line"><a name="l01397"></a><span class="lineno"> 1397</span>&#160; *           } </div><div class="line"><a name="l01398"></a><span class="lineno"> 1398</span>&#160; * </div><div class="line"><a name="l01399"></a><span class="lineno"> 1399</span>&#160; *         phi.integrate_scatter(((body_force.get() != <span class="keyword">nullptr</span>) ? </div><div class="line"><a name="l01400"></a><span class="lineno"> 1400</span>&#160; *                                  <a class="code" href="namespaceEvaluationFlags.html#a9b7c6d689cb76386839d0d13640f59aeaf9825c682f693a6a200094641a0d6a58">EvaluationFlags::values</a> : </div><div class="line"><a name="l01401"></a><span class="lineno"> 1401</span>&#160; *                                  <a class="code" href="namespaceEvaluationFlags.html#a9b7c6d689cb76386839d0d13640f59aea5f2c95ea073cc4f276c70ae12aceb88c">EvaluationFlags::nothing</a>) | </div><div class="line"><a name="l01402"></a><span class="lineno"> 1402</span>&#160; *                                 <a class="code" href="namespaceEvaluationFlags.html#a9b7c6d689cb76386839d0d13640f59aea91b5f00e4be473005cc331b8644ab2f1">EvaluationFlags::gradients</a>, </div><div class="line"><a name="l01403"></a><span class="lineno"> 1403</span>&#160; *                               dst); </div><div class="line"><a name="l01404"></a><span class="lineno"> 1404</span>&#160; *       } </div><div class="line"><a name="l01405"></a><span class="lineno"> 1405</span>&#160; *   } </div><div class="line"><a name="l01406"></a><span class="lineno"> 1406</span>&#160; * </div><div class="line"><a name="l01407"></a><span class="lineno"> 1407</span>&#160; * <span class="keyword">@end</span>code</div><div class="line"><a name="l01408"></a><span class="lineno"> 1408</span>&#160; * </div><div class="line"><a name="l01409"></a><span class="lineno"> 1409</span>&#160; * 下一个函数涉及到内部面的积分计算，在这里我们需要与面相邻的两个单元的评估器。我们将变量`phi_m`与解分量 @f$\mathbf{<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a6b25dd8f005063d8d2b0a4bdb0d277f3">w</a>}^-@f$ 相关联，将变量`phi_p`与解分量 @f$\mathbf{<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a6b25dd8f005063d8d2b0a4bdb0d277f3">w</a>}^+@f$ 相关联。我们在FEFaceEvaluation的构造函数中通过第二个参数来区分两边，`<span class="keyword">true</span>`表示内侧，`<span class="keyword">false</span>`表示外侧，内侧和外侧表示相对于法向量的方向。</div><div class="line"><a name="l01410"></a><span class="lineno"> 1410</span>&#160; * </div><div class="line"><a name="l01411"></a><span class="lineno"> 1411</span>&#160;</div><div class="line"><a name="l01412"></a><span class="lineno"> 1412</span>&#160; * </div><div class="line"><a name="l01413"></a><span class="lineno"> 1413</span>&#160; * 注意调用 <a class="code" href="classFEFaceEvaluation.html#a4ac53fde2eab227ef45c7d29a5ed33fe">FEFaceEvaluation::gather_evaluate</a>() 和 <a class="code" href="classFEFaceEvaluation.html">FEFaceEvaluation</a>::integrate_scatter() 结合了对向量的访问和因式分解部分。这种合并操作不仅节省了一行代码，而且还包含了一个重要的优化。鉴于我们在Gauss-Lobatto正交公式的点上使用拉格朗日多项式的节点基础，在每个面上只有 @f$(p+1)^{<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a15728437b942dab0b0042eb06a407d2c">d</a>-1}@f$ 的基础函数评估为非零。因此，评估器只访问了向量中的必要数据，而跳过了乘以零的部分。如果我们首先读取向量，我们就需要从向量中加载所有的数据，因为孤立的调用不知道后续操作中需要哪些数据。如果随后的 <a class="code" href="classFEFaceEvaluation.html#a92f84b8ad276ca9866f30c6f789cf3a4">FEFaceEvaluation::evaluate</a>() 调用要求数值和导数，确实需要每个分量的所有 @f$(p+1)^<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a15728437b942dab0b0042eb06a407d2c">d</a>@f$ 向量条目，因为所有基函数的法向导数都是非零的。</div><div class="line"><a name="l01414"></a><span class="lineno"> 1414</span>&#160; * </div><div class="line"><a name="l01415"></a><span class="lineno"> 1415</span>&#160;</div><div class="line"><a name="l01416"></a><span class="lineno"> 1416</span>&#160; * </div><div class="line"><a name="l01417"></a><span class="lineno"> 1417</span>&#160; * 评价器的参数以及程序与单元评价相似。由于非线性项的存在，我们再次使用更精确的（过度）积分方案，指定为列表中第三个模板参数。在正交点上，我们再去找我们的自由函数来计算数值通量。它从两边（即 @f$\mathbf{<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a6b25dd8f005063d8d2b0a4bdb0d277f3">w</a>}^-@f$ 和 @f$\mathbf{<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a6b25dd8f005063d8d2b0a4bdb0d277f3">w</a>}^+@f$ ）接收在正交点评估的解决方案，以及到减去一边的法向量。正如上面所解释的，数值通量已经乘以来自减法侧的法向量了。我们需要转换符号，因为在引言中得出的弱形式中，边界项带有一个减号。然后，通量被排队在减号和加号上进行测试，由于加号上的法向量与减号上的法向量正好相反，所以要调换符号。</div><div class="line"><a name="l01418"></a><span class="lineno"> 1418</span>&#160; * </div><div class="line"><a name="l01419"></a><span class="lineno"> 1419</span>&#160;</div><div class="line"><a name="l01420"></a><span class="lineno"> 1420</span>&#160; * </div><div class="line"><a name="l01421"></a><span class="lineno"> 1421</span>&#160; * </div><div class="line"><a name="l01422"></a><span class="lineno"> 1422</span>&#160; * @code</div><div class="line"><a name="l01423"></a><span class="lineno"> 1423</span>&#160; *   <span class="keyword">template</span> &lt;<span class="keywordtype">int</span> dim, <span class="keywordtype">int</span> degree, <span class="keywordtype">int</span> n_po<span class="keywordtype">int</span>s_1d&gt; </div><div class="line"><a name="l01424"></a><span class="lineno"> 1424</span>&#160; *   <span class="keywordtype">void</span> EulerOperator&lt;dim, degree, n_points_1d&gt;::local_apply_face( </div><div class="line"><a name="l01425"></a><span class="lineno"> 1425</span>&#160; *     <span class="keyword">const</span> <a class="code" href="classMatrixFree.html">MatrixFree&lt;dim, Number&gt;</a> &amp;, </div><div class="line"><a name="l01426"></a><span class="lineno"> 1426</span>&#160; *     <a class="code" href="classLinearAlgebra_1_1distributed_1_1Vector.html">LinearAlgebra::distributed::Vector&lt;Number&gt;</a> &amp;      dst, </div><div class="line"><a name="l01427"></a><span class="lineno"> 1427</span>&#160; *     <span class="keyword">const</span> <a class="code" href="classLinearAlgebra_1_1distributed_1_1Vector.html">LinearAlgebra::distributed::Vector&lt;Number&gt;</a> &amp;src, </div><div class="line"><a name="l01428"></a><span class="lineno"> 1428</span>&#160; *     <span class="keyword">const</span> std::pair&lt;unsigned int, unsigned int&gt; &amp;     face_range) <span class="keyword">const</span> </div><div class="line"><a name="l01429"></a><span class="lineno"> 1429</span>&#160; *   { </div><div class="line"><a name="l01430"></a><span class="lineno"> 1430</span>&#160; *     <a class="code" href="classFEFaceEvaluation.html">FEFaceEvaluation&lt;dim, degree, n_points_1d, dim + 2, Number&gt;</a> phi_m(data, </div><div class="line"><a name="l01431"></a><span class="lineno"> 1431</span>&#160; *                                                                       <span class="keyword">true</span>); </div><div class="line"><a name="l01432"></a><span class="lineno"> 1432</span>&#160; *     <a class="code" href="classFEFaceEvaluation.html">FEFaceEvaluation&lt;dim, degree, n_points_1d, dim + 2, Number&gt;</a> phi_p(data, </div><div class="line"><a name="l01433"></a><span class="lineno"> 1433</span>&#160; *                                                                       <span class="keyword">false</span>); </div><div class="line"><a name="l01434"></a><span class="lineno"> 1434</span>&#160; * </div><div class="line"><a name="l01435"></a><span class="lineno"> 1435</span>&#160; *     <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> face = face_range.first; face &lt; face_range.second; ++face) </div><div class="line"><a name="l01436"></a><span class="lineno"> 1436</span>&#160; *       { </div><div class="line"><a name="l01437"></a><span class="lineno"> 1437</span>&#160; *         phi_p.reinit(face); </div><div class="line"><a name="l01438"></a><span class="lineno"> 1438</span>&#160; *         phi_p.gather_evaluate(src, <a class="code" href="namespaceEvaluationFlags.html#a9b7c6d689cb76386839d0d13640f59aeaf9825c682f693a6a200094641a0d6a58">EvaluationFlags::values</a>); </div><div class="line"><a name="l01439"></a><span class="lineno"> 1439</span>&#160; * </div><div class="line"><a name="l01440"></a><span class="lineno"> 1440</span>&#160; *         phi_m.reinit(face); </div><div class="line"><a name="l01441"></a><span class="lineno"> 1441</span>&#160; *         phi_m.gather_evaluate(src, <a class="code" href="namespaceEvaluationFlags.html#a9b7c6d689cb76386839d0d13640f59aeaf9825c682f693a6a200094641a0d6a58">EvaluationFlags::values</a>); </div><div class="line"><a name="l01442"></a><span class="lineno"> 1442</span>&#160; * </div><div class="line"><a name="l01443"></a><span class="lineno"> 1443</span>&#160; *         <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> q = 0; q &lt; phi_m.n_q_points; ++q) </div><div class="line"><a name="l01444"></a><span class="lineno"> 1444</span>&#160; *           { </div><div class="line"><a name="l01445"></a><span class="lineno"> 1445</span>&#160; *             <span class="keyword">const</span> <span class="keyword">auto</span> numerical_flux = </div><div class="line"><a name="l01446"></a><span class="lineno"> 1446</span>&#160; *               euler_numerical_flux&lt;dim&gt;(phi_m.get_value(q), </div><div class="line"><a name="l01447"></a><span class="lineno"> 1447</span>&#160; *                                         phi_p.get_value(q), </div><div class="line"><a name="l01448"></a><span class="lineno"> 1448</span>&#160; *                                         phi_m.get_normal_vector(q)); </div><div class="line"><a name="l01449"></a><span class="lineno"> 1449</span>&#160; *             phi_m.submit_value(-numerical_flux, q); </div><div class="line"><a name="l01450"></a><span class="lineno"> 1450</span>&#160; *             phi_p.submit_value(numerical_flux, q); </div><div class="line"><a name="l01451"></a><span class="lineno"> 1451</span>&#160; *           } </div><div class="line"><a name="l01452"></a><span class="lineno"> 1452</span>&#160; * </div><div class="line"><a name="l01453"></a><span class="lineno"> 1453</span>&#160; *         phi_p.integrate_scatter(<a class="code" href="namespaceEvaluationFlags.html#a9b7c6d689cb76386839d0d13640f59aeaf9825c682f693a6a200094641a0d6a58">EvaluationFlags::values</a>, dst); </div><div class="line"><a name="l01454"></a><span class="lineno"> 1454</span>&#160; *         phi_m.integrate_scatter(<a class="code" href="namespaceEvaluationFlags.html#a9b7c6d689cb76386839d0d13640f59aeaf9825c682f693a6a200094641a0d6a58">EvaluationFlags::values</a>, dst); </div><div class="line"><a name="l01455"></a><span class="lineno"> 1455</span>&#160; *       } </div><div class="line"><a name="l01456"></a><span class="lineno"> 1456</span>&#160; *   } </div><div class="line"><a name="l01457"></a><span class="lineno"> 1457</span>&#160; * </div><div class="line"><a name="l01458"></a><span class="lineno"> 1458</span>&#160; * <span class="keyword">@end</span>code</div><div class="line"><a name="l01459"></a><span class="lineno"> 1459</span>&#160; * </div><div class="line"><a name="l01460"></a><span class="lineno"> 1460</span>&#160; * 对于位于边界的面，我们需要施加适当的边界条件。在这个教程程序中，我们实现了上述的四种情况。第五种情况，即超音速流出条件，将在下面的 <span class="stringliteral">&quot;结果 &quot;</span>部分讨论）。不连续的Galerkin方法对边界条件的施加不是作为约束条件，而只是弱化。因此，各种条件是通过找到一个适当的&lt;i&gt;exterior&lt;/i&gt;量 @f$\mathbf{<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a6b25dd8f005063d8d2b0a4bdb0d277f3">w</a>}^+@f$ 来施加的，然后将其交给也用于内部面的数值通量函数。实质上，我们在域外 <span class="stringliteral">&quot;假装 &quot;</span>一个状态，如果那是现实，PDE的解将满足我们想要的边界条件。</div><div class="line"><a name="l01461"></a><span class="lineno"> 1461</span>&#160; * </div><div class="line"><a name="l01462"></a><span class="lineno"> 1462</span>&#160;</div><div class="line"><a name="l01463"></a><span class="lineno"> 1463</span>&#160; * </div><div class="line"><a name="l01464"></a><span class="lineno"> 1464</span>&#160; * 对于墙的边界，我们需要对动量变量施加一个无正态通量的条件，而对于密度和能量，我们使用的是诺伊曼条件  @f$\rho^+ = \rho^-@f$  和  @f$E^+ = <a class="code" href="namespacenumbers.html#a3c7239f00d5e87dfcf6dd19cbc3ddc74">E</a>^-@f$  。为了实现无正态通量条件，我们将外部数值设定为内部数值，并减去墙面法线方向，即法线矢量方向上的速度的2倍。</div><div class="line"><a name="l01465"></a><span class="lineno"> 1465</span>&#160; * </div><div class="line"><a name="l01466"></a><span class="lineno"> 1466</span>&#160;</div><div class="line"><a name="l01467"></a><span class="lineno"> 1467</span>&#160; * </div><div class="line"><a name="l01468"></a><span class="lineno"> 1468</span>&#160; * 对于流入边界，我们简单地将给定的Dirichlet数据 @f$\mathbf{<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a6b25dd8f005063d8d2b0a4bdb0d277f3">w</a>}_\mathrm{D}@f$ 作为边界值。另一种方法是使用 @f$\mathbf{<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a6b25dd8f005063d8d2b0a4bdb0d277f3">w</a>}^+ = -\mathbf{<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a6b25dd8f005063d8d2b0a4bdb0d277f3">w</a>}^- + 2 \mathbf{<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a6b25dd8f005063d8d2b0a4bdb0d277f3">w</a>}_\mathrm{D}@f$  ，即所谓的镜像原理。</div><div class="line"><a name="l01469"></a><span class="lineno"> 1469</span>&#160; * </div><div class="line"><a name="l01470"></a><span class="lineno"> 1470</span>&#160;</div><div class="line"><a name="l01471"></a><span class="lineno"> 1471</span>&#160; * </div><div class="line"><a name="l01472"></a><span class="lineno"> 1472</span>&#160; * 强加外流本质上是一个诺伊曼条件，即设定  @f$\mathbf{<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a6b25dd8f005063d8d2b0a4bdb0d277f3">w</a>}^+ = \mathbf{<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a6b25dd8f005063d8d2b0a4bdb0d277f3">w</a>}^-@f$  。对于亚声速流出的情况，我们仍然需要强加一个能量值，我们从各自的函数中得出这个值。对于&lt;i&gt;backflow&lt;/i&gt;的情况，即在Neumann部分有动量通入域的情况，需要一个特殊的步骤。根据文献（这一事实可以通过适当的能量论证得出），我们必须切换到流入部分的通量的另一个变体，见Gravemeier, Comerford, Yoshihara, Ismail, Wall, <span class="stringliteral">&quot;A novel formulation for Neumann inflow conditions in biomechanics&quot;</span>, Int. J. Numer. Meth. 生物医学。Eng., vol. 28 (2012). 这里，动量项需要再次添加，这相当于去除动量变量上的通量贡献。我们在后处理步骤中这样做，而且只适用于我们都处于外流边界且法向量与动量（或等同于速度）之间的点积为负的情况。由于我们在SIMD矢量化中一次处理多个正交点的数据，这里需要明确地在SIMD数组的条目上循环。</div><div class="line"><a name="l01473"></a><span class="lineno"> 1473</span>&#160; * </div><div class="line"><a name="l01474"></a><span class="lineno"> 1474</span>&#160;</div><div class="line"><a name="l01475"></a><span class="lineno"> 1475</span>&#160; * </div><div class="line"><a name="l01476"></a><span class="lineno"> 1476</span>&#160; * 在下面的实现中，我们在正交点的层面上检查各种类型的边界。当然，我们也可以将决定权移出正交点循环，将整个面孔视为同类，这就避免了在正交点的内循环中进行一些地图/集合的查找。然而，效率的损失并不明显，所以我们在这里选择了更简单的代码。还要注意的是，最后的 <span class="stringliteral">&quot;else &quot;</span>子句会捕捉到这样的情况，即边界的某些部分没有通过 `EulerOperator::set_..._boundary(...)`. 分配任何边界条件。</div><div class="line"><a name="l01477"></a><span class="lineno"> 1477</span>&#160; * </div><div class="line"><a name="l01478"></a><span class="lineno"> 1478</span>&#160; * @code</div><div class="line"><a name="l01479"></a><span class="lineno"> 1479</span>&#160; *   <span class="keyword">template</span> &lt;<span class="keywordtype">int</span> dim, <span class="keywordtype">int</span> degree, <span class="keywordtype">int</span> n_po<span class="keywordtype">int</span>s_1d&gt; </div><div class="line"><a name="l01480"></a><span class="lineno"> 1480</span>&#160; *   <span class="keywordtype">void</span> EulerOperator&lt;dim, degree, n_points_1d&gt;::local_apply_boundary_face( </div><div class="line"><a name="l01481"></a><span class="lineno"> 1481</span>&#160; *     <span class="keyword">const</span> <a class="code" href="classMatrixFree.html">MatrixFree&lt;dim, Number&gt;</a> &amp;, </div><div class="line"><a name="l01482"></a><span class="lineno"> 1482</span>&#160; *     <a class="code" href="classLinearAlgebra_1_1distributed_1_1Vector.html">LinearAlgebra::distributed::Vector&lt;Number&gt;</a> &amp;      dst, </div><div class="line"><a name="l01483"></a><span class="lineno"> 1483</span>&#160; *     <span class="keyword">const</span> <a class="code" href="classLinearAlgebra_1_1distributed_1_1Vector.html">LinearAlgebra::distributed::Vector&lt;Number&gt;</a> &amp;src, </div><div class="line"><a name="l01484"></a><span class="lineno"> 1484</span>&#160; *     <span class="keyword">const</span> std::pair&lt;unsigned int, unsigned int&gt; &amp;     face_range) <span class="keyword">const</span> </div><div class="line"><a name="l01485"></a><span class="lineno"> 1485</span>&#160; *   { </div><div class="line"><a name="l01486"></a><span class="lineno"> 1486</span>&#160; *     <a class="code" href="classFEFaceEvaluation.html">FEFaceEvaluation&lt;dim, degree, n_points_1d, dim + 2, Number&gt;</a> phi(data, <span class="keyword">true</span>); </div><div class="line"><a name="l01487"></a><span class="lineno"> 1487</span>&#160; * </div><div class="line"><a name="l01488"></a><span class="lineno"> 1488</span>&#160; *     <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> face = face_range.first; face &lt; face_range.second; ++face) </div><div class="line"><a name="l01489"></a><span class="lineno"> 1489</span>&#160; *       { </div><div class="line"><a name="l01490"></a><span class="lineno"> 1490</span>&#160; *         phi.reinit(face); </div><div class="line"><a name="l01491"></a><span class="lineno"> 1491</span>&#160; *         phi.gather_evaluate(src, <a class="code" href="namespaceEvaluationFlags.html#a9b7c6d689cb76386839d0d13640f59aeaf9825c682f693a6a200094641a0d6a58">EvaluationFlags::values</a>); </div><div class="line"><a name="l01492"></a><span class="lineno"> 1492</span>&#160; * </div><div class="line"><a name="l01493"></a><span class="lineno"> 1493</span>&#160; *         <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> q = 0; q &lt; phi.n_q_points; ++q) </div><div class="line"><a name="l01494"></a><span class="lineno"> 1494</span>&#160; *           { </div><div class="line"><a name="l01495"></a><span class="lineno"> 1495</span>&#160; *             <span class="keyword">const</span> <span class="keyword">auto</span> w_m    = phi.get_value(q); </div><div class="line"><a name="l01496"></a><span class="lineno"> 1496</span>&#160; *             <span class="keyword">const</span> <span class="keyword">auto</span> normal = phi.get_normal_vector(q); </div><div class="line"><a name="l01497"></a><span class="lineno"> 1497</span>&#160; * </div><div class="line"><a name="l01498"></a><span class="lineno"> 1498</span>&#160; *             <span class="keyword">auto</span> rho_u_dot_n = w_m[1] * normal[0]; </div><div class="line"><a name="l01499"></a><span class="lineno"> 1499</span>&#160; *             <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a15728437b942dab0b0042eb06a407d2c">d</a> = 1; <a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a15728437b942dab0b0042eb06a407d2c">d</a> &lt; dim; ++<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a15728437b942dab0b0042eb06a407d2c">d</a>) </div><div class="line"><a name="l01500"></a><span class="lineno"> 1500</span>&#160; *               rho_u_dot_n += w_m[1 + <a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a15728437b942dab0b0042eb06a407d2c">d</a>] * normal[<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a15728437b942dab0b0042eb06a407d2c">d</a>]; </div><div class="line"><a name="l01501"></a><span class="lineno"> 1501</span>&#160; * </div><div class="line"><a name="l01502"></a><span class="lineno"> 1502</span>&#160; *             <span class="keywordtype">bool</span> at_outflow = <span class="keyword">false</span>; </div><div class="line"><a name="l01503"></a><span class="lineno"> 1503</span>&#160; * </div><div class="line"><a name="l01504"></a><span class="lineno"> 1504</span>&#160; *             <a class="code" href="classTensor.html">Tensor&lt;1, dim + 2, VectorizedArray&lt;Number&gt;</a>&gt; w_p; </div><div class="line"><a name="l01505"></a><span class="lineno"> 1505</span>&#160; *             <span class="keyword">const</span> <span class="keyword">auto</span> <a class="code" href="namespacetypes.html#aed8813fee8c8a2edcc6005e6a48c321a">boundary_id</a> = data.get_boundary_id(face); </div><div class="line"><a name="l01506"></a><span class="lineno"> 1506</span>&#160; *             <span class="keywordflow">if</span> (wall_boundaries.find(<a class="code" href="namespacetypes.html#aed8813fee8c8a2edcc6005e6a48c321a">boundary_id</a>) != wall_boundaries.end()) </div><div class="line"><a name="l01507"></a><span class="lineno"> 1507</span>&#160; *               { </div><div class="line"><a name="l01508"></a><span class="lineno"> 1508</span>&#160; *                 w_p[0] = w_m[0]; </div><div class="line"><a name="l01509"></a><span class="lineno"> 1509</span>&#160; *                 <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a15728437b942dab0b0042eb06a407d2c">d</a> = 0; <a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a15728437b942dab0b0042eb06a407d2c">d</a> &lt; dim; ++<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a15728437b942dab0b0042eb06a407d2c">d</a>) </div><div class="line"><a name="l01510"></a><span class="lineno"> 1510</span>&#160; *                   w_p[<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a15728437b942dab0b0042eb06a407d2c">d</a> + 1] = w_m[<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a15728437b942dab0b0042eb06a407d2c">d</a> + 1] - 2. * rho_u_dot_n * normal[<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a15728437b942dab0b0042eb06a407d2c">d</a>]; </div><div class="line"><a name="l01511"></a><span class="lineno"> 1511</span>&#160; *                 w_p[dim + 1] = w_m[dim + 1]; </div><div class="line"><a name="l01512"></a><span class="lineno"> 1512</span>&#160; *               } </div><div class="line"><a name="l01513"></a><span class="lineno"> 1513</span>&#160; *             <span class="keywordflow">else</span> <span class="keywordflow">if</span> (inflow_boundaries.find(<a class="code" href="namespacetypes.html#aed8813fee8c8a2edcc6005e6a48c321a">boundary_id</a>) != </div><div class="line"><a name="l01514"></a><span class="lineno"> 1514</span>&#160; *                      inflow_boundaries.end()) </div><div class="line"><a name="l01515"></a><span class="lineno"> 1515</span>&#160; *               w_p = </div><div class="line"><a name="l01516"></a><span class="lineno"> 1516</span>&#160; *                 evaluate_function(*inflow_boundaries.find(<a class="code" href="namespacetypes.html#aed8813fee8c8a2edcc6005e6a48c321a">boundary_id</a>)-&gt;second, </div><div class="line"><a name="l01517"></a><span class="lineno"> 1517</span>&#160; *                                   phi.quadrature_point(q)); </div><div class="line"><a name="l01518"></a><span class="lineno"> 1518</span>&#160; *             <span class="keywordflow">else</span> <span class="keywordflow">if</span> (subsonic_outflow_boundaries.find(<a class="code" href="namespacetypes.html#aed8813fee8c8a2edcc6005e6a48c321a">boundary_id</a>) != </div><div class="line"><a name="l01519"></a><span class="lineno"> 1519</span>&#160; *                      subsonic_outflow_boundaries.end()) </div><div class="line"><a name="l01520"></a><span class="lineno"> 1520</span>&#160; *               { </div><div class="line"><a name="l01521"></a><span class="lineno"> 1521</span>&#160; *                 w_p          = w_m; </div><div class="line"><a name="l01522"></a><span class="lineno"> 1522</span>&#160; *                 w_p[dim + 1] = evaluate_function( </div><div class="line"><a name="l01523"></a><span class="lineno"> 1523</span>&#160; *                   *subsonic_outflow_boundaries.find(<a class="code" href="namespacetypes.html#aed8813fee8c8a2edcc6005e6a48c321a">boundary_id</a>)-&gt;second, </div><div class="line"><a name="l01524"></a><span class="lineno"> 1524</span>&#160; *                   phi.quadrature_point(q), </div><div class="line"><a name="l01525"></a><span class="lineno"> 1525</span>&#160; *                   dim + 1); </div><div class="line"><a name="l01526"></a><span class="lineno"> 1526</span>&#160; *                 at_outflow = <span class="keyword">true</span>; </div><div class="line"><a name="l01527"></a><span class="lineno"> 1527</span>&#160; *               } </div><div class="line"><a name="l01528"></a><span class="lineno"> 1528</span>&#160; *             <span class="keywordflow">else</span> </div><div class="line"><a name="l01529"></a><span class="lineno"> 1529</span>&#160; *               <a class="code" href="group__Exceptions.html#gafc0ca7ad85b3ebd64e8e51689ac85caf">AssertThrow</a>(<span class="keyword">false</span>, </div><div class="line"><a name="l01530"></a><span class="lineno"> 1530</span>&#160; *                           <a class="code" href="group__Exceptions.html#gae9a45f517af1401c50811a11083f9114">ExcMessage</a>(<span class="stringliteral">&quot;Unknown boundary id, did &quot;</span> </div><div class="line"><a name="l01531"></a><span class="lineno"> 1531</span>&#160; *                                      <span class="stringliteral">&quot;you set a boundary condition for &quot;</span> </div><div class="line"><a name="l01532"></a><span class="lineno"> 1532</span>&#160; *                                      <span class="stringliteral">&quot;this part of the domain boundary?&quot;</span>)); </div><div class="line"><a name="l01533"></a><span class="lineno"> 1533</span>&#160; * </div><div class="line"><a name="l01534"></a><span class="lineno"> 1534</span>&#160; *             <span class="keyword">auto</span> flux = euler_numerical_flux&lt;dim&gt;(w_m, w_p, normal); </div><div class="line"><a name="l01535"></a><span class="lineno"> 1535</span>&#160; * </div><div class="line"><a name="l01536"></a><span class="lineno"> 1536</span>&#160; *             <span class="keywordflow">if</span> (at_outflow) </div><div class="line"><a name="l01537"></a><span class="lineno"> 1537</span>&#160; *               <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> v = 0; v &lt; VectorizedArray&lt;Number&gt;::size(); ++v) </div><div class="line"><a name="l01538"></a><span class="lineno"> 1538</span>&#160; *                 { </div><div class="line"><a name="l01539"></a><span class="lineno"> 1539</span>&#160; *                   <span class="keywordflow">if</span> (rho_u_dot_n[v] &lt; -1<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a9587d5229555daa5b1fa1ba2f8a40adb">e</a>-12) </div><div class="line"><a name="l01540"></a><span class="lineno"> 1540</span>&#160; *                     <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a15728437b942dab0b0042eb06a407d2c">d</a> = 0; <a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a15728437b942dab0b0042eb06a407d2c">d</a> &lt; dim; ++<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a15728437b942dab0b0042eb06a407d2c">d</a>) </div><div class="line"><a name="l01541"></a><span class="lineno"> 1541</span>&#160; *                       flux[<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a15728437b942dab0b0042eb06a407d2c">d</a> + 1][v] = 0.; </div><div class="line"><a name="l01542"></a><span class="lineno"> 1542</span>&#160; *                 } </div><div class="line"><a name="l01543"></a><span class="lineno"> 1543</span>&#160; * </div><div class="line"><a name="l01544"></a><span class="lineno"> 1544</span>&#160; *             phi.submit_value(-flux, q); </div><div class="line"><a name="l01545"></a><span class="lineno"> 1545</span>&#160; *           } </div><div class="line"><a name="l01546"></a><span class="lineno"> 1546</span>&#160; * </div><div class="line"><a name="l01547"></a><span class="lineno"> 1547</span>&#160; *         phi.integrate_scatter(<a class="code" href="namespaceEvaluationFlags.html#a9b7c6d689cb76386839d0d13640f59aeaf9825c682f693a6a200094641a0d6a58">EvaluationFlags::values</a>, dst); </div><div class="line"><a name="l01548"></a><span class="lineno"> 1548</span>&#160; *       } </div><div class="line"><a name="l01549"></a><span class="lineno"> 1549</span>&#160; *   } </div><div class="line"><a name="l01550"></a><span class="lineno"> 1550</span>&#160; * </div><div class="line"><a name="l01551"></a><span class="lineno"> 1551</span>&#160; * <span class="keyword">@end</span>code</div><div class="line"><a name="l01552"></a><span class="lineno"> 1552</span>&#160; * </div><div class="line"><a name="l01553"></a><span class="lineno"> 1553</span>&#160; * 下一个函数实现了质量矩阵的逆运算。在介绍中已经广泛讨论了算法和原理，所以我们在这里只讨论 <a class="code" href="classMatrixFreeOperators_1_1CellwiseInverseMassMatrix.html">MatrixFreeOperators::CellwiseInverseMassMatrix</a> 类的技术问题。它所做的操作与质量矩阵的正向评估类似，只是使用了不同的插值矩阵，代表逆 @f$S^{-1}@f$ 因子。这些代表了从指定的基础（在这种情况下，高斯--洛巴托正交公式点中的拉格朗日基础）到高斯正交公式点中的拉格朗日基础的改变。在后者的基础上，我们可以应用点的逆向`JxW`因子，即正交权重乘以从参考坐标到实坐标的映射的雅各布系数。一旦完成了这一操作，基数将再次变回节点高斯-洛巴托基数。所有这些操作都由下面的 <span class="stringliteral">&quot;apply() &quot;</span>函数完成。我们需要提供的是要操作的局部场（我们通过一个FEEvaluation对象从全局向量中提取），并将结果写回质量矩阵操作的目标向量。</div><div class="line"><a name="l01554"></a><span class="lineno"> 1554</span>&#160; * </div><div class="line"><a name="l01555"></a><span class="lineno"> 1555</span>&#160;</div><div class="line"><a name="l01556"></a><span class="lineno"> 1556</span>&#160; * </div><div class="line"><a name="l01557"></a><span class="lineno"> 1557</span>&#160; * 需要注意的一点是，我们在FEEvaluation的构造函数中添加了两个整数参数（可选），第一个是0（在多DoFHandler系统中选择DoFHandler；在这里，我们只有一个），第二个是1，用于进行正交公式选择。由于我们将正交公式0用于非线性项的过度积分，我们使用公式1与默认的 @f$p+1@f$ （或变量名称中的`fe_degree+1`）点用于质量矩阵。这导致了对质量矩阵的平方贡献，并确保了精确的积分，正如介绍中所解释的。</div><div class="line"><a name="l01558"></a><span class="lineno"> 1558</span>&#160; * </div><div class="line"><a name="l01559"></a><span class="lineno"> 1559</span>&#160;</div><div class="line"><a name="l01560"></a><span class="lineno"> 1560</span>&#160; * </div><div class="line"><a name="l01561"></a><span class="lineno"> 1561</span>&#160; * </div><div class="line"><a name="l01562"></a><span class="lineno"> 1562</span>&#160; * @code</div><div class="line"><a name="l01563"></a><span class="lineno"> 1563</span>&#160; *   <span class="keyword">template</span> &lt;<span class="keywordtype">int</span> dim, <span class="keywordtype">int</span> degree, <span class="keywordtype">int</span> n_po<span class="keywordtype">int</span>s_1d&gt; </div><div class="line"><a name="l01564"></a><span class="lineno"> 1564</span>&#160; *   <span class="keywordtype">void</span> EulerOperator&lt;dim, degree, n_points_1d&gt;::local_apply_inverse_mass_matrix( </div><div class="line"><a name="l01565"></a><span class="lineno"> 1565</span>&#160; *     <span class="keyword">const</span> <a class="code" href="classMatrixFree.html">MatrixFree&lt;dim, Number&gt;</a> &amp;, </div><div class="line"><a name="l01566"></a><span class="lineno"> 1566</span>&#160; *     <a class="code" href="classLinearAlgebra_1_1distributed_1_1Vector.html">LinearAlgebra::distributed::Vector&lt;Number&gt;</a> &amp;      dst, </div><div class="line"><a name="l01567"></a><span class="lineno"> 1567</span>&#160; *     <span class="keyword">const</span> <a class="code" href="classLinearAlgebra_1_1distributed_1_1Vector.html">LinearAlgebra::distributed::Vector&lt;Number&gt;</a> &amp;src, </div><div class="line"><a name="l01568"></a><span class="lineno"> 1568</span>&#160; *     <span class="keyword">const</span> std::pair&lt;unsigned int, unsigned int&gt; &amp;     cell_range) <span class="keyword">const</span> </div><div class="line"><a name="l01569"></a><span class="lineno"> 1569</span>&#160; *   { </div><div class="line"><a name="l01570"></a><span class="lineno"> 1570</span>&#160; *     <a class="code" href="classFEEvaluation.html">FEEvaluation&lt;dim, degree, degree + 1, dim + 2, Number&gt;</a> phi(data, 0, 1); </div><div class="line"><a name="l01571"></a><span class="lineno"> 1571</span>&#160; *     <a class="code" href="classMatrixFreeOperators_1_1CellwiseInverseMassMatrix.html">MatrixFreeOperators::CellwiseInverseMassMatrix&lt;dim, degree, dim + 2, Number&gt;</a> </div><div class="line"><a name="l01572"></a><span class="lineno"> 1572</span>&#160; *       inverse(phi); </div><div class="line"><a name="l01573"></a><span class="lineno"> 1573</span>&#160; * </div><div class="line"><a name="l01574"></a><span class="lineno"> 1574</span>&#160; *     <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> cell = cell_range.first; cell &lt; cell_range.second; ++cell) </div><div class="line"><a name="l01575"></a><span class="lineno"> 1575</span>&#160; *       { </div><div class="line"><a name="l01576"></a><span class="lineno"> 1576</span>&#160; *         phi.reinit(cell); </div><div class="line"><a name="l01577"></a><span class="lineno"> 1577</span>&#160; *         phi.read_dof_values(src); </div><div class="line"><a name="l01578"></a><span class="lineno"> 1578</span>&#160; * </div><div class="line"><a name="l01579"></a><span class="lineno"> 1579</span>&#160; *         inverse.apply(phi.begin_dof_values(), phi.begin_dof_values()); </div><div class="line"><a name="l01580"></a><span class="lineno"> 1580</span>&#160; * </div><div class="line"><a name="l01581"></a><span class="lineno"> 1581</span>&#160; *         phi.set_dof_values(dst); </div><div class="line"><a name="l01582"></a><span class="lineno"> 1582</span>&#160; *       } </div><div class="line"><a name="l01583"></a><span class="lineno"> 1583</span>&#160; *   } </div><div class="line"><a name="l01584"></a><span class="lineno"> 1584</span>&#160; * </div><div class="line"><a name="l01585"></a><span class="lineno"> 1585</span>&#160; * <span class="keyword">@end</span>code</div><div class="line"><a name="l01586"></a><span class="lineno"> 1586</span>&#160; * </div><div class="line"><a name="l01587"></a><span class="lineno"> 1587</span>&#160; * </div><div class="line"><a name="l01588"></a><span class="lineno"> 1588</span>&#160; * &lt;a name=<span class="stringliteral">&quot;Theapplyandrelatedfunctions&quot;</span>&gt;&lt;/a&gt; </div><div class="line"><a name="l01589"></a><span class="lineno"> 1589</span>&#160; * &lt;h4&gt;The <a class="code" href="namespacestd__cxx17.html#aa2fc1031c06af4aea4de90c5a1905473">apply</a>() and related <a class="code" href="namespaceinternal_1_1p4est.html#a4b980c7b4b4d9984e93d73c7d30173ea">functions</a>&lt;/h4&gt;</div><div class="line"><a name="l01590"></a><span class="lineno"> 1590</span>&#160; * </div><div class="line"><a name="l01591"></a><span class="lineno"> 1591</span>&#160;</div><div class="line"><a name="l01592"></a><span class="lineno"> 1592</span>&#160; * </div><div class="line"><a name="l01593"></a><span class="lineno"> 1593</span>&#160; * 我们现在来到实现欧拉算子整体评估的函数，即 @f$\mathcal M^{-1} \mathcal <a class="code" href="namespaceLAPACKSupport.html#a0a1f0b9f7bb0b746b8f27d7f297ed7fe">L</a>(t, \mathbf{<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a6b25dd8f005063d8d2b0a4bdb0d277f3">w</a>})@f$  ，调用上面介绍的局部评估器。这些步骤在前面的代码中应该是清楚的。需要注意的一点是，我们需要调整与边界各部分相关的函数中的时间，以便在边界数据与时间相关的情况下与方程一致。然后，我们调用 <a class="code" href="classMatrixFree.html#a0e9669e4a5cfaceac78f5e26c285c2ea">MatrixFree::loop</a>() 来执行单元和面的积分，包括在`src`向量中进行必要的ghost数据交换。该函数的第七个参数，&quot;true&quot;，指定我们要在开始向其累积积分之前，将 &quot;dst &quot;向量作为循环的一部分归零。这个变体比在循环之前明确调用`dst = 0.;`要好，因为归零操作是在矢量的子范围内完成的，其部分是由附近的积分写入的。这加强了数据的定位，并允许缓存，节省了向量数据到主内存的一次往返，提高了性能。循环的最后两个参数决定了哪些数据被交换：由于我们只访问一个面的形状函数的值，这是典型的一阶双曲问题，并且由于我们有一个节点基础，节点位于参考元素表面，我们只需要交换这些部分。这又节省了宝贵的内存带宽。</div><div class="line"><a name="l01594"></a><span class="lineno"> 1594</span>&#160; * </div><div class="line"><a name="l01595"></a><span class="lineno"> 1595</span>&#160;</div><div class="line"><a name="l01596"></a><span class="lineno"> 1596</span>&#160; * </div><div class="line"><a name="l01597"></a><span class="lineno"> 1597</span>&#160; * 一旦应用了空间算子 @f$\mathcal <a class="code" href="namespaceLAPACKSupport.html#a0a1f0b9f7bb0b746b8f27d7f297ed7fe">L</a>@f$ ，我们需要进行第二轮操作，应用反质量矩阵。这里，我们调用 <a class="code" href="classMatrixFree.html">MatrixFree</a>::cell_loop() ，因为只有单元格积分出现。单元循环比全循环更便宜，因为只访问与本地拥有的单元相关的自由度，这只是DG离散化的本地拥有的自由度。因此，这里不需要鬼魂交换。</div><div class="line"><a name="l01598"></a><span class="lineno"> 1598</span>&#160; * </div><div class="line"><a name="l01599"></a><span class="lineno"> 1599</span>&#160;</div><div class="line"><a name="l01600"></a><span class="lineno"> 1600</span>&#160; * </div><div class="line"><a name="l01601"></a><span class="lineno"> 1601</span>&#160; * 在所有这些函数的周围，我们设置了定时器范围来记录计算时间，以统计各部分的贡献。</div><div class="line"><a name="l01602"></a><span class="lineno"> 1602</span>&#160; * </div><div class="line"><a name="l01603"></a><span class="lineno"> 1603</span>&#160;</div><div class="line"><a name="l01604"></a><span class="lineno"> 1604</span>&#160; * </div><div class="line"><a name="l01605"></a><span class="lineno"> 1605</span>&#160; * </div><div class="line"><a name="l01606"></a><span class="lineno"> 1606</span>&#160; * @code</div><div class="line"><a name="l01607"></a><span class="lineno"> 1607</span>&#160; *   template &lt;<span class="keywordtype">int</span> dim, <span class="keywordtype">int</span> degree, <span class="keywordtype">int</span> n_points_1d&gt; </div><div class="line"><a name="l01608"></a><span class="lineno"> 1608</span>&#160; *   <span class="keywordtype">void</span> EulerOperator&lt;dim, degree, n_points_1d&gt;::<a class="code" href="namespacestd__cxx17.html#aa2fc1031c06af4aea4de90c5a1905473">apply</a>( </div><div class="line"><a name="l01609"></a><span class="lineno"> 1609</span>&#160; *     const <span class="keywordtype">double</span>                                      current_time, </div><div class="line"><a name="l01610"></a><span class="lineno"> 1610</span>&#160; *     const <a class="code" href="namespaceLinearAlgebra.html">LinearAlgebra</a>::distributed::<a class="code" href="classVector.html">Vector</a>&lt;Number&gt; &amp;src, </div><div class="line"><a name="l01611"></a><span class="lineno"> 1611</span>&#160; *     <a class="code" href="namespaceLinearAlgebra.html">LinearAlgebra</a>::distributed::<a class="code" href="classVector.html">Vector</a>&lt;Number&gt; &amp;      dst) const </div><div class="line"><a name="l01612"></a><span class="lineno"> 1612</span>&#160; *   { </div><div class="line"><a name="l01613"></a><span class="lineno"> 1613</span>&#160; *     { </div><div class="line"><a name="l01614"></a><span class="lineno"> 1614</span>&#160; *       <a class="code" href="classTimerOutput_1_1Scope.html">TimerOutput::Scope</a> t(timer, <span class="stringliteral">&quot;apply - integrals&quot;</span>); </div><div class="line"><a name="l01615"></a><span class="lineno"> 1615</span>&#160; * </div><div class="line"><a name="l01616"></a><span class="lineno"> 1616</span>&#160; *       <span class="keywordflow">for</span> (<span class="keyword">auto</span> &amp;i : inflow_boundaries) </div><div class="line"><a name="l01617"></a><span class="lineno"> 1617</span>&#160; *         i.second-&gt;set_time(current_time); </div><div class="line"><a name="l01618"></a><span class="lineno"> 1618</span>&#160; *       <span class="keywordflow">for</span> (<span class="keyword">auto</span> &amp;i : subsonic_outflow_boundaries) </div><div class="line"><a name="l01619"></a><span class="lineno"> 1619</span>&#160; *         i.second-&gt;set_time(current_time); </div><div class="line"><a name="l01620"></a><span class="lineno"> 1620</span>&#160; * </div><div class="line"><a name="l01621"></a><span class="lineno"> 1621</span>&#160; *       data.loop(&amp;EulerOperator::local_apply_cell, </div><div class="line"><a name="l01622"></a><span class="lineno"> 1622</span>&#160; *                 &amp;EulerOperator::local_apply_face, </div><div class="line"><a name="l01623"></a><span class="lineno"> 1623</span>&#160; *                 &amp;EulerOperator::local_apply_boundary_face, </div><div class="line"><a name="l01624"></a><span class="lineno"> 1624</span>&#160; *                 <span class="keyword">this</span>, </div><div class="line"><a name="l01625"></a><span class="lineno"> 1625</span>&#160; *                 dst, </div><div class="line"><a name="l01626"></a><span class="lineno"> 1626</span>&#160; *                 src, </div><div class="line"><a name="l01627"></a><span class="lineno"> 1627</span>&#160; *                 <span class="keyword">true</span>, </div><div class="line"><a name="l01628"></a><span class="lineno"> 1628</span>&#160; *                 <a class="code" href="classMatrixFree.html">MatrixFree&lt;dim, Number&gt;::DataAccessOnFaces::values</a>, </div><div class="line"><a name="l01629"></a><span class="lineno"> 1629</span>&#160; *                 <a class="code" href="classMatrixFree.html">MatrixFree&lt;dim, Number&gt;::DataAccessOnFaces::values</a>); </div><div class="line"><a name="l01630"></a><span class="lineno"> 1630</span>&#160; *     } </div><div class="line"><a name="l01631"></a><span class="lineno"> 1631</span>&#160; * </div><div class="line"><a name="l01632"></a><span class="lineno"> 1632</span>&#160; *     { </div><div class="line"><a name="l01633"></a><span class="lineno"> 1633</span>&#160; *       <a class="code" href="classTimerOutput_1_1Scope.html">TimerOutput::Scope</a> t(timer, <span class="stringliteral">&quot;apply - inverse mass&quot;</span>); </div><div class="line"><a name="l01634"></a><span class="lineno"> 1634</span>&#160; * </div><div class="line"><a name="l01635"></a><span class="lineno"> 1635</span>&#160; *       data.cell_loop(&amp;EulerOperator::local_apply_inverse_mass_matrix, </div><div class="line"><a name="l01636"></a><span class="lineno"> 1636</span>&#160; *                      <span class="keyword">this</span>, </div><div class="line"><a name="l01637"></a><span class="lineno"> 1637</span>&#160; *                      dst, </div><div class="line"><a name="l01638"></a><span class="lineno"> 1638</span>&#160; *                      dst); </div><div class="line"><a name="l01639"></a><span class="lineno"> 1639</span>&#160; *     } </div><div class="line"><a name="l01640"></a><span class="lineno"> 1640</span>&#160; *   } </div><div class="line"><a name="l01641"></a><span class="lineno"> 1641</span>&#160; * </div><div class="line"><a name="l01642"></a><span class="lineno"> 1642</span>&#160; * <span class="keyword">@end</span>code</div><div class="line"><a name="l01643"></a><span class="lineno"> 1643</span>&#160; * </div><div class="line"><a name="l01644"></a><span class="lineno"> 1644</span>&#160; * 让我们转到做Runge--Kutta更新的整个阶段的函数。它调用 <a class="code" href="namespacestd__cxx17.html#aa2fc1031c06af4aea4de90c5a1905473">EulerOperator::apply</a>() ，然后对向量进行一些更新，即`next_ri = solution + factor_ai * k_i`和`solution += factor_solution * k_i`。与其通过向量接口执行这些步骤，我们在这里提出了一个替代策略，在基于缓存的架构上速度更快。由于向量所消耗的内存往往比缓存所能容纳的要大得多，因此数据必须有效地来自缓慢的RAM内存。这种情况可以通过循环融合来改善，即在一次扫描中对`next_ki`和`solution`进行更新。在这种情况下，我们将读取两个向量`rhs`和`solution`并写入`next_ki`和`solution`，而在基线情况下，至少有4次读取和两次写入。在这里，我们更进一步，当质量矩阵反转在向量的某一部分完成后，立即执行循环。  <a class="code" href="classMatrixFree.html">MatrixFree</a>::cell_loop() 提供了一种机制，在单元格的循环第一次接触到一个向量条目之前，附加一个 `<a class="code" href="namespacestd.html">std</a>::function` （我们在这里没有使用，但用于例如向量的归零），以及在循环最后接触到一个条目之后，调用第二个 `<a class="code" href="namespacestd.html">std</a>::function` 。回调的形式是给定向量上的一个范围（就MPI宇宙中的本地索引编号而言），可以由`local_element()`函数来处理。</div><div class="line"><a name="l01645"></a><span class="lineno"> 1645</span>&#160; * </div><div class="line"><a name="l01646"></a><span class="lineno"> 1646</span>&#160;</div><div class="line"><a name="l01647"></a><span class="lineno"> 1647</span>&#160; * </div><div class="line"><a name="l01648"></a><span class="lineno"> 1648</span>&#160; * 对于这个第二个回调，我们创建一个lambda，在一个范围内工作，并在这个范围内写入相应的更新。理想情况下，我们会在本地循环之前添加`<a class="code" href="config_8h.html#a202e950262df75b31ea0486f4dd2447f">DEAL_II_OPENMP_SIMD_PRAGMA</a>`，以建议编译器对这个循环进行SIMD并行化（这意味着在实践中我们要确保在循环内部使用的指针的索引范围之间没有重叠，也称为别名）。事实证明，在写这篇文章的时候，GCC 7.2无法编译lambda函数中的OpenMP pragma，所以我们在下面注释了这个pragma。如果你的编译器比较新，你应该可以再次取消注释这些行。</div><div class="line"><a name="l01649"></a><span class="lineno"> 1649</span>&#160; * </div><div class="line"><a name="l01650"></a><span class="lineno"> 1650</span>&#160;</div><div class="line"><a name="l01651"></a><span class="lineno"> 1651</span>&#160; * </div><div class="line"><a name="l01652"></a><span class="lineno"> 1652</span>&#160; * 注意，当我们不需要更新`next_ri`向量时，我们为最后的Runge--Kutta阶段选择不同的代码路径。这个策略带来了相当大的速度提升。在40核机器上，默认矢量更新时，逆质量矩阵和矢量更新需要60%以上的计算时间，而在更优化的变体中，这一比例约为35%。换句话说，这是一个大约三分之一的速度提升。</div><div class="line"><a name="l01653"></a><span class="lineno"> 1653</span>&#160; * </div><div class="line"><a name="l01654"></a><span class="lineno"> 1654</span>&#160;</div><div class="line"><a name="l01655"></a><span class="lineno"> 1655</span>&#160; * </div><div class="line"><a name="l01656"></a><span class="lineno"> 1656</span>&#160; * </div><div class="line"><a name="l01657"></a><span class="lineno"> 1657</span>&#160; * @code</div><div class="line"><a name="l01658"></a><span class="lineno"> 1658</span>&#160; *   template &lt;<span class="keywordtype">int</span> dim, <span class="keywordtype">int</span> degree, <span class="keywordtype">int</span> n_points_1d&gt; </div><div class="line"><a name="l01659"></a><span class="lineno"> 1659</span>&#160; *   <span class="keywordtype">void</span> EulerOperator&lt;dim, degree, n_points_1d&gt;::perform_stage( </div><div class="line"><a name="l01660"></a><span class="lineno"> 1660</span>&#160; *     const Number                                      current_time, </div><div class="line"><a name="l01661"></a><span class="lineno"> 1661</span>&#160; *     const Number                                      factor_solution, </div><div class="line"><a name="l01662"></a><span class="lineno"> 1662</span>&#160; *     const Number                                      factor_ai, </div><div class="line"><a name="l01663"></a><span class="lineno"> 1663</span>&#160; *     const <a class="code" href="namespaceLinearAlgebra.html">LinearAlgebra</a>::distributed::<a class="code" href="classVector.html">Vector</a>&lt;Number&gt; &amp;current_ri, </div><div class="line"><a name="l01664"></a><span class="lineno"> 1664</span>&#160; *     <a class="code" href="namespaceLinearAlgebra.html">LinearAlgebra</a>::distributed::<a class="code" href="classVector.html">Vector</a>&lt;Number&gt; &amp;      vec_ki, </div><div class="line"><a name="l01665"></a><span class="lineno"> 1665</span>&#160; *     <a class="code" href="namespaceLinearAlgebra.html">LinearAlgebra</a>::distributed::<a class="code" href="classVector.html">Vector</a>&lt;Number&gt; &amp;      solution, </div><div class="line"><a name="l01666"></a><span class="lineno"> 1666</span>&#160; *     <a class="code" href="namespaceLinearAlgebra.html">LinearAlgebra</a>::distributed::<a class="code" href="classVector.html">Vector</a>&lt;Number&gt; &amp;      next_ri) const </div><div class="line"><a name="l01667"></a><span class="lineno"> 1667</span>&#160; *   { </div><div class="line"><a name="l01668"></a><span class="lineno"> 1668</span>&#160; *     { </div><div class="line"><a name="l01669"></a><span class="lineno"> 1669</span>&#160; *       <a class="code" href="classTimerOutput_1_1Scope.html">TimerOutput::Scope</a> t(timer, <span class="stringliteral">&quot;rk_stage - integrals L_h&quot;</span>); </div><div class="line"><a name="l01670"></a><span class="lineno"> 1670</span>&#160; * </div><div class="line"><a name="l01671"></a><span class="lineno"> 1671</span>&#160; *       <span class="keywordflow">for</span> (<span class="keyword">auto</span> &amp;i : inflow_boundaries) </div><div class="line"><a name="l01672"></a><span class="lineno"> 1672</span>&#160; *         i.second-&gt;set_time(current_time); </div><div class="line"><a name="l01673"></a><span class="lineno"> 1673</span>&#160; *       <span class="keywordflow">for</span> (<span class="keyword">auto</span> &amp;i : subsonic_outflow_boundaries) </div><div class="line"><a name="l01674"></a><span class="lineno"> 1674</span>&#160; *         i.second-&gt;set_time(current_time); </div><div class="line"><a name="l01675"></a><span class="lineno"> 1675</span>&#160; * </div><div class="line"><a name="l01676"></a><span class="lineno"> 1676</span>&#160; *       data.loop(&amp;EulerOperator::local_apply_cell, </div><div class="line"><a name="l01677"></a><span class="lineno"> 1677</span>&#160; *                 &amp;EulerOperator::local_apply_face, </div><div class="line"><a name="l01678"></a><span class="lineno"> 1678</span>&#160; *                 &amp;EulerOperator::local_apply_boundary_face, </div><div class="line"><a name="l01679"></a><span class="lineno"> 1679</span>&#160; *                 <span class="keyword">this</span>, </div><div class="line"><a name="l01680"></a><span class="lineno"> 1680</span>&#160; *                 vec_ki, </div><div class="line"><a name="l01681"></a><span class="lineno"> 1681</span>&#160; *                 current_ri, </div><div class="line"><a name="l01682"></a><span class="lineno"> 1682</span>&#160; *                 <span class="keyword">true</span>, </div><div class="line"><a name="l01683"></a><span class="lineno"> 1683</span>&#160; *                 <a class="code" href="classMatrixFree.html">MatrixFree&lt;dim, Number&gt;::DataAccessOnFaces::values</a>, </div><div class="line"><a name="l01684"></a><span class="lineno"> 1684</span>&#160; *                 <a class="code" href="classMatrixFree.html">MatrixFree&lt;dim, Number&gt;::DataAccessOnFaces::values</a>); </div><div class="line"><a name="l01685"></a><span class="lineno"> 1685</span>&#160; *     } </div><div class="line"><a name="l01686"></a><span class="lineno"> 1686</span>&#160; * </div><div class="line"><a name="l01687"></a><span class="lineno"> 1687</span>&#160; *     { </div><div class="line"><a name="l01688"></a><span class="lineno"> 1688</span>&#160; *       <a class="code" href="classTimerOutput_1_1Scope.html">TimerOutput::Scope</a> t(timer, <span class="stringliteral">&quot;rk_stage - inv mass + vec upd&quot;</span>); </div><div class="line"><a name="l01689"></a><span class="lineno"> 1689</span>&#160; *       data.cell_loop( </div><div class="line"><a name="l01690"></a><span class="lineno"> 1690</span>&#160; *         &amp;EulerOperator::local_apply_inverse_mass_matrix, </div><div class="line"><a name="l01691"></a><span class="lineno"> 1691</span>&#160; *         <span class="keyword">this</span>, </div><div class="line"><a name="l01692"></a><span class="lineno"> 1692</span>&#160; *         next_ri, </div><div class="line"><a name="l01693"></a><span class="lineno"> 1693</span>&#160; *         vec_ki, </div><div class="line"><a name="l01694"></a><span class="lineno"> 1694</span>&#160; *         std::function&lt;<span class="keywordtype">void</span>(<span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span>, <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span>)&gt;(), </div><div class="line"><a name="l01695"></a><span class="lineno"> 1695</span>&#160; *         [&amp;](<span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> start_range, <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> end_range) { </div><div class="line"><a name="l01696"></a><span class="lineno"> 1696</span>&#160; *           <span class="keyword">const</span> Number ai = factor_ai; </div><div class="line"><a name="l01697"></a><span class="lineno"> 1697</span>&#160; *           <span class="keyword">const</span> Number bi = factor_solution; </div><div class="line"><a name="l01698"></a><span class="lineno"> 1698</span>&#160; *           <span class="keywordflow">if</span> (ai == Number()) </div><div class="line"><a name="l01699"></a><span class="lineno"> 1699</span>&#160; *             { </div><div class="line"><a name="l01700"></a><span class="lineno"> 1700</span>&#160; * </div><div class="line"><a name="l01701"></a><span class="lineno"> 1701</span>&#160; *           <span class="comment">/* DEAL_II_OPENMP_SIMD_PRAGMA  */</span> </div><div class="line"><a name="l01702"></a><span class="lineno"> 1702</span>&#160; *               <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i = start_range; i &lt; end_range; ++i) </div><div class="line"><a name="l01703"></a><span class="lineno"> 1703</span>&#160; *                 { </div><div class="line"><a name="l01704"></a><span class="lineno"> 1704</span>&#160; *                   <span class="keyword">const</span> Number k_i          = next_ri.local_element(i); </div><div class="line"><a name="l01705"></a><span class="lineno"> 1705</span>&#160; *                   <span class="keyword">const</span> Number sol_i        = solution.local_element(i); </div><div class="line"><a name="l01706"></a><span class="lineno"> 1706</span>&#160; *                   solution.local_element(i) = sol_i + bi * k_i; </div><div class="line"><a name="l01707"></a><span class="lineno"> 1707</span>&#160; *                 } </div><div class="line"><a name="l01708"></a><span class="lineno"> 1708</span>&#160; *             } </div><div class="line"><a name="l01709"></a><span class="lineno"> 1709</span>&#160; *           <span class="keywordflow">else</span> </div><div class="line"><a name="l01710"></a><span class="lineno"> 1710</span>&#160; *             { </div><div class="line"><a name="l01711"></a><span class="lineno"> 1711</span>&#160; * </div><div class="line"><a name="l01712"></a><span class="lineno"> 1712</span>&#160; *               <span class="comment">/* DEAL_II_OPENMP_SIMD_PRAGMA  */</span> </div><div class="line"><a name="l01713"></a><span class="lineno"> 1713</span>&#160; *               <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i = start_range; i &lt; end_range; ++i) </div><div class="line"><a name="l01714"></a><span class="lineno"> 1714</span>&#160; *                 { </div><div class="line"><a name="l01715"></a><span class="lineno"> 1715</span>&#160; *                   <span class="keyword">const</span> Number k_i          = next_ri.local_element(i); </div><div class="line"><a name="l01716"></a><span class="lineno"> 1716</span>&#160; *                   <span class="keyword">const</span> Number sol_i        = solution.local_element(i); </div><div class="line"><a name="l01717"></a><span class="lineno"> 1717</span>&#160; *                   solution.local_element(i) = sol_i + bi * k_i; </div><div class="line"><a name="l01718"></a><span class="lineno"> 1718</span>&#160; *                   next_ri.local_element(i)  = sol_i + ai * k_i; </div><div class="line"><a name="l01719"></a><span class="lineno"> 1719</span>&#160; *                 } </div><div class="line"><a name="l01720"></a><span class="lineno"> 1720</span>&#160; *             } </div><div class="line"><a name="l01721"></a><span class="lineno"> 1721</span>&#160; *         }); </div><div class="line"><a name="l01722"></a><span class="lineno"> 1722</span>&#160; *     } </div><div class="line"><a name="l01723"></a><span class="lineno"> 1723</span>&#160; *   } </div><div class="line"><a name="l01724"></a><span class="lineno"> 1724</span>&#160; * </div><div class="line"><a name="l01725"></a><span class="lineno"> 1725</span>&#160; * <span class="keyword">@end</span>code</div><div class="line"><a name="l01726"></a><span class="lineno"> 1726</span>&#160; * </div><div class="line"><a name="l01727"></a><span class="lineno"> 1727</span>&#160; * 在讨论了将解提前一个时间步长的函数的实现后，现在让我们来看看实现其他辅助性操作的函数。具体来说，这些是计算投影、评估误差和计算单元上信息传输速度的函数。</div><div class="line"><a name="l01728"></a><span class="lineno"> 1728</span>&#160; * </div><div class="line"><a name="l01729"></a><span class="lineno"> 1729</span>&#160;</div><div class="line"><a name="l01730"></a><span class="lineno"> 1730</span>&#160; * </div><div class="line"><a name="l01731"></a><span class="lineno"> 1731</span>&#160; * 这些函数中的第一个基本上等同于 <a class="code" href="namespaceVectorTools.html#ac6b404bf03cb2a742b290421cc2789fe">VectorTools::project</a>(), ，只是速度快得多，因为它是专门针对DG元素的，不需要设置和解决线性系统，因为每个元素都有独立的基函数。我们在这里展示代码的原因，除了这个非关键操作的小幅提速之外，还因为它显示了 <a class="code" href="classMatrixFreeOperators_1_1CellwiseInverseMassMatrix.html">MatrixFreeOperators::CellwiseInverseMassMatrix</a>. 提供的额外功能。</div><div class="line"><a name="l01732"></a><span class="lineno"> 1732</span>&#160; * </div><div class="line"><a name="l01733"></a><span class="lineno"> 1733</span>&#160;</div><div class="line"><a name="l01734"></a><span class="lineno"> 1734</span>&#160; * </div><div class="line"><a name="l01735"></a><span class="lineno"> 1735</span>&#160; * 投影操作的工作原理如下。如果我们用 @f$S@f$ 表示在正交点评估的形状函数矩阵，那么在单元格 @f$K@f$ 上的投影是一个形式为 @f$\underbrace{S J^K S^\mathrm <a class="code" href="namespaceLAPACKSupport.html#a8cac1e477eff052db622c8a9a9426ea3">T</a>}_{\mathcal M^K} \mathbf{<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a6b25dd8f005063d8d2b0a4bdb0d277f3">w</a>}^K = S J^K \tilde{\mathbf{<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a6b25dd8f005063d8d2b0a4bdb0d277f3">w</a>}}(\mathbf{x}_q)_{q=1:n_q}@f$ 的操作，其中 @f$J^K@f$ 是包含雅各布系数乘以正交权重（JxW）的对角矩阵， @f$\mathcal M^K@f$ 是单元格的质量矩阵， @f$\tilde{\mathbf{<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a6b25dd8f005063d8d2b0a4bdb0d277f3">w</a>}}(\mathbf{x}_q)_{q=1:n_q}@f$ 是要投影到正交点的领域评估。实际上，矩阵 @f$S@f$ 通过张量积有额外的结构，如介绍中所解释的）。这个系统现在可以等效地写成 @f$\mathbf{<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a6b25dd8f005063d8d2b0a4bdb0d277f3">w</a>}^K = \left(S J^K S^\mathrm <a class="code" href="namespaceLAPACKSupport.html#a8cac1e477eff052db622c8a9a9426ea3">T</a>\right)^{-1} S J^K \tilde{\mathbf{<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a6b25dd8f005063d8d2b0a4bdb0d277f3">w</a>}}(\mathbf{x}_q)_{q=1:n_q} = S^{-\mathrm <a class="code" href="namespaceLAPACKSupport.html#a8cac1e477eff052db622c8a9a9426ea3">T</a>} \left(J^K\right)^{-1} S^{-1} S J^K \tilde{\mathbf{<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a6b25dd8f005063d8d2b0a4bdb0d277f3">w</a>}}(\mathbf{x}_q)_{q=1:n_q}@f$  。现在，项 @f$S^{-1} S@f$ 和 @f$\left(J^K\right)^{-1} J^K@f$ 相抵消，导致最后的表达式 @f$\mathbf{<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a6b25dd8f005063d8d2b0a4bdb0d277f3">w</a>}^K = S^{-\mathrm <a class="code" href="namespaceLAPACKSupport.html#a8cac1e477eff052db622c8a9a9426ea3">T</a>} \tilde{\mathbf{<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a6b25dd8f005063d8d2b0a4bdb0d277f3">w</a>}}(\mathbf{x}_q)_{q=1:n_q}@f$  。这个操作由 <a class="code" href="classMatrixFreeOperators_1_1CellwiseInverseMassMatrix.html#a5e95a87a9c63b321c77c72b8d762b760">MatrixFreeOperators::CellwiseInverseMassMatrix::transform_from_q_points_to_basis</a>(). 实现。这个名字来自于这个投影只是乘以 @f$S^{-\mathrm <a class="code" href="namespaceLAPACKSupport.html#a8cac1e477eff052db622c8a9a9426ea3">T</a>}@f$ ，一个从高斯正交点的节点基到给定的有限元基的基数变化。请注意，我们调用 <a class="code" href="classFEEvaluationBase.html#a459813036810fbdc3c5487309b118fd8">FEEvaluation::set_dof_values</a>() 将结果写入矢量，覆盖之前的内容，而不是像典型的积分任务那样累积结果--我们可以这样做，因为对于不连续的Galerkin离散，每个矢量条目都只有一个单元的贡献。</div><div class="line"><a name="l01736"></a><span class="lineno"> 1736</span>&#160; * </div><div class="line"><a name="l01737"></a><span class="lineno"> 1737</span>&#160;</div><div class="line"><a name="l01738"></a><span class="lineno"> 1738</span>&#160; * </div><div class="line"><a name="l01739"></a><span class="lineno"> 1739</span>&#160; * </div><div class="line"><a name="l01740"></a><span class="lineno"> 1740</span>&#160; * @code</div><div class="line"><a name="l01741"></a><span class="lineno"> 1741</span>&#160; *   template &lt;<span class="keywordtype">int</span> dim, <span class="keywordtype">int</span> degree, <span class="keywordtype">int</span> n_points_1d&gt; </div><div class="line"><a name="l01742"></a><span class="lineno"> 1742</span>&#160; *   <span class="keywordtype">void</span> EulerOperator&lt;dim, degree, n_points_1d&gt;::<a class="code" href="namespaceVectorTools.html#ac6b404bf03cb2a742b290421cc2789fe">project</a>( </div><div class="line"><a name="l01743"></a><span class="lineno"> 1743</span>&#160; *     const <a class="code" href="classFunction.html">Function</a>&lt;dim&gt; &amp;                       function, </div><div class="line"><a name="l01744"></a><span class="lineno"> 1744</span>&#160; *     <a class="code" href="namespaceLinearAlgebra.html">LinearAlgebra</a>::distributed::<a class="code" href="classVector.html">Vector</a>&lt;Number&gt; &amp;solution) const </div><div class="line"><a name="l01745"></a><span class="lineno"> 1745</span>&#160; *   { </div><div class="line"><a name="l01746"></a><span class="lineno"> 1746</span>&#160; *     <a class="code" href="classFEEvaluation.html">FEEvaluation&lt;dim, degree, degree + 1, dim + 2, Number&gt;</a> phi(data, 0, 1); </div><div class="line"><a name="l01747"></a><span class="lineno"> 1747</span>&#160; *     <a class="code" href="classMatrixFreeOperators_1_1CellwiseInverseMassMatrix.html">MatrixFreeOperators::CellwiseInverseMassMatrix&lt;dim, degree, dim + 2, Number&gt;</a> </div><div class="line"><a name="l01748"></a><span class="lineno"> 1748</span>&#160; *       inverse(phi); </div><div class="line"><a name="l01749"></a><span class="lineno"> 1749</span>&#160; *     solution.zero_out_ghost_values(); </div><div class="line"><a name="l01750"></a><span class="lineno"> 1750</span>&#160; *     <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> cell = 0; cell &lt; data.n_cell_batches(); ++cell) </div><div class="line"><a name="l01751"></a><span class="lineno"> 1751</span>&#160; *       { </div><div class="line"><a name="l01752"></a><span class="lineno"> 1752</span>&#160; *         phi.reinit(cell); </div><div class="line"><a name="l01753"></a><span class="lineno"> 1753</span>&#160; *         <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> q = 0; q &lt; phi.n_q_points; ++q) </div><div class="line"><a name="l01754"></a><span class="lineno"> 1754</span>&#160; *           phi.submit_dof_value(evaluate_function(<span class="keyword">function</span>, </div><div class="line"><a name="l01755"></a><span class="lineno"> 1755</span>&#160; *                                                  phi.quadrature_point(q)), </div><div class="line"><a name="l01756"></a><span class="lineno"> 1756</span>&#160; *                                q); </div><div class="line"><a name="l01757"></a><span class="lineno"> 1757</span>&#160; *         inverse.transform_from_q_points_to_basis(dim + 2, </div><div class="line"><a name="l01758"></a><span class="lineno"> 1758</span>&#160; *                                                  phi.begin_dof_values(), </div><div class="line"><a name="l01759"></a><span class="lineno"> 1759</span>&#160; *                                                  phi.begin_dof_values()); </div><div class="line"><a name="l01760"></a><span class="lineno"> 1760</span>&#160; *         phi.set_dof_values(solution); </div><div class="line"><a name="l01761"></a><span class="lineno"> 1761</span>&#160; *       } </div><div class="line"><a name="l01762"></a><span class="lineno"> 1762</span>&#160; *   } </div><div class="line"><a name="l01763"></a><span class="lineno"> 1763</span>&#160; * </div><div class="line"><a name="l01764"></a><span class="lineno"> 1764</span>&#160; * <span class="keyword">@end</span>code</div><div class="line"><a name="l01765"></a><span class="lineno"> 1765</span>&#160; * </div><div class="line"><a name="l01766"></a><span class="lineno"> 1766</span>&#160; * 下一个函数再次重复了同样由deal.II库提供的功能，即 <a class="code" href="namespaceVectorTools.html#a676190d2c897ac5da68a9c460fa95832">VectorTools::integrate_difference</a>(). 我们在这里展示了明确的代码，以强调跨几个单元的矢量化是如何工作的，以及如何通过该接口累积结果。回顾一下，每个&lt;i&gt;lane&lt;/i&gt;的矢量化数组持有来自不同单元的数据。通过对当前MPI进程所拥有的所有单元批的循环，我们就可以填充一个结果的VectorizedArray；为了得到一个全局的总和，我们需要进一步去对SIMD阵列中的条目进行求和。然而，这样的程序并不稳定，因为SIMD数组事实上可能并不持有其所有通道的有效数据。当本地拥有的单元的数量不是SIMD宽度的倍数时，就会发生这种情况。为了避免无效数据，我们必须在访问数据时明确地跳过那些无效的通道。虽然人们可以想象，我们可以通过简单地将空车道设置为零（从而不对总和做出贡献）来使其工作，但情况比这更复杂。如果我们要从动量中计算出一个速度呢？那么，我们就需要除以密度，而密度是零--结果就会是NaN，并污染结果。当我们在单元格批次中循环时，使用函数 <a class="code" href="classMatrixFree.html#a1d516071d20e633dc9efcadb7852ce15">MatrixFree::n_active_entries_per_cell_batch</a>() 给我们提供有效数据的通道数，累积有效SIMD范围内的结果，就可以避免这种陷阱。它在大多数单元上等于 <a class="code" href="classVectorizedArray.html">VectorizedArray</a>::size() ，但如果单元数与SIMD宽度相比有余数，则在最后一个单元批上可能会更少。</div><div class="line"><a name="l01767"></a><span class="lineno"> 1767</span>&#160; * </div><div class="line"><a name="l01768"></a><span class="lineno"> 1768</span>&#160;</div><div class="line"><a name="l01769"></a><span class="lineno"> 1769</span>&#160; * </div><div class="line"><a name="l01770"></a><span class="lineno"> 1770</span>&#160; * </div><div class="line"><a name="l01771"></a><span class="lineno"> 1771</span>&#160; * @code</div><div class="line"><a name="l01772"></a><span class="lineno"> 1772</span>&#160; *   template &lt;<span class="keywordtype">int</span> dim, <span class="keywordtype">int</span> degree, <span class="keywordtype">int</span> n_points_1d&gt; </div><div class="line"><a name="l01773"></a><span class="lineno"> 1773</span>&#160; *   <a class="code" href="namespacestd.html">std</a>::array&lt;<span class="keywordtype">double</span>, 3&gt; EulerOperator&lt;dim, degree, n_points_1d&gt;::compute_errors( </div><div class="line"><a name="l01774"></a><span class="lineno"> 1774</span>&#160; *     const <a class="code" href="classFunction.html">Function</a>&lt;dim&gt; &amp;                             function, </div><div class="line"><a name="l01775"></a><span class="lineno"> 1775</span>&#160; *     const <a class="code" href="namespaceLinearAlgebra.html">LinearAlgebra</a>::distributed::<a class="code" href="classVector.html">Vector</a>&lt;Number&gt; &amp;solution) const </div><div class="line"><a name="l01776"></a><span class="lineno"> 1776</span>&#160; *   { </div><div class="line"><a name="l01777"></a><span class="lineno"> 1777</span>&#160; *     <a class="code" href="classTimerOutput_1_1Scope.html">TimerOutput::Scope</a> t(timer, <span class="stringliteral">&quot;compute errors&quot;</span>); </div><div class="line"><a name="l01778"></a><span class="lineno"> 1778</span>&#160; *     <span class="keywordtype">double</span>             errors_squared[3] = {}; </div><div class="line"><a name="l01779"></a><span class="lineno"> 1779</span>&#160; *     <a class="code" href="classFEEvaluation.html">FEEvaluation&lt;dim, degree, n_points_1d, dim + 2, Number&gt;</a> phi(data, 0, 0); </div><div class="line"><a name="l01780"></a><span class="lineno"> 1780</span>&#160; * </div><div class="line"><a name="l01781"></a><span class="lineno"> 1781</span>&#160; *     <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> cell = 0; cell &lt; data.n_cell_batches(); ++cell) </div><div class="line"><a name="l01782"></a><span class="lineno"> 1782</span>&#160; *       { </div><div class="line"><a name="l01783"></a><span class="lineno"> 1783</span>&#160; *         phi.reinit(cell); </div><div class="line"><a name="l01784"></a><span class="lineno"> 1784</span>&#160; *         phi.gather_evaluate(solution, <a class="code" href="namespaceEvaluationFlags.html#a9b7c6d689cb76386839d0d13640f59aeaf9825c682f693a6a200094641a0d6a58">EvaluationFlags::values</a>); </div><div class="line"><a name="l01785"></a><span class="lineno"> 1785</span>&#160; *         <a class="code" href="classVectorizedArray.html">VectorizedArray&lt;Number&gt;</a> local_errors_squared[3] = {}; </div><div class="line"><a name="l01786"></a><span class="lineno"> 1786</span>&#160; *         <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> q = 0; q &lt; phi.n_q_points; ++q) </div><div class="line"><a name="l01787"></a><span class="lineno"> 1787</span>&#160; *           { </div><div class="line"><a name="l01788"></a><span class="lineno"> 1788</span>&#160; *             <span class="keyword">const</span> <span class="keyword">auto</span> error = </div><div class="line"><a name="l01789"></a><span class="lineno"> 1789</span>&#160; *               evaluate_function(<span class="keyword">function</span>, phi.quadrature_point(q)) - </div><div class="line"><a name="l01790"></a><span class="lineno"> 1790</span>&#160; *               phi.get_value(q); </div><div class="line"><a name="l01791"></a><span class="lineno"> 1791</span>&#160; *             <span class="keyword">const</span> <span class="keyword">auto</span> JxW = phi.JxW(q); </div><div class="line"><a name="l01792"></a><span class="lineno"> 1792</span>&#160; * </div><div class="line"><a name="l01793"></a><span class="lineno"> 1793</span>&#160; *             local_errors_squared[0] += error[0] * error[0] * JxW; </div><div class="line"><a name="l01794"></a><span class="lineno"> 1794</span>&#160; *             <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a15728437b942dab0b0042eb06a407d2c">d</a> = 0; <a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a15728437b942dab0b0042eb06a407d2c">d</a> &lt; dim; ++<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a15728437b942dab0b0042eb06a407d2c">d</a>) </div><div class="line"><a name="l01795"></a><span class="lineno"> 1795</span>&#160; *               local_errors_squared[1] += (error[<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a15728437b942dab0b0042eb06a407d2c">d</a> + 1] * error[<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a15728437b942dab0b0042eb06a407d2c">d</a> + 1]) * JxW; </div><div class="line"><a name="l01796"></a><span class="lineno"> 1796</span>&#160; *             local_errors_squared[2] += (error[dim + 1] * error[dim + 1]) * JxW; </div><div class="line"><a name="l01797"></a><span class="lineno"> 1797</span>&#160; *           } </div><div class="line"><a name="l01798"></a><span class="lineno"> 1798</span>&#160; *         <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> v = 0; v &lt; data.n_active_entries_per_cell_batch(cell); </div><div class="line"><a name="l01799"></a><span class="lineno"> 1799</span>&#160; *              ++v) </div><div class="line"><a name="l01800"></a><span class="lineno"> 1800</span>&#160; *           <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a15728437b942dab0b0042eb06a407d2c">d</a> = 0; <a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a15728437b942dab0b0042eb06a407d2c">d</a> &lt; 3; ++<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a15728437b942dab0b0042eb06a407d2c">d</a>) </div><div class="line"><a name="l01801"></a><span class="lineno"> 1801</span>&#160; *             errors_squared[<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a15728437b942dab0b0042eb06a407d2c">d</a>] += local_errors_squared[<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a15728437b942dab0b0042eb06a407d2c">d</a>][v]; </div><div class="line"><a name="l01802"></a><span class="lineno"> 1802</span>&#160; *       } </div><div class="line"><a name="l01803"></a><span class="lineno"> 1803</span>&#160; * </div><div class="line"><a name="l01804"></a><span class="lineno"> 1804</span>&#160; *     <a class="code" href="namespaceUtilities_1_1MPI.html#ab544a3bf3301a6dd3e705ee352c5551b">Utilities::MPI::sum</a>(errors_squared, MPI_COMM_WORLD, errors_squared); </div><div class="line"><a name="l01805"></a><span class="lineno"> 1805</span>&#160; * </div><div class="line"><a name="l01806"></a><span class="lineno"> 1806</span>&#160; *     std::array&lt;double, 3&gt; errors; </div><div class="line"><a name="l01807"></a><span class="lineno"> 1807</span>&#160; *     <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a15728437b942dab0b0042eb06a407d2c">d</a> = 0; <a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a15728437b942dab0b0042eb06a407d2c">d</a> &lt; 3; ++<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a15728437b942dab0b0042eb06a407d2c">d</a>) </div><div class="line"><a name="l01808"></a><span class="lineno"> 1808</span>&#160; *       errors[<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a15728437b942dab0b0042eb06a407d2c">d</a>] = std::sqrt(errors_squared[<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a15728437b942dab0b0042eb06a407d2c">d</a>]); </div><div class="line"><a name="l01809"></a><span class="lineno"> 1809</span>&#160; * </div><div class="line"><a name="l01810"></a><span class="lineno"> 1810</span>&#160; *     <span class="keywordflow">return</span> errors; </div><div class="line"><a name="l01811"></a><span class="lineno"> 1811</span>&#160; *   } </div><div class="line"><a name="l01812"></a><span class="lineno"> 1812</span>&#160; * </div><div class="line"><a name="l01813"></a><span class="lineno"> 1813</span>&#160; * <span class="keyword">@end</span>code</div><div class="line"><a name="l01814"></a><span class="lineno"> 1814</span>&#160; * </div><div class="line"><a name="l01815"></a><span class="lineno"> 1815</span>&#160; * EulerOperator类的最后一个函数是用来估计传输速度的，由网格大小缩放，这与设置显式时间积分器的时间步长有关。在欧拉方程中，有两种传输速度，即对流速度 @f$\mathbf{u}@f$ 和相对于以速度 @f$\mathbf u@f$ 运动的介质而言，声波的传播速度 @f$c = \sqrt{<a class="code" href="namespaceinternal_1_1QGaussLobatto.html#ac1aec52fdbb26c78e2d32fc0bed659c7">\gamma</a> p/\rho}@f$  。</div><div class="line"><a name="l01816"></a><span class="lineno"> 1816</span>&#160; * </div><div class="line"><a name="l01817"></a><span class="lineno"> 1817</span>&#160;</div><div class="line"><a name="l01818"></a><span class="lineno"> 1818</span>&#160; * </div><div class="line"><a name="l01819"></a><span class="lineno"> 1819</span>&#160; * 在时间步长的公式中，我们感兴趣的不是这些绝对速度，而是信息穿过一个单元所需的时间量。对于与介质一起传输的信息， @f$\mathbf u@f$ 是由网格大小缩放的，所以最大速度的估计可以通过计算 @f$\|J^{-\mathrm <a class="code" href="namespaceLAPACKSupport.html#a8cac1e477eff052db622c8a9a9426ea3">T</a>} \mathbf{u}\|_\infty@f$  得到，其中 @f$J@f$ 是实域到参考域的转换的雅各布。请注意， <a class="code" href="classFEEvaluationBaseData.html#adad456112f01b19291e7781fb5efee55">FEEvaluationBase::inverse_jacobian</a>() 返回的是反转和转置的雅各布，代表从实数到参考坐标的度量项，所以我们不需要再次转置。我们在下面的代码中把这个极限存储在变量`convective_limit`中。</div><div class="line"><a name="l01820"></a><span class="lineno"> 1820</span>&#160; * </div><div class="line"><a name="l01821"></a><span class="lineno"> 1821</span>&#160;</div><div class="line"><a name="l01822"></a><span class="lineno"> 1822</span>&#160; * </div><div class="line"><a name="l01823"></a><span class="lineno"> 1823</span>&#160; * 声音的传播是各向同性的，所以我们需要考虑到任何方向的网格尺寸。然后，适当的网格大小比例由 @f$J@f$ 的最小奇异值给出，或者，等同于 @f$J^{-1}@f$ 的最大奇异值。请注意，当忽略弯曲的单元时，可以用单元顶点之间的最小距离来近似这个量。为了得到Jacobian的最大奇异值，一般的策略是使用一些LAPACK函数。由于我们在这里需要的只是一个估计值，所以我们可以避免将一个向量数组的张量分解成几个矩阵的麻烦，并在没有向量的情况下进入一个（昂贵的）特征值函数，而是使用应用于 @f$J^{-1}J^{-\mathrm <a class="code" href="namespaceLAPACKSupport.html#a8cac1e477eff052db622c8a9a9426ea3">T</a>}@f$ 的幂方法进行几次迭代（在下面的代码中为五次）。这种方法的收敛速度取决于最大特征值与次大特征值的比率以及初始猜测，即所有1的矢量。这可能表明，我们在接近立方体形状的单元上得到缓慢的收敛，在这种情况下，所有的长度几乎都是一样的。然而，这种缓慢的收敛意味着结果将位于两个最大的奇异值之间，而这两个奇异值无论如何都是接近最大值的。在所有其他情况下，收敛将是快速的。因此，我们可以只在这里硬编码5次迭代，并确信结果是好的。</div><div class="line"><a name="l01824"></a><span class="lineno"> 1824</span>&#160; * </div><div class="line"><a name="l01825"></a><span class="lineno"> 1825</span>&#160;</div><div class="line"><a name="l01826"></a><span class="lineno"> 1826</span>&#160; * </div><div class="line"><a name="l01827"></a><span class="lineno"> 1827</span>&#160; * </div><div class="line"><a name="l01828"></a><span class="lineno"> 1828</span>&#160; * @code</div><div class="line"><a name="l01829"></a><span class="lineno"> 1829</span>&#160; *   <span class="keyword">template</span> &lt;<span class="keywordtype">int</span> dim, <span class="keywordtype">int</span> degree, <span class="keywordtype">int</span> n_po<span class="keywordtype">int</span>s_1d&gt; </div><div class="line"><a name="l01830"></a><span class="lineno"> 1830</span>&#160; *   <span class="keywordtype">double</span> EulerOperator&lt;dim, degree, n_points_1d&gt;::compute_cell_transport_speed( </div><div class="line"><a name="l01831"></a><span class="lineno"> 1831</span>&#160; *     <span class="keyword">const</span> <a class="code" href="classLinearAlgebra_1_1distributed_1_1Vector.html">LinearAlgebra::distributed::Vector&lt;Number&gt;</a> &amp;solution) <span class="keyword">const</span> </div><div class="line"><a name="l01832"></a><span class="lineno"> 1832</span>&#160; *   { </div><div class="line"><a name="l01833"></a><span class="lineno"> 1833</span>&#160; *     <a class="code" href="classTimerOutput_1_1Scope.html">TimerOutput::Scope</a> t(timer, <span class="stringliteral">&quot;compute transport speed&quot;</span>); </div><div class="line"><a name="l01834"></a><span class="lineno"> 1834</span>&#160; *     Number             max_transport = 0; </div><div class="line"><a name="l01835"></a><span class="lineno"> 1835</span>&#160; *     <a class="code" href="classFEEvaluation.html">FEEvaluation&lt;dim, degree, degree + 1, dim + 2, Number&gt;</a> phi(data, 0, 1); </div><div class="line"><a name="l01836"></a><span class="lineno"> 1836</span>&#160; * </div><div class="line"><a name="l01837"></a><span class="lineno"> 1837</span>&#160; *     <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> cell = 0; cell &lt; data.n_cell_batches(); ++cell) </div><div class="line"><a name="l01838"></a><span class="lineno"> 1838</span>&#160; *       { </div><div class="line"><a name="l01839"></a><span class="lineno"> 1839</span>&#160; *         phi.reinit(cell); </div><div class="line"><a name="l01840"></a><span class="lineno"> 1840</span>&#160; *         phi.gather_evaluate(solution, <a class="code" href="namespaceEvaluationFlags.html#a9b7c6d689cb76386839d0d13640f59aeaf9825c682f693a6a200094641a0d6a58">EvaluationFlags::values</a>); </div><div class="line"><a name="l01841"></a><span class="lineno"> 1841</span>&#160; *         <a class="code" href="classVectorizedArray.html">VectorizedArray&lt;Number&gt;</a> local_max = 0.; </div><div class="line"><a name="l01842"></a><span class="lineno"> 1842</span>&#160; *         <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> q = 0; q &lt; phi.n_q_points; ++q) </div><div class="line"><a name="l01843"></a><span class="lineno"> 1843</span>&#160; *           { </div><div class="line"><a name="l01844"></a><span class="lineno"> 1844</span>&#160; *             <span class="keyword">const</span> <span class="keyword">auto</span> solution = phi.get_value(q); </div><div class="line"><a name="l01845"></a><span class="lineno"> 1845</span>&#160; *             <span class="keyword">const</span> <span class="keyword">auto</span> velocity = euler_velocity&lt;dim&gt;(solution); </div><div class="line"><a name="l01846"></a><span class="lineno"> 1846</span>&#160; *             <span class="keyword">const</span> <span class="keyword">auto</span> pressure = euler_pressure&lt;dim&gt;(solution); </div><div class="line"><a name="l01847"></a><span class="lineno"> 1847</span>&#160; * </div><div class="line"><a name="l01848"></a><span class="lineno"> 1848</span>&#160; *             <span class="keyword">const</span> <span class="keyword">auto</span> inverse_jacobian = phi.inverse_jacobian(q); </div><div class="line"><a name="l01849"></a><span class="lineno"> 1849</span>&#160; *             <span class="keyword">const</span> <span class="keyword">auto</span> convective_speed = inverse_jacobian * velocity; </div><div class="line"><a name="l01850"></a><span class="lineno"> 1850</span>&#160; *             <a class="code" href="classVectorizedArray.html">VectorizedArray&lt;Number&gt;</a> convective_limit = 0.; </div><div class="line"><a name="l01851"></a><span class="lineno"> 1851</span>&#160; *             <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a15728437b942dab0b0042eb06a407d2c">d</a> = 0; <a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a15728437b942dab0b0042eb06a407d2c">d</a> &lt; dim; ++<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a15728437b942dab0b0042eb06a407d2c">d</a>) </div><div class="line"><a name="l01852"></a><span class="lineno"> 1852</span>&#160; *               convective_limit = </div><div class="line"><a name="l01853"></a><span class="lineno"> 1853</span>&#160; *                 <a class="code" href="namespaceVectorTools_1_1EvaluationFlags.html#ac6721740e24732d6afabcf28ddfc1ffda8e7f5b8545162dccd5ed717792bdf420">std::max</a>(convective_limit, std::abs(convective_speed[<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a15728437b942dab0b0042eb06a407d2c">d</a>])); </div><div class="line"><a name="l01854"></a><span class="lineno"> 1854</span>&#160; * </div><div class="line"><a name="l01855"></a><span class="lineno"> 1855</span>&#160; *             <span class="keyword">const</span> <span class="keyword">auto</span> speed_of_sound = </div><div class="line"><a name="l01856"></a><span class="lineno"> 1856</span>&#160; *               <a class="code" href="vectorization_8h.html#a303f564e3c189251976da401ee2e44fa">std::sqrt</a>(<a class="code" href="namespaceinternal_1_1QGaussLobatto.html#ac1aec52fdbb26c78e2d32fc0bed659c7">gamma</a> * pressure * (1. / solution[0])); </div><div class="line"><a name="l01857"></a><span class="lineno"> 1857</span>&#160; * </div><div class="line"><a name="l01858"></a><span class="lineno"> 1858</span>&#160; *             <a class="code" href="classTensor.html">Tensor&lt;1, dim, VectorizedArray&lt;Number&gt;</a>&gt; eigenvector; </div><div class="line"><a name="l01859"></a><span class="lineno"> 1859</span>&#160; *             <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> d = 0; d &lt; dim; ++<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a15728437b942dab0b0042eb06a407d2c">d</a>) </div><div class="line"><a name="l01860"></a><span class="lineno"> 1860</span>&#160; *               eigenvector[d] = 1.; </div><div class="line"><a name="l01861"></a><span class="lineno"> 1861</span>&#160; *             <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i = 0; i &lt; 5; ++i) </div><div class="line"><a name="l01862"></a><span class="lineno"> 1862</span>&#160; *               { </div><div class="line"><a name="l01863"></a><span class="lineno"> 1863</span>&#160; *                 eigenvector = <a class="code" href="derivative__form_8h.html#a3c201452e8dd28e4f5be4a316cb9305f">transpose</a>(inverse_jacobian) * </div><div class="line"><a name="l01864"></a><span class="lineno"> 1864</span>&#160; *                               (inverse_jacobian * eigenvector); </div><div class="line"><a name="l01865"></a><span class="lineno"> 1865</span>&#160; *                 <a class="code" href="classVectorizedArray.html">VectorizedArray&lt;Number&gt;</a> eigenvector_norm = 0.; </div><div class="line"><a name="l01866"></a><span class="lineno"> 1866</span>&#160; *                 <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> d = 0; d &lt; dim; ++<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a15728437b942dab0b0042eb06a407d2c">d</a>) </div><div class="line"><a name="l01867"></a><span class="lineno"> 1867</span>&#160; *                   eigenvector_norm = </div><div class="line"><a name="l01868"></a><span class="lineno"> 1868</span>&#160; *                     <a class="code" href="namespaceVectorTools_1_1EvaluationFlags.html#ac6721740e24732d6afabcf28ddfc1ffda8e7f5b8545162dccd5ed717792bdf420">std::max</a>(eigenvector_norm, std::abs(eigenvector[d])); </div><div class="line"><a name="l01869"></a><span class="lineno"> 1869</span>&#160; *                 eigenvector /= eigenvector_norm; </div><div class="line"><a name="l01870"></a><span class="lineno"> 1870</span>&#160; *               } </div><div class="line"><a name="l01871"></a><span class="lineno"> 1871</span>&#160; *             <span class="keyword">const</span> <span class="keyword">auto</span> jac_times_ev   = inverse_jacobian * eigenvector; </div><div class="line"><a name="l01872"></a><span class="lineno"> 1872</span>&#160; *             <span class="keyword">const</span> <span class="keyword">auto</span> max_eigenvalue = <a class="code" href="vectorization_8h.html#a303f564e3c189251976da401ee2e44fa">std::sqrt</a>( </div><div class="line"><a name="l01873"></a><span class="lineno"> 1873</span>&#160; *               (jac_times_ev * jac_times_ev) / (eigenvector * eigenvector)); </div><div class="line"><a name="l01874"></a><span class="lineno"> 1874</span>&#160; *             local_max = </div><div class="line"><a name="l01875"></a><span class="lineno"> 1875</span>&#160; *               <a class="code" href="namespaceVectorTools_1_1EvaluationFlags.html#ac6721740e24732d6afabcf28ddfc1ffda8e7f5b8545162dccd5ed717792bdf420">std::max</a>(local_max, </div><div class="line"><a name="l01876"></a><span class="lineno"> 1876</span>&#160; *                        max_eigenvalue * speed_of_sound + convective_limit); </div><div class="line"><a name="l01877"></a><span class="lineno"> 1877</span>&#160; *           } </div><div class="line"><a name="l01878"></a><span class="lineno"> 1878</span>&#160; * </div><div class="line"><a name="l01879"></a><span class="lineno"> 1879</span>&#160; * <span class="keyword">@end</span>code</div><div class="line"><a name="l01880"></a><span class="lineno"> 1880</span>&#160; * </div><div class="line"><a name="l01881"></a><span class="lineno"> 1881</span>&#160; * 与前面的函数类似，我们必须确保只在一个单元格批次的有效单元格上积累速度。</div><div class="line"><a name="l01882"></a><span class="lineno"> 1882</span>&#160; * </div><div class="line"><a name="l01883"></a><span class="lineno"> 1883</span>&#160;</div><div class="line"><a name="l01884"></a><span class="lineno"> 1884</span>&#160; * </div><div class="line"><a name="l01885"></a><span class="lineno"> 1885</span>&#160; * </div><div class="line"><a name="l01886"></a><span class="lineno"> 1886</span>&#160; * @code</div><div class="line"><a name="l01887"></a><span class="lineno"> 1887</span>&#160; *      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> v = 0; v &lt; data.n_active_entries_per_cell_batch(cell);</div><div class="line"><a name="l01888"></a><span class="lineno"> 1888</span>&#160; *              ++v) </div><div class="line"><a name="l01889"></a><span class="lineno"> 1889</span>&#160; *           <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> d = 0; d &lt; 3; ++<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a15728437b942dab0b0042eb06a407d2c">d</a>) </div><div class="line"><a name="l01890"></a><span class="lineno"> 1890</span>&#160; *             max_transport = <a class="code" href="namespaceVectorTools_1_1EvaluationFlags.html#ac6721740e24732d6afabcf28ddfc1ffda8e7f5b8545162dccd5ed717792bdf420">std::max</a>(max_transport, local_max[v]); </div><div class="line"><a name="l01891"></a><span class="lineno"> 1891</span>&#160; *       } </div><div class="line"><a name="l01892"></a><span class="lineno"> 1892</span>&#160; * </div><div class="line"><a name="l01893"></a><span class="lineno"> 1893</span>&#160; *     max_transport = <a class="code" href="namespaceUtilities_1_1MPI.html#ad2f716b789abe53715d6659f38aa7815">Utilities::MPI::max</a>(max_transport, MPI_COMM_WORLD); </div><div class="line"><a name="l01894"></a><span class="lineno"> 1894</span>&#160; * </div><div class="line"><a name="l01895"></a><span class="lineno"> 1895</span>&#160; *     <span class="keywordflow">return</span> max_transport; </div><div class="line"><a name="l01896"></a><span class="lineno"> 1896</span>&#160; *   } </div><div class="line"><a name="l01897"></a><span class="lineno"> 1897</span>&#160; * </div><div class="line"><a name="l01898"></a><span class="lineno"> 1898</span>&#160; * <span class="keyword">@end</span>code</div><div class="line"><a name="l01899"></a><span class="lineno"> 1899</span>&#160; * </div><div class="line"><a name="l01900"></a><span class="lineno"> 1900</span>&#160; * </div><div class="line"><a name="l01901"></a><span class="lineno"> 1901</span>&#160; * &lt;a name=<span class="stringliteral">&quot;TheEulerProblemclass&quot;</span>&gt;&lt;/a&gt; </div><div class="line"><a name="l01902"></a><span class="lineno"> 1902</span>&#160; * &lt;h3&gt;The EulerProblem <span class="keyword">class</span>&lt;/h3&gt;</div><div class="line"><a name="l01903"></a><span class="lineno"> 1903</span>&#160; * </div><div class="line"><a name="l01904"></a><span class="lineno"> 1904</span>&#160;</div><div class="line"><a name="l01905"></a><span class="lineno"> 1905</span>&#160; * </div><div class="line"><a name="l01906"></a><span class="lineno"> 1906</span>&#160; * 该类将EulerOperator类与时间积分器和通常的全局数据结构（如FiniteElement和DoFHandler）相结合，以实际运行Euler问题的模拟。</div><div class="line"><a name="l01907"></a><span class="lineno"> 1907</span>&#160; * </div><div class="line"><a name="l01908"></a><span class="lineno"> 1908</span>&#160;</div><div class="line"><a name="l01909"></a><span class="lineno"> 1909</span>&#160; * </div><div class="line"><a name="l01910"></a><span class="lineno"> 1910</span>&#160; * 成员变量是一个三角形、一个有限元、一个映射（用于创建高阶曲面，见 @ref step_10 <span class="stringliteral">&quot;step-10&quot;</span> ），以及一个描述自由度的DoFHandler。此外，我们还保留了上面描述的EulerOperator的实例，它将完成所有积分方面的繁重工作，以及一些时间积分的参数，如当前时间或时间步长。</div><div class="line"><a name="l01911"></a><span class="lineno"> 1911</span>&#160; * </div><div class="line"><a name="l01912"></a><span class="lineno"> 1912</span>&#160;</div><div class="line"><a name="l01913"></a><span class="lineno"> 1913</span>&#160; * </div><div class="line"><a name="l01914"></a><span class="lineno"> 1914</span>&#160; * 此外，我们使用一个PostProcessor实例来向输出文件写入一些额外的信息，这与  @ref step_33 <span class="stringliteral">&quot;step-33&quot;</span>  中的做法类似。DataPostprocessor类的接口很直观，要求我们提供关于需要评估的信息（通常只有解决方案的值，除了Schlieren图，我们只在二维中启用它是有意义的），以及被评估的东西的名称。请注意，也可以通过可视化程序（如ParaView）中的计算器工具来提取大部分信息，但在写输出时就已经做了，这要方便得多。</div><div class="line"><a name="l01915"></a><span class="lineno"> 1915</span>&#160; * </div><div class="line"><a name="l01916"></a><span class="lineno"> 1916</span>&#160;</div><div class="line"><a name="l01917"></a><span class="lineno"> 1917</span>&#160; * </div><div class="line"><a name="l01918"></a><span class="lineno"> 1918</span>&#160; * </div><div class="line"><a name="l01919"></a><span class="lineno"> 1919</span>&#160; * @code</div><div class="line"><a name="l01920"></a><span class="lineno"> 1920</span>&#160; *   <span class="keyword">template</span> &lt;<span class="keywordtype">int</span> dim&gt; </div><div class="line"><a name="l01921"></a><span class="lineno"> 1921</span>&#160; *   <span class="keyword">class </span>EulerProblem </div><div class="line"><a name="l01922"></a><span class="lineno"> 1922</span>&#160; *   { </div><div class="line"><a name="l01923"></a><span class="lineno"> 1923</span>&#160; *   <span class="keyword">public</span>: </div><div class="line"><a name="l01924"></a><span class="lineno"> 1924</span>&#160; *     EulerProblem(); </div><div class="line"><a name="l01925"></a><span class="lineno"> 1925</span>&#160; * </div><div class="line"><a name="l01926"></a><span class="lineno"> 1926</span>&#160; *     <span class="keywordtype">void</span> <a class="code" href="namespaceWorkStream_1_1internal_1_1tbb__no__coloring.html#a8673698a405bf47aa24002aeb6d76d70">run</a>(); </div><div class="line"><a name="l01927"></a><span class="lineno"> 1927</span>&#160; * </div><div class="line"><a name="l01928"></a><span class="lineno"> 1928</span>&#160; *   <span class="keyword">private</span>: </div><div class="line"><a name="l01929"></a><span class="lineno"> 1929</span>&#160; *     <span class="keywordtype">void</span> make_grid_and_dofs(); </div><div class="line"><a name="l01930"></a><span class="lineno"> 1930</span>&#160; * </div><div class="line"><a name="l01931"></a><span class="lineno"> 1931</span>&#160; *     <span class="keywordtype">void</span> output_results(<span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> result_number); </div><div class="line"><a name="l01932"></a><span class="lineno"> 1932</span>&#160; * </div><div class="line"><a name="l01933"></a><span class="lineno"> 1933</span>&#160; *     <a class="code" href="classLinearAlgebra_1_1distributed_1_1Vector.html">LinearAlgebra::distributed::Vector&lt;Number&gt;</a> solution; </div><div class="line"><a name="l01934"></a><span class="lineno"> 1934</span>&#160; * </div><div class="line"><a name="l01935"></a><span class="lineno"> 1935</span>&#160; *     <a class="code" href="classConditionalOStream.html">ConditionalOStream</a> pcout; </div><div class="line"><a name="l01936"></a><span class="lineno"> 1936</span>&#160; * </div><div class="line"><a name="l01937"></a><span class="lineno"> 1937</span>&#160; * #ifdef DEAL_II_WITH_P4EST </div><div class="line"><a name="l01938"></a><span class="lineno"> 1938</span>&#160; *     <a class="code" href="classparallel_1_1distributed_1_1Triangulation.html">parallel::distributed::Triangulation&lt;dim&gt;</a> <a class="code" href="p4est__wrappers_8cc.html#ace00f2f80d9780ef9aa1007e1c22c6a4">triangulation</a>; </div><div class="line"><a name="l01939"></a><span class="lineno"> 1939</span>&#160; * #<span class="keywordflow">else</span> </div><div class="line"><a name="l01940"></a><span class="lineno"> 1940</span>&#160; *     <a class="code" href="classTriangulation.html">Triangulation&lt;dim&gt;</a> <a class="code" href="p4est__wrappers_8cc.html#ace00f2f80d9780ef9aa1007e1c22c6a4">triangulation</a>; </div><div class="line"><a name="l01941"></a><span class="lineno"> 1941</span>&#160; * #endif </div><div class="line"><a name="l01942"></a><span class="lineno"> 1942</span>&#160; * </div><div class="line"><a name="l01943"></a><span class="lineno"> 1943</span>&#160; *     <a class="code" href="classFESystem.html">FESystem&lt;dim&gt;</a>        fe; </div><div class="line"><a name="l01944"></a><span class="lineno"> 1944</span>&#160; *     <a class="code" href="classMappingQGeneric.html">MappingQGeneric&lt;dim&gt;</a> mapping; </div><div class="line"><a name="l01945"></a><span class="lineno"> 1945</span>&#160; *     <a class="code" href="classDoFHandler.html">DoFHandler&lt;dim&gt;</a>      dof_handler; </div><div class="line"><a name="l01946"></a><span class="lineno"> 1946</span>&#160; * </div><div class="line"><a name="l01947"></a><span class="lineno"> 1947</span>&#160; *     <a class="code" href="classTimerOutput.html">TimerOutput</a> timer; </div><div class="line"><a name="l01948"></a><span class="lineno"> 1948</span>&#160; * </div><div class="line"><a name="l01949"></a><span class="lineno"> 1949</span>&#160; *     EulerOperator&lt;dim, fe_degree, n_q_points_1d&gt; euler_operator; </div><div class="line"><a name="l01950"></a><span class="lineno"> 1950</span>&#160; * </div><div class="line"><a name="l01951"></a><span class="lineno"> 1951</span>&#160; *     <span class="keywordtype">double</span> <a class="code" href="classFunctionTime.html#a8932e3ec9ed7b6f6d6a91c23f82e36d8">time</a>, time_step; </div><div class="line"><a name="l01952"></a><span class="lineno"> 1952</span>&#160; * </div><div class="line"><a name="l01953"></a><span class="lineno"> 1953</span>&#160; *     <span class="keyword">class </span>Postprocessor : <span class="keyword">public</span> <a class="code" href="classDataPostprocessor.html">DataPostprocessor</a>&lt;dim&gt; </div><div class="line"><a name="l01954"></a><span class="lineno"> 1954</span>&#160; *     { </div><div class="line"><a name="l01955"></a><span class="lineno"> 1955</span>&#160; *     <span class="keyword">public</span>: </div><div class="line"><a name="l01956"></a><span class="lineno"> 1956</span>&#160; *       Postprocessor(); </div><div class="line"><a name="l01957"></a><span class="lineno"> 1957</span>&#160; * </div><div class="line"><a name="l01958"></a><span class="lineno"> 1958</span>&#160; *       <span class="keyword">virtual</span> <span class="keywordtype">void</span> evaluate_vector_field( </div><div class="line"><a name="l01959"></a><span class="lineno"> 1959</span>&#160; *         <span class="keyword">const</span> <a class="code" href="structDataPostprocessorInputs_1_1Vector.html">DataPostprocessorInputs::Vector&lt;dim&gt;</a> &amp;inputs, </div><div class="line"><a name="l01960"></a><span class="lineno"> 1960</span>&#160; *         std::vector&lt;<a class="code" href="classVector.html">Vector&lt;double&gt;</a>&gt; &amp;computed_quantities) <span class="keyword">const override</span>; </div><div class="line"><a name="l01961"></a><span class="lineno"> 1961</span>&#160; * </div><div class="line"><a name="l01962"></a><span class="lineno"> 1962</span>&#160; *       <span class="keyword">virtual</span> std::vector&lt;std::string&gt; get_names() <span class="keyword">const override</span>; </div><div class="line"><a name="l01963"></a><span class="lineno"> 1963</span>&#160; * </div><div class="line"><a name="l01964"></a><span class="lineno"> 1964</span>&#160; *       <span class="keyword">virtual</span> std::vector&lt; </div><div class="line"><a name="l01965"></a><span class="lineno"> 1965</span>&#160; *         <a class="code" href="namespaceDataComponentInterpretation.html#a0cd2da3afe902f9004c23a73dbcc8ab0">DataComponentInterpretation::DataComponentInterpretation</a>&gt; </div><div class="line"><a name="l01966"></a><span class="lineno"> 1966</span>&#160; *       get_data_component_interpretation() <span class="keyword">const override</span>; </div><div class="line"><a name="l01967"></a><span class="lineno"> 1967</span>&#160; * </div><div class="line"><a name="l01968"></a><span class="lineno"> 1968</span>&#160; *       <span class="keyword">virtual</span> <a class="code" href="group__feaccess.html#gaa94b67d2fdcc390690c523f28019e52f">UpdateFlags</a> get_needed_update_flags() <span class="keyword">const override</span>; </div><div class="line"><a name="l01969"></a><span class="lineno"> 1969</span>&#160; * </div><div class="line"><a name="l01970"></a><span class="lineno"> 1970</span>&#160; *     <span class="keyword">private</span>: </div><div class="line"><a name="l01971"></a><span class="lineno"> 1971</span>&#160; *       <span class="keyword">const</span> <span class="keywordtype">bool</span> do_schlieren_plot; </div><div class="line"><a name="l01972"></a><span class="lineno"> 1972</span>&#160; *     }; </div><div class="line"><a name="l01973"></a><span class="lineno"> 1973</span>&#160; *   }; </div><div class="line"><a name="l01974"></a><span class="lineno"> 1974</span>&#160; * </div><div class="line"><a name="l01975"></a><span class="lineno"> 1975</span>&#160; *   <span class="keyword">template</span> &lt;<span class="keywordtype">int</span> dim&gt; </div><div class="line"><a name="l01976"></a><span class="lineno"> 1976</span>&#160; *   EulerProblem&lt;dim&gt;::Postprocessor::Postprocessor() </div><div class="line"><a name="l01977"></a><span class="lineno"> 1977</span>&#160; *     : do_schlieren_plot(dim == 2) </div><div class="line"><a name="l01978"></a><span class="lineno"> 1978</span>&#160; *   {} </div><div class="line"><a name="l01979"></a><span class="lineno"> 1979</span>&#160; * </div><div class="line"><a name="l01980"></a><span class="lineno"> 1980</span>&#160; * <span class="keyword">@end</span>code</div><div class="line"><a name="l01981"></a><span class="lineno"> 1981</span>&#160; * </div><div class="line"><a name="l01982"></a><span class="lineno"> 1982</span>&#160; * 对于字段变量的主要评估，我们首先检查数组的长度是否等于预期值（长度`2*dim+4`或`2*dim+5`来自我们在下面get_names()函数中指定的名字的大小）。然后我们在所有的评估点上循环，填充相应的信息。首先，我们填写密度 @f$\rho@f$ 、动量 @f$\rho \mathbf{u}@f$ 和能量 @f$E@f$ 的原始解变量，然后我们计算得出速度 @f$\mathbf u@f$ 、压力 @f$p@f$ 、声速 @f$c=\sqrt{<a class="code" href="namespaceinternal_1_1QGaussLobatto.html#ac1aec52fdbb26c78e2d32fc0bed659c7">\gamma</a> p / \rho}@f$ ，以及显示 @f$s = |\nabla \rho|^2@f$ 的Schlieren图，如果它被启用。参见 @ref step_69 <span class="stringliteral">&quot;step-69&quot;</span> 中另一个创建Schlieren图的例子）。</div><div class="line"><a name="l01983"></a><span class="lineno"> 1983</span>&#160; * </div><div class="line"><a name="l01984"></a><span class="lineno"> 1984</span>&#160;</div><div class="line"><a name="l01985"></a><span class="lineno"> 1985</span>&#160; * </div><div class="line"><a name="l01986"></a><span class="lineno"> 1986</span>&#160; * </div><div class="line"><a name="l01987"></a><span class="lineno"> 1987</span>&#160; * @code</div><div class="line"><a name="l01988"></a><span class="lineno"> 1988</span>&#160; *   <span class="keyword">template</span> &lt;<span class="keywordtype">int</span> dim&gt; </div><div class="line"><a name="l01989"></a><span class="lineno"> 1989</span>&#160; *   <span class="keywordtype">void</span> EulerProblem&lt;dim&gt;::Postprocessor::evaluate_vector_field( </div><div class="line"><a name="l01990"></a><span class="lineno"> 1990</span>&#160; *     <span class="keyword">const</span> <a class="code" href="structDataPostprocessorInputs_1_1Vector.html">DataPostprocessorInputs::Vector&lt;dim&gt;</a> &amp;inputs, </div><div class="line"><a name="l01991"></a><span class="lineno"> 1991</span>&#160; *     std::vector&lt;<a class="code" href="classVector.html">Vector&lt;double&gt;</a>&gt; &amp;               computed_quantities) <span class="keyword">const</span> </div><div class="line"><a name="l01992"></a><span class="lineno"> 1992</span>&#160; *   { </div><div class="line"><a name="l01993"></a><span class="lineno"> 1993</span>&#160; *     <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> n_evaluation_points = inputs.solution_values.size(); </div><div class="line"><a name="l01994"></a><span class="lineno"> 1994</span>&#160; * </div><div class="line"><a name="l01995"></a><span class="lineno"> 1995</span>&#160; *     <span class="keywordflow">if</span> (do_schlieren_plot == <span class="keyword">true</span>) </div><div class="line"><a name="l01996"></a><span class="lineno"> 1996</span>&#160; *       <a class="code" href="group__Exceptions.html#ga70a0bb353656e704acf927945277bbc6">Assert</a>(inputs.solution_gradients.size() == n_evaluation_points, </div><div class="line"><a name="l01997"></a><span class="lineno"> 1997</span>&#160; *              <a class="code" href="group__Exceptions.html#ga31978c026b8b6b5116df30b8e748f6b7">ExcInternalError</a>()); </div><div class="line"><a name="l01998"></a><span class="lineno"> 1998</span>&#160; * </div><div class="line"><a name="l01999"></a><span class="lineno"> 1999</span>&#160; *     <a class="code" href="group__Exceptions.html#ga70a0bb353656e704acf927945277bbc6">Assert</a>(computed_quantities.size() == n_evaluation_points, </div><div class="line"><a name="l02000"></a><span class="lineno"> 2000</span>&#160; *            <a class="code" href="group__Exceptions.html#ga31978c026b8b6b5116df30b8e748f6b7">ExcInternalError</a>()); </div><div class="line"><a name="l02001"></a><span class="lineno"> 2001</span>&#160; *     <a class="code" href="group__Exceptions.html#ga70a0bb353656e704acf927945277bbc6">Assert</a>(inputs.solution_values[0].size() == dim + 2, <a class="code" href="group__Exceptions.html#ga31978c026b8b6b5116df30b8e748f6b7">ExcInternalError</a>()); </div><div class="line"><a name="l02002"></a><span class="lineno"> 2002</span>&#160; *     <a class="code" href="group__Exceptions.html#ga70a0bb353656e704acf927945277bbc6">Assert</a>(computed_quantities[0].size() == </div><div class="line"><a name="l02003"></a><span class="lineno"> 2003</span>&#160; *              dim + 2 + (do_schlieren_plot == <span class="keyword">true</span> ? 1 : 0), </div><div class="line"><a name="l02004"></a><span class="lineno"> 2004</span>&#160; *            <a class="code" href="group__Exceptions.html#ga31978c026b8b6b5116df30b8e748f6b7">ExcInternalError</a>()); </div><div class="line"><a name="l02005"></a><span class="lineno"> 2005</span>&#160; * </div><div class="line"><a name="l02006"></a><span class="lineno"> 2006</span>&#160; *     <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> q = 0; q &lt; n_evaluation_points; ++q) </div><div class="line"><a name="l02007"></a><span class="lineno"> 2007</span>&#160; *       { </div><div class="line"><a name="l02008"></a><span class="lineno"> 2008</span>&#160; *         <a class="code" href="classTensor.html">Tensor&lt;1, dim + 2&gt;</a> solution; </div><div class="line"><a name="l02009"></a><span class="lineno"> 2009</span>&#160; *         <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> d = 0; d &lt; dim + 2; ++<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a15728437b942dab0b0042eb06a407d2c">d</a>) </div><div class="line"><a name="l02010"></a><span class="lineno"> 2010</span>&#160; *           solution[d] = inputs.solution_values[q](d); </div><div class="line"><a name="l02011"></a><span class="lineno"> 2011</span>&#160; * </div><div class="line"><a name="l02012"></a><span class="lineno"> 2012</span>&#160; *         <span class="keyword">const</span> <span class="keywordtype">double</span>         density  = solution[0]; </div><div class="line"><a name="l02013"></a><span class="lineno"> 2013</span>&#160; *         <span class="keyword">const</span> <a class="code" href="classTensor.html">Tensor&lt;1, dim&gt;</a> velocity = euler_velocity&lt;dim&gt;(solution); </div><div class="line"><a name="l02014"></a><span class="lineno"> 2014</span>&#160; *         <span class="keyword">const</span> <span class="keywordtype">double</span>         pressure = euler_pressure&lt;dim&gt;(solution); </div><div class="line"><a name="l02015"></a><span class="lineno"> 2015</span>&#160; * </div><div class="line"><a name="l02016"></a><span class="lineno"> 2016</span>&#160; *         <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> d = 0; d &lt; dim; ++<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a15728437b942dab0b0042eb06a407d2c">d</a>) </div><div class="line"><a name="l02017"></a><span class="lineno"> 2017</span>&#160; *           computed_quantities[q](d) = velocity[<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a15728437b942dab0b0042eb06a407d2c">d</a>]; </div><div class="line"><a name="l02018"></a><span class="lineno"> 2018</span>&#160; *         computed_quantities[q](dim)     = pressure; </div><div class="line"><a name="l02019"></a><span class="lineno"> 2019</span>&#160; *         computed_quantities[q](dim + 1) = std::sqrt(<a class="code" href="namespaceinternal_1_1QGaussLobatto.html#ac1aec52fdbb26c78e2d32fc0bed659c7">gamma</a> * pressure / density); </div><div class="line"><a name="l02020"></a><span class="lineno"> 2020</span>&#160; * </div><div class="line"><a name="l02021"></a><span class="lineno"> 2021</span>&#160; *         <span class="keywordflow">if</span> (do_schlieren_plot == <span class="keyword">true</span>) </div><div class="line"><a name="l02022"></a><span class="lineno"> 2022</span>&#160; *           computed_quantities[q](dim + 2) = </div><div class="line"><a name="l02023"></a><span class="lineno"> 2023</span>&#160; *             inputs.solution_gradients[q][0] * inputs.solution_gradients[q][0]; </div><div class="line"><a name="l02024"></a><span class="lineno"> 2024</span>&#160; *       } </div><div class="line"><a name="l02025"></a><span class="lineno"> 2025</span>&#160; *   } </div><div class="line"><a name="l02026"></a><span class="lineno"> 2026</span>&#160; * </div><div class="line"><a name="l02027"></a><span class="lineno"> 2027</span>&#160; *   <span class="keyword">template</span> &lt;<span class="keywordtype">int</span> dim&gt; </div><div class="line"><a name="l02028"></a><span class="lineno"> 2028</span>&#160; *   std::vector&lt;std::string&gt; EulerProblem&lt;dim&gt;::Postprocessor::get_names() const </div><div class="line"><a name="l02029"></a><span class="lineno"> 2029</span>&#160; *   { </div><div class="line"><a name="l02030"></a><span class="lineno"> 2030</span>&#160; *     std::vector&lt;std::string&gt; names; </div><div class="line"><a name="l02031"></a><span class="lineno"> 2031</span>&#160; *     <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> d = 0; d &lt; dim; ++<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a15728437b942dab0b0042eb06a407d2c">d</a>) </div><div class="line"><a name="l02032"></a><span class="lineno"> 2032</span>&#160; *       names.emplace_back(<span class="stringliteral">&quot;velocity&quot;</span>); </div><div class="line"><a name="l02033"></a><span class="lineno"> 2033</span>&#160; *     names.emplace_back(<span class="stringliteral">&quot;pressure&quot;</span>); </div><div class="line"><a name="l02034"></a><span class="lineno"> 2034</span>&#160; *     names.emplace_back(<span class="stringliteral">&quot;speed_of_sound&quot;</span>); </div><div class="line"><a name="l02035"></a><span class="lineno"> 2035</span>&#160; * </div><div class="line"><a name="l02036"></a><span class="lineno"> 2036</span>&#160; *     <span class="keywordflow">if</span> (do_schlieren_plot == <span class="keyword">true</span>) </div><div class="line"><a name="l02037"></a><span class="lineno"> 2037</span>&#160; *       names.emplace_back(<span class="stringliteral">&quot;schlieren_plot&quot;</span>); </div><div class="line"><a name="l02038"></a><span class="lineno"> 2038</span>&#160; * </div><div class="line"><a name="l02039"></a><span class="lineno"> 2039</span>&#160; *     <span class="keywordflow">return</span> names; </div><div class="line"><a name="l02040"></a><span class="lineno"> 2040</span>&#160; *   } </div><div class="line"><a name="l02041"></a><span class="lineno"> 2041</span>&#160; * </div><div class="line"><a name="l02042"></a><span class="lineno"> 2042</span>&#160; * <span class="keyword">@end</span>code</div><div class="line"><a name="l02043"></a><span class="lineno"> 2043</span>&#160; * </div><div class="line"><a name="l02044"></a><span class="lineno"> 2044</span>&#160; * 对于量的解释，我们有标量密度、能量、压力、声速和Schlieren图，以及动量和速度的向量。</div><div class="line"><a name="l02045"></a><span class="lineno"> 2045</span>&#160; * </div><div class="line"><a name="l02046"></a><span class="lineno"> 2046</span>&#160;</div><div class="line"><a name="l02047"></a><span class="lineno"> 2047</span>&#160; * </div><div class="line"><a name="l02048"></a><span class="lineno"> 2048</span>&#160; * </div><div class="line"><a name="l02049"></a><span class="lineno"> 2049</span>&#160; * @code</div><div class="line"><a name="l02050"></a><span class="lineno"> 2050</span>&#160; *   <span class="keyword">template</span> &lt;<span class="keywordtype">int</span> dim&gt; </div><div class="line"><a name="l02051"></a><span class="lineno"> 2051</span>&#160; *   std::vector&lt;DataComponentInterpretation::DataComponentInterpretation&gt; </div><div class="line"><a name="l02052"></a><span class="lineno"> 2052</span>&#160; *   EulerProblem&lt;dim&gt;::Postprocessor::get_data_component_interpretation() const </div><div class="line"><a name="l02053"></a><span class="lineno"> 2053</span>&#160; *   { </div><div class="line"><a name="l02054"></a><span class="lineno"> 2054</span>&#160; *     std::vector&lt;DataComponentInterpretation::DataComponentInterpretation&gt; </div><div class="line"><a name="l02055"></a><span class="lineno"> 2055</span>&#160; *       interpretation; </div><div class="line"><a name="l02056"></a><span class="lineno"> 2056</span>&#160; *     <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> d = 0; d &lt; dim; ++<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a15728437b942dab0b0042eb06a407d2c">d</a>) </div><div class="line"><a name="l02057"></a><span class="lineno"> 2057</span>&#160; *       interpretation.push_back( </div><div class="line"><a name="l02058"></a><span class="lineno"> 2058</span>&#160; *         <a class="code" href="namespaceDataComponentInterpretation.html#a0cd2da3afe902f9004c23a73dbcc8ab0aa783915dbc182d5a49e111815fd23fe0">DataComponentInterpretation::component_is_part_of_vector</a>); </div><div class="line"><a name="l02059"></a><span class="lineno"> 2059</span>&#160; *     interpretation.push_back(<a class="code" href="namespaceDataComponentInterpretation.html#a0cd2da3afe902f9004c23a73dbcc8ab0a1f3cd50135818a6458f1d3ff7ea4bb51">DataComponentInterpretation::component_is_scalar</a>); </div><div class="line"><a name="l02060"></a><span class="lineno"> 2060</span>&#160; *     interpretation.push_back(<a class="code" href="namespaceDataComponentInterpretation.html#a0cd2da3afe902f9004c23a73dbcc8ab0a1f3cd50135818a6458f1d3ff7ea4bb51">DataComponentInterpretation::component_is_scalar</a>); </div><div class="line"><a name="l02061"></a><span class="lineno"> 2061</span>&#160; * </div><div class="line"><a name="l02062"></a><span class="lineno"> 2062</span>&#160; *     <span class="keywordflow">if</span> (do_schlieren_plot == <span class="keyword">true</span>) </div><div class="line"><a name="l02063"></a><span class="lineno"> 2063</span>&#160; *       interpretation.push_back( </div><div class="line"><a name="l02064"></a><span class="lineno"> 2064</span>&#160; *         <a class="code" href="namespaceDataComponentInterpretation.html#a0cd2da3afe902f9004c23a73dbcc8ab0a1f3cd50135818a6458f1d3ff7ea4bb51">DataComponentInterpretation::component_is_scalar</a>); </div><div class="line"><a name="l02065"></a><span class="lineno"> 2065</span>&#160; * </div><div class="line"><a name="l02066"></a><span class="lineno"> 2066</span>&#160; *     <span class="keywordflow">return</span> interpretation; </div><div class="line"><a name="l02067"></a><span class="lineno"> 2067</span>&#160; *   } </div><div class="line"><a name="l02068"></a><span class="lineno"> 2068</span>&#160; * </div><div class="line"><a name="l02069"></a><span class="lineno"> 2069</span>&#160; * <span class="keyword">@end</span>code</div><div class="line"><a name="l02070"></a><span class="lineno"> 2070</span>&#160; * </div><div class="line"><a name="l02071"></a><span class="lineno"> 2071</span>&#160; * 关于必要的更新标志，我们只需要所有数量的值，但Schlieren图除外，它是基于密度梯度的。</div><div class="line"><a name="l02072"></a><span class="lineno"> 2072</span>&#160; * </div><div class="line"><a name="l02073"></a><span class="lineno"> 2073</span>&#160;</div><div class="line"><a name="l02074"></a><span class="lineno"> 2074</span>&#160; * </div><div class="line"><a name="l02075"></a><span class="lineno"> 2075</span>&#160; * </div><div class="line"><a name="l02076"></a><span class="lineno"> 2076</span>&#160; * @code</div><div class="line"><a name="l02077"></a><span class="lineno"> 2077</span>&#160; *   <span class="keyword">template</span> &lt;<span class="keywordtype">int</span> dim&gt; </div><div class="line"><a name="l02078"></a><span class="lineno"> 2078</span>&#160; *   <a class="code" href="group__feaccess.html#gaa94b67d2fdcc390690c523f28019e52f">UpdateFlags</a> EulerProblem&lt;dim&gt;::Postprocessor::get_needed_update_flags() const </div><div class="line"><a name="l02079"></a><span class="lineno"> 2079</span>&#160; *   { </div><div class="line"><a name="l02080"></a><span class="lineno"> 2080</span>&#160; *     <span class="keywordflow">if</span> (do_schlieren_plot == <span class="keyword">true</span>) </div><div class="line"><a name="l02081"></a><span class="lineno"> 2081</span>&#160; *       <span class="keywordflow">return</span> <a class="code" href="group__feaccess.html#ggaa94b67d2fdcc390690c523f28019e52fa4057ca2f127aa619c65886a9d3ad4aea">update_values</a> | <a class="code" href="group__feaccess.html#ggaa94b67d2fdcc390690c523f28019e52facbcc430975fa6af05f75ca786dc6fe20">update_gradients</a>; </div><div class="line"><a name="l02082"></a><span class="lineno"> 2082</span>&#160; *     <span class="keywordflow">else</span> </div><div class="line"><a name="l02083"></a><span class="lineno"> 2083</span>&#160; *       <span class="keywordflow">return</span> <a class="code" href="group__feaccess.html#ggaa94b67d2fdcc390690c523f28019e52fa4057ca2f127aa619c65886a9d3ad4aea">update_values</a>; </div><div class="line"><a name="l02084"></a><span class="lineno"> 2084</span>&#160; *   } </div><div class="line"><a name="l02085"></a><span class="lineno"> 2085</span>&#160; * </div><div class="line"><a name="l02086"></a><span class="lineno"> 2086</span>&#160; * <span class="keyword">@end</span>code</div><div class="line"><a name="l02087"></a><span class="lineno"> 2087</span>&#160; * </div><div class="line"><a name="l02088"></a><span class="lineno"> 2088</span>&#160; * 这个类的构造函数并不令人惊讶。我们设置了一个基于 <span class="stringliteral">&quot;MPI_COMM_WORLD &quot;</span>通信器的平行三角形，一个具有 <span class="stringliteral">&quot;dim+2 &quot;</span>分量的密度、动量和能量的矢量有限元，一个与底层有限元相同程度的高阶映射，并将时间和时间步长初始化为零。</div><div class="line"><a name="l02089"></a><span class="lineno"> 2089</span>&#160; * </div><div class="line"><a name="l02090"></a><span class="lineno"> 2090</span>&#160;</div><div class="line"><a name="l02091"></a><span class="lineno"> 2091</span>&#160; * </div><div class="line"><a name="l02092"></a><span class="lineno"> 2092</span>&#160; * </div><div class="line"><a name="l02093"></a><span class="lineno"> 2093</span>&#160; * @code</div><div class="line"><a name="l02094"></a><span class="lineno"> 2094</span>&#160; *   <span class="keyword">template</span> &lt;<span class="keywordtype">int</span> dim&gt; </div><div class="line"><a name="l02095"></a><span class="lineno"> 2095</span>&#160; *   EulerProblem&lt;dim&gt;::EulerProblem() </div><div class="line"><a name="l02096"></a><span class="lineno"> 2096</span>&#160; *     : pcout(std::cout, <a class="code" href="namespaceUtilities_1_1MPI.html#a895dcd8223a0ee6f0e6a80b80e2d5982">Utilities::MPI::this_mpi_process</a>(MPI_COMM_WORLD) == 0) </div><div class="line"><a name="l02097"></a><span class="lineno"> 2097</span>&#160; * #ifdef DEAL_II_WITH_P4EST </div><div class="line"><a name="l02098"></a><span class="lineno"> 2098</span>&#160; *     , <a class="code" href="p4est__wrappers_8cc.html#ace00f2f80d9780ef9aa1007e1c22c6a4">triangulation</a>(MPI_COMM_WORLD) </div><div class="line"><a name="l02099"></a><span class="lineno"> 2099</span>&#160; * #endif </div><div class="line"><a name="l02100"></a><span class="lineno"> 2100</span>&#160; *     , fe(<a class="code" href="classFE__DGQ.html">FE_DGQ&lt;dim&gt;</a>(fe_degree), dim + 2) </div><div class="line"><a name="l02101"></a><span class="lineno"> 2101</span>&#160; *     , mapping(fe_degree) </div><div class="line"><a name="l02102"></a><span class="lineno"> 2102</span>&#160; *     , dof_handler(<a class="code" href="p4est__wrappers_8cc.html#ace00f2f80d9780ef9aa1007e1c22c6a4">triangulation</a>) </div><div class="line"><a name="l02103"></a><span class="lineno"> 2103</span>&#160; *     , timer(pcout, <a class="code" href="classTimerOutput.html#a643d0e642b80048e91b37109fe9357cbaed9deac359496981f6275d6d6962e652">TimerOutput::never</a>, <a class="code" href="classTimerOutput.html#a2405ae1b041a57d11a61a8cbfad3b487aa1bf9100145d06321277979f4ca77ba2">TimerOutput::wall_times</a>) </div><div class="line"><a name="l02104"></a><span class="lineno"> 2104</span>&#160; *     , euler_operator(timer) </div><div class="line"><a name="l02105"></a><span class="lineno"> 2105</span>&#160; *     , time(0) </div><div class="line"><a name="l02106"></a><span class="lineno"> 2106</span>&#160; *     , time_step(0) </div><div class="line"><a name="l02107"></a><span class="lineno"> 2107</span>&#160; *   {} </div><div class="line"><a name="l02108"></a><span class="lineno"> 2108</span>&#160; * </div><div class="line"><a name="l02109"></a><span class="lineno"> 2109</span>&#160; * <span class="keyword">@end</span>code</div><div class="line"><a name="l02110"></a><span class="lineno"> 2110</span>&#160; * </div><div class="line"><a name="l02111"></a><span class="lineno"> 2111</span>&#160; * 作为一个网格，本教程程序实现了两种选择，取决于全局变量`testcase`。对于分析型变量（`testcase==0`），域是 @f$(0, 10) \times (-5, 5)@f$ ，域的四周都有迪里希特边界条件（流入）。对于 <span class="stringliteral">&quot;testcase==1&quot;</span>，我们将域设置为矩形箱中的圆柱体，源自Sch&amp;auml;fer和Turek（1996）对不可压缩的粘性流动的圆柱体的流动测试案例。在这里，我们有更多种类的边界。通道左侧的流入部分是给定的流入类型，为此我们选择了一个恒定的流入轮廓，而我们在右侧设置了一个亚声速的流出。对于圆柱体周围的边界（边界id等于2）以及通道壁（边界id等于3），我们使用壁的边界类型，即无正态流。此外，对于三维圆柱体，我们还在垂直方向上增加了一个重力。有了基础网格（包括由 <a class="code" href="namespaceGridGenerator.html#a9d0b8a34fe5ca58425aa1fcf0d6132f1">GridGenerator::channel_with_cylinder</a>()), 设置的流形），我们就可以执行指定数量的全局细化，从DoFHandler创建未知的编号，并将DoFHandler和Mapping对象交给EulerOperator的初始化。</div><div class="line"><a name="l02112"></a><span class="lineno"> 2112</span>&#160; * </div><div class="line"><a name="l02113"></a><span class="lineno"> 2113</span>&#160;</div><div class="line"><a name="l02114"></a><span class="lineno"> 2114</span>&#160; * </div><div class="line"><a name="l02115"></a><span class="lineno"> 2115</span>&#160; * </div><div class="line"><a name="l02116"></a><span class="lineno"> 2116</span>&#160; * @code</div><div class="line"><a name="l02117"></a><span class="lineno"> 2117</span>&#160; *   template &lt;int dim&gt; </div><div class="line"><a name="l02118"></a><span class="lineno"> 2118</span>&#160; *   <span class="keywordtype">void</span> EulerProblem&lt;dim&gt;::make_grid_and_dofs() </div><div class="line"><a name="l02119"></a><span class="lineno"> 2119</span>&#160; *   { </div><div class="line"><a name="l02120"></a><span class="lineno"> 2120</span>&#160; *     <span class="keywordflow">switch</span> (testcase) </div><div class="line"><a name="l02121"></a><span class="lineno"> 2121</span>&#160; *       { </div><div class="line"><a name="l02122"></a><span class="lineno"> 2122</span>&#160; *         <span class="keywordflow">case</span> 0: </div><div class="line"><a name="l02123"></a><span class="lineno"> 2123</span>&#160; *           { </div><div class="line"><a name="l02124"></a><span class="lineno"> 2124</span>&#160; *             <a class="code" href="classPoint.html">Point&lt;dim&gt;</a> lower_left; </div><div class="line"><a name="l02125"></a><span class="lineno"> 2125</span>&#160; *             <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> d = 1; d &lt; dim; ++<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a15728437b942dab0b0042eb06a407d2c">d</a>) </div><div class="line"><a name="l02126"></a><span class="lineno"> 2126</span>&#160; *               lower_left[d] = -5; </div><div class="line"><a name="l02127"></a><span class="lineno"> 2127</span>&#160; * </div><div class="line"><a name="l02128"></a><span class="lineno"> 2128</span>&#160; *             <a class="code" href="classPoint.html">Point&lt;dim&gt;</a> upper_right; </div><div class="line"><a name="l02129"></a><span class="lineno"> 2129</span>&#160; *             upper_right[0] = 10; </div><div class="line"><a name="l02130"></a><span class="lineno"> 2130</span>&#160; *             <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> d = 1; d &lt; dim; ++<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a15728437b942dab0b0042eb06a407d2c">d</a>) </div><div class="line"><a name="l02131"></a><span class="lineno"> 2131</span>&#160; *               upper_right[d] = 5; </div><div class="line"><a name="l02132"></a><span class="lineno"> 2132</span>&#160; * </div><div class="line"><a name="l02133"></a><span class="lineno"> 2133</span>&#160; *             <a class="code" href="namespaceGridGenerator.html#a56019d263ae45708302d5d7599f0d458">GridGenerator::hyper_rectangle</a>(<a class="code" href="p4est__wrappers_8cc.html#ace00f2f80d9780ef9aa1007e1c22c6a4">triangulation</a>, </div><div class="line"><a name="l02134"></a><span class="lineno"> 2134</span>&#160; *                                            lower_left, </div><div class="line"><a name="l02135"></a><span class="lineno"> 2135</span>&#160; *                                            upper_right); </div><div class="line"><a name="l02136"></a><span class="lineno"> 2136</span>&#160; *             <a class="code" href="p4est__wrappers_8cc.html#ace00f2f80d9780ef9aa1007e1c22c6a4">triangulation</a>.refine_global(2); </div><div class="line"><a name="l02137"></a><span class="lineno"> 2137</span>&#160; * </div><div class="line"><a name="l02138"></a><span class="lineno"> 2138</span>&#160; *             euler_operator.set_inflow_boundary( </div><div class="line"><a name="l02139"></a><span class="lineno"> 2139</span>&#160; *               0, std::make_unique&lt;ExactSolution&lt;dim&gt;&gt;(0)); </div><div class="line"><a name="l02140"></a><span class="lineno"> 2140</span>&#160; * </div><div class="line"><a name="l02141"></a><span class="lineno"> 2141</span>&#160; *             <span class="keywordflow">break</span>; </div><div class="line"><a name="l02142"></a><span class="lineno"> 2142</span>&#160; *           } </div><div class="line"><a name="l02143"></a><span class="lineno"> 2143</span>&#160; * </div><div class="line"><a name="l02144"></a><span class="lineno"> 2144</span>&#160; *         <span class="keywordflow">case</span> 1: </div><div class="line"><a name="l02145"></a><span class="lineno"> 2145</span>&#160; *           { </div><div class="line"><a name="l02146"></a><span class="lineno"> 2146</span>&#160; *             <a class="code" href="namespaceGridGenerator.html#a9d0b8a34fe5ca58425aa1fcf0d6132f1">GridGenerator::channel_with_cylinder</a>( </div><div class="line"><a name="l02147"></a><span class="lineno"> 2147</span>&#160; *               <a class="code" href="p4est__wrappers_8cc.html#ace00f2f80d9780ef9aa1007e1c22c6a4">triangulation</a>, 0.03, 1, 0, <span class="keyword">true</span>); </div><div class="line"><a name="l02148"></a><span class="lineno"> 2148</span>&#160; * </div><div class="line"><a name="l02149"></a><span class="lineno"> 2149</span>&#160; *             euler_operator.set_inflow_boundary( </div><div class="line"><a name="l02150"></a><span class="lineno"> 2150</span>&#160; *               0, std::make_unique&lt;ExactSolution&lt;dim&gt;&gt;(0)); </div><div class="line"><a name="l02151"></a><span class="lineno"> 2151</span>&#160; *             euler_operator.set_subsonic_outflow_boundary( </div><div class="line"><a name="l02152"></a><span class="lineno"> 2152</span>&#160; *               1, std::make_unique&lt;ExactSolution&lt;dim&gt;&gt;(0)); </div><div class="line"><a name="l02153"></a><span class="lineno"> 2153</span>&#160; * </div><div class="line"><a name="l02154"></a><span class="lineno"> 2154</span>&#160; *             euler_operator.set_wall_boundary(2); </div><div class="line"><a name="l02155"></a><span class="lineno"> 2155</span>&#160; *             euler_operator.set_wall_boundary(3); </div><div class="line"><a name="l02156"></a><span class="lineno"> 2156</span>&#160; * </div><div class="line"><a name="l02157"></a><span class="lineno"> 2157</span>&#160; *             <span class="keywordflow">if</span> (dim == 3) </div><div class="line"><a name="l02158"></a><span class="lineno"> 2158</span>&#160; *               euler_operator.set_body_force( </div><div class="line"><a name="l02159"></a><span class="lineno"> 2159</span>&#160; *                 std::make_unique&lt;<a class="code" href="classFunctions_1_1ConstantFunction.html">Functions::ConstantFunction&lt;dim&gt;</a>&gt;( </div><div class="line"><a name="l02160"></a><span class="lineno"> 2160</span>&#160; *                   std::vector&lt;double&gt;({0., 0., -0.2}))); </div><div class="line"><a name="l02161"></a><span class="lineno"> 2161</span>&#160; * </div><div class="line"><a name="l02162"></a><span class="lineno"> 2162</span>&#160; *             <span class="keywordflow">break</span>; </div><div class="line"><a name="l02163"></a><span class="lineno"> 2163</span>&#160; *           } </div><div class="line"><a name="l02164"></a><span class="lineno"> 2164</span>&#160; * </div><div class="line"><a name="l02165"></a><span class="lineno"> 2165</span>&#160; *         <span class="keywordflow">default</span>: </div><div class="line"><a name="l02166"></a><span class="lineno"> 2166</span>&#160; *           <a class="code" href="group__Exceptions.html#ga70a0bb353656e704acf927945277bbc6">Assert</a>(<span class="keyword">false</span>, <a class="code" href="group__Exceptions.html#ga7b52b286796c23ef9ff178faf7a4b68f">ExcNotImplemented</a>()); </div><div class="line"><a name="l02167"></a><span class="lineno"> 2167</span>&#160; *       } </div><div class="line"><a name="l02168"></a><span class="lineno"> 2168</span>&#160; * </div><div class="line"><a name="l02169"></a><span class="lineno"> 2169</span>&#160; *     <a class="code" href="p4est__wrappers_8cc.html#ace00f2f80d9780ef9aa1007e1c22c6a4">triangulation</a>.refine_global(n_global_refinements); </div><div class="line"><a name="l02170"></a><span class="lineno"> 2170</span>&#160; * </div><div class="line"><a name="l02171"></a><span class="lineno"> 2171</span>&#160; *     dof_handler.distribute_dofs(fe); </div><div class="line"><a name="l02172"></a><span class="lineno"> 2172</span>&#160; * </div><div class="line"><a name="l02173"></a><span class="lineno"> 2173</span>&#160; *     euler_operator.reinit(mapping, dof_handler); </div><div class="line"><a name="l02174"></a><span class="lineno"> 2174</span>&#160; *     euler_operator.initialize_vector(solution); </div><div class="line"><a name="l02175"></a><span class="lineno"> 2175</span>&#160; * </div><div class="line"><a name="l02176"></a><span class="lineno"> 2176</span>&#160; * <span class="keyword">@end</span>code</div><div class="line"><a name="l02177"></a><span class="lineno"> 2177</span>&#160; * </div><div class="line"><a name="l02178"></a><span class="lineno"> 2178</span>&#160; * 在下文中，我们输出一些关于问题的统计数据。因为我们经常会出现相当多的单元格或自由度，所以我们希望用逗号来分隔每一组的三位数来打印它们。这可以通过 <span class="stringliteral">&quot;locales &quot;</span>来实现，尽管这种工作方式不是特别直观。  @ref step_32 <span class="stringliteral">&quot;step-32&quot;</span> 对此有稍微详细的解释。</div><div class="line"><a name="l02179"></a><span class="lineno"> 2179</span>&#160; * </div><div class="line"><a name="l02180"></a><span class="lineno"> 2180</span>&#160;</div><div class="line"><a name="l02181"></a><span class="lineno"> 2181</span>&#160; * </div><div class="line"><a name="l02182"></a><span class="lineno"> 2182</span>&#160; * </div><div class="line"><a name="l02183"></a><span class="lineno"> 2183</span>&#160; * @code</div><div class="line"><a name="l02184"></a><span class="lineno"> 2184</span>&#160; *     std::locale s = pcout.get_stream().getloc(); </div><div class="line"><a name="l02185"></a><span class="lineno"> 2185</span>&#160; *     pcout.get_stream().imbue(std::locale(<span class="stringliteral">&quot;&quot;</span>)); </div><div class="line"><a name="l02186"></a><span class="lineno"> 2186</span>&#160; *     pcout &lt;&lt; <span class="stringliteral">&quot;Number of degrees of freedom: &quot;</span> &lt;&lt; dof_handler.n_dofs() </div><div class="line"><a name="l02187"></a><span class="lineno"> 2187</span>&#160; *           &lt;&lt; <span class="stringliteral">&quot; ( = &quot;</span> &lt;&lt; (dim + 2) &lt;&lt; <span class="stringliteral">&quot; [vars] x &quot;</span> </div><div class="line"><a name="l02188"></a><span class="lineno"> 2188</span>&#160; *           &lt;&lt; <a class="code" href="p4est__wrappers_8cc.html#ace00f2f80d9780ef9aa1007e1c22c6a4">triangulation</a>.n_global_active_cells() &lt;&lt; <span class="stringliteral">&quot; [cells] x &quot;</span> </div><div class="line"><a name="l02189"></a><span class="lineno"> 2189</span>&#160; *           &lt;&lt; <a class="code" href="namespaceUtilities.html#a0900f35b37ee122e73fb2c80bba9beb9">Utilities::pow</a>(fe_degree + 1, dim) &lt;&lt; <span class="stringliteral">&quot; [dofs/cell/var] )&quot;</span> </div><div class="line"><a name="l02190"></a><span class="lineno"> 2190</span>&#160; *           &lt;&lt; std::endl; </div><div class="line"><a name="l02191"></a><span class="lineno"> 2191</span>&#160; *     pcout.get_stream().imbue(s); </div><div class="line"><a name="l02192"></a><span class="lineno"> 2192</span>&#160; *   } </div><div class="line"><a name="l02193"></a><span class="lineno"> 2193</span>&#160; * </div><div class="line"><a name="l02194"></a><span class="lineno"> 2194</span>&#160; * <span class="keyword">@end</span>code</div><div class="line"><a name="l02195"></a><span class="lineno"> 2195</span>&#160; * </div><div class="line"><a name="l02196"></a><span class="lineno"> 2196</span>&#160; * 对于输出，我们首先让欧拉算子计算出数值结果的误差。更确切地说，对于分析解的情况，我们计算与分析结果的误差，而对于第二个测试情况，我们计算与密度和能量恒定的背景场以及 @f$x@f$ 方向的恒定速度的偏差。</div><div class="line"><a name="l02197"></a><span class="lineno"> 2197</span>&#160; * </div><div class="line"><a name="l02198"></a><span class="lineno"> 2198</span>&#160;</div><div class="line"><a name="l02199"></a><span class="lineno"> 2199</span>&#160; * </div><div class="line"><a name="l02200"></a><span class="lineno"> 2200</span>&#160; * 下一步是创建输出。这与 @ref step_33 <span class="stringliteral">&quot;step-33&quot;</span> 中的做法类似：我们让上面定义的后处理器控制大部分的输出，除了我们直接写的原始场。对于分析解的测试案例，我们还对分析解进行了另一次投影，并打印出该场和数值解之间的差异。一旦我们定义了所有要写的量，我们就建立输出的补丁。与 @ref step_65 <span class="stringliteral">&quot;step-65&quot;</span> 类似，我们通过设置适当的标志来创建一个高阶VTK输出，这使我们能够可视化高多项式度的场。最后，我们调用 `<a class="code" href="classDataOutInterface.html#a5df488dad82b811ceb08cb1adf9eafcd">DataOutInterface::write_vtu_in_parallel</a>()` 函数，将结果写入给定的文件名。这个函数使用了特殊的MPI并行写设施，与其他大多数教程程序中使用的标准库的 `std::ofstream` 变体相比，它通常对并行文件系统更加优化。`write_vtu_in_parallel()`函数的一个特别好的特点是，它可以将所有MPI行列的输出合并到一个文件中，使得没有必要有一个所有此类文件的中央记录（即 <span class="stringliteral">&quot;pvtu &quot;</span>文件）。</div><div class="line"><a name="l02201"></a><span class="lineno"> 2201</span>&#160; * </div><div class="line"><a name="l02202"></a><span class="lineno"> 2202</span>&#160;</div><div class="line"><a name="l02203"></a><span class="lineno"> 2203</span>&#160; * </div><div class="line"><a name="l02204"></a><span class="lineno"> 2204</span>&#160; * 对于并行程序来说，看一下单元在处理器之间的划分往往是有启发的。为此，我们可以向 <a class="code" href="classDataOut__DoFData.html#a79cbe2f02f8dfb85026c71d783dbb703">DataOut::add_data_vector</a>() 传递一个数字向量，其中包含与当前处理器拥有的活动单元一样多的条目；然后这些数字应该是拥有这些单元的处理器的等级。例如，这样一个向量可以从 <a class="code" href="namespaceGridTools.html">GridTools</a>::<a class="code" href="namespaceDoFTools.html#a0429b3117b2ab1f5a1fd0d55de26ad81">get_subdomain_association</a>(). 中获得。另一方面，在每个MPI进程中，DataOut将只读取那些对应于本地拥有的单元的条目，这些条目当然都有相同的值：即当前进程的等级。矢量的其余条目中的内容实际上并不重要，因此我们可以用一个廉价的技巧逃脱。我们只是把我们给 <a class="code" href="classDataOut.html">DataOut</a>::add_data_vector() 的向量的所有*值都填上当前MPI进程的等级。关键是在每个进程中，只有对应于本地拥有的单元格的条目会被读取，而忽略其他条目中的（错误）值。事实上，每个进程提交的向量中的条目子集是正确的，这就足够了。</div><div class="line"><a name="l02205"></a><span class="lineno"> 2205</span>&#160; * </div><div class="line"><a name="l02206"></a><span class="lineno"> 2206</span>&#160;</div><div class="line"><a name="l02207"></a><span class="lineno"> 2207</span>&#160; * </div><div class="line"><a name="l02208"></a><span class="lineno"> 2208</span>&#160; * </div><div class="line"><a name="l02209"></a><span class="lineno"> 2209</span>&#160; * @code</div><div class="line"><a name="l02210"></a><span class="lineno"> 2210</span>&#160; *   template &lt;<span class="keywordtype">int</span> dim&gt; </div><div class="line"><a name="l02211"></a><span class="lineno"> 2211</span>&#160; *   <span class="keywordtype">void</span> EulerProblem&lt;dim&gt;::output_results(const <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> result_number) </div><div class="line"><a name="l02212"></a><span class="lineno"> 2212</span>&#160; *   { </div><div class="line"><a name="l02213"></a><span class="lineno"> 2213</span>&#160; *     <span class="keyword">const</span> std::array&lt;double, 3&gt; errors = </div><div class="line"><a name="l02214"></a><span class="lineno"> 2214</span>&#160; *       euler_operator.compute_errors(ExactSolution&lt;dim&gt;(time), solution); </div><div class="line"><a name="l02215"></a><span class="lineno"> 2215</span>&#160; *     <span class="keyword">const</span> std::string quantity_name = testcase == 0 ? <span class="stringliteral">&quot;error&quot;</span> : <span class="stringliteral">&quot;norm&quot;</span>; </div><div class="line"><a name="l02216"></a><span class="lineno"> 2216</span>&#160; * </div><div class="line"><a name="l02217"></a><span class="lineno"> 2217</span>&#160; *     pcout &lt;&lt; <span class="stringliteral">&quot;Time:&quot;</span> &lt;&lt; std::setw(8) &lt;&lt; std::setprecision(3) &lt;&lt; time </div><div class="line"><a name="l02218"></a><span class="lineno"> 2218</span>&#160; *           &lt;&lt; <span class="stringliteral">&quot;, dt: &quot;</span> &lt;&lt; std::setw(8) &lt;&lt; std::setprecision(2) &lt;&lt; time_step </div><div class="line"><a name="l02219"></a><span class="lineno"> 2219</span>&#160; *           &lt;&lt; <span class="stringliteral">&quot;, &quot;</span> &lt;&lt; quantity_name &lt;&lt; <span class="stringliteral">&quot; rho: &quot;</span> &lt;&lt; std::setprecision(4) </div><div class="line"><a name="l02220"></a><span class="lineno"> 2220</span>&#160; *           &lt;&lt; std::setw(10) &lt;&lt; errors[0] &lt;&lt; <span class="stringliteral">&quot;, rho * u: &quot;</span> &lt;&lt; std::setprecision(4) </div><div class="line"><a name="l02221"></a><span class="lineno"> 2221</span>&#160; *           &lt;&lt; std::setw(10) &lt;&lt; errors[1] &lt;&lt; <span class="stringliteral">&quot;, energy:&quot;</span> &lt;&lt; std::setprecision(4) </div><div class="line"><a name="l02222"></a><span class="lineno"> 2222</span>&#160; *           &lt;&lt; std::setw(10) &lt;&lt; errors[2] &lt;&lt; std::endl; </div><div class="line"><a name="l02223"></a><span class="lineno"> 2223</span>&#160; * </div><div class="line"><a name="l02224"></a><span class="lineno"> 2224</span>&#160; *     { </div><div class="line"><a name="l02225"></a><span class="lineno"> 2225</span>&#160; *       <a class="code" href="classTimerOutput_1_1Scope.html">TimerOutput::Scope</a> t(timer, <span class="stringliteral">&quot;output&quot;</span>); </div><div class="line"><a name="l02226"></a><span class="lineno"> 2226</span>&#160; * </div><div class="line"><a name="l02227"></a><span class="lineno"> 2227</span>&#160; *       Postprocessor postprocessor; </div><div class="line"><a name="l02228"></a><span class="lineno"> 2228</span>&#160; *       <a class="code" href="classDataOut.html">DataOut&lt;dim&gt;</a>  data_out; </div><div class="line"><a name="l02229"></a><span class="lineno"> 2229</span>&#160; * </div><div class="line"><a name="l02230"></a><span class="lineno"> 2230</span>&#160; *       <a class="code" href="structDataOutBase_1_1VtkFlags.html">DataOutBase::VtkFlags</a> flags; </div><div class="line"><a name="l02231"></a><span class="lineno"> 2231</span>&#160; *       flags.<a class="code" href="structDataOutBase_1_1VtkFlags.html#aa9dd1830c0ff35a2431704c4d45453eb">write_higher_order_cells</a> = <span class="keyword">true</span>; </div><div class="line"><a name="l02232"></a><span class="lineno"> 2232</span>&#160; *       data_out.<a class="code" href="classDataOutInterface.html#ac7280a24690b117454acfb0fa058299c">set_flags</a>(flags); </div><div class="line"><a name="l02233"></a><span class="lineno"> 2233</span>&#160; * </div><div class="line"><a name="l02234"></a><span class="lineno"> 2234</span>&#160; *       data_out.<a class="code" href="classDataOut__DoFData.html#a6ed7c846331069f406b8c9933c37fda4">attach_dof_handler</a>(dof_handler); </div><div class="line"><a name="l02235"></a><span class="lineno"> 2235</span>&#160; *       { </div><div class="line"><a name="l02236"></a><span class="lineno"> 2236</span>&#160; *         std::vector&lt;std::string&gt; names; </div><div class="line"><a name="l02237"></a><span class="lineno"> 2237</span>&#160; *         names.emplace_back(<span class="stringliteral">&quot;density&quot;</span>); </div><div class="line"><a name="l02238"></a><span class="lineno"> 2238</span>&#160; *         <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> d = 0; d &lt; dim; ++<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a15728437b942dab0b0042eb06a407d2c">d</a>) </div><div class="line"><a name="l02239"></a><span class="lineno"> 2239</span>&#160; *           names.emplace_back(<span class="stringliteral">&quot;momentum&quot;</span>); </div><div class="line"><a name="l02240"></a><span class="lineno"> 2240</span>&#160; *         names.emplace_back(<span class="stringliteral">&quot;energy&quot;</span>); </div><div class="line"><a name="l02241"></a><span class="lineno"> 2241</span>&#160; * </div><div class="line"><a name="l02242"></a><span class="lineno"> 2242</span>&#160; *         std::vector&lt;DataComponentInterpretation::DataComponentInterpretation&gt; </div><div class="line"><a name="l02243"></a><span class="lineno"> 2243</span>&#160; *           interpretation; </div><div class="line"><a name="l02244"></a><span class="lineno"> 2244</span>&#160; *         interpretation.push_back( </div><div class="line"><a name="l02245"></a><span class="lineno"> 2245</span>&#160; *           <a class="code" href="namespaceDataComponentInterpretation.html#a0cd2da3afe902f9004c23a73dbcc8ab0a1f3cd50135818a6458f1d3ff7ea4bb51">DataComponentInterpretation::component_is_scalar</a>); </div><div class="line"><a name="l02246"></a><span class="lineno"> 2246</span>&#160; *         <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> d = 0; d &lt; dim; ++<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a15728437b942dab0b0042eb06a407d2c">d</a>) </div><div class="line"><a name="l02247"></a><span class="lineno"> 2247</span>&#160; *           interpretation.push_back( </div><div class="line"><a name="l02248"></a><span class="lineno"> 2248</span>&#160; *             <a class="code" href="namespaceDataComponentInterpretation.html#a0cd2da3afe902f9004c23a73dbcc8ab0aa783915dbc182d5a49e111815fd23fe0">DataComponentInterpretation::component_is_part_of_vector</a>); </div><div class="line"><a name="l02249"></a><span class="lineno"> 2249</span>&#160; *         interpretation.push_back( </div><div class="line"><a name="l02250"></a><span class="lineno"> 2250</span>&#160; *           <a class="code" href="namespaceDataComponentInterpretation.html#a0cd2da3afe902f9004c23a73dbcc8ab0a1f3cd50135818a6458f1d3ff7ea4bb51">DataComponentInterpretation::component_is_scalar</a>); </div><div class="line"><a name="l02251"></a><span class="lineno"> 2251</span>&#160; * </div><div class="line"><a name="l02252"></a><span class="lineno"> 2252</span>&#160; *         data_out.<a class="code" href="classDataOut__DoFData.html#a79cbe2f02f8dfb85026c71d783dbb703">add_data_vector</a>(dof_handler, solution, names, interpretation); </div><div class="line"><a name="l02253"></a><span class="lineno"> 2253</span>&#160; *       } </div><div class="line"><a name="l02254"></a><span class="lineno"> 2254</span>&#160; *       data_out.<a class="code" href="classDataOut__DoFData.html#a79cbe2f02f8dfb85026c71d783dbb703">add_data_vector</a>(solution, postprocessor); </div><div class="line"><a name="l02255"></a><span class="lineno"> 2255</span>&#160; * </div><div class="line"><a name="l02256"></a><span class="lineno"> 2256</span>&#160; *       <a class="code" href="classLinearAlgebra_1_1distributed_1_1Vector.html">LinearAlgebra::distributed::Vector&lt;Number&gt;</a> reference; </div><div class="line"><a name="l02257"></a><span class="lineno"> 2257</span>&#160; *       <span class="keywordflow">if</span> (testcase == 0 &amp;&amp; dim == 2) </div><div class="line"><a name="l02258"></a><span class="lineno"> 2258</span>&#160; *         { </div><div class="line"><a name="l02259"></a><span class="lineno"> 2259</span>&#160; *           reference.<a class="code" href="classLinearAlgebra_1_1distributed_1_1Vector.html#ace027311492ed2f6e07fbd74d723e3a9">reinit</a>(solution); </div><div class="line"><a name="l02260"></a><span class="lineno"> 2260</span>&#160; *           euler_operator.project(ExactSolution&lt;dim&gt;(time), reference); </div><div class="line"><a name="l02261"></a><span class="lineno"> 2261</span>&#160; *           reference.<a class="code" href="classLinearAlgebra_1_1distributed_1_1Vector.html#aa6376a098589519491fc452d1529f57b">sadd</a>(-1., 1, solution); </div><div class="line"><a name="l02262"></a><span class="lineno"> 2262</span>&#160; *           std::vector&lt;std::string&gt; names; </div><div class="line"><a name="l02263"></a><span class="lineno"> 2263</span>&#160; *           names.emplace_back(<span class="stringliteral">&quot;error_density&quot;</span>); </div><div class="line"><a name="l02264"></a><span class="lineno"> 2264</span>&#160; *           <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> d = 0; d &lt; dim; ++<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a15728437b942dab0b0042eb06a407d2c">d</a>) </div><div class="line"><a name="l02265"></a><span class="lineno"> 2265</span>&#160; *             names.emplace_back(<span class="stringliteral">&quot;error_momentum&quot;</span>); </div><div class="line"><a name="l02266"></a><span class="lineno"> 2266</span>&#160; *           names.emplace_back(<span class="stringliteral">&quot;error_energy&quot;</span>); </div><div class="line"><a name="l02267"></a><span class="lineno"> 2267</span>&#160; * </div><div class="line"><a name="l02268"></a><span class="lineno"> 2268</span>&#160; *           std::vector&lt;DataComponentInterpretation::DataComponentInterpretation&gt; </div><div class="line"><a name="l02269"></a><span class="lineno"> 2269</span>&#160; *             interpretation; </div><div class="line"><a name="l02270"></a><span class="lineno"> 2270</span>&#160; *           interpretation.push_back( </div><div class="line"><a name="l02271"></a><span class="lineno"> 2271</span>&#160; *             <a class="code" href="namespaceDataComponentInterpretation.html#a0cd2da3afe902f9004c23a73dbcc8ab0a1f3cd50135818a6458f1d3ff7ea4bb51">DataComponentInterpretation::component_is_scalar</a>); </div><div class="line"><a name="l02272"></a><span class="lineno"> 2272</span>&#160; *           <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> d = 0; d &lt; dim; ++<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a15728437b942dab0b0042eb06a407d2c">d</a>) </div><div class="line"><a name="l02273"></a><span class="lineno"> 2273</span>&#160; *             interpretation.push_back( </div><div class="line"><a name="l02274"></a><span class="lineno"> 2274</span>&#160; *               <a class="code" href="namespaceDataComponentInterpretation.html#a0cd2da3afe902f9004c23a73dbcc8ab0aa783915dbc182d5a49e111815fd23fe0">DataComponentInterpretation::component_is_part_of_vector</a>); </div><div class="line"><a name="l02275"></a><span class="lineno"> 2275</span>&#160; *           interpretation.push_back( </div><div class="line"><a name="l02276"></a><span class="lineno"> 2276</span>&#160; *             <a class="code" href="namespaceDataComponentInterpretation.html#a0cd2da3afe902f9004c23a73dbcc8ab0a1f3cd50135818a6458f1d3ff7ea4bb51">DataComponentInterpretation::component_is_scalar</a>); </div><div class="line"><a name="l02277"></a><span class="lineno"> 2277</span>&#160; * </div><div class="line"><a name="l02278"></a><span class="lineno"> 2278</span>&#160; *           data_out.<a class="code" href="classDataOut__DoFData.html#a79cbe2f02f8dfb85026c71d783dbb703">add_data_vector</a>(dof_handler, </div><div class="line"><a name="l02279"></a><span class="lineno"> 2279</span>&#160; *                                    reference, </div><div class="line"><a name="l02280"></a><span class="lineno"> 2280</span>&#160; *                                    names, </div><div class="line"><a name="l02281"></a><span class="lineno"> 2281</span>&#160; *                                    interpretation); </div><div class="line"><a name="l02282"></a><span class="lineno"> 2282</span>&#160; *         } </div><div class="line"><a name="l02283"></a><span class="lineno"> 2283</span>&#160; * </div><div class="line"><a name="l02284"></a><span class="lineno"> 2284</span>&#160; *       <a class="code" href="classVector.html">Vector&lt;double&gt;</a> mpi_owner(<a class="code" href="p4est__wrappers_8cc.html#ace00f2f80d9780ef9aa1007e1c22c6a4">triangulation</a>.n_active_cells()); </div><div class="line"><a name="l02285"></a><span class="lineno"> 2285</span>&#160; *       mpi_owner = <a class="code" href="namespaceUtilities_1_1MPI.html#a895dcd8223a0ee6f0e6a80b80e2d5982">Utilities::MPI::this_mpi_process</a>(MPI_COMM_WORLD); </div><div class="line"><a name="l02286"></a><span class="lineno"> 2286</span>&#160; *       data_out.<a class="code" href="classDataOut__DoFData.html#a79cbe2f02f8dfb85026c71d783dbb703">add_data_vector</a>(mpi_owner, <span class="stringliteral">&quot;owner&quot;</span>); </div><div class="line"><a name="l02287"></a><span class="lineno"> 2287</span>&#160; * </div><div class="line"><a name="l02288"></a><span class="lineno"> 2288</span>&#160; *       data_out.<a class="code" href="classDataOut.html#a087f63e22f0614bca326dbdca288c646">build_patches</a>(mapping, </div><div class="line"><a name="l02289"></a><span class="lineno"> 2289</span>&#160; *                              fe.degree, </div><div class="line"><a name="l02290"></a><span class="lineno"> 2290</span>&#160; *                              <a class="code" href="classDataOut.html">DataOut&lt;dim&gt;::curved_inner_cells</a>); </div><div class="line"><a name="l02291"></a><span class="lineno"> 2291</span>&#160; * </div><div class="line"><a name="l02292"></a><span class="lineno"> 2292</span>&#160; *       <span class="keyword">const</span> std::string filename = </div><div class="line"><a name="l02293"></a><span class="lineno"> 2293</span>&#160; *         <span class="stringliteral">&quot;solution_&quot;</span> + <a class="code" href="namespaceUtilities.html#a6195c5f009ea8c7c536c6ffdf108c32f">Utilities::int_to_string</a>(result_number, 3) + <span class="stringliteral">&quot;.vtu&quot;</span>; </div><div class="line"><a name="l02294"></a><span class="lineno"> 2294</span>&#160; *       data_out.<a class="code" href="classDataOutInterface.html#a5df488dad82b811ceb08cb1adf9eafcd">write_vtu_in_parallel</a>(filename, MPI_COMM_WORLD); </div><div class="line"><a name="l02295"></a><span class="lineno"> 2295</span>&#160; *     } </div><div class="line"><a name="l02296"></a><span class="lineno"> 2296</span>&#160; *   } </div><div class="line"><a name="l02297"></a><span class="lineno"> 2297</span>&#160; * </div><div class="line"><a name="l02298"></a><span class="lineno"> 2298</span>&#160; * <span class="keyword">@end</span>code</div><div class="line"><a name="l02299"></a><span class="lineno"> 2299</span>&#160; * </div><div class="line"><a name="l02300"></a><span class="lineno"> 2300</span>&#160; * <a class="code" href="namespaceWorkStream_1_1internal_1_1tbb__no__coloring.html#a8673698a405bf47aa24002aeb6d76d70">EulerProblem::run</a>() 函数将所有的部分组合起来。它首先调用创建网格和设置数据结构的函数，然后初始化时间积分器和低存储积分器的两个临时向量。我们称这些向量为`rk_register_1`和`rk_register_2`，并使用第一个向量表示 @f$\mathbf{r}_i@f$ ，第二个向量表示 @f$\mathbf{k}_i@f$ ，在介绍中概述的Runge--Kutta方案的公式。在我们开始时间循环之前，我们通过 `EulerOperator::compute_cell_transport_speed()` 函数计算时间步长。为了便于比较，我们将那里得到的结果与最小网格尺寸进行比较，并将它们打印到屏幕上。对于像本教程程序中接近于统一的声速和速度，预测的有效网格尺寸将是接近的，但如果缩放比例不同，它们可能会有变化。</div><div class="line"><a name="l02301"></a><span class="lineno"> 2301</span>&#160; * </div><div class="line"><a name="l02302"></a><span class="lineno"> 2302</span>&#160;</div><div class="line"><a name="l02303"></a><span class="lineno"> 2303</span>&#160; * </div><div class="line"><a name="l02304"></a><span class="lineno"> 2304</span>&#160; * </div><div class="line"><a name="l02305"></a><span class="lineno"> 2305</span>&#160; * @code</div><div class="line"><a name="l02306"></a><span class="lineno"> 2306</span>&#160; *   <span class="keyword">template</span> &lt;<span class="keywordtype">int</span> dim&gt; </div><div class="line"><a name="l02307"></a><span class="lineno"> 2307</span>&#160; *   <span class="keywordtype">void</span> <a class="code" href="namespaceWorkStream_1_1internal_1_1tbb__no__coloring.html#a8673698a405bf47aa24002aeb6d76d70">EulerProblem&lt;dim&gt;::run</a>() </div><div class="line"><a name="l02308"></a><span class="lineno"> 2308</span>&#160; *   { </div><div class="line"><a name="l02309"></a><span class="lineno"> 2309</span>&#160; *     { </div><div class="line"><a name="l02310"></a><span class="lineno"> 2310</span>&#160; *       <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> n_vect_number = <a class="code" href="classVectorizedArrayBase.html#acb35404acc1693aee6e990228924cc09">VectorizedArray&lt;Number&gt;::size</a>(); </div><div class="line"><a name="l02311"></a><span class="lineno"> 2311</span>&#160; *       <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> n_vect_bits   = 8 * <span class="keyword">sizeof</span>(Number) * n_vect_number; </div><div class="line"><a name="l02312"></a><span class="lineno"> 2312</span>&#160; * </div><div class="line"><a name="l02313"></a><span class="lineno"> 2313</span>&#160; *       pcout &lt;&lt; <span class="stringliteral">&quot;Running with &quot;</span> </div><div class="line"><a name="l02314"></a><span class="lineno"> 2314</span>&#160; *             &lt;&lt; <a class="code" href="namespaceUtilities_1_1MPI.html#ac26de0c059200523177bb1d92cc25d00">Utilities::MPI::n_mpi_processes</a>(MPI_COMM_WORLD) </div><div class="line"><a name="l02315"></a><span class="lineno"> 2315</span>&#160; *             &lt;&lt; <span class="stringliteral">&quot; MPI processes&quot;</span> &lt;&lt; std::endl; </div><div class="line"><a name="l02316"></a><span class="lineno"> 2316</span>&#160; *       pcout &lt;&lt; <span class="stringliteral">&quot;Vectorization over &quot;</span> &lt;&lt; n_vect_number &lt;&lt; <span class="stringliteral">&quot; &quot;</span> </div><div class="line"><a name="l02317"></a><span class="lineno"> 2317</span>&#160; *             &lt;&lt; (std::is_same&lt;Number, double&gt;::value ? <span class="stringliteral">&quot;doubles&quot;</span> : <span class="stringliteral">&quot;floats&quot;</span>) </div><div class="line"><a name="l02318"></a><span class="lineno"> 2318</span>&#160; *             &lt;&lt; <span class="stringliteral">&quot; = &quot;</span> &lt;&lt; n_vect_bits &lt;&lt; <span class="stringliteral">&quot; bits (&quot;</span> </div><div class="line"><a name="l02319"></a><span class="lineno"> 2319</span>&#160; *             &lt;&lt; <a class="code" href="namespaceUtilities_1_1System.html#ade631a789101336840371e3b2e2851e0">Utilities::System::get_current_vectorization_level</a>() &lt;&lt; <span class="stringliteral">&quot;)&quot;</span> </div><div class="line"><a name="l02320"></a><span class="lineno"> 2320</span>&#160; *             &lt;&lt; std::endl; </div><div class="line"><a name="l02321"></a><span class="lineno"> 2321</span>&#160; *     } </div><div class="line"><a name="l02322"></a><span class="lineno"> 2322</span>&#160; * </div><div class="line"><a name="l02323"></a><span class="lineno"> 2323</span>&#160; *     make_grid_and_dofs(); </div><div class="line"><a name="l02324"></a><span class="lineno"> 2324</span>&#160; * </div><div class="line"><a name="l02325"></a><span class="lineno"> 2325</span>&#160; *     <span class="keyword">const</span> LowStorageRungeKuttaIntegrator integrator(lsrk_scheme); </div><div class="line"><a name="l02326"></a><span class="lineno"> 2326</span>&#160; * </div><div class="line"><a name="l02327"></a><span class="lineno"> 2327</span>&#160; *     <a class="code" href="classLinearAlgebra_1_1distributed_1_1Vector.html">LinearAlgebra::distributed::Vector&lt;Number&gt;</a> rk_register_1; </div><div class="line"><a name="l02328"></a><span class="lineno"> 2328</span>&#160; *     <a class="code" href="classLinearAlgebra_1_1distributed_1_1Vector.html">LinearAlgebra::distributed::Vector&lt;Number&gt;</a> rk_register_2; </div><div class="line"><a name="l02329"></a><span class="lineno"> 2329</span>&#160; *     rk_register_1.<a class="code" href="classLinearAlgebra_1_1distributed_1_1Vector.html#ace027311492ed2f6e07fbd74d723e3a9">reinit</a>(solution); </div><div class="line"><a name="l02330"></a><span class="lineno"> 2330</span>&#160; *     rk_register_2.<a class="code" href="classLinearAlgebra_1_1distributed_1_1Vector.html#ace027311492ed2f6e07fbd74d723e3a9">reinit</a>(solution); </div><div class="line"><a name="l02331"></a><span class="lineno"> 2331</span>&#160; * </div><div class="line"><a name="l02332"></a><span class="lineno"> 2332</span>&#160; *     euler_operator.project(ExactSolution&lt;dim&gt;(time), solution); </div><div class="line"><a name="l02333"></a><span class="lineno"> 2333</span>&#160; * </div><div class="line"><a name="l02334"></a><span class="lineno"> 2334</span>&#160; *     <span class="keywordtype">double</span> min_vertex_distance = <a class="code" href="namespaceVectorTools_1_1EvaluationFlags.html#ac6721740e24732d6afabcf28ddfc1ffda8e7f5b8545162dccd5ed717792bdf420">std::numeric_limits&lt;double&gt;::max</a>(); </div><div class="line"><a name="l02335"></a><span class="lineno"> 2335</span>&#160; *     <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span> &amp;cell : <a class="code" href="p4est__wrappers_8cc.html#ace00f2f80d9780ef9aa1007e1c22c6a4">triangulation</a>.active_cell_iterators()) </div><div class="line"><a name="l02336"></a><span class="lineno"> 2336</span>&#160; *       <span class="keywordflow">if</span> (cell-&gt;is_locally_owned()) </div><div class="line"><a name="l02337"></a><span class="lineno"> 2337</span>&#160; *         min_vertex_distance = </div><div class="line"><a name="l02338"></a><span class="lineno"> 2338</span>&#160; *           <a class="code" href="namespaceVectorTools_1_1EvaluationFlags.html#ac6721740e24732d6afabcf28ddfc1ffdaeb244a97c0c9e9e7ca4765e096f0badc">std::min</a>(min_vertex_distance, cell-&gt;minimum_vertex_distance()); </div><div class="line"><a name="l02339"></a><span class="lineno"> 2339</span>&#160; *     min_vertex_distance = </div><div class="line"><a name="l02340"></a><span class="lineno"> 2340</span>&#160; *       <a class="code" href="namespaceUtilities_1_1MPI.html#a9ac5275c3c74902f8a9d6e7bdb514179">Utilities::MPI::min</a>(min_vertex_distance, MPI_COMM_WORLD); </div><div class="line"><a name="l02341"></a><span class="lineno"> 2341</span>&#160; * </div><div class="line"><a name="l02342"></a><span class="lineno"> 2342</span>&#160; *     time_step = courant_number * integrator.n_stages() / </div><div class="line"><a name="l02343"></a><span class="lineno"> 2343</span>&#160; *                 euler_operator.compute_cell_transport_speed(solution); </div><div class="line"><a name="l02344"></a><span class="lineno"> 2344</span>&#160; *     pcout &lt;&lt; <span class="stringliteral">&quot;Time step size: &quot;</span> &lt;&lt; time_step </div><div class="line"><a name="l02345"></a><span class="lineno"> 2345</span>&#160; *           &lt;&lt; <span class="stringliteral">&quot;, minimal h: &quot;</span> &lt;&lt; min_vertex_distance </div><div class="line"><a name="l02346"></a><span class="lineno"> 2346</span>&#160; *           &lt;&lt; <span class="stringliteral">&quot;, initial transport scaling: &quot;</span> </div><div class="line"><a name="l02347"></a><span class="lineno"> 2347</span>&#160; *           &lt;&lt; 1. / euler_operator.compute_cell_transport_speed(solution) </div><div class="line"><a name="l02348"></a><span class="lineno"> 2348</span>&#160; *           &lt;&lt; std::endl </div><div class="line"><a name="l02349"></a><span class="lineno"> 2349</span>&#160; *           &lt;&lt; std::endl; </div><div class="line"><a name="l02350"></a><span class="lineno"> 2350</span>&#160; * </div><div class="line"><a name="l02351"></a><span class="lineno"> 2351</span>&#160; *     output_results(0); </div><div class="line"><a name="l02352"></a><span class="lineno"> 2352</span>&#160; * </div><div class="line"><a name="l02353"></a><span class="lineno"> 2353</span>&#160; * <span class="keyword">@end</span>code</div><div class="line"><a name="l02354"></a><span class="lineno"> 2354</span>&#160; * </div><div class="line"><a name="l02355"></a><span class="lineno"> 2355</span>&#160; * 现在我们准备开始时间循环，我们一直运行到时间达到预期的结束时间。每隔5个时间步长，我们就计算一个新的时间步长估计值--由于解决方案是非线性的，在模拟过程中调整这个值是最有效的。如果Courant数选择得过于激进，模拟通常会在时间步数为NaN时爆炸，所以在这里很容易发现。有一点需要注意的是，由于不同的时间步长选择的相互作用，四舍五入的误差可能会传播到前几位数，从而导致略有不同的解决方案。为了降低这种敏感性，通常的做法是将时间步长四舍五入或截断到几位数，例如在这种情况下是3。如果当前时间接近规定的输出 <span class="stringliteral">&quot;刻度 &quot;</span>值（如0.02），我们也会写出输出。在时间循环结束后，我们通过打印一些统计数据来总结计算，这主要由 <a class="code" href="classTimerOutput.html#ae7673798226de7731e3ecdf7c0fb7568">TimerOutput::print_wall_time_statistics</a>() 函数完成。</div><div class="line"><a name="l02356"></a><span class="lineno"> 2356</span>&#160; * </div><div class="line"><a name="l02357"></a><span class="lineno"> 2357</span>&#160;</div><div class="line"><a name="l02358"></a><span class="lineno"> 2358</span>&#160; * </div><div class="line"><a name="l02359"></a><span class="lineno"> 2359</span>&#160; * </div><div class="line"><a name="l02360"></a><span class="lineno"> 2360</span>&#160; * @code</div><div class="line"><a name="l02361"></a><span class="lineno"> 2361</span>&#160; *     <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> timestep_number = 0; </div><div class="line"><a name="l02362"></a><span class="lineno"> 2362</span>&#160; * </div><div class="line"><a name="l02363"></a><span class="lineno"> 2363</span>&#160; *     while (time &lt; final_time - 1<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a9587d5229555daa5b1fa1ba2f8a40adb">e</a>-12) </div><div class="line"><a name="l02364"></a><span class="lineno"> 2364</span>&#160; *       { </div><div class="line"><a name="l02365"></a><span class="lineno"> 2365</span>&#160; *         ++timestep_number; </div><div class="line"><a name="l02366"></a><span class="lineno"> 2366</span>&#160; *         <span class="keywordflow">if</span> (timestep_number % 5 == 0) </div><div class="line"><a name="l02367"></a><span class="lineno"> 2367</span>&#160; *           time_step = </div><div class="line"><a name="l02368"></a><span class="lineno"> 2368</span>&#160; *             courant_number * integrator.n_stages() / </div><div class="line"><a name="l02369"></a><span class="lineno"> 2369</span>&#160; *             <a class="code" href="namespaceUtilities.html#a17955af7a4bc8771d430e622f9e732b3">Utilities::truncate_to_n_digits</a>( </div><div class="line"><a name="l02370"></a><span class="lineno"> 2370</span>&#160; *               euler_operator.compute_cell_transport_speed(solution), 3); </div><div class="line"><a name="l02371"></a><span class="lineno"> 2371</span>&#160; * </div><div class="line"><a name="l02372"></a><span class="lineno"> 2372</span>&#160; *         { </div><div class="line"><a name="l02373"></a><span class="lineno"> 2373</span>&#160; *           <a class="code" href="classTimerOutput_1_1Scope.html">TimerOutput::Scope</a> t(timer, <span class="stringliteral">&quot;rk time stepping total&quot;</span>); </div><div class="line"><a name="l02374"></a><span class="lineno"> 2374</span>&#160; *           integrator.perform_time_step(euler_operator, </div><div class="line"><a name="l02375"></a><span class="lineno"> 2375</span>&#160; *                                        time, </div><div class="line"><a name="l02376"></a><span class="lineno"> 2376</span>&#160; *                                        time_step, </div><div class="line"><a name="l02377"></a><span class="lineno"> 2377</span>&#160; *                                        solution, </div><div class="line"><a name="l02378"></a><span class="lineno"> 2378</span>&#160; *                                        rk_register_1, </div><div class="line"><a name="l02379"></a><span class="lineno"> 2379</span>&#160; *                                        rk_register_2); </div><div class="line"><a name="l02380"></a><span class="lineno"> 2380</span>&#160; *         } </div><div class="line"><a name="l02381"></a><span class="lineno"> 2381</span>&#160; * </div><div class="line"><a name="l02382"></a><span class="lineno"> 2382</span>&#160; *         time += time_step; </div><div class="line"><a name="l02383"></a><span class="lineno"> 2383</span>&#160; * </div><div class="line"><a name="l02384"></a><span class="lineno"> 2384</span>&#160; *         <span class="keywordflow">if</span> (static_cast&lt;int&gt;(time / output_tick) != </div><div class="line"><a name="l02385"></a><span class="lineno"> 2385</span>&#160; *               static_cast&lt;int&gt;((time - time_step) / output_tick) || </div><div class="line"><a name="l02386"></a><span class="lineno"> 2386</span>&#160; *             time &gt;= final_time - 1e-12) </div><div class="line"><a name="l02387"></a><span class="lineno"> 2387</span>&#160; *           output_results( </div><div class="line"><a name="l02388"></a><span class="lineno"> 2388</span>&#160; *             static_cast&lt;unsigned int&gt;(std::round(time / output_tick))); </div><div class="line"><a name="l02389"></a><span class="lineno"> 2389</span>&#160; *       } </div><div class="line"><a name="l02390"></a><span class="lineno"> 2390</span>&#160; * </div><div class="line"><a name="l02391"></a><span class="lineno"> 2391</span>&#160; *     timer.print_wall_time_statistics(MPI_COMM_WORLD); </div><div class="line"><a name="l02392"></a><span class="lineno"> 2392</span>&#160; *     pcout &lt;&lt; std::endl; </div><div class="line"><a name="l02393"></a><span class="lineno"> 2393</span>&#160; *   } </div><div class="line"><a name="l02394"></a><span class="lineno"> 2394</span>&#160; * </div><div class="line"><a name="l02395"></a><span class="lineno"> 2395</span>&#160; * } <span class="comment">// namespace Euler_DG </span></div><div class="line"><a name="l02396"></a><span class="lineno"> 2396</span>&#160; * </div><div class="line"><a name="l02397"></a><span class="lineno"> 2397</span>&#160; * <span class="keyword">@end</span>code</div><div class="line"><a name="l02398"></a><span class="lineno"> 2398</span>&#160; * </div><div class="line"><a name="l02399"></a><span class="lineno"> 2399</span>&#160; * main()函数并不令人惊讶，它遵循了以前所有MPI程序中的做法。当我们运行一个MPI程序时，我们需要调用`MPI_Init()`和`MPI_Finalize()`，我们通过 <a class="code" href="namespaceUtilities.html">Utilities</a>::MPI::MPI_InitFinalize 数据结构来完成。请注意，我们只用MPI来运行程序，并将线程数设置为1。</div><div class="line"><a name="l02400"></a><span class="lineno"> 2400</span>&#160; * </div><div class="line"><a name="l02401"></a><span class="lineno"> 2401</span>&#160;</div><div class="line"><a name="l02402"></a><span class="lineno"> 2402</span>&#160; * </div><div class="line"><a name="l02403"></a><span class="lineno"> 2403</span>&#160; * </div><div class="line"><a name="l02404"></a><span class="lineno"> 2404</span>&#160; * @code</div><div class="line"><a name="l02405"></a><span class="lineno"> 2405</span>&#160; * <span class="keywordtype">int</span> main(<span class="keywordtype">int</span> argc, <span class="keywordtype">char</span> **argv) </div><div class="line"><a name="l02406"></a><span class="lineno"> 2406</span>&#160; * { </div><div class="line"><a name="l02407"></a><span class="lineno"> 2407</span>&#160; *   <span class="keyword">using namespace </span>Euler_DG; </div><div class="line"><a name="l02408"></a><span class="lineno"> 2408</span>&#160; *   <span class="keyword">using namespace </span><a class="code" href="namespacedealii.html">dealii</a>; </div><div class="line"><a name="l02409"></a><span class="lineno"> 2409</span>&#160; * </div><div class="line"><a name="l02410"></a><span class="lineno"> 2410</span>&#160; *   <a class="code" href="classUtilities_1_1MPI_1_1MPI__InitFinalize.html">Utilities::MPI::MPI_InitFinalize</a> mpi_initialization(argc, argv, 1); </div><div class="line"><a name="l02411"></a><span class="lineno"> 2411</span>&#160; * </div><div class="line"><a name="l02412"></a><span class="lineno"> 2412</span>&#160; *   <span class="keywordflow">try</span> </div><div class="line"><a name="l02413"></a><span class="lineno"> 2413</span>&#160; *     { </div><div class="line"><a name="l02414"></a><span class="lineno"> 2414</span>&#160; *       <a class="code" href="logstream_8h.html#ac643e79bd992f1a9bd0dca5b9f2859fb">deallog</a>.<a class="code" href="classLogStream.html#a8028e970ad8388596d625ed463894e98">depth_console</a>(0); </div><div class="line"><a name="l02415"></a><span class="lineno"> 2415</span>&#160; * </div><div class="line"><a name="l02416"></a><span class="lineno"> 2416</span>&#160; *       EulerProblem&lt;dimension&gt; euler_problem; </div><div class="line"><a name="l02417"></a><span class="lineno"> 2417</span>&#160; *       euler_problem.run(); </div><div class="line"><a name="l02418"></a><span class="lineno"> 2418</span>&#160; *     } </div><div class="line"><a name="l02419"></a><span class="lineno"> 2419</span>&#160; *   <span class="keywordflow">catch</span> (std::exception &amp;exc) </div><div class="line"><a name="l02420"></a><span class="lineno"> 2420</span>&#160; *     { </div><div class="line"><a name="l02421"></a><span class="lineno"> 2421</span>&#160; *       std::cerr &lt;&lt; std::endl </div><div class="line"><a name="l02422"></a><span class="lineno"> 2422</span>&#160; *                 &lt;&lt; std::endl </div><div class="line"><a name="l02423"></a><span class="lineno"> 2423</span>&#160; *                 &lt;&lt; <span class="stringliteral">&quot;----------------------------------------------------&quot;</span> </div><div class="line"><a name="l02424"></a><span class="lineno"> 2424</span>&#160; *                 &lt;&lt; std::endl; </div><div class="line"><a name="l02425"></a><span class="lineno"> 2425</span>&#160; *       std::cerr &lt;&lt; <span class="stringliteral">&quot;Exception on processing: &quot;</span> &lt;&lt; std::endl </div><div class="line"><a name="l02426"></a><span class="lineno"> 2426</span>&#160; *                 &lt;&lt; exc.what() &lt;&lt; std::endl </div><div class="line"><a name="l02427"></a><span class="lineno"> 2427</span>&#160; *                 &lt;&lt; <span class="stringliteral">&quot;Aborting!&quot;</span> &lt;&lt; std::endl </div><div class="line"><a name="l02428"></a><span class="lineno"> 2428</span>&#160; *                 &lt;&lt; <span class="stringliteral">&quot;----------------------------------------------------&quot;</span> </div><div class="line"><a name="l02429"></a><span class="lineno"> 2429</span>&#160; *                 &lt;&lt; std::endl; </div><div class="line"><a name="l02430"></a><span class="lineno"> 2430</span>&#160; * </div><div class="line"><a name="l02431"></a><span class="lineno"> 2431</span>&#160; *       <span class="keywordflow">return</span> 1; </div><div class="line"><a name="l02432"></a><span class="lineno"> 2432</span>&#160; *     } </div><div class="line"><a name="l02433"></a><span class="lineno"> 2433</span>&#160; *   <span class="keywordflow">catch</span> (...) </div><div class="line"><a name="l02434"></a><span class="lineno"> 2434</span>&#160; *     { </div><div class="line"><a name="l02435"></a><span class="lineno"> 2435</span>&#160; *       std::cerr &lt;&lt; std::endl </div><div class="line"><a name="l02436"></a><span class="lineno"> 2436</span>&#160; *                 &lt;&lt; std::endl </div><div class="line"><a name="l02437"></a><span class="lineno"> 2437</span>&#160; *                 &lt;&lt; <span class="stringliteral">&quot;----------------------------------------------------&quot;</span> </div><div class="line"><a name="l02438"></a><span class="lineno"> 2438</span>&#160; *                 &lt;&lt; std::endl; </div><div class="line"><a name="l02439"></a><span class="lineno"> 2439</span>&#160; *       std::cerr &lt;&lt; <span class="stringliteral">&quot;Unknown exception!&quot;</span> &lt;&lt; std::endl </div><div class="line"><a name="l02440"></a><span class="lineno"> 2440</span>&#160; *                 &lt;&lt; <span class="stringliteral">&quot;Aborting!&quot;</span> &lt;&lt; std::endl </div><div class="line"><a name="l02441"></a><span class="lineno"> 2441</span>&#160; *                 &lt;&lt; <span class="stringliteral">&quot;----------------------------------------------------&quot;</span> </div><div class="line"><a name="l02442"></a><span class="lineno"> 2442</span>&#160; *                 &lt;&lt; std::endl; </div><div class="line"><a name="l02443"></a><span class="lineno"> 2443</span>&#160; *       <span class="keywordflow">return</span> 1; </div><div class="line"><a name="l02444"></a><span class="lineno"> 2444</span>&#160; *     } </div><div class="line"><a name="l02445"></a><span class="lineno"> 2445</span>&#160; * </div><div class="line"><a name="l02446"></a><span class="lineno"> 2446</span>&#160; *   <span class="keywordflow">return</span> 0; </div><div class="line"><a name="l02447"></a><span class="lineno"> 2447</span>&#160; * } </div><div class="line"><a name="l02448"></a><span class="lineno"> 2448</span>&#160; * </div><div class="line"><a name="l02449"></a><span class="lineno"> 2449</span>&#160; * </div><div class="line"><a name="l02450"></a><span class="lineno"> 2450</span>&#160; * <span class="keyword">@end</span>code</div><div class="line"><a name="l02451"></a><span class="lineno"> 2451</span>&#160;examples/step-67/doc/results.dox</div><div class="line"><a name="l02452"></a><span class="lineno"> 2452</span>&#160;</div><div class="line"><a name="l02453"></a><span class="lineno"> 2453</span>&#160;</div><div class="line"><a name="l02454"></a><span class="lineno"> 2454</span>&#160;</div><div class="line"><a name="l02455"></a><span class="lineno"> 2455</span>&#160;&lt;a name=<span class="stringliteral">&quot;Results&quot;</span>&gt;&lt;/a&gt;&lt;h1&gt;Results&lt;/h1&gt;</div><div class="line"><a name="l02456"></a><span class="lineno"> 2456</span>&#160;</div><div class="line"><a name="l02457"></a><span class="lineno"> 2457</span>&#160;</div><div class="line"><a name="l02458"></a><span class="lineno"> 2458</span>&#160;&lt;a name=<span class="stringliteral">&quot;Programoutput&quot;</span>&gt;&lt;/a&gt;&lt;h3&gt;Program output&lt;/h3&gt;</div><div class="line"><a name="l02459"></a><span class="lineno"> 2459</span>&#160;</div><div class="line"><a name="l02460"></a><span class="lineno"> 2460</span>&#160;</div><div class="line"><a name="l02461"></a><span class="lineno"> 2461</span>&#160;在一台有40个进程的机器上以默认设置运行该程序，会产生以下输出。</div><div class="line"><a name="l02462"></a><span class="lineno"> 2462</span>&#160;</div><div class="line"><a name="l02463"></a><span class="lineno"> 2463</span>&#160;@code</div><div class="line"><a name="l02464"></a><span class="lineno"> 2464</span>&#160;Running with 40 MPI processes</div><div class="line"><a name="l02465"></a><span class="lineno"> 2465</span>&#160;Vectorization over 8 doubles = 512 bits (AVX512)</div><div class="line"><a name="l02466"></a><span class="lineno"> 2466</span>&#160;Number of degrees of freedom: 147,456 ( = 4 [vars] x 1,024 [cells] x 36 [dofs/cell/var] )</div><div class="line"><a name="l02467"></a><span class="lineno"> 2467</span>&#160;Time step size: 0.00689325, minimal h: 0.3125, <a class="code" href="namespaceAlgorithms_1_1Events.html#a15a12dfdadd39a026d192ad96cb6207b">initial</a> transport scaling: 0.102759</div><div class="line"><a name="l02468"></a><span class="lineno"> 2468</span>&#160;</div><div class="line"><a name="l02469"></a><span class="lineno"> 2469</span>&#160;</div><div class="line"><a name="l02470"></a><span class="lineno"> 2470</span>&#160;Time:       0, dt:   0.0069, error rho:   2.76e-07, rho * u:  1.259e-06, energy: 2.987e-06</div><div class="line"><a name="l02471"></a><span class="lineno"> 2471</span>&#160;Time:    1.01, dt:   0.0069, error rho:   1.37e-06, rho * u:  2.252e-06, energy: 4.153e-06</div><div class="line"><a name="l02472"></a><span class="lineno"> 2472</span>&#160;Time:    2.01, dt:   0.0069, error rho:  1.561e-06, rho * u:   2.43e-06, energy: 4.493e-06</div><div class="line"><a name="l02473"></a><span class="lineno"> 2473</span>&#160;Time:    3.01, dt:   0.0069, error rho:  1.714e-06, rho * u:  2.591e-06, energy: 4.762e-06</div><div class="line"><a name="l02474"></a><span class="lineno"> 2474</span>&#160;Time:    4.01, dt:   0.0069, error rho:  1.843e-06, rho * u:  2.625e-06, energy: 4.985e-06</div><div class="line"><a name="l02475"></a><span class="lineno"> 2475</span>&#160;Time:    5.01, dt:   0.0069, error rho:  1.496e-06, rho * u:  1.961e-06, energy: 4.142e-06</div><div class="line"><a name="l02476"></a><span class="lineno"> 2476</span>&#160;Time:       6, dt:   0.0083, error rho:  1.007e-06, rho * u:  7.119e-07, energy: 2.972e-06</div><div class="line"><a name="l02477"></a><span class="lineno"> 2477</span>&#160;Time:       7, dt:   0.0095, error rho:  9.096e-07, rho * u:  3.786e-07, energy: 2.626e-06</div><div class="line"><a name="l02478"></a><span class="lineno"> 2478</span>&#160;Time:       8, dt:   0.0096, error rho:  8.439e-07, rho * u:  3.338e-07, energy:  2.43e-06</div><div class="line"><a name="l02479"></a><span class="lineno"> 2479</span>&#160;Time:       9, dt:   0.0096, error rho:  7.822e-07, rho * u:  2.984e-07, energy: 2.248e-06</div><div class="line"><a name="l02480"></a><span class="lineno"> 2480</span>&#160;Time:      10, dt:   0.0096, error rho:  7.231e-07, rho * u:  2.666e-07, energy: 2.074e-06</div><div class="line"><a name="l02481"></a><span class="lineno"> 2481</span>&#160;</div><div class="line"><a name="l02482"></a><span class="lineno"> 2482</span>&#160;</div><div class="line"><a name="l02483"></a><span class="lineno"> 2483</span>&#160;+-------------------------------------------+------------------+------------+------------------+</div><div class="line"><a name="l02484"></a><span class="lineno"> 2484</span>&#160;| Total wallclock time elapsed              |     2.249s    30 |     2.249s |     2.249s     8 |</div><div class="line"><a name="l02485"></a><span class="lineno"> 2485</span>&#160;|                                           |                  |                               |</div><div class="line"><a name="l02486"></a><span class="lineno"> 2486</span>&#160;| Section                       | no. calls |   <a class="code" href="namespaceVectorTools_1_1EvaluationFlags.html#ac6721740e24732d6afabcf28ddfc1ffdaeb244a97c0c9e9e7ca4765e096f0badc">min</a> time  rank |   <a class="code" href="namespaceVectorTools_1_1EvaluationFlags.html#ac6721740e24732d6afabcf28ddfc1ffdacc8b05748569f308550a239dc5b14396">avg</a> time |   <a class="code" href="namespaceVectorTools_1_1EvaluationFlags.html#ac6721740e24732d6afabcf28ddfc1ffda8e7f5b8545162dccd5ed717792bdf420">max</a> time  rank |</div><div class="line"><a name="l02487"></a><span class="lineno"> 2487</span>&#160;+-------------------------------------------+------------------+------------+------------------+</div><div class="line"><a name="l02488"></a><span class="lineno"> 2488</span>&#160;| compute errors                |        11 |  0.008066s    13 |   0.00952s |   0.01041s    20 |</div><div class="line"><a name="l02489"></a><span class="lineno"> 2489</span>&#160;| compute transport speed       |       258 |   0.01012s    13 |   0.05392s |   0.08574s    25 |</div><div class="line"><a name="l02490"></a><span class="lineno"> 2490</span>&#160;| output                        |        11 |    0.9597s    13 |    0.9613s |    0.9623s     6 |</div><div class="line"><a name="l02491"></a><span class="lineno"> 2491</span>&#160;| rk time stepping total        |      1283 |    0.9827s    25 |     1.015s |      1.06s    13 |</div><div class="line"><a name="l02492"></a><span class="lineno"> 2492</span>&#160;| rk_stage - integrals L_h      |      6415 |    0.8803s    26 |    0.9198s |    0.9619s    14 |</div><div class="line"><a name="l02493"></a><span class="lineno"> 2493</span>&#160;| rk_stage - inv mass + vec upd |      6415 |   0.05677s    15 |   0.06487s |   0.07597s    13 |</div><div class="line"><a name="l02494"></a><span class="lineno"> 2494</span>&#160;+-------------------------------------------+------------------+------------+------------------+</div><div class="line"><a name="l02495"></a><span class="lineno"> 2495</span>&#160;@endcode</div><div class="line"><a name="l02496"></a><span class="lineno"> 2496</span>&#160;</div><div class="line"><a name="l02497"></a><span class="lineno"> 2497</span>&#160;</div><div class="line"><a name="l02498"></a><span class="lineno"> 2498</span>&#160;</div><div class="line"><a name="l02499"></a><span class="lineno"> 2499</span>&#160;程序输出显示，所有的误差都很小。这是由于我们使用了一个相对较细的 @f$32^2@f$ 单元的网格，用5度的多项式来求得一个平滑的解决方案。一个有趣的模式显示在时间步长上：虽然在时间5之前是0.0069，但在后来的时间里增加到0.0096。在时间5和6.5之间，一旦在声速之上有一些运动的旋涡（因此传播速度更快）离开计算域，步长就会增加。在这之后，气流只是在同一方向上是均匀的，与之前均匀速度被漩涡覆盖的状态相比，气体的最大速度有所下降。我们的时间步长公式认识到了这种影响。</div><div class="line"><a name="l02500"></a><span class="lineno"> 2500</span>&#160;</div><div class="line"><a name="l02501"></a><span class="lineno"> 2501</span>&#160;最后一块输出显示了关于程序各个部分时间的详细信息；它通过显示最快和最慢的处理器所花费的时间以及平均时间将其分解开来--这在非常大的计算中通常很有用，可以发现是否有处理器持续过热（并因此节制其时钟速度）或因其他原因持续过慢。总结显示，在1.02秒内完成了1283个时间步骤（看所有MPI进程的平均时间），而11个文件的输出又花了0.96秒。将每个时间步数和五个Runge--Kutta阶段分解开来，每次评估的计算时间为0.16毫秒。这种高性能是无矩阵评估器的典型表现，也是显式时间积分对隐式求解器非常有竞争力的原因，特别是对于大规模模拟。程序运行结束时的计算时间细分显示， @f$\mathcal L_h@f$ 中的积分评估贡献了大约0.92秒，反质量矩阵的应用贡献了0.06秒。此外，对时间步长计算的运输速度的估计又贡献了0.05秒的计算时间。</div><div class="line"><a name="l02502"></a><span class="lineno"> 2502</span>&#160;</div><div class="line"><a name="l02503"></a><span class="lineno"> 2503</span>&#160;如果我们再使用三个级别的全局细化和总共940万个DoF，最终的统计数据如下（对于修改后的Lax--Friedrichs通量， @f$p=5@f$  ，和同一系统的40个核心的双插槽Intel Xeon Gold 6230）。</div><div class="line"><a name="l02504"></a><span class="lineno"> 2504</span>&#160;</div><div class="line"><a name="l02505"></a><span class="lineno"> 2505</span>&#160;@code</div><div class="line"><a name="l02506"></a><span class="lineno"> 2506</span>&#160;+-------------------------------------------+------------------+------------+------------------+</div><div class="line"><a name="l02507"></a><span class="lineno"> 2507</span>&#160;| Total wallclock time elapsed              |     244.9s    12 |     244.9s |     244.9s    34 |</div><div class="line"><a name="l02508"></a><span class="lineno"> 2508</span>&#160;|                                           |                  |                               |</div><div class="line"><a name="l02509"></a><span class="lineno"> 2509</span>&#160;| Section                       | no. calls |   <a class="code" href="namespaceVectorTools_1_1EvaluationFlags.html#ac6721740e24732d6afabcf28ddfc1ffdaeb244a97c0c9e9e7ca4765e096f0badc">min</a> time  rank |   <a class="code" href="namespaceVectorTools_1_1EvaluationFlags.html#ac6721740e24732d6afabcf28ddfc1ffdacc8b05748569f308550a239dc5b14396">avg</a> time |   <a class="code" href="namespaceVectorTools_1_1EvaluationFlags.html#ac6721740e24732d6afabcf28ddfc1ffda8e7f5b8545162dccd5ed717792bdf420">max</a> time  rank |</div><div class="line"><a name="l02510"></a><span class="lineno"> 2510</span>&#160;+-------------------------------------------+------------------+------------+------------------+</div><div class="line"><a name="l02511"></a><span class="lineno"> 2511</span>&#160;| compute errors                |        11 |    0.4239s    12 |    0.4318s |    0.4408s     9 |</div><div class="line"><a name="l02512"></a><span class="lineno"> 2512</span>&#160;| compute transport speed       |      2053 |     3.962s    12 |     6.727s |     10.12s     7 |</div><div class="line"><a name="l02513"></a><span class="lineno"> 2513</span>&#160;| output                        |        11 |     30.35s    12 |     30.36s |     30.37s     9 |</div><div class="line"><a name="l02514"></a><span class="lineno"> 2514</span>&#160;| rk time stepping total        |     10258 |     201.7s     7 |     205.1s |     207.8s    12 |</div><div class="line"><a name="l02515"></a><span class="lineno"> 2515</span>&#160;| rk_stage - integrals L_h      |     51290 |     121.3s     6 |     126.6s |     136.3s    16 |</div><div class="line"><a name="l02516"></a><span class="lineno"> 2516</span>&#160;| rk_stage - inv mass + vec upd |     51290 |     66.19s    16 |     77.52s |     81.84s    10 |</div><div class="line"><a name="l02517"></a><span class="lineno"> 2517</span>&#160;+-------------------------------------------+------------------+------------+------------------+</div><div class="line"><a name="l02518"></a><span class="lineno"> 2518</span>&#160;@endcode</div><div class="line"><a name="l02519"></a><span class="lineno"> 2519</span>&#160;</div><div class="line"><a name="l02520"></a><span class="lineno"> 2520</span>&#160;</div><div class="line"><a name="l02521"></a><span class="lineno"> 2521</span>&#160;</div><div class="line"><a name="l02522"></a><span class="lineno"> 2522</span>&#160;每个时间步长，求解器现在需要0.02秒，大约是147k未知数的小问题的25倍。鉴于该问题涉及64倍的未知数，计算时间的增加并不令人惊讶。由于我们也做了8倍的时间步数，计算时间在理论上应该增加512倍。实际增加的时间是205秒/1.02秒=202。这是因为由于通信开销的原因，小问题的规模不能充分利用40个核心。如果我们研究一下每个时间步长所做操作的细节，这一点就很清楚了。带有近邻通信的微分算子 @f$\mathcal L_h@f$ 的评估时间从0.92秒到127秒，也就是说，它增加了138倍。另一方面，应用反质量矩阵和向量更新的成本，完全不需要在MPI进程之间通信，增加了1195倍。这一增长超过了理论上的512倍，因为对于较大的尺寸，操作受限于RAM内存的带宽，而对于较小的尺寸，所有的矢量都适合于CPU的缓存。数字显示，尽管使用了低存储量的Runge-Kutta积分器和合并矢量操作，但质量矩阵评估和矢量更新部分几乎消耗了Runge-Kutta阶段所花费的40%的时间。而且尽管对 @f$\mathcal L_h@f$ 算子使用了过度积分。对于更简单的微分算子和更昂贵的时间积分器，花费在质量矩阵和矢量更新部分的比例也可以达到70%。如果我们以每秒处理的DoFs和Runge--Kutta阶段计算一个吞吐量数字，我们得到@f[ \text{throughput} =</div><div class="line"><a name="l02523"></a><span class="lineno"> 2523</span>&#160;\frac{n_\mathrm{time steps} n_\mathrm{stages}</div><div class="line"><a name="l02524"></a><span class="lineno"> 2524</span>&#160;n_\mathrm{dofs}}{t_\mathrm{compute}} = \frac{10258 \cdot 5 \cdot</div><div class="line"><a name="l02525"></a><span class="lineno"> 2525</span>&#160;9.4\,\text{MDoFs}}{205s} = 2360\, \text{MDoFs/s} @f]这个吞吐量数字非常高，因为简单地将一个向量复制到另一个向量的运行速度只有大约10,000 MDoFs/s。</div><div class="line"><a name="l02526"></a><span class="lineno"> 2526</span>&#160;</div><div class="line"><a name="l02527"></a><span class="lineno"> 2527</span>&#160;如果我们进入下一个更大的规模，有3770万个DoF，总的模拟时间是2196秒，其中1978秒用于时间步进。L_h算子的运行时间增加了9.3倍（1179秒对127秒），反质量矩阵和向量更新增加了10.3倍（797秒对77.5秒）。运行时间非最佳增长的原因可以追溯到给定硬件上的缓存效应（有40MB的二级缓存和55MB的三级缓存）。虽然不是所有的相关数据都适合940万DoF的缓存（一个向量需要75MB，我们有三个向量加上MatrixFree中的一些额外数据），但还是有能力满足一个半向量的需求。考虑到现代的缓存比天真的最近使用的策略更复杂（在这种情况下，我们几乎没有重复使用，因为数据是以类似流的方式使用的），我们可以假设，在940万DoFs的情况下，确实有相当一部分数据可以从缓存中交付。在更大的情况下，即使有最佳的缓存，也只有不到10%的数据可以放入缓存中，而且会有相关的性能损失。</div><div class="line"><a name="l02528"></a><span class="lineno"> 2528</span>&#160;</div><div class="line"><a name="l02529"></a><span class="lineno"> 2529</span>&#160;</div><div class="line"><a name="l02530"></a><span class="lineno"> 2530</span>&#160;</div><div class="line"><a name="l02531"></a><span class="lineno"> 2531</span>&#160;</div><div class="line"><a name="l02532"></a><span class="lineno"> 2532</span>&#160;&lt;a name=<span class="stringliteral">&quot;Convergenceratesfortheanalyticaltestcase&quot;</span>&gt;&lt;/a&gt;&lt;h3&gt;Convergence rates <span class="keywordflow">for</span> the analytical test <span class="keywordflow">case</span>&lt;/h3&gt;</div><div class="line"><a name="l02533"></a><span class="lineno"> 2533</span>&#160;</div><div class="line"><a name="l02534"></a><span class="lineno"> 2534</span>&#160;</div><div class="line"><a name="l02535"></a><span class="lineno"> 2535</span>&#160;对于修改后的Lax--Friedrichs通量和测量动量变量的误差，我们得到以下收敛表（密度和能量变量的速率非常相似）。</div><div class="line"><a name="l02536"></a><span class="lineno"> 2536</span>&#160;</div><div class="line"><a name="l02537"></a><span class="lineno"> 2537</span>&#160; &lt;table align=<span class="stringliteral">&quot;center&quot;</span> <span class="keyword">class</span>=<span class="stringliteral">&quot;doxtable&quot;</span>&gt;</div><div class="line"><a name="l02538"></a><span class="lineno"> 2538</span>&#160;  &lt;tr&gt;</div><div class="line"><a name="l02539"></a><span class="lineno"> 2539</span>&#160;    &lt;th&gt;&amp;nbsp;&lt;/th&gt;</div><div class="line"><a name="l02540"></a><span class="lineno"> 2540</span>&#160;    &lt;th colspan=<span class="stringliteral">&quot;3&quot;</span>&gt;&lt;i&gt;p&lt;/i&gt;=2&lt;/th&gt;</div><div class="line"><a name="l02541"></a><span class="lineno"> 2541</span>&#160;    &lt;th colspan=<span class="stringliteral">&quot;3&quot;</span>&gt;&lt;i&gt;p&lt;/i&gt;=3&lt;/th&gt;</div><div class="line"><a name="l02542"></a><span class="lineno"> 2542</span>&#160;    &lt;th colspan=<span class="stringliteral">&quot;3&quot;</span>&gt;&lt;i&gt;p&lt;/i&gt;=5&lt;/th&gt;</div><div class="line"><a name="l02543"></a><span class="lineno"> 2543</span>&#160;  &lt;/tr&gt;</div><div class="line"><a name="l02544"></a><span class="lineno"> 2544</span>&#160;  &lt;tr&gt;</div><div class="line"><a name="l02545"></a><span class="lineno"> 2545</span>&#160;    &lt;th&gt;<a class="code" href="namespaceinternal_1_1TriangulationImplementation.html#a9f815604be9b560fea00beef8d720480">n_cells</a>&lt;/th&gt;</div><div class="line"><a name="l02546"></a><span class="lineno"> 2546</span>&#160;    &lt;th&gt;n_dofs&lt;/th&gt;</div><div class="line"><a name="l02547"></a><span class="lineno"> 2547</span>&#160;    &lt;th&gt;error mom&lt;/th&gt;</div><div class="line"><a name="l02548"></a><span class="lineno"> 2548</span>&#160;    &lt;th&gt;rate&lt;/th&gt;</div><div class="line"><a name="l02549"></a><span class="lineno"> 2549</span>&#160;    &lt;th&gt;n_dofs&lt;/th&gt;</div><div class="line"><a name="l02550"></a><span class="lineno"> 2550</span>&#160;    &lt;th&gt;error mom&lt;/th&gt;</div><div class="line"><a name="l02551"></a><span class="lineno"> 2551</span>&#160;    &lt;th&gt;rate&lt;/th&gt;</div><div class="line"><a name="l02552"></a><span class="lineno"> 2552</span>&#160;    &lt;th&gt;n_dofs&lt;/th&gt;</div><div class="line"><a name="l02553"></a><span class="lineno"> 2553</span>&#160;    &lt;th&gt;error mom&lt;/th&gt;</div><div class="line"><a name="l02554"></a><span class="lineno"> 2554</span>&#160;    &lt;th&gt;rate&lt;/th&gt;</div><div class="line"><a name="l02555"></a><span class="lineno"> 2555</span>&#160;  &lt;/tr&gt;</div><div class="line"><a name="l02556"></a><span class="lineno"> 2556</span>&#160;  &lt;tr&gt;</div><div class="line"><a name="l02557"></a><span class="lineno"> 2557</span>&#160;    &lt;td align=<span class="stringliteral">&quot;right&quot;</span>&gt;16&lt;/td&gt;</div><div class="line"><a name="l02558"></a><span class="lineno"> 2558</span>&#160;    &lt;td&gt;&amp;nbsp;&lt;/td&gt;</div><div class="line"><a name="l02559"></a><span class="lineno"> 2559</span>&#160;    &lt;td&gt;&amp;nbsp;&lt;/td&gt;</div><div class="line"><a name="l02560"></a><span class="lineno"> 2560</span>&#160;    &lt;td&gt;&amp;nbsp;&lt;/td&gt;</div><div class="line"><a name="l02561"></a><span class="lineno"> 2561</span>&#160;    &lt;td&gt;&amp;nbsp;&lt;/td&gt;</div><div class="line"><a name="l02562"></a><span class="lineno"> 2562</span>&#160;    &lt;td&gt;&amp;nbsp;&lt;/td&gt;</div><div class="line"><a name="l02563"></a><span class="lineno"> 2563</span>&#160;    &lt;td&gt;&amp;nbsp;&lt;/td&gt;</div><div class="line"><a name="l02564"></a><span class="lineno"> 2564</span>&#160;    &lt;td align=<span class="stringliteral">&quot;right&quot;</span>&gt;2,304&lt;/td&gt;</div><div class="line"><a name="l02565"></a><span class="lineno"> 2565</span>&#160;    &lt;td align=<span class="stringliteral">&quot;center&quot;</span>&gt;1.373e-01&lt;/td&gt;</div><div class="line"><a name="l02566"></a><span class="lineno"> 2566</span>&#160;    &lt;td&gt;&amp;nbsp;&lt;/td&gt;</div><div class="line"><a name="l02567"></a><span class="lineno"> 2567</span>&#160;  &lt;/tr&gt;</div><div class="line"><a name="l02568"></a><span class="lineno"> 2568</span>&#160;  &lt;tr&gt;</div><div class="line"><a name="l02569"></a><span class="lineno"> 2569</span>&#160;    &lt;td align=<span class="stringliteral">&quot;right&quot;</span>&gt;64&lt;/td&gt;</div><div class="line"><a name="l02570"></a><span class="lineno"> 2570</span>&#160;    &lt;td&gt;&amp;nbsp;&lt;/td&gt;</div><div class="line"><a name="l02571"></a><span class="lineno"> 2571</span>&#160;    &lt;td&gt;&amp;nbsp;&lt;/td&gt;</div><div class="line"><a name="l02572"></a><span class="lineno"> 2572</span>&#160;    &lt;td&gt;&amp;nbsp;&lt;/td&gt;</div><div class="line"><a name="l02573"></a><span class="lineno"> 2573</span>&#160;    &lt;td align=<span class="stringliteral">&quot;right&quot;</span>&gt;4,096&lt;/td&gt;</div><div class="line"><a name="l02574"></a><span class="lineno"> 2574</span>&#160;    &lt;td align=<span class="stringliteral">&quot;center&quot;</span>&gt;9.130e-02&lt;/td&gt;</div><div class="line"><a name="l02575"></a><span class="lineno"> 2575</span>&#160;    &lt;td&gt;&amp;nbsp;&lt;/td&gt;</div><div class="line"><a name="l02576"></a><span class="lineno"> 2576</span>&#160;    &lt;td align=<span class="stringliteral">&quot;right&quot;</span>&gt;9,216&lt;/td&gt;</div><div class="line"><a name="l02577"></a><span class="lineno"> 2577</span>&#160;    &lt;td align=<span class="stringliteral">&quot;center&quot;</span>&gt;8.899e-03&lt;/td&gt;</div><div class="line"><a name="l02578"></a><span class="lineno"> 2578</span>&#160;    &lt;td&gt;3.94&lt;/td&gt;</div><div class="line"><a name="l02579"></a><span class="lineno"> 2579</span>&#160;  &lt;/tr&gt;</div><div class="line"><a name="l02580"></a><span class="lineno"> 2580</span>&#160;  &lt;tr&gt;</div><div class="line"><a name="l02581"></a><span class="lineno"> 2581</span>&#160;    &lt;td align=<span class="stringliteral">&quot;right&quot;</span>&gt;256&lt;/td&gt;</div><div class="line"><a name="l02582"></a><span class="lineno"> 2582</span>&#160;    &lt;td align=<span class="stringliteral">&quot;right&quot;</span>&gt;9,216&lt;/td&gt;</div><div class="line"><a name="l02583"></a><span class="lineno"> 2583</span>&#160;    &lt;td align=<span class="stringliteral">&quot;center&quot;</span>&gt;5.577e-02&lt;/td&gt;</div><div class="line"><a name="l02584"></a><span class="lineno"> 2584</span>&#160;    &lt;td&gt;&amp;nbsp;&lt;/td&gt;</div><div class="line"><a name="l02585"></a><span class="lineno"> 2585</span>&#160;    &lt;td align=<span class="stringliteral">&quot;right&quot;</span>&gt;16,384&lt;/td&gt;</div><div class="line"><a name="l02586"></a><span class="lineno"> 2586</span>&#160;    &lt;td align=<span class="stringliteral">&quot;center&quot;</span>&gt;7.381e-03&lt;/td&gt;</div><div class="line"><a name="l02587"></a><span class="lineno"> 2587</span>&#160;    &lt;td&gt;3.64&lt;/td&gt;</div><div class="line"><a name="l02588"></a><span class="lineno"> 2588</span>&#160;    &lt;td align=<span class="stringliteral">&quot;right&quot;</span>&gt;36,864&lt;/td&gt;</div><div class="line"><a name="l02589"></a><span class="lineno"> 2589</span>&#160;    &lt;td align=<span class="stringliteral">&quot;center&quot;</span>&gt;2.082e-04&lt;/td&gt;</div><div class="line"><a name="l02590"></a><span class="lineno"> 2590</span>&#160;    &lt;td&gt;5.42&lt;/td&gt;</div><div class="line"><a name="l02591"></a><span class="lineno"> 2591</span>&#160;  &lt;/tr&gt;</div><div class="line"><a name="l02592"></a><span class="lineno"> 2592</span>&#160;  &lt;tr&gt;</div><div class="line"><a name="l02593"></a><span class="lineno"> 2593</span>&#160;    &lt;td align=<span class="stringliteral">&quot;right&quot;</span>&gt;1024&lt;/td&gt;</div><div class="line"><a name="l02594"></a><span class="lineno"> 2594</span>&#160;    &lt;td align=<span class="stringliteral">&quot;right&quot;</span>&gt;36,864&lt;/td&gt;</div><div class="line"><a name="l02595"></a><span class="lineno"> 2595</span>&#160;    &lt;td align=<span class="stringliteral">&quot;center&quot;</span>&gt;4.724e-03&lt;/td&gt;</div><div class="line"><a name="l02596"></a><span class="lineno"> 2596</span>&#160;    &lt;td&gt;3.56&lt;/td&gt;</div><div class="line"><a name="l02597"></a><span class="lineno"> 2597</span>&#160;    &lt;td align=<span class="stringliteral">&quot;right&quot;</span>&gt;65,536&lt;/td&gt;</div><div class="line"><a name="l02598"></a><span class="lineno"> 2598</span>&#160;    &lt;td align=<span class="stringliteral">&quot;center&quot;</span>&gt;3.072e-04&lt;/td&gt;</div><div class="line"><a name="l02599"></a><span class="lineno"> 2599</span>&#160;    &lt;td&gt;4.59&lt;/td&gt;</div><div class="line"><a name="l02600"></a><span class="lineno"> 2600</span>&#160;    &lt;td align=<span class="stringliteral">&quot;right&quot;</span>&gt;147,456&lt;/td&gt;</div><div class="line"><a name="l02601"></a><span class="lineno"> 2601</span>&#160;    &lt;td align=<span class="stringliteral">&quot;center&quot;</span>&gt;2.625e-06&lt;/td&gt;</div><div class="line"><a name="l02602"></a><span class="lineno"> 2602</span>&#160;    &lt;td&gt;6.31&lt;/td&gt;</div><div class="line"><a name="l02603"></a><span class="lineno"> 2603</span>&#160;  &lt;/tr&gt;</div><div class="line"><a name="l02604"></a><span class="lineno"> 2604</span>&#160;  &lt;tr&gt;</div><div class="line"><a name="l02605"></a><span class="lineno"> 2605</span>&#160;    &lt;td align=<span class="stringliteral">&quot;right&quot;</span>&gt;4096&lt;/td&gt;</div><div class="line"><a name="l02606"></a><span class="lineno"> 2606</span>&#160;    &lt;td align=<span class="stringliteral">&quot;right&quot;</span>&gt;147,456&lt;/td&gt;</div><div class="line"><a name="l02607"></a><span class="lineno"> 2607</span>&#160;    &lt;td align=<span class="stringliteral">&quot;center&quot;</span>&gt;6.205e-04&lt;/td&gt;</div><div class="line"><a name="l02608"></a><span class="lineno"> 2608</span>&#160;    &lt;td&gt;2.92&lt;/td&gt;</div><div class="line"><a name="l02609"></a><span class="lineno"> 2609</span>&#160;    &lt;td align=<span class="stringliteral">&quot;right&quot;</span>&gt;262,144&lt;/td&gt;</div><div class="line"><a name="l02610"></a><span class="lineno"> 2610</span>&#160;    &lt;td align=<span class="stringliteral">&quot;center&quot;</span>&gt;1.880e-05&lt;/td&gt;</div><div class="line"><a name="l02611"></a><span class="lineno"> 2611</span>&#160;    &lt;td&gt;4.03&lt;/td&gt;</div><div class="line"><a name="l02612"></a><span class="lineno"> 2612</span>&#160;    &lt;td align=<span class="stringliteral">&quot;right&quot;</span>&gt;589,824&lt;/td&gt;</div><div class="line"><a name="l02613"></a><span class="lineno"> 2613</span>&#160;    &lt;td align=<span class="stringliteral">&quot;center&quot;</span>&gt;3.268e-08&lt;/td&gt;</div><div class="line"><a name="l02614"></a><span class="lineno"> 2614</span>&#160;    &lt;td&gt;6.33&lt;/td&gt;</div><div class="line"><a name="l02615"></a><span class="lineno"> 2615</span>&#160;  &lt;/tr&gt;</div><div class="line"><a name="l02616"></a><span class="lineno"> 2616</span>&#160;  &lt;tr&gt;</div><div class="line"><a name="l02617"></a><span class="lineno"> 2617</span>&#160;    &lt;td align=<span class="stringliteral">&quot;right&quot;</span>&gt;16,384&lt;/td&gt;</div><div class="line"><a name="l02618"></a><span class="lineno"> 2618</span>&#160;    &lt;td align=<span class="stringliteral">&quot;right&quot;</span>&gt;589,824&lt;/td&gt;</div><div class="line"><a name="l02619"></a><span class="lineno"> 2619</span>&#160;    &lt;td align=<span class="stringliteral">&quot;center&quot;</span>&gt;8.279e-05&lt;/td&gt;</div><div class="line"><a name="l02620"></a><span class="lineno"> 2620</span>&#160;    &lt;td&gt;2.91&lt;/td&gt;</div><div class="line"><a name="l02621"></a><span class="lineno"> 2621</span>&#160;    &lt;td align=<span class="stringliteral">&quot;right&quot;</span>&gt;1,048,576&lt;/td&gt;</div><div class="line"><a name="l02622"></a><span class="lineno"> 2622</span>&#160;    &lt;td align=<span class="stringliteral">&quot;center&quot;</span>&gt;1.224e-06&lt;/td&gt;</div><div class="line"><a name="l02623"></a><span class="lineno"> 2623</span>&#160;    &lt;td&gt;3.94&lt;/td&gt;</div><div class="line"><a name="l02624"></a><span class="lineno"> 2624</span>&#160;    &lt;td align=<span class="stringliteral">&quot;right&quot;</span>&gt;2,359,296&lt;/td&gt;</div><div class="line"><a name="l02625"></a><span class="lineno"> 2625</span>&#160;    &lt;td align=<span class="stringliteral">&quot;center&quot;</span>&gt;9.252e-10&lt;/td&gt;</div><div class="line"><a name="l02626"></a><span class="lineno"> 2626</span>&#160;    &lt;td&gt;5.14&lt;/td&gt;</div><div class="line"><a name="l02627"></a><span class="lineno"> 2627</span>&#160;  &lt;/tr&gt;</div><div class="line"><a name="l02628"></a><span class="lineno"> 2628</span>&#160;  &lt;tr&gt;</div><div class="line"><a name="l02629"></a><span class="lineno"> 2629</span>&#160;    &lt;td align=<span class="stringliteral">&quot;right&quot;</span>&gt;65,536&lt;/td&gt;</div><div class="line"><a name="l02630"></a><span class="lineno"> 2630</span>&#160;    &lt;td align=<span class="stringliteral">&quot;right&quot;</span>&gt;2,359,296&lt;/td&gt;</div><div class="line"><a name="l02631"></a><span class="lineno"> 2631</span>&#160;    &lt;td align=<span class="stringliteral">&quot;center&quot;</span>&gt;1.105e-05&lt;/td&gt;</div><div class="line"><a name="l02632"></a><span class="lineno"> 2632</span>&#160;    &lt;td&gt;2.91&lt;/td&gt;</div><div class="line"><a name="l02633"></a><span class="lineno"> 2633</span>&#160;    &lt;td align=<span class="stringliteral">&quot;right&quot;</span>&gt;4,194,304&lt;/td&gt;</div><div class="line"><a name="l02634"></a><span class="lineno"> 2634</span>&#160;    &lt;td align=<span class="stringliteral">&quot;center&quot;</span>&gt;7.871e-08&lt;/td&gt;</div><div class="line"><a name="l02635"></a><span class="lineno"> 2635</span>&#160;    &lt;td&gt;3.96&lt;/td&gt;</div><div class="line"><a name="l02636"></a><span class="lineno"> 2636</span>&#160;    &lt;td align=<span class="stringliteral">&quot;right&quot;</span>&gt;9,437,184&lt;/td&gt;</div><div class="line"><a name="l02637"></a><span class="lineno"> 2637</span>&#160;    &lt;td align=<span class="stringliteral">&quot;center&quot;</span>&gt;1.369e-10&lt;/td&gt;</div><div class="line"><a name="l02638"></a><span class="lineno"> 2638</span>&#160;    &lt;td&gt;2.77&lt;/td&gt;</div><div class="line"><a name="l02639"></a><span class="lineno"> 2639</span>&#160;  &lt;/tr&gt;</div><div class="line"><a name="l02640"></a><span class="lineno"> 2640</span>&#160;  &lt;tr&gt;</div><div class="line"><a name="l02641"></a><span class="lineno"> 2641</span>&#160;    &lt;td align=<span class="stringliteral">&quot;right&quot;</span>&gt;262,144&lt;/td&gt;</div><div class="line"><a name="l02642"></a><span class="lineno"> 2642</span>&#160;    &lt;td align=<span class="stringliteral">&quot;right&quot;</span>&gt;9,437,184&lt;/td&gt;</div><div class="line"><a name="l02643"></a><span class="lineno"> 2643</span>&#160;    &lt;td align=<span class="stringliteral">&quot;center&quot;</span>&gt;1.615e-06&lt;/td&gt;</div><div class="line"><a name="l02644"></a><span class="lineno"> 2644</span>&#160;    &lt;td&gt;2.77&lt;/td&gt;</div><div class="line"><a name="l02645"></a><span class="lineno"> 2645</span>&#160;    &lt;td align=<span class="stringliteral">&quot;right&quot;</span>&gt;16,777,216&lt;/td&gt;</div><div class="line"><a name="l02646"></a><span class="lineno"> 2646</span>&#160;    &lt;td align=<span class="stringliteral">&quot;center&quot;</span>&gt;4.961e-09&lt;/td&gt;</div><div class="line"><a name="l02647"></a><span class="lineno"> 2647</span>&#160;    &lt;td&gt;3.99&lt;/td&gt;</div><div class="line"><a name="l02648"></a><span class="lineno"> 2648</span>&#160;    &lt;td align=<span class="stringliteral">&quot;right&quot;</span>&gt;37,748,736&lt;/td&gt;</div><div class="line"><a name="l02649"></a><span class="lineno"> 2649</span>&#160;    &lt;td align=<span class="stringliteral">&quot;center&quot;</span>&gt;7.091e-11&lt;/td&gt;</div><div class="line"><a name="l02650"></a><span class="lineno"> 2650</span>&#160;    &lt;td&gt;0.95&lt;/td&gt;</div><div class="line"><a name="l02651"></a><span class="lineno"> 2651</span>&#160;  &lt;/tr&gt;</div><div class="line"><a name="l02652"></a><span class="lineno"> 2652</span>&#160;&lt;/table&gt; </div><div class="line"><a name="l02653"></a><span class="lineno"> 2653</span>&#160;</div><div class="line"><a name="l02654"></a><span class="lineno"> 2654</span>&#160;如果我们改用Harten-Lax-van Leer通量，结果如下。   &lt;table align=<span class="stringliteral">&quot;center&quot;</span> <span class="keyword">class</span>=<span class="stringliteral">&quot;doxtable&quot;</span>&gt;</div><div class="line"><a name="l02655"></a><span class="lineno"> 2655</span>&#160;  &lt;tr&gt;</div><div class="line"><a name="l02656"></a><span class="lineno"> 2656</span>&#160;    &lt;th&gt;&amp;nbsp;&lt;/th&gt;</div><div class="line"><a name="l02657"></a><span class="lineno"> 2657</span>&#160;    &lt;th colspan=<span class="stringliteral">&quot;3&quot;</span>&gt;&lt;i&gt;p&lt;/i&gt;=2&lt;/th&gt;</div><div class="line"><a name="l02658"></a><span class="lineno"> 2658</span>&#160;    &lt;th colspan=<span class="stringliteral">&quot;3&quot;</span>&gt;&lt;i&gt;p&lt;/i&gt;=3&lt;/th&gt;</div><div class="line"><a name="l02659"></a><span class="lineno"> 2659</span>&#160;    &lt;th colspan=<span class="stringliteral">&quot;3&quot;</span>&gt;&lt;i&gt;p&lt;/i&gt;=5&lt;/th&gt;</div><div class="line"><a name="l02660"></a><span class="lineno"> 2660</span>&#160;  &lt;/tr&gt;</div><div class="line"><a name="l02661"></a><span class="lineno"> 2661</span>&#160;  &lt;tr&gt;</div><div class="line"><a name="l02662"></a><span class="lineno"> 2662</span>&#160;    &lt;th&gt;<a class="code" href="namespaceinternal_1_1TriangulationImplementation.html#a9f815604be9b560fea00beef8d720480">n_cells</a>&lt;/th&gt;</div><div class="line"><a name="l02663"></a><span class="lineno"> 2663</span>&#160;    &lt;th&gt;n_dofs&lt;/th&gt;</div><div class="line"><a name="l02664"></a><span class="lineno"> 2664</span>&#160;    &lt;th&gt;error mom&lt;/th&gt;</div><div class="line"><a name="l02665"></a><span class="lineno"> 2665</span>&#160;    &lt;th&gt;rate&lt;/th&gt;</div><div class="line"><a name="l02666"></a><span class="lineno"> 2666</span>&#160;    &lt;th&gt;n_dofs&lt;/th&gt;</div><div class="line"><a name="l02667"></a><span class="lineno"> 2667</span>&#160;    &lt;th&gt;error mom&lt;/th&gt;</div><div class="line"><a name="l02668"></a><span class="lineno"> 2668</span>&#160;    &lt;th&gt;rate&lt;/th&gt;</div><div class="line"><a name="l02669"></a><span class="lineno"> 2669</span>&#160;    &lt;th&gt;n_dofs&lt;/th&gt;</div><div class="line"><a name="l02670"></a><span class="lineno"> 2670</span>&#160;    &lt;th&gt;error mom&lt;/th&gt;</div><div class="line"><a name="l02671"></a><span class="lineno"> 2671</span>&#160;    &lt;th&gt;rate&lt;/th&gt;</div><div class="line"><a name="l02672"></a><span class="lineno"> 2672</span>&#160;  &lt;/tr&gt;</div><div class="line"><a name="l02673"></a><span class="lineno"> 2673</span>&#160;  &lt;tr&gt;</div><div class="line"><a name="l02674"></a><span class="lineno"> 2674</span>&#160;    &lt;td align=<span class="stringliteral">&quot;right&quot;</span>&gt;16&lt;/td&gt;</div><div class="line"><a name="l02675"></a><span class="lineno"> 2675</span>&#160;    &lt;td&gt;&amp;nbsp;&lt;/td&gt;</div><div class="line"><a name="l02676"></a><span class="lineno"> 2676</span>&#160;    &lt;td&gt;&amp;nbsp;&lt;/td&gt;</div><div class="line"><a name="l02677"></a><span class="lineno"> 2677</span>&#160;    &lt;td&gt;&amp;nbsp;&lt;/td&gt;</div><div class="line"><a name="l02678"></a><span class="lineno"> 2678</span>&#160;    &lt;td&gt;&amp;nbsp;&lt;/td&gt;</div><div class="line"><a name="l02679"></a><span class="lineno"> 2679</span>&#160;    &lt;td&gt;&amp;nbsp;&lt;/td&gt;</div><div class="line"><a name="l02680"></a><span class="lineno"> 2680</span>&#160;    &lt;td&gt;&amp;nbsp;&lt;/td&gt;</div><div class="line"><a name="l02681"></a><span class="lineno"> 2681</span>&#160;    &lt;td align=<span class="stringliteral">&quot;right&quot;</span>&gt;2,304&lt;/td&gt;</div><div class="line"><a name="l02682"></a><span class="lineno"> 2682</span>&#160;    &lt;td align=<span class="stringliteral">&quot;center&quot;</span>&gt;1.339e-01&lt;/td&gt;</div><div class="line"><a name="l02683"></a><span class="lineno"> 2683</span>&#160;    &lt;td&gt;&amp;nbsp;&lt;/td&gt;</div><div class="line"><a name="l02684"></a><span class="lineno"> 2684</span>&#160;  &lt;/tr&gt;</div><div class="line"><a name="l02685"></a><span class="lineno"> 2685</span>&#160;  &lt;tr&gt;</div><div class="line"><a name="l02686"></a><span class="lineno"> 2686</span>&#160;    &lt;td align=<span class="stringliteral">&quot;right&quot;</span>&gt;64&lt;/td&gt;</div><div class="line"><a name="l02687"></a><span class="lineno"> 2687</span>&#160;    &lt;td&gt;&amp;nbsp;&lt;/td&gt;</div><div class="line"><a name="l02688"></a><span class="lineno"> 2688</span>&#160;    &lt;td&gt;&amp;nbsp;&lt;/td&gt;</div><div class="line"><a name="l02689"></a><span class="lineno"> 2689</span>&#160;    &lt;td&gt;&amp;nbsp;&lt;/td&gt;</div><div class="line"><a name="l02690"></a><span class="lineno"> 2690</span>&#160;    &lt;td align=<span class="stringliteral">&quot;right&quot;</span>&gt;4,096&lt;/td&gt;</div><div class="line"><a name="l02691"></a><span class="lineno"> 2691</span>&#160;    &lt;td align=<span class="stringliteral">&quot;center&quot;</span>&gt;9.037e-02&lt;/td&gt;</div><div class="line"><a name="l02692"></a><span class="lineno"> 2692</span>&#160;    &lt;td&gt;&amp;nbsp;&lt;/td&gt;</div><div class="line"><a name="l02693"></a><span class="lineno"> 2693</span>&#160;    &lt;td align=<span class="stringliteral">&quot;right&quot;</span>&gt;9,216&lt;/td&gt;</div><div class="line"><a name="l02694"></a><span class="lineno"> 2694</span>&#160;    &lt;td align=<span class="stringliteral">&quot;center&quot;</span>&gt;8.849e-03&lt;/td&gt;</div><div class="line"><a name="l02695"></a><span class="lineno"> 2695</span>&#160;    &lt;td&gt;3.92&lt;/td&gt;</div><div class="line"><a name="l02696"></a><span class="lineno"> 2696</span>&#160;  &lt;/tr&gt;</div><div class="line"><a name="l02697"></a><span class="lineno"> 2697</span>&#160;  &lt;tr&gt;</div><div class="line"><a name="l02698"></a><span class="lineno"> 2698</span>&#160;    &lt;td align=<span class="stringliteral">&quot;right&quot;</span>&gt;256&lt;/td&gt;</div><div class="line"><a name="l02699"></a><span class="lineno"> 2699</span>&#160;    &lt;td align=<span class="stringliteral">&quot;right&quot;</span>&gt;9,216&lt;/td&gt;</div><div class="line"><a name="l02700"></a><span class="lineno"> 2700</span>&#160;    &lt;td align=<span class="stringliteral">&quot;center&quot;</span>&gt;4.204e-02&lt;/td&gt;</div><div class="line"><a name="l02701"></a><span class="lineno"> 2701</span>&#160;    &lt;td&gt;&amp;nbsp;&lt;/td&gt;</div><div class="line"><a name="l02702"></a><span class="lineno"> 2702</span>&#160;    &lt;td align=<span class="stringliteral">&quot;right&quot;</span>&gt;16,384&lt;/td&gt;</div><div class="line"><a name="l02703"></a><span class="lineno"> 2703</span>&#160;    &lt;td align=<span class="stringliteral">&quot;center&quot;</span>&gt;9.143e-03&lt;/td&gt;</div><div class="line"><a name="l02704"></a><span class="lineno"> 2704</span>&#160;    &lt;td&gt;3.31&lt;/td&gt;</div><div class="line"><a name="l02705"></a><span class="lineno"> 2705</span>&#160;    &lt;td align=<span class="stringliteral">&quot;right&quot;</span>&gt;36,864&lt;/td&gt;</div><div class="line"><a name="l02706"></a><span class="lineno"> 2706</span>&#160;    &lt;td align=<span class="stringliteral">&quot;center&quot;</span>&gt;2.501e-04&lt;/td&gt;</div><div class="line"><a name="l02707"></a><span class="lineno"> 2707</span>&#160;    &lt;td&gt;5.14&lt;/td&gt;</div><div class="line"><a name="l02708"></a><span class="lineno"> 2708</span>&#160;  &lt;/tr&gt;</div><div class="line"><a name="l02709"></a><span class="lineno"> 2709</span>&#160;  &lt;tr&gt;</div><div class="line"><a name="l02710"></a><span class="lineno"> 2710</span>&#160;    &lt;td align=<span class="stringliteral">&quot;right&quot;</span>&gt;1024&lt;/td&gt;</div><div class="line"><a name="l02711"></a><span class="lineno"> 2711</span>&#160;    &lt;td align=<span class="stringliteral">&quot;right&quot;</span>&gt;36,864&lt;/td&gt;</div><div class="line"><a name="l02712"></a><span class="lineno"> 2712</span>&#160;    &lt;td align=<span class="stringliteral">&quot;center&quot;</span>&gt;4.913e-03&lt;/td&gt;</div><div class="line"><a name="l02713"></a><span class="lineno"> 2713</span>&#160;    &lt;td&gt;3.09&lt;/td&gt;</div><div class="line"><a name="l02714"></a><span class="lineno"> 2714</span>&#160;    &lt;td align=<span class="stringliteral">&quot;right&quot;</span>&gt;65,536&lt;/td&gt;</div><div class="line"><a name="l02715"></a><span class="lineno"> 2715</span>&#160;    &lt;td align=<span class="stringliteral">&quot;center&quot;</span>&gt;3.257e-04&lt;/td&gt;</div><div class="line"><a name="l02716"></a><span class="lineno"> 2716</span>&#160;    &lt;td&gt;4.81&lt;/td&gt;</div><div class="line"><a name="l02717"></a><span class="lineno"> 2717</span>&#160;    &lt;td align=<span class="stringliteral">&quot;right&quot;</span>&gt;147,456&lt;/td&gt;</div><div class="line"><a name="l02718"></a><span class="lineno"> 2718</span>&#160;    &lt;td align=<span class="stringliteral">&quot;center&quot;</span>&gt;3.260e-06&lt;/td&gt;</div><div class="line"><a name="l02719"></a><span class="lineno"> 2719</span>&#160;    &lt;td&gt;6.26&lt;/td&gt;</div><div class="line"><a name="l02720"></a><span class="lineno"> 2720</span>&#160;  &lt;/tr&gt;</div><div class="line"><a name="l02721"></a><span class="lineno"> 2721</span>&#160;  &lt;tr&gt;</div><div class="line"><a name="l02722"></a><span class="lineno"> 2722</span>&#160;    &lt;td align=<span class="stringliteral">&quot;right&quot;</span>&gt;4096&lt;/td&gt;</div><div class="line"><a name="l02723"></a><span class="lineno"> 2723</span>&#160;    &lt;td align=<span class="stringliteral">&quot;right&quot;</span>&gt;147,456&lt;/td&gt;</div><div class="line"><a name="l02724"></a><span class="lineno"> 2724</span>&#160;    &lt;td align=<span class="stringliteral">&quot;center&quot;</span>&gt;7.862e-04&lt;/td&gt;</div><div class="line"><a name="l02725"></a><span class="lineno"> 2725</span>&#160;    &lt;td&gt;2.64&lt;/td&gt;</div><div class="line"><a name="l02726"></a><span class="lineno"> 2726</span>&#160;    &lt;td align=<span class="stringliteral">&quot;right&quot;</span>&gt;262,144&lt;/td&gt;</div><div class="line"><a name="l02727"></a><span class="lineno"> 2727</span>&#160;    &lt;td align=<span class="stringliteral">&quot;center&quot;</span>&gt;1.588e-05&lt;/td&gt;</div><div class="line"><a name="l02728"></a><span class="lineno"> 2728</span>&#160;    &lt;td&gt;4.36&lt;/td&gt;</div><div class="line"><a name="l02729"></a><span class="lineno"> 2729</span>&#160;    &lt;td align=<span class="stringliteral">&quot;right&quot;</span>&gt;589,824&lt;/td&gt;</div><div class="line"><a name="l02730"></a><span class="lineno"> 2730</span>&#160;    &lt;td align=<span class="stringliteral">&quot;center&quot;</span>&gt;2.953e-08&lt;/td&gt;</div><div class="line"><a name="l02731"></a><span class="lineno"> 2731</span>&#160;    &lt;td&gt;6.79&lt;/td&gt;</div><div class="line"><a name="l02732"></a><span class="lineno"> 2732</span>&#160;  &lt;/tr&gt;</div><div class="line"><a name="l02733"></a><span class="lineno"> 2733</span>&#160;  &lt;tr&gt;</div><div class="line"><a name="l02734"></a><span class="lineno"> 2734</span>&#160;    &lt;td align=<span class="stringliteral">&quot;right&quot;</span>&gt;16,384&lt;/td&gt;</div><div class="line"><a name="l02735"></a><span class="lineno"> 2735</span>&#160;    &lt;td align=<span class="stringliteral">&quot;right&quot;</span>&gt;589,824&lt;/td&gt;</div><div class="line"><a name="l02736"></a><span class="lineno"> 2736</span>&#160;    &lt;td align=<span class="stringliteral">&quot;center&quot;</span>&gt;1.137e-04&lt;/td&gt;</div><div class="line"><a name="l02737"></a><span class="lineno"> 2737</span>&#160;    &lt;td&gt;2.79&lt;/td&gt;</div><div class="line"><a name="l02738"></a><span class="lineno"> 2738</span>&#160;    &lt;td align=<span class="stringliteral">&quot;right&quot;</span>&gt;1,048,576&lt;/td&gt;</div><div class="line"><a name="l02739"></a><span class="lineno"> 2739</span>&#160;    &lt;td align=<span class="stringliteral">&quot;center&quot;</span>&gt;9.400e-07&lt;/td&gt;</div><div class="line"><a name="l02740"></a><span class="lineno"> 2740</span>&#160;    &lt;td&gt;4.08&lt;/td&gt;</div><div class="line"><a name="l02741"></a><span class="lineno"> 2741</span>&#160;    &lt;td align=<span class="stringliteral">&quot;right&quot;</span>&gt;2,359,296&lt;/td&gt;</div><div class="line"><a name="l02742"></a><span class="lineno"> 2742</span>&#160;    &lt;td align=<span class="stringliteral">&quot;center&quot;</span>&gt;4.286e-10&lt;/td&gt;</div><div class="line"><a name="l02743"></a><span class="lineno"> 2743</span>&#160;    &lt;td&gt;6.11&lt;/td&gt;</div><div class="line"><a name="l02744"></a><span class="lineno"> 2744</span>&#160;  &lt;/tr&gt;</div><div class="line"><a name="l02745"></a><span class="lineno"> 2745</span>&#160;  &lt;tr&gt;</div><div class="line"><a name="l02746"></a><span class="lineno"> 2746</span>&#160;    &lt;td align=<span class="stringliteral">&quot;right&quot;</span>&gt;65,536&lt;/td&gt;</div><div class="line"><a name="l02747"></a><span class="lineno"> 2747</span>&#160;    &lt;td align=<span class="stringliteral">&quot;right&quot;</span>&gt;2,359,296&lt;/td&gt;</div><div class="line"><a name="l02748"></a><span class="lineno"> 2748</span>&#160;    &lt;td align=<span class="stringliteral">&quot;center&quot;</span>&gt;1.476e-05&lt;/td&gt;</div><div class="line"><a name="l02749"></a><span class="lineno"> 2749</span>&#160;    &lt;td&gt;2.95&lt;/td&gt;</div><div class="line"><a name="l02750"></a><span class="lineno"> 2750</span>&#160;    &lt;td align=<span class="stringliteral">&quot;right&quot;</span>&gt;4,194,304&lt;/td&gt;</div><div class="line"><a name="l02751"></a><span class="lineno"> 2751</span>&#160;    &lt;td align=<span class="stringliteral">&quot;center&quot;</span>&gt;5.799e-08&lt;/td&gt;</div><div class="line"><a name="l02752"></a><span class="lineno"> 2752</span>&#160;    &lt;td&gt;4.02&lt;/td&gt;</div><div class="line"><a name="l02753"></a><span class="lineno"> 2753</span>&#160;    &lt;td align=<span class="stringliteral">&quot;right&quot;</span>&gt;9,437,184&lt;/td&gt;</div><div class="line"><a name="l02754"></a><span class="lineno"> 2754</span>&#160;    &lt;td align=<span class="stringliteral">&quot;center&quot;</span>&gt;2.789e-11&lt;/td&gt;</div><div class="line"><a name="l02755"></a><span class="lineno"> 2755</span>&#160;    &lt;td&gt;3.94&lt;/td&gt;</div><div class="line"><a name="l02756"></a><span class="lineno"> 2756</span>&#160;  &lt;/tr&gt;</div><div class="line"><a name="l02757"></a><span class="lineno"> 2757</span>&#160;  &lt;tr&gt;</div><div class="line"><a name="l02758"></a><span class="lineno"> 2758</span>&#160;    &lt;td align=<span class="stringliteral">&quot;right&quot;</span>&gt;262,144&lt;/td&gt;</div><div class="line"><a name="l02759"></a><span class="lineno"> 2759</span>&#160;    &lt;td align=<span class="stringliteral">&quot;right&quot;</span>&gt;9,437,184&lt;/td&gt;</div><div class="line"><a name="l02760"></a><span class="lineno"> 2760</span>&#160;    &lt;td align=<span class="stringliteral">&quot;center&quot;</span>&gt;2.038e-06&lt;/td&gt;</div><div class="line"><a name="l02761"></a><span class="lineno"> 2761</span>&#160;    &lt;td&gt;2.86&lt;/td&gt;</div><div class="line"><a name="l02762"></a><span class="lineno"> 2762</span>&#160;    &lt;td align=<span class="stringliteral">&quot;right&quot;</span>&gt;16,777,216&lt;/td&gt;</div><div class="line"><a name="l02763"></a><span class="lineno"> 2763</span>&#160;    &lt;td align=<span class="stringliteral">&quot;center&quot;</span>&gt;3.609e-09&lt;/td&gt;</div><div class="line"><a name="l02764"></a><span class="lineno"> 2764</span>&#160;    &lt;td&gt;4.01&lt;/td&gt;</div><div class="line"><a name="l02765"></a><span class="lineno"> 2765</span>&#160;    &lt;td align=<span class="stringliteral">&quot;right&quot;</span>&gt;37,748,736&lt;/td&gt;</div><div class="line"><a name="l02766"></a><span class="lineno"> 2766</span>&#160;    &lt;td align=<span class="stringliteral">&quot;center&quot;</span>&gt;5.730e-11&lt;/td&gt;</div><div class="line"><a name="l02767"></a><span class="lineno"> 2767</span>&#160;    &lt;td&gt;-1.04&lt;/td&gt;</div><div class="line"><a name="l02768"></a><span class="lineno"> 2768</span>&#160;  &lt;/tr&gt;</div><div class="line"><a name="l02769"></a><span class="lineno"> 2769</span>&#160;&lt;/table&gt; </div><div class="line"><a name="l02770"></a><span class="lineno"> 2770</span>&#160;</div><div class="line"><a name="l02771"></a><span class="lineno"> 2771</span>&#160;表中显示，我们对两种数值通量都得到了最佳的 @f$\mathcal O\left(h^{p+1}\right)@f$ 收敛率。对于 @f$p=2@f$ 的Lax--Friedrichs通量，误差略小，但对于 @f$p=3@f$ 的情况则相反；在任何情况下，这个测试案例的差异都相对较小。</div><div class="line"><a name="l02772"></a><span class="lineno"> 2772</span>&#160;</div><div class="line"><a name="l02773"></a><span class="lineno"> 2773</span>&#160;对于 @f$p=5@f$ ，我们在最细的网格上用两种通量达到了 @f$10^{-11}@f$ 的舍入精度。还要注意的是，误差是绝对的，域长为 @f$10^2@f$ ，所以相对误差低于 @f$10^{-12}@f$ 。HLL通量对于最高度数来说要好一些，这是由于Lax--Friedrichs通量的轻微不准确造成的。Lax--Friedrichs通量对离开域的解设置了一个Dirichlet条件，这导致了一个小的人工反射，这在Lax--Friedrichs通量中被凸显出来。除此之外，我们看到数值通量的影响很小，因为元素内部的多项式部分是引起反射的主要动力。当试图用高阶DG设置来接近更具挑战性的设置时，通量的有限影响也会产生影响。以第33步的参数和网格为例，一旦高质部分接近边界，我们就会在两种通量下得到振荡（这反过来会使密度为负值，并使解决方案爆炸），这与低阶有限体积情况不同（ @f$p=0@f$ ）。因此，任何导致溶液中出现冲击的情况都需要某种形式的限制性或人工耗散。对于另一种选择，请参见@ref step_69 <span class="stringliteral">&quot;step-69&quot;</span>教程程序。</div><div class="line"><a name="l02774"></a><span class="lineno"> 2774</span>&#160;</div><div class="line"><a name="l02775"></a><span class="lineno"> 2775</span>&#160;</div><div class="line"><a name="l02776"></a><span class="lineno"> 2776</span>&#160;</div><div class="line"><a name="l02777"></a><span class="lineno"> 2777</span>&#160;</div><div class="line"><a name="l02778"></a><span class="lineno"> 2778</span>&#160;&lt;a name=<span class="stringliteral">&quot;Resultsforflowinchannelaroundcylinderin2D&quot;</span>&gt;&lt;/a&gt;&lt;h3&gt;Results <span class="keywordflow">for</span> flow in channel around <a class="code" href="namespaceGridGenerator.html#a5cdda7b4a76d509af7d1a8dc1320ddb0">cylinder</a> in 2D&lt;/h3&gt;</div><div class="line"><a name="l02779"></a><span class="lineno"> 2779</span>&#160;</div><div class="line"><a name="l02780"></a><span class="lineno"> 2780</span>&#160;</div><div class="line"><a name="l02781"></a><span class="lineno"> 2781</span>&#160;对于渠道中圆柱体周围的流动测试案例，我们需要将第一行代码改为</div><div class="line"><a name="l02782"></a><span class="lineno"> 2782</span>&#160;</div><div class="line"><a name="l02783"></a><span class="lineno"> 2783</span>&#160;@code</div><div class="line"><a name="l02784"></a><span class="lineno"> 2784</span>&#160;  constexpr <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> testcase = 1;</div><div class="line"><a name="l02785"></a><span class="lineno"> 2785</span>&#160;<span class="keyword">@end</span>code</div><div class="line"><a name="l02786"></a><span class="lineno"> 2786</span>&#160;</div><div class="line"><a name="l02787"></a><span class="lineno"> 2787</span>&#160;这个测试案例从一个马赫数为0.31的恒定速度和恒定的初始密度的背景场开始；气流必须绕过一个圆柱体形式的障碍物。由于我们对圆柱体壁施加了一个无穿透的条件，最初迎面撞上圆柱体的气流必须重新排列，这就产生了一个大的声波。下面的图片显示了二维情况下5级全局细化时0.1、0.25、0.5和1.0（左上至右下）的压力，使用了102,400个单元，多项式程度为5，所有4个求解变量的自由度为1470万。我们清楚地看到，在时间0.1的第一个快照中，不连续现象在上游方向传播缓慢，在下游方向传播较快。在时间0.25，声波已经到达顶部和底部的墙壁并反射到内部。从下壁和上壁反射波的不同距离，我们可以看到以 <a class="code" href="namespaceGridGenerator.html#a9d0b8a34fe5ca58425aa1fcf0d6132f1">GridGenerator::channel_with_cylinder</a>() 为代表的Sch&amp;auml;fer-Turek试验案例的轻微不对称性，圆柱体上方的空间与下方相比要多一些。在后来的时间里，画面更加混乱，到处都是许多声波。</div><div class="line"><a name="l02788"></a><span class="lineno"> 2788</span>&#160;</div><div class="line"><a name="l02789"></a><span class="lineno"> 2789</span>&#160; &lt;table align=&quot;<a class="code" href="data__out__base_8cc.html#a8188ef4709fc9a4cc076d37447783ba1">center</a>&quot; class=&quot;doxtable&quot; style=&quot;width:85%&quot;&gt;</div><div class="line"><a name="l02790"></a><span class="lineno"> 2790</span>&#160;  &lt;tr&gt;</div><div class="line"><a name="l02791"></a><span class="lineno"> 2791</span>&#160;    &lt;td&gt;</div><div class="line"><a name="l02792"></a><span class="lineno"> 2792</span>&#160;        &lt;img src=&quot;https:<span class="comment">//www.dealii.org/images/steps/developer/step-67.pressure_010.png&quot; alt=&quot;&quot; width=&quot;100%&quot;&gt;</span></div><div class="line"><a name="l02793"></a><span class="lineno"> 2793</span>&#160;    &lt;/td&gt;</div><div class="line"><a name="l02794"></a><span class="lineno"> 2794</span>&#160;    &lt;td&gt;</div><div class="line"><a name="l02795"></a><span class="lineno"> 2795</span>&#160;        &lt;img src=&quot;https:<span class="comment">//www.dealii.org/images/steps/developer/step-67.pressure_025.png&quot; alt=&quot;&quot; width=&quot;100%&quot;&gt;</span></div><div class="line"><a name="l02796"></a><span class="lineno"> 2796</span>&#160;    &lt;/td&gt;</div><div class="line"><a name="l02797"></a><span class="lineno"> 2797</span>&#160;  &lt;/tr&gt;</div><div class="line"><a name="l02798"></a><span class="lineno"> 2798</span>&#160;  &lt;tr&gt;</div><div class="line"><a name="l02799"></a><span class="lineno"> 2799</span>&#160;    &lt;td&gt;</div><div class="line"><a name="l02800"></a><span class="lineno"> 2800</span>&#160;        &lt;img src=&quot;https:<span class="comment">//www.dealii.org/images/steps/developer/step-67.pressure_050.png&quot; alt=&quot;&quot; width=&quot;100%&quot;&gt;</span></div><div class="line"><a name="l02801"></a><span class="lineno"> 2801</span>&#160;    &lt;/td&gt;</div><div class="line"><a name="l02802"></a><span class="lineno"> 2802</span>&#160;    &lt;td&gt;</div><div class="line"><a name="l02803"></a><span class="lineno"> 2803</span>&#160;        &lt;img src=&quot;https:<span class="comment">//www.dealii.org/images/steps/developer/step-67.pressure_100.png&quot; alt=&quot;&quot; width=&quot;100%&quot;&gt;</span></div><div class="line"><a name="l02804"></a><span class="lineno"> 2804</span>&#160;    &lt;/td&gt;</div><div class="line"><a name="l02805"></a><span class="lineno"> 2805</span>&#160;  &lt;/tr&gt;</div><div class="line"><a name="l02806"></a><span class="lineno"> 2806</span>&#160;&lt;/table&gt; </div><div class="line"><a name="l02807"></a><span class="lineno"> 2807</span>&#160;</div><div class="line"><a name="l02808"></a><span class="lineno"> 2808</span>&#160;下一张图片显示了在相同分辨率下，从通道入口向出口看，时间为1.0时的压力仰角图--在这里，我们可以看到大量的反射。在该图中，可以看到两种类型的波。较大振幅的波对应于初始不连续物撞击墙壁时发生的各种反射，而与元素大小相似的小振幅波则对应于数值伪影。它们起源于方案的有限分辨率，并在不连续面通过高阶多项式的元素时出现。这种效应可以通过提高分辨率来治愈。除了这种效应之外，丰富的波浪结构是高阶DG方法的传输精度的结果。</div><div class="line"><a name="l02809"></a><span class="lineno"> 2809</span>&#160;</div><div class="line"><a name="l02810"></a><span class="lineno"> 2810</span>&#160; &lt;img src=&quot;https:<span class="comment">//www.dealii.org/images/steps/developer/step-67.pressure_elevated.jpg&quot; alt=&quot;&quot; width=&quot;40%&quot;&gt; </span></div><div class="line"><a name="l02811"></a><span class="lineno"> 2811</span>&#160;</div><div class="line"><a name="l02812"></a><span class="lineno"> 2812</span>&#160;通过2级全局细化，1,600个单元，网格及其在40个MPI进程上的划分情况如下。</div><div class="line"><a name="l02813"></a><span class="lineno"> 2813</span>&#160;</div><div class="line"><a name="l02814"></a><span class="lineno"> 2814</span>&#160; &lt;img src=&quot;https:<span class="comment">//www.dealii.org/images/steps/developer/step-67.grid-owner.png&quot; alt=&quot;&quot; width=&quot;70%&quot;&gt; </span></div><div class="line"><a name="l02815"></a><span class="lineno"> 2815</span>&#160;</div><div class="line"><a name="l02816"></a><span class="lineno"> 2816</span>&#160;当我们在40个核心上运行具有4级全局细化的代码时，我们得到以下输出。</div><div class="line"><a name="l02817"></a><span class="lineno"> 2817</span>&#160;</div><div class="line"><a name="l02818"></a><span class="lineno"> 2818</span>&#160;@code</div><div class="line"><a name="l02819"></a><span class="lineno"> 2819</span>&#160;Running with 40 MPI processes</div><div class="line"><a name="l02820"></a><span class="lineno"> 2820</span>&#160;Vectorization over 8 doubles = 512 bits (AVX512)</div><div class="line"><a name="l02821"></a><span class="lineno"> 2821</span>&#160;Number of degrees of freedom: 3,686,400 ( = 4 [vars] x 25,600 [cells] x 36 [dofs/cell/var] )</div><div class="line"><a name="l02822"></a><span class="lineno"> 2822</span>&#160;Time step size: 7.39876e-05, minimal h: 0.001875, <a class="code" href="namespaceAlgorithms_1_1Events.html#a15a12dfdadd39a026d192ad96cb6207b">initial</a> transport scaling: 0.00110294</div><div class="line"><a name="l02823"></a><span class="lineno"> 2823</span>&#160;</div><div class="line"><a name="l02824"></a><span class="lineno"> 2824</span>&#160;</div><div class="line"><a name="l02825"></a><span class="lineno"> 2825</span>&#160;Time:       0, dt:  7.4e-05, <a class="code" href="namespaceLocalIntegrators_1_1Divergence.html#a8bcfc37d2a2be8faa18628a601ecf112">norm</a> rho:   4.17e-16, rho * u:  1.629e-16, energy: 1.381e-15</div><div class="line"><a name="l02826"></a><span class="lineno"> 2826</span>&#160;Time:    0.05, dt:  6.3e-05, <a class="code" href="namespaceLocalIntegrators_1_1Divergence.html#a8bcfc37d2a2be8faa18628a601ecf112">norm</a> rho:    0.02075, rho * u:    0.03801, energy:   0.08772</div><div class="line"><a name="l02827"></a><span class="lineno"> 2827</span>&#160;Time:     0.1, dt:  5.9e-05, <a class="code" href="namespaceLocalIntegrators_1_1Divergence.html#a8bcfc37d2a2be8faa18628a601ecf112">norm</a> rho:    0.02211, rho * u:    0.04515, energy:   0.08953</div><div class="line"><a name="l02828"></a><span class="lineno"> 2828</span>&#160;Time:    0.15, dt:  5.7e-05, <a class="code" href="namespaceLocalIntegrators_1_1Divergence.html#a8bcfc37d2a2be8faa18628a601ecf112">norm</a> rho:    0.02261, rho * u:    0.04592, energy:   0.08967</div><div class="line"><a name="l02829"></a><span class="lineno"> 2829</span>&#160;Time:     0.2, dt:  5.8e-05, <a class="code" href="namespaceLocalIntegrators_1_1Divergence.html#a8bcfc37d2a2be8faa18628a601ecf112">norm</a> rho:    0.02058, rho * u:    0.04361, energy:   0.08222</div><div class="line"><a name="l02830"></a><span class="lineno"> 2830</span>&#160;Time:    0.25, dt:  5.9e-05, <a class="code" href="namespaceLocalIntegrators_1_1Divergence.html#a8bcfc37d2a2be8faa18628a601ecf112">norm</a> rho:    0.01695, rho * u:    0.04203, energy:   0.06873</div><div class="line"><a name="l02831"></a><span class="lineno"> 2831</span>&#160;Time:     0.3, dt:  5.9e-05, <a class="code" href="namespaceLocalIntegrators_1_1Divergence.html#a8bcfc37d2a2be8faa18628a601ecf112">norm</a> rho:    0.01653, rho * u:     0.0401, energy:   0.06604</div><div class="line"><a name="l02832"></a><span class="lineno"> 2832</span>&#160;Time:    0.35, dt:  5.7e-05, <a class="code" href="namespaceLocalIntegrators_1_1Divergence.html#a8bcfc37d2a2be8faa18628a601ecf112">norm</a> rho:    0.01774, rho * u:    0.04264, energy:    0.0706</div><div class="line"><a name="l02833"></a><span class="lineno"> 2833</span>&#160;</div><div class="line"><a name="l02834"></a><span class="lineno"> 2834</span>&#160;</div><div class="line"><a name="l02835"></a><span class="lineno"> 2835</span>&#160;...</div><div class="line"><a name="l02836"></a><span class="lineno"> 2836</span>&#160;</div><div class="line"><a name="l02837"></a><span class="lineno"> 2837</span>&#160;</div><div class="line"><a name="l02838"></a><span class="lineno"> 2838</span>&#160;Time:    1.95, dt:  5.8e-05, <a class="code" href="namespaceLocalIntegrators_1_1Divergence.html#a8bcfc37d2a2be8faa18628a601ecf112">norm</a> rho:    0.01488, rho * u:    0.03923, energy:   0.05185</div><div class="line"><a name="l02839"></a><span class="lineno"> 2839</span>&#160;Time:       2, dt:  5.7e-05, <a class="code" href="namespaceLocalIntegrators_1_1Divergence.html#a8bcfc37d2a2be8faa18628a601ecf112">norm</a> rho:    0.01432, rho * u:    0.03969, energy:   0.04889</div><div class="line"><a name="l02840"></a><span class="lineno"> 2840</span>&#160;</div><div class="line"><a name="l02841"></a><span class="lineno"> 2841</span>&#160;</div><div class="line"><a name="l02842"></a><span class="lineno"> 2842</span>&#160;+-------------------------------------------+------------------+------------+------------------+</div><div class="line"><a name="l02843"></a><span class="lineno"> 2843</span>&#160;| Total wallclock time elapsed              |     273.6s    13 |     273.6s |     273.6s     0 |</div><div class="line"><a name="l02844"></a><span class="lineno"> 2844</span>&#160;|                                           |                  |                               |</div><div class="line"><a name="l02845"></a><span class="lineno"> 2845</span>&#160;| Section                       | no. calls |   <a class="code" href="namespaceVectorTools_1_1EvaluationFlags.html#ac6721740e24732d6afabcf28ddfc1ffdaeb244a97c0c9e9e7ca4765e096f0badc">min</a> time  rank |   <a class="code" href="namespaceVectorTools_1_1EvaluationFlags.html#ac6721740e24732d6afabcf28ddfc1ffdacc8b05748569f308550a239dc5b14396">avg</a> time |   <a class="code" href="namespaceVectorTools_1_1EvaluationFlags.html#ac6721740e24732d6afabcf28ddfc1ffda8e7f5b8545162dccd5ed717792bdf420">max</a> time  rank |</div><div class="line"><a name="l02846"></a><span class="lineno"> 2846</span>&#160;+-------------------------------------------+------------------+------------+------------------+</div><div class="line"><a name="l02847"></a><span class="lineno"> 2847</span>&#160;| compute errors                |        41 |   0.01112s    35 |    0.0672s |    0.1337s     0 |</div><div class="line"><a name="l02848"></a><span class="lineno"> 2848</span>&#160;| compute transport speed       |      6914 |     5.422s    35 |     15.96s |     29.99s     1 |</div><div class="line"><a name="l02849"></a><span class="lineno"> 2849</span>&#160;| output                        |        41 |     37.24s    35 |      37.3s |     37.37s     0 |</div><div class="line"><a name="l02850"></a><span class="lineno"> 2850</span>&#160;| rk time stepping total        |     34564 |     205.4s     1 |     219.5s |     230.1s    35 |</div><div class="line"><a name="l02851"></a><span class="lineno"> 2851</span>&#160;| rk_stage - integrals L_h      |    172820 |     153.6s     1 |     164.9s |     175.6s    27 |</div><div class="line"><a name="l02852"></a><span class="lineno"> 2852</span>&#160;| rk_stage - inv mass + vec upd |    172820 |     47.13s    13 |     53.09s |     64.05s    33 |</div><div class="line"><a name="l02853"></a><span class="lineno"> 2853</span>&#160;+-------------------------------------------+------------------+------------+------------------+</div><div class="line"><a name="l02854"></a><span class="lineno"> 2854</span>&#160;@endcode</div><div class="line"><a name="l02855"></a><span class="lineno"> 2855</span>&#160;</div><div class="line"><a name="l02856"></a><span class="lineno"> 2856</span>&#160;</div><div class="line"><a name="l02857"></a><span class="lineno"> 2857</span>&#160;</div><div class="line"><a name="l02858"></a><span class="lineno"> 2858</span>&#160;这里显示的各种数量的规范是对背景场（即初始条件）的偏差 @f$\rho&#39;@f$ 、 @f$(\rho u)&#39;@f$ 和 @f$E&#39;@f$ 。运行时间的分布总体上与之前的测试案例相似。唯一略有不同的是，与反质量矩阵和矢量更新相比，在 @f$\mathcal L_h@f$ 中花费的时间比例较大。这是因为几何体是变形的，无矩阵框架需要从内存中加载额外的几何体阵列，这些阵列在仿生网格的情况下是被压缩的。</div><div class="line"><a name="l02859"></a><span class="lineno"> 2859</span>&#160;</div><div class="line"><a name="l02860"></a><span class="lineno"> 2860</span>&#160;将全局细化的数量增加到5，输出就变成了。</div><div class="line"><a name="l02861"></a><span class="lineno"> 2861</span>&#160;</div><div class="line"><a name="l02862"></a><span class="lineno"> 2862</span>&#160;@code</div><div class="line"><a name="l02863"></a><span class="lineno"> 2863</span>&#160;Running with 40 MPI processes</div><div class="line"><a name="l02864"></a><span class="lineno"> 2864</span>&#160;Vectorization over 8 doubles = 512 bits (AVX512)</div><div class="line"><a name="l02865"></a><span class="lineno"> 2865</span>&#160;Number of degrees of freedom: 14,745,600 ( = 4 [vars] x 102,400 [cells] x 36 [dofs/cell/var] )</div><div class="line"><a name="l02866"></a><span class="lineno"> 2866</span>&#160;</div><div class="line"><a name="l02867"></a><span class="lineno"> 2867</span>&#160;</div><div class="line"><a name="l02868"></a><span class="lineno"> 2868</span>&#160;...</div><div class="line"><a name="l02869"></a><span class="lineno"> 2869</span>&#160;</div><div class="line"><a name="l02870"></a><span class="lineno"> 2870</span>&#160;</div><div class="line"><a name="l02871"></a><span class="lineno"> 2871</span>&#160;+-------------------------------------------+------------------+------------+------------------+</div><div class="line"><a name="l02872"></a><span class="lineno"> 2872</span>&#160;| Total wallclock time elapsed              |      2693s    32 |      2693s |      2693s    23 |</div><div class="line"><a name="l02873"></a><span class="lineno"> 2873</span>&#160;|                                           |                  |                               |</div><div class="line"><a name="l02874"></a><span class="lineno"> 2874</span>&#160;| Section                       | no. calls |   <a class="code" href="namespaceVectorTools_1_1EvaluationFlags.html#ac6721740e24732d6afabcf28ddfc1ffdaeb244a97c0c9e9e7ca4765e096f0badc">min</a> time  rank |   <a class="code" href="namespaceVectorTools_1_1EvaluationFlags.html#ac6721740e24732d6afabcf28ddfc1ffdacc8b05748569f308550a239dc5b14396">avg</a> time |   <a class="code" href="namespaceVectorTools_1_1EvaluationFlags.html#ac6721740e24732d6afabcf28ddfc1ffda8e7f5b8545162dccd5ed717792bdf420">max</a> time  rank |</div><div class="line"><a name="l02875"></a><span class="lineno"> 2875</span>&#160;+-------------------------------------------+------------------+------------+------------------+</div><div class="line"><a name="l02876"></a><span class="lineno"> 2876</span>&#160;| compute errors                |        41 |   0.04537s    32 |     0.173s |    0.3489s     0 |</div><div class="line"><a name="l02877"></a><span class="lineno"> 2877</span>&#160;| compute transport speed       |     13858 |     40.75s    32 |     85.99s |     149.8s     0 |</div><div class="line"><a name="l02878"></a><span class="lineno"> 2878</span>&#160;| output                        |        41 |     153.8s    32 |     153.9s |     154.1s     0 |</div><div class="line"><a name="l02879"></a><span class="lineno"> 2879</span>&#160;| rk time stepping total        |     69284 |      2386s     0 |      2450s |      2496s    32 |</div><div class="line"><a name="l02880"></a><span class="lineno"> 2880</span>&#160;| rk_stage - integrals L_h      |    346420 |      1365s    32 |      1574s |      1718s    19 |</div><div class="line"><a name="l02881"></a><span class="lineno"> 2881</span>&#160;| rk_stage - inv mass + vec upd |    346420 |     722.5s    10 |     870.7s |      1125s    32 |</div><div class="line"><a name="l02882"></a><span class="lineno"> 2882</span>&#160;+-------------------------------------------+------------------+------------+------------------+</div><div class="line"><a name="l02883"></a><span class="lineno"> 2883</span>&#160;@endcode</div><div class="line"><a name="l02884"></a><span class="lineno"> 2884</span>&#160;</div><div class="line"><a name="l02885"></a><span class="lineno"> 2885</span>&#160;</div><div class="line"><a name="l02886"></a><span class="lineno"> 2886</span>&#160;</div><div class="line"><a name="l02887"></a><span class="lineno"> 2887</span>&#160;对性能的影响与分析性测试案例相似--理论上，计算时间应该增加8倍，但我们实际上看到时间步骤增加了11倍（219.5秒对2450秒）。这可以追溯到缓存，小的情况下大多适合缓存。一个有趣的效果，是典型的本地通信（积分 @f$\mathcal L_h@f$ ）和全局通信（计算运输速度）混合的程序，有一些负载不平衡，可以通过查看分别遇到不同阶段的最小和最大时间的MPI等级来观察。级别0报告了 &quot;rk时间步进总数 &quot;部分的最快吞吐量。同时，对于 &quot;计算传输速度 &quot;部分，它似乎是最慢的，几乎比平均水平慢了2倍，与较快的等级相比几乎是4倍。由于后者涉及到全局通信，我们可以将这部分的缓慢归因于本地Runge--Kutta阶段在这个等级上推进得更快，需要等到其他处理器跟上。在这一点上，人们可以怀疑这种不平衡的原因。在所有的MPI进程中，单元格的数量几乎是相同的。然而，无矩阵框架在位于通道出口处的仿生和笛卡尔单元上速度更快，较低的MPI等级被分配到这些单元。另一方面，报告Runga--Kutta阶段最高运行时间的等级32拥有靠近圆柱体的弯曲单元，对于这些单元不可能有数据压缩。为了提高吞吐量，我们可以在划分 <a class="code" href="namespaceparallel.html">parallel</a>::distributed::<a class="code" href="classTriangulation.html">Triangulation</a> 对象时给不同的单元类型分配不同的权重，甚至可以测量几个时间步骤的运行时间，然后尝试重新平衡。</div><div class="line"><a name="l02888"></a><span class="lineno"> 2888</span>&#160;</div><div class="line"><a name="l02889"></a><span class="lineno"> 2889</span>&#160;对于1470万DoFs的测试案例，在346000个Runge--Kutta阶段中，每个Runge--Kutta阶段的吞吐量可以计算到2085 MDoFs/s，比上面报告的2360 MDoFs/s的笛卡尔网格吞吐量略慢。</div><div class="line"><a name="l02890"></a><span class="lineno"> 2890</span>&#160;</div><div class="line"><a name="l02891"></a><span class="lineno"> 2891</span>&#160;最后，如果我们增加一个额外的细化，我们会记录以下输出。</div><div class="line"><a name="l02892"></a><span class="lineno"> 2892</span>&#160;</div><div class="line"><a name="l02893"></a><span class="lineno"> 2893</span>&#160;@code</div><div class="line"><a name="l02894"></a><span class="lineno"> 2894</span>&#160;Running with 40 MPI processes</div><div class="line"><a name="l02895"></a><span class="lineno"> 2895</span>&#160;Vectorization over 8 doubles = 512 bits (AVX512)</div><div class="line"><a name="l02896"></a><span class="lineno"> 2896</span>&#160;Number of degrees of freedom: 58,982,400 ( = 4 [vars] x 409,600 [cells] x 36 [dofs/cell/var] )</div><div class="line"><a name="l02897"></a><span class="lineno"> 2897</span>&#160;</div><div class="line"><a name="l02898"></a><span class="lineno"> 2898</span>&#160;</div><div class="line"><a name="l02899"></a><span class="lineno"> 2899</span>&#160;...</div><div class="line"><a name="l02900"></a><span class="lineno"> 2900</span>&#160;</div><div class="line"><a name="l02901"></a><span class="lineno"> 2901</span>&#160;</div><div class="line"><a name="l02902"></a><span class="lineno"> 2902</span>&#160;Time:    1.95, dt:  1.4e-05, <a class="code" href="namespaceLocalIntegrators_1_1Divergence.html#a8bcfc37d2a2be8faa18628a601ecf112">norm</a> rho:    0.01488, rho * u:    0.03923, energy:   0.05183</div><div class="line"><a name="l02903"></a><span class="lineno"> 2903</span>&#160;Time:       2, dt:  1.4e-05, <a class="code" href="namespaceLocalIntegrators_1_1Divergence.html#a8bcfc37d2a2be8faa18628a601ecf112">norm</a> rho:    0.01431, rho * u:    0.03969, energy:   0.04887</div><div class="line"><a name="l02904"></a><span class="lineno"> 2904</span>&#160;</div><div class="line"><a name="l02905"></a><span class="lineno"> 2905</span>&#160;</div><div class="line"><a name="l02906"></a><span class="lineno"> 2906</span>&#160;+-------------------------------------------+------------------+------------+------------------+</div><div class="line"><a name="l02907"></a><span class="lineno"> 2907</span>&#160;| Total wallclock time elapsed              | 2.166e+04s    26 | 2.166e+04s | 2.166e+04s    24 |</div><div class="line"><a name="l02908"></a><span class="lineno"> 2908</span>&#160;|                                           |                  |                               |</div><div class="line"><a name="l02909"></a><span class="lineno"> 2909</span>&#160;| Section                       | no. calls |   <a class="code" href="namespaceVectorTools_1_1EvaluationFlags.html#ac6721740e24732d6afabcf28ddfc1ffdaeb244a97c0c9e9e7ca4765e096f0badc">min</a> time  rank |   <a class="code" href="namespaceVectorTools_1_1EvaluationFlags.html#ac6721740e24732d6afabcf28ddfc1ffdacc8b05748569f308550a239dc5b14396">avg</a> time |   <a class="code" href="namespaceVectorTools_1_1EvaluationFlags.html#ac6721740e24732d6afabcf28ddfc1ffda8e7f5b8545162dccd5ed717792bdf420">max</a> time  rank |</div><div class="line"><a name="l02910"></a><span class="lineno"> 2910</span>&#160;+-------------------------------------------+------------------+------------+------------------+</div><div class="line"><a name="l02911"></a><span class="lineno"> 2911</span>&#160;| compute errors                |        41 |    0.1758s    30 |     0.672s |     1.376s     1 |</div><div class="line"><a name="l02912"></a><span class="lineno"> 2912</span>&#160;| compute transport speed       |     27748 |     321.3s    34 |     678.8s |      1202s     1 |</div><div class="line"><a name="l02913"></a><span class="lineno"> 2913</span>&#160;| output                        |        41 |     616.3s    32 |     616.4s |     616.4s    34 |</div><div class="line"><a name="l02914"></a><span class="lineno"> 2914</span>&#160;| rk time stepping total        |    138733 | 1.983e+04s     1 | 2.036e+04s | 2.072e+04s    34 |</div><div class="line"><a name="l02915"></a><span class="lineno"> 2915</span>&#160;| rk_stage - integrals L_h      |    693665 | 1.052e+04s    32 | 1.248e+04s | 1.387e+04s    19 |</div><div class="line"><a name="l02916"></a><span class="lineno"> 2916</span>&#160;| rk_stage - inv mass + vec upd |    693665 |      6404s    10 |      7868s | 1.018e+04s    32 |</div><div class="line"><a name="l02917"></a><span class="lineno"> 2917</span>&#160;+-------------------------------------------+------------------+------------+------------------+</div><div class="line"><a name="l02918"></a><span class="lineno"> 2918</span>&#160;@endcode</div><div class="line"><a name="l02919"></a><span class="lineno"> 2919</span>&#160;</div><div class="line"><a name="l02920"></a><span class="lineno"> 2920</span>&#160;</div><div class="line"><a name="l02921"></a><span class="lineno"> 2921</span>&#160;</div><div class="line"><a name="l02922"></a><span class="lineno"> 2922</span>&#160;rk时间步数总数 &quot;部分对应的是2010 MDoFs/s的吞吐量。执行139k时间步长的总体运行时间是20k秒（5.7小时）或每秒7个时间步长--对于有近6000万个未知数来说还不错。通过在计算中添加更多的内核，可以实现更多的吞吐量。</div><div class="line"><a name="l02923"></a><span class="lineno"> 2923</span>&#160;</div><div class="line"><a name="l02924"></a><span class="lineno"> 2924</span>&#160;</div><div class="line"><a name="l02925"></a><span class="lineno"> 2925</span>&#160;</div><div class="line"><a name="l02926"></a><span class="lineno"> 2926</span>&#160;</div><div class="line"><a name="l02927"></a><span class="lineno"> 2927</span>&#160;&lt;a name=&quot;Resultsforflowinchannelaroundcylinderin3D&quot;&gt;&lt;/a&gt;&lt;h3&gt;Results for flow in channel around <a class="code" href="namespaceGridGenerator.html#a5cdda7b4a76d509af7d1a8dc1320ddb0">cylinder</a> in 3D&lt;/h3&gt;</div><div class="line"><a name="l02928"></a><span class="lineno"> 2928</span>&#160;</div><div class="line"><a name="l02929"></a><span class="lineno"> 2929</span>&#160;</div><div class="line"><a name="l02930"></a><span class="lineno"> 2930</span>&#160;将通道测试案例切换到3D，并进行3次全局细化，输出结果是</div><div class="line"><a name="l02931"></a><span class="lineno"> 2931</span>&#160;</div><div class="line"><a name="l02932"></a><span class="lineno"> 2932</span>&#160;@code</div><div class="line"><a name="l02933"></a><span class="lineno"> 2933</span>&#160;Running with 40 MPI processes</div><div class="line"><a name="l02934"></a><span class="lineno"> 2934</span>&#160;Vectorization over 8 doubles = 512 bits (AVX512)</div><div class="line"><a name="l02935"></a><span class="lineno"> 2935</span>&#160;Number of degrees of freedom: 221,184,000 ( = 5 [vars] x 204,800 [cells] x 216 [dofs/cell/var] )</div><div class="line"><a name="l02936"></a><span class="lineno"> 2936</span>&#160;</div><div class="line"><a name="l02937"></a><span class="lineno"> 2937</span>&#160;</div><div class="line"><a name="l02938"></a><span class="lineno"> 2938</span>&#160;...</div><div class="line"><a name="l02939"></a><span class="lineno"> 2939</span>&#160;</div><div class="line"><a name="l02940"></a><span class="lineno"> 2940</span>&#160;</div><div class="line"><a name="l02941"></a><span class="lineno"> 2941</span>&#160;Time:    1.95, dt:  0.00011, <a class="code" href="namespaceLocalIntegrators_1_1Divergence.html#a8bcfc37d2a2be8faa18628a601ecf112">norm</a> rho:    0.01131, rho * u:    0.03056, energy:   0.04091</div><div class="line"><a name="l02942"></a><span class="lineno"> 2942</span>&#160;Time:       2, dt:  0.00011, <a class="code" href="namespaceLocalIntegrators_1_1Divergence.html#a8bcfc37d2a2be8faa18628a601ecf112">norm</a> rho:     0.0119, rho * u:    0.03142, energy:   0.04425</div><div class="line"><a name="l02943"></a><span class="lineno"> 2943</span>&#160;</div><div class="line"><a name="l02944"></a><span class="lineno"> 2944</span>&#160;</div><div class="line"><a name="l02945"></a><span class="lineno"> 2945</span>&#160;+-------------------------------------------+------------------+------------+------------------+</div><div class="line"><a name="l02946"></a><span class="lineno"> 2946</span>&#160;| Total wallclock time elapsed              | 1.734e+04s     4 | 1.734e+04s | 1.734e+04s    38 |</div><div class="line"><a name="l02947"></a><span class="lineno"> 2947</span>&#160;|                                           |                  |                               |</div><div class="line"><a name="l02948"></a><span class="lineno"> 2948</span>&#160;| Section                       | no. calls |   <a class="code" href="namespaceVectorTools_1_1EvaluationFlags.html#ac6721740e24732d6afabcf28ddfc1ffdaeb244a97c0c9e9e7ca4765e096f0badc">min</a> time  rank |   <a class="code" href="namespaceVectorTools_1_1EvaluationFlags.html#ac6721740e24732d6afabcf28ddfc1ffdacc8b05748569f308550a239dc5b14396">avg</a> time |   <a class="code" href="namespaceVectorTools_1_1EvaluationFlags.html#ac6721740e24732d6afabcf28ddfc1ffda8e7f5b8545162dccd5ed717792bdf420">max</a> time  rank |</div><div class="line"><a name="l02949"></a><span class="lineno"> 2949</span>&#160;+-------------------------------------------+------------------+------------+------------------+</div><div class="line"><a name="l02950"></a><span class="lineno"> 2950</span>&#160;| compute errors                |        41 |    0.6551s    34 |     3.216s |     7.281s     0 |</div><div class="line"><a name="l02951"></a><span class="lineno"> 2951</span>&#160;| compute transport speed       |      3546 |       160s    34 |     393.2s |     776.9s     0 |</div><div class="line"><a name="l02952"></a><span class="lineno"> 2952</span>&#160;| output                        |        41 |      1350s    34 |      1353s |      1357s     0 |</div><div class="line"><a name="l02953"></a><span class="lineno"> 2953</span>&#160;| rk time stepping total        |     17723 | 1.519e+04s     0 | 1.558e+04s | 1.582e+04s    34 |</div><div class="line"><a name="l02954"></a><span class="lineno"> 2954</span>&#160;| rk_stage - integrals L_h      |     88615 | 1.005e+04s    32 | 1.126e+04s |  1.23e+04s    11 |</div><div class="line"><a name="l02955"></a><span class="lineno"> 2955</span>&#160;| rk_stage - inv mass + vec upd |     88615 |      3056s    11 |      4322s |      5759s    32 |</div><div class="line"><a name="l02956"></a><span class="lineno"> 2956</span>&#160;+-------------------------------------------+------------------+------------+------------------+</div><div class="line"><a name="l02957"></a><span class="lineno"> 2957</span>&#160;@endcode</div><div class="line"><a name="l02958"></a><span class="lineno"> 2958</span>&#160;</div><div class="line"><a name="l02959"></a><span class="lineno"> 2959</span>&#160;</div><div class="line"><a name="l02960"></a><span class="lineno"> 2960</span>&#160;</div><div class="line"><a name="l02961"></a><span class="lineno"> 2961</span>&#160;物理原理与二维情况类似，由于引力的作用，在Z方向有轻微的运动。在这种情况下，每个Runge-Kutta阶段的吞吐量为</div><div class="line"><a name="l02962"></a><span class="lineno"> 2962</span>&#160;</div><div class="line"><a name="l02963"></a><span class="lineno"> 2963</span>&#160;@f[</div><div class="line"><a name="l02964"></a><span class="lineno"> 2964</span>&#160;\text{throughput} = \frac{n_\mathrm{time steps} n_\mathrm{stages}</div><div class="line"><a name="l02965"></a><span class="lineno"> 2965</span>&#160;n_\mathrm{dofs}}{t_\mathrm{compute}} =</div><div class="line"><a name="l02966"></a><span class="lineno"> 2966</span>&#160;\frac{17723 \cdot 5 \cdot 221.2\,\text{M}}{15580s} = 1258\, \text{MDoFs/s}.</div><div class="line"><a name="l02967"></a><span class="lineno"> 2967</span>&#160;</div><div class="line"><a name="l02968"></a><span class="lineno"> 2968</span>&#160;</div><div class="line"><a name="l02969"></a><span class="lineno"> 2969</span>&#160;@f]</div><div class="line"><a name="l02970"></a><span class="lineno"> 2970</span>&#160;</div><div class="line"><a name="l02971"></a><span class="lineno"> 2971</span>&#160;</div><div class="line"><a name="l02972"></a><span class="lineno"> 2972</span>&#160;</div><div class="line"><a name="l02973"></a><span class="lineno"> 2973</span>&#160;吞吐量低于二维，因为 @f$\mathcal L_h@f$ 项的计算更加昂贵。这是由于 <span class="stringliteral">&quot;度+2 &quot;</span>点的过度积分和较大比例的面积分（更差的体积-表面比率），以及更昂贵的通量计算。如果我们只考虑反质量矩阵和矢量更新部分，我们记录到等熵涡旋的二维案例的吞吐量为4857 MDoFs/s，有3770万个未知数，而三维案例的运行速度为4535 MDoFs/s。性能是相似的，因为这两种情况实际上都受到内存带宽的限制。</div><div class="line"><a name="l02974"></a><span class="lineno"> 2974</span>&#160;</div><div class="line"><a name="l02975"></a><span class="lineno"> 2975</span>&#160;如果我们进行四级全局细化，我们需要增加进程的数量以在内存中容纳所有的东西--在这种情况下，计算需要大约350GB的RAM内存。另外，通过增加额外的资源，完成35k个时间步骤所需的时间也变得更容易忍受。因此，我们使用了6个节点，每个节点有40个核心，从而使计算有240个MPI进程。</div><div class="line"><a name="l02976"></a><span class="lineno"> 2976</span>&#160;</div><div class="line"><a name="l02977"></a><span class="lineno"> 2977</span>&#160;@code</div><div class="line"><a name="l02978"></a><span class="lineno"> 2978</span>&#160;Running with 240 MPI processes</div><div class="line"><a name="l02979"></a><span class="lineno"> 2979</span>&#160;Vectorization over 8 doubles = 512 bits (AVX512)</div><div class="line"><a name="l02980"></a><span class="lineno"> 2980</span>&#160;Number of degrees of freedom: 1,769,472,000 ( = 5 [vars] x 1,638,400 [cells] x 216 [dofs/cell/var] )</div><div class="line"><a name="l02981"></a><span class="lineno"> 2981</span>&#160;</div><div class="line"><a name="l02982"></a><span class="lineno"> 2982</span>&#160;</div><div class="line"><a name="l02983"></a><span class="lineno"> 2983</span>&#160;...</div><div class="line"><a name="l02984"></a><span class="lineno"> 2984</span>&#160;</div><div class="line"><a name="l02985"></a><span class="lineno"> 2985</span>&#160;</div><div class="line"><a name="l02986"></a><span class="lineno"> 2986</span>&#160;Time:    1.95, dt:  5.6e-05, <a class="code" href="namespaceLocalIntegrators_1_1Divergence.html#a8bcfc37d2a2be8faa18628a601ecf112">norm</a> rho:    0.01129, rho * u:     0.0306, energy:   0.04086</div><div class="line"><a name="l02987"></a><span class="lineno"> 2987</span>&#160;Time:       2, dt:  5.6e-05, <a class="code" href="namespaceLocalIntegrators_1_1Divergence.html#a8bcfc37d2a2be8faa18628a601ecf112">norm</a> rho:    0.01189, rho * u:    0.03145, energy:   0.04417</div><div class="line"><a name="l02988"></a><span class="lineno"> 2988</span>&#160;</div><div class="line"><a name="l02989"></a><span class="lineno"> 2989</span>&#160;</div><div class="line"><a name="l02990"></a><span class="lineno"> 2990</span>&#160;+-------------------------------------------+------------------+------------+------------------+</div><div class="line"><a name="l02991"></a><span class="lineno"> 2991</span>&#160;| Total wallclock time elapsed              | 5.396e+04s   151 | 5.396e+04s | 5.396e+04s     0 |</div><div class="line"><a name="l02992"></a><span class="lineno"> 2992</span>&#160;|                                           |                  |                               |</div><div class="line"><a name="l02993"></a><span class="lineno"> 2993</span>&#160;| Section                       | no. calls |   <a class="code" href="namespaceVectorTools_1_1EvaluationFlags.html#ac6721740e24732d6afabcf28ddfc1ffdaeb244a97c0c9e9e7ca4765e096f0badc">min</a> time  rank |   <a class="code" href="namespaceVectorTools_1_1EvaluationFlags.html#ac6721740e24732d6afabcf28ddfc1ffdacc8b05748569f308550a239dc5b14396">avg</a> time |   <a class="code" href="namespaceVectorTools_1_1EvaluationFlags.html#ac6721740e24732d6afabcf28ddfc1ffda8e7f5b8545162dccd5ed717792bdf420">max</a> time  rank |</div><div class="line"><a name="l02994"></a><span class="lineno"> 2994</span>&#160;+-------------------------------------------+------------------+------------+------------------+</div><div class="line"><a name="l02995"></a><span class="lineno"> 2995</span>&#160;| compute errors                |        41 |     2.632s   178 |     7.221s |     16.56s     0 |</div><div class="line"><a name="l02996"></a><span class="lineno"> 2996</span>&#160;| compute transport speed       |      7072 |       714s   193 |      1553s |      3351s     0 |</div><div class="line"><a name="l02997"></a><span class="lineno"> 2997</span>&#160;| output                        |        41 |      8065s   176 |      8070s |      8079s     0 |</div><div class="line"><a name="l02998"></a><span class="lineno"> 2998</span>&#160;| rk time stepping total        |     35350 |  4.25e+04s     0 |  4.43e+04s | 4.515e+04s   193 |</div><div class="line"><a name="l02999"></a><span class="lineno"> 2999</span>&#160;| rk_stage - integrals L_h      |    176750 | 2.936e+04s   134 | 3.222e+04s |  3.67e+04s    99 |</div><div class="line"><a name="l03000"></a><span class="lineno"> 3000</span>&#160;| rk_stage - inv mass + vec upd |    176750 |      7004s    99 | 1.207e+04s |  1.55e+04s   132 |</div><div class="line"><a name="l03001"></a><span class="lineno"> 3001</span>&#160;+-------------------------------------------+------------------+------------+------------------+</div><div class="line"><a name="l03002"></a><span class="lineno"> 3002</span>&#160;@endcode</div><div class="line"><a name="l03003"></a><span class="lineno"> 3003</span>&#160;</div><div class="line"><a name="l03004"></a><span class="lineno"> 3004</span>&#160;这个模拟有近20亿个未知数--确实是一个相当大的计算量，而每个时间步长仍然只需要大约1.5秒。</div><div class="line"><a name="l03005"></a><span class="lineno"> 3005</span>&#160;</div><div class="line"><a name="l03006"></a><span class="lineno"> 3006</span>&#160;</div><div class="line"><a name="l03007"></a><span class="lineno"> 3007</span>&#160;</div><div class="line"><a name="l03008"></a><span class="lineno"> 3008</span>&#160;</div><div class="line"><a name="l03009"></a><span class="lineno"> 3009</span>&#160;&lt;a name=<span class="stringliteral">&quot;Possibilitiesforextensions&quot;</span>&gt;&lt;/a&gt;&lt;h3&gt;Possibilities <span class="keywordflow">for</span> extensions&lt;/h3&gt;</div><div class="line"><a name="l03010"></a><span class="lineno"> 3010</span>&#160;</div><div class="line"><a name="l03011"></a><span class="lineno"> 3011</span>&#160;</div><div class="line"><a name="l03012"></a><span class="lineno"> 3012</span>&#160;这里介绍的代码可以直接扩展到自适应网格，给定适当的指标来设置细化标志。在声波方程的背景下，类似求解器的大规模适应性已经由&lt;a href=&quot;https://github.com/kronbichler/exwave&quot;&gt;exwave</div><div class="line"><a name="l03013"></a><span class="lineno"> 3013</span>&#160;project&lt;/a&gt;实现。然而，在目前的情况下，自适应性的好处往往只限于靠近声波起源的早期时间和效果，因为波最终会反射和衍射。这就导致了到处都是陡峭的梯度，类似于湍流，以及或多或少的全局细化网格。</div><div class="line"><a name="l03014"></a><span class="lineno"> 3014</span>&#160;</div><div class="line"><a name="l03015"></a><span class="lineno"> 3015</span>&#160;我们在结果部分没有讨论的另一个话题是不同时间积分方案的比较。该程序提供了四种低存储量的Runga--Kutta积分器的变体，每一种都有轻微不同的精度和稳定性行为。在这里实现的方案中，高阶方案提供了额外的精度，但在违反CFL条件之前，每级步长的效率略低。一个有趣的扩展是将这里提出的低存储变体与标准的Runge--Kutta积分器进行比较，或者使用与质量矩阵运算分开运行的矢量运算，并比较性能。</div><div class="line"><a name="l03016"></a><span class="lineno"> 3016</span>&#160;</div><div class="line"><a name="l03017"></a><span class="lineno"> 3017</span>&#160;</div><div class="line"><a name="l03018"></a><span class="lineno"> 3018</span>&#160;</div><div class="line"><a name="l03019"></a><span class="lineno"> 3019</span>&#160;</div><div class="line"><a name="l03020"></a><span class="lineno"> 3020</span>&#160;&lt;a name=<span class="stringliteral">&quot;Moreadvancednumericalfluxfunctionsandskewsymmetricformulations&quot;</span>&gt;&lt;/a&gt;&lt;h4&gt;More advanced numerical flux <a class="code" href="namespaceinternal_1_1p4est.html#a4b980c7b4b4d9984e93d73c7d30173ea">functions</a> and skew-<a class="code" href="namespaceLAPACKSupport.html#a45557450a3c1ae0e74d7ddf12c43bc98a1c0655acd718579199c777967de9eea5">symmetric</a> formulations&lt;/h4&gt;</div><div class="line"><a name="l03021"></a><span class="lineno"> 3021</span>&#160;</div><div class="line"><a name="l03022"></a><span class="lineno"> 3022</span>&#160;</div><div class="line"><a name="l03023"></a><span class="lineno"> 3023</span>&#160;正如介绍中提到的，本程序中采用的修改的Lax--Friedrichs通量和HLL通量只是文献中关于欧拉方程的大量数值通量中的两个变种。一个例子是HLLC通量（Harten-Lax-van Leer-Contact）通量，它增加了HLL通量或Roe通量中缺少的稀疏波效应。正如介绍中提到的，数值通量对高阶DG方案的影响是有争议的（与低阶离散的情况不同）。</div><div class="line"><a name="l03024"></a><span class="lineno"> 3024</span>&#160;</div><div class="line"><a name="l03025"></a><span class="lineno"> 3025</span>&#160;为了提高求解器的稳定性，一个相关的改进是也要考虑空间积分项。上面使用的相当幼稚的实现方式的一个缺点是，原始欧拉方程的能量守恒（在没有冲击的情况下）只适用于离散化误差。如果解决方案的分辨率不足，离散化误差会引起数值能量的增加，并最终导致离散化的不稳定。这是因为欧拉方程中的项的不精确数值积分，其中包含有理非线性和弯曲单元的高阶内容。摆脱这种困境的方法是所谓的倾斜对称公式，见 @cite Gassner2013 的一个简单变体。倾斜对称意味着在弱式中切换解 @f$\mathbf{<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a6b25dd8f005063d8d2b0a4bdb0d277f3">w</a>}@f$ 和检验函数 @f$\mathbf{v}@f$ 的作用，除了一些边界项外，产生原始量的精确负值。在离散设置中，挑战在于当积分只被近似计算时也要保持这种倾斜对称性（在连续情况下，倾斜对称性是部分积分的结果）。偏斜对称的数值方案平衡了保守形式的空间导数  @f$(\nabla \mathbf v, \mathbf{<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#aa87528a28ad8a95fa89a3876e6f986c8">F</a>}(\mathbf <a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a6b25dd8f005063d8d2b0a4bdb0d277f3">w</a>))_{K}@f$  和对流形式的贡献  @f$(\mathbf v, \tilde{\mathbf{<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#aa87528a28ad8a95fa89a3876e6f986c8">F</a>}}(\mathbf <a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a6b25dd8f005063d8d2b0a4bdb0d277f3">w</a>)\nabla</div><div class="line"><a name="l03026"></a><span class="lineno"> 3026</span>&#160;\mathbf{<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a6b25dd8f005063d8d2b0a4bdb0d277f3">w</a>})_{K}@f$  ，对于某些  @f$\tilde{\mathbf{<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#aa87528a28ad8a95fa89a3876e6f986c8">F</a>}}@f$  。准确的条款取决于方程和积分公式，在某些情况下可以通过特殊的倾斜对称有限差分方案来理解。</div><div class="line"><a name="l03027"></a><span class="lineno"> 3027</span>&#160;</div><div class="line"><a name="l03028"></a><span class="lineno"> 3028</span>&#160;要想开始，有兴趣的读者可以看看https:<span class="comment">//github.com/kronbichler/advection_miniapp，其中用deal.II对一个简单的平流方程实现了倾斜对称的DG公式。</span></div><div class="line"><a name="l03029"></a><span class="lineno"> 3029</span>&#160;</div><div class="line"><a name="l03030"></a><span class="lineno"> 3030</span>&#160;&lt;a name=<span class="stringliteral">&quot;Equippingthecodeforsupersoniccalculations&quot;</span>&gt;&lt;/a&gt;&lt;h4&gt;Equipping the code <span class="keywordflow">for</span> supersonic calculations&lt;/h4&gt;</div><div class="line"><a name="l03031"></a><span class="lineno"> 3031</span>&#160;</div><div class="line"><a name="l03032"></a><span class="lineno"> 3032</span>&#160;</div><div class="line"><a name="l03033"></a><span class="lineno"> 3033</span>&#160;正如介绍中提到的，欧拉方程的解随着马赫数的增加而产生冲击，这需要额外的机制来稳定方案，例如限制器的形式。除了实际实施限制器或人工粘性方法外，主要的挑战是如何平衡计算，因为在有问题的单元中限制震荡所涉及的额外计算会使它们比没有限制的普通DG单元更昂贵。此外，更好地应对不连续情况的额外数值通量也是一种选择。</div><div class="line"><a name="l03034"></a><span class="lineno"> 3034</span>&#160;</div><div class="line"><a name="l03035"></a><span class="lineno"> 3035</span>&#160;对于超音速流动来说，有一个因素也是必要的，那就是适当的边界条件。与介绍中讨论的并在程序中实现的亚音速流出边界相反，所有的特性都是超音速流出边界的外在表现，所以我们不想规定任何外部数据。</div><div class="line"><a name="l03036"></a><span class="lineno"> 3036</span>&#160;</div><div class="line"><a name="l03037"></a><span class="lineno"> 3037</span>&#160;@f[</div><div class="line"><a name="l03038"></a><span class="lineno"> 3038</span>&#160;\mathbf{<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a6b25dd8f005063d8d2b0a4bdb0d277f3">w</a>}^+ = \mathbf{<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a6b25dd8f005063d8d2b0a4bdb0d277f3">w</a>}^- = <a class="code" href="namespaceTrilinosWrappers_1_1internal.html#ad88a9499e01173b35d78413e5945e020">\begin</a>{pmatrix} \rho^-\\</div><div class="line"><a name="l03039"></a><span class="lineno"> 3039</span>&#160;(\rho \mathbf u)^- \\ <a class="code" href="namespacenumbers.html#a3c7239f00d5e87dfcf6dd19cbc3ddc74">E</a>^-\<a class="code" href="namespaceTrilinosWrappers_1_1internal.html#aee42c8e3004e2e81eac3c3356d3ec46b">end</a>{pmatrix} \quad</div><div class="line"><a name="l03040"></a><span class="lineno"> 3040</span>&#160; \text{(Neumann)}.</div><div class="line"><a name="l03041"></a><span class="lineno"> 3041</span>&#160;</div><div class="line"><a name="l03042"></a><span class="lineno"> 3042</span>&#160;</div><div class="line"><a name="l03043"></a><span class="lineno"> 3043</span>&#160;@f]</div><div class="line"><a name="l03044"></a><span class="lineno"> 3044</span>&#160;</div><div class="line"><a name="l03045"></a><span class="lineno"> 3045</span>&#160;</div><div class="line"><a name="l03046"></a><span class="lineno"> 3046</span>&#160;</div><div class="line"><a name="l03047"></a><span class="lineno"> 3047</span>&#160;在代码中，我们将简单地添加额外的语句</div><div class="line"><a name="l03048"></a><span class="lineno"> 3048</span>&#160;</div><div class="line"><a name="l03049"></a><span class="lineno"> 3049</span>&#160;@code</div><div class="line"><a name="l03050"></a><span class="lineno"> 3050</span>&#160;            <span class="keywordflow">else</span> <span class="keywordflow">if</span> (supersonic_outflow_boundaries.find(<a class="code" href="namespacetypes.html#aed8813fee8c8a2edcc6005e6a48c321a">boundary_id</a>) !=</div><div class="line"><a name="l03051"></a><span class="lineno"> 3051</span>&#160;                     supersonic_outflow_boundaries.end())</div><div class="line"><a name="l03052"></a><span class="lineno"> 3052</span>&#160;              {</div><div class="line"><a name="l03053"></a><span class="lineno"> 3053</span>&#160;                w_p        = w_m;</div><div class="line"><a name="l03054"></a><span class="lineno"> 3054</span>&#160;                at_outflow = <span class="keyword">true</span>;</div><div class="line"><a name="l03055"></a><span class="lineno"> 3055</span>&#160;              }</div><div class="line"><a name="l03056"></a><span class="lineno"> 3056</span>&#160;<span class="keyword">@end</span>code</div><div class="line"><a name="l03057"></a><span class="lineno"> 3057</span>&#160;</div><div class="line"><a name="l03058"></a><span class="lineno"> 3058</span>&#160;在 <span class="stringliteral">&quot;local_apply_boundary_face() &quot;</span>函数中。</div><div class="line"><a name="l03059"></a><span class="lineno"> 3059</span>&#160;</div><div class="line"><a name="l03060"></a><span class="lineno"> 3060</span>&#160;&lt;a name=<span class="stringliteral">&quot;ExtensiontothelinearizedEulerequations&quot;</span>&gt;&lt;/a&gt;&lt;h4&gt;Extension to the linearized Euler equations&lt;/h4&gt;</div><div class="line"><a name="l03061"></a><span class="lineno"> 3061</span>&#160;</div><div class="line"><a name="l03062"></a><span class="lineno"> 3062</span>&#160;</div><div class="line"><a name="l03063"></a><span class="lineno"> 3063</span>&#160;当对欧拉解的兴趣主要在于声波的传播时，围绕一个背景状态，即一个给定的密度、速度和能量（或压力）场，将欧拉方程线性化，只计算针对这些场的变化，往往是合理的。这就是航空声学的广泛领域的设置。即使有时分辨率要求大大降低，但由于线性化引起了额外的条款，实施起来就变得有些复杂了。从代码的角度来看，在算子评估中，我们还需要为代码配备要线性化的状态。这一信息可以由分析函数（根据正交点的位置进行评估）或由类似于解决方案的矢量提供。基于该矢量，我们将创建一个额外的FEEvaluation对象，从中读取并提供正交点的场值。如果背景速度为零，密度为常数，线性化的欧拉方程进一步简化，可以等效地写成声波方程的形式。</div><div class="line"><a name="l03064"></a><span class="lineno"> 3064</span>&#160;</div><div class="line"><a name="l03065"></a><span class="lineno"> 3065</span>&#160;在声音传播的背景下，一个挑战往往是边界条件的定义，因为计算域需要是有限的，而实际模拟往往跨越无限的（或至少大得多）物理域。传统的Dirichlet或Neumann边界条件会引起声波的反射，最终传播到感兴趣的区域，破坏了解决方案。因此，各种非反射边界条件或海绵层的变体，通常以&lt;a</div><div class="line"><a name="l03066"></a><span class="lineno"> 3066</span>&#160;href=<span class="stringliteral">&quot;https://en.wikipedia.org/wiki/Perfectly_matched_layer&quot;</span>&gt;perfectly</div><div class="line"><a name="l03067"></a><span class="lineno"> 3067</span>&#160;matched layers&lt;/a&gt;的形式出现--其中解决方案被阻尼，没有反射</div><div class="line"><a name="l03068"></a><span class="lineno"> 3068</span>&#160;</div><div class="line"><a name="l03069"></a><span class="lineno"> 3069</span>&#160;--是很常见的。</div><div class="line"><a name="l03070"></a><span class="lineno"> 3070</span>&#160;</div><div class="line"><a name="l03071"></a><span class="lineno"> 3071</span>&#160;</div><div class="line"><a name="l03072"></a><span class="lineno"> 3072</span>&#160;</div><div class="line"><a name="l03073"></a><span class="lineno"> 3073</span>&#160;</div><div class="line"><a name="l03074"></a><span class="lineno"> 3074</span>&#160;&lt;a name=<span class="stringliteral">&quot;ExtensiontothecompressibleNavierStokesequations&quot;</span>&gt;&lt;/a&gt;&lt;h4&gt;Extension to the compressible Navier-Stokes equations&lt;/h4&gt;</div><div class="line"><a name="l03075"></a><span class="lineno"> 3075</span>&#160;</div><div class="line"><a name="l03076"></a><span class="lineno"> 3076</span>&#160;</div><div class="line"><a name="l03077"></a><span class="lineno"> 3077</span>&#160;如 @cite FehnWallKronbichler2019 所述，本教程程序中的求解器也可以通过添加粘性项扩展到可压缩的Navier-Stokes方程。为了尽量保持这里获得的性能，尽管有额外的椭圆项的成本，例如通过内部惩罚方法，我们可以像步骤59的教程程序一样，将基础从FE_DGQ切换到FE_DGQHermite。</div><div class="line"><a name="l03078"></a><span class="lineno"> 3078</span>&#160;</div><div class="line"><a name="l03079"></a><span class="lineno"> 3079</span>&#160;</div><div class="line"><a name="l03080"></a><span class="lineno"> 3080</span>&#160;</div><div class="line"><a name="l03081"></a><span class="lineno"> 3081</span>&#160;</div><div class="line"><a name="l03082"></a><span class="lineno"> 3082</span>&#160;&lt;a name=<span class="stringliteral">&quot;Usingcellcentricloopsandsharedmemory&quot;</span>&gt;&lt;/a&gt;&lt;h4&gt;Using cell-centric loops and shared memory&lt;/h4&gt;</div><div class="line"><a name="l03083"></a><span class="lineno"> 3083</span>&#160;</div><div class="line"><a name="l03084"></a><span class="lineno"> 3084</span>&#160;</div><div class="line"><a name="l03085"></a><span class="lineno"> 3085</span>&#160;在本教程中，我们使用了以面为中心的循环。在这里，单元和面的积分在不同的循环中处理，导致对结果向量的多次写入访问，这在现代硬件上是比较昂贵的，因为写入操作通常也会导致隐含的读操作。另一方面，以元素为中心的循环是在处理一个单元的同时直接处理其所有的2d面。虽然这种循环意味着通量必须计算两次（对于一个内部面的每一面），但结果向量只需访问一次的事实--以及由此产生的算法没有竞赛条件，因此完全适合共享内存的事实--已经带来了性能的提升。如果你对这些高级主题感兴趣，你可以看一下步骤76，在那里我们对本教程进行了修改，以便我们能够使用这些功能。</div><div class="line"><a name="l03086"></a><span class="lineno"> 3086</span>&#160;</div><div class="line"><a name="l03087"></a><span class="lineno"> 3087</span>&#160;</div><div class="line"><a name="l03088"></a><span class="lineno"> 3088</span>&#160; *</div><div class="line"><a name="l03089"></a><span class="lineno"> 3089</span>&#160; *</div><div class="line"><a name="l03090"></a><span class="lineno"> 3090</span>&#160;&lt;a name=<span class="stringliteral">&quot;PlainProg&quot;</span>&gt;&lt;/a&gt;</div><div class="line"><a name="l03091"></a><span class="lineno"> 3091</span>&#160;&lt;h1&gt; The plain program&lt;/h1&gt;</div><div class="line"><a name="l03092"></a><span class="lineno"> 3092</span>&#160;@include <span class="stringliteral">&quot;step-67.cc&quot;</span></div><div class="line"><a name="l03093"></a><span class="lineno"> 3093</span>&#160;*/</div><div class="ttc" id="classTimeStepping_1_1LowStorageRungeKutta_html"><div class="ttname"><a href="classTimeStepping_1_1LowStorageRungeKutta.html">TimeStepping::LowStorageRungeKutta</a></div><div class="ttdef"><b>Definition:</b> <a href="time__stepping_8h_source.html#l00509">time_stepping.h:509</a></div></div>
<div class="ttc" id="group__feaccess_html_ggaa94b67d2fdcc390690c523f28019e52fa714204722e9eeb43aadbd0d5ddc48c85"><div class="ttname"><a href="group__feaccess.html#ggaa94b67d2fdcc390690c523f28019e52fa714204722e9eeb43aadbd0d5ddc48c85">update_JxW_values</a></div><div class="ttdoc">Transformed quadrature weights. </div><div class="ttdef"><b>Definition:</b> <a href="fe__update__flags_8h_source.html#l00103">fe_update_flags.h:103</a></div></div>
<div class="ttc" id="namespaceDataComponentInterpretation_html_a0cd2da3afe902f9004c23a73dbcc8ab0aa783915dbc182d5a49e111815fd23fe0"><div class="ttname"><a href="namespaceDataComponentInterpretation.html#a0cd2da3afe902f9004c23a73dbcc8ab0aa783915dbc182d5a49e111815fd23fe0">DataComponentInterpretation::component_is_part_of_vector</a></div><div class="ttdef"><b>Definition:</b> <a href="data__component__interpretation_8h_source.html#l00057">data_component_interpretation.h:57</a></div></div>
<div class="ttc" id="classunsigned_01int_html"><div class="ttname"><a href="classunsigned_01int.html">unsigned int</a></div></div>
<div class="ttc" id="group__feaccess_html_ggaa94b67d2fdcc390690c523f28019e52fa4057ca2f127aa619c65886a9d3ad4aea"><div class="ttname"><a href="group__feaccess.html#ggaa94b67d2fdcc390690c523f28019e52fa4057ca2f127aa619c65886a9d3ad4aea">update_values</a></div><div class="ttdoc">Shape function values. </div><div class="ttdef"><b>Definition:</b> <a href="fe__update__flags_8h_source.html#l00062">fe_update_flags.h:62</a></div></div>
<div class="ttc" id="namespaceLAPACKSupport_html_a45557450a3c1ae0e74d7ddf12c43bc98a1c0655acd718579199c777967de9eea5"><div class="ttname"><a href="namespaceLAPACKSupport.html#a45557450a3c1ae0e74d7ddf12c43bc98a1c0655acd718579199c777967de9eea5">LAPACKSupport::symmetric</a></div><div class="ttdoc">Matrix is symmetric. </div><div class="ttdef"><b>Definition:</b> <a href="lapack__support_8h_source.html#l00116">lapack_support.h:116</a></div></div>
<div class="ttc" id="namespaceDoFTools_html_a0429b3117b2ab1f5a1fd0d55de26ad81"><div class="ttname"><a href="namespaceDoFTools.html#a0429b3117b2ab1f5a1fd0d55de26ad81">DoFTools::get_subdomain_association</a></div><div class="ttdeci">void get_subdomain_association(const DoFHandler&lt; dim, spacedim &gt; &amp;dof_handler, std::vector&lt; types::subdomain_id &gt; &amp;subdomain)</div><div class="ttdef"><b>Definition:</b> <a href="dof__tools_8cc_source.html#l01508">dof_tools.cc:1508</a></div></div>
<div class="ttc" id="group__MeshWorker_html_gad10f528ab87f39fbb0531d24f238b2f3"><div class="ttname"><a href="group__MeshWorker.html#gad10f528ab87f39fbb0531d24f238b2f3">MeshWorker::loop</a></div><div class="ttdeci">void loop(ITERATOR begin, typename identity&lt; ITERATOR &gt;::type end, DOFINFO &amp;dinfo, INFOBOX &amp;info, const std::function&lt; void(DOFINFO &amp;, typename INFOBOX::CellInfo &amp;)&gt; &amp;cell_worker, const std::function&lt; void(DOFINFO &amp;, typename INFOBOX::CellInfo &amp;)&gt; &amp;boundary_worker, const std::function&lt; void(DOFINFO &amp;, DOFINFO &amp;, typename INFOBOX::CellInfo &amp;, typename INFOBOX::CellInfo &amp;)&gt; &amp;face_worker, ASSEMBLER &amp;assembler, const LoopControl &amp;lctrl=LoopControl())</div><div class="ttdef"><b>Definition:</b> <a href="loop_8h_source.html#l00449">loop.h:449</a></div></div>
<div class="ttc" id="namespaceinternal_html_a38181f4582ff69679bda7d8e31c37291"><div class="ttname"><a href="namespaceinternal.html#a38181f4582ff69679bda7d8e31c37291">internal::reinit</a></div><div class="ttdeci">void reinit(MatrixBlock&lt; MatrixType &gt; &amp;v, const BlockSparsityPattern &amp;p)</div><div class="ttdef"><b>Definition:</b> <a href="matrix__block_8h_source.html#l00575">matrix_block.h:575</a></div></div>
<div class="ttc" id="namespaceUtilities_html_a17955af7a4bc8771d430e622f9e732b3"><div class="ttname"><a href="namespaceUtilities.html#a17955af7a4bc8771d430e622f9e732b3">Utilities::truncate_to_n_digits</a></div><div class="ttdeci">Number truncate_to_n_digits(const Number number, const unsigned int n_digits)</div><div class="ttdef"><b>Definition:</b> <a href="base_2utilities_8cc_source.html#l00581">utilities.cc:581</a></div></div>
<div class="ttc" id="structDataOutBase_1_1VtkFlags_html"><div class="ttname"><a href="structDataOutBase_1_1VtkFlags.html">DataOutBase::VtkFlags</a></div><div class="ttdef"><b>Definition:</b> <a href="data__out__base_8h_source.html#l00871">data_out_base.h:871</a></div></div>
<div class="ttc" id="classFunction_html"><div class="ttname"><a href="classFunction.html">Function</a></div><div class="ttdef"><b>Definition:</b> <a href="function_8h_source.html#l00116">function.h:116</a></div></div>
<div class="ttc" id="namespaceLAPACKSupport_html_a0a1f0b9f7bb0b746b8f27d7f297ed7fe"><div class="ttname"><a href="namespaceLAPACKSupport.html#a0a1f0b9f7bb0b746b8f27d7f297ed7fe">LAPACKSupport::L</a></div><div class="ttdeci">static const char L</div><div class="ttdef"><b>Definition:</b> <a href="lapack__support_8h_source.html#l00183">lapack_support.h:183</a></div></div>
<div class="ttc" id="group__Exceptions_html_ga9442b63275c9ef3fab29bc222831c49c"><div class="ttname"><a href="group__Exceptions.html#ga9442b63275c9ef3fab29bc222831c49c">AssertDimension</a></div><div class="ttdeci">#define AssertDimension(dim1, dim2)</div><div class="ttdef"><b>Definition:</b> <a href="include_2deal_8II_2base_2exceptions_8h_source.html#l01562">exceptions.h:1562</a></div></div>
<div class="ttc" id="classFunction_html_a7248c7e11dc434fb7d16cdc5e41e3770"><div class="ttname"><a href="classFunction.html#a7248c7e11dc434fb7d16cdc5e41e3770">Function::n_components</a></div><div class="ttdeci">const unsigned int n_components</div><div class="ttdef"><b>Definition:</b> <a href="function_8h_source.html#l00132">function.h:132</a></div></div>
<div class="ttc" id="logstream_8h_html_ac643e79bd992f1a9bd0dca5b9f2859fb"><div class="ttname"><a href="logstream_8h.html#ac643e79bd992f1a9bd0dca5b9f2859fb">deallog</a></div><div class="ttdeci">LogStream deallog</div><div class="ttdef"><b>Definition:</b> <a href="logstream_8cc_source.html#l00037">logstream.cc:37</a></div></div>
<div class="ttc" id="structMatrixFree_1_1AdditionalData_html"><div class="ttname"><a href="structMatrixFree_1_1AdditionalData.html">MatrixFree::AdditionalData</a></div><div class="ttdef"><b>Definition:</b> <a href="matrix__free_8h_source.html#l00128">matrix_free.h:128</a></div></div>
<div class="ttc" id="classDataOutInterface_html_ac7280a24690b117454acfb0fa058299c"><div class="ttname"><a href="classDataOutInterface.html#ac7280a24690b117454acfb0fa058299c">DataOutInterface::set_flags</a></div><div class="ttdeci">void set_flags(const FlagType &amp;flags)</div><div class="ttdef"><b>Definition:</b> <a href="data__out__base_8cc_source.html#l08210">data_out_base.cc:8210</a></div></div>
<div class="ttc" id="namespaceLAPACKSupport_html_a1a9009db0d9a77923a7031b549b9b638a5bc7c54a9c20485772672825c6a73003"><div class="ttname"><a href="namespaceLAPACKSupport.html#a1a9009db0d9a77923a7031b549b9b638a5bc7c54a9c20485772672825c6a73003">LAPACKSupport::matrix</a></div><div class="ttdoc">Contents is actually a matrix. </div><div class="ttdef"><b>Definition:</b> <a href="lapack__support_8h_source.html#l00060">lapack_support.h:60</a></div></div>
<div class="ttc" id="namespaceGridGenerator_html_a9d0b8a34fe5ca58425aa1fcf0d6132f1"><div class="ttname"><a href="namespaceGridGenerator.html#a9d0b8a34fe5ca58425aa1fcf0d6132f1">GridGenerator::channel_with_cylinder</a></div><div class="ttdeci">void channel_with_cylinder(Triangulation&lt; dim &gt; &amp;tria, const double shell_region_width=0.03, const unsigned int n_shells=2, const double skewness=2.0, const bool colorize=false)</div></div>
<div class="ttc" id="namespacePhysics_1_1Elasticity_1_1Kinematics_html_a9587d5229555daa5b1fa1ba2f8a40adb"><div class="ttname"><a href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a9587d5229555daa5b1fa1ba2f8a40adb">Physics::Elasticity::Kinematics::e</a></div><div class="ttdeci">SymmetricTensor&lt; 2, dim, Number &gt; e(const Tensor&lt; 2, dim, Number &gt; &amp;F)</div></div>
<div class="ttc" id="classTimerOutput_html_a2405ae1b041a57d11a61a8cbfad3b487aa1bf9100145d06321277979f4ca77ba2"><div class="ttname"><a href="classTimerOutput.html#a2405ae1b041a57d11a61a8cbfad3b487aa1bf9100145d06321277979f4ca77ba2">TimerOutput::wall_times</a></div><div class="ttdef"><b>Definition:</b> <a href="timer_8h_source.html#l00627">timer.h:627</a></div></div>
<div class="ttc" id="namespaceTimeStepping_html_abff97b5326e452552f108a379dd6cff4af34241e1b27c2f0f2f90715ee9f97bdb"><div class="ttname"><a href="namespaceTimeStepping.html#abff97b5326e452552f108a379dd6cff4af34241e1b27c2f0f2f90715ee9f97bdb">TimeStepping::LOW_STORAGE_RK_STAGE7_ORDER4</a></div><div class="ttdef"><b>Definition:</b> <a href="time__stepping_8h_source.html#l00165">time_stepping.h:165</a></div></div>
<div class="ttc" id="classVector_html"><div class="ttname"><a href="classVector.html">Vector</a></div><div class="ttdef"><b>Definition:</b> <a href="mapping__q1__eulerian_8h_source.html#l00033">mapping_q1_eulerian.h:33</a></div></div>
<div class="ttc" id="classAffineConstraints_html"><div class="ttname"><a href="classAffineConstraints.html">AffineConstraints&lt; double &gt;</a></div></div>
<div class="ttc" id="classVectorizedArray_html"><div class="ttname"><a href="classVectorizedArray.html">VectorizedArray&lt; Number &gt;</a></div></div>
<div class="ttc" id="classFEFaceEvaluation_html_a4ac53fde2eab227ef45c7d29a5ed33fe"><div class="ttname"><a href="classFEFaceEvaluation.html#a4ac53fde2eab227ef45c7d29a5ed33fe">FEFaceEvaluation::gather_evaluate</a></div><div class="ttdeci">void gather_evaluate(const VectorType &amp;input_vector, const EvaluationFlags::EvaluationFlags evaluation_flag)</div></div>
<div class="ttc" id="namespaceGridGenerator_html_a56019d263ae45708302d5d7599f0d458"><div class="ttname"><a href="namespaceGridGenerator.html#a56019d263ae45708302d5d7599f0d458">GridGenerator::hyper_rectangle</a></div><div class="ttdeci">void hyper_rectangle(Triangulation&lt; dim, spacedim &gt; &amp;tria, const Point&lt; dim &gt; &amp;p1, const Point&lt; dim &gt; &amp;p2, const bool colorize=false)</div></div>
<div class="ttc" id="classFE__DGQ_html"><div class="ttname"><a href="classFE__DGQ.html">FE_DGQ</a></div><div class="ttdef"><b>Definition:</b> <a href="fe__dgq_8h_source.html#l00079">fe_dgq.h:79</a></div></div>
<div class="ttc" id="classDataOut_html_a087f63e22f0614bca326dbdca288c646"><div class="ttname"><a href="classDataOut.html#a087f63e22f0614bca326dbdca288c646">DataOut::build_patches</a></div><div class="ttdeci">virtual void build_patches(const unsigned int n_subdivisions=0)</div><div class="ttdef"><b>Definition:</b> <a href="numerics_2data__out_8cc_source.html#l01071">data_out.cc:1071</a></div></div>
<div class="ttc" id="classLinearAlgebra_1_1distributed_1_1Vector_html_ace027311492ed2f6e07fbd74d723e3a9"><div class="ttname"><a href="classLinearAlgebra_1_1distributed_1_1Vector.html#ace027311492ed2f6e07fbd74d723e3a9">LinearAlgebra::distributed::Vector::reinit</a></div><div class="ttdeci">void reinit(const size_type size, const bool omit_zeroing_entries=false)</div></div>
<div class="ttc" id="namespaceLocalIntegrators_1_1Divergence_html_a8bcfc37d2a2be8faa18628a601ecf112"><div class="ttname"><a href="namespaceLocalIntegrators_1_1Divergence.html#a8bcfc37d2a2be8faa18628a601ecf112">LocalIntegrators::Divergence::norm</a></div><div class="ttdeci">double norm(const FEValuesBase&lt; dim &gt; &amp;fe, const ArrayView&lt; const std::vector&lt; Tensor&lt; 1, dim &gt;&gt;&gt; &amp;Du)</div><div class="ttdef"><b>Definition:</b> <a href="divergence_8h_source.html#l00462">divergence.h:462</a></div></div>
<div class="ttc" id="namespacestd_html"><div class="ttname"><a href="namespacestd.html">std</a></div><div class="ttdoc">STL namespace. </div></div>
<div class="ttc" id="structMatrixFree_1_1AdditionalData_html_aa326b1a098e1c037334cc05bdc2decc6"><div class="ttname"><a href="structMatrixFree_1_1AdditionalData.html#aa326b1a098e1c037334cc05bdc2decc6">MatrixFree::AdditionalData::mapping_update_flags_boundary_faces</a></div><div class="ttdeci">UpdateFlags mapping_update_flags_boundary_faces</div><div class="ttdef"><b>Definition:</b> <a href="matrix__free_8h_source.html#l00296">matrix_free.h:296</a></div></div>
<div class="ttc" id="group__feaccess_html_ggaa94b67d2fdcc390690c523f28019e52fad5c9ff886b9615349a5d04a6c782df4a"><div class="ttname"><a href="group__feaccess.html#ggaa94b67d2fdcc390690c523f28019e52fad5c9ff886b9615349a5d04a6c782df4a">update_quadrature_points</a></div><div class="ttdoc">Transformed quadrature points. </div><div class="ttdef"><b>Definition:</b> <a href="fe__update__flags_8h_source.html#l00097">fe_update_flags.h:97</a></div></div>
<div class="ttc" id="group__Exceptions_html_gafc0ca7ad85b3ebd64e8e51689ac85caf"><div class="ttname"><a href="group__Exceptions.html#gafc0ca7ad85b3ebd64e8e51689ac85caf">AssertThrow</a></div><div class="ttdeci">#define AssertThrow(cond, exc)</div><div class="ttdef"><b>Definition:</b> <a href="include_2deal_8II_2base_2exceptions_8h_source.html#l01519">exceptions.h:1519</a></div></div>
<div class="ttc" id="structMatrixFree_1_1AdditionalData_html_aa5d597e6c4441d273f4100b6139a2552"><div class="ttname"><a href="structMatrixFree_1_1AdditionalData.html#aa5d597e6c4441d273f4100b6139a2552">MatrixFree::AdditionalData::mapping_update_flags</a></div><div class="ttdeci">UpdateFlags mapping_update_flags</div><div class="ttdef"><b>Definition:</b> <a href="matrix__free_8h_source.html#l00285">matrix_free.h:285</a></div></div>
<div class="ttc" id="namespaceDifferentiation_1_1SD_html_a841a7b84dc17bf2ba675522093a97e8ba945f3fc449518a73b9f5f32868db466c"><div class="ttname"><a href="namespaceDifferentiation_1_1SD.html#a841a7b84dc17bf2ba675522093a97e8ba945f3fc449518a73b9f5f32868db466c">Differentiation::SD::OptimizerType::lambda</a></div></div>
<div class="ttc" id="namespaceVectorTools_1_1EvaluationFlags_html_ac6721740e24732d6afabcf28ddfc1ffdaeb244a97c0c9e9e7ca4765e096f0badc"><div class="ttname"><a href="namespaceVectorTools_1_1EvaluationFlags.html#ac6721740e24732d6afabcf28ddfc1ffdaeb244a97c0c9e9e7ca4765e096f0badc">VectorTools::EvaluationFlags::min</a></div><div class="ttdef"><b>Definition:</b> <a href="vector__tools__evaluate_8h_source.html#l00063">vector_tools_evaluate.h:63</a></div></div>
<div class="ttc" id="classPoint_html"><div class="ttname"><a href="classPoint.html">Point&lt; dim &gt;</a></div></div>
<div class="ttc" id="namespaceVectorTools_1_1EvaluationFlags_html_ac6721740e24732d6afabcf28ddfc1ffda8e7f5b8545162dccd5ed717792bdf420"><div class="ttname"><a href="namespaceVectorTools_1_1EvaluationFlags.html#ac6721740e24732d6afabcf28ddfc1ffda8e7f5b8545162dccd5ed717792bdf420">VectorTools::EvaluationFlags::max</a></div><div class="ttdef"><b>Definition:</b> <a href="vector__tools__evaluate_8h_source.html#l00057">vector_tools_evaluate.h:57</a></div></div>
<div class="ttc" id="namespacePhysics_1_1Elasticity_1_1Kinematics_html_aa87528a28ad8a95fa89a3876e6f986c8"><div class="ttname"><a href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#aa87528a28ad8a95fa89a3876e6f986c8">Physics::Elasticity::Kinematics::F</a></div><div class="ttdeci">Tensor&lt; 2, dim, Number &gt; F(const Tensor&lt; 2, dim, Number &gt; &amp;Grad_u)</div></div>
<div class="ttc" id="namespaceparallel_html"><div class="ttname"><a href="namespaceparallel.html">parallel</a></div><div class="ttdef"><b>Definition:</b> <a href="distributed_8h_source.html#l00150">distributed.h:150</a></div></div>
<div class="ttc" id="namespaceUtilities_html_a0900f35b37ee122e73fb2c80bba9beb9"><div class="ttname"><a href="namespaceUtilities.html#a0900f35b37ee122e73fb2c80bba9beb9">Utilities::pow</a></div><div class="ttdeci">constexpr T pow(const T base, const int iexp)</div><div class="ttdef"><b>Definition:</b> <a href="include_2deal_8II_2base_2utilities_8h_source.html#l00410">utilities.h:410</a></div></div>
<div class="ttc" id="classDataOutInterface_html_a5df488dad82b811ceb08cb1adf9eafcd"><div class="ttname"><a href="classDataOutInterface.html#a5df488dad82b811ceb08cb1adf9eafcd">DataOutInterface::write_vtu_in_parallel</a></div><div class="ttdeci">void write_vtu_in_parallel(const std::string &amp;filename, const MPI_Comm &amp;comm) const</div><div class="ttdef"><b>Definition:</b> <a href="data__out__base_8cc_source.html#l07254">data_out_base.cc:7254</a></div></div>
<div class="ttc" id="classMatrixFree_html"><div class="ttname"><a href="classMatrixFree.html">MatrixFree</a></div><div class="ttdef"><b>Definition:</b> <a href="matrix__free_8h_source.html#l00093">matrix_free.h:93</a></div></div>
<div class="ttc" id="classFunctionTime_html_a8932e3ec9ed7b6f6d6a91c23f82e36d8"><div class="ttname"><a href="classFunctionTime.html#a8932e3ec9ed7b6f6d6a91c23f82e36d8">FunctionTime&lt; numbers::NumberTraits&lt; RangeNumberType &gt;::real_type &gt;::time</a></div><div class="ttdeci">numbers::NumberTraits&lt; RangeNumberType &gt;::real_type time</div><div class="ttdef"><b>Definition:</b> <a href="function__time_8h_source.html#l00092">function_time.h:92</a></div></div>
<div class="ttc" id="namespaceEvaluationFlags_html_a9b7c6d689cb76386839d0d13640f59aea5f2c95ea073cc4f276c70ae12aceb88c"><div class="ttname"><a href="namespaceEvaluationFlags.html#a9b7c6d689cb76386839d0d13640f59aea5f2c95ea073cc4f276c70ae12aceb88c">EvaluationFlags::nothing</a></div><div class="ttdef"><b>Definition:</b> <a href="evaluation__flags_8h_source.html#l00049">evaluation_flags.h:49</a></div></div>
<div class="ttc" id="namespaceFunctions_html"><div class="ttname"><a href="namespaceFunctions.html">Functions</a></div><div class="ttdef"><b>Definition:</b> <a href="flow__function_8h_source.html#l00029">flow_function.h:29</a></div></div>
<div class="ttc" id="classQGauss_html"><div class="ttname"><a href="classQGauss.html">QGauss</a></div><div class="ttdef"><b>Definition:</b> <a href="quadrature__lib_8h_source.html#l00039">quadrature_lib.h:39</a></div></div>
<div class="ttc" id="namespaceGridTools_html"><div class="ttname"><a href="namespaceGridTools.html">GridTools</a></div><div class="ttdef"><b>Definition:</b> <a href="grid__tools_8h_source.html#l00126">grid_tools.h:126</a></div></div>
<div class="ttc" id="classFEEvaluationBase_html"><div class="ttname"><a href="classFEEvaluationBase.html">FEEvaluationBase</a></div><div class="ttdef"><b>Definition:</b> <a href="fe__evaluation_8h_source.html#l00521">fe_evaluation.h:521</a></div></div>
<div class="ttc" id="namespacenumbers_html_a3c7239f00d5e87dfcf6dd19cbc3ddc74"><div class="ttname"><a href="namespacenumbers.html#a3c7239f00d5e87dfcf6dd19cbc3ddc74">numbers::E</a></div><div class="ttdeci">static constexpr double E</div><div class="ttdef"><b>Definition:</b> <a href="numbers_8h_source.html#l00193">numbers.h:193</a></div></div>
<div class="ttc" id="classFEFaceEvaluation_html"><div class="ttname"><a href="classFEFaceEvaluation.html">FEFaceEvaluation</a></div><div class="ttdef"><b>Definition:</b> <a href="fe__evaluation_8h_source.html#l02547">fe_evaluation.h:2547</a></div></div>
<div class="ttc" id="classFunctions_1_1ConstantFunction_html"><div class="ttname"><a href="classFunctions_1_1ConstantFunction.html">Functions::ConstantFunction</a></div><div class="ttdef"><b>Definition:</b> <a href="function_8h_source.html#l00348">function.h:348</a></div></div>
<div class="ttc" id="classMatrixFree_html_adb324d469b296f2a6921b41208732ddf"><div class="ttname"><a href="classMatrixFree.html#adb324d469b296f2a6921b41208732ddf">MatrixFree::reinit</a></div><div class="ttdeci">void reinit(const MappingType &amp;mapping, const DoFHandler&lt; dim &gt; &amp;dof_handler, const AffineConstraints&lt; number2 &gt; &amp;constraint, const QuadratureType &amp;quad, const AdditionalData &amp;additional_data=AdditionalData())</div></div>
<div class="ttc" id="group__Exceptions_html_gae9a45f517af1401c50811a11083f9114"><div class="ttname"><a href="group__Exceptions.html#gae9a45f517af1401c50811a11083f9114">StandardExceptions::ExcMessage</a></div><div class="ttdeci">static ::ExceptionBase &amp; ExcMessage(std::string arg1)</div></div>
<div class="ttc" id="classMatrixFree_html_a0e9669e4a5cfaceac78f5e26c285c2ea"><div class="ttname"><a href="classMatrixFree.html#a0e9669e4a5cfaceac78f5e26c285c2ea">MatrixFree::loop</a></div><div class="ttdeci">void loop(const std::function&lt; void(const MatrixFree&lt; dim, Number, VectorizedArrayType &gt; &amp;, OutVector &amp;, const InVector &amp;, const std::pair&lt; unsigned int, unsigned int &gt; &amp;)&gt; &amp;cell_operation, const std::function&lt; void(const MatrixFree&lt; dim, Number, VectorizedArrayType &gt; &amp;, OutVector &amp;, const InVector &amp;, const std::pair&lt; unsigned int, unsigned int &gt; &amp;)&gt; &amp;face_operation, const std::function&lt; void(const MatrixFree&lt; dim, Number, VectorizedArrayType &gt; &amp;, OutVector &amp;, const InVector &amp;, const std::pair&lt; unsigned int, unsigned int &gt; &amp;)&gt; &amp;boundary_operation, OutVector &amp;dst, const InVector &amp;src, const bool zero_dst_vector=false, const DataAccessOnFaces dst_vector_face_access=DataAccessOnFaces::unspecified, const DataAccessOnFaces src_vector_face_access=DataAccessOnFaces::unspecified) const</div></div>
<div class="ttc" id="classMappingQGeneric_html"><div class="ttname"><a href="classMappingQGeneric.html">MappingQGeneric</a></div><div class="ttdef"><b>Definition:</b> <a href="mapping__q__generic_8h_source.html#l00084">mapping_q_generic.h:84</a></div></div>
<div class="ttc" id="namespaceEvaluationFlags_html_a9b7c6d689cb76386839d0d13640f59aea91b5f00e4be473005cc331b8644ab2f1"><div class="ttname"><a href="namespaceEvaluationFlags.html#a9b7c6d689cb76386839d0d13640f59aea91b5f00e4be473005cc331b8644ab2f1">EvaluationFlags::gradients</a></div><div class="ttdef"><b>Definition:</b> <a href="evaluation__flags_8h_source.html#l00059">evaluation_flags.h:59</a></div></div>
<div class="ttc" id="namespaceLAPACKSupport_html_a8cac1e477eff052db622c8a9a9426ea3"><div class="ttname"><a href="namespaceLAPACKSupport.html#a8cac1e477eff052db622c8a9a9426ea3">LAPACKSupport::T</a></div><div class="ttdeci">static const char T</div><div class="ttdef"><b>Definition:</b> <a href="lapack__support_8h_source.html#l00173">lapack_support.h:173</a></div></div>
<div class="ttc" id="namespacetypes_html"><div class="ttname"><a href="namespacetypes.html">types</a></div><div class="ttdef"><b>Definition:</b> <a href="types_8h_source.html#l00033">types.h:33</a></div></div>
<div class="ttc" id="namespaceUtilities_1_1MPI_html_ab544a3bf3301a6dd3e705ee352c5551b"><div class="ttname"><a href="namespaceUtilities_1_1MPI.html#ab544a3bf3301a6dd3e705ee352c5551b">Utilities::MPI::sum</a></div><div class="ttdeci">T sum(const T &amp;t, const MPI_Comm &amp;mpi_communicator)</div></div>
<div class="ttc" id="namespaceGridGenerator_html_a5cdda7b4a76d509af7d1a8dc1320ddb0"><div class="ttname"><a href="namespaceGridGenerator.html#a5cdda7b4a76d509af7d1a8dc1320ddb0">GridGenerator::cylinder</a></div><div class="ttdeci">void cylinder(Triangulation&lt; dim &gt; &amp;tria, const double radius=1., const double half_length=1.)</div></div>
<div class="ttc" id="group__Exceptions_html_ga70a0bb353656e704acf927945277bbc6"><div class="ttname"><a href="group__Exceptions.html#ga70a0bb353656e704acf927945277bbc6">Assert</a></div><div class="ttdeci">#define Assert(cond, exc)</div><div class="ttdef"><b>Definition:</b> <a href="include_2deal_8II_2base_2exceptions_8h_source.html#l01415">exceptions.h:1415</a></div></div>
<div class="ttc" id="classFEEvaluation_html_a1b8934d6ae273d7b3f91994eddcad239"><div class="ttname"><a href="classFEEvaluation.html#a1b8934d6ae273d7b3f91994eddcad239">FEEvaluation::n_q_points</a></div><div class="ttdeci">const unsigned int n_q_points</div><div class="ttdef"><b>Definition:</b> <a href="fe__evaluation_8h_source.html#l02506">fe_evaluation.h:2506</a></div></div>
<div class="ttc" id="group__feaccess_html_gaa94b67d2fdcc390690c523f28019e52f"><div class="ttname"><a href="group__feaccess.html#gaa94b67d2fdcc390690c523f28019e52f">UpdateFlags</a></div><div class="ttdeci">UpdateFlags</div><div class="ttdef"><b>Definition:</b> <a href="fe__update__flags_8h_source.html#l00053">fe_update_flags.h:53</a></div></div>
<div class="ttc" id="namespacestd__cxx17_html_aa2fc1031c06af4aea4de90c5a1905473"><div class="ttname"><a href="namespacestd__cxx17.html#aa2fc1031c06af4aea4de90c5a1905473">std_cxx17::apply</a></div><div class="ttdeci">auto apply(F &amp;&amp;fn, Tuple &amp;&amp;t) -&gt; decltype(apply_impl(std::forward&lt; F &gt;(fn), std::forward&lt; Tuple &gt;(t), std::make_index_sequence&lt; std::tuple_size&lt; typename std::remove_reference&lt; Tuple &gt;::type &gt;::value &gt;()))</div><div class="ttdef"><b>Definition:</b> <a href="tuple_8h_source.html#l00036">tuple.h:36</a></div></div>
<div class="ttc" id="classLinearAlgebra_1_1distributed_1_1Vector_html"><div class="ttname"><a href="classLinearAlgebra_1_1distributed_1_1Vector.html">LinearAlgebra::distributed::Vector&lt; Number &gt;</a></div></div>
<div class="ttc" id="classMapping_html"><div class="ttname"><a href="classMapping.html">Mapping&lt; dim &gt;</a></div></div>
<div class="ttc" id="derivative__form_8h_html_a3c201452e8dd28e4f5be4a316cb9305f"><div class="ttname"><a href="derivative__form_8h.html#a3c201452e8dd28e4f5be4a316cb9305f">transpose</a></div><div class="ttdeci">DerivativeForm&lt; 1, spacedim, dim, Number &gt; transpose(const DerivativeForm&lt; 1, dim, spacedim, Number &gt; &amp;DF)</div><div class="ttdef"><b>Definition:</b> <a href="derivative__form_8h_source.html#l00543">derivative_form.h:543</a></div></div>
<div class="ttc" id="classFESystem_html"><div class="ttname"><a href="classFESystem.html">FESystem</a></div><div class="ttdef"><b>Definition:</b> <a href="include_2deal_8II_2fe_2fe_8h_source.html#l00045">fe.h:45</a></div></div>
<div class="ttc" id="structMatrixFree_1_1AdditionalData_html_a5c25759917955940e0b2b74a6704012c"><div class="ttname"><a href="structMatrixFree_1_1AdditionalData.html#a5c25759917955940e0b2b74a6704012c">MatrixFree::AdditionalData::mapping_update_flags_inner_faces</a></div><div class="ttdeci">UpdateFlags mapping_update_flags_inner_faces</div><div class="ttdef"><b>Definition:</b> <a href="matrix__free_8h_source.html#l00307">matrix_free.h:307</a></div></div>
<div class="ttc" id="classDataPostprocessor_html"><div class="ttname"><a href="classDataPostprocessor.html">DataPostprocessor</a></div><div class="ttdef"><b>Definition:</b> <a href="data__postprocessor_8h_source.html#l00341">data_postprocessor.h:341</a></div></div>
<div class="ttc" id="namespaceTrilinosWrappers_1_1internal_html_aee42c8e3004e2e81eac3c3356d3ec46b"><div class="ttname"><a href="namespaceTrilinosWrappers_1_1internal.html#aee42c8e3004e2e81eac3c3356d3ec46b">TrilinosWrappers::internal::end</a></div><div class="ttdeci">VectorType::value_type * end(VectorType &amp;V)</div><div class="ttdef"><b>Definition:</b> <a href="trilinos__sparse__matrix_8cc_source.html#l00067">trilinos_sparse_matrix.cc:67</a></div></div>
<div class="ttc" id="namespacePatterns_1_1Tools_html_a72743302dcb1a0fb1f2f8dc5122d299e"><div class="ttname"><a href="namespacePatterns_1_1Tools.html#a72743302dcb1a0fb1f2f8dc5122d299e">Patterns::Tools::to_string</a></div><div class="ttdeci">std::string to_string(const T &amp;t)</div><div class="ttdef"><b>Definition:</b> <a href="patterns_8h_source.html#l02231">patterns.h:2231</a></div></div>
<div class="ttc" id="config_8h_html_a1d1d58e8be15e5c4285f6892e5f33136"><div class="ttname"><a href="config_8h.html#a1d1d58e8be15e5c4285f6892e5f33136">DEAL_II_ALWAYS_INLINE</a></div><div class="ttdeci">#define DEAL_II_ALWAYS_INLINE</div><div class="ttdef"><b>Definition:</b> <a href="config_8h_source.html#l00096">config.h:96</a></div></div>
<div class="ttc" id="classTriangulation_html"><div class="ttname"><a href="classTriangulation.html">Triangulation&lt; dim &gt;</a></div></div>
<div class="ttc" id="namespaceDataComponentInterpretation_html_a0cd2da3afe902f9004c23a73dbcc8ab0a1f3cd50135818a6458f1d3ff7ea4bb51"><div class="ttname"><a href="namespaceDataComponentInterpretation.html#a0cd2da3afe902f9004c23a73dbcc8ab0a1f3cd50135818a6458f1d3ff7ea4bb51">DataComponentInterpretation::component_is_scalar</a></div><div class="ttdef"><b>Definition:</b> <a href="data__component__interpretation_8h_source.html#l00051">data_component_interpretation.h:51</a></div></div>
<div class="ttc" id="classDataOut__DoFData_html_a79cbe2f02f8dfb85026c71d783dbb703"><div class="ttname"><a href="classDataOut__DoFData.html#a79cbe2f02f8dfb85026c71d783dbb703">DataOut_DoFData&lt; dim, dim, spacedim, spacedim &gt;::add_data_vector</a></div><div class="ttdeci">void add_data_vector(const VectorType &amp;data, const std::vector&lt; std::string &gt; &amp;names, const DataVectorType type=type_automatic, const std::vector&lt; DataComponentInterpretation::DataComponentInterpretation &gt; &amp;data_component_interpretation=std::vector&lt; DataComponentInterpretation::DataComponentInterpretation &gt;())</div><div class="ttdef"><b>Definition:</b> <a href="data__out__dof__data_8h_source.html#l00902">data_out_dof_data.h:902</a></div></div>
<div class="ttc" id="classVectorizedArrayBase_html_acb35404acc1693aee6e990228924cc09"><div class="ttname"><a href="classVectorizedArrayBase.html#acb35404acc1693aee6e990228924cc09">VectorizedArrayBase&lt; VectorizedArray&lt; Number, width &gt;, 1 &gt;::size</a></div><div class="ttdeci">static constexpr std::size_t size()</div><div class="ttdef"><b>Definition:</b> <a href="vectorization_8h_source.html#l00266">vectorization.h:266</a></div></div>
<div class="ttc" id="classMatrixFree_html_a1d516071d20e633dc9efcadb7852ce15"><div class="ttname"><a href="classMatrixFree.html#a1d516071d20e633dc9efcadb7852ce15">MatrixFree::n_active_entries_per_cell_batch</a></div><div class="ttdeci">unsigned int n_active_entries_per_cell_batch(const unsigned int cell_batch_index) const</div></div>
<div class="ttc" id="classDataOut_html"><div class="ttname"><a href="classDataOut.html">DataOut</a></div><div class="ttdef"><b>Definition:</b> <a href="numerics_2data__out_8h_source.html#l00092">data_out.h:92</a></div></div>
<div class="ttc" id="classLogStream_html_a8028e970ad8388596d625ed463894e98"><div class="ttname"><a href="classLogStream.html#a8028e970ad8388596d625ed463894e98">LogStream::depth_console</a></div><div class="ttdeci">unsigned int depth_console(const unsigned int n)</div><div class="ttdef"><b>Definition:</b> <a href="logstream_8cc_source.html#l00350">logstream.cc:350</a></div></div>
<div class="ttc" id="namespaceLinearAlgebra_html"><div class="ttname"><a href="namespaceLinearAlgebra.html">LinearAlgebra</a></div><div class="ttdef"><b>Definition:</b> <a href="lac_2communication__pattern__base_8h_source.html#l00027">communication_pattern_base.h:27</a></div></div>
<div class="ttc" id="structMatrixFree_1_1AdditionalData_html_a0bcce2facca91b925d3e1a5a00c7704b"><div class="ttname"><a href="structMatrixFree_1_1AdditionalData.html#a0bcce2facca91b925d3e1a5a00c7704b">MatrixFree::AdditionalData::tasks_parallel_scheme</a></div><div class="ttdeci">TasksParallelScheme tasks_parallel_scheme</div><div class="ttdef"><b>Definition:</b> <a href="matrix__free_8h_source.html#l00271">matrix_free.h:271</a></div></div>
<div class="ttc" id="namespaceUtilities_html_a6195c5f009ea8c7c536c6ffdf108c32f"><div class="ttname"><a href="namespaceUtilities.html#a6195c5f009ea8c7c536c6ffdf108c32f">Utilities::int_to_string</a></div><div class="ttdeci">std::string int_to_string(const unsigned int value, const unsigned int digits=numbers::invalid_unsigned_int)</div><div class="ttdef"><b>Definition:</b> <a href="base_2utilities_8cc_source.html#l00473">utilities.cc:473</a></div></div>
<div class="ttc" id="namespacePhysics_1_1Elasticity_1_1Kinematics_html_a15728437b942dab0b0042eb06a407d2c"><div class="ttname"><a href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a15728437b942dab0b0042eb06a407d2c">Physics::Elasticity::Kinematics::d</a></div><div class="ttdeci">SymmetricTensor&lt; 2, dim, Number &gt; d(const Tensor&lt; 2, dim, Number &gt; &amp;F, const Tensor&lt; 2, dim, Number &gt; &amp;dF_dt)</div></div>
<div class="ttc" id="namespaceUtilities_1_1MPI_html_ac26de0c059200523177bb1d92cc25d00"><div class="ttname"><a href="namespaceUtilities_1_1MPI.html#ac26de0c059200523177bb1d92cc25d00">Utilities::MPI::n_mpi_processes</a></div><div class="ttdeci">unsigned int n_mpi_processes(const MPI_Comm &amp;mpi_communicator)</div><div class="ttdef"><b>Definition:</b> <a href="mpi_8cc_source.html#l00117">mpi.cc:117</a></div></div>
<div class="ttc" id="namespaceinternal_1_1TriangulationImplementation_html_a9f815604be9b560fea00beef8d720480"><div class="ttname"><a href="namespaceinternal_1_1TriangulationImplementation.html#a9f815604be9b560fea00beef8d720480">internal::TriangulationImplementation::n_cells</a></div><div class="ttdeci">unsigned int n_cells(const internal::TriangulationImplementation::NumberCache&lt; 1 &gt; &amp;c)</div><div class="ttdef"><b>Definition:</b> <a href="grid_2tria_8cc_source.html#l12588">tria.cc:12588</a></div></div>
<div class="ttc" id="namespaceTimeStepping_html_abff97b5326e452552f108a379dd6cff4a6a1cbeb6dd2a5ed5ac2e3efe3293e941"><div class="ttname"><a href="namespaceTimeStepping.html#abff97b5326e452552f108a379dd6cff4a6a1cbeb6dd2a5ed5ac2e3efe3293e941">TimeStepping::LOW_STORAGE_RK_STAGE9_ORDER5</a></div><div class="ttdef"><b>Definition:</b> <a href="time__stepping_8h_source.html#l00171">time_stepping.h:171</a></div></div>
<div class="ttc" id="namespaceAlgorithms_1_1Events_html_a15a12dfdadd39a026d192ad96cb6207b"><div class="ttname"><a href="namespaceAlgorithms_1_1Events.html#a15a12dfdadd39a026d192ad96cb6207b">Algorithms::Events::initial</a></div><div class="ttdeci">const Event initial</div><div class="ttdef"><b>Definition:</b> <a href="event_8cc_source.html#l00065">event.cc:65</a></div></div>
<div class="ttc" id="namespaceDataComponentInterpretation_html_a0cd2da3afe902f9004c23a73dbcc8ab0"><div class="ttname"><a href="namespaceDataComponentInterpretation.html#a0cd2da3afe902f9004c23a73dbcc8ab0">DataComponentInterpretation::DataComponentInterpretation</a></div><div class="ttdeci">DataComponentInterpretation</div><div class="ttdef"><b>Definition:</b> <a href="data__component__interpretation_8h_source.html#l00045">data_component_interpretation.h:45</a></div></div>
<div class="ttc" id="namespacePhysics_1_1Elasticity_1_1Kinematics_html_a6b25dd8f005063d8d2b0a4bdb0d277f3"><div class="ttname"><a href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a6b25dd8f005063d8d2b0a4bdb0d277f3">Physics::Elasticity::Kinematics::w</a></div><div class="ttdeci">Tensor&lt; 2, dim, Number &gt; w(const Tensor&lt; 2, dim, Number &gt; &amp;F, const Tensor&lt; 2, dim, Number &gt; &amp;dF_dt)</div></div>
<div class="ttc" id="classVectorType_html"><div class="ttname"><a href="classVectorType.html">VectorType</a></div></div>
<div class="ttc" id="classTimerOutput_html"><div class="ttname"><a href="classTimerOutput.html">TimerOutput</a></div><div class="ttdef"><b>Definition:</b> <a href="timer_8h_source.html#l00512">timer.h:512</a></div></div>
<div class="ttc" id="namespaceUtilities_html"><div class="ttname"><a href="namespaceUtilities.html">Utilities</a></div><div class="ttdef"><b>Definition:</b> <a href="base_2communication__pattern__base_8h_source.html#l00031">communication_pattern_base.h:31</a></div></div>
<div class="ttc" id="vectorization_8h_html_ae5c8b2cd70b2640bab8f1ee4ccb7f4cc"><div class="ttname"><a href="vectorization_8h.html#ae5c8b2cd70b2640bab8f1ee4ccb7f4cc">std::pow</a></div><div class="ttdeci">inline ::VectorizedArray&lt; Number, width &gt; pow(const ::VectorizedArray&lt; Number, width &gt; &amp;x, const ::VectorizedArray&lt; Number, width &gt; &amp;p)</div><div class="ttdef"><b>Definition:</b> <a href="vectorization_8h_source.html#l05480">vectorization.h:5480</a></div></div>
<div class="ttc" id="classFEEvaluationBaseData_html_adad456112f01b19291e7781fb5efee55"><div class="ttname"><a href="classFEEvaluationBaseData.html#adad456112f01b19291e7781fb5efee55">FEEvaluationBaseData::inverse_jacobian</a></div><div class="ttdeci">Tensor&lt; 2, dim, VectorizedArrayType &gt; inverse_jacobian(const unsigned int q_point) const</div></div>
<div class="ttc" id="classTensor_html"><div class="ttname"><a href="classTensor.html">Tensor&lt; 1, dim, Number &gt;</a></div></div>
<div class="ttc" id="namespacenumbers_html_a3e24f194a9cb9b6ff4442b8a7a877d4a"><div class="ttname"><a href="namespacenumbers.html#a3e24f194a9cb9b6ff4442b8a7a877d4a">numbers::PI</a></div><div class="ttdeci">static constexpr double PI</div><div class="ttdef"><b>Definition:</b> <a href="numbers_8h_source.html#l00223">numbers.h:223</a></div></div>
<div class="ttc" id="namespaceTrilinosWrappers_1_1internal_html_ad88a9499e01173b35d78413e5945e020"><div class="ttname"><a href="namespaceTrilinosWrappers_1_1internal.html#ad88a9499e01173b35d78413e5945e020">TrilinosWrappers::internal::begin</a></div><div class="ttdeci">VectorType::value_type * begin(VectorType &amp;V)</div><div class="ttdef"><b>Definition:</b> <a href="trilinos__sparse__matrix_8cc_source.html#l00053">trilinos_sparse_matrix.cc:53</a></div></div>
<div class="ttc" id="classDataOut__DoFData_html_a6ed7c846331069f406b8c9933c37fda4"><div class="ttname"><a href="classDataOut__DoFData.html#a6ed7c846331069f406b8c9933c37fda4">DataOut_DoFData::attach_dof_handler</a></div><div class="ttdeci">void attach_dof_handler(const DoFHandler&lt; dim, spacedim &gt; &amp;)</div></div>
<div class="ttc" id="group__feaccess_html_ggaa94b67d2fdcc390690c523f28019e52facbcc430975fa6af05f75ca786dc6fe20"><div class="ttname"><a href="group__feaccess.html#ggaa94b67d2fdcc390690c523f28019e52facbcc430975fa6af05f75ca786dc6fe20">update_gradients</a></div><div class="ttdoc">Shape function gradients. </div><div class="ttdef"><b>Definition:</b> <a href="fe__update__flags_8h_source.html#l00068">fe_update_flags.h:68</a></div></div>
<div class="ttc" id="namespaceUtilities_1_1MPI_html_a9ac5275c3c74902f8a9d6e7bdb514179"><div class="ttname"><a href="namespaceUtilities_1_1MPI.html#a9ac5275c3c74902f8a9d6e7bdb514179">Utilities::MPI::min</a></div><div class="ttdeci">T min(const T &amp;t, const MPI_Comm &amp;mpi_communicator)</div></div>
<div class="ttc" id="group__feaccess_html_ggaa94b67d2fdcc390690c523f28019e52fa5e7366a91c84a50ca4e7dbd43ca6369f"><div class="ttname"><a href="group__feaccess.html#ggaa94b67d2fdcc390690c523f28019e52fa5e7366a91c84a50ca4e7dbd43ca6369f">update_normal_vectors</a></div><div class="ttdoc">Normal vectors. </div><div class="ttdef"><b>Definition:</b> <a href="fe__update__flags_8h_source.html#l00109">fe_update_flags.h:109</a></div></div>
<div class="ttc" id="classTimerOutput_html_a643d0e642b80048e91b37109fe9357cbaed9deac359496981f6275d6d6962e652"><div class="ttname"><a href="classTimerOutput.html#a643d0e642b80048e91b37109fe9357cbaed9deac359496981f6275d6d6962e652">TimerOutput::never</a></div><div class="ttdef"><b>Definition:</b> <a href="timer_8h_source.html#l00586">timer.h:586</a></div></div>
<div class="ttc" id="classUtilities_1_1MPI_1_1MPI__InitFinalize_html"><div class="ttname"><a href="classUtilities_1_1MPI_1_1MPI__InitFinalize.html">Utilities::MPI::MPI_InitFinalize</a></div><div class="ttdef"><b>Definition:</b> <a href="mpi_8h_source.html#l00742">mpi.h:742</a></div></div>
<div class="ttc" id="structDataPostprocessorInputs_1_1Vector_html"><div class="ttname"><a href="structDataPostprocessorInputs_1_1Vector.html">DataPostprocessorInputs::Vector</a></div><div class="ttdef"><b>Definition:</b> <a href="data__postprocessor_8h_source.html#l00247">data_postprocessor.h:247</a></div></div>
<div class="ttc" id="classDoFHandler_html"><div class="ttname"><a href="classDoFHandler.html">DoFHandler&lt; dim &gt;</a></div></div>
<div class="ttc" id="namespaceTimeStepping_html_abff97b5326e452552f108a379dd6cff4"><div class="ttname"><a href="namespaceTimeStepping.html#abff97b5326e452552f108a379dd6cff4">TimeStepping::runge_kutta_method</a></div><div class="ttdeci">runge_kutta_method</div><div class="ttdef"><b>Definition:</b> <a href="time__stepping_8h_source.html#l00125">time_stepping.h:125</a></div></div>
<div class="ttc" id="data__out__base_8cc_html_a8188ef4709fc9a4cc076d37447783ba1"><div class="ttname"><a href="data__out__base_8cc.html#a8188ef4709fc9a4cc076d37447783ba1">center</a></div><div class="ttdeci">Point&lt; 3 &gt; center</div><div class="ttdef"><b>Definition:</b> <a href="data__out__base_8cc_source.html#l00170">data_out_base.cc:170</a></div></div>
<div class="ttc" id="namespaceUtilities_1_1MPI_html_a895dcd8223a0ee6f0e6a80b80e2d5982"><div class="ttname"><a href="namespaceUtilities_1_1MPI.html#a895dcd8223a0ee6f0e6a80b80e2d5982">Utilities::MPI::this_mpi_process</a></div><div class="ttdeci">unsigned int this_mpi_process(const MPI_Comm &amp;mpi_communicator)</div><div class="ttdef"><b>Definition:</b> <a href="mpi_8cc_source.html#l00128">mpi.cc:128</a></div></div>
<div class="ttc" id="group__Exceptions_html_ga7b52b286796c23ef9ff178faf7a4b68f"><div class="ttname"><a href="group__Exceptions.html#ga7b52b286796c23ef9ff178faf7a4b68f">StandardExceptions::ExcNotImplemented</a></div><div class="ttdeci">static ::ExceptionBase &amp; ExcNotImplemented()</div></div>
<div class="ttc" id="namespaceTimeStepping_html_abff97b5326e452552f108a379dd6cff4aba5c997ffa7c63d0c0f6b046a53d63bf"><div class="ttname"><a href="namespaceTimeStepping.html#abff97b5326e452552f108a379dd6cff4aba5c997ffa7c63d0c0f6b046a53d63bf">TimeStepping::LOW_STORAGE_RK_STAGE3_ORDER3</a></div><div class="ttdef"><b>Definition:</b> <a href="time__stepping_8h_source.html#l00153">time_stepping.h:153</a></div></div>
<div class="ttc" id="classparallel_1_1distributed_1_1Triangulation_html"><div class="ttname"><a href="classparallel_1_1distributed_1_1Triangulation.html">parallel::distributed::Triangulation&lt; dim &gt;</a></div></div>
<div class="ttc" id="namespaceOpenCASCADE_html_a9509efa83e3b2fa42616fe0623cba696"><div class="ttname"><a href="namespaceOpenCASCADE.html#a9509efa83e3b2fa42616fe0623cba696">OpenCASCADE::point</a></div><div class="ttdeci">Point&lt; spacedim &gt; point(const gp_Pnt &amp;p, const double tolerance=1e-10)</div><div class="ttdef"><b>Definition:</b> <a href="opencascade_2utilities_8cc_source.html#l00188">utilities.cc:188</a></div></div>
<div class="ttc" id="namespaceEvaluationFlags_html_a9b7c6d689cb76386839d0d13640f59aeaf9825c682f693a6a200094641a0d6a58"><div class="ttname"><a href="namespaceEvaluationFlags.html#a9b7c6d689cb76386839d0d13640f59aeaf9825c682f693a6a200094641a0d6a58">EvaluationFlags::values</a></div><div class="ttdef"><b>Definition:</b> <a href="evaluation__flags_8h_source.html#l00054">evaluation_flags.h:54</a></div></div>
<div class="ttc" id="complex__overloads_8h_html_a285c79b547d28de482e34d02cee71bb2"><div class="ttname"><a href="complex__overloads_8h.html#a285c79b547d28de482e34d02cee71bb2">operator*</a></div><div class="ttdeci">std::enable_if&lt; std::is_floating_point&lt; T &gt;::value &amp;&amp;std::is_floating_point&lt; U &gt;::value, typename ProductType&lt; std::complex&lt; T &gt;, std::complex&lt; U &gt; &gt;::type &gt;::type operator*(const std::complex&lt; T &gt; &amp;left, const std::complex&lt; U &gt; &amp;right)</div><div class="ttdef"><b>Definition:</b> <a href="complex__overloads_8h_source.html#l00043">complex_overloads.h:43</a></div></div>
<div class="ttc" id="p4est__wrappers_8cc_html_ace00f2f80d9780ef9aa1007e1c22c6a4"><div class="ttname"><a href="p4est__wrappers_8cc.html#ace00f2f80d9780ef9aa1007e1c22c6a4">triangulation</a></div><div class="ttdeci">const ::parallel::distributed::Triangulation&lt; dim, spacedim &gt; * triangulation</div><div class="ttdef"><b>Definition:</b> <a href="p4est__wrappers_8cc_source.html#l00069">p4est_wrappers.cc:69</a></div></div>
<div class="ttc" id="namespaceUtilities_1_1System_html_ade631a789101336840371e3b2e2851e0"><div class="ttname"><a href="namespaceUtilities_1_1System.html#ade631a789101336840371e3b2e2851e0">Utilities::System::get_current_vectorization_level</a></div><div class="ttdeci">const std::string get_current_vectorization_level()</div><div class="ttdef"><b>Definition:</b> <a href="base_2utilities_8cc_source.html#l00944">utilities.cc:944</a></div></div>
<div class="ttc" id="classFunctionTime_html_ae7d37ddb04314b38cf67c6cba22923f6"><div class="ttname"><a href="classFunctionTime.html#ae7d37ddb04314b38cf67c6cba22923f6">FunctionTime&lt; numbers::NumberTraits&lt; RangeNumberType &gt;::real_type &gt;::get_time</a></div><div class="ttdeci">numbers::NumberTraits&lt; RangeNumberType &gt;::real_type get_time() const</div></div>
<div class="ttc" id="structDataOutBase_1_1VtkFlags_html_aa9dd1830c0ff35a2431704c4d45453eb"><div class="ttname"><a href="structDataOutBase_1_1VtkFlags.html#aa9dd1830c0ff35a2431704c4d45453eb">DataOutBase::VtkFlags::write_higher_order_cells</a></div><div class="ttdeci">bool write_higher_order_cells</div><div class="ttdef"><b>Definition:</b> <a href="data__out__base_8h_source.html#l00944">data_out_base.h:944</a></div></div>
<div class="ttc" id="classFunction_html_acbfcab66b2fc63bfea59268f40772bb4"><div class="ttname"><a href="classFunction.html#acbfcab66b2fc63bfea59268f40772bb4">Function::value</a></div><div class="ttdeci">virtual RangeNumberType value(const Point&lt; dim &gt; &amp;p, const unsigned int component=0) const</div></div>
<div class="ttc" id="namespaceinternal_1_1QGaussLobatto_html_ac1aec52fdbb26c78e2d32fc0bed659c7"><div class="ttname"><a href="namespaceinternal_1_1QGaussLobatto.html#ac1aec52fdbb26c78e2d32fc0bed659c7">internal::QGaussLobatto::gamma</a></div><div class="ttdeci">long double gamma(const unsigned int n)</div><div class="ttdef"><b>Definition:</b> <a href="quadrature__lib_8cc_source.html#l00096">quadrature_lib.cc:96</a></div></div>
<div class="ttc" id="namespacedealii_html"><div class="ttname"><a href="namespacedealii.html">dealii</a></div><div class="ttdef"><b>Definition:</b> <a href="namespace__dealii_8h_source.html#l00024">namespace_dealii.h:24</a></div></div>
<div class="ttc" id="namespaceVectorTools_html_a676190d2c897ac5da68a9c460fa95832"><div class="ttname"><a href="namespaceVectorTools.html#a676190d2c897ac5da68a9c460fa95832">VectorTools::integrate_difference</a></div><div class="ttdeci">void integrate_difference(const Mapping&lt; dim, spacedim &gt; &amp;mapping, const DoFHandler&lt; dim, spacedim &gt; &amp;dof, const InVector &amp;fe_function, const Function&lt; spacedim, typename InVector::value_type &gt; &amp;exact_solution, OutVector &amp;difference, const Quadrature&lt; dim &gt; &amp;q, const NormType &amp;norm, const Function&lt; spacedim, double &gt; *weight=nullptr, const double exponent=2.)</div></div>
<div class="ttc" id="classConditionalOStream_html"><div class="ttname"><a href="classConditionalOStream.html">ConditionalOStream</a></div><div class="ttdef"><b>Definition:</b> <a href="conditional__ostream_8h_source.html#l00070">conditional_ostream.h:70</a></div></div>
<div class="ttc" id="namespacetypes_html_aed8813fee8c8a2edcc6005e6a48c321a"><div class="ttname"><a href="namespacetypes.html#aed8813fee8c8a2edcc6005e6a48c321a">types::boundary_id</a></div><div class="ttdeci">unsigned int boundary_id</div><div class="ttdef"><b>Definition:</b> <a href="types_8h_source.html#l00108">types.h:108</a></div></div>
<div class="ttc" id="classFEFaceEvaluation_html_a92f84b8ad276ca9866f30c6f789cf3a4"><div class="ttname"><a href="classFEFaceEvaluation.html#a92f84b8ad276ca9866f30c6f789cf3a4">FEFaceEvaluation::evaluate</a></div><div class="ttdeci">void evaluate(const EvaluationFlags::EvaluationFlags evaluation_flag)</div></div>
<div class="ttc" id="classTimerOutput_html_ae7673798226de7731e3ecdf7c0fb7568"><div class="ttname"><a href="classTimerOutput.html#ae7673798226de7731e3ecdf7c0fb7568">TimerOutput::print_wall_time_statistics</a></div><div class="ttdeci">void print_wall_time_statistics(const MPI_Comm &amp;mpi_comm, const double print_quantile=0.) const</div><div class="ttdef"><b>Definition:</b> <a href="timer_8cc_source.html#l00844">timer.cc:844</a></div></div>
<div class="ttc" id="classTimerOutput_1_1Scope_html"><div class="ttname"><a href="classTimerOutput_1_1Scope.html">TimerOutput::Scope</a></div><div class="ttdef"><b>Definition:</b> <a href="timer_8h_source.html#l00519">timer.h:519</a></div></div>
<div class="ttc" id="namespaceUtilities_1_1MPI_html_ad2f716b789abe53715d6659f38aa7815"><div class="ttname"><a href="namespaceUtilities_1_1MPI.html#ad2f716b789abe53715d6659f38aa7815">Utilities::MPI::max</a></div><div class="ttdeci">T max(const T &amp;t, const MPI_Comm &amp;mpi_communicator)</div></div>
<div class="ttc" id="namespaceVectorTools_html_ac6b404bf03cb2a742b290421cc2789fe"><div class="ttname"><a href="namespaceVectorTools.html#ac6b404bf03cb2a742b290421cc2789fe">VectorTools::project</a></div><div class="ttdeci">void project(const Mapping&lt; dim, spacedim &gt; &amp;mapping, const DoFHandler&lt; dim, spacedim &gt; &amp;dof, const AffineConstraints&lt; typename VectorType::value_type &gt; &amp;constraints, const Quadrature&lt; dim &gt; &amp;quadrature, const Function&lt; spacedim, typename VectorType::value_type &gt; &amp;function, VectorType &amp;vec, const bool enforce_zero_boundary=false, const Quadrature&lt; dim - 1 &gt; &amp;q_boundary=(dim &gt; 1 ? QGauss&lt; dim - 1 &gt;(2) :Quadrature&lt; dim - 1 &gt;(0)), const bool project_to_boundary_first=false)</div></div>
<div class="ttc" id="classFEEvaluationBase_html_a459813036810fbdc3c5487309b118fd8"><div class="ttname"><a href="classFEEvaluationBase.html#a459813036810fbdc3c5487309b118fd8">FEEvaluationBase::set_dof_values</a></div><div class="ttdeci">void set_dof_values(VectorType &amp;dst, const unsigned int first_index=0, const std::bitset&lt; VectorizedArrayType::size()&gt; &amp;mask=std::bitset&lt; VectorizedArrayType::size()&gt;().flip()) const</div></div>
<div class="ttc" id="config_8h_html_a202e950262df75b31ea0486f4dd2447f"><div class="ttname"><a href="config_8h.html#a202e950262df75b31ea0486f4dd2447f">DEAL_II_OPENMP_SIMD_PRAGMA</a></div><div class="ttdeci">#define DEAL_II_OPENMP_SIMD_PRAGMA</div><div class="ttdef"><b>Definition:</b> <a href="config_8h_source.html#l00136">config.h:136</a></div></div>
<div class="ttc" id="namespaceTimeStepping_html_abff97b5326e452552f108a379dd6cff4af4a68ccb74e043ac956cddf23fa57e48"><div class="ttname"><a href="namespaceTimeStepping.html#abff97b5326e452552f108a379dd6cff4af4a68ccb74e043ac956cddf23fa57e48">TimeStepping::LOW_STORAGE_RK_STAGE5_ORDER4</a></div><div class="ttdef"><b>Definition:</b> <a href="time__stepping_8h_source.html#l00159">time_stepping.h:159</a></div></div>
<div class="ttc" id="classMatrixFreeOperators_1_1CellwiseInverseMassMatrix_html"><div class="ttname"><a href="classMatrixFreeOperators_1_1CellwiseInverseMassMatrix.html">MatrixFreeOperators::CellwiseInverseMassMatrix</a></div><div class="ttdef"><b>Definition:</b> <a href="operators_8h_source.html#l00557">operators.h:557</a></div></div>
<div class="ttc" id="classFEEvaluationBase_html_aeecc76ffeff6b36816f6af20af1398a8"><div class="ttname"><a href="classFEEvaluationBase.html#aeecc76ffeff6b36816f6af20af1398a8">FEEvaluationBase::get_value</a></div><div class="ttdeci">value_type get_value(const unsigned int q_point) const</div></div>
<div class="ttc" id="namespaceVectorTools_1_1EvaluationFlags_html_ac6721740e24732d6afabcf28ddfc1ffdacc8b05748569f308550a239dc5b14396"><div class="ttname"><a href="namespaceVectorTools_1_1EvaluationFlags.html#ac6721740e24732d6afabcf28ddfc1ffdacc8b05748569f308550a239dc5b14396">VectorTools::EvaluationFlags::avg</a></div><div class="ttdef"><b>Definition:</b> <a href="vector__tools__evaluate_8h_source.html#l00051">vector_tools_evaluate.h:51</a></div></div>
<div class="ttc" id="namespaceinternal_1_1p4est_html_a4b980c7b4b4d9984e93d73c7d30173ea"><div class="ttname"><a href="namespaceinternal_1_1p4est.html#a4b980c7b4b4d9984e93d73c7d30173ea">internal::p4est::functions</a></div><div class="ttdeci">int(&amp;) functions(const void *v1, const void *v2)</div><div class="ttdef"><b>Definition:</b> <a href="p4est__wrappers_8cc_source.html#l00339">p4est_wrappers.cc:339</a></div></div>
<div class="ttc" id="namespaceWorkStream_1_1internal_1_1tbb__no__coloring_html_a8673698a405bf47aa24002aeb6d76d70"><div class="ttname"><a href="namespaceWorkStream_1_1internal_1_1tbb__no__coloring.html#a8673698a405bf47aa24002aeb6d76d70">WorkStream::internal::tbb_no_coloring::run</a></div><div class="ttdeci">void run(const Iterator &amp;begin, const typename identity&lt; Iterator &gt;::type &amp;end, Worker worker, Copier copier, const ScratchData &amp;sample_scratch_data, const CopyData &amp;sample_copy_data, const unsigned int queue_length, const unsigned int chunk_size)</div><div class="ttdef"><b>Definition:</b> <a href="work__stream_8h_source.html#l00562">work_stream.h:562</a></div></div>
<div class="ttc" id="classMatrixFreeOperators_1_1CellwiseInverseMassMatrix_html_a5e95a87a9c63b321c77c72b8d762b760"><div class="ttname"><a href="classMatrixFreeOperators_1_1CellwiseInverseMassMatrix.html#a5e95a87a9c63b321c77c72b8d762b760">MatrixFreeOperators::CellwiseInverseMassMatrix::transform_from_q_points_to_basis</a></div><div class="ttdeci">void transform_from_q_points_to_basis(const unsigned int n_actual_components, const VectorizedArrayType *in_array, VectorizedArrayType *out_array) const</div><div class="ttdef"><b>Definition:</b> <a href="operators_8h_source.html#l00970">operators.h:970</a></div></div>
<div class="ttc" id="vectorization_8h_html_a303f564e3c189251976da401ee2e44fa"><div class="ttname"><a href="vectorization_8h.html#a303f564e3c189251976da401ee2e44fa">std::sqrt</a></div><div class="ttdeci">inline ::VectorizedArray&lt; Number, width &gt; sqrt(const ::VectorizedArray&lt; Number, width &gt; &amp;x)</div><div class="ttdef"><b>Definition:</b> <a href="vectorization_8h_source.html#l05442">vectorization.h:5442</a></div></div>
<div class="ttc" id="group__Exceptions_html_ga31978c026b8b6b5116df30b8e748f6b7"><div class="ttname"><a href="group__Exceptions.html#ga31978c026b8b6b5116df30b8e748f6b7">StandardExceptions::ExcInternalError</a></div><div class="ttdeci">static ::ExceptionBase &amp; ExcInternalError()</div></div>
<div class="ttc" id="classLinearAlgebra_1_1distributed_1_1Vector_html_aa6376a098589519491fc452d1529f57b"><div class="ttname"><a href="classLinearAlgebra_1_1distributed_1_1Vector.html#aa6376a098589519491fc452d1529f57b">LinearAlgebra::distributed::Vector::sadd</a></div><div class="ttdeci">virtual void sadd(const Number s, const Number a, const VectorSpaceVector&lt; Number &gt; &amp;V) override</div></div>
<div class="ttc" id="classFEEvaluation_html"><div class="ttname"><a href="classFEEvaluation.html">FEEvaluation</a></div><div class="ttdef"><b>Definition:</b> <a href="fe__evaluation_8h_source.html#l00071">fe_evaluation.h:71</a></div></div>
</div><!-- fragment --></div><!-- contents -->
<!-- HTML footer for doxygen 1.8.13-->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.13
</small></address>
</body>
</html>
