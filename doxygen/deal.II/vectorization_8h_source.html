<!-- HTML header for doxygen 1.8.13-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<link rel="canonical" href="https://www.dealii.org/current/doxygen/deal.II/vectorization_8h_source.html" />
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.13"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>The deal.II Library: include/deal.II/base/vectorization.h Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js", "TeX/AMSmath.js", "TeX/AMSsymbols.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
</script><script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="stylesheet.css" rel="stylesheet" type="text/css"/>
<link rel="SHORTCUT ICON" href="deal.ico"></link>
<script type="text/javascript" src="custom.js"></script>
<meta name="author" content="The deal.II Authors <authors@dealii.org>"></meta>
<meta name="copyright" content="Copyright (C) 1998 - 2021 by the deal.II authors"></meta>
<meta name="deal.II-version" content="10.0.0-pre"></meta>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="logo200.png"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">
   &#160;<span id="projectnumber">Reference documentation for deal.II version 10.0.0-pre</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!--Extra macros for MathJax:-->
<div style="display:none">
\(\newcommand{\dealvcentcolon}{\mathrel{\mathop{:}}}\)
\(\newcommand{\dealcoloneq}{\dealvcentcolon\mathrel{\mkern-1.2mu}=}\)
\(\newcommand{\jump}[1]{\left[\!\left[ #1 \right]\!\right]}\)
\(\newcommand{\average}[1]{\left\{\!\left\{ #1 \right\}\!\right\}}\)
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_d44c64559bbebec7f509842c48db8b23.html">include</a></li><li class="navelem"><a class="el" href="dir_ee90d91a514b839c31faec7a1d916f67.html">deal.II</a></li><li class="navelem"><a class="el" href="dir_90a2ad6518b731f1dc196d14153b8b6b.html">base</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">vectorization.h</div>  </div>
</div><!--header-->
<div class="contents">
<a href="vectorization_8h.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;<span class="comment">//include/deal.II-translator/base/vectorization_0.txt</span></div><div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;<span class="comment">// ---------------------------------------------------------------------</span></div><div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;<span class="comment">//</span></div><div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;<span class="comment">// Copyright (C) 2011 - 2020 by the deal.II authors</span></div><div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;<span class="comment">//</span></div><div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;<span class="comment">// This file is part of the deal.II library.</span></div><div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;<span class="comment">//</span></div><div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;<span class="comment">// The deal.II library is free software; you can use it, redistribute</span></div><div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;<span class="comment">// it, and/or modify it under the terms of the GNU Lesser General</span></div><div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;<span class="comment">// Public License as published by the Free Software Foundation; either</span></div><div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;<span class="comment">// version 2.1 of the License, or (at your option) any later version.</span></div><div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;<span class="comment">// The full text of the license can be found in the file LICENSE.md at</span></div><div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;<span class="comment">// the top level directory of deal.II.</span></div><div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;<span class="comment">//</span></div><div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;<span class="comment">// ---------------------------------------------------------------------</span></div><div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;</div><div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;</div><div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;<span class="preprocessor">#ifndef dealii_vectorization_h</span></div><div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;<span class="preprocessor">#define dealii_vectorization_h</span></div><div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;</div><div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;<span class="preprocessor">#include &lt;<a class="code" href="config_8h.html">deal.II/base/config.h</a>&gt;</span></div><div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;</div><div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;<span class="preprocessor">#include &lt;<a class="code" href="include_2deal_8II_2base_2exceptions_8h.html">deal.II/base/exceptions.h</a>&gt;</span></div><div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;<span class="preprocessor">#include &lt;<a class="code" href="template__constraints_8h.html">deal.II/base/template_constraints.h</a>&gt;</span></div><div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;</div><div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;<span class="preprocessor">#include &lt;array&gt;</span></div><div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;<span class="preprocessor">#include &lt;cmath&gt;</span></div><div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;</div><div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;<span class="comment">// Note:</span></div><div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;<span class="comment">// The flag DEAL_II_VECTORIZATION_WIDTH_IN_BITS is essentially constructed</span></div><div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;<span class="comment">// according to the following scheme (on x86-based architectures)</span></div><div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;<span class="comment">// #ifdef __AVX512F__</span></div><div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;<span class="comment">// #define DEAL_II_VECTORIZATION_WIDTH_IN_BITS 512</span></div><div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;<span class="comment">// #elif defined (__AVX__)</span></div><div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;<span class="comment">// #define DEAL_II_VECTORIZATION_WIDTH_IN_BITS 256</span></div><div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;<span class="comment">// #elif defined (__SSE2__)</span></div><div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;<span class="comment">// #define DEAL_II_VECTORIZATION_WIDTH_IN_BITS 128</span></div><div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;<span class="comment">// #else</span></div><div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;<span class="comment">// #define DEAL_II_VECTORIZATION_WIDTH_IN_BITS 0</span></div><div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;<span class="comment">// #endif</span></div><div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;<span class="comment">// In addition to checking the flags __AVX512F__, __AVX__ and __SSE2__, a CMake</span></div><div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;<span class="comment">// test, &#39;check_01_cpu_features.cmake&#39;, ensures that these feature are not only</span></div><div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;<span class="comment">// present in the compilation unit but also working properly.</span></div><div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;</div><div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;<span class="preprocessor">#if DEAL_II_VECTORIZATION_WIDTH_IN_BITS &gt; 0</span></div><div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;</div><div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;<span class="comment">// These error messages try to detect the case that deal.II was compiled with</span></div><div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;<span class="comment">// a wider instruction set extension as the current compilation unit, for</span></div><div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;<span class="comment">// example because deal.II was compiled with AVX, but a user project does not</span></div><div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;<span class="comment">// add -march=native or similar flags, making it fall to SSE2. This leads to</span></div><div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;<span class="comment">// very strange errors as the size of data structures differs between the</span></div><div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;<span class="comment">// compiled deal.II code sitting in libdeal_II.so and the user code if not</span></div><div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;<span class="comment">// detected.</span></div><div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;<span class="preprocessor">#  if DEAL_II_VECTORIZATION_WIDTH_IN_BITS &gt;= 256 &amp;&amp; !defined(__AVX__)</span></div><div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;<span class="preprocessor">#    error \</span></div><div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;<span class="preprocessor">      &quot;Mismatch in vectorization capabilities: AVX was detected during configuration of deal.II and switched on, but it is apparently not available for the file you are trying to compile at the moment. Check compilation flags controlling the instruction set, such as -march=native.&quot;</span></div><div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;<span class="preprocessor">#  endif</span></div><div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;<span class="preprocessor">#  if DEAL_II_VECTORIZATION_WIDTH_IN_BITS &gt;= 512 &amp;&amp; !defined(__AVX512F__)</span></div><div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;<span class="preprocessor">#    error \</span></div><div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;<span class="preprocessor">      &quot;Mismatch in vectorization capabilities: AVX-512F was detected during configuration of deal.II and switched on, but it is apparently not available for the file you are trying to compile at the moment. Check compilation flags controlling the instruction set, such as -march=native.&quot;</span></div><div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;<span class="preprocessor">#  endif</span></div><div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;</div><div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;<span class="preprocessor">#  if defined(_MSC_VER)</span></div><div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;<span class="preprocessor">#    include &lt;intrin.h&gt;</span></div><div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;<span class="preprocessor">#  elif defined(__ALTIVEC__)</span></div><div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;<span class="preprocessor">#    include &lt;altivec.h&gt;</span></div><div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;</div><div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;<span class="comment">// altivec.h defines vector, pixel, bool, but we do not use them, so undefine</span></div><div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;<span class="comment">// them before they make trouble</span></div><div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;<span class="preprocessor">#    undef vector</span></div><div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;<span class="preprocessor">#    undef pixel</span></div><div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;<span class="preprocessor">#    undef bool</span></div><div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;<span class="preprocessor">#  else</span></div><div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;<span class="preprocessor">#    include &lt;x86intrin.h&gt;</span></div><div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;<span class="preprocessor">#  endif</span></div><div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;</div><div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;</div><div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;</div><div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;<a class="code" href="config_8h.html#a37029dc5bac94f70ea13386b692956b6">DEAL_II_NAMESPACE_OPEN</a></div><div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;</div><div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;</div><div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;<span class="comment">// Enable the EnableIfScalar type trait for VectorizedArray&lt;Number&gt; such</span></div><div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;<span class="comment">// that it can be used as a Number type in Tensor&lt;rank,dim,Number&gt;, etc.</span></div><div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;</div><div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;<span class="keyword">template</span> &lt;<span class="keyword">typename</span> Number, std::<span class="keywordtype">size_t</span> w<span class="keywordtype">id</span>th&gt;</div><div class="line"><a name="l00087"></a><span class="lineno"><a class="line" href="structEnableIfScalar_3_01VectorizedArray_3_01Number_00_01width_01_4_01_4.html">   87</a></span>&#160;<span class="keyword">struct </span><a class="code" href="structEnableIfScalar.html">EnableIfScalar</a>&lt;<a class="code" href="classVectorizedArray.html">VectorizedArray</a>&lt;Number, width&gt;&gt;</div><div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;{</div><div class="line"><a name="l00089"></a><span class="lineno"><a class="line" href="structEnableIfScalar_3_01VectorizedArray_3_01Number_00_01width_01_4_01_4.html#aa194cf20de34e6bfa06079895a0ecb85">   89</a></span>&#160;  <span class="keyword">using</span> <a class="code" href="classVectorizedArray.html">type</a> = <a class="code" href="classVectorizedArray.html">VectorizedArray&lt;typename EnableIfScalar&lt;Number&gt;::type</a>, width&gt;;</div><div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;};</div><div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;</div><div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;</div><div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;</div><div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;<span class="keyword">template</span> &lt;<span class="keyword">typename</span> T&gt;</div><div class="line"><a name="l00100"></a><span class="lineno"><a class="line" href="classVectorizedArrayIterator.html">  100</a></span>&#160;<span class="keyword">class </span><a class="code" href="classVectorizedArrayIterator.html">VectorizedArrayIterator</a></div><div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;{</div><div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;<span class="keyword">public</span>:</div><div class="line"><a name="l00108"></a><span class="lineno"><a class="line" href="classVectorizedArrayIterator.html#aa88eaef9423311e81e73d13ff20e7c64">  108</a></span>&#160;  <a class="code" href="classVectorizedArrayIterator.html#aa88eaef9423311e81e73d13ff20e7c64">VectorizedArrayIterator</a>(<a class="code" href="namespaceLAPACKSupport.html#a8cac1e477eff052db622c8a9a9426ea3">T</a> &amp;data, <span class="keyword">const</span> std::size_t lane)</div><div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;    : data(&amp;data)</div><div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;    , lane(lane)</div><div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;  {}</div><div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;</div><div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;  <span class="keywordtype">bool</span></div><div class="line"><a name="l00118"></a><span class="lineno"><a class="line" href="classVectorizedArrayIterator.html#a8bf1cdfcc45f1a960d59ccf5c180490b">  118</a></span>&#160;  <a class="code" href="classVectorizedArrayIterator.html#a8bf1cdfcc45f1a960d59ccf5c180490b">operator==</a>(<span class="keyword">const</span> <a class="code" href="classVectorizedArrayIterator.html">VectorizedArrayIterator&lt;T&gt;</a> &amp;other)<span class="keyword"> const</span></div><div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;<span class="keyword">  </span>{</div><div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;    <a class="code" href="group__Exceptions.html#ga70a0bb353656e704acf927945277bbc6">Assert</a>(this-&gt;data == other.<a class="code" href="classVectorizedArrayIterator.html#a3d832202485823dcc45057b7353bc89a">data</a>,</div><div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;           <a class="code" href="group__Exceptions.html#gae9a45f517af1401c50811a11083f9114">ExcMessage</a>(</div><div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;             <span class="stringliteral">&quot;You are trying to compare iterators into different arrays.&quot;</span>));</div><div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;    <span class="keywordflow">return</span> this-&gt;lane == other.<a class="code" href="classVectorizedArrayIterator.html#a396f2193b51e7ef97f6c7f73fa7baf3a">lane</a>;</div><div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;  }</div><div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;</div><div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;  <span class="keywordtype">bool</span></div><div class="line"><a name="l00131"></a><span class="lineno"><a class="line" href="classVectorizedArrayIterator.html#aebfab490af179c78ee97f1407a8cd9bc">  131</a></span>&#160;  <a class="code" href="classVectorizedArrayIterator.html#aebfab490af179c78ee97f1407a8cd9bc">operator!=</a>(<span class="keyword">const</span> <a class="code" href="classVectorizedArrayIterator.html">VectorizedArrayIterator&lt;T&gt;</a> &amp;other)<span class="keyword"> const</span></div><div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;<span class="keyword">  </span>{</div><div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;    <a class="code" href="group__Exceptions.html#ga70a0bb353656e704acf927945277bbc6">Assert</a>(this-&gt;data == other.<a class="code" href="classVectorizedArrayIterator.html#a3d832202485823dcc45057b7353bc89a">data</a>,</div><div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;           <a class="code" href="group__Exceptions.html#gae9a45f517af1401c50811a11083f9114">ExcMessage</a>(</div><div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;             <span class="stringliteral">&quot;You are trying to compare iterators into different arrays.&quot;</span>));</div><div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;    <span class="keywordflow">return</span> this-&gt;lane != other.<a class="code" href="classVectorizedArrayIterator.html#a396f2193b51e7ef97f6c7f73fa7baf3a">lane</a>;</div><div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;  }</div><div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;</div><div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;  <a class="code" href="classVectorizedArrayIterator.html">VectorizedArrayIterator&lt;T&gt;</a> &amp;</div><div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;  operator=(<span class="keyword">const</span> <a class="code" href="classVectorizedArrayIterator.html">VectorizedArrayIterator&lt;T&gt;</a> &amp;other) = <span class="keywordflow">default</span>;</div><div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;</div><div class="line"><a name="l00150"></a><span class="lineno"><a class="line" href="classVectorizedArrayIterator.html#afc5b011dc689df8f4a1cd07e18af4471">  150</a></span>&#160;  <span class="keyword">const</span> <span class="keyword">typename</span> T::value_type &amp;<a class="code" href="classVectorizedArrayIterator.html#afc5b011dc689df8f4a1cd07e18af4471">operator*</a>()<span class="keyword"> const</span></div><div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;<span class="keyword">  </span>{</div><div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;    <a class="code" href="group__Exceptions.html#gaafbb69cc2a791ae55880fd8d57d0c1b0">AssertIndexRange</a>(lane, T::size());</div><div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;    <span class="keywordflow">return</span> (*data)[lane];</div><div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;  }</div><div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;</div><div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;</div><div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;  <span class="keyword">template</span> &lt;<span class="keyword">typename</span> U = T&gt;</div><div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;  <span class="keyword">typename</span> std::enable_if&lt;!std::is_same&lt;U, const U&gt;::value,</div><div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;                          <span class="keyword">typename</span> T::value_type&gt;::type &amp;</div><div class="line"><a name="l00164"></a><span class="lineno"><a class="line" href="classVectorizedArrayIterator.html#ac99439a37b8c798eff7e273d86e751c1">  164</a></span>&#160;  <a class="code" href="classVectorizedArrayIterator.html#ac99439a37b8c798eff7e273d86e751c1">operator*</a>()</div><div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;  {</div><div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;    <a class="code" href="group__Exceptions.html#gaafbb69cc2a791ae55880fd8d57d0c1b0">AssertIndexRange</a>(lane, T::size());</div><div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;    <span class="keywordflow">return</span> (*data)[lane];</div><div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;  }</div><div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;</div><div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;  <a class="code" href="classVectorizedArrayIterator.html">VectorizedArrayIterator&lt;T&gt;</a> &amp;</div><div class="line"><a name="l00175"></a><span class="lineno"><a class="line" href="classVectorizedArrayIterator.html#abcd785ad700ce2660fc5edfe7a960b3b">  175</a></span>&#160;  <a class="code" href="classVectorizedArrayIterator.html#abcd785ad700ce2660fc5edfe7a960b3b">operator++</a>()</div><div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;  {</div><div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;    <a class="code" href="group__Exceptions.html#gaafbb69cc2a791ae55880fd8d57d0c1b0">AssertIndexRange</a>(lane + 1, T::size() + 1);</div><div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;    lane++;</div><div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;    <span class="keywordflow">return</span> *<span class="keyword">this</span>;</div><div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;  }</div><div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;</div><div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;  <a class="code" href="classVectorizedArrayIterator.html">VectorizedArrayIterator&lt;T&gt;</a> &amp;</div><div class="line"><a name="l00188"></a><span class="lineno"><a class="line" href="classVectorizedArrayIterator.html#aab509ac7f9e1c0b9c27e43d9f86147f4">  188</a></span>&#160;  <a class="code" href="classVectorizedArrayIterator.html#aab509ac7f9e1c0b9c27e43d9f86147f4">operator+=</a>(<span class="keyword">const</span> std::size_t offset)</div><div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;  {</div><div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;    <a class="code" href="group__Exceptions.html#gaafbb69cc2a791ae55880fd8d57d0c1b0">AssertIndexRange</a>(lane + offset, T::size() + 1);</div><div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;    lane += offset;</div><div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;    <span class="keywordflow">return</span> *<span class="keyword">this</span>;</div><div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;  }</div><div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;</div><div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;  <a class="code" href="classVectorizedArrayIterator.html">VectorizedArrayIterator&lt;T&gt;</a> &amp;</div><div class="line"><a name="l00200"></a><span class="lineno"><a class="line" href="classVectorizedArrayIterator.html#a2a2b466061bfd63279b534a151904bea">  200</a></span>&#160;  <a class="code" href="classVectorizedArrayIterator.html#a2a2b466061bfd63279b534a151904bea">operator--</a>()</div><div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;  {</div><div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;    <a class="code" href="group__Exceptions.html#ga70a0bb353656e704acf927945277bbc6">Assert</a>(</div><div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;      lane &gt; 0,</div><div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;      <a class="code" href="group__Exceptions.html#gae9a45f517af1401c50811a11083f9114">ExcMessage</a>(</div><div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;        <span class="stringliteral">&quot;You can&#39;t decrement an iterator that is already at the beginning of the range.&quot;</span>));</div><div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;    --lane;</div><div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;    <span class="keywordflow">return</span> *<span class="keyword">this</span>;</div><div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;  }</div><div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;</div><div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;  <a class="code" href="classVectorizedArrayIterator.html">VectorizedArrayIterator&lt;T&gt;</a></div><div class="line"><a name="l00215"></a><span class="lineno"><a class="line" href="classVectorizedArrayIterator.html#a04edb009a66cc9b4710efbf247ddbe92">  215</a></span>&#160;  <a class="code" href="classVectorizedArrayIterator.html#a04edb009a66cc9b4710efbf247ddbe92">operator+</a>(<span class="keyword">const</span> std::size_t &amp;offset)<span class="keyword"> const</span></div><div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;<span class="keyword">  </span>{</div><div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;    <a class="code" href="group__Exceptions.html#gaafbb69cc2a791ae55880fd8d57d0c1b0">AssertIndexRange</a>(lane + offset, T::size() + 1);</div><div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="classVectorizedArrayIterator.html">VectorizedArrayIterator&lt;T&gt;</a>(*data, lane + offset);</div><div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;  }</div><div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;</div><div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;  std::ptrdiff_t</div><div class="line"><a name="l00226"></a><span class="lineno"><a class="line" href="classVectorizedArrayIterator.html#a6ce102e8f469efe6a63bcbed0f643099">  226</a></span>&#160;  <a class="code" href="classVectorizedArrayIterator.html#a6ce102e8f469efe6a63bcbed0f643099">operator-</a>(<span class="keyword">const</span> <a class="code" href="classVectorizedArrayIterator.html">VectorizedArrayIterator&lt;T&gt;</a> &amp;other)<span class="keyword"> const</span></div><div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;<span class="keyword">  </span>{</div><div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">static_cast&lt;</span>std::ptrdiff_t<span class="keyword">&gt;</span>(lane) -</div><div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;           static_cast&lt;ptrdiff_t&gt;(other.<a class="code" href="classVectorizedArrayIterator.html#a396f2193b51e7ef97f6c7f73fa7baf3a">lane</a>);</div><div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;  }</div><div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;</div><div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;<span class="keyword">private</span>:</div><div class="line"><a name="l00237"></a><span class="lineno"><a class="line" href="classVectorizedArrayIterator.html#a3d832202485823dcc45057b7353bc89a">  237</a></span>&#160;  <a class="code" href="namespaceLAPACKSupport.html#a8cac1e477eff052db622c8a9a9426ea3">T</a> *<a class="code" href="classVectorizedArrayIterator.html#a3d832202485823dcc45057b7353bc89a">data</a>;</div><div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;</div><div class="line"><a name="l00243"></a><span class="lineno"><a class="line" href="classVectorizedArrayIterator.html#a396f2193b51e7ef97f6c7f73fa7baf3a">  243</a></span>&#160;  std::size_t <a class="code" href="classVectorizedArrayIterator.html#a396f2193b51e7ef97f6c7f73fa7baf3a">lane</a>;</div><div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;};</div><div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;</div><div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;</div><div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;</div><div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;<span class="keyword">template</span> &lt;<span class="keyword">typename</span> T, std::<span class="keywordtype">size_t</span> w<span class="keywordtype">id</span>th&gt;</div><div class="line"><a name="l00258"></a><span class="lineno"><a class="line" href="classVectorizedArrayBase.html">  258</a></span>&#160;<span class="keyword">class </span><a class="code" href="classVectorizedArrayBase.html">VectorizedArrayBase</a></div><div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;{</div><div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;<span class="keyword">public</span>:</div><div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;  <span class="keyword">static</span> constexpr std::size_t</div><div class="line"><a name="l00266"></a><span class="lineno"><a class="line" href="classVectorizedArrayBase.html#acb35404acc1693aee6e990228924cc09">  266</a></span>&#160;  <a class="code" href="classVectorizedArrayBase.html#acb35404acc1693aee6e990228924cc09">size</a>()</div><div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;  {</div><div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;    <span class="keywordflow">return</span> width;</div><div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;  }</div><div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;</div><div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;  <a class="code" href="classVectorizedArrayIterator.html">VectorizedArrayIterator&lt;T&gt;</a></div><div class="line"><a name="l00276"></a><span class="lineno"><a class="line" href="classVectorizedArrayBase.html#ac3079ced5292fcebec8a4ff8a6bdb0f0">  276</a></span>&#160;  <a class="code" href="classVectorizedArrayBase.html#ac3079ced5292fcebec8a4ff8a6bdb0f0">begin</a>()</div><div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;  {</div><div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="classVectorizedArrayIterator.html">VectorizedArrayIterator&lt;T&gt;</a>(<span class="keyword">static_cast&lt;</span><a class="code" href="namespaceLAPACKSupport.html#a8cac1e477eff052db622c8a9a9426ea3">T</a> &amp;<span class="keyword">&gt;</span>(*this), 0);</div><div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;  }</div><div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;</div><div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;  <a class="code" href="classVectorizedArrayIterator.html">VectorizedArrayIterator&lt;const T&gt;</a></div><div class="line"><a name="l00286"></a><span class="lineno"><a class="line" href="classVectorizedArrayBase.html#a4abc43c177332ab7133ae7b42850c3cc">  286</a></span>&#160;  <a class="code" href="classVectorizedArrayBase.html#a4abc43c177332ab7133ae7b42850c3cc">begin</a>()<span class="keyword"> const</span></div><div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;<span class="keyword">  </span>{</div><div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="classVectorizedArrayIterator.html">VectorizedArrayIterator&lt;const T&gt;</a>(<span class="keyword">static_cast&lt;</span><span class="keyword">const </span><a class="code" href="namespaceLAPACKSupport.html#a8cac1e477eff052db622c8a9a9426ea3">T</a> &amp;<span class="keyword">&gt;</span>(*this), 0);</div><div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;  }</div><div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;</div><div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;  <a class="code" href="classVectorizedArrayIterator.html">VectorizedArrayIterator&lt;T&gt;</a></div><div class="line"><a name="l00296"></a><span class="lineno"><a class="line" href="classVectorizedArrayBase.html#a78e62fef92c4dd89eee5bcd616be5ef0">  296</a></span>&#160;  <a class="code" href="classVectorizedArrayBase.html#a78e62fef92c4dd89eee5bcd616be5ef0">end</a>()</div><div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;  {</div><div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="classVectorizedArrayIterator.html">VectorizedArrayIterator&lt;T&gt;</a>(<span class="keyword">static_cast&lt;</span><a class="code" href="namespaceLAPACKSupport.html#a8cac1e477eff052db622c8a9a9426ea3">T</a> &amp;<span class="keyword">&gt;</span>(*this), width);</div><div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;  }</div><div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;</div><div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;  <a class="code" href="classVectorizedArrayIterator.html">VectorizedArrayIterator&lt;const T&gt;</a></div><div class="line"><a name="l00306"></a><span class="lineno"><a class="line" href="classVectorizedArrayBase.html#a60230d197dc20a35c0fe0289e4a03b53">  306</a></span>&#160;  <a class="code" href="classVectorizedArrayBase.html#a60230d197dc20a35c0fe0289e4a03b53">end</a>()<span class="keyword"> const</span></div><div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;<span class="keyword">  </span>{</div><div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="classVectorizedArrayIterator.html">VectorizedArrayIterator&lt;const T&gt;</a>(<span class="keyword">static_cast&lt;</span><span class="keyword">const </span><a class="code" href="namespaceLAPACKSupport.html#a8cac1e477eff052db622c8a9a9426ea3">T</a> &amp;<span class="keyword">&gt;</span>(*this),</div><div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;                                            width);</div><div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;  }</div><div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;};</div><div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;</div><div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;</div><div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;</div><div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;<span class="keyword">template</span> &lt;<span class="keyword">typename</span> Number, std::<span class="keywordtype">size_t</span> w<span class="keywordtype">id</span>th&gt;</div><div class="line"><a name="l00409"></a><span class="lineno"><a class="line" href="classVectorizedArray.html">  409</a></span>&#160;<span class="keyword">class </span><a class="code" href="classVectorizedArray.html">VectorizedArray</a></div><div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;  : <span class="keyword">public</span> <a class="code" href="classVectorizedArrayBase.html">VectorizedArrayBase</a>&lt;VectorizedArray&lt;Number, width&gt;, 1&gt;</div><div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;{</div><div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;<span class="keyword">public</span>:</div><div class="line"><a name="l00417"></a><span class="lineno"><a class="line" href="classVectorizedArray.html#ad5e3061a2d2cf13c446354059e6fa8ef">  417</a></span>&#160;  <span class="keyword">using</span> <a class="code" href="classVectorizedArray.html#ad5e3061a2d2cf13c446354059e6fa8ef">value_type</a> = Number;</div><div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;</div><div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;  static_assert(width == 1,</div><div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160;                <span class="stringliteral">&quot;You specified an illegal width that is not supported.&quot;</span>);</div><div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;</div><div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160;  <a class="code" href="classVectorizedArray.html">VectorizedArray</a>() = <span class="keywordflow">default</span>;</div><div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160;</div><div class="line"><a name="l00432"></a><span class="lineno"><a class="line" href="classVectorizedArray.html#a6367cca1b81fc817e58f1d961d223fc4">  432</a></span>&#160;  <a class="code" href="classVectorizedArray.html#a6367cca1b81fc817e58f1d961d223fc4">VectorizedArray</a>(<span class="keyword">const</span> Number scalar)</div><div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160;  {</div><div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160;    this-&gt;operator=(scalar);</div><div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160;  }</div><div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160;</div><div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160;  <a class="code" href="config_8h.html#a1d1d58e8be15e5c4285f6892e5f33136">DEAL_II_ALWAYS_INLINE</a></div><div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160;  <a class="code" href="classVectorizedArray.html">VectorizedArray</a> &amp;</div><div class="line"><a name="l00443"></a><span class="lineno"><a class="line" href="classVectorizedArray.html#a4bab1253b131475943b076b83179ae76">  443</a></span>&#160;  <a class="code" href="classVectorizedArray.html#a4bab1253b131475943b076b83179ae76">operator=</a>(<span class="keyword">const</span> Number scalar)</div><div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160;  {</div><div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160;    data = scalar;</div><div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160;    <span class="keywordflow">return</span> *<span class="keyword">this</span>;</div><div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160;  }</div><div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160;</div><div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160;  <a class="code" href="config_8h.html#a1d1d58e8be15e5c4285f6892e5f33136">DEAL_II_ALWAYS_INLINE</a></div><div class="line"><a name="l00454"></a><span class="lineno"><a class="line" href="classVectorizedArray.html#a99f8bdefac7d751bef7e42be5dae12fa">  454</a></span>&#160;  Number &amp;<a class="code" href="classVectorizedArray.html#a99f8bdefac7d751bef7e42be5dae12fa">operator[]</a>(<span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> comp)</div><div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160;  {</div><div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160;    (void)comp;</div><div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160;    <a class="code" href="group__Exceptions.html#gaafbb69cc2a791ae55880fd8d57d0c1b0">AssertIndexRange</a>(comp, 1);</div><div class="line"><a name="l00458"></a><span class="lineno">  458</span>&#160;    <span class="keywordflow">return</span> data;</div><div class="line"><a name="l00459"></a><span class="lineno">  459</span>&#160;  }</div><div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160;</div><div class="line"><a name="l00465"></a><span class="lineno">  465</span>&#160;  <a class="code" href="config_8h.html#a1d1d58e8be15e5c4285f6892e5f33136">DEAL_II_ALWAYS_INLINE</a></div><div class="line"><a name="l00466"></a><span class="lineno"><a class="line" href="classVectorizedArray.html#ab40f56a62c0f7c527629540a7af0d9d0">  466</a></span>&#160;  <span class="keyword">const</span> Number &amp;<a class="code" href="classVectorizedArray.html#ab40f56a62c0f7c527629540a7af0d9d0">operator[]</a>(<span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> comp)<span class="keyword"> const</span></div><div class="line"><a name="l00467"></a><span class="lineno">  467</span>&#160;<span class="keyword">  </span>{</div><div class="line"><a name="l00468"></a><span class="lineno">  468</span>&#160;    (void)comp;</div><div class="line"><a name="l00469"></a><span class="lineno">  469</span>&#160;    <a class="code" href="group__Exceptions.html#gaafbb69cc2a791ae55880fd8d57d0c1b0">AssertIndexRange</a>(comp, 1);</div><div class="line"><a name="l00470"></a><span class="lineno">  470</span>&#160;    <span class="keywordflow">return</span> data;</div><div class="line"><a name="l00471"></a><span class="lineno">  471</span>&#160;  }</div><div class="line"><a name="l00472"></a><span class="lineno">  472</span>&#160;</div><div class="line"><a name="l00477"></a><span class="lineno">  477</span>&#160;  <a class="code" href="config_8h.html#a1d1d58e8be15e5c4285f6892e5f33136">DEAL_II_ALWAYS_INLINE</a></div><div class="line"><a name="l00478"></a><span class="lineno">  478</span>&#160;  <a class="code" href="classVectorizedArray.html">VectorizedArray</a> &amp;</div><div class="line"><a name="l00479"></a><span class="lineno"><a class="line" href="classVectorizedArray.html#a23cd28d5bd07f3944d7e56fe33f652fc">  479</a></span>&#160;  <a class="code" href="classVectorizedArray.html#a23cd28d5bd07f3944d7e56fe33f652fc">operator+=</a>(<span class="keyword">const</span> <a class="code" href="classVectorizedArray.html">VectorizedArray</a> &amp;vec)</div><div class="line"><a name="l00480"></a><span class="lineno">  480</span>&#160;  {</div><div class="line"><a name="l00481"></a><span class="lineno">  481</span>&#160;    data += vec.<a class="code" href="classVectorizedArray.html#ad38190d02537705964e021da7ecbab3f">data</a>;</div><div class="line"><a name="l00482"></a><span class="lineno">  482</span>&#160;    <span class="keywordflow">return</span> *<span class="keyword">this</span>;</div><div class="line"><a name="l00483"></a><span class="lineno">  483</span>&#160;  }</div><div class="line"><a name="l00484"></a><span class="lineno">  484</span>&#160;</div><div class="line"><a name="l00489"></a><span class="lineno">  489</span>&#160;  <a class="code" href="config_8h.html#a1d1d58e8be15e5c4285f6892e5f33136">DEAL_II_ALWAYS_INLINE</a></div><div class="line"><a name="l00490"></a><span class="lineno">  490</span>&#160;  <a class="code" href="classVectorizedArray.html">VectorizedArray</a> &amp;</div><div class="line"><a name="l00491"></a><span class="lineno"><a class="line" href="classVectorizedArray.html#aff4825de67b123e97613fd1f1dd96436">  491</a></span>&#160;  <a class="code" href="classVectorizedArray.html#aff4825de67b123e97613fd1f1dd96436">operator-=</a>(<span class="keyword">const</span> <a class="code" href="classVectorizedArray.html">VectorizedArray</a> &amp;vec)</div><div class="line"><a name="l00492"></a><span class="lineno">  492</span>&#160;  {</div><div class="line"><a name="l00493"></a><span class="lineno">  493</span>&#160;    data -= vec.<a class="code" href="classVectorizedArray.html#ad38190d02537705964e021da7ecbab3f">data</a>;</div><div class="line"><a name="l00494"></a><span class="lineno">  494</span>&#160;    <span class="keywordflow">return</span> *<span class="keyword">this</span>;</div><div class="line"><a name="l00495"></a><span class="lineno">  495</span>&#160;  }</div><div class="line"><a name="l00496"></a><span class="lineno">  496</span>&#160;</div><div class="line"><a name="l00501"></a><span class="lineno">  501</span>&#160;  <a class="code" href="config_8h.html#a1d1d58e8be15e5c4285f6892e5f33136">DEAL_II_ALWAYS_INLINE</a></div><div class="line"><a name="l00502"></a><span class="lineno">  502</span>&#160;  <a class="code" href="classVectorizedArray.html">VectorizedArray</a> &amp;</div><div class="line"><a name="l00503"></a><span class="lineno"><a class="line" href="classVectorizedArray.html#aab5595f01cf6de1bb959befa44bb6603">  503</a></span>&#160;  <a class="code" href="classVectorizedArray.html#aab5595f01cf6de1bb959befa44bb6603">operator*=</a>(<span class="keyword">const</span> <a class="code" href="classVectorizedArray.html">VectorizedArray</a> &amp;vec)</div><div class="line"><a name="l00504"></a><span class="lineno">  504</span>&#160;  {</div><div class="line"><a name="l00505"></a><span class="lineno">  505</span>&#160;    data *= vec.<a class="code" href="classVectorizedArray.html#ad38190d02537705964e021da7ecbab3f">data</a>;</div><div class="line"><a name="l00506"></a><span class="lineno">  506</span>&#160;    <span class="keywordflow">return</span> *<span class="keyword">this</span>;</div><div class="line"><a name="l00507"></a><span class="lineno">  507</span>&#160;  }</div><div class="line"><a name="l00508"></a><span class="lineno">  508</span>&#160;</div><div class="line"><a name="l00513"></a><span class="lineno">  513</span>&#160;  <a class="code" href="config_8h.html#a1d1d58e8be15e5c4285f6892e5f33136">DEAL_II_ALWAYS_INLINE</a></div><div class="line"><a name="l00514"></a><span class="lineno">  514</span>&#160;  <a class="code" href="classVectorizedArray.html">VectorizedArray</a> &amp;</div><div class="line"><a name="l00515"></a><span class="lineno"><a class="line" href="classVectorizedArray.html#a73ed02d36053ebd2d903eac17fc832d2">  515</a></span>&#160;  <a class="code" href="classVectorizedArray.html#a73ed02d36053ebd2d903eac17fc832d2">operator/=</a>(<span class="keyword">const</span> <a class="code" href="classVectorizedArray.html">VectorizedArray</a> &amp;vec)</div><div class="line"><a name="l00516"></a><span class="lineno">  516</span>&#160;  {</div><div class="line"><a name="l00517"></a><span class="lineno">  517</span>&#160;    data /= vec.<a class="code" href="classVectorizedArray.html#ad38190d02537705964e021da7ecbab3f">data</a>;</div><div class="line"><a name="l00518"></a><span class="lineno">  518</span>&#160;    <span class="keywordflow">return</span> *<span class="keyword">this</span>;</div><div class="line"><a name="l00519"></a><span class="lineno">  519</span>&#160;  }</div><div class="line"><a name="l00520"></a><span class="lineno">  520</span>&#160;</div><div class="line"><a name="l00525"></a><span class="lineno">  525</span>&#160;  <a class="code" href="config_8h.html#a1d1d58e8be15e5c4285f6892e5f33136">DEAL_II_ALWAYS_INLINE</a></div><div class="line"><a name="l00526"></a><span class="lineno">  526</span>&#160;  <span class="keywordtype">void</span></div><div class="line"><a name="l00527"></a><span class="lineno"><a class="line" href="classVectorizedArray.html#ab0c3d5bcdf208c37fc1f8055765c03b1">  527</a></span>&#160;  <a class="code" href="classVectorizedArray.html#ab0c3d5bcdf208c37fc1f8055765c03b1">load</a>(<span class="keyword">const</span> Number *ptr)</div><div class="line"><a name="l00528"></a><span class="lineno">  528</span>&#160;  {</div><div class="line"><a name="l00529"></a><span class="lineno">  529</span>&#160;    data = *ptr;</div><div class="line"><a name="l00530"></a><span class="lineno">  530</span>&#160;  }</div><div class="line"><a name="l00531"></a><span class="lineno">  531</span>&#160;</div><div class="line"><a name="l00536"></a><span class="lineno">  536</span>&#160;  <a class="code" href="config_8h.html#a1d1d58e8be15e5c4285f6892e5f33136">DEAL_II_ALWAYS_INLINE</a></div><div class="line"><a name="l00537"></a><span class="lineno">  537</span>&#160;  <span class="keywordtype">void</span></div><div class="line"><a name="l00538"></a><span class="lineno"><a class="line" href="classVectorizedArray.html#a9f2cef2c40dbc7871c7c702bc0cfe533">  538</a></span>&#160;  <a class="code" href="classVectorizedArray.html#a9f2cef2c40dbc7871c7c702bc0cfe533">store</a>(Number *ptr)<span class="keyword"> const</span></div><div class="line"><a name="l00539"></a><span class="lineno">  539</span>&#160;<span class="keyword">  </span>{</div><div class="line"><a name="l00540"></a><span class="lineno">  540</span>&#160;    *ptr = data;</div><div class="line"><a name="l00541"></a><span class="lineno">  541</span>&#160;  }</div><div class="line"><a name="l00542"></a><span class="lineno">  542</span>&#160;</div><div class="line"><a name="l00557"></a><span class="lineno">  557</span>&#160;  <a class="code" href="config_8h.html#a1d1d58e8be15e5c4285f6892e5f33136">DEAL_II_ALWAYS_INLINE</a></div><div class="line"><a name="l00558"></a><span class="lineno">  558</span>&#160;  <span class="keywordtype">void</span></div><div class="line"><a name="l00559"></a><span class="lineno"><a class="line" href="classVectorizedArray.html#ae5fa52c39ffcb5a2e740552a92833009">  559</a></span>&#160;  <a class="code" href="classVectorizedArray.html#ae5fa52c39ffcb5a2e740552a92833009">streaming_store</a>(Number *ptr)<span class="keyword"> const</span></div><div class="line"><a name="l00560"></a><span class="lineno">  560</span>&#160;<span class="keyword">  </span>{</div><div class="line"><a name="l00561"></a><span class="lineno">  561</span>&#160;    *ptr = data;</div><div class="line"><a name="l00562"></a><span class="lineno">  562</span>&#160;  }</div><div class="line"><a name="l00563"></a><span class="lineno">  563</span>&#160;</div><div class="line"><a name="l00574"></a><span class="lineno">  574</span>&#160;  <a class="code" href="config_8h.html#a1d1d58e8be15e5c4285f6892e5f33136">DEAL_II_ALWAYS_INLINE</a></div><div class="line"><a name="l00575"></a><span class="lineno">  575</span>&#160;  <span class="keywordtype">void</span></div><div class="line"><a name="l00576"></a><span class="lineno"><a class="line" href="classVectorizedArray.html#a137b7cf45664efddbc332cad9c5c8839">  576</a></span>&#160;  <a class="code" href="classVectorizedArray.html#a137b7cf45664efddbc332cad9c5c8839">gather</a>(<span class="keyword">const</span> Number *base_ptr, <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> *offsets)</div><div class="line"><a name="l00577"></a><span class="lineno">  577</span>&#160;  {</div><div class="line"><a name="l00578"></a><span class="lineno">  578</span>&#160;    data = base_ptr[offsets[0]];</div><div class="line"><a name="l00579"></a><span class="lineno">  579</span>&#160;  }</div><div class="line"><a name="l00580"></a><span class="lineno">  580</span>&#160;</div><div class="line"><a name="l00590"></a><span class="lineno">  590</span>&#160;  <a class="code" href="config_8h.html#a1d1d58e8be15e5c4285f6892e5f33136">DEAL_II_ALWAYS_INLINE</a></div><div class="line"><a name="l00591"></a><span class="lineno">  591</span>&#160;  <span class="keywordtype">void</span></div><div class="line"><a name="l00592"></a><span class="lineno"><a class="line" href="classVectorizedArray.html#aa05c67eb5742dc4eea633174e8a88986">  592</a></span>&#160;  <a class="code" href="classVectorizedArray.html#aa05c67eb5742dc4eea633174e8a88986">scatter</a>(<span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> *offsets, Number *base_ptr)<span class="keyword"> const</span></div><div class="line"><a name="l00593"></a><span class="lineno">  593</span>&#160;<span class="keyword">  </span>{</div><div class="line"><a name="l00594"></a><span class="lineno">  594</span>&#160;    base_ptr[offsets[0]] = data;</div><div class="line"><a name="l00595"></a><span class="lineno">  595</span>&#160;  }</div><div class="line"><a name="l00596"></a><span class="lineno">  596</span>&#160;</div><div class="line"><a name="l00601"></a><span class="lineno"><a class="line" href="classVectorizedArray.html#ad38190d02537705964e021da7ecbab3f">  601</a></span>&#160;  Number <a class="code" href="classVectorizedArray.html#ad38190d02537705964e021da7ecbab3f">data</a>;</div><div class="line"><a name="l00602"></a><span class="lineno">  602</span>&#160;</div><div class="line"><a name="l00603"></a><span class="lineno">  603</span>&#160;<span class="keyword">private</span>:</div><div class="line"><a name="l00608"></a><span class="lineno">  608</span>&#160;  <a class="code" href="config_8h.html#a1d1d58e8be15e5c4285f6892e5f33136">DEAL_II_ALWAYS_INLINE</a></div><div class="line"><a name="l00609"></a><span class="lineno">  609</span>&#160;  <a class="code" href="classVectorizedArray.html">VectorizedArray</a></div><div class="line"><a name="l00610"></a><span class="lineno"><a class="line" href="classVectorizedArray.html#ac3828c2f77428ee28013df11e678a897">  610</a></span>&#160;  <a class="code" href="classVectorizedArray.html#ac3828c2f77428ee28013df11e678a897">get_sqrt</a>()<span class="keyword"> const</span></div><div class="line"><a name="l00611"></a><span class="lineno">  611</span>&#160;<span class="keyword">  </span>{</div><div class="line"><a name="l00612"></a><span class="lineno">  612</span>&#160;    <a class="code" href="classVectorizedArray.html">VectorizedArray</a> res;</div><div class="line"><a name="l00613"></a><span class="lineno">  613</span>&#160;    res.<a class="code" href="classVectorizedArray.html#ad38190d02537705964e021da7ecbab3f">data</a> = std::sqrt(data);</div><div class="line"><a name="l00614"></a><span class="lineno">  614</span>&#160;    <span class="keywordflow">return</span> res;</div><div class="line"><a name="l00615"></a><span class="lineno">  615</span>&#160;  }</div><div class="line"><a name="l00616"></a><span class="lineno">  616</span>&#160;</div><div class="line"><a name="l00621"></a><span class="lineno">  621</span>&#160;  <a class="code" href="config_8h.html#a1d1d58e8be15e5c4285f6892e5f33136">DEAL_II_ALWAYS_INLINE</a></div><div class="line"><a name="l00622"></a><span class="lineno">  622</span>&#160;  <a class="code" href="classVectorizedArray.html">VectorizedArray</a></div><div class="line"><a name="l00623"></a><span class="lineno"><a class="line" href="classVectorizedArray.html#a29d1dcaad4340a1a08f9660ff3f4ac7f">  623</a></span>&#160;  <a class="code" href="classVectorizedArray.html#a29d1dcaad4340a1a08f9660ff3f4ac7f">get_abs</a>()<span class="keyword"> const</span></div><div class="line"><a name="l00624"></a><span class="lineno">  624</span>&#160;<span class="keyword">  </span>{</div><div class="line"><a name="l00625"></a><span class="lineno">  625</span>&#160;    <a class="code" href="classVectorizedArray.html">VectorizedArray</a> res;</div><div class="line"><a name="l00626"></a><span class="lineno">  626</span>&#160;    res.<a class="code" href="classVectorizedArray.html#ad38190d02537705964e021da7ecbab3f">data</a> = <a class="code" href="namespaceDifferentiation_1_1SD.html#a592560ee80355620422a86087f11b9df">std::fabs</a>(data);</div><div class="line"><a name="l00627"></a><span class="lineno">  627</span>&#160;    <span class="keywordflow">return</span> res;</div><div class="line"><a name="l00628"></a><span class="lineno">  628</span>&#160;  }</div><div class="line"><a name="l00629"></a><span class="lineno">  629</span>&#160;</div><div class="line"><a name="l00634"></a><span class="lineno">  634</span>&#160;  <a class="code" href="config_8h.html#a1d1d58e8be15e5c4285f6892e5f33136">DEAL_II_ALWAYS_INLINE</a></div><div class="line"><a name="l00635"></a><span class="lineno">  635</span>&#160;  <a class="code" href="classVectorizedArray.html">VectorizedArray</a></div><div class="line"><a name="l00636"></a><span class="lineno"><a class="line" href="classVectorizedArray.html#a6bce743d38c5e0afd42e8834f8f6dabf">  636</a></span>&#160;  <a class="code" href="classVectorizedArray.html#a6bce743d38c5e0afd42e8834f8f6dabf">get_max</a>(<span class="keyword">const</span> <a class="code" href="classVectorizedArray.html">VectorizedArray</a> &amp;other)<span class="keyword"> const</span></div><div class="line"><a name="l00637"></a><span class="lineno">  637</span>&#160;<span class="keyword">  </span>{</div><div class="line"><a name="l00638"></a><span class="lineno">  638</span>&#160;    <a class="code" href="classVectorizedArray.html">VectorizedArray</a> res;</div><div class="line"><a name="l00639"></a><span class="lineno">  639</span>&#160;    res.<a class="code" href="classVectorizedArray.html#ad38190d02537705964e021da7ecbab3f">data</a> = std::max(data, other.<a class="code" href="classVectorizedArray.html#ad38190d02537705964e021da7ecbab3f">data</a>);</div><div class="line"><a name="l00640"></a><span class="lineno">  640</span>&#160;    <span class="keywordflow">return</span> res;</div><div class="line"><a name="l00641"></a><span class="lineno">  641</span>&#160;  }</div><div class="line"><a name="l00642"></a><span class="lineno">  642</span>&#160;</div><div class="line"><a name="l00647"></a><span class="lineno">  647</span>&#160;  <a class="code" href="config_8h.html#a1d1d58e8be15e5c4285f6892e5f33136">DEAL_II_ALWAYS_INLINE</a></div><div class="line"><a name="l00648"></a><span class="lineno">  648</span>&#160;  <a class="code" href="classVectorizedArray.html">VectorizedArray</a></div><div class="line"><a name="l00649"></a><span class="lineno"><a class="line" href="classVectorizedArray.html#a84c9518b5e35e5596944e124d6a3a2d9">  649</a></span>&#160;  <a class="code" href="classVectorizedArray.html#a84c9518b5e35e5596944e124d6a3a2d9">get_min</a>(<span class="keyword">const</span> <a class="code" href="classVectorizedArray.html">VectorizedArray</a> &amp;other)<span class="keyword"> const</span></div><div class="line"><a name="l00650"></a><span class="lineno">  650</span>&#160;<span class="keyword">  </span>{</div><div class="line"><a name="l00651"></a><span class="lineno">  651</span>&#160;    <a class="code" href="classVectorizedArray.html">VectorizedArray</a> res;</div><div class="line"><a name="l00652"></a><span class="lineno">  652</span>&#160;    res.<a class="code" href="classVectorizedArray.html#ad38190d02537705964e021da7ecbab3f">data</a> = std::min(data, other.<a class="code" href="classVectorizedArray.html#ad38190d02537705964e021da7ecbab3f">data</a>);</div><div class="line"><a name="l00653"></a><span class="lineno">  653</span>&#160;    <span class="keywordflow">return</span> res;</div><div class="line"><a name="l00654"></a><span class="lineno">  654</span>&#160;  }</div><div class="line"><a name="l00655"></a><span class="lineno">  655</span>&#160;</div><div class="line"><a name="l00656"></a><span class="lineno">  656</span>&#160;  <span class="comment">// Make a few functions friends.</span></div><div class="line"><a name="l00657"></a><span class="lineno">  657</span>&#160;  <span class="keyword">template</span> &lt;<span class="keyword">typename</span> Number2, std::<span class="keywordtype">size_t</span> w<span class="keywordtype">id</span>th2&gt;</div><div class="line"><a name="l00658"></a><span class="lineno">  658</span>&#160;  <span class="keyword">friend</span> <a class="code" href="classVectorizedArray.html">VectorizedArray&lt;Number2, width2&gt;</a></div><div class="line"><a name="l00659"></a><span class="lineno">  659</span>&#160;  std::sqrt(<span class="keyword">const</span> <a class="code" href="classVectorizedArray.html">VectorizedArray&lt;Number2, width2&gt;</a> &amp;);</div><div class="line"><a name="l00660"></a><span class="lineno">  660</span>&#160;  <span class="keyword">template</span> &lt;<span class="keyword">typename</span> Number2, std::<span class="keywordtype">size_t</span> w<span class="keywordtype">id</span>th2&gt;</div><div class="line"><a name="l00661"></a><span class="lineno">  661</span>&#160;  <span class="keyword">friend</span> <a class="code" href="classVectorizedArray.html">VectorizedArray&lt;Number2, width2&gt;</a></div><div class="line"><a name="l00662"></a><span class="lineno">  662</span>&#160;  std::abs(<span class="keyword">const</span> <a class="code" href="classVectorizedArray.html">VectorizedArray&lt;Number2, width2&gt;</a> &amp;);</div><div class="line"><a name="l00663"></a><span class="lineno">  663</span>&#160;  <span class="keyword">template</span> &lt;<span class="keyword">typename</span> Number2, std::<span class="keywordtype">size_t</span> w<span class="keywordtype">id</span>th2&gt;</div><div class="line"><a name="l00664"></a><span class="lineno">  664</span>&#160;  <span class="keyword">friend</span> <a class="code" href="classVectorizedArray.html">VectorizedArray&lt;Number2, width2&gt;</a></div><div class="line"><a name="l00665"></a><span class="lineno">  665</span>&#160;  std::max(<span class="keyword">const</span> <a class="code" href="classVectorizedArray.html">VectorizedArray&lt;Number2, width2&gt;</a> &amp;,</div><div class="line"><a name="l00666"></a><span class="lineno">  666</span>&#160;           <span class="keyword">const</span> <a class="code" href="classVectorizedArray.html">VectorizedArray&lt;Number2, width2&gt;</a> &amp;);</div><div class="line"><a name="l00667"></a><span class="lineno">  667</span>&#160;  <span class="keyword">template</span> &lt;<span class="keyword">typename</span> Number2, std::<span class="keywordtype">size_t</span> w<span class="keywordtype">id</span>th2&gt;</div><div class="line"><a name="l00668"></a><span class="lineno">  668</span>&#160;  <span class="keyword">friend</span> <a class="code" href="classVectorizedArray.html">VectorizedArray&lt;Number2, width2&gt;</a></div><div class="line"><a name="l00669"></a><span class="lineno">  669</span>&#160;  std::min(<span class="keyword">const</span> <a class="code" href="classVectorizedArray.html">VectorizedArray&lt;Number2, width2&gt;</a> &amp;,</div><div class="line"><a name="l00670"></a><span class="lineno">  670</span>&#160;           <span class="keyword">const</span> <a class="code" href="classVectorizedArray.html">VectorizedArray&lt;Number2, width2&gt;</a> &amp;);</div><div class="line"><a name="l00671"></a><span class="lineno">  671</span>&#160;};</div><div class="line"><a name="l00672"></a><span class="lineno">  672</span>&#160;</div><div class="line"><a name="l00673"></a><span class="lineno">  673</span>&#160;</div><div class="line"><a name="l00674"></a><span class="lineno">  674</span>&#160;</div><div class="line"><a name="l00681"></a><span class="lineno">  681</span>&#160;</div><div class="line"><a name="l00682"></a><span class="lineno">  682</span>&#160;</div><div class="line"><a name="l00689"></a><span class="lineno">  689</span>&#160;<span class="keyword">template</span> &lt;<span class="keyword">typename</span> Number,</div><div class="line"><a name="l00690"></a><span class="lineno">  690</span>&#160;          std::size_t width =</div><div class="line"><a name="l00691"></a><span class="lineno">  691</span>&#160;            <a class="code" href="structinternal_1_1VectorizedArrayWidthSpecifier.html">internal::VectorizedArrayWidthSpecifier&lt;Number&gt;::max_width</a>&gt;</div><div class="line"><a name="l00692"></a><span class="lineno">  692</span>&#160;<span class="keyword">inline</span> <a class="code" href="config_8h.html#a1d1d58e8be15e5c4285f6892e5f33136">DEAL_II_ALWAYS_INLINE</a> <a class="code" href="classVectorizedArray.html">VectorizedArray&lt;Number, width&gt;</a></div><div class="line"><a name="l00693"></a><span class="lineno"><a class="line" href="vectorization_8h.html#ad7d7e08942faeecf438c75a254e06cbe">  693</a></span>&#160;                             <a class="code" href="vectorization_8h.html#ad7d7e08942faeecf438c75a254e06cbe">make_vectorized_array</a>(<span class="keyword">const</span> Number &amp;u)</div><div class="line"><a name="l00694"></a><span class="lineno">  694</span>&#160;{</div><div class="line"><a name="l00695"></a><span class="lineno">  695</span>&#160;  <a class="code" href="classVectorizedArray.html">VectorizedArray&lt;Number, width&gt;</a> result = u;</div><div class="line"><a name="l00696"></a><span class="lineno">  696</span>&#160;  <span class="keywordflow">return</span> result;</div><div class="line"><a name="l00697"></a><span class="lineno">  697</span>&#160;}</div><div class="line"><a name="l00698"></a><span class="lineno">  698</span>&#160;</div><div class="line"><a name="l00699"></a><span class="lineno">  699</span>&#160;</div><div class="line"><a name="l00700"></a><span class="lineno">  700</span>&#160;</div><div class="line"><a name="l00707"></a><span class="lineno">  707</span>&#160;<span class="keyword">template</span> &lt;<span class="keyword">typename</span> VectorizedArrayType&gt;</div><div class="line"><a name="l00708"></a><span class="lineno">  708</span>&#160;<span class="keyword">inline</span> <a class="code" href="config_8h.html#a1d1d58e8be15e5c4285f6892e5f33136">DEAL_II_ALWAYS_INLINE</a> VectorizedArrayType</div><div class="line"><a name="l00709"></a><span class="lineno"><a class="line" href="vectorization_8h.html#a1e5618abfc968e28f587c4fcfa1fdb34">  709</a></span>&#160;                             <a class="code" href="vectorization_8h.html#ad7d7e08942faeecf438c75a254e06cbe">make_vectorized_array</a>(<span class="keyword">const</span> <span class="keyword">typename</span> VectorizedArrayType::value_type &amp;u)</div><div class="line"><a name="l00710"></a><span class="lineno">  710</span>&#160;{</div><div class="line"><a name="l00711"></a><span class="lineno">  711</span>&#160;  static_assert(</div><div class="line"><a name="l00712"></a><span class="lineno">  712</span>&#160;    std::is_same&lt;VectorizedArrayType,</div><div class="line"><a name="l00713"></a><span class="lineno">  713</span>&#160;                 <a class="code" href="classVectorizedArray.html">VectorizedArray</a>&lt;<span class="keyword">typename</span> VectorizedArrayType::value_type,</div><div class="line"><a name="l00714"></a><span class="lineno">  714</span>&#160;                                 VectorizedArrayType::size()&gt;&gt;::value,</div><div class="line"><a name="l00715"></a><span class="lineno">  715</span>&#160;    <span class="stringliteral">&quot;VectorizedArrayType is not a VectorizedArray.&quot;</span>);</div><div class="line"><a name="l00716"></a><span class="lineno">  716</span>&#160;</div><div class="line"><a name="l00717"></a><span class="lineno">  717</span>&#160;  VectorizedArrayType result = u;</div><div class="line"><a name="l00718"></a><span class="lineno">  718</span>&#160;  <span class="keywordflow">return</span> result;</div><div class="line"><a name="l00719"></a><span class="lineno">  719</span>&#160;}</div><div class="line"><a name="l00720"></a><span class="lineno">  720</span>&#160;</div><div class="line"><a name="l00721"></a><span class="lineno">  721</span>&#160;</div><div class="line"><a name="l00722"></a><span class="lineno">  722</span>&#160;</div><div class="line"><a name="l00736"></a><span class="lineno">  736</span>&#160;<span class="keyword">template</span> &lt;<span class="keyword">typename</span> Number, std::<span class="keywordtype">size_t</span> w<span class="keywordtype">id</span>th&gt;</div><div class="line"><a name="l00737"></a><span class="lineno">  737</span>&#160;<span class="keyword">inline</span> <a class="code" href="config_8h.html#a1d1d58e8be15e5c4285f6892e5f33136">DEAL_II_ALWAYS_INLINE</a> <span class="keywordtype">void</span></div><div class="line"><a name="l00738"></a><span class="lineno"><a class="line" href="vectorization_8h.html#a078ca5de8d3a59aedc130823be15ad26">  738</a></span>&#160;<a class="code" href="vectorization_8h.html#a078ca5de8d3a59aedc130823be15ad26">gather</a>(<a class="code" href="classVectorizedArray.html">VectorizedArray&lt;Number, width&gt;</a> &amp;   out,</div><div class="line"><a name="l00739"></a><span class="lineno">  739</span>&#160;       <span class="keyword">const</span> std::array&lt;Number *, width&gt; &amp;ptrs,</div><div class="line"><a name="l00740"></a><span class="lineno">  740</span>&#160;       <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span>                 offset)</div><div class="line"><a name="l00741"></a><span class="lineno">  741</span>&#160;{</div><div class="line"><a name="l00742"></a><span class="lineno">  742</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> v = 0; v &lt; width; v++)</div><div class="line"><a name="l00743"></a><span class="lineno">  743</span>&#160;    out.<a class="code" href="classVectorizedArray.html#ad38190d02537705964e021da7ecbab3f">data</a>[v] = ptrs[v][offset];</div><div class="line"><a name="l00744"></a><span class="lineno">  744</span>&#160;}</div><div class="line"><a name="l00745"></a><span class="lineno">  745</span>&#160;</div><div class="line"><a name="l00746"></a><span class="lineno">  746</span>&#160;</div><div class="line"><a name="l00747"></a><span class="lineno">  747</span>&#160;</div><div class="line"><a name="l00769"></a><span class="lineno">  769</span>&#160;<span class="keyword">template</span> &lt;<span class="keyword">typename</span> Number, std::<span class="keywordtype">size_t</span> w<span class="keywordtype">id</span>th&gt;</div><div class="line"><a name="l00770"></a><span class="lineno">  770</span>&#160;<span class="keyword">inline</span> <a class="code" href="config_8h.html#a1d1d58e8be15e5c4285f6892e5f33136">DEAL_II_ALWAYS_INLINE</a> <span class="keywordtype">void</span></div><div class="line"><a name="l00771"></a><span class="lineno"><a class="line" href="vectorization_8h.html#a14da4327264fd3a88a9f73a8f72a9094">  771</a></span>&#160;<a class="code" href="vectorization_8h.html#a14da4327264fd3a88a9f73a8f72a9094">vectorized_load_and_transpose</a>(<span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span>              n_entries,</div><div class="line"><a name="l00772"></a><span class="lineno">  772</span>&#160;                              <span class="keyword">const</span> Number *                  in,</div><div class="line"><a name="l00773"></a><span class="lineno">  773</span>&#160;                              <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> *            offsets,</div><div class="line"><a name="l00774"></a><span class="lineno">  774</span>&#160;                              <a class="code" href="classVectorizedArray.html">VectorizedArray&lt;Number, width&gt;</a> *out)</div><div class="line"><a name="l00775"></a><span class="lineno">  775</span>&#160;{</div><div class="line"><a name="l00776"></a><span class="lineno">  776</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i = 0; i &lt; n_entries; ++i)</div><div class="line"><a name="l00777"></a><span class="lineno">  777</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> v = 0; v &lt; VectorizedArray&lt;Number, width&gt;::size(); ++v)</div><div class="line"><a name="l00778"></a><span class="lineno">  778</span>&#160;      out[i][v] = in[offsets[v] + i];</div><div class="line"><a name="l00779"></a><span class="lineno">  779</span>&#160;}</div><div class="line"><a name="l00780"></a><span class="lineno">  780</span>&#160;</div><div class="line"><a name="l00781"></a><span class="lineno">  781</span>&#160;</div><div class="line"><a name="l00790"></a><span class="lineno">  790</span>&#160;<span class="keyword">template</span> &lt;<span class="keyword">typename</span> Number, std::<span class="keywordtype">size_t</span> w<span class="keywordtype">id</span>th&gt;</div><div class="line"><a name="l00791"></a><span class="lineno">  791</span>&#160;<span class="keyword">inline</span> <a class="code" href="config_8h.html#a1d1d58e8be15e5c4285f6892e5f33136">DEAL_II_ALWAYS_INLINE</a> <span class="keywordtype">void</span></div><div class="line"><a name="l00792"></a><span class="lineno"><a class="line" href="vectorization_8h.html#a6e7f7b3cdcf7b71718bee43a9cbc27f8">  792</a></span>&#160;<a class="code" href="vectorization_8h.html#a14da4327264fd3a88a9f73a8f72a9094">vectorized_load_and_transpose</a>(<span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span>                 n_entries,</div><div class="line"><a name="l00793"></a><span class="lineno">  793</span>&#160;                              <span class="keyword">const</span> std::array&lt;Number *, width&gt; &amp;in,</div><div class="line"><a name="l00794"></a><span class="lineno">  794</span>&#160;                              <a class="code" href="classVectorizedArray.html">VectorizedArray&lt;Number, width&gt;</a> *   out)</div><div class="line"><a name="l00795"></a><span class="lineno">  795</span>&#160;{</div><div class="line"><a name="l00796"></a><span class="lineno">  796</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i = 0; i &lt; n_entries; ++i)</div><div class="line"><a name="l00797"></a><span class="lineno">  797</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> v = 0; v &lt; VectorizedArray&lt;Number, width&gt;::size(); ++v)</div><div class="line"><a name="l00798"></a><span class="lineno">  798</span>&#160;      out[i][v] = in[v][i];</div><div class="line"><a name="l00799"></a><span class="lineno">  799</span>&#160;}</div><div class="line"><a name="l00800"></a><span class="lineno">  800</span>&#160;</div><div class="line"><a name="l00801"></a><span class="lineno">  801</span>&#160;</div><div class="line"><a name="l00802"></a><span class="lineno">  802</span>&#160;</div><div class="line"><a name="l00832"></a><span class="lineno">  832</span>&#160;<span class="keyword">template</span> &lt;<span class="keyword">typename</span> Number, std::<span class="keywordtype">size_t</span> w<span class="keywordtype">id</span>th&gt;</div><div class="line"><a name="l00833"></a><span class="lineno">  833</span>&#160;<span class="keyword">inline</span> <a class="code" href="config_8h.html#a1d1d58e8be15e5c4285f6892e5f33136">DEAL_II_ALWAYS_INLINE</a> <span class="keywordtype">void</span></div><div class="line"><a name="l00834"></a><span class="lineno"><a class="line" href="vectorization_8h.html#af396b43c783502e8acd2ca7d071a7325">  834</a></span>&#160;<a class="code" href="vectorization_8h.html#af396b43c783502e8acd2ca7d071a7325">vectorized_transpose_and_store</a>(<span class="keyword">const</span> <span class="keywordtype">bool</span>                            add_into,</div><div class="line"><a name="l00835"></a><span class="lineno">  835</span>&#160;                               <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span>                    n_entries,</div><div class="line"><a name="l00836"></a><span class="lineno">  836</span>&#160;                               <span class="keyword">const</span> <a class="code" href="classVectorizedArray.html">VectorizedArray&lt;Number, width&gt;</a> *in,</div><div class="line"><a name="l00837"></a><span class="lineno">  837</span>&#160;                               <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> *                  offsets,</div><div class="line"><a name="l00838"></a><span class="lineno">  838</span>&#160;                               Number *                              out)</div><div class="line"><a name="l00839"></a><span class="lineno">  839</span>&#160;{</div><div class="line"><a name="l00840"></a><span class="lineno">  840</span>&#160;  <span class="keywordflow">if</span> (add_into)</div><div class="line"><a name="l00841"></a><span class="lineno">  841</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i = 0; i &lt; n_entries; ++i)</div><div class="line"><a name="l00842"></a><span class="lineno">  842</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> v = 0; v &lt; VectorizedArray&lt;Number, width&gt;::size(); ++v)</div><div class="line"><a name="l00843"></a><span class="lineno">  843</span>&#160;        out[offsets[v] + i] += in[i][v];</div><div class="line"><a name="l00844"></a><span class="lineno">  844</span>&#160;  <span class="keywordflow">else</span></div><div class="line"><a name="l00845"></a><span class="lineno">  845</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i = 0; i &lt; n_entries; ++i)</div><div class="line"><a name="l00846"></a><span class="lineno">  846</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> v = 0; v &lt; VectorizedArray&lt;Number, width&gt;::size(); ++v)</div><div class="line"><a name="l00847"></a><span class="lineno">  847</span>&#160;        out[offsets[v] + i] = in[i][v];</div><div class="line"><a name="l00848"></a><span class="lineno">  848</span>&#160;}</div><div class="line"><a name="l00849"></a><span class="lineno">  849</span>&#160;</div><div class="line"><a name="l00850"></a><span class="lineno">  850</span>&#160;</div><div class="line"><a name="l00859"></a><span class="lineno">  859</span>&#160;<span class="keyword">template</span> &lt;<span class="keyword">typename</span> Number, std::<span class="keywordtype">size_t</span> w<span class="keywordtype">id</span>th&gt;</div><div class="line"><a name="l00860"></a><span class="lineno">  860</span>&#160;<span class="keyword">inline</span> <a class="code" href="config_8h.html#a1d1d58e8be15e5c4285f6892e5f33136">DEAL_II_ALWAYS_INLINE</a> <span class="keywordtype">void</span></div><div class="line"><a name="l00861"></a><span class="lineno"><a class="line" href="vectorization_8h.html#a63e4c80a49c6df42c3831655bdb318ab">  861</a></span>&#160;<a class="code" href="vectorization_8h.html#af396b43c783502e8acd2ca7d071a7325">vectorized_transpose_and_store</a>(<span class="keyword">const</span> <span class="keywordtype">bool</span>                            add_into,</div><div class="line"><a name="l00862"></a><span class="lineno">  862</span>&#160;                               <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span>                    n_entries,</div><div class="line"><a name="l00863"></a><span class="lineno">  863</span>&#160;                               <span class="keyword">const</span> <a class="code" href="classVectorizedArray.html">VectorizedArray&lt;Number, width&gt;</a> *in,</div><div class="line"><a name="l00864"></a><span class="lineno">  864</span>&#160;                               std::array&lt;Number *, width&gt; &amp;         out)</div><div class="line"><a name="l00865"></a><span class="lineno">  865</span>&#160;{</div><div class="line"><a name="l00866"></a><span class="lineno">  866</span>&#160;  <span class="keywordflow">if</span> (add_into)</div><div class="line"><a name="l00867"></a><span class="lineno">  867</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i = 0; i &lt; n_entries; ++i)</div><div class="line"><a name="l00868"></a><span class="lineno">  868</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> v = 0; v &lt; VectorizedArray&lt;Number, width&gt;::size(); ++v)</div><div class="line"><a name="l00869"></a><span class="lineno">  869</span>&#160;        out[v][i] += in[i][v];</div><div class="line"><a name="l00870"></a><span class="lineno">  870</span>&#160;  <span class="keywordflow">else</span></div><div class="line"><a name="l00871"></a><span class="lineno">  871</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i = 0; i &lt; n_entries; ++i)</div><div class="line"><a name="l00872"></a><span class="lineno">  872</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> v = 0; v &lt; VectorizedArray&lt;Number, width&gt;::size(); ++v)</div><div class="line"><a name="l00873"></a><span class="lineno">  873</span>&#160;        out[v][i] = in[i][v];</div><div class="line"><a name="l00874"></a><span class="lineno">  874</span>&#160;}</div><div class="line"><a name="l00875"></a><span class="lineno">  875</span>&#160;</div><div class="line"><a name="l00876"></a><span class="lineno">  876</span>&#160;</div><div class="line"><a name="l00878"></a><span class="lineno">  878</span>&#160;</div><div class="line"><a name="l00879"></a><span class="lineno">  879</span>&#160;<span class="preprocessor">#ifndef DOXYGEN</span></div><div class="line"><a name="l00880"></a><span class="lineno">  880</span>&#160;</div><div class="line"><a name="l00881"></a><span class="lineno">  881</span>&#160;<span class="comment">// for safety, also check that __AVX512F__ is defined in case the user manually</span></div><div class="line"><a name="l00882"></a><span class="lineno">  882</span>&#160;<span class="comment">// set some conflicting compile flags which prevent compilation</span></div><div class="line"><a name="l00883"></a><span class="lineno">  883</span>&#160;</div><div class="line"><a name="l00884"></a><span class="lineno">  884</span>&#160;<span class="preprocessor">#  if DEAL_II_VECTORIZATION_WIDTH_IN_BITS &gt;= 512 &amp;&amp; defined(__AVX512F__)</span></div><div class="line"><a name="l00885"></a><span class="lineno">  885</span>&#160;</div><div class="line"><a name="l00891"></a><span class="lineno">  891</span>&#160;<span class="keyword">template</span> &lt;&gt;</div><div class="line"><a name="l00892"></a><span class="lineno">  892</span>&#160;<span class="keyword">class </span><a class="code" href="classVectorizedArray.html">VectorizedArray</a>&lt;double, 8&gt;</div><div class="line"><a name="l00893"></a><span class="lineno">  893</span>&#160;  : <span class="keyword">public</span> <a class="code" href="classVectorizedArrayBase.html">VectorizedArrayBase</a>&lt;VectorizedArray&lt;double, 8&gt;, 8&gt;</div><div class="line"><a name="l00894"></a><span class="lineno">  894</span>&#160;{</div><div class="line"><a name="l00895"></a><span class="lineno">  895</span>&#160;<span class="keyword">public</span>:</div><div class="line"><a name="l00900"></a><span class="lineno">  900</span>&#160;  <span class="keyword">using</span> value_type = double;</div><div class="line"><a name="l00901"></a><span class="lineno">  901</span>&#160;</div><div class="line"><a name="l00906"></a><span class="lineno">  906</span>&#160;  <a class="code" href="classVectorizedArray.html">VectorizedArray</a>() = <span class="keywordflow">default</span>;</div><div class="line"><a name="l00907"></a><span class="lineno">  907</span>&#160;</div><div class="line"><a name="l00912"></a><span class="lineno">  912</span>&#160;  <a class="code" href="classVectorizedArray.html">VectorizedArray</a>(<span class="keyword">const</span> <span class="keywordtype">double</span> scalar)</div><div class="line"><a name="l00913"></a><span class="lineno">  913</span>&#160;  {</div><div class="line"><a name="l00914"></a><span class="lineno">  914</span>&#160;    this-&gt;operator=(scalar);</div><div class="line"><a name="l00915"></a><span class="lineno">  915</span>&#160;  }</div><div class="line"><a name="l00916"></a><span class="lineno">  916</span>&#160;</div><div class="line"><a name="l00921"></a><span class="lineno">  921</span>&#160;  <a class="code" href="config_8h.html#a1d1d58e8be15e5c4285f6892e5f33136">DEAL_II_ALWAYS_INLINE</a></div><div class="line"><a name="l00922"></a><span class="lineno">  922</span>&#160;  <a class="code" href="classVectorizedArray.html">VectorizedArray</a> &amp;</div><div class="line"><a name="l00923"></a><span class="lineno">  923</span>&#160;  operator=(<span class="keyword">const</span> <span class="keywordtype">double</span> x)</div><div class="line"><a name="l00924"></a><span class="lineno">  924</span>&#160;  {</div><div class="line"><a name="l00925"></a><span class="lineno">  925</span>&#160;    data = _mm512_set1_pd(x);</div><div class="line"><a name="l00926"></a><span class="lineno">  926</span>&#160;    <span class="keywordflow">return</span> *<span class="keyword">this</span>;</div><div class="line"><a name="l00927"></a><span class="lineno">  927</span>&#160;  }</div><div class="line"><a name="l00928"></a><span class="lineno">  928</span>&#160;</div><div class="line"><a name="l00933"></a><span class="lineno">  933</span>&#160;  <a class="code" href="config_8h.html#a1d1d58e8be15e5c4285f6892e5f33136">DEAL_II_ALWAYS_INLINE</a></div><div class="line"><a name="l00934"></a><span class="lineno">  934</span>&#160;  <span class="keywordtype">double</span> &amp;operator[](<span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> comp)</div><div class="line"><a name="l00935"></a><span class="lineno">  935</span>&#160;  {</div><div class="line"><a name="l00936"></a><span class="lineno">  936</span>&#160;    <a class="code" href="group__Exceptions.html#gaafbb69cc2a791ae55880fd8d57d0c1b0">AssertIndexRange</a>(comp, 8);</div><div class="line"><a name="l00937"></a><span class="lineno">  937</span>&#160;    <span class="keywordflow">return</span> *(<span class="keyword">reinterpret_cast&lt;</span><span class="keywordtype">double</span> *<span class="keyword">&gt;</span>(&amp;data) + comp);</div><div class="line"><a name="l00938"></a><span class="lineno">  938</span>&#160;  }</div><div class="line"><a name="l00939"></a><span class="lineno">  939</span>&#160;</div><div class="line"><a name="l00944"></a><span class="lineno">  944</span>&#160;  <a class="code" href="config_8h.html#a1d1d58e8be15e5c4285f6892e5f33136">DEAL_II_ALWAYS_INLINE</a></div><div class="line"><a name="l00945"></a><span class="lineno">  945</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">double</span> &amp;operator[](<span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> comp)<span class="keyword"> const</span></div><div class="line"><a name="l00946"></a><span class="lineno">  946</span>&#160;<span class="keyword">  </span>{</div><div class="line"><a name="l00947"></a><span class="lineno">  947</span>&#160;    <a class="code" href="group__Exceptions.html#gaafbb69cc2a791ae55880fd8d57d0c1b0">AssertIndexRange</a>(comp, 8);</div><div class="line"><a name="l00948"></a><span class="lineno">  948</span>&#160;    <span class="keywordflow">return</span> *(<span class="keyword">reinterpret_cast&lt;</span><span class="keyword">const </span><span class="keywordtype">double</span> *<span class="keyword">&gt;</span>(&amp;data) + comp);</div><div class="line"><a name="l00949"></a><span class="lineno">  949</span>&#160;  }</div><div class="line"><a name="l00950"></a><span class="lineno">  950</span>&#160;</div><div class="line"><a name="l00955"></a><span class="lineno">  955</span>&#160;  <a class="code" href="config_8h.html#a1d1d58e8be15e5c4285f6892e5f33136">DEAL_II_ALWAYS_INLINE</a></div><div class="line"><a name="l00956"></a><span class="lineno">  956</span>&#160;  <a class="code" href="classVectorizedArray.html">VectorizedArray</a> &amp;</div><div class="line"><a name="l00957"></a><span class="lineno">  957</span>&#160;  operator+=(<span class="keyword">const</span> <a class="code" href="classVectorizedArray.html">VectorizedArray</a> &amp;vec)</div><div class="line"><a name="l00958"></a><span class="lineno">  958</span>&#160;  {</div><div class="line"><a name="l00959"></a><span class="lineno">  959</span>&#160;    <span class="comment">// if the compiler supports vector arithmetic, we can simply use +=</span></div><div class="line"><a name="l00960"></a><span class="lineno">  960</span>&#160;    <span class="comment">// operator on the given data type. this allows the compiler to combine</span></div><div class="line"><a name="l00961"></a><span class="lineno">  961</span>&#160;    <span class="comment">// additions with multiplication (fused multiply-add) if those</span></div><div class="line"><a name="l00962"></a><span class="lineno">  962</span>&#160;    <span class="comment">// instructions are available. Otherwise, we need to use the built-in</span></div><div class="line"><a name="l00963"></a><span class="lineno">  963</span>&#160;    <span class="comment">// intrinsic command for __m512d</span></div><div class="line"><a name="l00964"></a><span class="lineno">  964</span>&#160;<span class="preprocessor">#    ifdef DEAL_II_COMPILER_USE_VECTOR_ARITHMETICS</span></div><div class="line"><a name="l00965"></a><span class="lineno">  965</span>&#160;    data += vec.<a class="code" href="classVectorizedArray.html#ad38190d02537705964e021da7ecbab3f">data</a>;</div><div class="line"><a name="l00966"></a><span class="lineno">  966</span>&#160;<span class="preprocessor">#    else</span></div><div class="line"><a name="l00967"></a><span class="lineno">  967</span>&#160;    data = _mm512_add_pd(data, vec.<a class="code" href="classVectorizedArray.html#ad38190d02537705964e021da7ecbab3f">data</a>);</div><div class="line"><a name="l00968"></a><span class="lineno">  968</span>&#160;<span class="preprocessor">#    endif</span></div><div class="line"><a name="l00969"></a><span class="lineno">  969</span>&#160;    <span class="keywordflow">return</span> *<span class="keyword">this</span>;</div><div class="line"><a name="l00970"></a><span class="lineno">  970</span>&#160;  }</div><div class="line"><a name="l00971"></a><span class="lineno">  971</span>&#160;</div><div class="line"><a name="l00976"></a><span class="lineno">  976</span>&#160;  <a class="code" href="config_8h.html#a1d1d58e8be15e5c4285f6892e5f33136">DEAL_II_ALWAYS_INLINE</a></div><div class="line"><a name="l00977"></a><span class="lineno">  977</span>&#160;  <a class="code" href="classVectorizedArray.html">VectorizedArray</a> &amp;</div><div class="line"><a name="l00978"></a><span class="lineno">  978</span>&#160;  operator-=(<span class="keyword">const</span> <a class="code" href="classVectorizedArray.html">VectorizedArray</a> &amp;vec)</div><div class="line"><a name="l00979"></a><span class="lineno">  979</span>&#160;  {</div><div class="line"><a name="l00980"></a><span class="lineno">  980</span>&#160;<span class="preprocessor">#    ifdef DEAL_II_COMPILER_USE_VECTOR_ARITHMETICS</span></div><div class="line"><a name="l00981"></a><span class="lineno">  981</span>&#160;    data -= vec.<a class="code" href="classVectorizedArray.html#ad38190d02537705964e021da7ecbab3f">data</a>;</div><div class="line"><a name="l00982"></a><span class="lineno">  982</span>&#160;<span class="preprocessor">#    else</span></div><div class="line"><a name="l00983"></a><span class="lineno">  983</span>&#160;    data = _mm512_sub_pd(data, vec.<a class="code" href="classVectorizedArray.html#ad38190d02537705964e021da7ecbab3f">data</a>);</div><div class="line"><a name="l00984"></a><span class="lineno">  984</span>&#160;<span class="preprocessor">#    endif</span></div><div class="line"><a name="l00985"></a><span class="lineno">  985</span>&#160;    <span class="keywordflow">return</span> *<span class="keyword">this</span>;</div><div class="line"><a name="l00986"></a><span class="lineno">  986</span>&#160;  }</div><div class="line"><a name="l00991"></a><span class="lineno">  991</span>&#160;  <a class="code" href="config_8h.html#a1d1d58e8be15e5c4285f6892e5f33136">DEAL_II_ALWAYS_INLINE</a></div><div class="line"><a name="l00992"></a><span class="lineno">  992</span>&#160;  <a class="code" href="classVectorizedArray.html">VectorizedArray</a> &amp;</div><div class="line"><a name="l00993"></a><span class="lineno">  993</span>&#160;  operator*=(<span class="keyword">const</span> <a class="code" href="classVectorizedArray.html">VectorizedArray</a> &amp;vec)</div><div class="line"><a name="l00994"></a><span class="lineno">  994</span>&#160;  {</div><div class="line"><a name="l00995"></a><span class="lineno">  995</span>&#160;<span class="preprocessor">#    ifdef DEAL_II_COMPILER_USE_VECTOR_ARITHMETICS</span></div><div class="line"><a name="l00996"></a><span class="lineno">  996</span>&#160;    data *= vec.<a class="code" href="classVectorizedArray.html#ad38190d02537705964e021da7ecbab3f">data</a>;</div><div class="line"><a name="l00997"></a><span class="lineno">  997</span>&#160;<span class="preprocessor">#    else</span></div><div class="line"><a name="l00998"></a><span class="lineno">  998</span>&#160;    data = _mm512_mul_pd(data, vec.<a class="code" href="classVectorizedArray.html#ad38190d02537705964e021da7ecbab3f">data</a>);</div><div class="line"><a name="l00999"></a><span class="lineno">  999</span>&#160;<span class="preprocessor">#    endif</span></div><div class="line"><a name="l01000"></a><span class="lineno"> 1000</span>&#160;    <span class="keywordflow">return</span> *<span class="keyword">this</span>;</div><div class="line"><a name="l01001"></a><span class="lineno"> 1001</span>&#160;  }</div><div class="line"><a name="l01002"></a><span class="lineno"> 1002</span>&#160;</div><div class="line"><a name="l01007"></a><span class="lineno"> 1007</span>&#160;  <a class="code" href="config_8h.html#a1d1d58e8be15e5c4285f6892e5f33136">DEAL_II_ALWAYS_INLINE</a></div><div class="line"><a name="l01008"></a><span class="lineno"> 1008</span>&#160;  <a class="code" href="classVectorizedArray.html">VectorizedArray</a> &amp;</div><div class="line"><a name="l01009"></a><span class="lineno"> 1009</span>&#160;  operator/=(<span class="keyword">const</span> <a class="code" href="classVectorizedArray.html">VectorizedArray</a> &amp;vec)</div><div class="line"><a name="l01010"></a><span class="lineno"> 1010</span>&#160;  {</div><div class="line"><a name="l01011"></a><span class="lineno"> 1011</span>&#160;<span class="preprocessor">#    ifdef DEAL_II_COMPILER_USE_VECTOR_ARITHMETICS</span></div><div class="line"><a name="l01012"></a><span class="lineno"> 1012</span>&#160;    data /= vec.<a class="code" href="classVectorizedArray.html#ad38190d02537705964e021da7ecbab3f">data</a>;</div><div class="line"><a name="l01013"></a><span class="lineno"> 1013</span>&#160;<span class="preprocessor">#    else</span></div><div class="line"><a name="l01014"></a><span class="lineno"> 1014</span>&#160;    data = _mm512_div_pd(data, vec.<a class="code" href="classVectorizedArray.html#ad38190d02537705964e021da7ecbab3f">data</a>);</div><div class="line"><a name="l01015"></a><span class="lineno"> 1015</span>&#160;<span class="preprocessor">#    endif</span></div><div class="line"><a name="l01016"></a><span class="lineno"> 1016</span>&#160;    <span class="keywordflow">return</span> *<span class="keyword">this</span>;</div><div class="line"><a name="l01017"></a><span class="lineno"> 1017</span>&#160;  }</div><div class="line"><a name="l01018"></a><span class="lineno"> 1018</span>&#160;</div><div class="line"><a name="l01023"></a><span class="lineno"> 1023</span>&#160;  <a class="code" href="config_8h.html#a1d1d58e8be15e5c4285f6892e5f33136">DEAL_II_ALWAYS_INLINE</a></div><div class="line"><a name="l01024"></a><span class="lineno"> 1024</span>&#160;  <span class="keywordtype">void</span></div><div class="line"><a name="l01025"></a><span class="lineno"> 1025</span>&#160;  load(<span class="keyword">const</span> <span class="keywordtype">double</span> *ptr)</div><div class="line"><a name="l01026"></a><span class="lineno"> 1026</span>&#160;  {</div><div class="line"><a name="l01027"></a><span class="lineno"> 1027</span>&#160;    data = _mm512_loadu_pd(ptr);</div><div class="line"><a name="l01028"></a><span class="lineno"> 1028</span>&#160;  }</div><div class="line"><a name="l01029"></a><span class="lineno"> 1029</span>&#160;</div><div class="line"><a name="l01035"></a><span class="lineno"> 1035</span>&#160;  <a class="code" href="config_8h.html#a1d1d58e8be15e5c4285f6892e5f33136">DEAL_II_ALWAYS_INLINE</a></div><div class="line"><a name="l01036"></a><span class="lineno"> 1036</span>&#160;  <span class="keywordtype">void</span></div><div class="line"><a name="l01037"></a><span class="lineno"> 1037</span>&#160;  store(<span class="keywordtype">double</span> *ptr)<span class="keyword"> const</span></div><div class="line"><a name="l01038"></a><span class="lineno"> 1038</span>&#160;<span class="keyword">  </span>{</div><div class="line"><a name="l01039"></a><span class="lineno"> 1039</span>&#160;    _mm512_storeu_pd(ptr, data);</div><div class="line"><a name="l01040"></a><span class="lineno"> 1040</span>&#160;  }</div><div class="line"><a name="l01041"></a><span class="lineno"> 1041</span>&#160;</div><div class="line"><a name="l01047"></a><span class="lineno"> 1047</span>&#160;  <a class="code" href="config_8h.html#a1d1d58e8be15e5c4285f6892e5f33136">DEAL_II_ALWAYS_INLINE</a></div><div class="line"><a name="l01048"></a><span class="lineno"> 1048</span>&#160;  <span class="keywordtype">void</span></div><div class="line"><a name="l01049"></a><span class="lineno"> 1049</span>&#160;  streaming_store(<span class="keywordtype">double</span> *ptr)<span class="keyword"> const</span></div><div class="line"><a name="l01050"></a><span class="lineno"> 1050</span>&#160;<span class="keyword">  </span>{</div><div class="line"><a name="l01051"></a><span class="lineno"> 1051</span>&#160;    <a class="code" href="group__Exceptions.html#ga70a0bb353656e704acf927945277bbc6">Assert</a>(reinterpret_cast&lt;std::size_t&gt;(ptr) % 64 == 0,</div><div class="line"><a name="l01052"></a><span class="lineno"> 1052</span>&#160;           <a class="code" href="group__Exceptions.html#gae9a45f517af1401c50811a11083f9114">ExcMessage</a>(<span class="stringliteral">&quot;Memory not aligned&quot;</span>));</div><div class="line"><a name="l01053"></a><span class="lineno"> 1053</span>&#160;    _mm512_stream_pd(ptr, data);</div><div class="line"><a name="l01054"></a><span class="lineno"> 1054</span>&#160;  }</div><div class="line"><a name="l01055"></a><span class="lineno"> 1055</span>&#160;</div><div class="line"><a name="l01067"></a><span class="lineno"> 1067</span>&#160;  <a class="code" href="config_8h.html#a1d1d58e8be15e5c4285f6892e5f33136">DEAL_II_ALWAYS_INLINE</a></div><div class="line"><a name="l01068"></a><span class="lineno"> 1068</span>&#160;  <span class="keywordtype">void</span></div><div class="line"><a name="l01069"></a><span class="lineno"> 1069</span>&#160;  <a class="code" href="vectorization_8h.html#a078ca5de8d3a59aedc130823be15ad26">gather</a>(<span class="keyword">const</span> <span class="keywordtype">double</span> *base_ptr, <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> *offsets)</div><div class="line"><a name="l01070"></a><span class="lineno"> 1070</span>&#160;  {</div><div class="line"><a name="l01071"></a><span class="lineno"> 1071</span>&#160;    <span class="comment">// unfortunately, there does not appear to be a 256 bit integer load, so</span></div><div class="line"><a name="l01072"></a><span class="lineno"> 1072</span>&#160;    <span class="comment">// do it by some reinterpret casts here. this is allowed because the Intel</span></div><div class="line"><a name="l01073"></a><span class="lineno"> 1073</span>&#160;    <span class="comment">// API allows aliasing between different vector types.</span></div><div class="line"><a name="l01074"></a><span class="lineno"> 1074</span>&#160;    <span class="keyword">const</span> __m256 index_val =</div><div class="line"><a name="l01075"></a><span class="lineno"> 1075</span>&#160;      _mm256_loadu_ps(reinterpret_cast&lt;const float *&gt;(offsets));</div><div class="line"><a name="l01076"></a><span class="lineno"> 1076</span>&#160;    <span class="keyword">const</span> __m256i index = *<span class="keyword">reinterpret_cast&lt;</span><span class="keyword">const </span>__m256i *<span class="keyword">&gt;</span>(&amp;index_val);</div><div class="line"><a name="l01077"></a><span class="lineno"> 1077</span>&#160;    data                = _mm512_i32gather_pd(index, base_ptr, 8);</div><div class="line"><a name="l01078"></a><span class="lineno"> 1078</span>&#160;  }</div><div class="line"><a name="l01079"></a><span class="lineno"> 1079</span>&#160;</div><div class="line"><a name="l01090"></a><span class="lineno"> 1090</span>&#160;  <a class="code" href="config_8h.html#a1d1d58e8be15e5c4285f6892e5f33136">DEAL_II_ALWAYS_INLINE</a></div><div class="line"><a name="l01091"></a><span class="lineno"> 1091</span>&#160;  <span class="keywordtype">void</span></div><div class="line"><a name="l01092"></a><span class="lineno"> 1092</span>&#160;  scatter(<span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> *offsets, <span class="keywordtype">double</span> *base_ptr)<span class="keyword"> const</span></div><div class="line"><a name="l01093"></a><span class="lineno"> 1093</span>&#160;<span class="keyword">  </span>{</div><div class="line"><a name="l01094"></a><span class="lineno"> 1094</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i = 0; i &lt; 8; ++i)</div><div class="line"><a name="l01095"></a><span class="lineno"> 1095</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> j = i + 1; j &lt; 8; ++j)</div><div class="line"><a name="l01096"></a><span class="lineno"> 1096</span>&#160;        <a class="code" href="group__Exceptions.html#ga70a0bb353656e704acf927945277bbc6">Assert</a>(offsets[i] != offsets[j],</div><div class="line"><a name="l01097"></a><span class="lineno"> 1097</span>&#160;               <a class="code" href="group__Exceptions.html#gae9a45f517af1401c50811a11083f9114">ExcMessage</a>(<span class="stringliteral">&quot;Result of scatter undefined if two offset elements&quot;</span></div><div class="line"><a name="l01098"></a><span class="lineno"> 1098</span>&#160;                          <span class="stringliteral">&quot; point to the same position&quot;</span>));</div><div class="line"><a name="l01099"></a><span class="lineno"> 1099</span>&#160;</div><div class="line"><a name="l01100"></a><span class="lineno"> 1100</span>&#160;    <span class="comment">// unfortunately, there does not appear to be a 256 bit integer load, so</span></div><div class="line"><a name="l01101"></a><span class="lineno"> 1101</span>&#160;    <span class="comment">// do it by some reinterpret casts here. this is allowed because the Intel</span></div><div class="line"><a name="l01102"></a><span class="lineno"> 1102</span>&#160;    <span class="comment">// API allows aliasing between different vector types.</span></div><div class="line"><a name="l01103"></a><span class="lineno"> 1103</span>&#160;    <span class="keyword">const</span> __m256 index_val =</div><div class="line"><a name="l01104"></a><span class="lineno"> 1104</span>&#160;      _mm256_loadu_ps(reinterpret_cast&lt;const float *&gt;(offsets));</div><div class="line"><a name="l01105"></a><span class="lineno"> 1105</span>&#160;    <span class="keyword">const</span> __m256i index = *<span class="keyword">reinterpret_cast&lt;</span><span class="keyword">const </span>__m256i *<span class="keyword">&gt;</span>(&amp;index_val);</div><div class="line"><a name="l01106"></a><span class="lineno"> 1106</span>&#160;    _mm512_i32scatter_pd(base_ptr, index, data, 8);</div><div class="line"><a name="l01107"></a><span class="lineno"> 1107</span>&#160;  }</div><div class="line"><a name="l01108"></a><span class="lineno"> 1108</span>&#160;</div><div class="line"><a name="l01113"></a><span class="lineno"> 1113</span>&#160;  __m512d data;</div><div class="line"><a name="l01114"></a><span class="lineno"> 1114</span>&#160;</div><div class="line"><a name="l01115"></a><span class="lineno"> 1115</span>&#160;<span class="keyword">private</span>:</div><div class="line"><a name="l01120"></a><span class="lineno"> 1120</span>&#160;  <a class="code" href="config_8h.html#a1d1d58e8be15e5c4285f6892e5f33136">DEAL_II_ALWAYS_INLINE</a></div><div class="line"><a name="l01121"></a><span class="lineno"> 1121</span>&#160;  <a class="code" href="classVectorizedArray.html">VectorizedArray</a></div><div class="line"><a name="l01122"></a><span class="lineno"> 1122</span>&#160;  get_sqrt()<span class="keyword"> const</span></div><div class="line"><a name="l01123"></a><span class="lineno"> 1123</span>&#160;<span class="keyword">  </span>{</div><div class="line"><a name="l01124"></a><span class="lineno"> 1124</span>&#160;    <a class="code" href="classVectorizedArray.html">VectorizedArray</a> res;</div><div class="line"><a name="l01125"></a><span class="lineno"> 1125</span>&#160;    res.<a class="code" href="classVectorizedArray.html#ad38190d02537705964e021da7ecbab3f">data</a> = _mm512_sqrt_pd(data);</div><div class="line"><a name="l01126"></a><span class="lineno"> 1126</span>&#160;    <span class="keywordflow">return</span> res;</div><div class="line"><a name="l01127"></a><span class="lineno"> 1127</span>&#160;  }</div><div class="line"><a name="l01128"></a><span class="lineno"> 1128</span>&#160;</div><div class="line"><a name="l01133"></a><span class="lineno"> 1133</span>&#160;  <a class="code" href="config_8h.html#a1d1d58e8be15e5c4285f6892e5f33136">DEAL_II_ALWAYS_INLINE</a></div><div class="line"><a name="l01134"></a><span class="lineno"> 1134</span>&#160;  <a class="code" href="classVectorizedArray.html">VectorizedArray</a></div><div class="line"><a name="l01135"></a><span class="lineno"> 1135</span>&#160;  get_abs()<span class="keyword"> const</span></div><div class="line"><a name="l01136"></a><span class="lineno"> 1136</span>&#160;<span class="keyword">  </span>{</div><div class="line"><a name="l01137"></a><span class="lineno"> 1137</span>&#160;    <span class="comment">// to compute the absolute value, perform bitwise andnot with -0. This</span></div><div class="line"><a name="l01138"></a><span class="lineno"> 1138</span>&#160;    <span class="comment">// will leave all value and exponent bits unchanged but force the sign</span></div><div class="line"><a name="l01139"></a><span class="lineno"> 1139</span>&#160;    <span class="comment">// value to +. Since there is no andnot for AVX512, we interpret the data</span></div><div class="line"><a name="l01140"></a><span class="lineno"> 1140</span>&#160;    <span class="comment">// as 64 bit integers and do the andnot on those types (note that andnot</span></div><div class="line"><a name="l01141"></a><span class="lineno"> 1141</span>&#160;    <span class="comment">// is a bitwise operation so the data type does not matter)</span></div><div class="line"><a name="l01142"></a><span class="lineno"> 1142</span>&#160;    __m512d         mask = _mm512_set1_pd(-0.);</div><div class="line"><a name="l01143"></a><span class="lineno"> 1143</span>&#160;    <a class="code" href="classVectorizedArray.html">VectorizedArray</a> res;</div><div class="line"><a name="l01144"></a><span class="lineno"> 1144</span>&#160;    res.<a class="code" href="classVectorizedArray.html#ad38190d02537705964e021da7ecbab3f">data</a> = <span class="keyword">reinterpret_cast&lt;</span>__m512d<span class="keyword">&gt;</span>(</div><div class="line"><a name="l01145"></a><span class="lineno"> 1145</span>&#160;      _mm512_andnot_epi64(reinterpret_cast&lt;__m512i&gt;(mask),</div><div class="line"><a name="l01146"></a><span class="lineno"> 1146</span>&#160;                          reinterpret_cast&lt;__m512i&gt;(data)));</div><div class="line"><a name="l01147"></a><span class="lineno"> 1147</span>&#160;    <span class="keywordflow">return</span> res;</div><div class="line"><a name="l01148"></a><span class="lineno"> 1148</span>&#160;  }</div><div class="line"><a name="l01149"></a><span class="lineno"> 1149</span>&#160;</div><div class="line"><a name="l01154"></a><span class="lineno"> 1154</span>&#160;  <a class="code" href="config_8h.html#a1d1d58e8be15e5c4285f6892e5f33136">DEAL_II_ALWAYS_INLINE</a></div><div class="line"><a name="l01155"></a><span class="lineno"> 1155</span>&#160;  <a class="code" href="classVectorizedArray.html">VectorizedArray</a></div><div class="line"><a name="l01156"></a><span class="lineno"> 1156</span>&#160;  get_max(<span class="keyword">const</span> <a class="code" href="classVectorizedArray.html">VectorizedArray</a> &amp;other)<span class="keyword"> const</span></div><div class="line"><a name="l01157"></a><span class="lineno"> 1157</span>&#160;<span class="keyword">  </span>{</div><div class="line"><a name="l01158"></a><span class="lineno"> 1158</span>&#160;    <a class="code" href="classVectorizedArray.html">VectorizedArray</a> res;</div><div class="line"><a name="l01159"></a><span class="lineno"> 1159</span>&#160;    res.<a class="code" href="classVectorizedArray.html#ad38190d02537705964e021da7ecbab3f">data</a> = _mm512_max_pd(data, other.<a class="code" href="classVectorizedArray.html#ad38190d02537705964e021da7ecbab3f">data</a>);</div><div class="line"><a name="l01160"></a><span class="lineno"> 1160</span>&#160;    <span class="keywordflow">return</span> res;</div><div class="line"><a name="l01161"></a><span class="lineno"> 1161</span>&#160;  }</div><div class="line"><a name="l01162"></a><span class="lineno"> 1162</span>&#160;</div><div class="line"><a name="l01167"></a><span class="lineno"> 1167</span>&#160;  <a class="code" href="config_8h.html#a1d1d58e8be15e5c4285f6892e5f33136">DEAL_II_ALWAYS_INLINE</a></div><div class="line"><a name="l01168"></a><span class="lineno"> 1168</span>&#160;  <a class="code" href="classVectorizedArray.html">VectorizedArray</a></div><div class="line"><a name="l01169"></a><span class="lineno"> 1169</span>&#160;  get_min(<span class="keyword">const</span> <a class="code" href="classVectorizedArray.html">VectorizedArray</a> &amp;other)<span class="keyword"> const</span></div><div class="line"><a name="l01170"></a><span class="lineno"> 1170</span>&#160;<span class="keyword">  </span>{</div><div class="line"><a name="l01171"></a><span class="lineno"> 1171</span>&#160;    <a class="code" href="classVectorizedArray.html">VectorizedArray</a> res;</div><div class="line"><a name="l01172"></a><span class="lineno"> 1172</span>&#160;    res.<a class="code" href="classVectorizedArray.html#ad38190d02537705964e021da7ecbab3f">data</a> = _mm512_min_pd(data, other.<a class="code" href="classVectorizedArray.html#ad38190d02537705964e021da7ecbab3f">data</a>);</div><div class="line"><a name="l01173"></a><span class="lineno"> 1173</span>&#160;    <span class="keywordflow">return</span> res;</div><div class="line"><a name="l01174"></a><span class="lineno"> 1174</span>&#160;  }</div><div class="line"><a name="l01175"></a><span class="lineno"> 1175</span>&#160;</div><div class="line"><a name="l01176"></a><span class="lineno"> 1176</span>&#160;  <span class="comment">// Make a few functions friends.</span></div><div class="line"><a name="l01177"></a><span class="lineno"> 1177</span>&#160;  <span class="keyword">template</span> &lt;<span class="keyword">typename</span> Number2, std::<span class="keywordtype">size_t</span> w<span class="keywordtype">id</span>th2&gt;</div><div class="line"><a name="l01178"></a><span class="lineno"> 1178</span>&#160;  <span class="keyword">friend</span> <a class="code" href="classVectorizedArray.html">VectorizedArray&lt;Number2, width2&gt;</a></div><div class="line"><a name="l01179"></a><span class="lineno"> 1179</span>&#160;  std::sqrt(<span class="keyword">const</span> <a class="code" href="classVectorizedArray.html">VectorizedArray&lt;Number2, width2&gt;</a> &amp;);</div><div class="line"><a name="l01180"></a><span class="lineno"> 1180</span>&#160;  <span class="keyword">template</span> &lt;<span class="keyword">typename</span> Number2, std::<span class="keywordtype">size_t</span> w<span class="keywordtype">id</span>th2&gt;</div><div class="line"><a name="l01181"></a><span class="lineno"> 1181</span>&#160;  <span class="keyword">friend</span> <a class="code" href="classVectorizedArray.html">VectorizedArray&lt;Number2, width2&gt;</a></div><div class="line"><a name="l01182"></a><span class="lineno"> 1182</span>&#160;  std::abs(<span class="keyword">const</span> <a class="code" href="classVectorizedArray.html">VectorizedArray&lt;Number2, width2&gt;</a> &amp;);</div><div class="line"><a name="l01183"></a><span class="lineno"> 1183</span>&#160;  <span class="keyword">template</span> &lt;<span class="keyword">typename</span> Number2, std::<span class="keywordtype">size_t</span> w<span class="keywordtype">id</span>th2&gt;</div><div class="line"><a name="l01184"></a><span class="lineno"> 1184</span>&#160;  <span class="keyword">friend</span> <a class="code" href="classVectorizedArray.html">VectorizedArray&lt;Number2, width2&gt;</a></div><div class="line"><a name="l01185"></a><span class="lineno"> 1185</span>&#160;  std::max(<span class="keyword">const</span> <a class="code" href="classVectorizedArray.html">VectorizedArray&lt;Number2, width2&gt;</a> &amp;,</div><div class="line"><a name="l01186"></a><span class="lineno"> 1186</span>&#160;           <span class="keyword">const</span> <a class="code" href="classVectorizedArray.html">VectorizedArray&lt;Number2, width2&gt;</a> &amp;);</div><div class="line"><a name="l01187"></a><span class="lineno"> 1187</span>&#160;  <span class="keyword">template</span> &lt;<span class="keyword">typename</span> Number2, std::<span class="keywordtype">size_t</span> w<span class="keywordtype">id</span>th2&gt;</div><div class="line"><a name="l01188"></a><span class="lineno"> 1188</span>&#160;  <span class="keyword">friend</span> <a class="code" href="classVectorizedArray.html">VectorizedArray&lt;Number2, width2&gt;</a></div><div class="line"><a name="l01189"></a><span class="lineno"> 1189</span>&#160;  std::min(<span class="keyword">const</span> <a class="code" href="classVectorizedArray.html">VectorizedArray&lt;Number2, width2&gt;</a> &amp;,</div><div class="line"><a name="l01190"></a><span class="lineno"> 1190</span>&#160;           <span class="keyword">const</span> <a class="code" href="classVectorizedArray.html">VectorizedArray&lt;Number2, width2&gt;</a> &amp;);</div><div class="line"><a name="l01191"></a><span class="lineno"> 1191</span>&#160;};</div><div class="line"><a name="l01192"></a><span class="lineno"> 1192</span>&#160;</div><div class="line"><a name="l01193"></a><span class="lineno"> 1193</span>&#160;</div><div class="line"><a name="l01194"></a><span class="lineno"> 1194</span>&#160;</div><div class="line"><a name="l01200"></a><span class="lineno"> 1200</span>&#160;<span class="keyword">template</span> &lt;&gt;</div><div class="line"><a name="l01201"></a><span class="lineno"> 1201</span>&#160;<span class="keyword">inline</span> <a class="code" href="config_8h.html#a1d1d58e8be15e5c4285f6892e5f33136">DEAL_II_ALWAYS_INLINE</a> <span class="keywordtype">void</span></div><div class="line"><a name="l01202"></a><span class="lineno"> 1202</span>&#160;<a class="code" href="vectorization_8h.html#a14da4327264fd3a88a9f73a8f72a9094">vectorized_load_and_transpose</a>(<span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span>          n_entries,</div><div class="line"><a name="l01203"></a><span class="lineno"> 1203</span>&#160;                              <span class="keyword">const</span> <span class="keywordtype">double</span> *              in,</div><div class="line"><a name="l01204"></a><span class="lineno"> 1204</span>&#160;                              <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> *        offsets,</div><div class="line"><a name="l01205"></a><span class="lineno"> 1205</span>&#160;                              <a class="code" href="classVectorizedArray.html">VectorizedArray&lt;double, 8&gt;</a> *out)</div><div class="line"><a name="l01206"></a><span class="lineno"> 1206</span>&#160;{</div><div class="line"><a name="l01207"></a><span class="lineno"> 1207</span>&#160;  <span class="comment">// do not do full transpose because the code is long and will most</span></div><div class="line"><a name="l01208"></a><span class="lineno"> 1208</span>&#160;  <span class="comment">// likely not pay off because many processors have two load units</span></div><div class="line"><a name="l01209"></a><span class="lineno"> 1209</span>&#160;  <span class="comment">// (for the top 8 instructions) but only 1 permute unit (for the 8</span></div><div class="line"><a name="l01210"></a><span class="lineno"> 1210</span>&#160;  <span class="comment">// shuffle/unpack instructions). rather start the transposition on the</span></div><div class="line"><a name="l01211"></a><span class="lineno"> 1211</span>&#160;  <span class="comment">// vectorized array of half the size with 256 bits</span></div><div class="line"><a name="l01212"></a><span class="lineno"> 1212</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> n_chunks = n_entries / 4;</div><div class="line"><a name="l01213"></a><span class="lineno"> 1213</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i = 0; i &lt; n_chunks; ++i)</div><div class="line"><a name="l01214"></a><span class="lineno"> 1214</span>&#160;    {</div><div class="line"><a name="l01215"></a><span class="lineno"> 1215</span>&#160;      __m512d t0, t1, t2, t3 = {};</div><div class="line"><a name="l01216"></a><span class="lineno"> 1216</span>&#160;</div><div class="line"><a name="l01217"></a><span class="lineno"> 1217</span>&#160;      t0 = _mm512_insertf64x4(t3, _mm256_loadu_pd(in + offsets[0] + 4 * i), 0);</div><div class="line"><a name="l01218"></a><span class="lineno"> 1218</span>&#160;      t0 = _mm512_insertf64x4(t0, _mm256_loadu_pd(in + offsets[2] + 4 * i), 1);</div><div class="line"><a name="l01219"></a><span class="lineno"> 1219</span>&#160;      t1 = _mm512_insertf64x4(t3, _mm256_loadu_pd(in + offsets[1] + 4 * i), 0);</div><div class="line"><a name="l01220"></a><span class="lineno"> 1220</span>&#160;      t1 = _mm512_insertf64x4(t1, _mm256_loadu_pd(in + offsets[3] + 4 * i), 1);</div><div class="line"><a name="l01221"></a><span class="lineno"> 1221</span>&#160;      t2 = _mm512_insertf64x4(t3, _mm256_loadu_pd(in + offsets[4] + 4 * i), 0);</div><div class="line"><a name="l01222"></a><span class="lineno"> 1222</span>&#160;      t2 = _mm512_insertf64x4(t2, _mm256_loadu_pd(in + offsets[6] + 4 * i), 1);</div><div class="line"><a name="l01223"></a><span class="lineno"> 1223</span>&#160;      t3 = _mm512_insertf64x4(t3, _mm256_loadu_pd(in + offsets[5] + 4 * i), 0);</div><div class="line"><a name="l01224"></a><span class="lineno"> 1224</span>&#160;      t3 = _mm512_insertf64x4(t3, _mm256_loadu_pd(in + offsets[7] + 4 * i), 1);</div><div class="line"><a name="l01225"></a><span class="lineno"> 1225</span>&#160;</div><div class="line"><a name="l01226"></a><span class="lineno"> 1226</span>&#160;      __m512d <a class="code" href="grid__tools_8cc.html#ad817a8f7e41831b2c2971f6eb7142f26">v0</a>          = _mm512_shuffle_f64x2(t0, t2, 0x88);</div><div class="line"><a name="l01227"></a><span class="lineno"> 1227</span>&#160;      __m512d <a class="code" href="grid__tools_8cc.html#adec67e1e77f5ae4fad3d65a5fb8036e9">v1</a>          = _mm512_shuffle_f64x2(t0, t2, 0xdd);</div><div class="line"><a name="l01228"></a><span class="lineno"> 1228</span>&#160;      __m512d v2          = _mm512_shuffle_f64x2(t1, t3, 0x88);</div><div class="line"><a name="l01229"></a><span class="lineno"> 1229</span>&#160;      __m512d v3          = _mm512_shuffle_f64x2(t1, t3, 0xdd);</div><div class="line"><a name="l01230"></a><span class="lineno"> 1230</span>&#160;      out[4 * i + 0].<a class="code" href="classVectorizedArray.html#ad38190d02537705964e021da7ecbab3f">data</a> = _mm512_unpacklo_pd(v0, v2);</div><div class="line"><a name="l01231"></a><span class="lineno"> 1231</span>&#160;      out[4 * i + 1].<a class="code" href="classVectorizedArray.html#ad38190d02537705964e021da7ecbab3f">data</a> = _mm512_unpackhi_pd(v0, v2);</div><div class="line"><a name="l01232"></a><span class="lineno"> 1232</span>&#160;      out[4 * i + 2].<a class="code" href="classVectorizedArray.html#ad38190d02537705964e021da7ecbab3f">data</a> = _mm512_unpacklo_pd(v1, v3);</div><div class="line"><a name="l01233"></a><span class="lineno"> 1233</span>&#160;      out[4 * i + 3].<a class="code" href="classVectorizedArray.html#ad38190d02537705964e021da7ecbab3f">data</a> = _mm512_unpackhi_pd(v1, v3);</div><div class="line"><a name="l01234"></a><span class="lineno"> 1234</span>&#160;    }</div><div class="line"><a name="l01235"></a><span class="lineno"> 1235</span>&#160;  <span class="comment">// remainder loop of work that does not divide by 4</span></div><div class="line"><a name="l01236"></a><span class="lineno"> 1236</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i = 4 * n_chunks; i &lt; n_entries; ++i)</div><div class="line"><a name="l01237"></a><span class="lineno"> 1237</span>&#160;    out[i].<a class="code" href="vectorization_8h.html#a078ca5de8d3a59aedc130823be15ad26">gather</a>(in + i, offsets);</div><div class="line"><a name="l01238"></a><span class="lineno"> 1238</span>&#160;}</div><div class="line"><a name="l01239"></a><span class="lineno"> 1239</span>&#160;</div><div class="line"><a name="l01240"></a><span class="lineno"> 1240</span>&#160;</div><div class="line"><a name="l01241"></a><span class="lineno"> 1241</span>&#160;</div><div class="line"><a name="l01247"></a><span class="lineno"> 1247</span>&#160;<span class="keyword">template</span> &lt;&gt;</div><div class="line"><a name="l01248"></a><span class="lineno"> 1248</span>&#160;<span class="keyword">inline</span> <a class="code" href="config_8h.html#a1d1d58e8be15e5c4285f6892e5f33136">DEAL_II_ALWAYS_INLINE</a> <span class="keywordtype">void</span></div><div class="line"><a name="l01249"></a><span class="lineno"> 1249</span>&#160;<a class="code" href="vectorization_8h.html#a14da4327264fd3a88a9f73a8f72a9094">vectorized_load_and_transpose</a>(<span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span>             n_entries,</div><div class="line"><a name="l01250"></a><span class="lineno"> 1250</span>&#160;                              <span class="keyword">const</span> std::array&lt;double *, 8&gt; &amp;in,</div><div class="line"><a name="l01251"></a><span class="lineno"> 1251</span>&#160;                              <a class="code" href="classVectorizedArray.html">VectorizedArray&lt;double, 8&gt;</a> *   out)</div><div class="line"><a name="l01252"></a><span class="lineno"> 1252</span>&#160;{</div><div class="line"><a name="l01253"></a><span class="lineno"> 1253</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> n_chunks = n_entries / 4;</div><div class="line"><a name="l01254"></a><span class="lineno"> 1254</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i = 0; i &lt; n_chunks; ++i)</div><div class="line"><a name="l01255"></a><span class="lineno"> 1255</span>&#160;    {</div><div class="line"><a name="l01256"></a><span class="lineno"> 1256</span>&#160;      __m512d t0, t1, t2, t3 = {};</div><div class="line"><a name="l01257"></a><span class="lineno"> 1257</span>&#160;</div><div class="line"><a name="l01258"></a><span class="lineno"> 1258</span>&#160;      t0 = _mm512_insertf64x4(t3, _mm256_loadu_pd(in[0] + 4 * i), 0);</div><div class="line"><a name="l01259"></a><span class="lineno"> 1259</span>&#160;      t0 = _mm512_insertf64x4(t0, _mm256_loadu_pd(in[2] + 4 * i), 1);</div><div class="line"><a name="l01260"></a><span class="lineno"> 1260</span>&#160;      t1 = _mm512_insertf64x4(t3, _mm256_loadu_pd(in[1] + 4 * i), 0);</div><div class="line"><a name="l01261"></a><span class="lineno"> 1261</span>&#160;      t1 = _mm512_insertf64x4(t1, _mm256_loadu_pd(in[3] + 4 * i), 1);</div><div class="line"><a name="l01262"></a><span class="lineno"> 1262</span>&#160;      t2 = _mm512_insertf64x4(t3, _mm256_loadu_pd(in[4] + 4 * i), 0);</div><div class="line"><a name="l01263"></a><span class="lineno"> 1263</span>&#160;      t2 = _mm512_insertf64x4(t2, _mm256_loadu_pd(in[6] + 4 * i), 1);</div><div class="line"><a name="l01264"></a><span class="lineno"> 1264</span>&#160;      t3 = _mm512_insertf64x4(t3, _mm256_loadu_pd(in[5] + 4 * i), 0);</div><div class="line"><a name="l01265"></a><span class="lineno"> 1265</span>&#160;      t3 = _mm512_insertf64x4(t3, _mm256_loadu_pd(in[7] + 4 * i), 1);</div><div class="line"><a name="l01266"></a><span class="lineno"> 1266</span>&#160;</div><div class="line"><a name="l01267"></a><span class="lineno"> 1267</span>&#160;      __m512d <a class="code" href="grid__tools_8cc.html#ad817a8f7e41831b2c2971f6eb7142f26">v0</a>          = _mm512_shuffle_f64x2(t0, t2, 0x88);</div><div class="line"><a name="l01268"></a><span class="lineno"> 1268</span>&#160;      __m512d <a class="code" href="grid__tools_8cc.html#adec67e1e77f5ae4fad3d65a5fb8036e9">v1</a>          = _mm512_shuffle_f64x2(t0, t2, 0xdd);</div><div class="line"><a name="l01269"></a><span class="lineno"> 1269</span>&#160;      __m512d v2          = _mm512_shuffle_f64x2(t1, t3, 0x88);</div><div class="line"><a name="l01270"></a><span class="lineno"> 1270</span>&#160;      __m512d v3          = _mm512_shuffle_f64x2(t1, t3, 0xdd);</div><div class="line"><a name="l01271"></a><span class="lineno"> 1271</span>&#160;      out[4 * i + 0].<a class="code" href="classVectorizedArray.html#ad38190d02537705964e021da7ecbab3f">data</a> = _mm512_unpacklo_pd(v0, v2);</div><div class="line"><a name="l01272"></a><span class="lineno"> 1272</span>&#160;      out[4 * i + 1].<a class="code" href="classVectorizedArray.html#ad38190d02537705964e021da7ecbab3f">data</a> = _mm512_unpackhi_pd(v0, v2);</div><div class="line"><a name="l01273"></a><span class="lineno"> 1273</span>&#160;      out[4 * i + 2].<a class="code" href="classVectorizedArray.html#ad38190d02537705964e021da7ecbab3f">data</a> = _mm512_unpacklo_pd(v1, v3);</div><div class="line"><a name="l01274"></a><span class="lineno"> 1274</span>&#160;      out[4 * i + 3].<a class="code" href="classVectorizedArray.html#ad38190d02537705964e021da7ecbab3f">data</a> = _mm512_unpackhi_pd(v1, v3);</div><div class="line"><a name="l01275"></a><span class="lineno"> 1275</span>&#160;    }</div><div class="line"><a name="l01276"></a><span class="lineno"> 1276</span>&#160;</div><div class="line"><a name="l01277"></a><span class="lineno"> 1277</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i = 4 * n_chunks; i &lt; n_entries; ++i)</div><div class="line"><a name="l01278"></a><span class="lineno"> 1278</span>&#160;    <a class="code" href="vectorization_8h.html#a078ca5de8d3a59aedc130823be15ad26">gather</a>(out[i], in, i);</div><div class="line"><a name="l01279"></a><span class="lineno"> 1279</span>&#160;}</div><div class="line"><a name="l01280"></a><span class="lineno"> 1280</span>&#160;</div><div class="line"><a name="l01281"></a><span class="lineno"> 1281</span>&#160;</div><div class="line"><a name="l01282"></a><span class="lineno"> 1282</span>&#160;</div><div class="line"><a name="l01288"></a><span class="lineno"> 1288</span>&#160;<span class="keyword">template</span> &lt;&gt;</div><div class="line"><a name="l01289"></a><span class="lineno"> 1289</span>&#160;<span class="keyword">inline</span> <a class="code" href="config_8h.html#a1d1d58e8be15e5c4285f6892e5f33136">DEAL_II_ALWAYS_INLINE</a> <span class="keywordtype">void</span></div><div class="line"><a name="l01290"></a><span class="lineno"> 1290</span>&#160;<a class="code" href="vectorization_8h.html#af396b43c783502e8acd2ca7d071a7325">vectorized_transpose_and_store</a>(<span class="keyword">const</span> <span class="keywordtype">bool</span>                        add_into,</div><div class="line"><a name="l01291"></a><span class="lineno"> 1291</span>&#160;                               <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span>                n_entries,</div><div class="line"><a name="l01292"></a><span class="lineno"> 1292</span>&#160;                               <span class="keyword">const</span> <a class="code" href="classVectorizedArray.html">VectorizedArray&lt;double, 8&gt;</a> *in,</div><div class="line"><a name="l01293"></a><span class="lineno"> 1293</span>&#160;                               <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> *              offsets,</div><div class="line"><a name="l01294"></a><span class="lineno"> 1294</span>&#160;                               <span class="keywordtype">double</span> *                          out)</div><div class="line"><a name="l01295"></a><span class="lineno"> 1295</span>&#160;{</div><div class="line"><a name="l01296"></a><span class="lineno"> 1296</span>&#160;  <span class="comment">// as for the load, we split the store operations into 256 bit units to</span></div><div class="line"><a name="l01297"></a><span class="lineno"> 1297</span>&#160;  <span class="comment">// better balance between code size, shuffle instructions, and stores</span></div><div class="line"><a name="l01298"></a><span class="lineno"> 1298</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> n_chunks = n_entries / 4;</div><div class="line"><a name="l01299"></a><span class="lineno"> 1299</span>&#160;  __m512i mask1 = _mm512_set_epi64(0xd, 0xc, 0x5, 0x4, 0x9, 0x8, 0x1, 0x0);</div><div class="line"><a name="l01300"></a><span class="lineno"> 1300</span>&#160;  __m512i mask2 = _mm512_set_epi64(0xf, 0xe, 0x7, 0x6, 0xb, 0xa, 0x3, 0x2);</div><div class="line"><a name="l01301"></a><span class="lineno"> 1301</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i = 0; i &lt; n_chunks; ++i)</div><div class="line"><a name="l01302"></a><span class="lineno"> 1302</span>&#160;    {</div><div class="line"><a name="l01303"></a><span class="lineno"> 1303</span>&#160;      __m512d t0   = _mm512_unpacklo_pd(in[i * 4].data, in[i * 4 + 1].data);</div><div class="line"><a name="l01304"></a><span class="lineno"> 1304</span>&#160;      __m512d t1   = _mm512_unpackhi_pd(in[i * 4].data, in[i * 4 + 1].data);</div><div class="line"><a name="l01305"></a><span class="lineno"> 1305</span>&#160;      __m512d t2   = _mm512_unpacklo_pd(in[i * 4 + 2].data, in[i * 4 + 3].data);</div><div class="line"><a name="l01306"></a><span class="lineno"> 1306</span>&#160;      __m512d t3   = _mm512_unpackhi_pd(in[i * 4 + 2].data, in[i * 4 + 3].data);</div><div class="line"><a name="l01307"></a><span class="lineno"> 1307</span>&#160;      __m512d <a class="code" href="grid__tools_8cc.html#ad817a8f7e41831b2c2971f6eb7142f26">v0</a>   = _mm512_permutex2var_pd(t0, mask1, t2);</div><div class="line"><a name="l01308"></a><span class="lineno"> 1308</span>&#160;      __m512d <a class="code" href="grid__tools_8cc.html#adec67e1e77f5ae4fad3d65a5fb8036e9">v1</a>   = _mm512_permutex2var_pd(t0, mask2, t2);</div><div class="line"><a name="l01309"></a><span class="lineno"> 1309</span>&#160;      __m512d v2   = _mm512_permutex2var_pd(t1, mask1, t3);</div><div class="line"><a name="l01310"></a><span class="lineno"> 1310</span>&#160;      __m512d v3   = _mm512_permutex2var_pd(t1, mask2, t3);</div><div class="line"><a name="l01311"></a><span class="lineno"> 1311</span>&#160;      __m256d res0 = _mm512_extractf64x4_pd(v0, 0);</div><div class="line"><a name="l01312"></a><span class="lineno"> 1312</span>&#160;      __m256d res4 = _mm512_extractf64x4_pd(v0, 1);</div><div class="line"><a name="l01313"></a><span class="lineno"> 1313</span>&#160;      __m256d res1 = _mm512_extractf64x4_pd(v2, 0);</div><div class="line"><a name="l01314"></a><span class="lineno"> 1314</span>&#160;      __m256d res5 = _mm512_extractf64x4_pd(v2, 1);</div><div class="line"><a name="l01315"></a><span class="lineno"> 1315</span>&#160;      __m256d res2 = _mm512_extractf64x4_pd(v1, 0);</div><div class="line"><a name="l01316"></a><span class="lineno"> 1316</span>&#160;      __m256d res6 = _mm512_extractf64x4_pd(v1, 1);</div><div class="line"><a name="l01317"></a><span class="lineno"> 1317</span>&#160;      __m256d res3 = _mm512_extractf64x4_pd(v3, 0);</div><div class="line"><a name="l01318"></a><span class="lineno"> 1318</span>&#160;      __m256d res7 = _mm512_extractf64x4_pd(v3, 1);</div><div class="line"><a name="l01319"></a><span class="lineno"> 1319</span>&#160;</div><div class="line"><a name="l01320"></a><span class="lineno"> 1320</span>&#160;      <span class="comment">// Cannot use the same store instructions in both paths of the &#39;if&#39;</span></div><div class="line"><a name="l01321"></a><span class="lineno"> 1321</span>&#160;      <span class="comment">// because the compiler cannot know that there is no aliasing</span></div><div class="line"><a name="l01322"></a><span class="lineno"> 1322</span>&#160;      <span class="comment">// between pointers</span></div><div class="line"><a name="l01323"></a><span class="lineno"> 1323</span>&#160;      <span class="keywordflow">if</span> (add_into)</div><div class="line"><a name="l01324"></a><span class="lineno"> 1324</span>&#160;        {</div><div class="line"><a name="l01325"></a><span class="lineno"> 1325</span>&#160;          res0 = _mm256_add_pd(_mm256_loadu_pd(out + 4 * i + offsets[0]), res0);</div><div class="line"><a name="l01326"></a><span class="lineno"> 1326</span>&#160;          _mm256_storeu_pd(out + 4 * i + offsets[0], res0);</div><div class="line"><a name="l01327"></a><span class="lineno"> 1327</span>&#160;          res1 = _mm256_add_pd(_mm256_loadu_pd(out + 4 * i + offsets[1]), res1);</div><div class="line"><a name="l01328"></a><span class="lineno"> 1328</span>&#160;          _mm256_storeu_pd(out + 4 * i + offsets[1], res1);</div><div class="line"><a name="l01329"></a><span class="lineno"> 1329</span>&#160;          res2 = _mm256_add_pd(_mm256_loadu_pd(out + 4 * i + offsets[2]), res2);</div><div class="line"><a name="l01330"></a><span class="lineno"> 1330</span>&#160;          _mm256_storeu_pd(out + 4 * i + offsets[2], res2);</div><div class="line"><a name="l01331"></a><span class="lineno"> 1331</span>&#160;          res3 = _mm256_add_pd(_mm256_loadu_pd(out + 4 * i + offsets[3]), res3);</div><div class="line"><a name="l01332"></a><span class="lineno"> 1332</span>&#160;          _mm256_storeu_pd(out + 4 * i + offsets[3], res3);</div><div class="line"><a name="l01333"></a><span class="lineno"> 1333</span>&#160;          res4 = _mm256_add_pd(_mm256_loadu_pd(out + 4 * i + offsets[4]), res4);</div><div class="line"><a name="l01334"></a><span class="lineno"> 1334</span>&#160;          _mm256_storeu_pd(out + 4 * i + offsets[4], res4);</div><div class="line"><a name="l01335"></a><span class="lineno"> 1335</span>&#160;          res5 = _mm256_add_pd(_mm256_loadu_pd(out + 4 * i + offsets[5]), res5);</div><div class="line"><a name="l01336"></a><span class="lineno"> 1336</span>&#160;          _mm256_storeu_pd(out + 4 * i + offsets[5], res5);</div><div class="line"><a name="l01337"></a><span class="lineno"> 1337</span>&#160;          res6 = _mm256_add_pd(_mm256_loadu_pd(out + 4 * i + offsets[6]), res6);</div><div class="line"><a name="l01338"></a><span class="lineno"> 1338</span>&#160;          _mm256_storeu_pd(out + 4 * i + offsets[6], res6);</div><div class="line"><a name="l01339"></a><span class="lineno"> 1339</span>&#160;          res7 = _mm256_add_pd(_mm256_loadu_pd(out + 4 * i + offsets[7]), res7);</div><div class="line"><a name="l01340"></a><span class="lineno"> 1340</span>&#160;          _mm256_storeu_pd(out + 4 * i + offsets[7], res7);</div><div class="line"><a name="l01341"></a><span class="lineno"> 1341</span>&#160;        }</div><div class="line"><a name="l01342"></a><span class="lineno"> 1342</span>&#160;      <span class="keywordflow">else</span></div><div class="line"><a name="l01343"></a><span class="lineno"> 1343</span>&#160;        {</div><div class="line"><a name="l01344"></a><span class="lineno"> 1344</span>&#160;          _mm256_storeu_pd(out + 4 * i + offsets[0], res0);</div><div class="line"><a name="l01345"></a><span class="lineno"> 1345</span>&#160;          _mm256_storeu_pd(out + 4 * i + offsets[1], res1);</div><div class="line"><a name="l01346"></a><span class="lineno"> 1346</span>&#160;          _mm256_storeu_pd(out + 4 * i + offsets[2], res2);</div><div class="line"><a name="l01347"></a><span class="lineno"> 1347</span>&#160;          _mm256_storeu_pd(out + 4 * i + offsets[3], res3);</div><div class="line"><a name="l01348"></a><span class="lineno"> 1348</span>&#160;          _mm256_storeu_pd(out + 4 * i + offsets[4], res4);</div><div class="line"><a name="l01349"></a><span class="lineno"> 1349</span>&#160;          _mm256_storeu_pd(out + 4 * i + offsets[5], res5);</div><div class="line"><a name="l01350"></a><span class="lineno"> 1350</span>&#160;          _mm256_storeu_pd(out + 4 * i + offsets[6], res6);</div><div class="line"><a name="l01351"></a><span class="lineno"> 1351</span>&#160;          _mm256_storeu_pd(out + 4 * i + offsets[7], res7);</div><div class="line"><a name="l01352"></a><span class="lineno"> 1352</span>&#160;        }</div><div class="line"><a name="l01353"></a><span class="lineno"> 1353</span>&#160;    }</div><div class="line"><a name="l01354"></a><span class="lineno"> 1354</span>&#160;</div><div class="line"><a name="l01355"></a><span class="lineno"> 1355</span>&#160;  <span class="comment">// remainder loop of work that does not divide by 4</span></div><div class="line"><a name="l01356"></a><span class="lineno"> 1356</span>&#160;  <span class="keywordflow">if</span> (add_into)</div><div class="line"><a name="l01357"></a><span class="lineno"> 1357</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i = 4 * n_chunks; i &lt; n_entries; ++i)</div><div class="line"><a name="l01358"></a><span class="lineno"> 1358</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> v = 0; v &lt; 8; ++v)</div><div class="line"><a name="l01359"></a><span class="lineno"> 1359</span>&#160;        out[offsets[v] + i] += in[i][v];</div><div class="line"><a name="l01360"></a><span class="lineno"> 1360</span>&#160;  <span class="keywordflow">else</span></div><div class="line"><a name="l01361"></a><span class="lineno"> 1361</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i = 4 * n_chunks; i &lt; n_entries; ++i)</div><div class="line"><a name="l01362"></a><span class="lineno"> 1362</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> v = 0; v &lt; 8; ++v)</div><div class="line"><a name="l01363"></a><span class="lineno"> 1363</span>&#160;        out[offsets[v] + i] = in[i][v];</div><div class="line"><a name="l01364"></a><span class="lineno"> 1364</span>&#160;}</div><div class="line"><a name="l01365"></a><span class="lineno"> 1365</span>&#160;</div><div class="line"><a name="l01366"></a><span class="lineno"> 1366</span>&#160;</div><div class="line"><a name="l01367"></a><span class="lineno"> 1367</span>&#160;</div><div class="line"><a name="l01373"></a><span class="lineno"> 1373</span>&#160;<span class="keyword">template</span> &lt;&gt;</div><div class="line"><a name="l01374"></a><span class="lineno"> 1374</span>&#160;<span class="keyword">inline</span> <a class="code" href="config_8h.html#a1d1d58e8be15e5c4285f6892e5f33136">DEAL_II_ALWAYS_INLINE</a> <span class="keywordtype">void</span></div><div class="line"><a name="l01375"></a><span class="lineno"> 1375</span>&#160;<a class="code" href="vectorization_8h.html#af396b43c783502e8acd2ca7d071a7325">vectorized_transpose_and_store</a>(<span class="keyword">const</span> <span class="keywordtype">bool</span>                        add_into,</div><div class="line"><a name="l01376"></a><span class="lineno"> 1376</span>&#160;                               <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span>                n_entries,</div><div class="line"><a name="l01377"></a><span class="lineno"> 1377</span>&#160;                               <span class="keyword">const</span> <a class="code" href="classVectorizedArray.html">VectorizedArray&lt;double, 8&gt;</a> *in,</div><div class="line"><a name="l01378"></a><span class="lineno"> 1378</span>&#160;                               std::array&lt;double *, 8&gt; &amp;         out)</div><div class="line"><a name="l01379"></a><span class="lineno"> 1379</span>&#160;{</div><div class="line"><a name="l01380"></a><span class="lineno"> 1380</span>&#160;  <span class="comment">// see the comments in the vectorized_transpose_and_store above</span></div><div class="line"><a name="l01381"></a><span class="lineno"> 1381</span>&#160;</div><div class="line"><a name="l01382"></a><span class="lineno"> 1382</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> n_chunks = n_entries / 4;</div><div class="line"><a name="l01383"></a><span class="lineno"> 1383</span>&#160;  __m512i mask1 = _mm512_set_epi64(0xd, 0xc, 0x5, 0x4, 0x9, 0x8, 0x1, 0x0);</div><div class="line"><a name="l01384"></a><span class="lineno"> 1384</span>&#160;  __m512i mask2 = _mm512_set_epi64(0xf, 0xe, 0x7, 0x6, 0xb, 0xa, 0x3, 0x2);</div><div class="line"><a name="l01385"></a><span class="lineno"> 1385</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i = 0; i &lt; n_chunks; ++i)</div><div class="line"><a name="l01386"></a><span class="lineno"> 1386</span>&#160;    {</div><div class="line"><a name="l01387"></a><span class="lineno"> 1387</span>&#160;      __m512d t0   = _mm512_unpacklo_pd(in[i * 4].data, in[i * 4 + 1].data);</div><div class="line"><a name="l01388"></a><span class="lineno"> 1388</span>&#160;      __m512d t1   = _mm512_unpackhi_pd(in[i * 4].data, in[i * 4 + 1].data);</div><div class="line"><a name="l01389"></a><span class="lineno"> 1389</span>&#160;      __m512d t2   = _mm512_unpacklo_pd(in[i * 4 + 2].data, in[i * 4 + 3].data);</div><div class="line"><a name="l01390"></a><span class="lineno"> 1390</span>&#160;      __m512d t3   = _mm512_unpackhi_pd(in[i * 4 + 2].data, in[i * 4 + 3].data);</div><div class="line"><a name="l01391"></a><span class="lineno"> 1391</span>&#160;      __m512d <a class="code" href="grid__tools_8cc.html#ad817a8f7e41831b2c2971f6eb7142f26">v0</a>   = _mm512_permutex2var_pd(t0, mask1, t2);</div><div class="line"><a name="l01392"></a><span class="lineno"> 1392</span>&#160;      __m512d <a class="code" href="grid__tools_8cc.html#adec67e1e77f5ae4fad3d65a5fb8036e9">v1</a>   = _mm512_permutex2var_pd(t0, mask2, t2);</div><div class="line"><a name="l01393"></a><span class="lineno"> 1393</span>&#160;      __m512d v2   = _mm512_permutex2var_pd(t1, mask1, t3);</div><div class="line"><a name="l01394"></a><span class="lineno"> 1394</span>&#160;      __m512d v3   = _mm512_permutex2var_pd(t1, mask2, t3);</div><div class="line"><a name="l01395"></a><span class="lineno"> 1395</span>&#160;      __m256d res0 = _mm512_extractf64x4_pd(v0, 0);</div><div class="line"><a name="l01396"></a><span class="lineno"> 1396</span>&#160;      __m256d res4 = _mm512_extractf64x4_pd(v0, 1);</div><div class="line"><a name="l01397"></a><span class="lineno"> 1397</span>&#160;      __m256d res1 = _mm512_extractf64x4_pd(v2, 0);</div><div class="line"><a name="l01398"></a><span class="lineno"> 1398</span>&#160;      __m256d res5 = _mm512_extractf64x4_pd(v2, 1);</div><div class="line"><a name="l01399"></a><span class="lineno"> 1399</span>&#160;      __m256d res2 = _mm512_extractf64x4_pd(v1, 0);</div><div class="line"><a name="l01400"></a><span class="lineno"> 1400</span>&#160;      __m256d res6 = _mm512_extractf64x4_pd(v1, 1);</div><div class="line"><a name="l01401"></a><span class="lineno"> 1401</span>&#160;      __m256d res3 = _mm512_extractf64x4_pd(v3, 0);</div><div class="line"><a name="l01402"></a><span class="lineno"> 1402</span>&#160;      __m256d res7 = _mm512_extractf64x4_pd(v3, 1);</div><div class="line"><a name="l01403"></a><span class="lineno"> 1403</span>&#160;</div><div class="line"><a name="l01404"></a><span class="lineno"> 1404</span>&#160;      <span class="keywordflow">if</span> (add_into)</div><div class="line"><a name="l01405"></a><span class="lineno"> 1405</span>&#160;        {</div><div class="line"><a name="l01406"></a><span class="lineno"> 1406</span>&#160;          res0 = _mm256_add_pd(_mm256_loadu_pd(out[0] + 4 * i), res0);</div><div class="line"><a name="l01407"></a><span class="lineno"> 1407</span>&#160;          _mm256_storeu_pd(out[0] + 4 * i, res0);</div><div class="line"><a name="l01408"></a><span class="lineno"> 1408</span>&#160;          res1 = _mm256_add_pd(_mm256_loadu_pd(out[1] + 4 * i), res1);</div><div class="line"><a name="l01409"></a><span class="lineno"> 1409</span>&#160;          _mm256_storeu_pd(out[1] + 4 * i, res1);</div><div class="line"><a name="l01410"></a><span class="lineno"> 1410</span>&#160;          res2 = _mm256_add_pd(_mm256_loadu_pd(out[2] + 4 * i), res2);</div><div class="line"><a name="l01411"></a><span class="lineno"> 1411</span>&#160;          _mm256_storeu_pd(out[2] + 4 * i, res2);</div><div class="line"><a name="l01412"></a><span class="lineno"> 1412</span>&#160;          res3 = _mm256_add_pd(_mm256_loadu_pd(out[3] + 4 * i), res3);</div><div class="line"><a name="l01413"></a><span class="lineno"> 1413</span>&#160;          _mm256_storeu_pd(out[3] + 4 * i, res3);</div><div class="line"><a name="l01414"></a><span class="lineno"> 1414</span>&#160;          res4 = _mm256_add_pd(_mm256_loadu_pd(out[4] + 4 * i), res4);</div><div class="line"><a name="l01415"></a><span class="lineno"> 1415</span>&#160;          _mm256_storeu_pd(out[4] + 4 * i, res4);</div><div class="line"><a name="l01416"></a><span class="lineno"> 1416</span>&#160;          res5 = _mm256_add_pd(_mm256_loadu_pd(out[5] + 4 * i), res5);</div><div class="line"><a name="l01417"></a><span class="lineno"> 1417</span>&#160;          _mm256_storeu_pd(out[5] + 4 * i, res5);</div><div class="line"><a name="l01418"></a><span class="lineno"> 1418</span>&#160;          res6 = _mm256_add_pd(_mm256_loadu_pd(out[6] + 4 * i), res6);</div><div class="line"><a name="l01419"></a><span class="lineno"> 1419</span>&#160;          _mm256_storeu_pd(out[6] + 4 * i, res6);</div><div class="line"><a name="l01420"></a><span class="lineno"> 1420</span>&#160;          res7 = _mm256_add_pd(_mm256_loadu_pd(out[7] + 4 * i), res7);</div><div class="line"><a name="l01421"></a><span class="lineno"> 1421</span>&#160;          _mm256_storeu_pd(out[7] + 4 * i, res7);</div><div class="line"><a name="l01422"></a><span class="lineno"> 1422</span>&#160;        }</div><div class="line"><a name="l01423"></a><span class="lineno"> 1423</span>&#160;      <span class="keywordflow">else</span></div><div class="line"><a name="l01424"></a><span class="lineno"> 1424</span>&#160;        {</div><div class="line"><a name="l01425"></a><span class="lineno"> 1425</span>&#160;          _mm256_storeu_pd(out[0] + 4 * i, res0);</div><div class="line"><a name="l01426"></a><span class="lineno"> 1426</span>&#160;          _mm256_storeu_pd(out[1] + 4 * i, res1);</div><div class="line"><a name="l01427"></a><span class="lineno"> 1427</span>&#160;          _mm256_storeu_pd(out[2] + 4 * i, res2);</div><div class="line"><a name="l01428"></a><span class="lineno"> 1428</span>&#160;          _mm256_storeu_pd(out[3] + 4 * i, res3);</div><div class="line"><a name="l01429"></a><span class="lineno"> 1429</span>&#160;          _mm256_storeu_pd(out[4] + 4 * i, res4);</div><div class="line"><a name="l01430"></a><span class="lineno"> 1430</span>&#160;          _mm256_storeu_pd(out[5] + 4 * i, res5);</div><div class="line"><a name="l01431"></a><span class="lineno"> 1431</span>&#160;          _mm256_storeu_pd(out[6] + 4 * i, res6);</div><div class="line"><a name="l01432"></a><span class="lineno"> 1432</span>&#160;          _mm256_storeu_pd(out[7] + 4 * i, res7);</div><div class="line"><a name="l01433"></a><span class="lineno"> 1433</span>&#160;        }</div><div class="line"><a name="l01434"></a><span class="lineno"> 1434</span>&#160;    }</div><div class="line"><a name="l01435"></a><span class="lineno"> 1435</span>&#160;</div><div class="line"><a name="l01436"></a><span class="lineno"> 1436</span>&#160;  <span class="keywordflow">if</span> (add_into)</div><div class="line"><a name="l01437"></a><span class="lineno"> 1437</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i = 4 * n_chunks; i &lt; n_entries; ++i)</div><div class="line"><a name="l01438"></a><span class="lineno"> 1438</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> v = 0; v &lt; 8; ++v)</div><div class="line"><a name="l01439"></a><span class="lineno"> 1439</span>&#160;        out[v][i] += in[i][v];</div><div class="line"><a name="l01440"></a><span class="lineno"> 1440</span>&#160;  <span class="keywordflow">else</span></div><div class="line"><a name="l01441"></a><span class="lineno"> 1441</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i = 4 * n_chunks; i &lt; n_entries; ++i)</div><div class="line"><a name="l01442"></a><span class="lineno"> 1442</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> v = 0; v &lt; 8; ++v)</div><div class="line"><a name="l01443"></a><span class="lineno"> 1443</span>&#160;        out[v][i] = in[i][v];</div><div class="line"><a name="l01444"></a><span class="lineno"> 1444</span>&#160;}</div><div class="line"><a name="l01445"></a><span class="lineno"> 1445</span>&#160;</div><div class="line"><a name="l01446"></a><span class="lineno"> 1446</span>&#160;</div><div class="line"><a name="l01447"></a><span class="lineno"> 1447</span>&#160;</div><div class="line"><a name="l01453"></a><span class="lineno"> 1453</span>&#160;<span class="keyword">template</span> &lt;&gt;</div><div class="line"><a name="l01454"></a><span class="lineno"> 1454</span>&#160;<span class="keyword">class </span><a class="code" href="classVectorizedArray.html">VectorizedArray</a>&lt;float, 16&gt;</div><div class="line"><a name="l01455"></a><span class="lineno"> 1455</span>&#160;  : <span class="keyword">public</span> <a class="code" href="classVectorizedArrayBase.html">VectorizedArrayBase</a>&lt;VectorizedArray&lt;float, 16&gt;, 16&gt;</div><div class="line"><a name="l01456"></a><span class="lineno"> 1456</span>&#160;{</div><div class="line"><a name="l01457"></a><span class="lineno"> 1457</span>&#160;<span class="keyword">public</span>:</div><div class="line"><a name="l01462"></a><span class="lineno"> 1462</span>&#160;  <span class="keyword">using</span> value_type = float;</div><div class="line"><a name="l01463"></a><span class="lineno"> 1463</span>&#160;</div><div class="line"><a name="l01468"></a><span class="lineno"> 1468</span>&#160;  <a class="code" href="classVectorizedArray.html">VectorizedArray</a>() = <span class="keywordflow">default</span>;</div><div class="line"><a name="l01469"></a><span class="lineno"> 1469</span>&#160;</div><div class="line"><a name="l01474"></a><span class="lineno"> 1474</span>&#160;  <a class="code" href="classVectorizedArray.html">VectorizedArray</a>(<span class="keyword">const</span> <span class="keywordtype">float</span> scalar)</div><div class="line"><a name="l01475"></a><span class="lineno"> 1475</span>&#160;  {</div><div class="line"><a name="l01476"></a><span class="lineno"> 1476</span>&#160;    this-&gt;operator=(scalar);</div><div class="line"><a name="l01477"></a><span class="lineno"> 1477</span>&#160;  }</div><div class="line"><a name="l01478"></a><span class="lineno"> 1478</span>&#160;</div><div class="line"><a name="l01483"></a><span class="lineno"> 1483</span>&#160;  <a class="code" href="config_8h.html#a1d1d58e8be15e5c4285f6892e5f33136">DEAL_II_ALWAYS_INLINE</a></div><div class="line"><a name="l01484"></a><span class="lineno"> 1484</span>&#160;  <a class="code" href="classVectorizedArray.html">VectorizedArray</a> &amp;</div><div class="line"><a name="l01485"></a><span class="lineno"> 1485</span>&#160;  operator=(<span class="keyword">const</span> <span class="keywordtype">float</span> x)</div><div class="line"><a name="l01486"></a><span class="lineno"> 1486</span>&#160;  {</div><div class="line"><a name="l01487"></a><span class="lineno"> 1487</span>&#160;    data = _mm512_set1_ps(x);</div><div class="line"><a name="l01488"></a><span class="lineno"> 1488</span>&#160;    <span class="keywordflow">return</span> *<span class="keyword">this</span>;</div><div class="line"><a name="l01489"></a><span class="lineno"> 1489</span>&#160;  }</div><div class="line"><a name="l01490"></a><span class="lineno"> 1490</span>&#160;</div><div class="line"><a name="l01495"></a><span class="lineno"> 1495</span>&#160;  <a class="code" href="config_8h.html#a1d1d58e8be15e5c4285f6892e5f33136">DEAL_II_ALWAYS_INLINE</a></div><div class="line"><a name="l01496"></a><span class="lineno"> 1496</span>&#160;  <span class="keywordtype">float</span> &amp;operator[](<span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> comp)</div><div class="line"><a name="l01497"></a><span class="lineno"> 1497</span>&#160;  {</div><div class="line"><a name="l01498"></a><span class="lineno"> 1498</span>&#160;    <a class="code" href="group__Exceptions.html#gaafbb69cc2a791ae55880fd8d57d0c1b0">AssertIndexRange</a>(comp, 16);</div><div class="line"><a name="l01499"></a><span class="lineno"> 1499</span>&#160;    <span class="keywordflow">return</span> *(<span class="keyword">reinterpret_cast&lt;</span><span class="keywordtype">float</span> *<span class="keyword">&gt;</span>(&amp;data) + comp);</div><div class="line"><a name="l01500"></a><span class="lineno"> 1500</span>&#160;  }</div><div class="line"><a name="l01501"></a><span class="lineno"> 1501</span>&#160;</div><div class="line"><a name="l01506"></a><span class="lineno"> 1506</span>&#160;  <a class="code" href="config_8h.html#a1d1d58e8be15e5c4285f6892e5f33136">DEAL_II_ALWAYS_INLINE</a></div><div class="line"><a name="l01507"></a><span class="lineno"> 1507</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">float</span> &amp;operator[](<span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> comp)<span class="keyword"> const</span></div><div class="line"><a name="l01508"></a><span class="lineno"> 1508</span>&#160;<span class="keyword">  </span>{</div><div class="line"><a name="l01509"></a><span class="lineno"> 1509</span>&#160;    <a class="code" href="group__Exceptions.html#gaafbb69cc2a791ae55880fd8d57d0c1b0">AssertIndexRange</a>(comp, 16);</div><div class="line"><a name="l01510"></a><span class="lineno"> 1510</span>&#160;    <span class="keywordflow">return</span> *(<span class="keyword">reinterpret_cast&lt;</span><span class="keyword">const </span><span class="keywordtype">float</span> *<span class="keyword">&gt;</span>(&amp;data) + comp);</div><div class="line"><a name="l01511"></a><span class="lineno"> 1511</span>&#160;  }</div><div class="line"><a name="l01512"></a><span class="lineno"> 1512</span>&#160;</div><div class="line"><a name="l01517"></a><span class="lineno"> 1517</span>&#160;  <a class="code" href="config_8h.html#a1d1d58e8be15e5c4285f6892e5f33136">DEAL_II_ALWAYS_INLINE</a></div><div class="line"><a name="l01518"></a><span class="lineno"> 1518</span>&#160;  <a class="code" href="classVectorizedArray.html">VectorizedArray</a> &amp;</div><div class="line"><a name="l01519"></a><span class="lineno"> 1519</span>&#160;  operator+=(<span class="keyword">const</span> <a class="code" href="classVectorizedArray.html">VectorizedArray</a> &amp;vec)</div><div class="line"><a name="l01520"></a><span class="lineno"> 1520</span>&#160;  {</div><div class="line"><a name="l01521"></a><span class="lineno"> 1521</span>&#160;    <span class="comment">// if the compiler supports vector arithmetic, we can simply use +=</span></div><div class="line"><a name="l01522"></a><span class="lineno"> 1522</span>&#160;    <span class="comment">// operator on the given data type. this allows the compiler to combine</span></div><div class="line"><a name="l01523"></a><span class="lineno"> 1523</span>&#160;    <span class="comment">// additions with multiplication (fused multiply-add) if those</span></div><div class="line"><a name="l01524"></a><span class="lineno"> 1524</span>&#160;    <span class="comment">// instructions are available. Otherwise, we need to use the built-in</span></div><div class="line"><a name="l01525"></a><span class="lineno"> 1525</span>&#160;    <span class="comment">// intrinsic command for __m512d</span></div><div class="line"><a name="l01526"></a><span class="lineno"> 1526</span>&#160;<span class="preprocessor">#    ifdef DEAL_II_COMPILER_USE_VECTOR_ARITHMETICS</span></div><div class="line"><a name="l01527"></a><span class="lineno"> 1527</span>&#160;    data += vec.<a class="code" href="classVectorizedArray.html#ad38190d02537705964e021da7ecbab3f">data</a>;</div><div class="line"><a name="l01528"></a><span class="lineno"> 1528</span>&#160;<span class="preprocessor">#    else</span></div><div class="line"><a name="l01529"></a><span class="lineno"> 1529</span>&#160;    data = _mm512_add_ps(data, vec.<a class="code" href="classVectorizedArray.html#ad38190d02537705964e021da7ecbab3f">data</a>);</div><div class="line"><a name="l01530"></a><span class="lineno"> 1530</span>&#160;<span class="preprocessor">#    endif</span></div><div class="line"><a name="l01531"></a><span class="lineno"> 1531</span>&#160;    <span class="keywordflow">return</span> *<span class="keyword">this</span>;</div><div class="line"><a name="l01532"></a><span class="lineno"> 1532</span>&#160;  }</div><div class="line"><a name="l01533"></a><span class="lineno"> 1533</span>&#160;</div><div class="line"><a name="l01538"></a><span class="lineno"> 1538</span>&#160;  <a class="code" href="config_8h.html#a1d1d58e8be15e5c4285f6892e5f33136">DEAL_II_ALWAYS_INLINE</a></div><div class="line"><a name="l01539"></a><span class="lineno"> 1539</span>&#160;  <a class="code" href="classVectorizedArray.html">VectorizedArray</a> &amp;</div><div class="line"><a name="l01540"></a><span class="lineno"> 1540</span>&#160;  operator-=(<span class="keyword">const</span> <a class="code" href="classVectorizedArray.html">VectorizedArray</a> &amp;vec)</div><div class="line"><a name="l01541"></a><span class="lineno"> 1541</span>&#160;  {</div><div class="line"><a name="l01542"></a><span class="lineno"> 1542</span>&#160;<span class="preprocessor">#    ifdef DEAL_II_COMPILER_USE_VECTOR_ARITHMETICS</span></div><div class="line"><a name="l01543"></a><span class="lineno"> 1543</span>&#160;    data -= vec.<a class="code" href="classVectorizedArray.html#ad38190d02537705964e021da7ecbab3f">data</a>;</div><div class="line"><a name="l01544"></a><span class="lineno"> 1544</span>&#160;<span class="preprocessor">#    else</span></div><div class="line"><a name="l01545"></a><span class="lineno"> 1545</span>&#160;    data = _mm512_sub_ps(data, vec.<a class="code" href="classVectorizedArray.html#ad38190d02537705964e021da7ecbab3f">data</a>);</div><div class="line"><a name="l01546"></a><span class="lineno"> 1546</span>&#160;<span class="preprocessor">#    endif</span></div><div class="line"><a name="l01547"></a><span class="lineno"> 1547</span>&#160;    <span class="keywordflow">return</span> *<span class="keyword">this</span>;</div><div class="line"><a name="l01548"></a><span class="lineno"> 1548</span>&#160;  }</div><div class="line"><a name="l01553"></a><span class="lineno"> 1553</span>&#160;  <a class="code" href="config_8h.html#a1d1d58e8be15e5c4285f6892e5f33136">DEAL_II_ALWAYS_INLINE</a></div><div class="line"><a name="l01554"></a><span class="lineno"> 1554</span>&#160;  <a class="code" href="classVectorizedArray.html">VectorizedArray</a> &amp;</div><div class="line"><a name="l01555"></a><span class="lineno"> 1555</span>&#160;  operator*=(<span class="keyword">const</span> <a class="code" href="classVectorizedArray.html">VectorizedArray</a> &amp;vec)</div><div class="line"><a name="l01556"></a><span class="lineno"> 1556</span>&#160;  {</div><div class="line"><a name="l01557"></a><span class="lineno"> 1557</span>&#160;<span class="preprocessor">#    ifdef DEAL_II_COMPILER_USE_VECTOR_ARITHMETICS</span></div><div class="line"><a name="l01558"></a><span class="lineno"> 1558</span>&#160;    data *= vec.<a class="code" href="classVectorizedArray.html#ad38190d02537705964e021da7ecbab3f">data</a>;</div><div class="line"><a name="l01559"></a><span class="lineno"> 1559</span>&#160;<span class="preprocessor">#    else</span></div><div class="line"><a name="l01560"></a><span class="lineno"> 1560</span>&#160;    data = _mm512_mul_ps(data, vec.<a class="code" href="classVectorizedArray.html#ad38190d02537705964e021da7ecbab3f">data</a>);</div><div class="line"><a name="l01561"></a><span class="lineno"> 1561</span>&#160;<span class="preprocessor">#    endif</span></div><div class="line"><a name="l01562"></a><span class="lineno"> 1562</span>&#160;    <span class="keywordflow">return</span> *<span class="keyword">this</span>;</div><div class="line"><a name="l01563"></a><span class="lineno"> 1563</span>&#160;  }</div><div class="line"><a name="l01564"></a><span class="lineno"> 1564</span>&#160;</div><div class="line"><a name="l01569"></a><span class="lineno"> 1569</span>&#160;  <a class="code" href="config_8h.html#a1d1d58e8be15e5c4285f6892e5f33136">DEAL_II_ALWAYS_INLINE</a></div><div class="line"><a name="l01570"></a><span class="lineno"> 1570</span>&#160;  <a class="code" href="classVectorizedArray.html">VectorizedArray</a> &amp;</div><div class="line"><a name="l01571"></a><span class="lineno"> 1571</span>&#160;  operator/=(<span class="keyword">const</span> <a class="code" href="classVectorizedArray.html">VectorizedArray</a> &amp;vec)</div><div class="line"><a name="l01572"></a><span class="lineno"> 1572</span>&#160;  {</div><div class="line"><a name="l01573"></a><span class="lineno"> 1573</span>&#160;<span class="preprocessor">#    ifdef DEAL_II_COMPILER_USE_VECTOR_ARITHMETICS</span></div><div class="line"><a name="l01574"></a><span class="lineno"> 1574</span>&#160;    data /= vec.<a class="code" href="classVectorizedArray.html#ad38190d02537705964e021da7ecbab3f">data</a>;</div><div class="line"><a name="l01575"></a><span class="lineno"> 1575</span>&#160;<span class="preprocessor">#    else</span></div><div class="line"><a name="l01576"></a><span class="lineno"> 1576</span>&#160;    data = _mm512_div_ps(data, vec.<a class="code" href="classVectorizedArray.html#ad38190d02537705964e021da7ecbab3f">data</a>);</div><div class="line"><a name="l01577"></a><span class="lineno"> 1577</span>&#160;<span class="preprocessor">#    endif</span></div><div class="line"><a name="l01578"></a><span class="lineno"> 1578</span>&#160;    <span class="keywordflow">return</span> *<span class="keyword">this</span>;</div><div class="line"><a name="l01579"></a><span class="lineno"> 1579</span>&#160;  }</div><div class="line"><a name="l01580"></a><span class="lineno"> 1580</span>&#160;</div><div class="line"><a name="l01586"></a><span class="lineno"> 1586</span>&#160;  <a class="code" href="config_8h.html#a1d1d58e8be15e5c4285f6892e5f33136">DEAL_II_ALWAYS_INLINE</a></div><div class="line"><a name="l01587"></a><span class="lineno"> 1587</span>&#160;  <span class="keywordtype">void</span></div><div class="line"><a name="l01588"></a><span class="lineno"> 1588</span>&#160;  load(<span class="keyword">const</span> <span class="keywordtype">float</span> *ptr)</div><div class="line"><a name="l01589"></a><span class="lineno"> 1589</span>&#160;  {</div><div class="line"><a name="l01590"></a><span class="lineno"> 1590</span>&#160;    data = _mm512_loadu_ps(ptr);</div><div class="line"><a name="l01591"></a><span class="lineno"> 1591</span>&#160;  }</div><div class="line"><a name="l01592"></a><span class="lineno"> 1592</span>&#160;</div><div class="line"><a name="l01598"></a><span class="lineno"> 1598</span>&#160;  <a class="code" href="config_8h.html#a1d1d58e8be15e5c4285f6892e5f33136">DEAL_II_ALWAYS_INLINE</a></div><div class="line"><a name="l01599"></a><span class="lineno"> 1599</span>&#160;  <span class="keywordtype">void</span></div><div class="line"><a name="l01600"></a><span class="lineno"> 1600</span>&#160;  store(<span class="keywordtype">float</span> *ptr)<span class="keyword"> const</span></div><div class="line"><a name="l01601"></a><span class="lineno"> 1601</span>&#160;<span class="keyword">  </span>{</div><div class="line"><a name="l01602"></a><span class="lineno"> 1602</span>&#160;    _mm512_storeu_ps(ptr, data);</div><div class="line"><a name="l01603"></a><span class="lineno"> 1603</span>&#160;  }</div><div class="line"><a name="l01604"></a><span class="lineno"> 1604</span>&#160;</div><div class="line"><a name="l01610"></a><span class="lineno"> 1610</span>&#160;  <a class="code" href="config_8h.html#a1d1d58e8be15e5c4285f6892e5f33136">DEAL_II_ALWAYS_INLINE</a></div><div class="line"><a name="l01611"></a><span class="lineno"> 1611</span>&#160;  <span class="keywordtype">void</span></div><div class="line"><a name="l01612"></a><span class="lineno"> 1612</span>&#160;  streaming_store(<span class="keywordtype">float</span> *ptr)<span class="keyword"> const</span></div><div class="line"><a name="l01613"></a><span class="lineno"> 1613</span>&#160;<span class="keyword">  </span>{</div><div class="line"><a name="l01614"></a><span class="lineno"> 1614</span>&#160;    <a class="code" href="group__Exceptions.html#ga70a0bb353656e704acf927945277bbc6">Assert</a>(reinterpret_cast&lt;std::size_t&gt;(ptr) % 64 == 0,</div><div class="line"><a name="l01615"></a><span class="lineno"> 1615</span>&#160;           <a class="code" href="group__Exceptions.html#gae9a45f517af1401c50811a11083f9114">ExcMessage</a>(<span class="stringliteral">&quot;Memory not aligned&quot;</span>));</div><div class="line"><a name="l01616"></a><span class="lineno"> 1616</span>&#160;    _mm512_stream_ps(ptr, data);</div><div class="line"><a name="l01617"></a><span class="lineno"> 1617</span>&#160;  }</div><div class="line"><a name="l01618"></a><span class="lineno"> 1618</span>&#160;</div><div class="line"><a name="l01630"></a><span class="lineno"> 1630</span>&#160;  <a class="code" href="config_8h.html#a1d1d58e8be15e5c4285f6892e5f33136">DEAL_II_ALWAYS_INLINE</a></div><div class="line"><a name="l01631"></a><span class="lineno"> 1631</span>&#160;  <span class="keywordtype">void</span></div><div class="line"><a name="l01632"></a><span class="lineno"> 1632</span>&#160;  <a class="code" href="vectorization_8h.html#a078ca5de8d3a59aedc130823be15ad26">gather</a>(<span class="keyword">const</span> <span class="keywordtype">float</span> *base_ptr, <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> *offsets)</div><div class="line"><a name="l01633"></a><span class="lineno"> 1633</span>&#160;  {</div><div class="line"><a name="l01634"></a><span class="lineno"> 1634</span>&#160;    <span class="comment">// unfortunately, there does not appear to be a 512 bit integer load, so</span></div><div class="line"><a name="l01635"></a><span class="lineno"> 1635</span>&#160;    <span class="comment">// do it by some reinterpret casts here. this is allowed because the Intel</span></div><div class="line"><a name="l01636"></a><span class="lineno"> 1636</span>&#160;    <span class="comment">// API allows aliasing between different vector types.</span></div><div class="line"><a name="l01637"></a><span class="lineno"> 1637</span>&#160;    <span class="keyword">const</span> __m512 index_val =</div><div class="line"><a name="l01638"></a><span class="lineno"> 1638</span>&#160;      _mm512_loadu_ps(reinterpret_cast&lt;const float *&gt;(offsets));</div><div class="line"><a name="l01639"></a><span class="lineno"> 1639</span>&#160;    <span class="keyword">const</span> __m512i index = *<span class="keyword">reinterpret_cast&lt;</span><span class="keyword">const </span>__m512i *<span class="keyword">&gt;</span>(&amp;index_val);</div><div class="line"><a name="l01640"></a><span class="lineno"> 1640</span>&#160;    data                = _mm512_i32gather_ps(index, base_ptr, 4);</div><div class="line"><a name="l01641"></a><span class="lineno"> 1641</span>&#160;  }</div><div class="line"><a name="l01642"></a><span class="lineno"> 1642</span>&#160;</div><div class="line"><a name="l01654"></a><span class="lineno"> 1654</span>&#160;  <a class="code" href="config_8h.html#a1d1d58e8be15e5c4285f6892e5f33136">DEAL_II_ALWAYS_INLINE</a></div><div class="line"><a name="l01655"></a><span class="lineno"> 1655</span>&#160;  <span class="keywordtype">void</span></div><div class="line"><a name="l01656"></a><span class="lineno"> 1656</span>&#160;  scatter(<span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> *offsets, <span class="keywordtype">float</span> *base_ptr)<span class="keyword"> const</span></div><div class="line"><a name="l01657"></a><span class="lineno"> 1657</span>&#160;<span class="keyword">  </span>{</div><div class="line"><a name="l01658"></a><span class="lineno"> 1658</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i = 0; i &lt; 16; ++i)</div><div class="line"><a name="l01659"></a><span class="lineno"> 1659</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> j = i + 1; j &lt; 16; ++j)</div><div class="line"><a name="l01660"></a><span class="lineno"> 1660</span>&#160;        <a class="code" href="group__Exceptions.html#ga70a0bb353656e704acf927945277bbc6">Assert</a>(offsets[i] != offsets[j],</div><div class="line"><a name="l01661"></a><span class="lineno"> 1661</span>&#160;               <a class="code" href="group__Exceptions.html#gae9a45f517af1401c50811a11083f9114">ExcMessage</a>(<span class="stringliteral">&quot;Result of scatter undefined if two offset elements&quot;</span></div><div class="line"><a name="l01662"></a><span class="lineno"> 1662</span>&#160;                          <span class="stringliteral">&quot; point to the same position&quot;</span>));</div><div class="line"><a name="l01663"></a><span class="lineno"> 1663</span>&#160;</div><div class="line"><a name="l01664"></a><span class="lineno"> 1664</span>&#160;    <span class="comment">// unfortunately, there does not appear to be a 512 bit integer load, so</span></div><div class="line"><a name="l01665"></a><span class="lineno"> 1665</span>&#160;    <span class="comment">// do it by some reinterpret casts here. this is allowed because the Intel</span></div><div class="line"><a name="l01666"></a><span class="lineno"> 1666</span>&#160;    <span class="comment">// API allows aliasing between different vector types.</span></div><div class="line"><a name="l01667"></a><span class="lineno"> 1667</span>&#160;    <span class="keyword">const</span> __m512 index_val =</div><div class="line"><a name="l01668"></a><span class="lineno"> 1668</span>&#160;      _mm512_loadu_ps(reinterpret_cast&lt;const float *&gt;(offsets));</div><div class="line"><a name="l01669"></a><span class="lineno"> 1669</span>&#160;    <span class="keyword">const</span> __m512i index = *<span class="keyword">reinterpret_cast&lt;</span><span class="keyword">const </span>__m512i *<span class="keyword">&gt;</span>(&amp;index_val);</div><div class="line"><a name="l01670"></a><span class="lineno"> 1670</span>&#160;    _mm512_i32scatter_ps(base_ptr, index, data, 4);</div><div class="line"><a name="l01671"></a><span class="lineno"> 1671</span>&#160;  }</div><div class="line"><a name="l01672"></a><span class="lineno"> 1672</span>&#160;</div><div class="line"><a name="l01677"></a><span class="lineno"> 1677</span>&#160;  __m512 data;</div><div class="line"><a name="l01678"></a><span class="lineno"> 1678</span>&#160;</div><div class="line"><a name="l01679"></a><span class="lineno"> 1679</span>&#160;<span class="keyword">private</span>:</div><div class="line"><a name="l01684"></a><span class="lineno"> 1684</span>&#160;  <a class="code" href="config_8h.html#a1d1d58e8be15e5c4285f6892e5f33136">DEAL_II_ALWAYS_INLINE</a></div><div class="line"><a name="l01685"></a><span class="lineno"> 1685</span>&#160;  <a class="code" href="classVectorizedArray.html">VectorizedArray</a></div><div class="line"><a name="l01686"></a><span class="lineno"> 1686</span>&#160;  get_sqrt()<span class="keyword"> const</span></div><div class="line"><a name="l01687"></a><span class="lineno"> 1687</span>&#160;<span class="keyword">  </span>{</div><div class="line"><a name="l01688"></a><span class="lineno"> 1688</span>&#160;    <a class="code" href="classVectorizedArray.html">VectorizedArray</a> res;</div><div class="line"><a name="l01689"></a><span class="lineno"> 1689</span>&#160;    res.<a class="code" href="classVectorizedArray.html#ad38190d02537705964e021da7ecbab3f">data</a> = _mm512_sqrt_ps(data);</div><div class="line"><a name="l01690"></a><span class="lineno"> 1690</span>&#160;    <span class="keywordflow">return</span> res;</div><div class="line"><a name="l01691"></a><span class="lineno"> 1691</span>&#160;  }</div><div class="line"><a name="l01692"></a><span class="lineno"> 1692</span>&#160;</div><div class="line"><a name="l01697"></a><span class="lineno"> 1697</span>&#160;  <a class="code" href="config_8h.html#a1d1d58e8be15e5c4285f6892e5f33136">DEAL_II_ALWAYS_INLINE</a></div><div class="line"><a name="l01698"></a><span class="lineno"> 1698</span>&#160;  <a class="code" href="classVectorizedArray.html">VectorizedArray</a></div><div class="line"><a name="l01699"></a><span class="lineno"> 1699</span>&#160;  get_abs()<span class="keyword"> const</span></div><div class="line"><a name="l01700"></a><span class="lineno"> 1700</span>&#160;<span class="keyword">  </span>{</div><div class="line"><a name="l01701"></a><span class="lineno"> 1701</span>&#160;    <span class="comment">// to compute the absolute value, perform bitwise andnot with -0. This</span></div><div class="line"><a name="l01702"></a><span class="lineno"> 1702</span>&#160;    <span class="comment">// will leave all value and exponent bits unchanged but force the sign</span></div><div class="line"><a name="l01703"></a><span class="lineno"> 1703</span>&#160;    <span class="comment">// value to +. Since there is no andnot for AVX512, we interpret the data</span></div><div class="line"><a name="l01704"></a><span class="lineno"> 1704</span>&#160;    <span class="comment">// as 32 bit integers and do the andnot on those types (note that andnot</span></div><div class="line"><a name="l01705"></a><span class="lineno"> 1705</span>&#160;    <span class="comment">// is a bitwise operation so the data type does not matter)</span></div><div class="line"><a name="l01706"></a><span class="lineno"> 1706</span>&#160;    __m512          mask = _mm512_set1_ps(-0.f);</div><div class="line"><a name="l01707"></a><span class="lineno"> 1707</span>&#160;    <a class="code" href="classVectorizedArray.html">VectorizedArray</a> res;</div><div class="line"><a name="l01708"></a><span class="lineno"> 1708</span>&#160;    res.<a class="code" href="classVectorizedArray.html#ad38190d02537705964e021da7ecbab3f">data</a> = <span class="keyword">reinterpret_cast&lt;</span>__m512<span class="keyword">&gt;</span>(</div><div class="line"><a name="l01709"></a><span class="lineno"> 1709</span>&#160;      _mm512_andnot_epi32(reinterpret_cast&lt;__m512i&gt;(mask),</div><div class="line"><a name="l01710"></a><span class="lineno"> 1710</span>&#160;                          reinterpret_cast&lt;__m512i&gt;(data)));</div><div class="line"><a name="l01711"></a><span class="lineno"> 1711</span>&#160;    <span class="keywordflow">return</span> res;</div><div class="line"><a name="l01712"></a><span class="lineno"> 1712</span>&#160;  }</div><div class="line"><a name="l01713"></a><span class="lineno"> 1713</span>&#160;</div><div class="line"><a name="l01718"></a><span class="lineno"> 1718</span>&#160;  <a class="code" href="config_8h.html#a1d1d58e8be15e5c4285f6892e5f33136">DEAL_II_ALWAYS_INLINE</a></div><div class="line"><a name="l01719"></a><span class="lineno"> 1719</span>&#160;  <a class="code" href="classVectorizedArray.html">VectorizedArray</a></div><div class="line"><a name="l01720"></a><span class="lineno"> 1720</span>&#160;  get_max(<span class="keyword">const</span> <a class="code" href="classVectorizedArray.html">VectorizedArray</a> &amp;other)<span class="keyword"> const</span></div><div class="line"><a name="l01721"></a><span class="lineno"> 1721</span>&#160;<span class="keyword">  </span>{</div><div class="line"><a name="l01722"></a><span class="lineno"> 1722</span>&#160;    <a class="code" href="classVectorizedArray.html">VectorizedArray</a> res;</div><div class="line"><a name="l01723"></a><span class="lineno"> 1723</span>&#160;    res.<a class="code" href="classVectorizedArray.html#ad38190d02537705964e021da7ecbab3f">data</a> = _mm512_max_ps(data, other.<a class="code" href="classVectorizedArray.html#ad38190d02537705964e021da7ecbab3f">data</a>);</div><div class="line"><a name="l01724"></a><span class="lineno"> 1724</span>&#160;    <span class="keywordflow">return</span> res;</div><div class="line"><a name="l01725"></a><span class="lineno"> 1725</span>&#160;  }</div><div class="line"><a name="l01726"></a><span class="lineno"> 1726</span>&#160;</div><div class="line"><a name="l01731"></a><span class="lineno"> 1731</span>&#160;  <a class="code" href="config_8h.html#a1d1d58e8be15e5c4285f6892e5f33136">DEAL_II_ALWAYS_INLINE</a></div><div class="line"><a name="l01732"></a><span class="lineno"> 1732</span>&#160;  <a class="code" href="classVectorizedArray.html">VectorizedArray</a></div><div class="line"><a name="l01733"></a><span class="lineno"> 1733</span>&#160;  get_min(<span class="keyword">const</span> <a class="code" href="classVectorizedArray.html">VectorizedArray</a> &amp;other)<span class="keyword"> const</span></div><div class="line"><a name="l01734"></a><span class="lineno"> 1734</span>&#160;<span class="keyword">  </span>{</div><div class="line"><a name="l01735"></a><span class="lineno"> 1735</span>&#160;    <a class="code" href="classVectorizedArray.html">VectorizedArray</a> res;</div><div class="line"><a name="l01736"></a><span class="lineno"> 1736</span>&#160;    res.<a class="code" href="classVectorizedArray.html#ad38190d02537705964e021da7ecbab3f">data</a> = _mm512_min_ps(data, other.<a class="code" href="classVectorizedArray.html#ad38190d02537705964e021da7ecbab3f">data</a>);</div><div class="line"><a name="l01737"></a><span class="lineno"> 1737</span>&#160;    <span class="keywordflow">return</span> res;</div><div class="line"><a name="l01738"></a><span class="lineno"> 1738</span>&#160;  }</div><div class="line"><a name="l01739"></a><span class="lineno"> 1739</span>&#160;</div><div class="line"><a name="l01740"></a><span class="lineno"> 1740</span>&#160;  <span class="comment">// Make a few functions friends.</span></div><div class="line"><a name="l01741"></a><span class="lineno"> 1741</span>&#160;  <span class="keyword">template</span> &lt;<span class="keyword">typename</span> Number2, std::<span class="keywordtype">size_t</span> w<span class="keywordtype">id</span>th2&gt;</div><div class="line"><a name="l01742"></a><span class="lineno"> 1742</span>&#160;  <span class="keyword">friend</span> <a class="code" href="classVectorizedArray.html">VectorizedArray&lt;Number2, width2&gt;</a></div><div class="line"><a name="l01743"></a><span class="lineno"> 1743</span>&#160;  std::sqrt(<span class="keyword">const</span> <a class="code" href="classVectorizedArray.html">VectorizedArray&lt;Number2, width2&gt;</a> &amp;);</div><div class="line"><a name="l01744"></a><span class="lineno"> 1744</span>&#160;  <span class="keyword">template</span> &lt;<span class="keyword">typename</span> Number2, std::<span class="keywordtype">size_t</span> w<span class="keywordtype">id</span>th2&gt;</div><div class="line"><a name="l01745"></a><span class="lineno"> 1745</span>&#160;  <span class="keyword">friend</span> <a class="code" href="classVectorizedArray.html">VectorizedArray&lt;Number2, width2&gt;</a></div><div class="line"><a name="l01746"></a><span class="lineno"> 1746</span>&#160;  std::abs(<span class="keyword">const</span> <a class="code" href="classVectorizedArray.html">VectorizedArray&lt;Number2, width2&gt;</a> &amp;);</div><div class="line"><a name="l01747"></a><span class="lineno"> 1747</span>&#160;  <span class="keyword">template</span> &lt;<span class="keyword">typename</span> Number2, std::<span class="keywordtype">size_t</span> w<span class="keywordtype">id</span>th2&gt;</div><div class="line"><a name="l01748"></a><span class="lineno"> 1748</span>&#160;  <span class="keyword">friend</span> <a class="code" href="classVectorizedArray.html">VectorizedArray&lt;Number2, width2&gt;</a></div><div class="line"><a name="l01749"></a><span class="lineno"> 1749</span>&#160;  std::max(<span class="keyword">const</span> <a class="code" href="classVectorizedArray.html">VectorizedArray&lt;Number2, width2&gt;</a> &amp;,</div><div class="line"><a name="l01750"></a><span class="lineno"> 1750</span>&#160;           <span class="keyword">const</span> <a class="code" href="classVectorizedArray.html">VectorizedArray&lt;Number2, width2&gt;</a> &amp;);</div><div class="line"><a name="l01751"></a><span class="lineno"> 1751</span>&#160;  <span class="keyword">template</span> &lt;<span class="keyword">typename</span> Number2, std::<span class="keywordtype">size_t</span> w<span class="keywordtype">id</span>th2&gt;</div><div class="line"><a name="l01752"></a><span class="lineno"> 1752</span>&#160;  <span class="keyword">friend</span> <a class="code" href="classVectorizedArray.html">VectorizedArray&lt;Number2, width2&gt;</a></div><div class="line"><a name="l01753"></a><span class="lineno"> 1753</span>&#160;  std::min(<span class="keyword">const</span> <a class="code" href="classVectorizedArray.html">VectorizedArray&lt;Number2, width2&gt;</a> &amp;,</div><div class="line"><a name="l01754"></a><span class="lineno"> 1754</span>&#160;           <span class="keyword">const</span> <a class="code" href="classVectorizedArray.html">VectorizedArray&lt;Number2, width2&gt;</a> &amp;);</div><div class="line"><a name="l01755"></a><span class="lineno"> 1755</span>&#160;};</div><div class="line"><a name="l01756"></a><span class="lineno"> 1756</span>&#160;</div><div class="line"><a name="l01757"></a><span class="lineno"> 1757</span>&#160;</div><div class="line"><a name="l01758"></a><span class="lineno"> 1758</span>&#160;</div><div class="line"><a name="l01764"></a><span class="lineno"> 1764</span>&#160;<span class="keyword">template</span> &lt;&gt;</div><div class="line"><a name="l01765"></a><span class="lineno"> 1765</span>&#160;<span class="keyword">inline</span> <a class="code" href="config_8h.html#a1d1d58e8be15e5c4285f6892e5f33136">DEAL_II_ALWAYS_INLINE</a> <span class="keywordtype">void</span></div><div class="line"><a name="l01766"></a><span class="lineno"> 1766</span>&#160;<a class="code" href="vectorization_8h.html#a14da4327264fd3a88a9f73a8f72a9094">vectorized_load_and_transpose</a>(<span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span>          n_entries,</div><div class="line"><a name="l01767"></a><span class="lineno"> 1767</span>&#160;                              <span class="keyword">const</span> <span class="keywordtype">float</span> *               in,</div><div class="line"><a name="l01768"></a><span class="lineno"> 1768</span>&#160;                              <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> *        offsets,</div><div class="line"><a name="l01769"></a><span class="lineno"> 1769</span>&#160;                              <a class="code" href="classVectorizedArray.html">VectorizedArray&lt;float, 16&gt;</a> *out)</div><div class="line"><a name="l01770"></a><span class="lineno"> 1770</span>&#160;{</div><div class="line"><a name="l01771"></a><span class="lineno"> 1771</span>&#160;  <span class="comment">// Similar to the double case, we perform the work on smaller entities. In</span></div><div class="line"><a name="l01772"></a><span class="lineno"> 1772</span>&#160;  <span class="comment">// this case, we start from 128 bit arrays and insert them into a full 512</span></div><div class="line"><a name="l01773"></a><span class="lineno"> 1773</span>&#160;  <span class="comment">// bit index. This reduces the code size and register pressure because we do</span></div><div class="line"><a name="l01774"></a><span class="lineno"> 1774</span>&#160;  <span class="comment">// shuffles on 4 numbers rather than 16.</span></div><div class="line"><a name="l01775"></a><span class="lineno"> 1775</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> n_chunks = n_entries / 4;</div><div class="line"><a name="l01776"></a><span class="lineno"> 1776</span>&#160;</div><div class="line"><a name="l01777"></a><span class="lineno"> 1777</span>&#160;  <span class="comment">// To avoid warnings about uninitialized variables, need to initialize one</span></div><div class="line"><a name="l01778"></a><span class="lineno"> 1778</span>&#160;  <span class="comment">// variable to a pre-exisiting value in out, which will never get used in</span></div><div class="line"><a name="l01779"></a><span class="lineno"> 1779</span>&#160;  <span class="comment">// the end. Keep the initialization outside the loop because of a bug in</span></div><div class="line"><a name="l01780"></a><span class="lineno"> 1780</span>&#160;  <span class="comment">// gcc-9.1 which generates a &quot;vmovapd&quot; instruction instead of &quot;vmovupd&quot; in</span></div><div class="line"><a name="l01781"></a><span class="lineno"> 1781</span>&#160;  <span class="comment">// case t3 is initialized to zero (inside/outside of loop), see</span></div><div class="line"><a name="l01782"></a><span class="lineno"> 1782</span>&#160;  <span class="comment">// https://gcc.gnu.org/bugzilla/show_bug.cgi?id=90991</span></div><div class="line"><a name="l01783"></a><span class="lineno"> 1783</span>&#160;  __m512 t0, t1, t2, t3;</div><div class="line"><a name="l01784"></a><span class="lineno"> 1784</span>&#160;  <span class="keywordflow">if</span> (n_chunks &gt; 0)</div><div class="line"><a name="l01785"></a><span class="lineno"> 1785</span>&#160;    t3 = out[0].<a class="code" href="classVectorizedArray.html#ad38190d02537705964e021da7ecbab3f">data</a>;</div><div class="line"><a name="l01786"></a><span class="lineno"> 1786</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i = 0; i &lt; n_chunks; ++i)</div><div class="line"><a name="l01787"></a><span class="lineno"> 1787</span>&#160;    {</div><div class="line"><a name="l01788"></a><span class="lineno"> 1788</span>&#160;      t0 = _mm512_insertf32x4(t3, _mm_loadu_ps(in + offsets[0] + 4 * i), 0);</div><div class="line"><a name="l01789"></a><span class="lineno"> 1789</span>&#160;      t0 = _mm512_insertf32x4(t0, _mm_loadu_ps(in + offsets[4] + 4 * i), 1);</div><div class="line"><a name="l01790"></a><span class="lineno"> 1790</span>&#160;      t0 = _mm512_insertf32x4(t0, _mm_loadu_ps(in + offsets[8] + 4 * i), 2);</div><div class="line"><a name="l01791"></a><span class="lineno"> 1791</span>&#160;      t0 = _mm512_insertf32x4(t0, _mm_loadu_ps(in + offsets[12] + 4 * i), 3);</div><div class="line"><a name="l01792"></a><span class="lineno"> 1792</span>&#160;      t1 = _mm512_insertf32x4(t3, _mm_loadu_ps(in + offsets[1] + 4 * i), 0);</div><div class="line"><a name="l01793"></a><span class="lineno"> 1793</span>&#160;      t1 = _mm512_insertf32x4(t1, _mm_loadu_ps(in + offsets[5] + 4 * i), 1);</div><div class="line"><a name="l01794"></a><span class="lineno"> 1794</span>&#160;      t1 = _mm512_insertf32x4(t1, _mm_loadu_ps(in + offsets[9] + 4 * i), 2);</div><div class="line"><a name="l01795"></a><span class="lineno"> 1795</span>&#160;      t1 = _mm512_insertf32x4(t1, _mm_loadu_ps(in + offsets[13] + 4 * i), 3);</div><div class="line"><a name="l01796"></a><span class="lineno"> 1796</span>&#160;      t2 = _mm512_insertf32x4(t3, _mm_loadu_ps(in + offsets[2] + 4 * i), 0);</div><div class="line"><a name="l01797"></a><span class="lineno"> 1797</span>&#160;      t2 = _mm512_insertf32x4(t2, _mm_loadu_ps(in + offsets[6] + 4 * i), 1);</div><div class="line"><a name="l01798"></a><span class="lineno"> 1798</span>&#160;      t2 = _mm512_insertf32x4(t2, _mm_loadu_ps(in + offsets[10] + 4 * i), 2);</div><div class="line"><a name="l01799"></a><span class="lineno"> 1799</span>&#160;      t2 = _mm512_insertf32x4(t2, _mm_loadu_ps(in + offsets[14] + 4 * i), 3);</div><div class="line"><a name="l01800"></a><span class="lineno"> 1800</span>&#160;      t3 = _mm512_insertf32x4(t3, _mm_loadu_ps(in + offsets[3] + 4 * i), 0);</div><div class="line"><a name="l01801"></a><span class="lineno"> 1801</span>&#160;      t3 = _mm512_insertf32x4(t3, _mm_loadu_ps(in + offsets[7] + 4 * i), 1);</div><div class="line"><a name="l01802"></a><span class="lineno"> 1802</span>&#160;      t3 = _mm512_insertf32x4(t3, _mm_loadu_ps(in + offsets[11] + 4 * i), 2);</div><div class="line"><a name="l01803"></a><span class="lineno"> 1803</span>&#160;      t3 = _mm512_insertf32x4(t3, _mm_loadu_ps(in + offsets[15] + 4 * i), 3);</div><div class="line"><a name="l01804"></a><span class="lineno"> 1804</span>&#160;</div><div class="line"><a name="l01805"></a><span class="lineno"> 1805</span>&#160;      __m512 <a class="code" href="grid__tools_8cc.html#ad817a8f7e41831b2c2971f6eb7142f26">v0</a> = _mm512_shuffle_ps(t0, t1, 0x44);</div><div class="line"><a name="l01806"></a><span class="lineno"> 1806</span>&#160;      __m512 <a class="code" href="grid__tools_8cc.html#adec67e1e77f5ae4fad3d65a5fb8036e9">v1</a> = _mm512_shuffle_ps(t0, t1, 0xee);</div><div class="line"><a name="l01807"></a><span class="lineno"> 1807</span>&#160;      __m512 v2 = _mm512_shuffle_ps(t2, t3, 0x44);</div><div class="line"><a name="l01808"></a><span class="lineno"> 1808</span>&#160;      __m512 v3 = _mm512_shuffle_ps(t2, t3, 0xee);</div><div class="line"><a name="l01809"></a><span class="lineno"> 1809</span>&#160;</div><div class="line"><a name="l01810"></a><span class="lineno"> 1810</span>&#160;      out[4 * i + 0].<a class="code" href="classVectorizedArray.html#ad38190d02537705964e021da7ecbab3f">data</a> = _mm512_shuffle_ps(v0, v2, 0x88);</div><div class="line"><a name="l01811"></a><span class="lineno"> 1811</span>&#160;      out[4 * i + 1].<a class="code" href="classVectorizedArray.html#ad38190d02537705964e021da7ecbab3f">data</a> = _mm512_shuffle_ps(v0, v2, 0xdd);</div><div class="line"><a name="l01812"></a><span class="lineno"> 1812</span>&#160;      out[4 * i + 2].<a class="code" href="classVectorizedArray.html#ad38190d02537705964e021da7ecbab3f">data</a> = _mm512_shuffle_ps(v1, v3, 0x88);</div><div class="line"><a name="l01813"></a><span class="lineno"> 1813</span>&#160;      out[4 * i + 3].<a class="code" href="classVectorizedArray.html#ad38190d02537705964e021da7ecbab3f">data</a> = _mm512_shuffle_ps(v1, v3, 0xdd);</div><div class="line"><a name="l01814"></a><span class="lineno"> 1814</span>&#160;    }</div><div class="line"><a name="l01815"></a><span class="lineno"> 1815</span>&#160;</div><div class="line"><a name="l01816"></a><span class="lineno"> 1816</span>&#160;  <span class="comment">// remainder loop of work that does not divide by 4</span></div><div class="line"><a name="l01817"></a><span class="lineno"> 1817</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i = 4 * n_chunks; i &lt; n_entries; ++i)</div><div class="line"><a name="l01818"></a><span class="lineno"> 1818</span>&#160;    out[i].<a class="code" href="vectorization_8h.html#a078ca5de8d3a59aedc130823be15ad26">gather</a>(in + i, offsets);</div><div class="line"><a name="l01819"></a><span class="lineno"> 1819</span>&#160;}</div><div class="line"><a name="l01820"></a><span class="lineno"> 1820</span>&#160;</div><div class="line"><a name="l01821"></a><span class="lineno"> 1821</span>&#160;</div><div class="line"><a name="l01822"></a><span class="lineno"> 1822</span>&#160;</div><div class="line"><a name="l01828"></a><span class="lineno"> 1828</span>&#160;<span class="keyword">template</span> &lt;&gt;</div><div class="line"><a name="l01829"></a><span class="lineno"> 1829</span>&#160;<span class="keyword">inline</span> <a class="code" href="config_8h.html#a1d1d58e8be15e5c4285f6892e5f33136">DEAL_II_ALWAYS_INLINE</a> <span class="keywordtype">void</span></div><div class="line"><a name="l01830"></a><span class="lineno"> 1830</span>&#160;<a class="code" href="vectorization_8h.html#a14da4327264fd3a88a9f73a8f72a9094">vectorized_load_and_transpose</a>(<span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span>             n_entries,</div><div class="line"><a name="l01831"></a><span class="lineno"> 1831</span>&#160;                              <span class="keyword">const</span> std::array&lt;float *, 16&gt; &amp;in,</div><div class="line"><a name="l01832"></a><span class="lineno"> 1832</span>&#160;                              <a class="code" href="classVectorizedArray.html">VectorizedArray&lt;float, 16&gt;</a> *   out)</div><div class="line"><a name="l01833"></a><span class="lineno"> 1833</span>&#160;{</div><div class="line"><a name="l01834"></a><span class="lineno"> 1834</span>&#160;  <span class="comment">// see the comments in the vectorized_load_and_transpose above</span></div><div class="line"><a name="l01835"></a><span class="lineno"> 1835</span>&#160;</div><div class="line"><a name="l01836"></a><span class="lineno"> 1836</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> n_chunks = n_entries / 4;</div><div class="line"><a name="l01837"></a><span class="lineno"> 1837</span>&#160;</div><div class="line"><a name="l01838"></a><span class="lineno"> 1838</span>&#160;  __m512 t0, t1, t2, t3;</div><div class="line"><a name="l01839"></a><span class="lineno"> 1839</span>&#160;  <span class="keywordflow">if</span> (n_chunks &gt; 0)</div><div class="line"><a name="l01840"></a><span class="lineno"> 1840</span>&#160;    t3 = out[0].<a class="code" href="classVectorizedArray.html#ad38190d02537705964e021da7ecbab3f">data</a>;</div><div class="line"><a name="l01841"></a><span class="lineno"> 1841</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i = 0; i &lt; n_chunks; ++i)</div><div class="line"><a name="l01842"></a><span class="lineno"> 1842</span>&#160;    {</div><div class="line"><a name="l01843"></a><span class="lineno"> 1843</span>&#160;      t0 = _mm512_insertf32x4(t3, _mm_loadu_ps(in[0] + 4 * i), 0);</div><div class="line"><a name="l01844"></a><span class="lineno"> 1844</span>&#160;      t0 = _mm512_insertf32x4(t0, _mm_loadu_ps(in[4] + 4 * i), 1);</div><div class="line"><a name="l01845"></a><span class="lineno"> 1845</span>&#160;      t0 = _mm512_insertf32x4(t0, _mm_loadu_ps(in[8] + 4 * i), 2);</div><div class="line"><a name="l01846"></a><span class="lineno"> 1846</span>&#160;      t0 = _mm512_insertf32x4(t0, _mm_loadu_ps(in[12] + 4 * i), 3);</div><div class="line"><a name="l01847"></a><span class="lineno"> 1847</span>&#160;      t1 = _mm512_insertf32x4(t3, _mm_loadu_ps(in[1] + 4 * i), 0);</div><div class="line"><a name="l01848"></a><span class="lineno"> 1848</span>&#160;      t1 = _mm512_insertf32x4(t1, _mm_loadu_ps(in[5] + 4 * i), 1);</div><div class="line"><a name="l01849"></a><span class="lineno"> 1849</span>&#160;      t1 = _mm512_insertf32x4(t1, _mm_loadu_ps(in[9] + 4 * i), 2);</div><div class="line"><a name="l01850"></a><span class="lineno"> 1850</span>&#160;      t1 = _mm512_insertf32x4(t1, _mm_loadu_ps(in[13] + 4 * i), 3);</div><div class="line"><a name="l01851"></a><span class="lineno"> 1851</span>&#160;      t2 = _mm512_insertf32x4(t3, _mm_loadu_ps(in[2] + 4 * i), 0);</div><div class="line"><a name="l01852"></a><span class="lineno"> 1852</span>&#160;      t2 = _mm512_insertf32x4(t2, _mm_loadu_ps(in[6] + 4 * i), 1);</div><div class="line"><a name="l01853"></a><span class="lineno"> 1853</span>&#160;      t2 = _mm512_insertf32x4(t2, _mm_loadu_ps(in[10] + 4 * i), 2);</div><div class="line"><a name="l01854"></a><span class="lineno"> 1854</span>&#160;      t2 = _mm512_insertf32x4(t2, _mm_loadu_ps(in[14] + 4 * i), 3);</div><div class="line"><a name="l01855"></a><span class="lineno"> 1855</span>&#160;      t3 = _mm512_insertf32x4(t3, _mm_loadu_ps(in[3] + 4 * i), 0);</div><div class="line"><a name="l01856"></a><span class="lineno"> 1856</span>&#160;      t3 = _mm512_insertf32x4(t3, _mm_loadu_ps(in[7] + 4 * i), 1);</div><div class="line"><a name="l01857"></a><span class="lineno"> 1857</span>&#160;      t3 = _mm512_insertf32x4(t3, _mm_loadu_ps(in[11] + 4 * i), 2);</div><div class="line"><a name="l01858"></a><span class="lineno"> 1858</span>&#160;      t3 = _mm512_insertf32x4(t3, _mm_loadu_ps(in[15] + 4 * i), 3);</div><div class="line"><a name="l01859"></a><span class="lineno"> 1859</span>&#160;</div><div class="line"><a name="l01860"></a><span class="lineno"> 1860</span>&#160;      __m512 <a class="code" href="grid__tools_8cc.html#ad817a8f7e41831b2c2971f6eb7142f26">v0</a> = _mm512_shuffle_ps(t0, t1, 0x44);</div><div class="line"><a name="l01861"></a><span class="lineno"> 1861</span>&#160;      __m512 <a class="code" href="grid__tools_8cc.html#adec67e1e77f5ae4fad3d65a5fb8036e9">v1</a> = _mm512_shuffle_ps(t0, t1, 0xee);</div><div class="line"><a name="l01862"></a><span class="lineno"> 1862</span>&#160;      __m512 v2 = _mm512_shuffle_ps(t2, t3, 0x44);</div><div class="line"><a name="l01863"></a><span class="lineno"> 1863</span>&#160;      __m512 v3 = _mm512_shuffle_ps(t2, t3, 0xee);</div><div class="line"><a name="l01864"></a><span class="lineno"> 1864</span>&#160;</div><div class="line"><a name="l01865"></a><span class="lineno"> 1865</span>&#160;      out[4 * i + 0].<a class="code" href="classVectorizedArray.html#ad38190d02537705964e021da7ecbab3f">data</a> = _mm512_shuffle_ps(v0, v2, 0x88);</div><div class="line"><a name="l01866"></a><span class="lineno"> 1866</span>&#160;      out[4 * i + 1].<a class="code" href="classVectorizedArray.html#ad38190d02537705964e021da7ecbab3f">data</a> = _mm512_shuffle_ps(v0, v2, 0xdd);</div><div class="line"><a name="l01867"></a><span class="lineno"> 1867</span>&#160;      out[4 * i + 2].<a class="code" href="classVectorizedArray.html#ad38190d02537705964e021da7ecbab3f">data</a> = _mm512_shuffle_ps(v1, v3, 0x88);</div><div class="line"><a name="l01868"></a><span class="lineno"> 1868</span>&#160;      out[4 * i + 3].<a class="code" href="classVectorizedArray.html#ad38190d02537705964e021da7ecbab3f">data</a> = _mm512_shuffle_ps(v1, v3, 0xdd);</div><div class="line"><a name="l01869"></a><span class="lineno"> 1869</span>&#160;    }</div><div class="line"><a name="l01870"></a><span class="lineno"> 1870</span>&#160;</div><div class="line"><a name="l01871"></a><span class="lineno"> 1871</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i = 4 * n_chunks; i &lt; n_entries; ++i)</div><div class="line"><a name="l01872"></a><span class="lineno"> 1872</span>&#160;    <a class="code" href="vectorization_8h.html#a078ca5de8d3a59aedc130823be15ad26">gather</a>(out[i], in, i);</div><div class="line"><a name="l01873"></a><span class="lineno"> 1873</span>&#160;}</div><div class="line"><a name="l01874"></a><span class="lineno"> 1874</span>&#160;</div><div class="line"><a name="l01875"></a><span class="lineno"> 1875</span>&#160;</div><div class="line"><a name="l01876"></a><span class="lineno"> 1876</span>&#160;</div><div class="line"><a name="l01882"></a><span class="lineno"> 1882</span>&#160;<span class="keyword">template</span> &lt;&gt;</div><div class="line"><a name="l01883"></a><span class="lineno"> 1883</span>&#160;<span class="keyword">inline</span> <a class="code" href="config_8h.html#a1d1d58e8be15e5c4285f6892e5f33136">DEAL_II_ALWAYS_INLINE</a> <span class="keywordtype">void</span></div><div class="line"><a name="l01884"></a><span class="lineno"> 1884</span>&#160;<a class="code" href="vectorization_8h.html#af396b43c783502e8acd2ca7d071a7325">vectorized_transpose_and_store</a>(<span class="keyword">const</span> <span class="keywordtype">bool</span>                        add_into,</div><div class="line"><a name="l01885"></a><span class="lineno"> 1885</span>&#160;                               <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span>                n_entries,</div><div class="line"><a name="l01886"></a><span class="lineno"> 1886</span>&#160;                               <span class="keyword">const</span> <a class="code" href="classVectorizedArray.html">VectorizedArray&lt;float, 16&gt;</a> *in,</div><div class="line"><a name="l01887"></a><span class="lineno"> 1887</span>&#160;                               <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> *              offsets,</div><div class="line"><a name="l01888"></a><span class="lineno"> 1888</span>&#160;                               <span class="keywordtype">float</span> *                           out)</div><div class="line"><a name="l01889"></a><span class="lineno"> 1889</span>&#160;{</div><div class="line"><a name="l01890"></a><span class="lineno"> 1890</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> n_chunks = n_entries / 4;</div><div class="line"><a name="l01891"></a><span class="lineno"> 1891</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i = 0; i &lt; n_chunks; ++i)</div><div class="line"><a name="l01892"></a><span class="lineno"> 1892</span>&#160;    {</div><div class="line"><a name="l01893"></a><span class="lineno"> 1893</span>&#160;      __m512 t0 = _mm512_shuffle_ps(in[4 * i].data, in[1 + 4 * i].data, 0x44);</div><div class="line"><a name="l01894"></a><span class="lineno"> 1894</span>&#160;      __m512 t1 = _mm512_shuffle_ps(in[4 * i].data, in[1 + 4 * i].data, 0xee);</div><div class="line"><a name="l01895"></a><span class="lineno"> 1895</span>&#160;      __m512 t2 =</div><div class="line"><a name="l01896"></a><span class="lineno"> 1896</span>&#160;        _mm512_shuffle_ps(in[2 + 4 * i].data, in[3 + 4 * i].data, 0x44);</div><div class="line"><a name="l01897"></a><span class="lineno"> 1897</span>&#160;      __m512 t3 =</div><div class="line"><a name="l01898"></a><span class="lineno"> 1898</span>&#160;        _mm512_shuffle_ps(in[2 + 4 * i].data, in[3 + 4 * i].data, 0xee);</div><div class="line"><a name="l01899"></a><span class="lineno"> 1899</span>&#160;      __m512 u0 = _mm512_shuffle_ps(t0, t2, 0x88);</div><div class="line"><a name="l01900"></a><span class="lineno"> 1900</span>&#160;      __m512 u1 = _mm512_shuffle_ps(t0, t2, 0xdd);</div><div class="line"><a name="l01901"></a><span class="lineno"> 1901</span>&#160;      __m512 u2 = _mm512_shuffle_ps(t1, t3, 0x88);</div><div class="line"><a name="l01902"></a><span class="lineno"> 1902</span>&#160;      __m512 u3 = _mm512_shuffle_ps(t1, t3, 0xdd);</div><div class="line"><a name="l01903"></a><span class="lineno"> 1903</span>&#160;</div><div class="line"><a name="l01904"></a><span class="lineno"> 1904</span>&#160;      __m128 res0  = _mm512_extractf32x4_ps(u0, 0);</div><div class="line"><a name="l01905"></a><span class="lineno"> 1905</span>&#160;      __m128 res4  = _mm512_extractf32x4_ps(u0, 1);</div><div class="line"><a name="l01906"></a><span class="lineno"> 1906</span>&#160;      __m128 res8  = _mm512_extractf32x4_ps(u0, 2);</div><div class="line"><a name="l01907"></a><span class="lineno"> 1907</span>&#160;      __m128 res12 = _mm512_extractf32x4_ps(u0, 3);</div><div class="line"><a name="l01908"></a><span class="lineno"> 1908</span>&#160;      __m128 res1  = _mm512_extractf32x4_ps(u1, 0);</div><div class="line"><a name="l01909"></a><span class="lineno"> 1909</span>&#160;      __m128 res5  = _mm512_extractf32x4_ps(u1, 1);</div><div class="line"><a name="l01910"></a><span class="lineno"> 1910</span>&#160;      __m128 res9  = _mm512_extractf32x4_ps(u1, 2);</div><div class="line"><a name="l01911"></a><span class="lineno"> 1911</span>&#160;      __m128 res13 = _mm512_extractf32x4_ps(u1, 3);</div><div class="line"><a name="l01912"></a><span class="lineno"> 1912</span>&#160;      __m128 res2  = _mm512_extractf32x4_ps(u2, 0);</div><div class="line"><a name="l01913"></a><span class="lineno"> 1913</span>&#160;      __m128 res6  = _mm512_extractf32x4_ps(u2, 1);</div><div class="line"><a name="l01914"></a><span class="lineno"> 1914</span>&#160;      __m128 res10 = _mm512_extractf32x4_ps(u2, 2);</div><div class="line"><a name="l01915"></a><span class="lineno"> 1915</span>&#160;      __m128 res14 = _mm512_extractf32x4_ps(u2, 3);</div><div class="line"><a name="l01916"></a><span class="lineno"> 1916</span>&#160;      __m128 res3  = _mm512_extractf32x4_ps(u3, 0);</div><div class="line"><a name="l01917"></a><span class="lineno"> 1917</span>&#160;      __m128 res7  = _mm512_extractf32x4_ps(u3, 1);</div><div class="line"><a name="l01918"></a><span class="lineno"> 1918</span>&#160;      __m128 res11 = _mm512_extractf32x4_ps(u3, 2);</div><div class="line"><a name="l01919"></a><span class="lineno"> 1919</span>&#160;      __m128 res15 = _mm512_extractf32x4_ps(u3, 3);</div><div class="line"><a name="l01920"></a><span class="lineno"> 1920</span>&#160;</div><div class="line"><a name="l01921"></a><span class="lineno"> 1921</span>&#160;      <span class="comment">// Cannot use the same store instructions in both paths of the &#39;if&#39;</span></div><div class="line"><a name="l01922"></a><span class="lineno"> 1922</span>&#160;      <span class="comment">// because the compiler cannot know that there is no aliasing between</span></div><div class="line"><a name="l01923"></a><span class="lineno"> 1923</span>&#160;      <span class="comment">// pointers</span></div><div class="line"><a name="l01924"></a><span class="lineno"> 1924</span>&#160;      <span class="keywordflow">if</span> (add_into)</div><div class="line"><a name="l01925"></a><span class="lineno"> 1925</span>&#160;        {</div><div class="line"><a name="l01926"></a><span class="lineno"> 1926</span>&#160;          res0 = _mm_add_ps(_mm_loadu_ps(out + 4 * i + offsets[0]), res0);</div><div class="line"><a name="l01927"></a><span class="lineno"> 1927</span>&#160;          _mm_storeu_ps(out + 4 * i + offsets[0], res0);</div><div class="line"><a name="l01928"></a><span class="lineno"> 1928</span>&#160;          res1 = _mm_add_ps(_mm_loadu_ps(out + 4 * i + offsets[1]), res1);</div><div class="line"><a name="l01929"></a><span class="lineno"> 1929</span>&#160;          _mm_storeu_ps(out + 4 * i + offsets[1], res1);</div><div class="line"><a name="l01930"></a><span class="lineno"> 1930</span>&#160;          res2 = _mm_add_ps(_mm_loadu_ps(out + 4 * i + offsets[2]), res2);</div><div class="line"><a name="l01931"></a><span class="lineno"> 1931</span>&#160;          _mm_storeu_ps(out + 4 * i + offsets[2], res2);</div><div class="line"><a name="l01932"></a><span class="lineno"> 1932</span>&#160;          res3 = _mm_add_ps(_mm_loadu_ps(out + 4 * i + offsets[3]), res3);</div><div class="line"><a name="l01933"></a><span class="lineno"> 1933</span>&#160;          _mm_storeu_ps(out + 4 * i + offsets[3], res3);</div><div class="line"><a name="l01934"></a><span class="lineno"> 1934</span>&#160;          res4 = _mm_add_ps(_mm_loadu_ps(out + 4 * i + offsets[4]), res4);</div><div class="line"><a name="l01935"></a><span class="lineno"> 1935</span>&#160;          _mm_storeu_ps(out + 4 * i + offsets[4], res4);</div><div class="line"><a name="l01936"></a><span class="lineno"> 1936</span>&#160;          res5 = _mm_add_ps(_mm_loadu_ps(out + 4 * i + offsets[5]), res5);</div><div class="line"><a name="l01937"></a><span class="lineno"> 1937</span>&#160;          _mm_storeu_ps(out + 4 * i + offsets[5], res5);</div><div class="line"><a name="l01938"></a><span class="lineno"> 1938</span>&#160;          res6 = _mm_add_ps(_mm_loadu_ps(out + 4 * i + offsets[6]), res6);</div><div class="line"><a name="l01939"></a><span class="lineno"> 1939</span>&#160;          _mm_storeu_ps(out + 4 * i + offsets[6], res6);</div><div class="line"><a name="l01940"></a><span class="lineno"> 1940</span>&#160;          res7 = _mm_add_ps(_mm_loadu_ps(out + 4 * i + offsets[7]), res7);</div><div class="line"><a name="l01941"></a><span class="lineno"> 1941</span>&#160;          _mm_storeu_ps(out + 4 * i + offsets[7], res7);</div><div class="line"><a name="l01942"></a><span class="lineno"> 1942</span>&#160;          res8 = _mm_add_ps(_mm_loadu_ps(out + 4 * i + offsets[8]), res8);</div><div class="line"><a name="l01943"></a><span class="lineno"> 1943</span>&#160;          _mm_storeu_ps(out + 4 * i + offsets[8], res8);</div><div class="line"><a name="l01944"></a><span class="lineno"> 1944</span>&#160;          res9 = _mm_add_ps(_mm_loadu_ps(out + 4 * i + offsets[9]), res9);</div><div class="line"><a name="l01945"></a><span class="lineno"> 1945</span>&#160;          _mm_storeu_ps(out + 4 * i + offsets[9], res9);</div><div class="line"><a name="l01946"></a><span class="lineno"> 1946</span>&#160;          res10 = _mm_add_ps(_mm_loadu_ps(out + 4 * i + offsets[10]), res10);</div><div class="line"><a name="l01947"></a><span class="lineno"> 1947</span>&#160;          _mm_storeu_ps(out + 4 * i + offsets[10], res10);</div><div class="line"><a name="l01948"></a><span class="lineno"> 1948</span>&#160;          res11 = _mm_add_ps(_mm_loadu_ps(out + 4 * i + offsets[11]), res11);</div><div class="line"><a name="l01949"></a><span class="lineno"> 1949</span>&#160;          _mm_storeu_ps(out + 4 * i + offsets[11], res11);</div><div class="line"><a name="l01950"></a><span class="lineno"> 1950</span>&#160;          res12 = _mm_add_ps(_mm_loadu_ps(out + 4 * i + offsets[12]), res12);</div><div class="line"><a name="l01951"></a><span class="lineno"> 1951</span>&#160;          _mm_storeu_ps(out + 4 * i + offsets[12], res12);</div><div class="line"><a name="l01952"></a><span class="lineno"> 1952</span>&#160;          res13 = _mm_add_ps(_mm_loadu_ps(out + 4 * i + offsets[13]), res13);</div><div class="line"><a name="l01953"></a><span class="lineno"> 1953</span>&#160;          _mm_storeu_ps(out + 4 * i + offsets[13], res13);</div><div class="line"><a name="l01954"></a><span class="lineno"> 1954</span>&#160;          res14 = _mm_add_ps(_mm_loadu_ps(out + 4 * i + offsets[14]), res14);</div><div class="line"><a name="l01955"></a><span class="lineno"> 1955</span>&#160;          _mm_storeu_ps(out + 4 * i + offsets[14], res14);</div><div class="line"><a name="l01956"></a><span class="lineno"> 1956</span>&#160;          res15 = _mm_add_ps(_mm_loadu_ps(out + 4 * i + offsets[15]), res15);</div><div class="line"><a name="l01957"></a><span class="lineno"> 1957</span>&#160;          _mm_storeu_ps(out + 4 * i + offsets[15], res15);</div><div class="line"><a name="l01958"></a><span class="lineno"> 1958</span>&#160;        }</div><div class="line"><a name="l01959"></a><span class="lineno"> 1959</span>&#160;      <span class="keywordflow">else</span></div><div class="line"><a name="l01960"></a><span class="lineno"> 1960</span>&#160;        {</div><div class="line"><a name="l01961"></a><span class="lineno"> 1961</span>&#160;          _mm_storeu_ps(out + 4 * i + offsets[0], res0);</div><div class="line"><a name="l01962"></a><span class="lineno"> 1962</span>&#160;          _mm_storeu_ps(out + 4 * i + offsets[1], res1);</div><div class="line"><a name="l01963"></a><span class="lineno"> 1963</span>&#160;          _mm_storeu_ps(out + 4 * i + offsets[2], res2);</div><div class="line"><a name="l01964"></a><span class="lineno"> 1964</span>&#160;          _mm_storeu_ps(out + 4 * i + offsets[3], res3);</div><div class="line"><a name="l01965"></a><span class="lineno"> 1965</span>&#160;          _mm_storeu_ps(out + 4 * i + offsets[4], res4);</div><div class="line"><a name="l01966"></a><span class="lineno"> 1966</span>&#160;          _mm_storeu_ps(out + 4 * i + offsets[5], res5);</div><div class="line"><a name="l01967"></a><span class="lineno"> 1967</span>&#160;          _mm_storeu_ps(out + 4 * i + offsets[6], res6);</div><div class="line"><a name="l01968"></a><span class="lineno"> 1968</span>&#160;          _mm_storeu_ps(out + 4 * i + offsets[7], res7);</div><div class="line"><a name="l01969"></a><span class="lineno"> 1969</span>&#160;          _mm_storeu_ps(out + 4 * i + offsets[8], res8);</div><div class="line"><a name="l01970"></a><span class="lineno"> 1970</span>&#160;          _mm_storeu_ps(out + 4 * i + offsets[9], res9);</div><div class="line"><a name="l01971"></a><span class="lineno"> 1971</span>&#160;          _mm_storeu_ps(out + 4 * i + offsets[10], res10);</div><div class="line"><a name="l01972"></a><span class="lineno"> 1972</span>&#160;          _mm_storeu_ps(out + 4 * i + offsets[11], res11);</div><div class="line"><a name="l01973"></a><span class="lineno"> 1973</span>&#160;          _mm_storeu_ps(out + 4 * i + offsets[12], res12);</div><div class="line"><a name="l01974"></a><span class="lineno"> 1974</span>&#160;          _mm_storeu_ps(out + 4 * i + offsets[13], res13);</div><div class="line"><a name="l01975"></a><span class="lineno"> 1975</span>&#160;          _mm_storeu_ps(out + 4 * i + offsets[14], res14);</div><div class="line"><a name="l01976"></a><span class="lineno"> 1976</span>&#160;          _mm_storeu_ps(out + 4 * i + offsets[15], res15);</div><div class="line"><a name="l01977"></a><span class="lineno"> 1977</span>&#160;        }</div><div class="line"><a name="l01978"></a><span class="lineno"> 1978</span>&#160;    }</div><div class="line"><a name="l01979"></a><span class="lineno"> 1979</span>&#160;</div><div class="line"><a name="l01980"></a><span class="lineno"> 1980</span>&#160;  <span class="comment">// remainder loop of work that does not divide by 4</span></div><div class="line"><a name="l01981"></a><span class="lineno"> 1981</span>&#160;  <span class="keywordflow">if</span> (add_into)</div><div class="line"><a name="l01982"></a><span class="lineno"> 1982</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i = 4 * n_chunks; i &lt; n_entries; ++i)</div><div class="line"><a name="l01983"></a><span class="lineno"> 1983</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> v = 0; v &lt; 16; ++v)</div><div class="line"><a name="l01984"></a><span class="lineno"> 1984</span>&#160;        out[offsets[v] + i] += in[i][v];</div><div class="line"><a name="l01985"></a><span class="lineno"> 1985</span>&#160;  <span class="keywordflow">else</span></div><div class="line"><a name="l01986"></a><span class="lineno"> 1986</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i = 4 * n_chunks; i &lt; n_entries; ++i)</div><div class="line"><a name="l01987"></a><span class="lineno"> 1987</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> v = 0; v &lt; 16; ++v)</div><div class="line"><a name="l01988"></a><span class="lineno"> 1988</span>&#160;        out[offsets[v] + i] = in[i][v];</div><div class="line"><a name="l01989"></a><span class="lineno"> 1989</span>&#160;}</div><div class="line"><a name="l01990"></a><span class="lineno"> 1990</span>&#160;</div><div class="line"><a name="l01991"></a><span class="lineno"> 1991</span>&#160;</div><div class="line"><a name="l01992"></a><span class="lineno"> 1992</span>&#160;</div><div class="line"><a name="l01998"></a><span class="lineno"> 1998</span>&#160;<span class="keyword">template</span> &lt;&gt;</div><div class="line"><a name="l01999"></a><span class="lineno"> 1999</span>&#160;<span class="keyword">inline</span> <a class="code" href="config_8h.html#a1d1d58e8be15e5c4285f6892e5f33136">DEAL_II_ALWAYS_INLINE</a> <span class="keywordtype">void</span></div><div class="line"><a name="l02000"></a><span class="lineno"> 2000</span>&#160;<a class="code" href="vectorization_8h.html#af396b43c783502e8acd2ca7d071a7325">vectorized_transpose_and_store</a>(<span class="keyword">const</span> <span class="keywordtype">bool</span>                        add_into,</div><div class="line"><a name="l02001"></a><span class="lineno"> 2001</span>&#160;                               <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span>                n_entries,</div><div class="line"><a name="l02002"></a><span class="lineno"> 2002</span>&#160;                               <span class="keyword">const</span> <a class="code" href="classVectorizedArray.html">VectorizedArray&lt;float, 16&gt;</a> *in,</div><div class="line"><a name="l02003"></a><span class="lineno"> 2003</span>&#160;                               std::array&lt;float *, 16&gt; &amp;         out)</div><div class="line"><a name="l02004"></a><span class="lineno"> 2004</span>&#160;{</div><div class="line"><a name="l02005"></a><span class="lineno"> 2005</span>&#160;  <span class="comment">// see the comments in the vectorized_transpose_and_store above</span></div><div class="line"><a name="l02006"></a><span class="lineno"> 2006</span>&#160;</div><div class="line"><a name="l02007"></a><span class="lineno"> 2007</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> n_chunks = n_entries / 4;</div><div class="line"><a name="l02008"></a><span class="lineno"> 2008</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i = 0; i &lt; n_chunks; ++i)</div><div class="line"><a name="l02009"></a><span class="lineno"> 2009</span>&#160;    {</div><div class="line"><a name="l02010"></a><span class="lineno"> 2010</span>&#160;      __m512 t0 = _mm512_shuffle_ps(in[4 * i].data, in[1 + 4 * i].data, 0x44);</div><div class="line"><a name="l02011"></a><span class="lineno"> 2011</span>&#160;      __m512 t1 = _mm512_shuffle_ps(in[4 * i].data, in[1 + 4 * i].data, 0xee);</div><div class="line"><a name="l02012"></a><span class="lineno"> 2012</span>&#160;      __m512 t2 =</div><div class="line"><a name="l02013"></a><span class="lineno"> 2013</span>&#160;        _mm512_shuffle_ps(in[2 + 4 * i].data, in[3 + 4 * i].data, 0x44);</div><div class="line"><a name="l02014"></a><span class="lineno"> 2014</span>&#160;      __m512 t3 =</div><div class="line"><a name="l02015"></a><span class="lineno"> 2015</span>&#160;        _mm512_shuffle_ps(in[2 + 4 * i].data, in[3 + 4 * i].data, 0xee);</div><div class="line"><a name="l02016"></a><span class="lineno"> 2016</span>&#160;      __m512 u0 = _mm512_shuffle_ps(t0, t2, 0x88);</div><div class="line"><a name="l02017"></a><span class="lineno"> 2017</span>&#160;      __m512 u1 = _mm512_shuffle_ps(t0, t2, 0xdd);</div><div class="line"><a name="l02018"></a><span class="lineno"> 2018</span>&#160;      __m512 u2 = _mm512_shuffle_ps(t1, t3, 0x88);</div><div class="line"><a name="l02019"></a><span class="lineno"> 2019</span>&#160;      __m512 u3 = _mm512_shuffle_ps(t1, t3, 0xdd);</div><div class="line"><a name="l02020"></a><span class="lineno"> 2020</span>&#160;</div><div class="line"><a name="l02021"></a><span class="lineno"> 2021</span>&#160;      __m128 res0  = _mm512_extractf32x4_ps(u0, 0);</div><div class="line"><a name="l02022"></a><span class="lineno"> 2022</span>&#160;      __m128 res4  = _mm512_extractf32x4_ps(u0, 1);</div><div class="line"><a name="l02023"></a><span class="lineno"> 2023</span>&#160;      __m128 res8  = _mm512_extractf32x4_ps(u0, 2);</div><div class="line"><a name="l02024"></a><span class="lineno"> 2024</span>&#160;      __m128 res12 = _mm512_extractf32x4_ps(u0, 3);</div><div class="line"><a name="l02025"></a><span class="lineno"> 2025</span>&#160;      __m128 res1  = _mm512_extractf32x4_ps(u1, 0);</div><div class="line"><a name="l02026"></a><span class="lineno"> 2026</span>&#160;      __m128 res5  = _mm512_extractf32x4_ps(u1, 1);</div><div class="line"><a name="l02027"></a><span class="lineno"> 2027</span>&#160;      __m128 res9  = _mm512_extractf32x4_ps(u1, 2);</div><div class="line"><a name="l02028"></a><span class="lineno"> 2028</span>&#160;      __m128 res13 = _mm512_extractf32x4_ps(u1, 3);</div><div class="line"><a name="l02029"></a><span class="lineno"> 2029</span>&#160;      __m128 res2  = _mm512_extractf32x4_ps(u2, 0);</div><div class="line"><a name="l02030"></a><span class="lineno"> 2030</span>&#160;      __m128 res6  = _mm512_extractf32x4_ps(u2, 1);</div><div class="line"><a name="l02031"></a><span class="lineno"> 2031</span>&#160;      __m128 res10 = _mm512_extractf32x4_ps(u2, 2);</div><div class="line"><a name="l02032"></a><span class="lineno"> 2032</span>&#160;      __m128 res14 = _mm512_extractf32x4_ps(u2, 3);</div><div class="line"><a name="l02033"></a><span class="lineno"> 2033</span>&#160;      __m128 res3  = _mm512_extractf32x4_ps(u3, 0);</div><div class="line"><a name="l02034"></a><span class="lineno"> 2034</span>&#160;      __m128 res7  = _mm512_extractf32x4_ps(u3, 1);</div><div class="line"><a name="l02035"></a><span class="lineno"> 2035</span>&#160;      __m128 res11 = _mm512_extractf32x4_ps(u3, 2);</div><div class="line"><a name="l02036"></a><span class="lineno"> 2036</span>&#160;      __m128 res15 = _mm512_extractf32x4_ps(u3, 3);</div><div class="line"><a name="l02037"></a><span class="lineno"> 2037</span>&#160;</div><div class="line"><a name="l02038"></a><span class="lineno"> 2038</span>&#160;      <span class="keywordflow">if</span> (add_into)</div><div class="line"><a name="l02039"></a><span class="lineno"> 2039</span>&#160;        {</div><div class="line"><a name="l02040"></a><span class="lineno"> 2040</span>&#160;          res0 = _mm_add_ps(_mm_loadu_ps(out[0] + 4 * i), res0);</div><div class="line"><a name="l02041"></a><span class="lineno"> 2041</span>&#160;          _mm_storeu_ps(out[0] + 4 * i, res0);</div><div class="line"><a name="l02042"></a><span class="lineno"> 2042</span>&#160;          res1 = _mm_add_ps(_mm_loadu_ps(out[1] + 4 * i), res1);</div><div class="line"><a name="l02043"></a><span class="lineno"> 2043</span>&#160;          _mm_storeu_ps(out[1] + 4 * i, res1);</div><div class="line"><a name="l02044"></a><span class="lineno"> 2044</span>&#160;          res2 = _mm_add_ps(_mm_loadu_ps(out[2] + 4 * i), res2);</div><div class="line"><a name="l02045"></a><span class="lineno"> 2045</span>&#160;          _mm_storeu_ps(out[2] + 4 * i, res2);</div><div class="line"><a name="l02046"></a><span class="lineno"> 2046</span>&#160;          res3 = _mm_add_ps(_mm_loadu_ps(out[3] + 4 * i), res3);</div><div class="line"><a name="l02047"></a><span class="lineno"> 2047</span>&#160;          _mm_storeu_ps(out[3] + 4 * i, res3);</div><div class="line"><a name="l02048"></a><span class="lineno"> 2048</span>&#160;          res4 = _mm_add_ps(_mm_loadu_ps(out[4] + 4 * i), res4);</div><div class="line"><a name="l02049"></a><span class="lineno"> 2049</span>&#160;          _mm_storeu_ps(out[4] + 4 * i, res4);</div><div class="line"><a name="l02050"></a><span class="lineno"> 2050</span>&#160;          res5 = _mm_add_ps(_mm_loadu_ps(out[5] + 4 * i), res5);</div><div class="line"><a name="l02051"></a><span class="lineno"> 2051</span>&#160;          _mm_storeu_ps(out[5] + 4 * i, res5);</div><div class="line"><a name="l02052"></a><span class="lineno"> 2052</span>&#160;          res6 = _mm_add_ps(_mm_loadu_ps(out[6] + 4 * i), res6);</div><div class="line"><a name="l02053"></a><span class="lineno"> 2053</span>&#160;          _mm_storeu_ps(out[6] + 4 * i, res6);</div><div class="line"><a name="l02054"></a><span class="lineno"> 2054</span>&#160;          res7 = _mm_add_ps(_mm_loadu_ps(out[7] + 4 * i), res7);</div><div class="line"><a name="l02055"></a><span class="lineno"> 2055</span>&#160;          _mm_storeu_ps(out[7] + 4 * i, res7);</div><div class="line"><a name="l02056"></a><span class="lineno"> 2056</span>&#160;          res8 = _mm_add_ps(_mm_loadu_ps(out[8] + 4 * i), res8);</div><div class="line"><a name="l02057"></a><span class="lineno"> 2057</span>&#160;          _mm_storeu_ps(out[8] + 4 * i, res8);</div><div class="line"><a name="l02058"></a><span class="lineno"> 2058</span>&#160;          res9 = _mm_add_ps(_mm_loadu_ps(out[9] + 4 * i), res9);</div><div class="line"><a name="l02059"></a><span class="lineno"> 2059</span>&#160;          _mm_storeu_ps(out[9] + 4 * i, res9);</div><div class="line"><a name="l02060"></a><span class="lineno"> 2060</span>&#160;          res10 = _mm_add_ps(_mm_loadu_ps(out[10] + 4 * i), res10);</div><div class="line"><a name="l02061"></a><span class="lineno"> 2061</span>&#160;          _mm_storeu_ps(out[10] + 4 * i, res10);</div><div class="line"><a name="l02062"></a><span class="lineno"> 2062</span>&#160;          res11 = _mm_add_ps(_mm_loadu_ps(out[11] + 4 * i), res11);</div><div class="line"><a name="l02063"></a><span class="lineno"> 2063</span>&#160;          _mm_storeu_ps(out[11] + 4 * i, res11);</div><div class="line"><a name="l02064"></a><span class="lineno"> 2064</span>&#160;          res12 = _mm_add_ps(_mm_loadu_ps(out[12] + 4 * i), res12);</div><div class="line"><a name="l02065"></a><span class="lineno"> 2065</span>&#160;          _mm_storeu_ps(out[12] + 4 * i, res12);</div><div class="line"><a name="l02066"></a><span class="lineno"> 2066</span>&#160;          res13 = _mm_add_ps(_mm_loadu_ps(out[13] + 4 * i), res13);</div><div class="line"><a name="l02067"></a><span class="lineno"> 2067</span>&#160;          _mm_storeu_ps(out[13] + 4 * i, res13);</div><div class="line"><a name="l02068"></a><span class="lineno"> 2068</span>&#160;          res14 = _mm_add_ps(_mm_loadu_ps(out[14] + 4 * i), res14);</div><div class="line"><a name="l02069"></a><span class="lineno"> 2069</span>&#160;          _mm_storeu_ps(out[14] + 4 * i, res14);</div><div class="line"><a name="l02070"></a><span class="lineno"> 2070</span>&#160;          res15 = _mm_add_ps(_mm_loadu_ps(out[15] + 4 * i), res15);</div><div class="line"><a name="l02071"></a><span class="lineno"> 2071</span>&#160;          _mm_storeu_ps(out[15] + 4 * i, res15);</div><div class="line"><a name="l02072"></a><span class="lineno"> 2072</span>&#160;        }</div><div class="line"><a name="l02073"></a><span class="lineno"> 2073</span>&#160;      <span class="keywordflow">else</span></div><div class="line"><a name="l02074"></a><span class="lineno"> 2074</span>&#160;        {</div><div class="line"><a name="l02075"></a><span class="lineno"> 2075</span>&#160;          _mm_storeu_ps(out[0] + 4 * i, res0);</div><div class="line"><a name="l02076"></a><span class="lineno"> 2076</span>&#160;          _mm_storeu_ps(out[1] + 4 * i, res1);</div><div class="line"><a name="l02077"></a><span class="lineno"> 2077</span>&#160;          _mm_storeu_ps(out[2] + 4 * i, res2);</div><div class="line"><a name="l02078"></a><span class="lineno"> 2078</span>&#160;          _mm_storeu_ps(out[3] + 4 * i, res3);</div><div class="line"><a name="l02079"></a><span class="lineno"> 2079</span>&#160;          _mm_storeu_ps(out[4] + 4 * i, res4);</div><div class="line"><a name="l02080"></a><span class="lineno"> 2080</span>&#160;          _mm_storeu_ps(out[5] + 4 * i, res5);</div><div class="line"><a name="l02081"></a><span class="lineno"> 2081</span>&#160;          _mm_storeu_ps(out[6] + 4 * i, res6);</div><div class="line"><a name="l02082"></a><span class="lineno"> 2082</span>&#160;          _mm_storeu_ps(out[7] + 4 * i, res7);</div><div class="line"><a name="l02083"></a><span class="lineno"> 2083</span>&#160;          _mm_storeu_ps(out[8] + 4 * i, res8);</div><div class="line"><a name="l02084"></a><span class="lineno"> 2084</span>&#160;          _mm_storeu_ps(out[9] + 4 * i, res9);</div><div class="line"><a name="l02085"></a><span class="lineno"> 2085</span>&#160;          _mm_storeu_ps(out[10] + 4 * i, res10);</div><div class="line"><a name="l02086"></a><span class="lineno"> 2086</span>&#160;          _mm_storeu_ps(out[11] + 4 * i, res11);</div><div class="line"><a name="l02087"></a><span class="lineno"> 2087</span>&#160;          _mm_storeu_ps(out[12] + 4 * i, res12);</div><div class="line"><a name="l02088"></a><span class="lineno"> 2088</span>&#160;          _mm_storeu_ps(out[13] + 4 * i, res13);</div><div class="line"><a name="l02089"></a><span class="lineno"> 2089</span>&#160;          _mm_storeu_ps(out[14] + 4 * i, res14);</div><div class="line"><a name="l02090"></a><span class="lineno"> 2090</span>&#160;          _mm_storeu_ps(out[15] + 4 * i, res15);</div><div class="line"><a name="l02091"></a><span class="lineno"> 2091</span>&#160;        }</div><div class="line"><a name="l02092"></a><span class="lineno"> 2092</span>&#160;    }</div><div class="line"><a name="l02093"></a><span class="lineno"> 2093</span>&#160;</div><div class="line"><a name="l02094"></a><span class="lineno"> 2094</span>&#160;  <span class="keywordflow">if</span> (add_into)</div><div class="line"><a name="l02095"></a><span class="lineno"> 2095</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i = 4 * n_chunks; i &lt; n_entries; ++i)</div><div class="line"><a name="l02096"></a><span class="lineno"> 2096</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> v = 0; v &lt; 16; ++v)</div><div class="line"><a name="l02097"></a><span class="lineno"> 2097</span>&#160;        out[v][i] += in[i][v];</div><div class="line"><a name="l02098"></a><span class="lineno"> 2098</span>&#160;  <span class="keywordflow">else</span></div><div class="line"><a name="l02099"></a><span class="lineno"> 2099</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i = 4 * n_chunks; i &lt; n_entries; ++i)</div><div class="line"><a name="l02100"></a><span class="lineno"> 2100</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> v = 0; v &lt; 16; ++v)</div><div class="line"><a name="l02101"></a><span class="lineno"> 2101</span>&#160;        out[v][i] = in[i][v];</div><div class="line"><a name="l02102"></a><span class="lineno"> 2102</span>&#160;}</div><div class="line"><a name="l02103"></a><span class="lineno"> 2103</span>&#160;</div><div class="line"><a name="l02104"></a><span class="lineno"> 2104</span>&#160;<span class="preprocessor">#  endif</span></div><div class="line"><a name="l02105"></a><span class="lineno"> 2105</span>&#160;</div><div class="line"><a name="l02106"></a><span class="lineno"> 2106</span>&#160;<span class="preprocessor">#  if DEAL_II_VECTORIZATION_WIDTH_IN_BITS &gt;= 256 &amp;&amp; defined(__AVX__)</span></div><div class="line"><a name="l02107"></a><span class="lineno"> 2107</span>&#160;</div><div class="line"><a name="l02113"></a><span class="lineno"> 2113</span>&#160;<span class="keyword">template</span> &lt;&gt;</div><div class="line"><a name="l02114"></a><span class="lineno"> 2114</span>&#160;<span class="keyword">class </span><a class="code" href="classVectorizedArray.html">VectorizedArray</a>&lt;double, 4&gt;</div><div class="line"><a name="l02115"></a><span class="lineno"> 2115</span>&#160;  : <span class="keyword">public</span> <a class="code" href="classVectorizedArrayBase.html">VectorizedArrayBase</a>&lt;VectorizedArray&lt;double, 4&gt;, 4&gt;</div><div class="line"><a name="l02116"></a><span class="lineno"> 2116</span>&#160;{</div><div class="line"><a name="l02117"></a><span class="lineno"> 2117</span>&#160;<span class="keyword">public</span>:</div><div class="line"><a name="l02122"></a><span class="lineno"> 2122</span>&#160;  <span class="keyword">using</span> value_type = double;</div><div class="line"><a name="l02123"></a><span class="lineno"> 2123</span>&#160;</div><div class="line"><a name="l02128"></a><span class="lineno"> 2128</span>&#160;  <a class="code" href="classVectorizedArray.html">VectorizedArray</a>() = <span class="keywordflow">default</span>;</div><div class="line"><a name="l02129"></a><span class="lineno"> 2129</span>&#160;</div><div class="line"><a name="l02134"></a><span class="lineno"> 2134</span>&#160;  <a class="code" href="classVectorizedArray.html">VectorizedArray</a>(<span class="keyword">const</span> <span class="keywordtype">double</span> scalar)</div><div class="line"><a name="l02135"></a><span class="lineno"> 2135</span>&#160;  {</div><div class="line"><a name="l02136"></a><span class="lineno"> 2136</span>&#160;    this-&gt;operator=(scalar);</div><div class="line"><a name="l02137"></a><span class="lineno"> 2137</span>&#160;  }</div><div class="line"><a name="l02138"></a><span class="lineno"> 2138</span>&#160;</div><div class="line"><a name="l02143"></a><span class="lineno"> 2143</span>&#160;  <a class="code" href="config_8h.html#a1d1d58e8be15e5c4285f6892e5f33136">DEAL_II_ALWAYS_INLINE</a></div><div class="line"><a name="l02144"></a><span class="lineno"> 2144</span>&#160;  <a class="code" href="classVectorizedArray.html">VectorizedArray</a> &amp;</div><div class="line"><a name="l02145"></a><span class="lineno"> 2145</span>&#160;  operator=(<span class="keyword">const</span> <span class="keywordtype">double</span> x)</div><div class="line"><a name="l02146"></a><span class="lineno"> 2146</span>&#160;  {</div><div class="line"><a name="l02147"></a><span class="lineno"> 2147</span>&#160;    data = _mm256_set1_pd(x);</div><div class="line"><a name="l02148"></a><span class="lineno"> 2148</span>&#160;    <span class="keywordflow">return</span> *<span class="keyword">this</span>;</div><div class="line"><a name="l02149"></a><span class="lineno"> 2149</span>&#160;  }</div><div class="line"><a name="l02150"></a><span class="lineno"> 2150</span>&#160;</div><div class="line"><a name="l02155"></a><span class="lineno"> 2155</span>&#160;  <a class="code" href="config_8h.html#a1d1d58e8be15e5c4285f6892e5f33136">DEAL_II_ALWAYS_INLINE</a></div><div class="line"><a name="l02156"></a><span class="lineno"> 2156</span>&#160;  <span class="keywordtype">double</span> &amp;operator[](<span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> comp)</div><div class="line"><a name="l02157"></a><span class="lineno"> 2157</span>&#160;  {</div><div class="line"><a name="l02158"></a><span class="lineno"> 2158</span>&#160;    <a class="code" href="group__Exceptions.html#gaafbb69cc2a791ae55880fd8d57d0c1b0">AssertIndexRange</a>(comp, 4);</div><div class="line"><a name="l02159"></a><span class="lineno"> 2159</span>&#160;    <span class="keywordflow">return</span> *(<span class="keyword">reinterpret_cast&lt;</span><span class="keywordtype">double</span> *<span class="keyword">&gt;</span>(&amp;data) + comp);</div><div class="line"><a name="l02160"></a><span class="lineno"> 2160</span>&#160;  }</div><div class="line"><a name="l02161"></a><span class="lineno"> 2161</span>&#160;</div><div class="line"><a name="l02166"></a><span class="lineno"> 2166</span>&#160;  <a class="code" href="config_8h.html#a1d1d58e8be15e5c4285f6892e5f33136">DEAL_II_ALWAYS_INLINE</a></div><div class="line"><a name="l02167"></a><span class="lineno"> 2167</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">double</span> &amp;operator[](<span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> comp)<span class="keyword"> const</span></div><div class="line"><a name="l02168"></a><span class="lineno"> 2168</span>&#160;<span class="keyword">  </span>{</div><div class="line"><a name="l02169"></a><span class="lineno"> 2169</span>&#160;    <a class="code" href="group__Exceptions.html#gaafbb69cc2a791ae55880fd8d57d0c1b0">AssertIndexRange</a>(comp, 4);</div><div class="line"><a name="l02170"></a><span class="lineno"> 2170</span>&#160;    <span class="keywordflow">return</span> *(<span class="keyword">reinterpret_cast&lt;</span><span class="keyword">const </span><span class="keywordtype">double</span> *<span class="keyword">&gt;</span>(&amp;data) + comp);</div><div class="line"><a name="l02171"></a><span class="lineno"> 2171</span>&#160;  }</div><div class="line"><a name="l02172"></a><span class="lineno"> 2172</span>&#160;</div><div class="line"><a name="l02177"></a><span class="lineno"> 2177</span>&#160;  <a class="code" href="config_8h.html#a1d1d58e8be15e5c4285f6892e5f33136">DEAL_II_ALWAYS_INLINE</a></div><div class="line"><a name="l02178"></a><span class="lineno"> 2178</span>&#160;  <a class="code" href="classVectorizedArray.html">VectorizedArray</a> &amp;</div><div class="line"><a name="l02179"></a><span class="lineno"> 2179</span>&#160;  operator+=(<span class="keyword">const</span> <a class="code" href="classVectorizedArray.html">VectorizedArray</a> &amp;vec)</div><div class="line"><a name="l02180"></a><span class="lineno"> 2180</span>&#160;  {</div><div class="line"><a name="l02181"></a><span class="lineno"> 2181</span>&#160;    <span class="comment">// if the compiler supports vector arithmetic, we can simply use +=</span></div><div class="line"><a name="l02182"></a><span class="lineno"> 2182</span>&#160;    <span class="comment">// operator on the given data type. this allows the compiler to combine</span></div><div class="line"><a name="l02183"></a><span class="lineno"> 2183</span>&#160;    <span class="comment">// additions with multiplication (fused multiply-add) if those</span></div><div class="line"><a name="l02184"></a><span class="lineno"> 2184</span>&#160;    <span class="comment">// instructions are available. Otherwise, we need to use the built-in</span></div><div class="line"><a name="l02185"></a><span class="lineno"> 2185</span>&#160;    <span class="comment">// intrinsic command for __m256d</span></div><div class="line"><a name="l02186"></a><span class="lineno"> 2186</span>&#160;<span class="preprocessor">#    ifdef DEAL_II_COMPILER_USE_VECTOR_ARITHMETICS</span></div><div class="line"><a name="l02187"></a><span class="lineno"> 2187</span>&#160;    data += vec.<a class="code" href="classVectorizedArray.html#ad38190d02537705964e021da7ecbab3f">data</a>;</div><div class="line"><a name="l02188"></a><span class="lineno"> 2188</span>&#160;<span class="preprocessor">#    else</span></div><div class="line"><a name="l02189"></a><span class="lineno"> 2189</span>&#160;    data = _mm256_add_pd(data, vec.<a class="code" href="classVectorizedArray.html#ad38190d02537705964e021da7ecbab3f">data</a>);</div><div class="line"><a name="l02190"></a><span class="lineno"> 2190</span>&#160;<span class="preprocessor">#    endif</span></div><div class="line"><a name="l02191"></a><span class="lineno"> 2191</span>&#160;    <span class="keywordflow">return</span> *<span class="keyword">this</span>;</div><div class="line"><a name="l02192"></a><span class="lineno"> 2192</span>&#160;  }</div><div class="line"><a name="l02193"></a><span class="lineno"> 2193</span>&#160;</div><div class="line"><a name="l02198"></a><span class="lineno"> 2198</span>&#160;  <a class="code" href="config_8h.html#a1d1d58e8be15e5c4285f6892e5f33136">DEAL_II_ALWAYS_INLINE</a></div><div class="line"><a name="l02199"></a><span class="lineno"> 2199</span>&#160;  <a class="code" href="classVectorizedArray.html">VectorizedArray</a> &amp;</div><div class="line"><a name="l02200"></a><span class="lineno"> 2200</span>&#160;  operator-=(<span class="keyword">const</span> <a class="code" href="classVectorizedArray.html">VectorizedArray</a> &amp;vec)</div><div class="line"><a name="l02201"></a><span class="lineno"> 2201</span>&#160;  {</div><div class="line"><a name="l02202"></a><span class="lineno"> 2202</span>&#160;<span class="preprocessor">#    ifdef DEAL_II_COMPILER_USE_VECTOR_ARITHMETICS</span></div><div class="line"><a name="l02203"></a><span class="lineno"> 2203</span>&#160;    data -= vec.<a class="code" href="classVectorizedArray.html#ad38190d02537705964e021da7ecbab3f">data</a>;</div><div class="line"><a name="l02204"></a><span class="lineno"> 2204</span>&#160;<span class="preprocessor">#    else</span></div><div class="line"><a name="l02205"></a><span class="lineno"> 2205</span>&#160;    data = _mm256_sub_pd(data, vec.<a class="code" href="classVectorizedArray.html#ad38190d02537705964e021da7ecbab3f">data</a>);</div><div class="line"><a name="l02206"></a><span class="lineno"> 2206</span>&#160;<span class="preprocessor">#    endif</span></div><div class="line"><a name="l02207"></a><span class="lineno"> 2207</span>&#160;    <span class="keywordflow">return</span> *<span class="keyword">this</span>;</div><div class="line"><a name="l02208"></a><span class="lineno"> 2208</span>&#160;  }</div><div class="line"><a name="l02213"></a><span class="lineno"> 2213</span>&#160;  <a class="code" href="config_8h.html#a1d1d58e8be15e5c4285f6892e5f33136">DEAL_II_ALWAYS_INLINE</a></div><div class="line"><a name="l02214"></a><span class="lineno"> 2214</span>&#160;  <a class="code" href="classVectorizedArray.html">VectorizedArray</a> &amp;</div><div class="line"><a name="l02215"></a><span class="lineno"> 2215</span>&#160;  operator*=(<span class="keyword">const</span> <a class="code" href="classVectorizedArray.html">VectorizedArray</a> &amp;vec)</div><div class="line"><a name="l02216"></a><span class="lineno"> 2216</span>&#160;  {</div><div class="line"><a name="l02217"></a><span class="lineno"> 2217</span>&#160;<span class="preprocessor">#    ifdef DEAL_II_COMPILER_USE_VECTOR_ARITHMETICS</span></div><div class="line"><a name="l02218"></a><span class="lineno"> 2218</span>&#160;    data *= vec.<a class="code" href="classVectorizedArray.html#ad38190d02537705964e021da7ecbab3f">data</a>;</div><div class="line"><a name="l02219"></a><span class="lineno"> 2219</span>&#160;<span class="preprocessor">#    else</span></div><div class="line"><a name="l02220"></a><span class="lineno"> 2220</span>&#160;    data = _mm256_mul_pd(data, vec.<a class="code" href="classVectorizedArray.html#ad38190d02537705964e021da7ecbab3f">data</a>);</div><div class="line"><a name="l02221"></a><span class="lineno"> 2221</span>&#160;<span class="preprocessor">#    endif</span></div><div class="line"><a name="l02222"></a><span class="lineno"> 2222</span>&#160;    <span class="keywordflow">return</span> *<span class="keyword">this</span>;</div><div class="line"><a name="l02223"></a><span class="lineno"> 2223</span>&#160;  }</div><div class="line"><a name="l02224"></a><span class="lineno"> 2224</span>&#160;</div><div class="line"><a name="l02229"></a><span class="lineno"> 2229</span>&#160;  <a class="code" href="config_8h.html#a1d1d58e8be15e5c4285f6892e5f33136">DEAL_II_ALWAYS_INLINE</a></div><div class="line"><a name="l02230"></a><span class="lineno"> 2230</span>&#160;  <a class="code" href="classVectorizedArray.html">VectorizedArray</a> &amp;</div><div class="line"><a name="l02231"></a><span class="lineno"> 2231</span>&#160;  operator/=(<span class="keyword">const</span> <a class="code" href="classVectorizedArray.html">VectorizedArray</a> &amp;vec)</div><div class="line"><a name="l02232"></a><span class="lineno"> 2232</span>&#160;  {</div><div class="line"><a name="l02233"></a><span class="lineno"> 2233</span>&#160;<span class="preprocessor">#    ifdef DEAL_II_COMPILER_USE_VECTOR_ARITHMETICS</span></div><div class="line"><a name="l02234"></a><span class="lineno"> 2234</span>&#160;    data /= vec.<a class="code" href="classVectorizedArray.html#ad38190d02537705964e021da7ecbab3f">data</a>;</div><div class="line"><a name="l02235"></a><span class="lineno"> 2235</span>&#160;<span class="preprocessor">#    else</span></div><div class="line"><a name="l02236"></a><span class="lineno"> 2236</span>&#160;    data = _mm256_div_pd(data, vec.<a class="code" href="classVectorizedArray.html#ad38190d02537705964e021da7ecbab3f">data</a>);</div><div class="line"><a name="l02237"></a><span class="lineno"> 2237</span>&#160;<span class="preprocessor">#    endif</span></div><div class="line"><a name="l02238"></a><span class="lineno"> 2238</span>&#160;    <span class="keywordflow">return</span> *<span class="keyword">this</span>;</div><div class="line"><a name="l02239"></a><span class="lineno"> 2239</span>&#160;  }</div><div class="line"><a name="l02240"></a><span class="lineno"> 2240</span>&#160;</div><div class="line"><a name="l02246"></a><span class="lineno"> 2246</span>&#160;  <a class="code" href="config_8h.html#a1d1d58e8be15e5c4285f6892e5f33136">DEAL_II_ALWAYS_INLINE</a></div><div class="line"><a name="l02247"></a><span class="lineno"> 2247</span>&#160;  <span class="keywordtype">void</span></div><div class="line"><a name="l02248"></a><span class="lineno"> 2248</span>&#160;  load(<span class="keyword">const</span> <span class="keywordtype">double</span> *ptr)</div><div class="line"><a name="l02249"></a><span class="lineno"> 2249</span>&#160;  {</div><div class="line"><a name="l02250"></a><span class="lineno"> 2250</span>&#160;    data = _mm256_loadu_pd(ptr);</div><div class="line"><a name="l02251"></a><span class="lineno"> 2251</span>&#160;  }</div><div class="line"><a name="l02252"></a><span class="lineno"> 2252</span>&#160;</div><div class="line"><a name="l02258"></a><span class="lineno"> 2258</span>&#160;  <a class="code" href="config_8h.html#a1d1d58e8be15e5c4285f6892e5f33136">DEAL_II_ALWAYS_INLINE</a></div><div class="line"><a name="l02259"></a><span class="lineno"> 2259</span>&#160;  <span class="keywordtype">void</span></div><div class="line"><a name="l02260"></a><span class="lineno"> 2260</span>&#160;  store(<span class="keywordtype">double</span> *ptr)<span class="keyword"> const</span></div><div class="line"><a name="l02261"></a><span class="lineno"> 2261</span>&#160;<span class="keyword">  </span>{</div><div class="line"><a name="l02262"></a><span class="lineno"> 2262</span>&#160;    _mm256_storeu_pd(ptr, data);</div><div class="line"><a name="l02263"></a><span class="lineno"> 2263</span>&#160;  }</div><div class="line"><a name="l02264"></a><span class="lineno"> 2264</span>&#160;</div><div class="line"><a name="l02270"></a><span class="lineno"> 2270</span>&#160;  <a class="code" href="config_8h.html#a1d1d58e8be15e5c4285f6892e5f33136">DEAL_II_ALWAYS_INLINE</a></div><div class="line"><a name="l02271"></a><span class="lineno"> 2271</span>&#160;  <span class="keywordtype">void</span></div><div class="line"><a name="l02272"></a><span class="lineno"> 2272</span>&#160;  streaming_store(<span class="keywordtype">double</span> *ptr)<span class="keyword"> const</span></div><div class="line"><a name="l02273"></a><span class="lineno"> 2273</span>&#160;<span class="keyword">  </span>{</div><div class="line"><a name="l02274"></a><span class="lineno"> 2274</span>&#160;    <a class="code" href="group__Exceptions.html#ga70a0bb353656e704acf927945277bbc6">Assert</a>(reinterpret_cast&lt;std::size_t&gt;(ptr) % 32 == 0,</div><div class="line"><a name="l02275"></a><span class="lineno"> 2275</span>&#160;           <a class="code" href="group__Exceptions.html#gae9a45f517af1401c50811a11083f9114">ExcMessage</a>(<span class="stringliteral">&quot;Memory not aligned&quot;</span>));</div><div class="line"><a name="l02276"></a><span class="lineno"> 2276</span>&#160;    _mm256_stream_pd(ptr, data);</div><div class="line"><a name="l02277"></a><span class="lineno"> 2277</span>&#160;  }</div><div class="line"><a name="l02278"></a><span class="lineno"> 2278</span>&#160;</div><div class="line"><a name="l02289"></a><span class="lineno"> 2289</span>&#160;  <a class="code" href="config_8h.html#a1d1d58e8be15e5c4285f6892e5f33136">DEAL_II_ALWAYS_INLINE</a></div><div class="line"><a name="l02290"></a><span class="lineno"> 2290</span>&#160;  <span class="keywordtype">void</span></div><div class="line"><a name="l02291"></a><span class="lineno"> 2291</span>&#160;  <a class="code" href="vectorization_8h.html#a078ca5de8d3a59aedc130823be15ad26">gather</a>(<span class="keyword">const</span> <span class="keywordtype">double</span> *base_ptr, <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> *offsets)</div><div class="line"><a name="l02292"></a><span class="lineno"> 2292</span>&#160;  {</div><div class="line"><a name="l02293"></a><span class="lineno"> 2293</span>&#160;<span class="preprocessor">#    ifdef __AVX2__</span></div><div class="line"><a name="l02294"></a><span class="lineno"> 2294</span>&#160;    <span class="comment">// unfortunately, there does not appear to be a 128 bit integer load, so</span></div><div class="line"><a name="l02295"></a><span class="lineno"> 2295</span>&#160;    <span class="comment">// do it by some reinterpret casts here. this is allowed because the Intel</span></div><div class="line"><a name="l02296"></a><span class="lineno"> 2296</span>&#160;    <span class="comment">// API allows aliasing between different vector types.</span></div><div class="line"><a name="l02297"></a><span class="lineno"> 2297</span>&#160;    <span class="keyword">const</span> __m128 index_val =</div><div class="line"><a name="l02298"></a><span class="lineno"> 2298</span>&#160;      _mm_loadu_ps(reinterpret_cast&lt;const float *&gt;(offsets));</div><div class="line"><a name="l02299"></a><span class="lineno"> 2299</span>&#160;    <span class="keyword">const</span> __m128i index = *<span class="keyword">reinterpret_cast&lt;</span><span class="keyword">const </span>__m128i *<span class="keyword">&gt;</span>(&amp;index_val);</div><div class="line"><a name="l02300"></a><span class="lineno"> 2300</span>&#160;    data                = _mm256_i32gather_pd(base_ptr, index, 8);</div><div class="line"><a name="l02301"></a><span class="lineno"> 2301</span>&#160;<span class="preprocessor">#    else</span></div><div class="line"><a name="l02302"></a><span class="lineno"> 2302</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i = 0; i &lt; 4; ++i)</div><div class="line"><a name="l02303"></a><span class="lineno"> 2303</span>&#160;      *(reinterpret_cast&lt;double *&gt;(&amp;data) + i) = base_ptr[offsets[i]];</div><div class="line"><a name="l02304"></a><span class="lineno"> 2304</span>&#160;<span class="preprocessor">#    endif</span></div><div class="line"><a name="l02305"></a><span class="lineno"> 2305</span>&#160;  }</div><div class="line"><a name="l02306"></a><span class="lineno"> 2306</span>&#160;</div><div class="line"><a name="l02318"></a><span class="lineno"> 2318</span>&#160;  <a class="code" href="config_8h.html#a1d1d58e8be15e5c4285f6892e5f33136">DEAL_II_ALWAYS_INLINE</a></div><div class="line"><a name="l02319"></a><span class="lineno"> 2319</span>&#160;  <span class="keywordtype">void</span></div><div class="line"><a name="l02320"></a><span class="lineno"> 2320</span>&#160;  scatter(<span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> *offsets, <span class="keywordtype">double</span> *base_ptr)<span class="keyword"> const</span></div><div class="line"><a name="l02321"></a><span class="lineno"> 2321</span>&#160;<span class="keyword">  </span>{</div><div class="line"><a name="l02322"></a><span class="lineno"> 2322</span>&#160;    <span class="comment">// no scatter operation in AVX/AVX2</span></div><div class="line"><a name="l02323"></a><span class="lineno"> 2323</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i = 0; i &lt; 4; ++i)</div><div class="line"><a name="l02324"></a><span class="lineno"> 2324</span>&#160;      base_ptr[offsets[i]] = *(reinterpret_cast&lt;const double *&gt;(&amp;data) + i);</div><div class="line"><a name="l02325"></a><span class="lineno"> 2325</span>&#160;  }</div><div class="line"><a name="l02326"></a><span class="lineno"> 2326</span>&#160;</div><div class="line"><a name="l02331"></a><span class="lineno"> 2331</span>&#160;  __m256d data;</div><div class="line"><a name="l02332"></a><span class="lineno"> 2332</span>&#160;</div><div class="line"><a name="l02333"></a><span class="lineno"> 2333</span>&#160;<span class="keyword">private</span>:</div><div class="line"><a name="l02338"></a><span class="lineno"> 2338</span>&#160;  <a class="code" href="config_8h.html#a1d1d58e8be15e5c4285f6892e5f33136">DEAL_II_ALWAYS_INLINE</a></div><div class="line"><a name="l02339"></a><span class="lineno"> 2339</span>&#160;  <a class="code" href="classVectorizedArray.html">VectorizedArray</a></div><div class="line"><a name="l02340"></a><span class="lineno"> 2340</span>&#160;  get_sqrt()<span class="keyword"> const</span></div><div class="line"><a name="l02341"></a><span class="lineno"> 2341</span>&#160;<span class="keyword">  </span>{</div><div class="line"><a name="l02342"></a><span class="lineno"> 2342</span>&#160;    <a class="code" href="classVectorizedArray.html">VectorizedArray</a> res;</div><div class="line"><a name="l02343"></a><span class="lineno"> 2343</span>&#160;    res.<a class="code" href="classVectorizedArray.html#ad38190d02537705964e021da7ecbab3f">data</a> = _mm256_sqrt_pd(data);</div><div class="line"><a name="l02344"></a><span class="lineno"> 2344</span>&#160;    <span class="keywordflow">return</span> res;</div><div class="line"><a name="l02345"></a><span class="lineno"> 2345</span>&#160;  }</div><div class="line"><a name="l02346"></a><span class="lineno"> 2346</span>&#160;</div><div class="line"><a name="l02351"></a><span class="lineno"> 2351</span>&#160;  <a class="code" href="config_8h.html#a1d1d58e8be15e5c4285f6892e5f33136">DEAL_II_ALWAYS_INLINE</a></div><div class="line"><a name="l02352"></a><span class="lineno"> 2352</span>&#160;  <a class="code" href="classVectorizedArray.html">VectorizedArray</a></div><div class="line"><a name="l02353"></a><span class="lineno"> 2353</span>&#160;  get_abs()<span class="keyword"> const</span></div><div class="line"><a name="l02354"></a><span class="lineno"> 2354</span>&#160;<span class="keyword">  </span>{</div><div class="line"><a name="l02355"></a><span class="lineno"> 2355</span>&#160;    <span class="comment">// to compute the absolute value, perform bitwise andnot with -0. This</span></div><div class="line"><a name="l02356"></a><span class="lineno"> 2356</span>&#160;    <span class="comment">// will leave all value and exponent bits unchanged but force the sign</span></div><div class="line"><a name="l02357"></a><span class="lineno"> 2357</span>&#160;    <span class="comment">// value to +.</span></div><div class="line"><a name="l02358"></a><span class="lineno"> 2358</span>&#160;    __m256d         mask = _mm256_set1_pd(-0.);</div><div class="line"><a name="l02359"></a><span class="lineno"> 2359</span>&#160;    <a class="code" href="classVectorizedArray.html">VectorizedArray</a> res;</div><div class="line"><a name="l02360"></a><span class="lineno"> 2360</span>&#160;    res.<a class="code" href="classVectorizedArray.html#ad38190d02537705964e021da7ecbab3f">data</a> = _mm256_andnot_pd(mask, data);</div><div class="line"><a name="l02361"></a><span class="lineno"> 2361</span>&#160;    <span class="keywordflow">return</span> res;</div><div class="line"><a name="l02362"></a><span class="lineno"> 2362</span>&#160;  }</div><div class="line"><a name="l02363"></a><span class="lineno"> 2363</span>&#160;</div><div class="line"><a name="l02368"></a><span class="lineno"> 2368</span>&#160;  <a class="code" href="config_8h.html#a1d1d58e8be15e5c4285f6892e5f33136">DEAL_II_ALWAYS_INLINE</a></div><div class="line"><a name="l02369"></a><span class="lineno"> 2369</span>&#160;  <a class="code" href="classVectorizedArray.html">VectorizedArray</a></div><div class="line"><a name="l02370"></a><span class="lineno"> 2370</span>&#160;  get_max(<span class="keyword">const</span> <a class="code" href="classVectorizedArray.html">VectorizedArray</a> &amp;other)<span class="keyword"> const</span></div><div class="line"><a name="l02371"></a><span class="lineno"> 2371</span>&#160;<span class="keyword">  </span>{</div><div class="line"><a name="l02372"></a><span class="lineno"> 2372</span>&#160;    <a class="code" href="classVectorizedArray.html">VectorizedArray</a> res;</div><div class="line"><a name="l02373"></a><span class="lineno"> 2373</span>&#160;    res.<a class="code" href="classVectorizedArray.html#ad38190d02537705964e021da7ecbab3f">data</a> = _mm256_max_pd(data, other.<a class="code" href="classVectorizedArray.html#ad38190d02537705964e021da7ecbab3f">data</a>);</div><div class="line"><a name="l02374"></a><span class="lineno"> 2374</span>&#160;    <span class="keywordflow">return</span> res;</div><div class="line"><a name="l02375"></a><span class="lineno"> 2375</span>&#160;  }</div><div class="line"><a name="l02376"></a><span class="lineno"> 2376</span>&#160;</div><div class="line"><a name="l02381"></a><span class="lineno"> 2381</span>&#160;  <a class="code" href="config_8h.html#a1d1d58e8be15e5c4285f6892e5f33136">DEAL_II_ALWAYS_INLINE</a></div><div class="line"><a name="l02382"></a><span class="lineno"> 2382</span>&#160;  <a class="code" href="classVectorizedArray.html">VectorizedArray</a></div><div class="line"><a name="l02383"></a><span class="lineno"> 2383</span>&#160;  get_min(<span class="keyword">const</span> <a class="code" href="classVectorizedArray.html">VectorizedArray</a> &amp;other)<span class="keyword"> const</span></div><div class="line"><a name="l02384"></a><span class="lineno"> 2384</span>&#160;<span class="keyword">  </span>{</div><div class="line"><a name="l02385"></a><span class="lineno"> 2385</span>&#160;    <a class="code" href="classVectorizedArray.html">VectorizedArray</a> res;</div><div class="line"><a name="l02386"></a><span class="lineno"> 2386</span>&#160;    res.<a class="code" href="classVectorizedArray.html#ad38190d02537705964e021da7ecbab3f">data</a> = _mm256_min_pd(data, other.<a class="code" href="classVectorizedArray.html#ad38190d02537705964e021da7ecbab3f">data</a>);</div><div class="line"><a name="l02387"></a><span class="lineno"> 2387</span>&#160;    <span class="keywordflow">return</span> res;</div><div class="line"><a name="l02388"></a><span class="lineno"> 2388</span>&#160;  }</div><div class="line"><a name="l02389"></a><span class="lineno"> 2389</span>&#160;</div><div class="line"><a name="l02390"></a><span class="lineno"> 2390</span>&#160;  <span class="comment">// Make a few functions friends.</span></div><div class="line"><a name="l02391"></a><span class="lineno"> 2391</span>&#160;  <span class="keyword">template</span> &lt;<span class="keyword">typename</span> Number2, std::<span class="keywordtype">size_t</span> w<span class="keywordtype">id</span>th2&gt;</div><div class="line"><a name="l02392"></a><span class="lineno"> 2392</span>&#160;  <span class="keyword">friend</span> <a class="code" href="classVectorizedArray.html">VectorizedArray&lt;Number2, width2&gt;</a></div><div class="line"><a name="l02393"></a><span class="lineno"> 2393</span>&#160;  std::sqrt(<span class="keyword">const</span> <a class="code" href="classVectorizedArray.html">VectorizedArray&lt;Number2, width2&gt;</a> &amp;);</div><div class="line"><a name="l02394"></a><span class="lineno"> 2394</span>&#160;  <span class="keyword">template</span> &lt;<span class="keyword">typename</span> Number2, std::<span class="keywordtype">size_t</span> w<span class="keywordtype">id</span>th2&gt;</div><div class="line"><a name="l02395"></a><span class="lineno"> 2395</span>&#160;  <span class="keyword">friend</span> <a class="code" href="classVectorizedArray.html">VectorizedArray&lt;Number2, width2&gt;</a></div><div class="line"><a name="l02396"></a><span class="lineno"> 2396</span>&#160;  std::abs(<span class="keyword">const</span> <a class="code" href="classVectorizedArray.html">VectorizedArray&lt;Number2, width2&gt;</a> &amp;);</div><div class="line"><a name="l02397"></a><span class="lineno"> 2397</span>&#160;  <span class="keyword">template</span> &lt;<span class="keyword">typename</span> Number2, std::<span class="keywordtype">size_t</span> w<span class="keywordtype">id</span>th2&gt;</div><div class="line"><a name="l02398"></a><span class="lineno"> 2398</span>&#160;  <span class="keyword">friend</span> <a class="code" href="classVectorizedArray.html">VectorizedArray&lt;Number2, width2&gt;</a></div><div class="line"><a name="l02399"></a><span class="lineno"> 2399</span>&#160;  std::max(<span class="keyword">const</span> <a class="code" href="classVectorizedArray.html">VectorizedArray&lt;Number2, width2&gt;</a> &amp;,</div><div class="line"><a name="l02400"></a><span class="lineno"> 2400</span>&#160;           <span class="keyword">const</span> <a class="code" href="classVectorizedArray.html">VectorizedArray&lt;Number2, width2&gt;</a> &amp;);</div><div class="line"><a name="l02401"></a><span class="lineno"> 2401</span>&#160;  <span class="keyword">template</span> &lt;<span class="keyword">typename</span> Number2, std::<span class="keywordtype">size_t</span> w<span class="keywordtype">id</span>th2&gt;</div><div class="line"><a name="l02402"></a><span class="lineno"> 2402</span>&#160;  <span class="keyword">friend</span> <a class="code" href="classVectorizedArray.html">VectorizedArray&lt;Number2, width2&gt;</a></div><div class="line"><a name="l02403"></a><span class="lineno"> 2403</span>&#160;  std::min(<span class="keyword">const</span> <a class="code" href="classVectorizedArray.html">VectorizedArray&lt;Number2, width2&gt;</a> &amp;,</div><div class="line"><a name="l02404"></a><span class="lineno"> 2404</span>&#160;           <span class="keyword">const</span> <a class="code" href="classVectorizedArray.html">VectorizedArray&lt;Number2, width2&gt;</a> &amp;);</div><div class="line"><a name="l02405"></a><span class="lineno"> 2405</span>&#160;};</div><div class="line"><a name="l02406"></a><span class="lineno"> 2406</span>&#160;</div><div class="line"><a name="l02407"></a><span class="lineno"> 2407</span>&#160;</div><div class="line"><a name="l02408"></a><span class="lineno"> 2408</span>&#160;</div><div class="line"><a name="l02414"></a><span class="lineno"> 2414</span>&#160;<span class="keyword">template</span> &lt;&gt;</div><div class="line"><a name="l02415"></a><span class="lineno"> 2415</span>&#160;<span class="keyword">inline</span> <a class="code" href="config_8h.html#a1d1d58e8be15e5c4285f6892e5f33136">DEAL_II_ALWAYS_INLINE</a> <span class="keywordtype">void</span></div><div class="line"><a name="l02416"></a><span class="lineno"> 2416</span>&#160;<a class="code" href="vectorization_8h.html#a14da4327264fd3a88a9f73a8f72a9094">vectorized_load_and_transpose</a>(<span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span>          n_entries,</div><div class="line"><a name="l02417"></a><span class="lineno"> 2417</span>&#160;                              <span class="keyword">const</span> <span class="keywordtype">double</span> *              in,</div><div class="line"><a name="l02418"></a><span class="lineno"> 2418</span>&#160;                              <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> *        offsets,</div><div class="line"><a name="l02419"></a><span class="lineno"> 2419</span>&#160;                              <a class="code" href="classVectorizedArray.html">VectorizedArray&lt;double, 4&gt;</a> *out)</div><div class="line"><a name="l02420"></a><span class="lineno"> 2420</span>&#160;{</div><div class="line"><a name="l02421"></a><span class="lineno"> 2421</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> n_chunks = n_entries / 4;</div><div class="line"><a name="l02422"></a><span class="lineno"> 2422</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">double</span> *     in0      = in + offsets[0];</div><div class="line"><a name="l02423"></a><span class="lineno"> 2423</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">double</span> *     in1      = in + offsets[1];</div><div class="line"><a name="l02424"></a><span class="lineno"> 2424</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">double</span> *     in2      = in + offsets[2];</div><div class="line"><a name="l02425"></a><span class="lineno"> 2425</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">double</span> *     in3      = in + offsets[3];</div><div class="line"><a name="l02426"></a><span class="lineno"> 2426</span>&#160;</div><div class="line"><a name="l02427"></a><span class="lineno"> 2427</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i = 0; i &lt; n_chunks; ++i)</div><div class="line"><a name="l02428"></a><span class="lineno"> 2428</span>&#160;    {</div><div class="line"><a name="l02429"></a><span class="lineno"> 2429</span>&#160;      __m256d u0          = _mm256_loadu_pd(in0 + 4 * i);</div><div class="line"><a name="l02430"></a><span class="lineno"> 2430</span>&#160;      __m256d u1          = _mm256_loadu_pd(in1 + 4 * i);</div><div class="line"><a name="l02431"></a><span class="lineno"> 2431</span>&#160;      __m256d u2          = _mm256_loadu_pd(in2 + 4 * i);</div><div class="line"><a name="l02432"></a><span class="lineno"> 2432</span>&#160;      __m256d u3          = _mm256_loadu_pd(in3 + 4 * i);</div><div class="line"><a name="l02433"></a><span class="lineno"> 2433</span>&#160;      __m256d t0          = _mm256_permute2f128_pd(u0, u2, 0x20);</div><div class="line"><a name="l02434"></a><span class="lineno"> 2434</span>&#160;      __m256d t1          = _mm256_permute2f128_pd(u1, u3, 0x20);</div><div class="line"><a name="l02435"></a><span class="lineno"> 2435</span>&#160;      __m256d t2          = _mm256_permute2f128_pd(u0, u2, 0x31);</div><div class="line"><a name="l02436"></a><span class="lineno"> 2436</span>&#160;      __m256d t3          = _mm256_permute2f128_pd(u1, u3, 0x31);</div><div class="line"><a name="l02437"></a><span class="lineno"> 2437</span>&#160;      out[4 * i + 0].<a class="code" href="classVectorizedArray.html#ad38190d02537705964e021da7ecbab3f">data</a> = _mm256_unpacklo_pd(t0, t1);</div><div class="line"><a name="l02438"></a><span class="lineno"> 2438</span>&#160;      out[4 * i + 1].<a class="code" href="classVectorizedArray.html#ad38190d02537705964e021da7ecbab3f">data</a> = _mm256_unpackhi_pd(t0, t1);</div><div class="line"><a name="l02439"></a><span class="lineno"> 2439</span>&#160;      out[4 * i + 2].<a class="code" href="classVectorizedArray.html#ad38190d02537705964e021da7ecbab3f">data</a> = _mm256_unpacklo_pd(t2, t3);</div><div class="line"><a name="l02440"></a><span class="lineno"> 2440</span>&#160;      out[4 * i + 3].<a class="code" href="classVectorizedArray.html#ad38190d02537705964e021da7ecbab3f">data</a> = _mm256_unpackhi_pd(t2, t3);</div><div class="line"><a name="l02441"></a><span class="lineno"> 2441</span>&#160;    }</div><div class="line"><a name="l02442"></a><span class="lineno"> 2442</span>&#160;</div><div class="line"><a name="l02443"></a><span class="lineno"> 2443</span>&#160;  <span class="comment">// remainder loop of work that does not divide by 4</span></div><div class="line"><a name="l02444"></a><span class="lineno"> 2444</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i = 4 * n_chunks; i &lt; n_entries; ++i)</div><div class="line"><a name="l02445"></a><span class="lineno"> 2445</span>&#160;    out[i].<a class="code" href="vectorization_8h.html#a078ca5de8d3a59aedc130823be15ad26">gather</a>(in + i, offsets);</div><div class="line"><a name="l02446"></a><span class="lineno"> 2446</span>&#160;}</div><div class="line"><a name="l02447"></a><span class="lineno"> 2447</span>&#160;</div><div class="line"><a name="l02448"></a><span class="lineno"> 2448</span>&#160;</div><div class="line"><a name="l02449"></a><span class="lineno"> 2449</span>&#160;</div><div class="line"><a name="l02455"></a><span class="lineno"> 2455</span>&#160;<span class="keyword">template</span> &lt;&gt;</div><div class="line"><a name="l02456"></a><span class="lineno"> 2456</span>&#160;<span class="keyword">inline</span> <a class="code" href="config_8h.html#a1d1d58e8be15e5c4285f6892e5f33136">DEAL_II_ALWAYS_INLINE</a> <span class="keywordtype">void</span></div><div class="line"><a name="l02457"></a><span class="lineno"> 2457</span>&#160;<a class="code" href="vectorization_8h.html#a14da4327264fd3a88a9f73a8f72a9094">vectorized_load_and_transpose</a>(<span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span>             n_entries,</div><div class="line"><a name="l02458"></a><span class="lineno"> 2458</span>&#160;                              <span class="keyword">const</span> std::array&lt;double *, 4&gt; &amp;in,</div><div class="line"><a name="l02459"></a><span class="lineno"> 2459</span>&#160;                              <a class="code" href="classVectorizedArray.html">VectorizedArray&lt;double, 4&gt;</a> *   out)</div><div class="line"><a name="l02460"></a><span class="lineno"> 2460</span>&#160;{</div><div class="line"><a name="l02461"></a><span class="lineno"> 2461</span>&#160;  <span class="comment">// see the comments in the vectorized_load_and_transpose above</span></div><div class="line"><a name="l02462"></a><span class="lineno"> 2462</span>&#160;</div><div class="line"><a name="l02463"></a><span class="lineno"> 2463</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> n_chunks = n_entries / 4;</div><div class="line"><a name="l02464"></a><span class="lineno"> 2464</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">double</span> *     in0      = in[0];</div><div class="line"><a name="l02465"></a><span class="lineno"> 2465</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">double</span> *     in1      = in[1];</div><div class="line"><a name="l02466"></a><span class="lineno"> 2466</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">double</span> *     in2      = in[2];</div><div class="line"><a name="l02467"></a><span class="lineno"> 2467</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">double</span> *     in3      = in[3];</div><div class="line"><a name="l02468"></a><span class="lineno"> 2468</span>&#160;</div><div class="line"><a name="l02469"></a><span class="lineno"> 2469</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i = 0; i &lt; n_chunks; ++i)</div><div class="line"><a name="l02470"></a><span class="lineno"> 2470</span>&#160;    {</div><div class="line"><a name="l02471"></a><span class="lineno"> 2471</span>&#160;      __m256d u0          = _mm256_loadu_pd(in0 + 4 * i);</div><div class="line"><a name="l02472"></a><span class="lineno"> 2472</span>&#160;      __m256d u1          = _mm256_loadu_pd(in1 + 4 * i);</div><div class="line"><a name="l02473"></a><span class="lineno"> 2473</span>&#160;      __m256d u2          = _mm256_loadu_pd(in2 + 4 * i);</div><div class="line"><a name="l02474"></a><span class="lineno"> 2474</span>&#160;      __m256d u3          = _mm256_loadu_pd(in3 + 4 * i);</div><div class="line"><a name="l02475"></a><span class="lineno"> 2475</span>&#160;      __m256d t0          = _mm256_permute2f128_pd(u0, u2, 0x20);</div><div class="line"><a name="l02476"></a><span class="lineno"> 2476</span>&#160;      __m256d t1          = _mm256_permute2f128_pd(u1, u3, 0x20);</div><div class="line"><a name="l02477"></a><span class="lineno"> 2477</span>&#160;      __m256d t2          = _mm256_permute2f128_pd(u0, u2, 0x31);</div><div class="line"><a name="l02478"></a><span class="lineno"> 2478</span>&#160;      __m256d t3          = _mm256_permute2f128_pd(u1, u3, 0x31);</div><div class="line"><a name="l02479"></a><span class="lineno"> 2479</span>&#160;      out[4 * i + 0].<a class="code" href="classVectorizedArray.html#ad38190d02537705964e021da7ecbab3f">data</a> = _mm256_unpacklo_pd(t0, t1);</div><div class="line"><a name="l02480"></a><span class="lineno"> 2480</span>&#160;      out[4 * i + 1].<a class="code" href="classVectorizedArray.html#ad38190d02537705964e021da7ecbab3f">data</a> = _mm256_unpackhi_pd(t0, t1);</div><div class="line"><a name="l02481"></a><span class="lineno"> 2481</span>&#160;      out[4 * i + 2].<a class="code" href="classVectorizedArray.html#ad38190d02537705964e021da7ecbab3f">data</a> = _mm256_unpacklo_pd(t2, t3);</div><div class="line"><a name="l02482"></a><span class="lineno"> 2482</span>&#160;      out[4 * i + 3].<a class="code" href="classVectorizedArray.html#ad38190d02537705964e021da7ecbab3f">data</a> = _mm256_unpackhi_pd(t2, t3);</div><div class="line"><a name="l02483"></a><span class="lineno"> 2483</span>&#160;    }</div><div class="line"><a name="l02484"></a><span class="lineno"> 2484</span>&#160;</div><div class="line"><a name="l02485"></a><span class="lineno"> 2485</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i = 4 * n_chunks; i &lt; n_entries; ++i)</div><div class="line"><a name="l02486"></a><span class="lineno"> 2486</span>&#160;    <a class="code" href="vectorization_8h.html#a078ca5de8d3a59aedc130823be15ad26">gather</a>(out[i], in, i);</div><div class="line"><a name="l02487"></a><span class="lineno"> 2487</span>&#160;}</div><div class="line"><a name="l02488"></a><span class="lineno"> 2488</span>&#160;</div><div class="line"><a name="l02489"></a><span class="lineno"> 2489</span>&#160;</div><div class="line"><a name="l02490"></a><span class="lineno"> 2490</span>&#160;</div><div class="line"><a name="l02496"></a><span class="lineno"> 2496</span>&#160;<span class="keyword">template</span> &lt;&gt;</div><div class="line"><a name="l02497"></a><span class="lineno"> 2497</span>&#160;<span class="keyword">inline</span> <a class="code" href="config_8h.html#a1d1d58e8be15e5c4285f6892e5f33136">DEAL_II_ALWAYS_INLINE</a> <span class="keywordtype">void</span></div><div class="line"><a name="l02498"></a><span class="lineno"> 2498</span>&#160;<a class="code" href="vectorization_8h.html#af396b43c783502e8acd2ca7d071a7325">vectorized_transpose_and_store</a>(<span class="keyword">const</span> <span class="keywordtype">bool</span>                        add_into,</div><div class="line"><a name="l02499"></a><span class="lineno"> 2499</span>&#160;                               <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span>                n_entries,</div><div class="line"><a name="l02500"></a><span class="lineno"> 2500</span>&#160;                               <span class="keyword">const</span> <a class="code" href="classVectorizedArray.html">VectorizedArray&lt;double, 4&gt;</a> *in,</div><div class="line"><a name="l02501"></a><span class="lineno"> 2501</span>&#160;                               <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> *              offsets,</div><div class="line"><a name="l02502"></a><span class="lineno"> 2502</span>&#160;                               <span class="keywordtype">double</span> *                          out)</div><div class="line"><a name="l02503"></a><span class="lineno"> 2503</span>&#160;{</div><div class="line"><a name="l02504"></a><span class="lineno"> 2504</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> n_chunks = n_entries / 4;</div><div class="line"><a name="l02505"></a><span class="lineno"> 2505</span>&#160;  <span class="keywordtype">double</span> *           out0     = out + offsets[0];</div><div class="line"><a name="l02506"></a><span class="lineno"> 2506</span>&#160;  <span class="keywordtype">double</span> *           out1     = out + offsets[1];</div><div class="line"><a name="l02507"></a><span class="lineno"> 2507</span>&#160;  <span class="keywordtype">double</span> *           out2     = out + offsets[2];</div><div class="line"><a name="l02508"></a><span class="lineno"> 2508</span>&#160;  <span class="keywordtype">double</span> *           out3     = out + offsets[3];</div><div class="line"><a name="l02509"></a><span class="lineno"> 2509</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i = 0; i &lt; n_chunks; ++i)</div><div class="line"><a name="l02510"></a><span class="lineno"> 2510</span>&#160;    {</div><div class="line"><a name="l02511"></a><span class="lineno"> 2511</span>&#160;      __m256d u0   = in[4 * i + 0].<a class="code" href="classVectorizedArray.html#ad38190d02537705964e021da7ecbab3f">data</a>;</div><div class="line"><a name="l02512"></a><span class="lineno"> 2512</span>&#160;      __m256d u1   = in[4 * i + 1].<a class="code" href="classVectorizedArray.html#ad38190d02537705964e021da7ecbab3f">data</a>;</div><div class="line"><a name="l02513"></a><span class="lineno"> 2513</span>&#160;      __m256d u2   = in[4 * i + 2].<a class="code" href="classVectorizedArray.html#ad38190d02537705964e021da7ecbab3f">data</a>;</div><div class="line"><a name="l02514"></a><span class="lineno"> 2514</span>&#160;      __m256d u3   = in[4 * i + 3].<a class="code" href="classVectorizedArray.html#ad38190d02537705964e021da7ecbab3f">data</a>;</div><div class="line"><a name="l02515"></a><span class="lineno"> 2515</span>&#160;      __m256d t0   = _mm256_permute2f128_pd(u0, u2, 0x20);</div><div class="line"><a name="l02516"></a><span class="lineno"> 2516</span>&#160;      __m256d t1   = _mm256_permute2f128_pd(u1, u3, 0x20);</div><div class="line"><a name="l02517"></a><span class="lineno"> 2517</span>&#160;      __m256d t2   = _mm256_permute2f128_pd(u0, u2, 0x31);</div><div class="line"><a name="l02518"></a><span class="lineno"> 2518</span>&#160;      __m256d t3   = _mm256_permute2f128_pd(u1, u3, 0x31);</div><div class="line"><a name="l02519"></a><span class="lineno"> 2519</span>&#160;      __m256d res0 = _mm256_unpacklo_pd(t0, t1);</div><div class="line"><a name="l02520"></a><span class="lineno"> 2520</span>&#160;      __m256d res1 = _mm256_unpackhi_pd(t0, t1);</div><div class="line"><a name="l02521"></a><span class="lineno"> 2521</span>&#160;      __m256d res2 = _mm256_unpacklo_pd(t2, t3);</div><div class="line"><a name="l02522"></a><span class="lineno"> 2522</span>&#160;      __m256d res3 = _mm256_unpackhi_pd(t2, t3);</div><div class="line"><a name="l02523"></a><span class="lineno"> 2523</span>&#160;</div><div class="line"><a name="l02524"></a><span class="lineno"> 2524</span>&#160;      <span class="comment">// Cannot use the same store instructions in both paths of the &#39;if&#39;</span></div><div class="line"><a name="l02525"></a><span class="lineno"> 2525</span>&#160;      <span class="comment">// because the compiler cannot know that there is no aliasing between</span></div><div class="line"><a name="l02526"></a><span class="lineno"> 2526</span>&#160;      <span class="comment">// pointers</span></div><div class="line"><a name="l02527"></a><span class="lineno"> 2527</span>&#160;      <span class="keywordflow">if</span> (add_into)</div><div class="line"><a name="l02528"></a><span class="lineno"> 2528</span>&#160;        {</div><div class="line"><a name="l02529"></a><span class="lineno"> 2529</span>&#160;          res0 = _mm256_add_pd(_mm256_loadu_pd(out0 + 4 * i), res0);</div><div class="line"><a name="l02530"></a><span class="lineno"> 2530</span>&#160;          _mm256_storeu_pd(out0 + 4 * i, res0);</div><div class="line"><a name="l02531"></a><span class="lineno"> 2531</span>&#160;          res1 = _mm256_add_pd(_mm256_loadu_pd(out1 + 4 * i), res1);</div><div class="line"><a name="l02532"></a><span class="lineno"> 2532</span>&#160;          _mm256_storeu_pd(out1 + 4 * i, res1);</div><div class="line"><a name="l02533"></a><span class="lineno"> 2533</span>&#160;          res2 = _mm256_add_pd(_mm256_loadu_pd(out2 + 4 * i), res2);</div><div class="line"><a name="l02534"></a><span class="lineno"> 2534</span>&#160;          _mm256_storeu_pd(out2 + 4 * i, res2);</div><div class="line"><a name="l02535"></a><span class="lineno"> 2535</span>&#160;          res3 = _mm256_add_pd(_mm256_loadu_pd(out3 + 4 * i), res3);</div><div class="line"><a name="l02536"></a><span class="lineno"> 2536</span>&#160;          _mm256_storeu_pd(out3 + 4 * i, res3);</div><div class="line"><a name="l02537"></a><span class="lineno"> 2537</span>&#160;        }</div><div class="line"><a name="l02538"></a><span class="lineno"> 2538</span>&#160;      <span class="keywordflow">else</span></div><div class="line"><a name="l02539"></a><span class="lineno"> 2539</span>&#160;        {</div><div class="line"><a name="l02540"></a><span class="lineno"> 2540</span>&#160;          _mm256_storeu_pd(out0 + 4 * i, res0);</div><div class="line"><a name="l02541"></a><span class="lineno"> 2541</span>&#160;          _mm256_storeu_pd(out1 + 4 * i, res1);</div><div class="line"><a name="l02542"></a><span class="lineno"> 2542</span>&#160;          _mm256_storeu_pd(out2 + 4 * i, res2);</div><div class="line"><a name="l02543"></a><span class="lineno"> 2543</span>&#160;          _mm256_storeu_pd(out3 + 4 * i, res3);</div><div class="line"><a name="l02544"></a><span class="lineno"> 2544</span>&#160;        }</div><div class="line"><a name="l02545"></a><span class="lineno"> 2545</span>&#160;    }</div><div class="line"><a name="l02546"></a><span class="lineno"> 2546</span>&#160;</div><div class="line"><a name="l02547"></a><span class="lineno"> 2547</span>&#160;  <span class="comment">// remainder loop of work that does not divide by 4</span></div><div class="line"><a name="l02548"></a><span class="lineno"> 2548</span>&#160;  <span class="keywordflow">if</span> (add_into)</div><div class="line"><a name="l02549"></a><span class="lineno"> 2549</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i = 4 * n_chunks; i &lt; n_entries; ++i)</div><div class="line"><a name="l02550"></a><span class="lineno"> 2550</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> v = 0; v &lt; 4; ++v)</div><div class="line"><a name="l02551"></a><span class="lineno"> 2551</span>&#160;        out[offsets[v] + i] += in[i][v];</div><div class="line"><a name="l02552"></a><span class="lineno"> 2552</span>&#160;  <span class="keywordflow">else</span></div><div class="line"><a name="l02553"></a><span class="lineno"> 2553</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i = 4 * n_chunks; i &lt; n_entries; ++i)</div><div class="line"><a name="l02554"></a><span class="lineno"> 2554</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> v = 0; v &lt; 4; ++v)</div><div class="line"><a name="l02555"></a><span class="lineno"> 2555</span>&#160;        out[offsets[v] + i] = in[i][v];</div><div class="line"><a name="l02556"></a><span class="lineno"> 2556</span>&#160;}</div><div class="line"><a name="l02557"></a><span class="lineno"> 2557</span>&#160;</div><div class="line"><a name="l02558"></a><span class="lineno"> 2558</span>&#160;</div><div class="line"><a name="l02559"></a><span class="lineno"> 2559</span>&#160;</div><div class="line"><a name="l02565"></a><span class="lineno"> 2565</span>&#160;<span class="keyword">template</span> &lt;&gt;</div><div class="line"><a name="l02566"></a><span class="lineno"> 2566</span>&#160;<span class="keyword">inline</span> <a class="code" href="config_8h.html#a1d1d58e8be15e5c4285f6892e5f33136">DEAL_II_ALWAYS_INLINE</a> <span class="keywordtype">void</span></div><div class="line"><a name="l02567"></a><span class="lineno"> 2567</span>&#160;<a class="code" href="vectorization_8h.html#af396b43c783502e8acd2ca7d071a7325">vectorized_transpose_and_store</a>(<span class="keyword">const</span> <span class="keywordtype">bool</span>                        add_into,</div><div class="line"><a name="l02568"></a><span class="lineno"> 2568</span>&#160;                               <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span>                n_entries,</div><div class="line"><a name="l02569"></a><span class="lineno"> 2569</span>&#160;                               <span class="keyword">const</span> <a class="code" href="classVectorizedArray.html">VectorizedArray&lt;double, 4&gt;</a> *in,</div><div class="line"><a name="l02570"></a><span class="lineno"> 2570</span>&#160;                               std::array&lt;double *, 4&gt; &amp;         out)</div><div class="line"><a name="l02571"></a><span class="lineno"> 2571</span>&#160;{</div><div class="line"><a name="l02572"></a><span class="lineno"> 2572</span>&#160;  <span class="comment">// see the comments in the vectorized_transpose_and_store above</span></div><div class="line"><a name="l02573"></a><span class="lineno"> 2573</span>&#160;</div><div class="line"><a name="l02574"></a><span class="lineno"> 2574</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> n_chunks = n_entries / 4;</div><div class="line"><a name="l02575"></a><span class="lineno"> 2575</span>&#160;  <span class="keywordtype">double</span> *           out0     = out[0];</div><div class="line"><a name="l02576"></a><span class="lineno"> 2576</span>&#160;  <span class="keywordtype">double</span> *           out1     = out[1];</div><div class="line"><a name="l02577"></a><span class="lineno"> 2577</span>&#160;  <span class="keywordtype">double</span> *           out2     = out[2];</div><div class="line"><a name="l02578"></a><span class="lineno"> 2578</span>&#160;  <span class="keywordtype">double</span> *           out3     = out[3];</div><div class="line"><a name="l02579"></a><span class="lineno"> 2579</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i = 0; i &lt; n_chunks; ++i)</div><div class="line"><a name="l02580"></a><span class="lineno"> 2580</span>&#160;    {</div><div class="line"><a name="l02581"></a><span class="lineno"> 2581</span>&#160;      __m256d u0   = in[4 * i + 0].<a class="code" href="classVectorizedArray.html#ad38190d02537705964e021da7ecbab3f">data</a>;</div><div class="line"><a name="l02582"></a><span class="lineno"> 2582</span>&#160;      __m256d u1   = in[4 * i + 1].<a class="code" href="classVectorizedArray.html#ad38190d02537705964e021da7ecbab3f">data</a>;</div><div class="line"><a name="l02583"></a><span class="lineno"> 2583</span>&#160;      __m256d u2   = in[4 * i + 2].<a class="code" href="classVectorizedArray.html#ad38190d02537705964e021da7ecbab3f">data</a>;</div><div class="line"><a name="l02584"></a><span class="lineno"> 2584</span>&#160;      __m256d u3   = in[4 * i + 3].<a class="code" href="classVectorizedArray.html#ad38190d02537705964e021da7ecbab3f">data</a>;</div><div class="line"><a name="l02585"></a><span class="lineno"> 2585</span>&#160;      __m256d t0   = _mm256_permute2f128_pd(u0, u2, 0x20);</div><div class="line"><a name="l02586"></a><span class="lineno"> 2586</span>&#160;      __m256d t1   = _mm256_permute2f128_pd(u1, u3, 0x20);</div><div class="line"><a name="l02587"></a><span class="lineno"> 2587</span>&#160;      __m256d t2   = _mm256_permute2f128_pd(u0, u2, 0x31);</div><div class="line"><a name="l02588"></a><span class="lineno"> 2588</span>&#160;      __m256d t3   = _mm256_permute2f128_pd(u1, u3, 0x31);</div><div class="line"><a name="l02589"></a><span class="lineno"> 2589</span>&#160;      __m256d res0 = _mm256_unpacklo_pd(t0, t1);</div><div class="line"><a name="l02590"></a><span class="lineno"> 2590</span>&#160;      __m256d res1 = _mm256_unpackhi_pd(t0, t1);</div><div class="line"><a name="l02591"></a><span class="lineno"> 2591</span>&#160;      __m256d res2 = _mm256_unpacklo_pd(t2, t3);</div><div class="line"><a name="l02592"></a><span class="lineno"> 2592</span>&#160;      __m256d res3 = _mm256_unpackhi_pd(t2, t3);</div><div class="line"><a name="l02593"></a><span class="lineno"> 2593</span>&#160;</div><div class="line"><a name="l02594"></a><span class="lineno"> 2594</span>&#160;      <span class="comment">// Cannot use the same store instructions in both paths of the &#39;if&#39;</span></div><div class="line"><a name="l02595"></a><span class="lineno"> 2595</span>&#160;      <span class="comment">// because the compiler cannot know that there is no aliasing between</span></div><div class="line"><a name="l02596"></a><span class="lineno"> 2596</span>&#160;      <span class="comment">// pointers</span></div><div class="line"><a name="l02597"></a><span class="lineno"> 2597</span>&#160;      <span class="keywordflow">if</span> (add_into)</div><div class="line"><a name="l02598"></a><span class="lineno"> 2598</span>&#160;        {</div><div class="line"><a name="l02599"></a><span class="lineno"> 2599</span>&#160;          res0 = _mm256_add_pd(_mm256_loadu_pd(out0 + 4 * i), res0);</div><div class="line"><a name="l02600"></a><span class="lineno"> 2600</span>&#160;          _mm256_storeu_pd(out0 + 4 * i, res0);</div><div class="line"><a name="l02601"></a><span class="lineno"> 2601</span>&#160;          res1 = _mm256_add_pd(_mm256_loadu_pd(out1 + 4 * i), res1);</div><div class="line"><a name="l02602"></a><span class="lineno"> 2602</span>&#160;          _mm256_storeu_pd(out1 + 4 * i, res1);</div><div class="line"><a name="l02603"></a><span class="lineno"> 2603</span>&#160;          res2 = _mm256_add_pd(_mm256_loadu_pd(out2 + 4 * i), res2);</div><div class="line"><a name="l02604"></a><span class="lineno"> 2604</span>&#160;          _mm256_storeu_pd(out2 + 4 * i, res2);</div><div class="line"><a name="l02605"></a><span class="lineno"> 2605</span>&#160;          res3 = _mm256_add_pd(_mm256_loadu_pd(out3 + 4 * i), res3);</div><div class="line"><a name="l02606"></a><span class="lineno"> 2606</span>&#160;          _mm256_storeu_pd(out3 + 4 * i, res3);</div><div class="line"><a name="l02607"></a><span class="lineno"> 2607</span>&#160;        }</div><div class="line"><a name="l02608"></a><span class="lineno"> 2608</span>&#160;      <span class="keywordflow">else</span></div><div class="line"><a name="l02609"></a><span class="lineno"> 2609</span>&#160;        {</div><div class="line"><a name="l02610"></a><span class="lineno"> 2610</span>&#160;          _mm256_storeu_pd(out0 + 4 * i, res0);</div><div class="line"><a name="l02611"></a><span class="lineno"> 2611</span>&#160;          _mm256_storeu_pd(out1 + 4 * i, res1);</div><div class="line"><a name="l02612"></a><span class="lineno"> 2612</span>&#160;          _mm256_storeu_pd(out2 + 4 * i, res2);</div><div class="line"><a name="l02613"></a><span class="lineno"> 2613</span>&#160;          _mm256_storeu_pd(out3 + 4 * i, res3);</div><div class="line"><a name="l02614"></a><span class="lineno"> 2614</span>&#160;        }</div><div class="line"><a name="l02615"></a><span class="lineno"> 2615</span>&#160;    }</div><div class="line"><a name="l02616"></a><span class="lineno"> 2616</span>&#160;</div><div class="line"><a name="l02617"></a><span class="lineno"> 2617</span>&#160;  <span class="comment">// remainder loop of work that does not divide by 4</span></div><div class="line"><a name="l02618"></a><span class="lineno"> 2618</span>&#160;  <span class="keywordflow">if</span> (add_into)</div><div class="line"><a name="l02619"></a><span class="lineno"> 2619</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i = 4 * n_chunks; i &lt; n_entries; ++i)</div><div class="line"><a name="l02620"></a><span class="lineno"> 2620</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> v = 0; v &lt; 4; ++v)</div><div class="line"><a name="l02621"></a><span class="lineno"> 2621</span>&#160;        out[v][i] += in[i][v];</div><div class="line"><a name="l02622"></a><span class="lineno"> 2622</span>&#160;  <span class="keywordflow">else</span></div><div class="line"><a name="l02623"></a><span class="lineno"> 2623</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i = 4 * n_chunks; i &lt; n_entries; ++i)</div><div class="line"><a name="l02624"></a><span class="lineno"> 2624</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> v = 0; v &lt; 4; ++v)</div><div class="line"><a name="l02625"></a><span class="lineno"> 2625</span>&#160;        out[v][i] = in[i][v];</div><div class="line"><a name="l02626"></a><span class="lineno"> 2626</span>&#160;}</div><div class="line"><a name="l02627"></a><span class="lineno"> 2627</span>&#160;</div><div class="line"><a name="l02628"></a><span class="lineno"> 2628</span>&#160;</div><div class="line"><a name="l02629"></a><span class="lineno"> 2629</span>&#160;</div><div class="line"><a name="l02635"></a><span class="lineno"> 2635</span>&#160;<span class="keyword">template</span> &lt;&gt;</div><div class="line"><a name="l02636"></a><span class="lineno"> 2636</span>&#160;<span class="keyword">class </span><a class="code" href="classVectorizedArray.html">VectorizedArray</a>&lt;float, 8&gt;</div><div class="line"><a name="l02637"></a><span class="lineno"> 2637</span>&#160;  : <span class="keyword">public</span> <a class="code" href="classVectorizedArrayBase.html">VectorizedArrayBase</a>&lt;VectorizedArray&lt;float, 8&gt;, 8&gt;</div><div class="line"><a name="l02638"></a><span class="lineno"> 2638</span>&#160;{</div><div class="line"><a name="l02639"></a><span class="lineno"> 2639</span>&#160;<span class="keyword">public</span>:</div><div class="line"><a name="l02644"></a><span class="lineno"> 2644</span>&#160;  <span class="keyword">using</span> value_type = float;</div><div class="line"><a name="l02645"></a><span class="lineno"> 2645</span>&#160;</div><div class="line"><a name="l02650"></a><span class="lineno"> 2650</span>&#160;  <a class="code" href="classVectorizedArray.html">VectorizedArray</a>() = <span class="keywordflow">default</span>;</div><div class="line"><a name="l02651"></a><span class="lineno"> 2651</span>&#160;</div><div class="line"><a name="l02656"></a><span class="lineno"> 2656</span>&#160;  <a class="code" href="classVectorizedArray.html">VectorizedArray</a>(<span class="keyword">const</span> <span class="keywordtype">float</span> scalar)</div><div class="line"><a name="l02657"></a><span class="lineno"> 2657</span>&#160;  {</div><div class="line"><a name="l02658"></a><span class="lineno"> 2658</span>&#160;    this-&gt;operator=(scalar);</div><div class="line"><a name="l02659"></a><span class="lineno"> 2659</span>&#160;  }</div><div class="line"><a name="l02660"></a><span class="lineno"> 2660</span>&#160;</div><div class="line"><a name="l02665"></a><span class="lineno"> 2665</span>&#160;  <a class="code" href="config_8h.html#a1d1d58e8be15e5c4285f6892e5f33136">DEAL_II_ALWAYS_INLINE</a></div><div class="line"><a name="l02666"></a><span class="lineno"> 2666</span>&#160;  <a class="code" href="classVectorizedArray.html">VectorizedArray</a> &amp;</div><div class="line"><a name="l02667"></a><span class="lineno"> 2667</span>&#160;  operator=(<span class="keyword">const</span> <span class="keywordtype">float</span> x)</div><div class="line"><a name="l02668"></a><span class="lineno"> 2668</span>&#160;  {</div><div class="line"><a name="l02669"></a><span class="lineno"> 2669</span>&#160;    data = _mm256_set1_ps(x);</div><div class="line"><a name="l02670"></a><span class="lineno"> 2670</span>&#160;    <span class="keywordflow">return</span> *<span class="keyword">this</span>;</div><div class="line"><a name="l02671"></a><span class="lineno"> 2671</span>&#160;  }</div><div class="line"><a name="l02672"></a><span class="lineno"> 2672</span>&#160;</div><div class="line"><a name="l02677"></a><span class="lineno"> 2677</span>&#160;  <a class="code" href="config_8h.html#a1d1d58e8be15e5c4285f6892e5f33136">DEAL_II_ALWAYS_INLINE</a></div><div class="line"><a name="l02678"></a><span class="lineno"> 2678</span>&#160;  <span class="keywordtype">float</span> &amp;operator[](<span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> comp)</div><div class="line"><a name="l02679"></a><span class="lineno"> 2679</span>&#160;  {</div><div class="line"><a name="l02680"></a><span class="lineno"> 2680</span>&#160;    <a class="code" href="group__Exceptions.html#gaafbb69cc2a791ae55880fd8d57d0c1b0">AssertIndexRange</a>(comp, 8);</div><div class="line"><a name="l02681"></a><span class="lineno"> 2681</span>&#160;    <span class="keywordflow">return</span> *(<span class="keyword">reinterpret_cast&lt;</span><span class="keywordtype">float</span> *<span class="keyword">&gt;</span>(&amp;data) + comp);</div><div class="line"><a name="l02682"></a><span class="lineno"> 2682</span>&#160;  }</div><div class="line"><a name="l02683"></a><span class="lineno"> 2683</span>&#160;</div><div class="line"><a name="l02688"></a><span class="lineno"> 2688</span>&#160;  <a class="code" href="config_8h.html#a1d1d58e8be15e5c4285f6892e5f33136">DEAL_II_ALWAYS_INLINE</a></div><div class="line"><a name="l02689"></a><span class="lineno"> 2689</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">float</span> &amp;operator[](<span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> comp)<span class="keyword"> const</span></div><div class="line"><a name="l02690"></a><span class="lineno"> 2690</span>&#160;<span class="keyword">  </span>{</div><div class="line"><a name="l02691"></a><span class="lineno"> 2691</span>&#160;    <a class="code" href="group__Exceptions.html#gaafbb69cc2a791ae55880fd8d57d0c1b0">AssertIndexRange</a>(comp, 8);</div><div class="line"><a name="l02692"></a><span class="lineno"> 2692</span>&#160;    <span class="keywordflow">return</span> *(<span class="keyword">reinterpret_cast&lt;</span><span class="keyword">const </span><span class="keywordtype">float</span> *<span class="keyword">&gt;</span>(&amp;data) + comp);</div><div class="line"><a name="l02693"></a><span class="lineno"> 2693</span>&#160;  }</div><div class="line"><a name="l02694"></a><span class="lineno"> 2694</span>&#160;</div><div class="line"><a name="l02699"></a><span class="lineno"> 2699</span>&#160;  <a class="code" href="config_8h.html#a1d1d58e8be15e5c4285f6892e5f33136">DEAL_II_ALWAYS_INLINE</a></div><div class="line"><a name="l02700"></a><span class="lineno"> 2700</span>&#160;  <a class="code" href="classVectorizedArray.html">VectorizedArray</a> &amp;</div><div class="line"><a name="l02701"></a><span class="lineno"> 2701</span>&#160;  operator+=(<span class="keyword">const</span> <a class="code" href="classVectorizedArray.html">VectorizedArray</a> &amp;vec)</div><div class="line"><a name="l02702"></a><span class="lineno"> 2702</span>&#160;  {</div><div class="line"><a name="l02703"></a><span class="lineno"> 2703</span>&#160;    <span class="comment">// if the compiler supports vector arithmetic, we can simply use +=</span></div><div class="line"><a name="l02704"></a><span class="lineno"> 2704</span>&#160;    <span class="comment">// operator on the given data type. this allows the compiler to combine</span></div><div class="line"><a name="l02705"></a><span class="lineno"> 2705</span>&#160;    <span class="comment">// additions with multiplication (fused multiply-add) if those</span></div><div class="line"><a name="l02706"></a><span class="lineno"> 2706</span>&#160;    <span class="comment">// instructions are available. Otherwise, we need to use the built-in</span></div><div class="line"><a name="l02707"></a><span class="lineno"> 2707</span>&#160;    <span class="comment">// intrinsic command for __m256d</span></div><div class="line"><a name="l02708"></a><span class="lineno"> 2708</span>&#160;<span class="preprocessor">#    ifdef DEAL_II_COMPILER_USE_VECTOR_ARITHMETICS</span></div><div class="line"><a name="l02709"></a><span class="lineno"> 2709</span>&#160;    data += vec.<a class="code" href="classVectorizedArray.html#ad38190d02537705964e021da7ecbab3f">data</a>;</div><div class="line"><a name="l02710"></a><span class="lineno"> 2710</span>&#160;<span class="preprocessor">#    else</span></div><div class="line"><a name="l02711"></a><span class="lineno"> 2711</span>&#160;    data = _mm256_add_ps(data, vec.<a class="code" href="classVectorizedArray.html#ad38190d02537705964e021da7ecbab3f">data</a>);</div><div class="line"><a name="l02712"></a><span class="lineno"> 2712</span>&#160;<span class="preprocessor">#    endif</span></div><div class="line"><a name="l02713"></a><span class="lineno"> 2713</span>&#160;    <span class="keywordflow">return</span> *<span class="keyword">this</span>;</div><div class="line"><a name="l02714"></a><span class="lineno"> 2714</span>&#160;  }</div><div class="line"><a name="l02715"></a><span class="lineno"> 2715</span>&#160;</div><div class="line"><a name="l02720"></a><span class="lineno"> 2720</span>&#160;  <a class="code" href="config_8h.html#a1d1d58e8be15e5c4285f6892e5f33136">DEAL_II_ALWAYS_INLINE</a></div><div class="line"><a name="l02721"></a><span class="lineno"> 2721</span>&#160;  <a class="code" href="classVectorizedArray.html">VectorizedArray</a> &amp;</div><div class="line"><a name="l02722"></a><span class="lineno"> 2722</span>&#160;  operator-=(<span class="keyword">const</span> <a class="code" href="classVectorizedArray.html">VectorizedArray</a> &amp;vec)</div><div class="line"><a name="l02723"></a><span class="lineno"> 2723</span>&#160;  {</div><div class="line"><a name="l02724"></a><span class="lineno"> 2724</span>&#160;<span class="preprocessor">#    ifdef DEAL_II_COMPILER_USE_VECTOR_ARITHMETICS</span></div><div class="line"><a name="l02725"></a><span class="lineno"> 2725</span>&#160;    data -= vec.<a class="code" href="classVectorizedArray.html#ad38190d02537705964e021da7ecbab3f">data</a>;</div><div class="line"><a name="l02726"></a><span class="lineno"> 2726</span>&#160;<span class="preprocessor">#    else</span></div><div class="line"><a name="l02727"></a><span class="lineno"> 2727</span>&#160;    data = _mm256_sub_ps(data, vec.<a class="code" href="classVectorizedArray.html#ad38190d02537705964e021da7ecbab3f">data</a>);</div><div class="line"><a name="l02728"></a><span class="lineno"> 2728</span>&#160;<span class="preprocessor">#    endif</span></div><div class="line"><a name="l02729"></a><span class="lineno"> 2729</span>&#160;    <span class="keywordflow">return</span> *<span class="keyword">this</span>;</div><div class="line"><a name="l02730"></a><span class="lineno"> 2730</span>&#160;  }</div><div class="line"><a name="l02735"></a><span class="lineno"> 2735</span>&#160;  <a class="code" href="config_8h.html#a1d1d58e8be15e5c4285f6892e5f33136">DEAL_II_ALWAYS_INLINE</a></div><div class="line"><a name="l02736"></a><span class="lineno"> 2736</span>&#160;  <a class="code" href="classVectorizedArray.html">VectorizedArray</a> &amp;</div><div class="line"><a name="l02737"></a><span class="lineno"> 2737</span>&#160;  operator*=(<span class="keyword">const</span> <a class="code" href="classVectorizedArray.html">VectorizedArray</a> &amp;vec)</div><div class="line"><a name="l02738"></a><span class="lineno"> 2738</span>&#160;  {</div><div class="line"><a name="l02739"></a><span class="lineno"> 2739</span>&#160;<span class="preprocessor">#    ifdef DEAL_II_COMPILER_USE_VECTOR_ARITHMETICS</span></div><div class="line"><a name="l02740"></a><span class="lineno"> 2740</span>&#160;    data *= vec.<a class="code" href="classVectorizedArray.html#ad38190d02537705964e021da7ecbab3f">data</a>;</div><div class="line"><a name="l02741"></a><span class="lineno"> 2741</span>&#160;<span class="preprocessor">#    else</span></div><div class="line"><a name="l02742"></a><span class="lineno"> 2742</span>&#160;    data = _mm256_mul_ps(data, vec.<a class="code" href="classVectorizedArray.html#ad38190d02537705964e021da7ecbab3f">data</a>);</div><div class="line"><a name="l02743"></a><span class="lineno"> 2743</span>&#160;<span class="preprocessor">#    endif</span></div><div class="line"><a name="l02744"></a><span class="lineno"> 2744</span>&#160;    <span class="keywordflow">return</span> *<span class="keyword">this</span>;</div><div class="line"><a name="l02745"></a><span class="lineno"> 2745</span>&#160;  }</div><div class="line"><a name="l02746"></a><span class="lineno"> 2746</span>&#160;</div><div class="line"><a name="l02751"></a><span class="lineno"> 2751</span>&#160;  <a class="code" href="config_8h.html#a1d1d58e8be15e5c4285f6892e5f33136">DEAL_II_ALWAYS_INLINE</a></div><div class="line"><a name="l02752"></a><span class="lineno"> 2752</span>&#160;  <a class="code" href="classVectorizedArray.html">VectorizedArray</a> &amp;</div><div class="line"><a name="l02753"></a><span class="lineno"> 2753</span>&#160;  operator/=(<span class="keyword">const</span> <a class="code" href="classVectorizedArray.html">VectorizedArray</a> &amp;vec)</div><div class="line"><a name="l02754"></a><span class="lineno"> 2754</span>&#160;  {</div><div class="line"><a name="l02755"></a><span class="lineno"> 2755</span>&#160;<span class="preprocessor">#    ifdef DEAL_II_COMPILER_USE_VECTOR_ARITHMETICS</span></div><div class="line"><a name="l02756"></a><span class="lineno"> 2756</span>&#160;    data /= vec.<a class="code" href="classVectorizedArray.html#ad38190d02537705964e021da7ecbab3f">data</a>;</div><div class="line"><a name="l02757"></a><span class="lineno"> 2757</span>&#160;<span class="preprocessor">#    else</span></div><div class="line"><a name="l02758"></a><span class="lineno"> 2758</span>&#160;    data = _mm256_div_ps(data, vec.<a class="code" href="classVectorizedArray.html#ad38190d02537705964e021da7ecbab3f">data</a>);</div><div class="line"><a name="l02759"></a><span class="lineno"> 2759</span>&#160;<span class="preprocessor">#    endif</span></div><div class="line"><a name="l02760"></a><span class="lineno"> 2760</span>&#160;    <span class="keywordflow">return</span> *<span class="keyword">this</span>;</div><div class="line"><a name="l02761"></a><span class="lineno"> 2761</span>&#160;  }</div><div class="line"><a name="l02762"></a><span class="lineno"> 2762</span>&#160;</div><div class="line"><a name="l02768"></a><span class="lineno"> 2768</span>&#160;  <a class="code" href="config_8h.html#a1d1d58e8be15e5c4285f6892e5f33136">DEAL_II_ALWAYS_INLINE</a></div><div class="line"><a name="l02769"></a><span class="lineno"> 2769</span>&#160;  <span class="keywordtype">void</span></div><div class="line"><a name="l02770"></a><span class="lineno"> 2770</span>&#160;  load(<span class="keyword">const</span> <span class="keywordtype">float</span> *ptr)</div><div class="line"><a name="l02771"></a><span class="lineno"> 2771</span>&#160;  {</div><div class="line"><a name="l02772"></a><span class="lineno"> 2772</span>&#160;    data = _mm256_loadu_ps(ptr);</div><div class="line"><a name="l02773"></a><span class="lineno"> 2773</span>&#160;  }</div><div class="line"><a name="l02774"></a><span class="lineno"> 2774</span>&#160;</div><div class="line"><a name="l02780"></a><span class="lineno"> 2780</span>&#160;  <a class="code" href="config_8h.html#a1d1d58e8be15e5c4285f6892e5f33136">DEAL_II_ALWAYS_INLINE</a></div><div class="line"><a name="l02781"></a><span class="lineno"> 2781</span>&#160;  <span class="keywordtype">void</span></div><div class="line"><a name="l02782"></a><span class="lineno"> 2782</span>&#160;  store(<span class="keywordtype">float</span> *ptr)<span class="keyword"> const</span></div><div class="line"><a name="l02783"></a><span class="lineno"> 2783</span>&#160;<span class="keyword">  </span>{</div><div class="line"><a name="l02784"></a><span class="lineno"> 2784</span>&#160;    _mm256_storeu_ps(ptr, data);</div><div class="line"><a name="l02785"></a><span class="lineno"> 2785</span>&#160;  }</div><div class="line"><a name="l02786"></a><span class="lineno"> 2786</span>&#160;</div><div class="line"><a name="l02792"></a><span class="lineno"> 2792</span>&#160;  <a class="code" href="config_8h.html#a1d1d58e8be15e5c4285f6892e5f33136">DEAL_II_ALWAYS_INLINE</a></div><div class="line"><a name="l02793"></a><span class="lineno"> 2793</span>&#160;  <span class="keywordtype">void</span></div><div class="line"><a name="l02794"></a><span class="lineno"> 2794</span>&#160;  streaming_store(<span class="keywordtype">float</span> *ptr)<span class="keyword"> const</span></div><div class="line"><a name="l02795"></a><span class="lineno"> 2795</span>&#160;<span class="keyword">  </span>{</div><div class="line"><a name="l02796"></a><span class="lineno"> 2796</span>&#160;    <a class="code" href="group__Exceptions.html#ga70a0bb353656e704acf927945277bbc6">Assert</a>(reinterpret_cast&lt;std::size_t&gt;(ptr) % 32 == 0,</div><div class="line"><a name="l02797"></a><span class="lineno"> 2797</span>&#160;           <a class="code" href="group__Exceptions.html#gae9a45f517af1401c50811a11083f9114">ExcMessage</a>(<span class="stringliteral">&quot;Memory not aligned&quot;</span>));</div><div class="line"><a name="l02798"></a><span class="lineno"> 2798</span>&#160;    _mm256_stream_ps(ptr, data);</div><div class="line"><a name="l02799"></a><span class="lineno"> 2799</span>&#160;  }</div><div class="line"><a name="l02800"></a><span class="lineno"> 2800</span>&#160;</div><div class="line"><a name="l02811"></a><span class="lineno"> 2811</span>&#160;  <a class="code" href="config_8h.html#a1d1d58e8be15e5c4285f6892e5f33136">DEAL_II_ALWAYS_INLINE</a></div><div class="line"><a name="l02812"></a><span class="lineno"> 2812</span>&#160;  <span class="keywordtype">void</span></div><div class="line"><a name="l02813"></a><span class="lineno"> 2813</span>&#160;  <a class="code" href="vectorization_8h.html#a078ca5de8d3a59aedc130823be15ad26">gather</a>(<span class="keyword">const</span> <span class="keywordtype">float</span> *base_ptr, <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> *offsets)</div><div class="line"><a name="l02814"></a><span class="lineno"> 2814</span>&#160;  {</div><div class="line"><a name="l02815"></a><span class="lineno"> 2815</span>&#160;<span class="preprocessor">#    ifdef __AVX2__</span></div><div class="line"><a name="l02816"></a><span class="lineno"> 2816</span>&#160;    <span class="comment">// unfortunately, there does not appear to be a 256 bit integer load, so</span></div><div class="line"><a name="l02817"></a><span class="lineno"> 2817</span>&#160;    <span class="comment">// do it by some reinterpret casts here. this is allowed because the Intel</span></div><div class="line"><a name="l02818"></a><span class="lineno"> 2818</span>&#160;    <span class="comment">// API allows aliasing between different vector types.</span></div><div class="line"><a name="l02819"></a><span class="lineno"> 2819</span>&#160;    <span class="keyword">const</span> __m256 index_val =</div><div class="line"><a name="l02820"></a><span class="lineno"> 2820</span>&#160;      _mm256_loadu_ps(reinterpret_cast&lt;const float *&gt;(offsets));</div><div class="line"><a name="l02821"></a><span class="lineno"> 2821</span>&#160;    <span class="keyword">const</span> __m256i index = *<span class="keyword">reinterpret_cast&lt;</span><span class="keyword">const </span>__m256i *<span class="keyword">&gt;</span>(&amp;index_val);</div><div class="line"><a name="l02822"></a><span class="lineno"> 2822</span>&#160;    data                = _mm256_i32gather_ps(base_ptr, index, 4);</div><div class="line"><a name="l02823"></a><span class="lineno"> 2823</span>&#160;<span class="preprocessor">#    else</span></div><div class="line"><a name="l02824"></a><span class="lineno"> 2824</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i = 0; i &lt; 8; ++i)</div><div class="line"><a name="l02825"></a><span class="lineno"> 2825</span>&#160;      *(reinterpret_cast&lt;float *&gt;(&amp;data) + i) = base_ptr[offsets[i]];</div><div class="line"><a name="l02826"></a><span class="lineno"> 2826</span>&#160;<span class="preprocessor">#    endif</span></div><div class="line"><a name="l02827"></a><span class="lineno"> 2827</span>&#160;  }</div><div class="line"><a name="l02828"></a><span class="lineno"> 2828</span>&#160;</div><div class="line"><a name="l02840"></a><span class="lineno"> 2840</span>&#160;  <a class="code" href="config_8h.html#a1d1d58e8be15e5c4285f6892e5f33136">DEAL_II_ALWAYS_INLINE</a></div><div class="line"><a name="l02841"></a><span class="lineno"> 2841</span>&#160;  <span class="keywordtype">void</span></div><div class="line"><a name="l02842"></a><span class="lineno"> 2842</span>&#160;  scatter(<span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> *offsets, <span class="keywordtype">float</span> *base_ptr)<span class="keyword"> const</span></div><div class="line"><a name="l02843"></a><span class="lineno"> 2843</span>&#160;<span class="keyword">  </span>{</div><div class="line"><a name="l02844"></a><span class="lineno"> 2844</span>&#160;    <span class="comment">// no scatter operation in AVX/AVX2</span></div><div class="line"><a name="l02845"></a><span class="lineno"> 2845</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i = 0; i &lt; 8; ++i)</div><div class="line"><a name="l02846"></a><span class="lineno"> 2846</span>&#160;      base_ptr[offsets[i]] = *(reinterpret_cast&lt;const float *&gt;(&amp;data) + i);</div><div class="line"><a name="l02847"></a><span class="lineno"> 2847</span>&#160;  }</div><div class="line"><a name="l02848"></a><span class="lineno"> 2848</span>&#160;</div><div class="line"><a name="l02853"></a><span class="lineno"> 2853</span>&#160;  __m256 data;</div><div class="line"><a name="l02854"></a><span class="lineno"> 2854</span>&#160;</div><div class="line"><a name="l02855"></a><span class="lineno"> 2855</span>&#160;<span class="keyword">private</span>:</div><div class="line"><a name="l02860"></a><span class="lineno"> 2860</span>&#160;  <a class="code" href="config_8h.html#a1d1d58e8be15e5c4285f6892e5f33136">DEAL_II_ALWAYS_INLINE</a></div><div class="line"><a name="l02861"></a><span class="lineno"> 2861</span>&#160;  <a class="code" href="classVectorizedArray.html">VectorizedArray</a></div><div class="line"><a name="l02862"></a><span class="lineno"> 2862</span>&#160;  get_sqrt()<span class="keyword"> const</span></div><div class="line"><a name="l02863"></a><span class="lineno"> 2863</span>&#160;<span class="keyword">  </span>{</div><div class="line"><a name="l02864"></a><span class="lineno"> 2864</span>&#160;    <a class="code" href="classVectorizedArray.html">VectorizedArray</a> res;</div><div class="line"><a name="l02865"></a><span class="lineno"> 2865</span>&#160;    res.<a class="code" href="classVectorizedArray.html#ad38190d02537705964e021da7ecbab3f">data</a> = _mm256_sqrt_ps(data);</div><div class="line"><a name="l02866"></a><span class="lineno"> 2866</span>&#160;    <span class="keywordflow">return</span> res;</div><div class="line"><a name="l02867"></a><span class="lineno"> 2867</span>&#160;  }</div><div class="line"><a name="l02868"></a><span class="lineno"> 2868</span>&#160;</div><div class="line"><a name="l02873"></a><span class="lineno"> 2873</span>&#160;  <a class="code" href="config_8h.html#a1d1d58e8be15e5c4285f6892e5f33136">DEAL_II_ALWAYS_INLINE</a></div><div class="line"><a name="l02874"></a><span class="lineno"> 2874</span>&#160;  <a class="code" href="classVectorizedArray.html">VectorizedArray</a></div><div class="line"><a name="l02875"></a><span class="lineno"> 2875</span>&#160;  get_abs()<span class="keyword"> const</span></div><div class="line"><a name="l02876"></a><span class="lineno"> 2876</span>&#160;<span class="keyword">  </span>{</div><div class="line"><a name="l02877"></a><span class="lineno"> 2877</span>&#160;    <span class="comment">// to compute the absolute value, perform bitwise andnot with -0. This</span></div><div class="line"><a name="l02878"></a><span class="lineno"> 2878</span>&#160;    <span class="comment">// will leave all value and exponent bits unchanged but force the sign</span></div><div class="line"><a name="l02879"></a><span class="lineno"> 2879</span>&#160;    <span class="comment">// value to +.</span></div><div class="line"><a name="l02880"></a><span class="lineno"> 2880</span>&#160;    __m256          mask = _mm256_set1_ps(-0.f);</div><div class="line"><a name="l02881"></a><span class="lineno"> 2881</span>&#160;    <a class="code" href="classVectorizedArray.html">VectorizedArray</a> res;</div><div class="line"><a name="l02882"></a><span class="lineno"> 2882</span>&#160;    res.<a class="code" href="classVectorizedArray.html#ad38190d02537705964e021da7ecbab3f">data</a> = _mm256_andnot_ps(mask, data);</div><div class="line"><a name="l02883"></a><span class="lineno"> 2883</span>&#160;    <span class="keywordflow">return</span> res;</div><div class="line"><a name="l02884"></a><span class="lineno"> 2884</span>&#160;  }</div><div class="line"><a name="l02885"></a><span class="lineno"> 2885</span>&#160;</div><div class="line"><a name="l02890"></a><span class="lineno"> 2890</span>&#160;  <a class="code" href="config_8h.html#a1d1d58e8be15e5c4285f6892e5f33136">DEAL_II_ALWAYS_INLINE</a></div><div class="line"><a name="l02891"></a><span class="lineno"> 2891</span>&#160;  <a class="code" href="classVectorizedArray.html">VectorizedArray</a></div><div class="line"><a name="l02892"></a><span class="lineno"> 2892</span>&#160;  get_max(<span class="keyword">const</span> <a class="code" href="classVectorizedArray.html">VectorizedArray</a> &amp;other)<span class="keyword"> const</span></div><div class="line"><a name="l02893"></a><span class="lineno"> 2893</span>&#160;<span class="keyword">  </span>{</div><div class="line"><a name="l02894"></a><span class="lineno"> 2894</span>&#160;    <a class="code" href="classVectorizedArray.html">VectorizedArray</a> res;</div><div class="line"><a name="l02895"></a><span class="lineno"> 2895</span>&#160;    res.<a class="code" href="classVectorizedArray.html#ad38190d02537705964e021da7ecbab3f">data</a> = _mm256_max_ps(data, other.<a class="code" href="classVectorizedArray.html#ad38190d02537705964e021da7ecbab3f">data</a>);</div><div class="line"><a name="l02896"></a><span class="lineno"> 2896</span>&#160;    <span class="keywordflow">return</span> res;</div><div class="line"><a name="l02897"></a><span class="lineno"> 2897</span>&#160;  }</div><div class="line"><a name="l02898"></a><span class="lineno"> 2898</span>&#160;</div><div class="line"><a name="l02903"></a><span class="lineno"> 2903</span>&#160;  <a class="code" href="config_8h.html#a1d1d58e8be15e5c4285f6892e5f33136">DEAL_II_ALWAYS_INLINE</a></div><div class="line"><a name="l02904"></a><span class="lineno"> 2904</span>&#160;  <a class="code" href="classVectorizedArray.html">VectorizedArray</a></div><div class="line"><a name="l02905"></a><span class="lineno"> 2905</span>&#160;  get_min(<span class="keyword">const</span> <a class="code" href="classVectorizedArray.html">VectorizedArray</a> &amp;other)<span class="keyword"> const</span></div><div class="line"><a name="l02906"></a><span class="lineno"> 2906</span>&#160;<span class="keyword">  </span>{</div><div class="line"><a name="l02907"></a><span class="lineno"> 2907</span>&#160;    <a class="code" href="classVectorizedArray.html">VectorizedArray</a> res;</div><div class="line"><a name="l02908"></a><span class="lineno"> 2908</span>&#160;    res.<a class="code" href="classVectorizedArray.html#ad38190d02537705964e021da7ecbab3f">data</a> = _mm256_min_ps(data, other.<a class="code" href="classVectorizedArray.html#ad38190d02537705964e021da7ecbab3f">data</a>);</div><div class="line"><a name="l02909"></a><span class="lineno"> 2909</span>&#160;    <span class="keywordflow">return</span> res;</div><div class="line"><a name="l02910"></a><span class="lineno"> 2910</span>&#160;  }</div><div class="line"><a name="l02911"></a><span class="lineno"> 2911</span>&#160;</div><div class="line"><a name="l02912"></a><span class="lineno"> 2912</span>&#160;  <span class="comment">// Make a few functions friends.</span></div><div class="line"><a name="l02913"></a><span class="lineno"> 2913</span>&#160;  <span class="keyword">template</span> &lt;<span class="keyword">typename</span> Number2, std::<span class="keywordtype">size_t</span> w<span class="keywordtype">id</span>th2&gt;</div><div class="line"><a name="l02914"></a><span class="lineno"> 2914</span>&#160;  <span class="keyword">friend</span> <a class="code" href="classVectorizedArray.html">VectorizedArray&lt;Number2, width2&gt;</a></div><div class="line"><a name="l02915"></a><span class="lineno"> 2915</span>&#160;  std::sqrt(<span class="keyword">const</span> <a class="code" href="classVectorizedArray.html">VectorizedArray&lt;Number2, width2&gt;</a> &amp;);</div><div class="line"><a name="l02916"></a><span class="lineno"> 2916</span>&#160;  <span class="keyword">template</span> &lt;<span class="keyword">typename</span> Number2, std::<span class="keywordtype">size_t</span> w<span class="keywordtype">id</span>th2&gt;</div><div class="line"><a name="l02917"></a><span class="lineno"> 2917</span>&#160;  <span class="keyword">friend</span> <a class="code" href="classVectorizedArray.html">VectorizedArray&lt;Number2, width2&gt;</a></div><div class="line"><a name="l02918"></a><span class="lineno"> 2918</span>&#160;  std::abs(<span class="keyword">const</span> <a class="code" href="classVectorizedArray.html">VectorizedArray&lt;Number2, width2&gt;</a> &amp;);</div><div class="line"><a name="l02919"></a><span class="lineno"> 2919</span>&#160;  <span class="keyword">template</span> &lt;<span class="keyword">typename</span> Number2, std::<span class="keywordtype">size_t</span> w<span class="keywordtype">id</span>th2&gt;</div><div class="line"><a name="l02920"></a><span class="lineno"> 2920</span>&#160;  <span class="keyword">friend</span> <a class="code" href="classVectorizedArray.html">VectorizedArray&lt;Number2, width2&gt;</a></div><div class="line"><a name="l02921"></a><span class="lineno"> 2921</span>&#160;  std::max(<span class="keyword">const</span> <a class="code" href="classVectorizedArray.html">VectorizedArray&lt;Number2, width2&gt;</a> &amp;,</div><div class="line"><a name="l02922"></a><span class="lineno"> 2922</span>&#160;           <span class="keyword">const</span> <a class="code" href="classVectorizedArray.html">VectorizedArray&lt;Number2, width2&gt;</a> &amp;);</div><div class="line"><a name="l02923"></a><span class="lineno"> 2923</span>&#160;  <span class="keyword">template</span> &lt;<span class="keyword">typename</span> Number2, std::<span class="keywordtype">size_t</span> w<span class="keywordtype">id</span>th2&gt;</div><div class="line"><a name="l02924"></a><span class="lineno"> 2924</span>&#160;  <span class="keyword">friend</span> <a class="code" href="classVectorizedArray.html">VectorizedArray&lt;Number2, width2&gt;</a></div><div class="line"><a name="l02925"></a><span class="lineno"> 2925</span>&#160;  std::min(<span class="keyword">const</span> <a class="code" href="classVectorizedArray.html">VectorizedArray&lt;Number2, width2&gt;</a> &amp;,</div><div class="line"><a name="l02926"></a><span class="lineno"> 2926</span>&#160;           <span class="keyword">const</span> <a class="code" href="classVectorizedArray.html">VectorizedArray&lt;Number2, width2&gt;</a> &amp;);</div><div class="line"><a name="l02927"></a><span class="lineno"> 2927</span>&#160;};</div><div class="line"><a name="l02928"></a><span class="lineno"> 2928</span>&#160;</div><div class="line"><a name="l02929"></a><span class="lineno"> 2929</span>&#160;</div><div class="line"><a name="l02930"></a><span class="lineno"> 2930</span>&#160;</div><div class="line"><a name="l02936"></a><span class="lineno"> 2936</span>&#160;<span class="keyword">template</span> &lt;&gt;</div><div class="line"><a name="l02937"></a><span class="lineno"> 2937</span>&#160;<span class="keyword">inline</span> <a class="code" href="config_8h.html#a1d1d58e8be15e5c4285f6892e5f33136">DEAL_II_ALWAYS_INLINE</a> <span class="keywordtype">void</span></div><div class="line"><a name="l02938"></a><span class="lineno"> 2938</span>&#160;<a class="code" href="vectorization_8h.html#a14da4327264fd3a88a9f73a8f72a9094">vectorized_load_and_transpose</a>(<span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span>         n_entries,</div><div class="line"><a name="l02939"></a><span class="lineno"> 2939</span>&#160;                              <span class="keyword">const</span> <span class="keywordtype">float</span> *              in,</div><div class="line"><a name="l02940"></a><span class="lineno"> 2940</span>&#160;                              <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> *       offsets,</div><div class="line"><a name="l02941"></a><span class="lineno"> 2941</span>&#160;                              <a class="code" href="classVectorizedArray.html">VectorizedArray&lt;float, 8&gt;</a> *out)</div><div class="line"><a name="l02942"></a><span class="lineno"> 2942</span>&#160;{</div><div class="line"><a name="l02943"></a><span class="lineno"> 2943</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> n_chunks = n_entries / 4;</div><div class="line"><a name="l02944"></a><span class="lineno"> 2944</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i = 0; i &lt; n_chunks; ++i)</div><div class="line"><a name="l02945"></a><span class="lineno"> 2945</span>&#160;    {</div><div class="line"><a name="l02946"></a><span class="lineno"> 2946</span>&#160;      <span class="comment">// To avoid warnings about uninitialized variables, need to initialize</span></div><div class="line"><a name="l02947"></a><span class="lineno"> 2947</span>&#160;      <span class="comment">// one variable with zero before using it.</span></div><div class="line"><a name="l02948"></a><span class="lineno"> 2948</span>&#160;      __m256 t0, t1, t2, t3 = {};</div><div class="line"><a name="l02949"></a><span class="lineno"> 2949</span>&#160;      t0 = _mm256_insertf128_ps(t3, _mm_loadu_ps(in + 4 * i + offsets[0]), 0);</div><div class="line"><a name="l02950"></a><span class="lineno"> 2950</span>&#160;      t0 = _mm256_insertf128_ps(t0, _mm_loadu_ps(in + 4 * i + offsets[4]), 1);</div><div class="line"><a name="l02951"></a><span class="lineno"> 2951</span>&#160;      t1 = _mm256_insertf128_ps(t3, _mm_loadu_ps(in + 4 * i + offsets[1]), 0);</div><div class="line"><a name="l02952"></a><span class="lineno"> 2952</span>&#160;      t1 = _mm256_insertf128_ps(t1, _mm_loadu_ps(in + 4 * i + offsets[5]), 1);</div><div class="line"><a name="l02953"></a><span class="lineno"> 2953</span>&#160;      t2 = _mm256_insertf128_ps(t3, _mm_loadu_ps(in + 4 * i + offsets[2]), 0);</div><div class="line"><a name="l02954"></a><span class="lineno"> 2954</span>&#160;      t2 = _mm256_insertf128_ps(t2, _mm_loadu_ps(in + 4 * i + offsets[6]), 1);</div><div class="line"><a name="l02955"></a><span class="lineno"> 2955</span>&#160;      t3 = _mm256_insertf128_ps(t3, _mm_loadu_ps(in + 4 * i + offsets[3]), 0);</div><div class="line"><a name="l02956"></a><span class="lineno"> 2956</span>&#160;      t3 = _mm256_insertf128_ps(t3, _mm_loadu_ps(in + 4 * i + offsets[7]), 1);</div><div class="line"><a name="l02957"></a><span class="lineno"> 2957</span>&#160;</div><div class="line"><a name="l02958"></a><span class="lineno"> 2958</span>&#160;      __m256 <a class="code" href="grid__tools_8cc.html#ad817a8f7e41831b2c2971f6eb7142f26">v0</a>           = _mm256_shuffle_ps(t0, t1, 0x44);</div><div class="line"><a name="l02959"></a><span class="lineno"> 2959</span>&#160;      __m256 <a class="code" href="grid__tools_8cc.html#adec67e1e77f5ae4fad3d65a5fb8036e9">v1</a>           = _mm256_shuffle_ps(t0, t1, 0xee);</div><div class="line"><a name="l02960"></a><span class="lineno"> 2960</span>&#160;      __m256 v2           = _mm256_shuffle_ps(t2, t3, 0x44);</div><div class="line"><a name="l02961"></a><span class="lineno"> 2961</span>&#160;      __m256 v3           = _mm256_shuffle_ps(t2, t3, 0xee);</div><div class="line"><a name="l02962"></a><span class="lineno"> 2962</span>&#160;      out[4 * i + 0].<a class="code" href="classVectorizedArray.html#ad38190d02537705964e021da7ecbab3f">data</a> = _mm256_shuffle_ps(v0, v2, 0x88);</div><div class="line"><a name="l02963"></a><span class="lineno"> 2963</span>&#160;      out[4 * i + 1].<a class="code" href="classVectorizedArray.html#ad38190d02537705964e021da7ecbab3f">data</a> = _mm256_shuffle_ps(v0, v2, 0xdd);</div><div class="line"><a name="l02964"></a><span class="lineno"> 2964</span>&#160;      out[4 * i + 2].<a class="code" href="classVectorizedArray.html#ad38190d02537705964e021da7ecbab3f">data</a> = _mm256_shuffle_ps(v1, v3, 0x88);</div><div class="line"><a name="l02965"></a><span class="lineno"> 2965</span>&#160;      out[4 * i + 3].<a class="code" href="classVectorizedArray.html#ad38190d02537705964e021da7ecbab3f">data</a> = _mm256_shuffle_ps(v1, v3, 0xdd);</div><div class="line"><a name="l02966"></a><span class="lineno"> 2966</span>&#160;    }</div><div class="line"><a name="l02967"></a><span class="lineno"> 2967</span>&#160;</div><div class="line"><a name="l02968"></a><span class="lineno"> 2968</span>&#160;  <span class="comment">// remainder loop of work that does not divide by 4</span></div><div class="line"><a name="l02969"></a><span class="lineno"> 2969</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i = 4 * n_chunks; i &lt; n_entries; ++i)</div><div class="line"><a name="l02970"></a><span class="lineno"> 2970</span>&#160;    out[i].<a class="code" href="vectorization_8h.html#a078ca5de8d3a59aedc130823be15ad26">gather</a>(in + i, offsets);</div><div class="line"><a name="l02971"></a><span class="lineno"> 2971</span>&#160;}</div><div class="line"><a name="l02972"></a><span class="lineno"> 2972</span>&#160;</div><div class="line"><a name="l02973"></a><span class="lineno"> 2973</span>&#160;</div><div class="line"><a name="l02974"></a><span class="lineno"> 2974</span>&#160;</div><div class="line"><a name="l02980"></a><span class="lineno"> 2980</span>&#160;<span class="keyword">template</span> &lt;&gt;</div><div class="line"><a name="l02981"></a><span class="lineno"> 2981</span>&#160;<span class="keyword">inline</span> <a class="code" href="config_8h.html#a1d1d58e8be15e5c4285f6892e5f33136">DEAL_II_ALWAYS_INLINE</a> <span class="keywordtype">void</span></div><div class="line"><a name="l02982"></a><span class="lineno"> 2982</span>&#160;<a class="code" href="vectorization_8h.html#a14da4327264fd3a88a9f73a8f72a9094">vectorized_load_and_transpose</a>(<span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span>            n_entries,</div><div class="line"><a name="l02983"></a><span class="lineno"> 2983</span>&#160;                              <span class="keyword">const</span> std::array&lt;float *, 8&gt; &amp;in,</div><div class="line"><a name="l02984"></a><span class="lineno"> 2984</span>&#160;                              <a class="code" href="classVectorizedArray.html">VectorizedArray&lt;float, 8&gt;</a> *   out)</div><div class="line"><a name="l02985"></a><span class="lineno"> 2985</span>&#160;{</div><div class="line"><a name="l02986"></a><span class="lineno"> 2986</span>&#160;  <span class="comment">// see the comments in the vectorized_load_and_transpose above</span></div><div class="line"><a name="l02987"></a><span class="lineno"> 2987</span>&#160;</div><div class="line"><a name="l02988"></a><span class="lineno"> 2988</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> n_chunks = n_entries / 4;</div><div class="line"><a name="l02989"></a><span class="lineno"> 2989</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i = 0; i &lt; n_chunks; ++i)</div><div class="line"><a name="l02990"></a><span class="lineno"> 2990</span>&#160;    {</div><div class="line"><a name="l02991"></a><span class="lineno"> 2991</span>&#160;      __m256 t0, t1, t2, t3 = {};</div><div class="line"><a name="l02992"></a><span class="lineno"> 2992</span>&#160;      t0 = _mm256_insertf128_ps(t3, _mm_loadu_ps(in[0] + 4 * i), 0);</div><div class="line"><a name="l02993"></a><span class="lineno"> 2993</span>&#160;      t0 = _mm256_insertf128_ps(t0, _mm_loadu_ps(in[4] + 4 * i), 1);</div><div class="line"><a name="l02994"></a><span class="lineno"> 2994</span>&#160;      t1 = _mm256_insertf128_ps(t3, _mm_loadu_ps(in[1] + 4 * i), 0);</div><div class="line"><a name="l02995"></a><span class="lineno"> 2995</span>&#160;      t1 = _mm256_insertf128_ps(t1, _mm_loadu_ps(in[5] + 4 * i), 1);</div><div class="line"><a name="l02996"></a><span class="lineno"> 2996</span>&#160;      t2 = _mm256_insertf128_ps(t3, _mm_loadu_ps(in[2] + 4 * i), 0);</div><div class="line"><a name="l02997"></a><span class="lineno"> 2997</span>&#160;      t2 = _mm256_insertf128_ps(t2, _mm_loadu_ps(in[6] + 4 * i), 1);</div><div class="line"><a name="l02998"></a><span class="lineno"> 2998</span>&#160;      t3 = _mm256_insertf128_ps(t3, _mm_loadu_ps(in[3] + 4 * i), 0);</div><div class="line"><a name="l02999"></a><span class="lineno"> 2999</span>&#160;      t3 = _mm256_insertf128_ps(t3, _mm_loadu_ps(in[7] + 4 * i), 1);</div><div class="line"><a name="l03000"></a><span class="lineno"> 3000</span>&#160;</div><div class="line"><a name="l03001"></a><span class="lineno"> 3001</span>&#160;      __m256 <a class="code" href="grid__tools_8cc.html#ad817a8f7e41831b2c2971f6eb7142f26">v0</a>           = _mm256_shuffle_ps(t0, t1, 0x44);</div><div class="line"><a name="l03002"></a><span class="lineno"> 3002</span>&#160;      __m256 <a class="code" href="grid__tools_8cc.html#adec67e1e77f5ae4fad3d65a5fb8036e9">v1</a>           = _mm256_shuffle_ps(t0, t1, 0xee);</div><div class="line"><a name="l03003"></a><span class="lineno"> 3003</span>&#160;      __m256 v2           = _mm256_shuffle_ps(t2, t3, 0x44);</div><div class="line"><a name="l03004"></a><span class="lineno"> 3004</span>&#160;      __m256 v3           = _mm256_shuffle_ps(t2, t3, 0xee);</div><div class="line"><a name="l03005"></a><span class="lineno"> 3005</span>&#160;      out[4 * i + 0].<a class="code" href="classVectorizedArray.html#ad38190d02537705964e021da7ecbab3f">data</a> = _mm256_shuffle_ps(v0, v2, 0x88);</div><div class="line"><a name="l03006"></a><span class="lineno"> 3006</span>&#160;      out[4 * i + 1].<a class="code" href="classVectorizedArray.html#ad38190d02537705964e021da7ecbab3f">data</a> = _mm256_shuffle_ps(v0, v2, 0xdd);</div><div class="line"><a name="l03007"></a><span class="lineno"> 3007</span>&#160;      out[4 * i + 2].<a class="code" href="classVectorizedArray.html#ad38190d02537705964e021da7ecbab3f">data</a> = _mm256_shuffle_ps(v1, v3, 0x88);</div><div class="line"><a name="l03008"></a><span class="lineno"> 3008</span>&#160;      out[4 * i + 3].<a class="code" href="classVectorizedArray.html#ad38190d02537705964e021da7ecbab3f">data</a> = _mm256_shuffle_ps(v1, v3, 0xdd);</div><div class="line"><a name="l03009"></a><span class="lineno"> 3009</span>&#160;    }</div><div class="line"><a name="l03010"></a><span class="lineno"> 3010</span>&#160;</div><div class="line"><a name="l03011"></a><span class="lineno"> 3011</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i = 4 * n_chunks; i &lt; n_entries; ++i)</div><div class="line"><a name="l03012"></a><span class="lineno"> 3012</span>&#160;    <a class="code" href="vectorization_8h.html#a078ca5de8d3a59aedc130823be15ad26">gather</a>(out[i], in, i);</div><div class="line"><a name="l03013"></a><span class="lineno"> 3013</span>&#160;}</div><div class="line"><a name="l03014"></a><span class="lineno"> 3014</span>&#160;</div><div class="line"><a name="l03015"></a><span class="lineno"> 3015</span>&#160;</div><div class="line"><a name="l03016"></a><span class="lineno"> 3016</span>&#160;</div><div class="line"><a name="l03022"></a><span class="lineno"> 3022</span>&#160;<span class="keyword">template</span> &lt;&gt;</div><div class="line"><a name="l03023"></a><span class="lineno"> 3023</span>&#160;<span class="keyword">inline</span> <a class="code" href="config_8h.html#a1d1d58e8be15e5c4285f6892e5f33136">DEAL_II_ALWAYS_INLINE</a> <span class="keywordtype">void</span></div><div class="line"><a name="l03024"></a><span class="lineno"> 3024</span>&#160;<a class="code" href="vectorization_8h.html#af396b43c783502e8acd2ca7d071a7325">vectorized_transpose_and_store</a>(<span class="keyword">const</span> <span class="keywordtype">bool</span>                       add_into,</div><div class="line"><a name="l03025"></a><span class="lineno"> 3025</span>&#160;                               <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span>               n_entries,</div><div class="line"><a name="l03026"></a><span class="lineno"> 3026</span>&#160;                               <span class="keyword">const</span> <a class="code" href="classVectorizedArray.html">VectorizedArray&lt;float, 8&gt;</a> *in,</div><div class="line"><a name="l03027"></a><span class="lineno"> 3027</span>&#160;                               <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> *             offsets,</div><div class="line"><a name="l03028"></a><span class="lineno"> 3028</span>&#160;                               <span class="keywordtype">float</span> *                          out)</div><div class="line"><a name="l03029"></a><span class="lineno"> 3029</span>&#160;{</div><div class="line"><a name="l03030"></a><span class="lineno"> 3030</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> n_chunks = n_entries / 4;</div><div class="line"><a name="l03031"></a><span class="lineno"> 3031</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i = 0; i &lt; n_chunks; ++i)</div><div class="line"><a name="l03032"></a><span class="lineno"> 3032</span>&#160;    {</div><div class="line"><a name="l03033"></a><span class="lineno"> 3033</span>&#160;      __m256 u0   = in[4 * i + 0].<a class="code" href="classVectorizedArray.html#ad38190d02537705964e021da7ecbab3f">data</a>;</div><div class="line"><a name="l03034"></a><span class="lineno"> 3034</span>&#160;      __m256 u1   = in[4 * i + 1].<a class="code" href="classVectorizedArray.html#ad38190d02537705964e021da7ecbab3f">data</a>;</div><div class="line"><a name="l03035"></a><span class="lineno"> 3035</span>&#160;      __m256 u2   = in[4 * i + 2].<a class="code" href="classVectorizedArray.html#ad38190d02537705964e021da7ecbab3f">data</a>;</div><div class="line"><a name="l03036"></a><span class="lineno"> 3036</span>&#160;      __m256 u3   = in[4 * i + 3].<a class="code" href="classVectorizedArray.html#ad38190d02537705964e021da7ecbab3f">data</a>;</div><div class="line"><a name="l03037"></a><span class="lineno"> 3037</span>&#160;      __m256 t0   = _mm256_shuffle_ps(u0, u1, 0x44);</div><div class="line"><a name="l03038"></a><span class="lineno"> 3038</span>&#160;      __m256 t1   = _mm256_shuffle_ps(u0, u1, 0xee);</div><div class="line"><a name="l03039"></a><span class="lineno"> 3039</span>&#160;      __m256 t2   = _mm256_shuffle_ps(u2, u3, 0x44);</div><div class="line"><a name="l03040"></a><span class="lineno"> 3040</span>&#160;      __m256 t3   = _mm256_shuffle_ps(u2, u3, 0xee);</div><div class="line"><a name="l03041"></a><span class="lineno"> 3041</span>&#160;      u0          = _mm256_shuffle_ps(t0, t2, 0x88);</div><div class="line"><a name="l03042"></a><span class="lineno"> 3042</span>&#160;      u1          = _mm256_shuffle_ps(t0, t2, 0xdd);</div><div class="line"><a name="l03043"></a><span class="lineno"> 3043</span>&#160;      u2          = _mm256_shuffle_ps(t1, t3, 0x88);</div><div class="line"><a name="l03044"></a><span class="lineno"> 3044</span>&#160;      u3          = _mm256_shuffle_ps(t1, t3, 0xdd);</div><div class="line"><a name="l03045"></a><span class="lineno"> 3045</span>&#160;      __m128 res0 = _mm256_extractf128_ps(u0, 0);</div><div class="line"><a name="l03046"></a><span class="lineno"> 3046</span>&#160;      __m128 res4 = _mm256_extractf128_ps(u0, 1);</div><div class="line"><a name="l03047"></a><span class="lineno"> 3047</span>&#160;      __m128 res1 = _mm256_extractf128_ps(u1, 0);</div><div class="line"><a name="l03048"></a><span class="lineno"> 3048</span>&#160;      __m128 res5 = _mm256_extractf128_ps(u1, 1);</div><div class="line"><a name="l03049"></a><span class="lineno"> 3049</span>&#160;      __m128 res2 = _mm256_extractf128_ps(u2, 0);</div><div class="line"><a name="l03050"></a><span class="lineno"> 3050</span>&#160;      __m128 res6 = _mm256_extractf128_ps(u2, 1);</div><div class="line"><a name="l03051"></a><span class="lineno"> 3051</span>&#160;      __m128 res3 = _mm256_extractf128_ps(u3, 0);</div><div class="line"><a name="l03052"></a><span class="lineno"> 3052</span>&#160;      __m128 res7 = _mm256_extractf128_ps(u3, 1);</div><div class="line"><a name="l03053"></a><span class="lineno"> 3053</span>&#160;</div><div class="line"><a name="l03054"></a><span class="lineno"> 3054</span>&#160;      <span class="comment">// Cannot use the same store instructions in both paths of the &#39;if&#39;</span></div><div class="line"><a name="l03055"></a><span class="lineno"> 3055</span>&#160;      <span class="comment">// because the compiler cannot know that there is no aliasing between</span></div><div class="line"><a name="l03056"></a><span class="lineno"> 3056</span>&#160;      <span class="comment">// pointers</span></div><div class="line"><a name="l03057"></a><span class="lineno"> 3057</span>&#160;      <span class="keywordflow">if</span> (add_into)</div><div class="line"><a name="l03058"></a><span class="lineno"> 3058</span>&#160;        {</div><div class="line"><a name="l03059"></a><span class="lineno"> 3059</span>&#160;          res0 = _mm_add_ps(_mm_loadu_ps(out + 4 * i + offsets[0]), res0);</div><div class="line"><a name="l03060"></a><span class="lineno"> 3060</span>&#160;          _mm_storeu_ps(out + 4 * i + offsets[0], res0);</div><div class="line"><a name="l03061"></a><span class="lineno"> 3061</span>&#160;          res1 = _mm_add_ps(_mm_loadu_ps(out + 4 * i + offsets[1]), res1);</div><div class="line"><a name="l03062"></a><span class="lineno"> 3062</span>&#160;          _mm_storeu_ps(out + 4 * i + offsets[1], res1);</div><div class="line"><a name="l03063"></a><span class="lineno"> 3063</span>&#160;          res2 = _mm_add_ps(_mm_loadu_ps(out + 4 * i + offsets[2]), res2);</div><div class="line"><a name="l03064"></a><span class="lineno"> 3064</span>&#160;          _mm_storeu_ps(out + 4 * i + offsets[2], res2);</div><div class="line"><a name="l03065"></a><span class="lineno"> 3065</span>&#160;          res3 = _mm_add_ps(_mm_loadu_ps(out + 4 * i + offsets[3]), res3);</div><div class="line"><a name="l03066"></a><span class="lineno"> 3066</span>&#160;          _mm_storeu_ps(out + 4 * i + offsets[3], res3);</div><div class="line"><a name="l03067"></a><span class="lineno"> 3067</span>&#160;          res4 = _mm_add_ps(_mm_loadu_ps(out + 4 * i + offsets[4]), res4);</div><div class="line"><a name="l03068"></a><span class="lineno"> 3068</span>&#160;          _mm_storeu_ps(out + 4 * i + offsets[4], res4);</div><div class="line"><a name="l03069"></a><span class="lineno"> 3069</span>&#160;          res5 = _mm_add_ps(_mm_loadu_ps(out + 4 * i + offsets[5]), res5);</div><div class="line"><a name="l03070"></a><span class="lineno"> 3070</span>&#160;          _mm_storeu_ps(out + 4 * i + offsets[5], res5);</div><div class="line"><a name="l03071"></a><span class="lineno"> 3071</span>&#160;          res6 = _mm_add_ps(_mm_loadu_ps(out + 4 * i + offsets[6]), res6);</div><div class="line"><a name="l03072"></a><span class="lineno"> 3072</span>&#160;          _mm_storeu_ps(out + 4 * i + offsets[6], res6);</div><div class="line"><a name="l03073"></a><span class="lineno"> 3073</span>&#160;          res7 = _mm_add_ps(_mm_loadu_ps(out + 4 * i + offsets[7]), res7);</div><div class="line"><a name="l03074"></a><span class="lineno"> 3074</span>&#160;          _mm_storeu_ps(out + 4 * i + offsets[7], res7);</div><div class="line"><a name="l03075"></a><span class="lineno"> 3075</span>&#160;        }</div><div class="line"><a name="l03076"></a><span class="lineno"> 3076</span>&#160;      <span class="keywordflow">else</span></div><div class="line"><a name="l03077"></a><span class="lineno"> 3077</span>&#160;        {</div><div class="line"><a name="l03078"></a><span class="lineno"> 3078</span>&#160;          _mm_storeu_ps(out + 4 * i + offsets[0], res0);</div><div class="line"><a name="l03079"></a><span class="lineno"> 3079</span>&#160;          _mm_storeu_ps(out + 4 * i + offsets[1], res1);</div><div class="line"><a name="l03080"></a><span class="lineno"> 3080</span>&#160;          _mm_storeu_ps(out + 4 * i + offsets[2], res2);</div><div class="line"><a name="l03081"></a><span class="lineno"> 3081</span>&#160;          _mm_storeu_ps(out + 4 * i + offsets[3], res3);</div><div class="line"><a name="l03082"></a><span class="lineno"> 3082</span>&#160;          _mm_storeu_ps(out + 4 * i + offsets[4], res4);</div><div class="line"><a name="l03083"></a><span class="lineno"> 3083</span>&#160;          _mm_storeu_ps(out + 4 * i + offsets[5], res5);</div><div class="line"><a name="l03084"></a><span class="lineno"> 3084</span>&#160;          _mm_storeu_ps(out + 4 * i + offsets[6], res6);</div><div class="line"><a name="l03085"></a><span class="lineno"> 3085</span>&#160;          _mm_storeu_ps(out + 4 * i + offsets[7], res7);</div><div class="line"><a name="l03086"></a><span class="lineno"> 3086</span>&#160;        }</div><div class="line"><a name="l03087"></a><span class="lineno"> 3087</span>&#160;    }</div><div class="line"><a name="l03088"></a><span class="lineno"> 3088</span>&#160;</div><div class="line"><a name="l03089"></a><span class="lineno"> 3089</span>&#160;  <span class="comment">// remainder loop of work that does not divide by 4</span></div><div class="line"><a name="l03090"></a><span class="lineno"> 3090</span>&#160;  <span class="keywordflow">if</span> (add_into)</div><div class="line"><a name="l03091"></a><span class="lineno"> 3091</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i = 4 * n_chunks; i &lt; n_entries; ++i)</div><div class="line"><a name="l03092"></a><span class="lineno"> 3092</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> v = 0; v &lt; 8; ++v)</div><div class="line"><a name="l03093"></a><span class="lineno"> 3093</span>&#160;        out[offsets[v] + i] += in[i][v];</div><div class="line"><a name="l03094"></a><span class="lineno"> 3094</span>&#160;  <span class="keywordflow">else</span></div><div class="line"><a name="l03095"></a><span class="lineno"> 3095</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i = 4 * n_chunks; i &lt; n_entries; ++i)</div><div class="line"><a name="l03096"></a><span class="lineno"> 3096</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> v = 0; v &lt; 8; ++v)</div><div class="line"><a name="l03097"></a><span class="lineno"> 3097</span>&#160;        out[offsets[v] + i] = in[i][v];</div><div class="line"><a name="l03098"></a><span class="lineno"> 3098</span>&#160;}</div><div class="line"><a name="l03099"></a><span class="lineno"> 3099</span>&#160;</div><div class="line"><a name="l03100"></a><span class="lineno"> 3100</span>&#160;</div><div class="line"><a name="l03101"></a><span class="lineno"> 3101</span>&#160;</div><div class="line"><a name="l03107"></a><span class="lineno"> 3107</span>&#160;<span class="keyword">template</span> &lt;&gt;</div><div class="line"><a name="l03108"></a><span class="lineno"> 3108</span>&#160;<span class="keyword">inline</span> <a class="code" href="config_8h.html#a1d1d58e8be15e5c4285f6892e5f33136">DEAL_II_ALWAYS_INLINE</a> <span class="keywordtype">void</span></div><div class="line"><a name="l03109"></a><span class="lineno"> 3109</span>&#160;<a class="code" href="vectorization_8h.html#af396b43c783502e8acd2ca7d071a7325">vectorized_transpose_and_store</a>(<span class="keyword">const</span> <span class="keywordtype">bool</span>                       add_into,</div><div class="line"><a name="l03110"></a><span class="lineno"> 3110</span>&#160;                               <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span>               n_entries,</div><div class="line"><a name="l03111"></a><span class="lineno"> 3111</span>&#160;                               <span class="keyword">const</span> <a class="code" href="classVectorizedArray.html">VectorizedArray&lt;float, 8&gt;</a> *in,</div><div class="line"><a name="l03112"></a><span class="lineno"> 3112</span>&#160;                               std::array&lt;float *, 8&gt; &amp;         out)</div><div class="line"><a name="l03113"></a><span class="lineno"> 3113</span>&#160;{</div><div class="line"><a name="l03114"></a><span class="lineno"> 3114</span>&#160;  <span class="comment">// see the comments in the vectorized_transpose_and_store above</span></div><div class="line"><a name="l03115"></a><span class="lineno"> 3115</span>&#160;</div><div class="line"><a name="l03116"></a><span class="lineno"> 3116</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> n_chunks = n_entries / 4;</div><div class="line"><a name="l03117"></a><span class="lineno"> 3117</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i = 0; i &lt; n_chunks; ++i)</div><div class="line"><a name="l03118"></a><span class="lineno"> 3118</span>&#160;    {</div><div class="line"><a name="l03119"></a><span class="lineno"> 3119</span>&#160;      __m256 u0   = in[4 * i + 0].<a class="code" href="classVectorizedArray.html#ad38190d02537705964e021da7ecbab3f">data</a>;</div><div class="line"><a name="l03120"></a><span class="lineno"> 3120</span>&#160;      __m256 u1   = in[4 * i + 1].<a class="code" href="classVectorizedArray.html#ad38190d02537705964e021da7ecbab3f">data</a>;</div><div class="line"><a name="l03121"></a><span class="lineno"> 3121</span>&#160;      __m256 u2   = in[4 * i + 2].<a class="code" href="classVectorizedArray.html#ad38190d02537705964e021da7ecbab3f">data</a>;</div><div class="line"><a name="l03122"></a><span class="lineno"> 3122</span>&#160;      __m256 u3   = in[4 * i + 3].<a class="code" href="classVectorizedArray.html#ad38190d02537705964e021da7ecbab3f">data</a>;</div><div class="line"><a name="l03123"></a><span class="lineno"> 3123</span>&#160;      __m256 t0   = _mm256_shuffle_ps(u0, u1, 0x44);</div><div class="line"><a name="l03124"></a><span class="lineno"> 3124</span>&#160;      __m256 t1   = _mm256_shuffle_ps(u0, u1, 0xee);</div><div class="line"><a name="l03125"></a><span class="lineno"> 3125</span>&#160;      __m256 t2   = _mm256_shuffle_ps(u2, u3, 0x44);</div><div class="line"><a name="l03126"></a><span class="lineno"> 3126</span>&#160;      __m256 t3   = _mm256_shuffle_ps(u2, u3, 0xee);</div><div class="line"><a name="l03127"></a><span class="lineno"> 3127</span>&#160;      u0          = _mm256_shuffle_ps(t0, t2, 0x88);</div><div class="line"><a name="l03128"></a><span class="lineno"> 3128</span>&#160;      u1          = _mm256_shuffle_ps(t0, t2, 0xdd);</div><div class="line"><a name="l03129"></a><span class="lineno"> 3129</span>&#160;      u2          = _mm256_shuffle_ps(t1, t3, 0x88);</div><div class="line"><a name="l03130"></a><span class="lineno"> 3130</span>&#160;      u3          = _mm256_shuffle_ps(t1, t3, 0xdd);</div><div class="line"><a name="l03131"></a><span class="lineno"> 3131</span>&#160;      __m128 res0 = _mm256_extractf128_ps(u0, 0);</div><div class="line"><a name="l03132"></a><span class="lineno"> 3132</span>&#160;      __m128 res4 = _mm256_extractf128_ps(u0, 1);</div><div class="line"><a name="l03133"></a><span class="lineno"> 3133</span>&#160;      __m128 res1 = _mm256_extractf128_ps(u1, 0);</div><div class="line"><a name="l03134"></a><span class="lineno"> 3134</span>&#160;      __m128 res5 = _mm256_extractf128_ps(u1, 1);</div><div class="line"><a name="l03135"></a><span class="lineno"> 3135</span>&#160;      __m128 res2 = _mm256_extractf128_ps(u2, 0);</div><div class="line"><a name="l03136"></a><span class="lineno"> 3136</span>&#160;      __m128 res6 = _mm256_extractf128_ps(u2, 1);</div><div class="line"><a name="l03137"></a><span class="lineno"> 3137</span>&#160;      __m128 res3 = _mm256_extractf128_ps(u3, 0);</div><div class="line"><a name="l03138"></a><span class="lineno"> 3138</span>&#160;      __m128 res7 = _mm256_extractf128_ps(u3, 1);</div><div class="line"><a name="l03139"></a><span class="lineno"> 3139</span>&#160;</div><div class="line"><a name="l03140"></a><span class="lineno"> 3140</span>&#160;      <span class="keywordflow">if</span> (add_into)</div><div class="line"><a name="l03141"></a><span class="lineno"> 3141</span>&#160;        {</div><div class="line"><a name="l03142"></a><span class="lineno"> 3142</span>&#160;          res0 = _mm_add_ps(_mm_loadu_ps(out[0] + 4 * i), res0);</div><div class="line"><a name="l03143"></a><span class="lineno"> 3143</span>&#160;          _mm_storeu_ps(out[0] + 4 * i, res0);</div><div class="line"><a name="l03144"></a><span class="lineno"> 3144</span>&#160;          res1 = _mm_add_ps(_mm_loadu_ps(out[1] + 4 * i), res1);</div><div class="line"><a name="l03145"></a><span class="lineno"> 3145</span>&#160;          _mm_storeu_ps(out[1] + 4 * i, res1);</div><div class="line"><a name="l03146"></a><span class="lineno"> 3146</span>&#160;          res2 = _mm_add_ps(_mm_loadu_ps(out[2] + 4 * i), res2);</div><div class="line"><a name="l03147"></a><span class="lineno"> 3147</span>&#160;          _mm_storeu_ps(out[2] + 4 * i, res2);</div><div class="line"><a name="l03148"></a><span class="lineno"> 3148</span>&#160;          res3 = _mm_add_ps(_mm_loadu_ps(out[3] + 4 * i), res3);</div><div class="line"><a name="l03149"></a><span class="lineno"> 3149</span>&#160;          _mm_storeu_ps(out[3] + 4 * i, res3);</div><div class="line"><a name="l03150"></a><span class="lineno"> 3150</span>&#160;          res4 = _mm_add_ps(_mm_loadu_ps(out[4] + 4 * i), res4);</div><div class="line"><a name="l03151"></a><span class="lineno"> 3151</span>&#160;          _mm_storeu_ps(out[4] + 4 * i, res4);</div><div class="line"><a name="l03152"></a><span class="lineno"> 3152</span>&#160;          res5 = _mm_add_ps(_mm_loadu_ps(out[5] + 4 * i), res5);</div><div class="line"><a name="l03153"></a><span class="lineno"> 3153</span>&#160;          _mm_storeu_ps(out[5] + 4 * i, res5);</div><div class="line"><a name="l03154"></a><span class="lineno"> 3154</span>&#160;          res6 = _mm_add_ps(_mm_loadu_ps(out[6] + 4 * i), res6);</div><div class="line"><a name="l03155"></a><span class="lineno"> 3155</span>&#160;          _mm_storeu_ps(out[6] + 4 * i, res6);</div><div class="line"><a name="l03156"></a><span class="lineno"> 3156</span>&#160;          res7 = _mm_add_ps(_mm_loadu_ps(out[7] + 4 * i), res7);</div><div class="line"><a name="l03157"></a><span class="lineno"> 3157</span>&#160;          _mm_storeu_ps(out[7] + 4 * i, res7);</div><div class="line"><a name="l03158"></a><span class="lineno"> 3158</span>&#160;        }</div><div class="line"><a name="l03159"></a><span class="lineno"> 3159</span>&#160;      <span class="keywordflow">else</span></div><div class="line"><a name="l03160"></a><span class="lineno"> 3160</span>&#160;        {</div><div class="line"><a name="l03161"></a><span class="lineno"> 3161</span>&#160;          _mm_storeu_ps(out[0] + 4 * i, res0);</div><div class="line"><a name="l03162"></a><span class="lineno"> 3162</span>&#160;          _mm_storeu_ps(out[1] + 4 * i, res1);</div><div class="line"><a name="l03163"></a><span class="lineno"> 3163</span>&#160;          _mm_storeu_ps(out[2] + 4 * i, res2);</div><div class="line"><a name="l03164"></a><span class="lineno"> 3164</span>&#160;          _mm_storeu_ps(out[3] + 4 * i, res3);</div><div class="line"><a name="l03165"></a><span class="lineno"> 3165</span>&#160;          _mm_storeu_ps(out[4] + 4 * i, res4);</div><div class="line"><a name="l03166"></a><span class="lineno"> 3166</span>&#160;          _mm_storeu_ps(out[5] + 4 * i, res5);</div><div class="line"><a name="l03167"></a><span class="lineno"> 3167</span>&#160;          _mm_storeu_ps(out[6] + 4 * i, res6);</div><div class="line"><a name="l03168"></a><span class="lineno"> 3168</span>&#160;          _mm_storeu_ps(out[7] + 4 * i, res7);</div><div class="line"><a name="l03169"></a><span class="lineno"> 3169</span>&#160;        }</div><div class="line"><a name="l03170"></a><span class="lineno"> 3170</span>&#160;    }</div><div class="line"><a name="l03171"></a><span class="lineno"> 3171</span>&#160;</div><div class="line"><a name="l03172"></a><span class="lineno"> 3172</span>&#160;  <span class="keywordflow">if</span> (add_into)</div><div class="line"><a name="l03173"></a><span class="lineno"> 3173</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i = 4 * n_chunks; i &lt; n_entries; ++i)</div><div class="line"><a name="l03174"></a><span class="lineno"> 3174</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> v = 0; v &lt; 8; ++v)</div><div class="line"><a name="l03175"></a><span class="lineno"> 3175</span>&#160;        out[v][i] += in[i][v];</div><div class="line"><a name="l03176"></a><span class="lineno"> 3176</span>&#160;  <span class="keywordflow">else</span></div><div class="line"><a name="l03177"></a><span class="lineno"> 3177</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i = 4 * n_chunks; i &lt; n_entries; ++i)</div><div class="line"><a name="l03178"></a><span class="lineno"> 3178</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> v = 0; v &lt; 8; ++v)</div><div class="line"><a name="l03179"></a><span class="lineno"> 3179</span>&#160;        out[v][i] = in[i][v];</div><div class="line"><a name="l03180"></a><span class="lineno"> 3180</span>&#160;}</div><div class="line"><a name="l03181"></a><span class="lineno"> 3181</span>&#160;</div><div class="line"><a name="l03182"></a><span class="lineno"> 3182</span>&#160;<span class="preprocessor">#  endif</span></div><div class="line"><a name="l03183"></a><span class="lineno"> 3183</span>&#160;</div><div class="line"><a name="l03184"></a><span class="lineno"> 3184</span>&#160;<span class="preprocessor">#  if DEAL_II_VECTORIZATION_WIDTH_IN_BITS &gt;= 128 &amp;&amp; defined(__SSE2__)</span></div><div class="line"><a name="l03185"></a><span class="lineno"> 3185</span>&#160;</div><div class="line"><a name="l03191"></a><span class="lineno"> 3191</span>&#160;<span class="keyword">template</span> &lt;&gt;</div><div class="line"><a name="l03192"></a><span class="lineno"> 3192</span>&#160;<span class="keyword">class </span><a class="code" href="classVectorizedArray.html">VectorizedArray</a>&lt;double, 2&gt;</div><div class="line"><a name="l03193"></a><span class="lineno"> 3193</span>&#160;  : <span class="keyword">public</span> <a class="code" href="classVectorizedArrayBase.html">VectorizedArrayBase</a>&lt;VectorizedArray&lt;double, 2&gt;, 2&gt;</div><div class="line"><a name="l03194"></a><span class="lineno"> 3194</span>&#160;{</div><div class="line"><a name="l03195"></a><span class="lineno"> 3195</span>&#160;<span class="keyword">public</span>:</div><div class="line"><a name="l03200"></a><span class="lineno"> 3200</span>&#160;  <span class="keyword">using</span> value_type = double;</div><div class="line"><a name="l03201"></a><span class="lineno"> 3201</span>&#160;</div><div class="line"><a name="l03206"></a><span class="lineno"> 3206</span>&#160;  <a class="code" href="classVectorizedArray.html">VectorizedArray</a>() = <span class="keywordflow">default</span>;</div><div class="line"><a name="l03207"></a><span class="lineno"> 3207</span>&#160;</div><div class="line"><a name="l03212"></a><span class="lineno"> 3212</span>&#160;  <a class="code" href="classVectorizedArray.html">VectorizedArray</a>(<span class="keyword">const</span> <span class="keywordtype">double</span> scalar)</div><div class="line"><a name="l03213"></a><span class="lineno"> 3213</span>&#160;  {</div><div class="line"><a name="l03214"></a><span class="lineno"> 3214</span>&#160;    this-&gt;operator=(scalar);</div><div class="line"><a name="l03215"></a><span class="lineno"> 3215</span>&#160;  }</div><div class="line"><a name="l03216"></a><span class="lineno"> 3216</span>&#160;</div><div class="line"><a name="l03221"></a><span class="lineno"> 3221</span>&#160;  <a class="code" href="config_8h.html#a1d1d58e8be15e5c4285f6892e5f33136">DEAL_II_ALWAYS_INLINE</a></div><div class="line"><a name="l03222"></a><span class="lineno"> 3222</span>&#160;  <a class="code" href="classVectorizedArray.html">VectorizedArray</a> &amp;</div><div class="line"><a name="l03223"></a><span class="lineno"> 3223</span>&#160;  operator=(<span class="keyword">const</span> <span class="keywordtype">double</span> x)</div><div class="line"><a name="l03224"></a><span class="lineno"> 3224</span>&#160;  {</div><div class="line"><a name="l03225"></a><span class="lineno"> 3225</span>&#160;    data = _mm_set1_pd(x);</div><div class="line"><a name="l03226"></a><span class="lineno"> 3226</span>&#160;    <span class="keywordflow">return</span> *<span class="keyword">this</span>;</div><div class="line"><a name="l03227"></a><span class="lineno"> 3227</span>&#160;  }</div><div class="line"><a name="l03228"></a><span class="lineno"> 3228</span>&#160;</div><div class="line"><a name="l03233"></a><span class="lineno"> 3233</span>&#160;  <a class="code" href="config_8h.html#a1d1d58e8be15e5c4285f6892e5f33136">DEAL_II_ALWAYS_INLINE</a></div><div class="line"><a name="l03234"></a><span class="lineno"> 3234</span>&#160;  <span class="keywordtype">double</span> &amp;operator[](<span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> comp)</div><div class="line"><a name="l03235"></a><span class="lineno"> 3235</span>&#160;  {</div><div class="line"><a name="l03236"></a><span class="lineno"> 3236</span>&#160;    <a class="code" href="group__Exceptions.html#gaafbb69cc2a791ae55880fd8d57d0c1b0">AssertIndexRange</a>(comp, 2);</div><div class="line"><a name="l03237"></a><span class="lineno"> 3237</span>&#160;    <span class="keywordflow">return</span> *(<span class="keyword">reinterpret_cast&lt;</span><span class="keywordtype">double</span> *<span class="keyword">&gt;</span>(&amp;data) + comp);</div><div class="line"><a name="l03238"></a><span class="lineno"> 3238</span>&#160;  }</div><div class="line"><a name="l03239"></a><span class="lineno"> 3239</span>&#160;</div><div class="line"><a name="l03244"></a><span class="lineno"> 3244</span>&#160;  <a class="code" href="config_8h.html#a1d1d58e8be15e5c4285f6892e5f33136">DEAL_II_ALWAYS_INLINE</a></div><div class="line"><a name="l03245"></a><span class="lineno"> 3245</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">double</span> &amp;operator[](<span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> comp)<span class="keyword"> const</span></div><div class="line"><a name="l03246"></a><span class="lineno"> 3246</span>&#160;<span class="keyword">  </span>{</div><div class="line"><a name="l03247"></a><span class="lineno"> 3247</span>&#160;    <a class="code" href="group__Exceptions.html#gaafbb69cc2a791ae55880fd8d57d0c1b0">AssertIndexRange</a>(comp, 2);</div><div class="line"><a name="l03248"></a><span class="lineno"> 3248</span>&#160;    <span class="keywordflow">return</span> *(<span class="keyword">reinterpret_cast&lt;</span><span class="keyword">const </span><span class="keywordtype">double</span> *<span class="keyword">&gt;</span>(&amp;data) + comp);</div><div class="line"><a name="l03249"></a><span class="lineno"> 3249</span>&#160;  }</div><div class="line"><a name="l03250"></a><span class="lineno"> 3250</span>&#160;</div><div class="line"><a name="l03255"></a><span class="lineno"> 3255</span>&#160;  <a class="code" href="config_8h.html#a1d1d58e8be15e5c4285f6892e5f33136">DEAL_II_ALWAYS_INLINE</a></div><div class="line"><a name="l03256"></a><span class="lineno"> 3256</span>&#160;  <a class="code" href="classVectorizedArray.html">VectorizedArray</a> &amp;</div><div class="line"><a name="l03257"></a><span class="lineno"> 3257</span>&#160;  operator+=(<span class="keyword">const</span> <a class="code" href="classVectorizedArray.html">VectorizedArray</a> &amp;vec)</div><div class="line"><a name="l03258"></a><span class="lineno"> 3258</span>&#160;  {</div><div class="line"><a name="l03259"></a><span class="lineno"> 3259</span>&#160;<span class="preprocessor">#    ifdef DEAL_II_COMPILER_USE_VECTOR_ARITHMETICS</span></div><div class="line"><a name="l03260"></a><span class="lineno"> 3260</span>&#160;    data += vec.<a class="code" href="classVectorizedArray.html#ad38190d02537705964e021da7ecbab3f">data</a>;</div><div class="line"><a name="l03261"></a><span class="lineno"> 3261</span>&#160;<span class="preprocessor">#    else</span></div><div class="line"><a name="l03262"></a><span class="lineno"> 3262</span>&#160;    data = _mm_add_pd(data, vec.<a class="code" href="classVectorizedArray.html#ad38190d02537705964e021da7ecbab3f">data</a>);</div><div class="line"><a name="l03263"></a><span class="lineno"> 3263</span>&#160;<span class="preprocessor">#    endif</span></div><div class="line"><a name="l03264"></a><span class="lineno"> 3264</span>&#160;    <span class="keywordflow">return</span> *<span class="keyword">this</span>;</div><div class="line"><a name="l03265"></a><span class="lineno"> 3265</span>&#160;  }</div><div class="line"><a name="l03266"></a><span class="lineno"> 3266</span>&#160;</div><div class="line"><a name="l03271"></a><span class="lineno"> 3271</span>&#160;  <a class="code" href="config_8h.html#a1d1d58e8be15e5c4285f6892e5f33136">DEAL_II_ALWAYS_INLINE</a></div><div class="line"><a name="l03272"></a><span class="lineno"> 3272</span>&#160;  <a class="code" href="classVectorizedArray.html">VectorizedArray</a> &amp;</div><div class="line"><a name="l03273"></a><span class="lineno"> 3273</span>&#160;  operator-=(<span class="keyword">const</span> <a class="code" href="classVectorizedArray.html">VectorizedArray</a> &amp;vec)</div><div class="line"><a name="l03274"></a><span class="lineno"> 3274</span>&#160;  {</div><div class="line"><a name="l03275"></a><span class="lineno"> 3275</span>&#160;<span class="preprocessor">#    ifdef DEAL_II_COMPILER_USE_VECTOR_ARITHMETICS</span></div><div class="line"><a name="l03276"></a><span class="lineno"> 3276</span>&#160;    data -= vec.<a class="code" href="classVectorizedArray.html#ad38190d02537705964e021da7ecbab3f">data</a>;</div><div class="line"><a name="l03277"></a><span class="lineno"> 3277</span>&#160;<span class="preprocessor">#    else</span></div><div class="line"><a name="l03278"></a><span class="lineno"> 3278</span>&#160;    data = _mm_sub_pd(data, vec.<a class="code" href="classVectorizedArray.html#ad38190d02537705964e021da7ecbab3f">data</a>);</div><div class="line"><a name="l03279"></a><span class="lineno"> 3279</span>&#160;<span class="preprocessor">#    endif</span></div><div class="line"><a name="l03280"></a><span class="lineno"> 3280</span>&#160;    <span class="keywordflow">return</span> *<span class="keyword">this</span>;</div><div class="line"><a name="l03281"></a><span class="lineno"> 3281</span>&#160;  }</div><div class="line"><a name="l03282"></a><span class="lineno"> 3282</span>&#160;</div><div class="line"><a name="l03287"></a><span class="lineno"> 3287</span>&#160;  <a class="code" href="config_8h.html#a1d1d58e8be15e5c4285f6892e5f33136">DEAL_II_ALWAYS_INLINE</a></div><div class="line"><a name="l03288"></a><span class="lineno"> 3288</span>&#160;  <a class="code" href="classVectorizedArray.html">VectorizedArray</a> &amp;</div><div class="line"><a name="l03289"></a><span class="lineno"> 3289</span>&#160;  operator*=(<span class="keyword">const</span> <a class="code" href="classVectorizedArray.html">VectorizedArray</a> &amp;vec)</div><div class="line"><a name="l03290"></a><span class="lineno"> 3290</span>&#160;  {</div><div class="line"><a name="l03291"></a><span class="lineno"> 3291</span>&#160;<span class="preprocessor">#    ifdef DEAL_II_COMPILER_USE_VECTOR_ARITHMETICS</span></div><div class="line"><a name="l03292"></a><span class="lineno"> 3292</span>&#160;    data *= vec.<a class="code" href="classVectorizedArray.html#ad38190d02537705964e021da7ecbab3f">data</a>;</div><div class="line"><a name="l03293"></a><span class="lineno"> 3293</span>&#160;<span class="preprocessor">#    else</span></div><div class="line"><a name="l03294"></a><span class="lineno"> 3294</span>&#160;    data = _mm_mul_pd(data, vec.<a class="code" href="classVectorizedArray.html#ad38190d02537705964e021da7ecbab3f">data</a>);</div><div class="line"><a name="l03295"></a><span class="lineno"> 3295</span>&#160;<span class="preprocessor">#    endif</span></div><div class="line"><a name="l03296"></a><span class="lineno"> 3296</span>&#160;    <span class="keywordflow">return</span> *<span class="keyword">this</span>;</div><div class="line"><a name="l03297"></a><span class="lineno"> 3297</span>&#160;  }</div><div class="line"><a name="l03298"></a><span class="lineno"> 3298</span>&#160;</div><div class="line"><a name="l03303"></a><span class="lineno"> 3303</span>&#160;  <a class="code" href="config_8h.html#a1d1d58e8be15e5c4285f6892e5f33136">DEAL_II_ALWAYS_INLINE</a></div><div class="line"><a name="l03304"></a><span class="lineno"> 3304</span>&#160;  <a class="code" href="classVectorizedArray.html">VectorizedArray</a> &amp;</div><div class="line"><a name="l03305"></a><span class="lineno"> 3305</span>&#160;  operator/=(<span class="keyword">const</span> <a class="code" href="classVectorizedArray.html">VectorizedArray</a> &amp;vec)</div><div class="line"><a name="l03306"></a><span class="lineno"> 3306</span>&#160;  {</div><div class="line"><a name="l03307"></a><span class="lineno"> 3307</span>&#160;<span class="preprocessor">#    ifdef DEAL_II_COMPILER_USE_VECTOR_ARITHMETICS</span></div><div class="line"><a name="l03308"></a><span class="lineno"> 3308</span>&#160;    data /= vec.<a class="code" href="classVectorizedArray.html#ad38190d02537705964e021da7ecbab3f">data</a>;</div><div class="line"><a name="l03309"></a><span class="lineno"> 3309</span>&#160;<span class="preprocessor">#    else</span></div><div class="line"><a name="l03310"></a><span class="lineno"> 3310</span>&#160;    data = _mm_div_pd(data, vec.<a class="code" href="classVectorizedArray.html#ad38190d02537705964e021da7ecbab3f">data</a>);</div><div class="line"><a name="l03311"></a><span class="lineno"> 3311</span>&#160;<span class="preprocessor">#    endif</span></div><div class="line"><a name="l03312"></a><span class="lineno"> 3312</span>&#160;    <span class="keywordflow">return</span> *<span class="keyword">this</span>;</div><div class="line"><a name="l03313"></a><span class="lineno"> 3313</span>&#160;  }</div><div class="line"><a name="l03314"></a><span class="lineno"> 3314</span>&#160;</div><div class="line"><a name="l03320"></a><span class="lineno"> 3320</span>&#160;  <a class="code" href="config_8h.html#a1d1d58e8be15e5c4285f6892e5f33136">DEAL_II_ALWAYS_INLINE</a></div><div class="line"><a name="l03321"></a><span class="lineno"> 3321</span>&#160;  <span class="keywordtype">void</span></div><div class="line"><a name="l03322"></a><span class="lineno"> 3322</span>&#160;  load(<span class="keyword">const</span> <span class="keywordtype">double</span> *ptr)</div><div class="line"><a name="l03323"></a><span class="lineno"> 3323</span>&#160;  {</div><div class="line"><a name="l03324"></a><span class="lineno"> 3324</span>&#160;    data = _mm_loadu_pd(ptr);</div><div class="line"><a name="l03325"></a><span class="lineno"> 3325</span>&#160;  }</div><div class="line"><a name="l03326"></a><span class="lineno"> 3326</span>&#160;</div><div class="line"><a name="l03332"></a><span class="lineno"> 3332</span>&#160;  <a class="code" href="config_8h.html#a1d1d58e8be15e5c4285f6892e5f33136">DEAL_II_ALWAYS_INLINE</a></div><div class="line"><a name="l03333"></a><span class="lineno"> 3333</span>&#160;  <span class="keywordtype">void</span></div><div class="line"><a name="l03334"></a><span class="lineno"> 3334</span>&#160;  store(<span class="keywordtype">double</span> *ptr)<span class="keyword"> const</span></div><div class="line"><a name="l03335"></a><span class="lineno"> 3335</span>&#160;<span class="keyword">  </span>{</div><div class="line"><a name="l03336"></a><span class="lineno"> 3336</span>&#160;    _mm_storeu_pd(ptr, data);</div><div class="line"><a name="l03337"></a><span class="lineno"> 3337</span>&#160;  }</div><div class="line"><a name="l03338"></a><span class="lineno"> 3338</span>&#160;</div><div class="line"><a name="l03344"></a><span class="lineno"> 3344</span>&#160;  <a class="code" href="config_8h.html#a1d1d58e8be15e5c4285f6892e5f33136">DEAL_II_ALWAYS_INLINE</a></div><div class="line"><a name="l03345"></a><span class="lineno"> 3345</span>&#160;  <span class="keywordtype">void</span></div><div class="line"><a name="l03346"></a><span class="lineno"> 3346</span>&#160;  streaming_store(<span class="keywordtype">double</span> *ptr)<span class="keyword"> const</span></div><div class="line"><a name="l03347"></a><span class="lineno"> 3347</span>&#160;<span class="keyword">  </span>{</div><div class="line"><a name="l03348"></a><span class="lineno"> 3348</span>&#160;    <a class="code" href="group__Exceptions.html#ga70a0bb353656e704acf927945277bbc6">Assert</a>(reinterpret_cast&lt;std::size_t&gt;(ptr) % 16 == 0,</div><div class="line"><a name="l03349"></a><span class="lineno"> 3349</span>&#160;           <a class="code" href="group__Exceptions.html#gae9a45f517af1401c50811a11083f9114">ExcMessage</a>(<span class="stringliteral">&quot;Memory not aligned&quot;</span>));</div><div class="line"><a name="l03350"></a><span class="lineno"> 3350</span>&#160;    _mm_stream_pd(ptr, data);</div><div class="line"><a name="l03351"></a><span class="lineno"> 3351</span>&#160;  }</div><div class="line"><a name="l03352"></a><span class="lineno"> 3352</span>&#160;</div><div class="line"><a name="l03363"></a><span class="lineno"> 3363</span>&#160;  <a class="code" href="config_8h.html#a1d1d58e8be15e5c4285f6892e5f33136">DEAL_II_ALWAYS_INLINE</a></div><div class="line"><a name="l03364"></a><span class="lineno"> 3364</span>&#160;  <span class="keywordtype">void</span></div><div class="line"><a name="l03365"></a><span class="lineno"> 3365</span>&#160;  <a class="code" href="vectorization_8h.html#a078ca5de8d3a59aedc130823be15ad26">gather</a>(<span class="keyword">const</span> <span class="keywordtype">double</span> *base_ptr, <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> *offsets)</div><div class="line"><a name="l03366"></a><span class="lineno"> 3366</span>&#160;  {</div><div class="line"><a name="l03367"></a><span class="lineno"> 3367</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i = 0; i &lt; 2; ++i)</div><div class="line"><a name="l03368"></a><span class="lineno"> 3368</span>&#160;      *(reinterpret_cast&lt;double *&gt;(&amp;data) + i) = base_ptr[offsets[i]];</div><div class="line"><a name="l03369"></a><span class="lineno"> 3369</span>&#160;  }</div><div class="line"><a name="l03370"></a><span class="lineno"> 3370</span>&#160;</div><div class="line"><a name="l03381"></a><span class="lineno"> 3381</span>&#160;  <a class="code" href="config_8h.html#a1d1d58e8be15e5c4285f6892e5f33136">DEAL_II_ALWAYS_INLINE</a></div><div class="line"><a name="l03382"></a><span class="lineno"> 3382</span>&#160;  <span class="keywordtype">void</span></div><div class="line"><a name="l03383"></a><span class="lineno"> 3383</span>&#160;  scatter(<span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> *offsets, <span class="keywordtype">double</span> *base_ptr)<span class="keyword"> const</span></div><div class="line"><a name="l03384"></a><span class="lineno"> 3384</span>&#160;<span class="keyword">  </span>{</div><div class="line"><a name="l03385"></a><span class="lineno"> 3385</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i = 0; i &lt; 2; ++i)</div><div class="line"><a name="l03386"></a><span class="lineno"> 3386</span>&#160;      base_ptr[offsets[i]] = *(reinterpret_cast&lt;const double *&gt;(&amp;data) + i);</div><div class="line"><a name="l03387"></a><span class="lineno"> 3387</span>&#160;  }</div><div class="line"><a name="l03388"></a><span class="lineno"> 3388</span>&#160;</div><div class="line"><a name="l03393"></a><span class="lineno"> 3393</span>&#160;  __m128d data;</div><div class="line"><a name="l03394"></a><span class="lineno"> 3394</span>&#160;</div><div class="line"><a name="l03395"></a><span class="lineno"> 3395</span>&#160;<span class="keyword">private</span>:</div><div class="line"><a name="l03400"></a><span class="lineno"> 3400</span>&#160;  <a class="code" href="config_8h.html#a1d1d58e8be15e5c4285f6892e5f33136">DEAL_II_ALWAYS_INLINE</a></div><div class="line"><a name="l03401"></a><span class="lineno"> 3401</span>&#160;  <a class="code" href="classVectorizedArray.html">VectorizedArray</a></div><div class="line"><a name="l03402"></a><span class="lineno"> 3402</span>&#160;  get_sqrt()<span class="keyword"> const</span></div><div class="line"><a name="l03403"></a><span class="lineno"> 3403</span>&#160;<span class="keyword">  </span>{</div><div class="line"><a name="l03404"></a><span class="lineno"> 3404</span>&#160;    <a class="code" href="classVectorizedArray.html">VectorizedArray</a> res;</div><div class="line"><a name="l03405"></a><span class="lineno"> 3405</span>&#160;    res.<a class="code" href="classVectorizedArray.html#ad38190d02537705964e021da7ecbab3f">data</a> = _mm_sqrt_pd(data);</div><div class="line"><a name="l03406"></a><span class="lineno"> 3406</span>&#160;    <span class="keywordflow">return</span> res;</div><div class="line"><a name="l03407"></a><span class="lineno"> 3407</span>&#160;  }</div><div class="line"><a name="l03408"></a><span class="lineno"> 3408</span>&#160;</div><div class="line"><a name="l03413"></a><span class="lineno"> 3413</span>&#160;  <a class="code" href="config_8h.html#a1d1d58e8be15e5c4285f6892e5f33136">DEAL_II_ALWAYS_INLINE</a></div><div class="line"><a name="l03414"></a><span class="lineno"> 3414</span>&#160;  <a class="code" href="classVectorizedArray.html">VectorizedArray</a></div><div class="line"><a name="l03415"></a><span class="lineno"> 3415</span>&#160;  get_abs()<span class="keyword"> const</span></div><div class="line"><a name="l03416"></a><span class="lineno"> 3416</span>&#160;<span class="keyword">  </span>{</div><div class="line"><a name="l03417"></a><span class="lineno"> 3417</span>&#160;    <span class="comment">// to compute the absolute value, perform</span></div><div class="line"><a name="l03418"></a><span class="lineno"> 3418</span>&#160;    <span class="comment">// bitwise andnot with -0. This will leave all</span></div><div class="line"><a name="l03419"></a><span class="lineno"> 3419</span>&#160;    <span class="comment">// value and exponent bits unchanged but force</span></div><div class="line"><a name="l03420"></a><span class="lineno"> 3420</span>&#160;    <span class="comment">// the sign value to +.</span></div><div class="line"><a name="l03421"></a><span class="lineno"> 3421</span>&#160;    __m128d         mask = _mm_set1_pd(-0.);</div><div class="line"><a name="l03422"></a><span class="lineno"> 3422</span>&#160;    <a class="code" href="classVectorizedArray.html">VectorizedArray</a> res;</div><div class="line"><a name="l03423"></a><span class="lineno"> 3423</span>&#160;    res.<a class="code" href="classVectorizedArray.html#ad38190d02537705964e021da7ecbab3f">data</a> = _mm_andnot_pd(mask, data);</div><div class="line"><a name="l03424"></a><span class="lineno"> 3424</span>&#160;    <span class="keywordflow">return</span> res;</div><div class="line"><a name="l03425"></a><span class="lineno"> 3425</span>&#160;  }</div><div class="line"><a name="l03426"></a><span class="lineno"> 3426</span>&#160;</div><div class="line"><a name="l03431"></a><span class="lineno"> 3431</span>&#160;  <a class="code" href="config_8h.html#a1d1d58e8be15e5c4285f6892e5f33136">DEAL_II_ALWAYS_INLINE</a></div><div class="line"><a name="l03432"></a><span class="lineno"> 3432</span>&#160;  <a class="code" href="classVectorizedArray.html">VectorizedArray</a></div><div class="line"><a name="l03433"></a><span class="lineno"> 3433</span>&#160;  get_max(<span class="keyword">const</span> <a class="code" href="classVectorizedArray.html">VectorizedArray</a> &amp;other)<span class="keyword"> const</span></div><div class="line"><a name="l03434"></a><span class="lineno"> 3434</span>&#160;<span class="keyword">  </span>{</div><div class="line"><a name="l03435"></a><span class="lineno"> 3435</span>&#160;    <a class="code" href="classVectorizedArray.html">VectorizedArray</a> res;</div><div class="line"><a name="l03436"></a><span class="lineno"> 3436</span>&#160;    res.<a class="code" href="classVectorizedArray.html#ad38190d02537705964e021da7ecbab3f">data</a> = _mm_max_pd(data, other.<a class="code" href="classVectorizedArray.html#ad38190d02537705964e021da7ecbab3f">data</a>);</div><div class="line"><a name="l03437"></a><span class="lineno"> 3437</span>&#160;    <span class="keywordflow">return</span> res;</div><div class="line"><a name="l03438"></a><span class="lineno"> 3438</span>&#160;  }</div><div class="line"><a name="l03439"></a><span class="lineno"> 3439</span>&#160;</div><div class="line"><a name="l03444"></a><span class="lineno"> 3444</span>&#160;  <a class="code" href="config_8h.html#a1d1d58e8be15e5c4285f6892e5f33136">DEAL_II_ALWAYS_INLINE</a></div><div class="line"><a name="l03445"></a><span class="lineno"> 3445</span>&#160;  <a class="code" href="classVectorizedArray.html">VectorizedArray</a></div><div class="line"><a name="l03446"></a><span class="lineno"> 3446</span>&#160;  get_min(<span class="keyword">const</span> <a class="code" href="classVectorizedArray.html">VectorizedArray</a> &amp;other)<span class="keyword"> const</span></div><div class="line"><a name="l03447"></a><span class="lineno"> 3447</span>&#160;<span class="keyword">  </span>{</div><div class="line"><a name="l03448"></a><span class="lineno"> 3448</span>&#160;    <a class="code" href="classVectorizedArray.html">VectorizedArray</a> res;</div><div class="line"><a name="l03449"></a><span class="lineno"> 3449</span>&#160;    res.<a class="code" href="classVectorizedArray.html#ad38190d02537705964e021da7ecbab3f">data</a> = _mm_min_pd(data, other.<a class="code" href="classVectorizedArray.html#ad38190d02537705964e021da7ecbab3f">data</a>);</div><div class="line"><a name="l03450"></a><span class="lineno"> 3450</span>&#160;    <span class="keywordflow">return</span> res;</div><div class="line"><a name="l03451"></a><span class="lineno"> 3451</span>&#160;  }</div><div class="line"><a name="l03452"></a><span class="lineno"> 3452</span>&#160;</div><div class="line"><a name="l03453"></a><span class="lineno"> 3453</span>&#160;  <span class="comment">// Make a few functions friends.</span></div><div class="line"><a name="l03454"></a><span class="lineno"> 3454</span>&#160;  <span class="keyword">template</span> &lt;<span class="keyword">typename</span> Number2, std::<span class="keywordtype">size_t</span> w<span class="keywordtype">id</span>th2&gt;</div><div class="line"><a name="l03455"></a><span class="lineno"> 3455</span>&#160;  <span class="keyword">friend</span> <a class="code" href="classVectorizedArray.html">VectorizedArray&lt;Number2, width2&gt;</a></div><div class="line"><a name="l03456"></a><span class="lineno"> 3456</span>&#160;  std::sqrt(<span class="keyword">const</span> <a class="code" href="classVectorizedArray.html">VectorizedArray&lt;Number2, width2&gt;</a> &amp;);</div><div class="line"><a name="l03457"></a><span class="lineno"> 3457</span>&#160;  <span class="keyword">template</span> &lt;<span class="keyword">typename</span> Number2, std::<span class="keywordtype">size_t</span> w<span class="keywordtype">id</span>th2&gt;</div><div class="line"><a name="l03458"></a><span class="lineno"> 3458</span>&#160;  <span class="keyword">friend</span> <a class="code" href="classVectorizedArray.html">VectorizedArray&lt;Number2, width2&gt;</a></div><div class="line"><a name="l03459"></a><span class="lineno"> 3459</span>&#160;  std::abs(<span class="keyword">const</span> <a class="code" href="classVectorizedArray.html">VectorizedArray&lt;Number2, width2&gt;</a> &amp;);</div><div class="line"><a name="l03460"></a><span class="lineno"> 3460</span>&#160;  <span class="keyword">template</span> &lt;<span class="keyword">typename</span> Number2, std::<span class="keywordtype">size_t</span> w<span class="keywordtype">id</span>th2&gt;</div><div class="line"><a name="l03461"></a><span class="lineno"> 3461</span>&#160;  <span class="keyword">friend</span> <a class="code" href="classVectorizedArray.html">VectorizedArray&lt;Number2, width2&gt;</a></div><div class="line"><a name="l03462"></a><span class="lineno"> 3462</span>&#160;  std::max(<span class="keyword">const</span> <a class="code" href="classVectorizedArray.html">VectorizedArray&lt;Number2, width2&gt;</a> &amp;,</div><div class="line"><a name="l03463"></a><span class="lineno"> 3463</span>&#160;           <span class="keyword">const</span> <a class="code" href="classVectorizedArray.html">VectorizedArray&lt;Number2, width2&gt;</a> &amp;);</div><div class="line"><a name="l03464"></a><span class="lineno"> 3464</span>&#160;  <span class="keyword">template</span> &lt;<span class="keyword">typename</span> Number2, std::<span class="keywordtype">size_t</span> w<span class="keywordtype">id</span>th2&gt;</div><div class="line"><a name="l03465"></a><span class="lineno"> 3465</span>&#160;  <span class="keyword">friend</span> <a class="code" href="classVectorizedArray.html">VectorizedArray&lt;Number2, width2&gt;</a></div><div class="line"><a name="l03466"></a><span class="lineno"> 3466</span>&#160;  std::min(<span class="keyword">const</span> <a class="code" href="classVectorizedArray.html">VectorizedArray&lt;Number2, width2&gt;</a> &amp;,</div><div class="line"><a name="l03467"></a><span class="lineno"> 3467</span>&#160;           <span class="keyword">const</span> <a class="code" href="classVectorizedArray.html">VectorizedArray&lt;Number2, width2&gt;</a> &amp;);</div><div class="line"><a name="l03468"></a><span class="lineno"> 3468</span>&#160;};</div><div class="line"><a name="l03469"></a><span class="lineno"> 3469</span>&#160;</div><div class="line"><a name="l03470"></a><span class="lineno"> 3470</span>&#160;</div><div class="line"><a name="l03471"></a><span class="lineno"> 3471</span>&#160;</div><div class="line"><a name="l03477"></a><span class="lineno"> 3477</span>&#160;<span class="keyword">template</span> &lt;&gt;</div><div class="line"><a name="l03478"></a><span class="lineno"> 3478</span>&#160;<span class="keyword">inline</span> <a class="code" href="config_8h.html#a1d1d58e8be15e5c4285f6892e5f33136">DEAL_II_ALWAYS_INLINE</a> <span class="keywordtype">void</span></div><div class="line"><a name="l03479"></a><span class="lineno"> 3479</span>&#160;<a class="code" href="vectorization_8h.html#a14da4327264fd3a88a9f73a8f72a9094">vectorized_load_and_transpose</a>(<span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span>          n_entries,</div><div class="line"><a name="l03480"></a><span class="lineno"> 3480</span>&#160;                              <span class="keyword">const</span> <span class="keywordtype">double</span> *              in,</div><div class="line"><a name="l03481"></a><span class="lineno"> 3481</span>&#160;                              <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> *        offsets,</div><div class="line"><a name="l03482"></a><span class="lineno"> 3482</span>&#160;                              <a class="code" href="classVectorizedArray.html">VectorizedArray&lt;double, 2&gt;</a> *out)</div><div class="line"><a name="l03483"></a><span class="lineno"> 3483</span>&#160;{</div><div class="line"><a name="l03484"></a><span class="lineno"> 3484</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> n_chunks = n_entries / 2;</div><div class="line"><a name="l03485"></a><span class="lineno"> 3485</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i = 0; i &lt; n_chunks; ++i)</div><div class="line"><a name="l03486"></a><span class="lineno"> 3486</span>&#160;    {</div><div class="line"><a name="l03487"></a><span class="lineno"> 3487</span>&#160;      __m128d u0          = _mm_loadu_pd(in + 2 * i + offsets[0]);</div><div class="line"><a name="l03488"></a><span class="lineno"> 3488</span>&#160;      __m128d u1          = _mm_loadu_pd(in + 2 * i + offsets[1]);</div><div class="line"><a name="l03489"></a><span class="lineno"> 3489</span>&#160;      out[2 * i + 0].<a class="code" href="classVectorizedArray.html#ad38190d02537705964e021da7ecbab3f">data</a> = _mm_unpacklo_pd(u0, u1);</div><div class="line"><a name="l03490"></a><span class="lineno"> 3490</span>&#160;      out[2 * i + 1].<a class="code" href="classVectorizedArray.html#ad38190d02537705964e021da7ecbab3f">data</a> = _mm_unpackhi_pd(u0, u1);</div><div class="line"><a name="l03491"></a><span class="lineno"> 3491</span>&#160;    }</div><div class="line"><a name="l03492"></a><span class="lineno"> 3492</span>&#160;</div><div class="line"><a name="l03493"></a><span class="lineno"> 3493</span>&#160;  <span class="comment">// remainder loop of work that does not divide by 2</span></div><div class="line"><a name="l03494"></a><span class="lineno"> 3494</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i = 2 * n_chunks; i &lt; n_entries; ++i)</div><div class="line"><a name="l03495"></a><span class="lineno"> 3495</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> v = 0; v &lt; 2; ++v)</div><div class="line"><a name="l03496"></a><span class="lineno"> 3496</span>&#160;      out[i][v] = in[offsets[v] + i];</div><div class="line"><a name="l03497"></a><span class="lineno"> 3497</span>&#160;}</div><div class="line"><a name="l03498"></a><span class="lineno"> 3498</span>&#160;</div><div class="line"><a name="l03499"></a><span class="lineno"> 3499</span>&#160;</div><div class="line"><a name="l03500"></a><span class="lineno"> 3500</span>&#160;</div><div class="line"><a name="l03506"></a><span class="lineno"> 3506</span>&#160;<span class="keyword">template</span> &lt;&gt;</div><div class="line"><a name="l03507"></a><span class="lineno"> 3507</span>&#160;<span class="keyword">inline</span> <a class="code" href="config_8h.html#a1d1d58e8be15e5c4285f6892e5f33136">DEAL_II_ALWAYS_INLINE</a> <span class="keywordtype">void</span></div><div class="line"><a name="l03508"></a><span class="lineno"> 3508</span>&#160;<a class="code" href="vectorization_8h.html#a14da4327264fd3a88a9f73a8f72a9094">vectorized_load_and_transpose</a>(<span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span>             n_entries,</div><div class="line"><a name="l03509"></a><span class="lineno"> 3509</span>&#160;                              <span class="keyword">const</span> std::array&lt;double *, 2&gt; &amp;in,</div><div class="line"><a name="l03510"></a><span class="lineno"> 3510</span>&#160;                              <a class="code" href="classVectorizedArray.html">VectorizedArray&lt;double, 2&gt;</a> *   out)</div><div class="line"><a name="l03511"></a><span class="lineno"> 3511</span>&#160;{</div><div class="line"><a name="l03512"></a><span class="lineno"> 3512</span>&#160;  <span class="comment">// see the comments in the vectorized_load_and_transpose above</span></div><div class="line"><a name="l03513"></a><span class="lineno"> 3513</span>&#160;</div><div class="line"><a name="l03514"></a><span class="lineno"> 3514</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> n_chunks = n_entries / 2;</div><div class="line"><a name="l03515"></a><span class="lineno"> 3515</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i = 0; i &lt; n_chunks; ++i)</div><div class="line"><a name="l03516"></a><span class="lineno"> 3516</span>&#160;    {</div><div class="line"><a name="l03517"></a><span class="lineno"> 3517</span>&#160;      __m128d u0          = _mm_loadu_pd(in[0] + 2 * i);</div><div class="line"><a name="l03518"></a><span class="lineno"> 3518</span>&#160;      __m128d u1          = _mm_loadu_pd(in[1] + 2 * i);</div><div class="line"><a name="l03519"></a><span class="lineno"> 3519</span>&#160;      out[2 * i + 0].<a class="code" href="classVectorizedArray.html#ad38190d02537705964e021da7ecbab3f">data</a> = _mm_unpacklo_pd(u0, u1);</div><div class="line"><a name="l03520"></a><span class="lineno"> 3520</span>&#160;      out[2 * i + 1].<a class="code" href="classVectorizedArray.html#ad38190d02537705964e021da7ecbab3f">data</a> = _mm_unpackhi_pd(u0, u1);</div><div class="line"><a name="l03521"></a><span class="lineno"> 3521</span>&#160;    }</div><div class="line"><a name="l03522"></a><span class="lineno"> 3522</span>&#160;</div><div class="line"><a name="l03523"></a><span class="lineno"> 3523</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i = 2 * n_chunks; i &lt; n_entries; ++i)</div><div class="line"><a name="l03524"></a><span class="lineno"> 3524</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> v = 0; v &lt; 2; ++v)</div><div class="line"><a name="l03525"></a><span class="lineno"> 3525</span>&#160;      out[i][v] = in[v][i];</div><div class="line"><a name="l03526"></a><span class="lineno"> 3526</span>&#160;}</div><div class="line"><a name="l03527"></a><span class="lineno"> 3527</span>&#160;</div><div class="line"><a name="l03528"></a><span class="lineno"> 3528</span>&#160;</div><div class="line"><a name="l03529"></a><span class="lineno"> 3529</span>&#160;</div><div class="line"><a name="l03535"></a><span class="lineno"> 3535</span>&#160;<span class="keyword">template</span> &lt;&gt;</div><div class="line"><a name="l03536"></a><span class="lineno"> 3536</span>&#160;<span class="keyword">inline</span> <a class="code" href="config_8h.html#a1d1d58e8be15e5c4285f6892e5f33136">DEAL_II_ALWAYS_INLINE</a> <span class="keywordtype">void</span></div><div class="line"><a name="l03537"></a><span class="lineno"> 3537</span>&#160;<a class="code" href="vectorization_8h.html#af396b43c783502e8acd2ca7d071a7325">vectorized_transpose_and_store</a>(<span class="keyword">const</span> <span class="keywordtype">bool</span>                        add_into,</div><div class="line"><a name="l03538"></a><span class="lineno"> 3538</span>&#160;                               <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span>                n_entries,</div><div class="line"><a name="l03539"></a><span class="lineno"> 3539</span>&#160;                               <span class="keyword">const</span> <a class="code" href="classVectorizedArray.html">VectorizedArray&lt;double, 2&gt;</a> *in,</div><div class="line"><a name="l03540"></a><span class="lineno"> 3540</span>&#160;                               <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> *              offsets,</div><div class="line"><a name="l03541"></a><span class="lineno"> 3541</span>&#160;                               <span class="keywordtype">double</span> *                          out)</div><div class="line"><a name="l03542"></a><span class="lineno"> 3542</span>&#160;{</div><div class="line"><a name="l03543"></a><span class="lineno"> 3543</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> n_chunks = n_entries / 2;</div><div class="line"><a name="l03544"></a><span class="lineno"> 3544</span>&#160;  <span class="keywordflow">if</span> (add_into)</div><div class="line"><a name="l03545"></a><span class="lineno"> 3545</span>&#160;    {</div><div class="line"><a name="l03546"></a><span class="lineno"> 3546</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i = 0; i &lt; n_chunks; ++i)</div><div class="line"><a name="l03547"></a><span class="lineno"> 3547</span>&#160;        {</div><div class="line"><a name="l03548"></a><span class="lineno"> 3548</span>&#160;          __m128d u0   = in[2 * i + 0].<a class="code" href="classVectorizedArray.html#ad38190d02537705964e021da7ecbab3f">data</a>;</div><div class="line"><a name="l03549"></a><span class="lineno"> 3549</span>&#160;          __m128d u1   = in[2 * i + 1].<a class="code" href="classVectorizedArray.html#ad38190d02537705964e021da7ecbab3f">data</a>;</div><div class="line"><a name="l03550"></a><span class="lineno"> 3550</span>&#160;          __m128d res0 = _mm_unpacklo_pd(u0, u1);</div><div class="line"><a name="l03551"></a><span class="lineno"> 3551</span>&#160;          __m128d res1 = _mm_unpackhi_pd(u0, u1);</div><div class="line"><a name="l03552"></a><span class="lineno"> 3552</span>&#160;          _mm_storeu_pd(out + 2 * i + offsets[0],</div><div class="line"><a name="l03553"></a><span class="lineno"> 3553</span>&#160;                        _mm_add_pd(_mm_loadu_pd(out + 2 * i + offsets[0]),</div><div class="line"><a name="l03554"></a><span class="lineno"> 3554</span>&#160;                                   res0));</div><div class="line"><a name="l03555"></a><span class="lineno"> 3555</span>&#160;          _mm_storeu_pd(out + 2 * i + offsets[1],</div><div class="line"><a name="l03556"></a><span class="lineno"> 3556</span>&#160;                        _mm_add_pd(_mm_loadu_pd(out + 2 * i + offsets[1]),</div><div class="line"><a name="l03557"></a><span class="lineno"> 3557</span>&#160;                                   res1));</div><div class="line"><a name="l03558"></a><span class="lineno"> 3558</span>&#160;        }</div><div class="line"><a name="l03559"></a><span class="lineno"> 3559</span>&#160;      <span class="comment">// remainder loop of work that does not divide by 2</span></div><div class="line"><a name="l03560"></a><span class="lineno"> 3560</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i = 2 * n_chunks; i &lt; n_entries; ++i)</div><div class="line"><a name="l03561"></a><span class="lineno"> 3561</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> v = 0; v &lt; 2; ++v)</div><div class="line"><a name="l03562"></a><span class="lineno"> 3562</span>&#160;          out[offsets[v] + i] += in[i][v];</div><div class="line"><a name="l03563"></a><span class="lineno"> 3563</span>&#160;    }</div><div class="line"><a name="l03564"></a><span class="lineno"> 3564</span>&#160;  <span class="keywordflow">else</span></div><div class="line"><a name="l03565"></a><span class="lineno"> 3565</span>&#160;    {</div><div class="line"><a name="l03566"></a><span class="lineno"> 3566</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i = 0; i &lt; n_chunks; ++i)</div><div class="line"><a name="l03567"></a><span class="lineno"> 3567</span>&#160;        {</div><div class="line"><a name="l03568"></a><span class="lineno"> 3568</span>&#160;          __m128d u0   = in[2 * i + 0].<a class="code" href="classVectorizedArray.html#ad38190d02537705964e021da7ecbab3f">data</a>;</div><div class="line"><a name="l03569"></a><span class="lineno"> 3569</span>&#160;          __m128d u1   = in[2 * i + 1].<a class="code" href="classVectorizedArray.html#ad38190d02537705964e021da7ecbab3f">data</a>;</div><div class="line"><a name="l03570"></a><span class="lineno"> 3570</span>&#160;          __m128d res0 = _mm_unpacklo_pd(u0, u1);</div><div class="line"><a name="l03571"></a><span class="lineno"> 3571</span>&#160;          __m128d res1 = _mm_unpackhi_pd(u0, u1);</div><div class="line"><a name="l03572"></a><span class="lineno"> 3572</span>&#160;          _mm_storeu_pd(out + 2 * i + offsets[0], res0);</div><div class="line"><a name="l03573"></a><span class="lineno"> 3573</span>&#160;          _mm_storeu_pd(out + 2 * i + offsets[1], res1);</div><div class="line"><a name="l03574"></a><span class="lineno"> 3574</span>&#160;        }</div><div class="line"><a name="l03575"></a><span class="lineno"> 3575</span>&#160;      <span class="comment">// remainder loop of work that does not divide by 2</span></div><div class="line"><a name="l03576"></a><span class="lineno"> 3576</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i = 2 * n_chunks; i &lt; n_entries; ++i)</div><div class="line"><a name="l03577"></a><span class="lineno"> 3577</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> v = 0; v &lt; 2; ++v)</div><div class="line"><a name="l03578"></a><span class="lineno"> 3578</span>&#160;          out[offsets[v] + i] = in[i][v];</div><div class="line"><a name="l03579"></a><span class="lineno"> 3579</span>&#160;    }</div><div class="line"><a name="l03580"></a><span class="lineno"> 3580</span>&#160;}</div><div class="line"><a name="l03581"></a><span class="lineno"> 3581</span>&#160;</div><div class="line"><a name="l03582"></a><span class="lineno"> 3582</span>&#160;</div><div class="line"><a name="l03583"></a><span class="lineno"> 3583</span>&#160;</div><div class="line"><a name="l03589"></a><span class="lineno"> 3589</span>&#160;<span class="keyword">template</span> &lt;&gt;</div><div class="line"><a name="l03590"></a><span class="lineno"> 3590</span>&#160;<span class="keyword">inline</span> <a class="code" href="config_8h.html#a1d1d58e8be15e5c4285f6892e5f33136">DEAL_II_ALWAYS_INLINE</a> <span class="keywordtype">void</span></div><div class="line"><a name="l03591"></a><span class="lineno"> 3591</span>&#160;<a class="code" href="vectorization_8h.html#af396b43c783502e8acd2ca7d071a7325">vectorized_transpose_and_store</a>(<span class="keyword">const</span> <span class="keywordtype">bool</span>                        add_into,</div><div class="line"><a name="l03592"></a><span class="lineno"> 3592</span>&#160;                               <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span>                n_entries,</div><div class="line"><a name="l03593"></a><span class="lineno"> 3593</span>&#160;                               <span class="keyword">const</span> <a class="code" href="classVectorizedArray.html">VectorizedArray&lt;double, 2&gt;</a> *in,</div><div class="line"><a name="l03594"></a><span class="lineno"> 3594</span>&#160;                               std::array&lt;double *, 2&gt; &amp;         out)</div><div class="line"><a name="l03595"></a><span class="lineno"> 3595</span>&#160;{</div><div class="line"><a name="l03596"></a><span class="lineno"> 3596</span>&#160;  <span class="comment">// see the comments in the vectorized_transpose_and_store above</span></div><div class="line"><a name="l03597"></a><span class="lineno"> 3597</span>&#160;</div><div class="line"><a name="l03598"></a><span class="lineno"> 3598</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> n_chunks = n_entries / 2;</div><div class="line"><a name="l03599"></a><span class="lineno"> 3599</span>&#160;  <span class="keywordflow">if</span> (add_into)</div><div class="line"><a name="l03600"></a><span class="lineno"> 3600</span>&#160;    {</div><div class="line"><a name="l03601"></a><span class="lineno"> 3601</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i = 0; i &lt; n_chunks; ++i)</div><div class="line"><a name="l03602"></a><span class="lineno"> 3602</span>&#160;        {</div><div class="line"><a name="l03603"></a><span class="lineno"> 3603</span>&#160;          __m128d u0   = in[2 * i + 0].<a class="code" href="classVectorizedArray.html#ad38190d02537705964e021da7ecbab3f">data</a>;</div><div class="line"><a name="l03604"></a><span class="lineno"> 3604</span>&#160;          __m128d u1   = in[2 * i + 1].<a class="code" href="classVectorizedArray.html#ad38190d02537705964e021da7ecbab3f">data</a>;</div><div class="line"><a name="l03605"></a><span class="lineno"> 3605</span>&#160;          __m128d res0 = _mm_unpacklo_pd(u0, u1);</div><div class="line"><a name="l03606"></a><span class="lineno"> 3606</span>&#160;          __m128d res1 = _mm_unpackhi_pd(u0, u1);</div><div class="line"><a name="l03607"></a><span class="lineno"> 3607</span>&#160;          _mm_storeu_pd(out[0] + 2 * i,</div><div class="line"><a name="l03608"></a><span class="lineno"> 3608</span>&#160;                        _mm_add_pd(_mm_loadu_pd(out[0] + 2 * i), res0));</div><div class="line"><a name="l03609"></a><span class="lineno"> 3609</span>&#160;          _mm_storeu_pd(out[1] + 2 * i,</div><div class="line"><a name="l03610"></a><span class="lineno"> 3610</span>&#160;                        _mm_add_pd(_mm_loadu_pd(out[1] + 2 * i), res1));</div><div class="line"><a name="l03611"></a><span class="lineno"> 3611</span>&#160;        }</div><div class="line"><a name="l03612"></a><span class="lineno"> 3612</span>&#160;</div><div class="line"><a name="l03613"></a><span class="lineno"> 3613</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i = 2 * n_chunks; i &lt; n_entries; ++i)</div><div class="line"><a name="l03614"></a><span class="lineno"> 3614</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> v = 0; v &lt; 2; ++v)</div><div class="line"><a name="l03615"></a><span class="lineno"> 3615</span>&#160;          out[v][i] += in[i][v];</div><div class="line"><a name="l03616"></a><span class="lineno"> 3616</span>&#160;    }</div><div class="line"><a name="l03617"></a><span class="lineno"> 3617</span>&#160;  <span class="keywordflow">else</span></div><div class="line"><a name="l03618"></a><span class="lineno"> 3618</span>&#160;    {</div><div class="line"><a name="l03619"></a><span class="lineno"> 3619</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i = 0; i &lt; n_chunks; ++i)</div><div class="line"><a name="l03620"></a><span class="lineno"> 3620</span>&#160;        {</div><div class="line"><a name="l03621"></a><span class="lineno"> 3621</span>&#160;          __m128d u0   = in[2 * i + 0].<a class="code" href="classVectorizedArray.html#ad38190d02537705964e021da7ecbab3f">data</a>;</div><div class="line"><a name="l03622"></a><span class="lineno"> 3622</span>&#160;          __m128d u1   = in[2 * i + 1].<a class="code" href="classVectorizedArray.html#ad38190d02537705964e021da7ecbab3f">data</a>;</div><div class="line"><a name="l03623"></a><span class="lineno"> 3623</span>&#160;          __m128d res0 = _mm_unpacklo_pd(u0, u1);</div><div class="line"><a name="l03624"></a><span class="lineno"> 3624</span>&#160;          __m128d res1 = _mm_unpackhi_pd(u0, u1);</div><div class="line"><a name="l03625"></a><span class="lineno"> 3625</span>&#160;          _mm_storeu_pd(out[0] + 2 * i, res0);</div><div class="line"><a name="l03626"></a><span class="lineno"> 3626</span>&#160;          _mm_storeu_pd(out[1] + 2 * i, res1);</div><div class="line"><a name="l03627"></a><span class="lineno"> 3627</span>&#160;        }</div><div class="line"><a name="l03628"></a><span class="lineno"> 3628</span>&#160;</div><div class="line"><a name="l03629"></a><span class="lineno"> 3629</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i = 2 * n_chunks; i &lt; n_entries; ++i)</div><div class="line"><a name="l03630"></a><span class="lineno"> 3630</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> v = 0; v &lt; 2; ++v)</div><div class="line"><a name="l03631"></a><span class="lineno"> 3631</span>&#160;          out[v][i] = in[i][v];</div><div class="line"><a name="l03632"></a><span class="lineno"> 3632</span>&#160;    }</div><div class="line"><a name="l03633"></a><span class="lineno"> 3633</span>&#160;}</div><div class="line"><a name="l03634"></a><span class="lineno"> 3634</span>&#160;</div><div class="line"><a name="l03635"></a><span class="lineno"> 3635</span>&#160;</div><div class="line"><a name="l03636"></a><span class="lineno"> 3636</span>&#160;</div><div class="line"><a name="l03642"></a><span class="lineno"> 3642</span>&#160;<span class="keyword">template</span> &lt;&gt;</div><div class="line"><a name="l03643"></a><span class="lineno"> 3643</span>&#160;<span class="keyword">class </span><a class="code" href="classVectorizedArray.html">VectorizedArray</a>&lt;float, 4&gt;</div><div class="line"><a name="l03644"></a><span class="lineno"> 3644</span>&#160;  : <span class="keyword">public</span> <a class="code" href="classVectorizedArrayBase.html">VectorizedArrayBase</a>&lt;VectorizedArray&lt;float, 4&gt;, 4&gt;</div><div class="line"><a name="l03645"></a><span class="lineno"> 3645</span>&#160;{</div><div class="line"><a name="l03646"></a><span class="lineno"> 3646</span>&#160;<span class="keyword">public</span>:</div><div class="line"><a name="l03651"></a><span class="lineno"> 3651</span>&#160;  <span class="keyword">using</span> value_type = float;</div><div class="line"><a name="l03652"></a><span class="lineno"> 3652</span>&#160;</div><div class="line"><a name="l03662"></a><span class="lineno"> 3662</span>&#160;  <a class="code" href="classVectorizedArray.html">VectorizedArray</a>() = <span class="keywordflow">default</span>;</div><div class="line"><a name="l03663"></a><span class="lineno"> 3663</span>&#160;</div><div class="line"><a name="l03668"></a><span class="lineno"> 3668</span>&#160;  <a class="code" href="classVectorizedArray.html">VectorizedArray</a>(<span class="keyword">const</span> <span class="keywordtype">float</span> scalar)</div><div class="line"><a name="l03669"></a><span class="lineno"> 3669</span>&#160;  {</div><div class="line"><a name="l03670"></a><span class="lineno"> 3670</span>&#160;    this-&gt;operator=(scalar);</div><div class="line"><a name="l03671"></a><span class="lineno"> 3671</span>&#160;  }</div><div class="line"><a name="l03672"></a><span class="lineno"> 3672</span>&#160;</div><div class="line"><a name="l03673"></a><span class="lineno"> 3673</span>&#160;  <a class="code" href="config_8h.html#a1d1d58e8be15e5c4285f6892e5f33136">DEAL_II_ALWAYS_INLINE</a></div><div class="line"><a name="l03674"></a><span class="lineno"> 3674</span>&#160;  <a class="code" href="classVectorizedArray.html">VectorizedArray</a> &amp;</div><div class="line"><a name="l03675"></a><span class="lineno"> 3675</span>&#160;  operator=(<span class="keyword">const</span> <span class="keywordtype">float</span> x)</div><div class="line"><a name="l03676"></a><span class="lineno"> 3676</span>&#160;  {</div><div class="line"><a name="l03677"></a><span class="lineno"> 3677</span>&#160;    data = _mm_set1_ps(x);</div><div class="line"><a name="l03678"></a><span class="lineno"> 3678</span>&#160;    <span class="keywordflow">return</span> *<span class="keyword">this</span>;</div><div class="line"><a name="l03679"></a><span class="lineno"> 3679</span>&#160;  }</div><div class="line"><a name="l03680"></a><span class="lineno"> 3680</span>&#160;</div><div class="line"><a name="l03685"></a><span class="lineno"> 3685</span>&#160;  <a class="code" href="config_8h.html#a1d1d58e8be15e5c4285f6892e5f33136">DEAL_II_ALWAYS_INLINE</a></div><div class="line"><a name="l03686"></a><span class="lineno"> 3686</span>&#160;  <span class="keywordtype">float</span> &amp;operator[](<span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> comp)</div><div class="line"><a name="l03687"></a><span class="lineno"> 3687</span>&#160;  {</div><div class="line"><a name="l03688"></a><span class="lineno"> 3688</span>&#160;    <a class="code" href="group__Exceptions.html#gaafbb69cc2a791ae55880fd8d57d0c1b0">AssertIndexRange</a>(comp, 4);</div><div class="line"><a name="l03689"></a><span class="lineno"> 3689</span>&#160;    <span class="keywordflow">return</span> *(<span class="keyword">reinterpret_cast&lt;</span><span class="keywordtype">float</span> *<span class="keyword">&gt;</span>(&amp;data) + comp);</div><div class="line"><a name="l03690"></a><span class="lineno"> 3690</span>&#160;  }</div><div class="line"><a name="l03691"></a><span class="lineno"> 3691</span>&#160;</div><div class="line"><a name="l03696"></a><span class="lineno"> 3696</span>&#160;  <a class="code" href="config_8h.html#a1d1d58e8be15e5c4285f6892e5f33136">DEAL_II_ALWAYS_INLINE</a></div><div class="line"><a name="l03697"></a><span class="lineno"> 3697</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">float</span> &amp;operator[](<span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> comp)<span class="keyword"> const</span></div><div class="line"><a name="l03698"></a><span class="lineno"> 3698</span>&#160;<span class="keyword">  </span>{</div><div class="line"><a name="l03699"></a><span class="lineno"> 3699</span>&#160;    <a class="code" href="group__Exceptions.html#gaafbb69cc2a791ae55880fd8d57d0c1b0">AssertIndexRange</a>(comp, 4);</div><div class="line"><a name="l03700"></a><span class="lineno"> 3700</span>&#160;    <span class="keywordflow">return</span> *(<span class="keyword">reinterpret_cast&lt;</span><span class="keyword">const </span><span class="keywordtype">float</span> *<span class="keyword">&gt;</span>(&amp;data) + comp);</div><div class="line"><a name="l03701"></a><span class="lineno"> 3701</span>&#160;  }</div><div class="line"><a name="l03702"></a><span class="lineno"> 3702</span>&#160;</div><div class="line"><a name="l03707"></a><span class="lineno"> 3707</span>&#160;  <a class="code" href="config_8h.html#a1d1d58e8be15e5c4285f6892e5f33136">DEAL_II_ALWAYS_INLINE</a></div><div class="line"><a name="l03708"></a><span class="lineno"> 3708</span>&#160;  <a class="code" href="classVectorizedArray.html">VectorizedArray</a> &amp;</div><div class="line"><a name="l03709"></a><span class="lineno"> 3709</span>&#160;  operator+=(<span class="keyword">const</span> <a class="code" href="classVectorizedArray.html">VectorizedArray</a> &amp;vec)</div><div class="line"><a name="l03710"></a><span class="lineno"> 3710</span>&#160;  {</div><div class="line"><a name="l03711"></a><span class="lineno"> 3711</span>&#160;<span class="preprocessor">#    ifdef DEAL_II_COMPILER_USE_VECTOR_ARITHMETICS</span></div><div class="line"><a name="l03712"></a><span class="lineno"> 3712</span>&#160;    data += vec.<a class="code" href="classVectorizedArray.html#ad38190d02537705964e021da7ecbab3f">data</a>;</div><div class="line"><a name="l03713"></a><span class="lineno"> 3713</span>&#160;<span class="preprocessor">#    else</span></div><div class="line"><a name="l03714"></a><span class="lineno"> 3714</span>&#160;    data = _mm_add_ps(data, vec.<a class="code" href="classVectorizedArray.html#ad38190d02537705964e021da7ecbab3f">data</a>);</div><div class="line"><a name="l03715"></a><span class="lineno"> 3715</span>&#160;<span class="preprocessor">#    endif</span></div><div class="line"><a name="l03716"></a><span class="lineno"> 3716</span>&#160;    <span class="keywordflow">return</span> *<span class="keyword">this</span>;</div><div class="line"><a name="l03717"></a><span class="lineno"> 3717</span>&#160;  }</div><div class="line"><a name="l03718"></a><span class="lineno"> 3718</span>&#160;</div><div class="line"><a name="l03723"></a><span class="lineno"> 3723</span>&#160;  <a class="code" href="config_8h.html#a1d1d58e8be15e5c4285f6892e5f33136">DEAL_II_ALWAYS_INLINE</a></div><div class="line"><a name="l03724"></a><span class="lineno"> 3724</span>&#160;  <a class="code" href="classVectorizedArray.html">VectorizedArray</a> &amp;</div><div class="line"><a name="l03725"></a><span class="lineno"> 3725</span>&#160;  operator-=(<span class="keyword">const</span> <a class="code" href="classVectorizedArray.html">VectorizedArray</a> &amp;vec)</div><div class="line"><a name="l03726"></a><span class="lineno"> 3726</span>&#160;  {</div><div class="line"><a name="l03727"></a><span class="lineno"> 3727</span>&#160;<span class="preprocessor">#    ifdef DEAL_II_COMPILER_USE_VECTOR_ARITHMETICS</span></div><div class="line"><a name="l03728"></a><span class="lineno"> 3728</span>&#160;    data -= vec.<a class="code" href="classVectorizedArray.html#ad38190d02537705964e021da7ecbab3f">data</a>;</div><div class="line"><a name="l03729"></a><span class="lineno"> 3729</span>&#160;<span class="preprocessor">#    else</span></div><div class="line"><a name="l03730"></a><span class="lineno"> 3730</span>&#160;    data = _mm_sub_ps(data, vec.<a class="code" href="classVectorizedArray.html#ad38190d02537705964e021da7ecbab3f">data</a>);</div><div class="line"><a name="l03731"></a><span class="lineno"> 3731</span>&#160;<span class="preprocessor">#    endif</span></div><div class="line"><a name="l03732"></a><span class="lineno"> 3732</span>&#160;    <span class="keywordflow">return</span> *<span class="keyword">this</span>;</div><div class="line"><a name="l03733"></a><span class="lineno"> 3733</span>&#160;  }</div><div class="line"><a name="l03734"></a><span class="lineno"> 3734</span>&#160;</div><div class="line"><a name="l03739"></a><span class="lineno"> 3739</span>&#160;  <a class="code" href="config_8h.html#a1d1d58e8be15e5c4285f6892e5f33136">DEAL_II_ALWAYS_INLINE</a></div><div class="line"><a name="l03740"></a><span class="lineno"> 3740</span>&#160;  <a class="code" href="classVectorizedArray.html">VectorizedArray</a> &amp;</div><div class="line"><a name="l03741"></a><span class="lineno"> 3741</span>&#160;  operator*=(<span class="keyword">const</span> <a class="code" href="classVectorizedArray.html">VectorizedArray</a> &amp;vec)</div><div class="line"><a name="l03742"></a><span class="lineno"> 3742</span>&#160;  {</div><div class="line"><a name="l03743"></a><span class="lineno"> 3743</span>&#160;<span class="preprocessor">#    ifdef DEAL_II_COMPILER_USE_VECTOR_ARITHMETICS</span></div><div class="line"><a name="l03744"></a><span class="lineno"> 3744</span>&#160;    data *= vec.<a class="code" href="classVectorizedArray.html#ad38190d02537705964e021da7ecbab3f">data</a>;</div><div class="line"><a name="l03745"></a><span class="lineno"> 3745</span>&#160;<span class="preprocessor">#    else</span></div><div class="line"><a name="l03746"></a><span class="lineno"> 3746</span>&#160;    data = _mm_mul_ps(data, vec.<a class="code" href="classVectorizedArray.html#ad38190d02537705964e021da7ecbab3f">data</a>);</div><div class="line"><a name="l03747"></a><span class="lineno"> 3747</span>&#160;<span class="preprocessor">#    endif</span></div><div class="line"><a name="l03748"></a><span class="lineno"> 3748</span>&#160;    <span class="keywordflow">return</span> *<span class="keyword">this</span>;</div><div class="line"><a name="l03749"></a><span class="lineno"> 3749</span>&#160;  }</div><div class="line"><a name="l03750"></a><span class="lineno"> 3750</span>&#160;</div><div class="line"><a name="l03755"></a><span class="lineno"> 3755</span>&#160;  <a class="code" href="config_8h.html#a1d1d58e8be15e5c4285f6892e5f33136">DEAL_II_ALWAYS_INLINE</a></div><div class="line"><a name="l03756"></a><span class="lineno"> 3756</span>&#160;  <a class="code" href="classVectorizedArray.html">VectorizedArray</a> &amp;</div><div class="line"><a name="l03757"></a><span class="lineno"> 3757</span>&#160;  operator/=(<span class="keyword">const</span> <a class="code" href="classVectorizedArray.html">VectorizedArray</a> &amp;vec)</div><div class="line"><a name="l03758"></a><span class="lineno"> 3758</span>&#160;  {</div><div class="line"><a name="l03759"></a><span class="lineno"> 3759</span>&#160;<span class="preprocessor">#    ifdef DEAL_II_COMPILER_USE_VECTOR_ARITHMETICS</span></div><div class="line"><a name="l03760"></a><span class="lineno"> 3760</span>&#160;    data /= vec.<a class="code" href="classVectorizedArray.html#ad38190d02537705964e021da7ecbab3f">data</a>;</div><div class="line"><a name="l03761"></a><span class="lineno"> 3761</span>&#160;<span class="preprocessor">#    else</span></div><div class="line"><a name="l03762"></a><span class="lineno"> 3762</span>&#160;    data = _mm_div_ps(data, vec.<a class="code" href="classVectorizedArray.html#ad38190d02537705964e021da7ecbab3f">data</a>);</div><div class="line"><a name="l03763"></a><span class="lineno"> 3763</span>&#160;<span class="preprocessor">#    endif</span></div><div class="line"><a name="l03764"></a><span class="lineno"> 3764</span>&#160;    <span class="keywordflow">return</span> *<span class="keyword">this</span>;</div><div class="line"><a name="l03765"></a><span class="lineno"> 3765</span>&#160;  }</div><div class="line"><a name="l03766"></a><span class="lineno"> 3766</span>&#160;</div><div class="line"><a name="l03772"></a><span class="lineno"> 3772</span>&#160;  <a class="code" href="config_8h.html#a1d1d58e8be15e5c4285f6892e5f33136">DEAL_II_ALWAYS_INLINE</a></div><div class="line"><a name="l03773"></a><span class="lineno"> 3773</span>&#160;  <span class="keywordtype">void</span></div><div class="line"><a name="l03774"></a><span class="lineno"> 3774</span>&#160;  load(<span class="keyword">const</span> <span class="keywordtype">float</span> *ptr)</div><div class="line"><a name="l03775"></a><span class="lineno"> 3775</span>&#160;  {</div><div class="line"><a name="l03776"></a><span class="lineno"> 3776</span>&#160;    data = _mm_loadu_ps(ptr);</div><div class="line"><a name="l03777"></a><span class="lineno"> 3777</span>&#160;  }</div><div class="line"><a name="l03778"></a><span class="lineno"> 3778</span>&#160;</div><div class="line"><a name="l03784"></a><span class="lineno"> 3784</span>&#160;  <a class="code" href="config_8h.html#a1d1d58e8be15e5c4285f6892e5f33136">DEAL_II_ALWAYS_INLINE</a></div><div class="line"><a name="l03785"></a><span class="lineno"> 3785</span>&#160;  <span class="keywordtype">void</span></div><div class="line"><a name="l03786"></a><span class="lineno"> 3786</span>&#160;  store(<span class="keywordtype">float</span> *ptr)<span class="keyword"> const</span></div><div class="line"><a name="l03787"></a><span class="lineno"> 3787</span>&#160;<span class="keyword">  </span>{</div><div class="line"><a name="l03788"></a><span class="lineno"> 3788</span>&#160;    _mm_storeu_ps(ptr, data);</div><div class="line"><a name="l03789"></a><span class="lineno"> 3789</span>&#160;  }</div><div class="line"><a name="l03790"></a><span class="lineno"> 3790</span>&#160;</div><div class="line"><a name="l03796"></a><span class="lineno"> 3796</span>&#160;  <a class="code" href="config_8h.html#a1d1d58e8be15e5c4285f6892e5f33136">DEAL_II_ALWAYS_INLINE</a></div><div class="line"><a name="l03797"></a><span class="lineno"> 3797</span>&#160;  <span class="keywordtype">void</span></div><div class="line"><a name="l03798"></a><span class="lineno"> 3798</span>&#160;  streaming_store(<span class="keywordtype">float</span> *ptr)<span class="keyword"> const</span></div><div class="line"><a name="l03799"></a><span class="lineno"> 3799</span>&#160;<span class="keyword">  </span>{</div><div class="line"><a name="l03800"></a><span class="lineno"> 3800</span>&#160;    <a class="code" href="group__Exceptions.html#ga70a0bb353656e704acf927945277bbc6">Assert</a>(reinterpret_cast&lt;std::size_t&gt;(ptr) % 16 == 0,</div><div class="line"><a name="l03801"></a><span class="lineno"> 3801</span>&#160;           <a class="code" href="group__Exceptions.html#gae9a45f517af1401c50811a11083f9114">ExcMessage</a>(<span class="stringliteral">&quot;Memory not aligned&quot;</span>));</div><div class="line"><a name="l03802"></a><span class="lineno"> 3802</span>&#160;    _mm_stream_ps(ptr, data);</div><div class="line"><a name="l03803"></a><span class="lineno"> 3803</span>&#160;  }</div><div class="line"><a name="l03804"></a><span class="lineno"> 3804</span>&#160;</div><div class="line"><a name="l03815"></a><span class="lineno"> 3815</span>&#160;  <a class="code" href="config_8h.html#a1d1d58e8be15e5c4285f6892e5f33136">DEAL_II_ALWAYS_INLINE</a></div><div class="line"><a name="l03816"></a><span class="lineno"> 3816</span>&#160;  <span class="keywordtype">void</span></div><div class="line"><a name="l03817"></a><span class="lineno"> 3817</span>&#160;  <a class="code" href="vectorization_8h.html#a078ca5de8d3a59aedc130823be15ad26">gather</a>(<span class="keyword">const</span> <span class="keywordtype">float</span> *base_ptr, <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> *offsets)</div><div class="line"><a name="l03818"></a><span class="lineno"> 3818</span>&#160;  {</div><div class="line"><a name="l03819"></a><span class="lineno"> 3819</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i = 0; i &lt; 4; ++i)</div><div class="line"><a name="l03820"></a><span class="lineno"> 3820</span>&#160;      *(reinterpret_cast&lt;float *&gt;(&amp;data) + i) = base_ptr[offsets[i]];</div><div class="line"><a name="l03821"></a><span class="lineno"> 3821</span>&#160;  }</div><div class="line"><a name="l03822"></a><span class="lineno"> 3822</span>&#160;</div><div class="line"><a name="l03834"></a><span class="lineno"> 3834</span>&#160;  <a class="code" href="config_8h.html#a1d1d58e8be15e5c4285f6892e5f33136">DEAL_II_ALWAYS_INLINE</a></div><div class="line"><a name="l03835"></a><span class="lineno"> 3835</span>&#160;  <span class="keywordtype">void</span></div><div class="line"><a name="l03836"></a><span class="lineno"> 3836</span>&#160;  scatter(<span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> *offsets, <span class="keywordtype">float</span> *base_ptr)<span class="keyword"> const</span></div><div class="line"><a name="l03837"></a><span class="lineno"> 3837</span>&#160;<span class="keyword">  </span>{</div><div class="line"><a name="l03838"></a><span class="lineno"> 3838</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i = 0; i &lt; 4; ++i)</div><div class="line"><a name="l03839"></a><span class="lineno"> 3839</span>&#160;      base_ptr[offsets[i]] = *(reinterpret_cast&lt;const float *&gt;(&amp;data) + i);</div><div class="line"><a name="l03840"></a><span class="lineno"> 3840</span>&#160;  }</div><div class="line"><a name="l03841"></a><span class="lineno"> 3841</span>&#160;</div><div class="line"><a name="l03846"></a><span class="lineno"> 3846</span>&#160;  __m128 data;</div><div class="line"><a name="l03847"></a><span class="lineno"> 3847</span>&#160;</div><div class="line"><a name="l03848"></a><span class="lineno"> 3848</span>&#160;<span class="keyword">private</span>:</div><div class="line"><a name="l03853"></a><span class="lineno"> 3853</span>&#160;  <a class="code" href="config_8h.html#a1d1d58e8be15e5c4285f6892e5f33136">DEAL_II_ALWAYS_INLINE</a></div><div class="line"><a name="l03854"></a><span class="lineno"> 3854</span>&#160;  <a class="code" href="classVectorizedArray.html">VectorizedArray</a></div><div class="line"><a name="l03855"></a><span class="lineno"> 3855</span>&#160;  get_sqrt()<span class="keyword"> const</span></div><div class="line"><a name="l03856"></a><span class="lineno"> 3856</span>&#160;<span class="keyword">  </span>{</div><div class="line"><a name="l03857"></a><span class="lineno"> 3857</span>&#160;    <a class="code" href="classVectorizedArray.html">VectorizedArray</a> res;</div><div class="line"><a name="l03858"></a><span class="lineno"> 3858</span>&#160;    res.<a class="code" href="classVectorizedArray.html#ad38190d02537705964e021da7ecbab3f">data</a> = _mm_sqrt_ps(data);</div><div class="line"><a name="l03859"></a><span class="lineno"> 3859</span>&#160;    <span class="keywordflow">return</span> res;</div><div class="line"><a name="l03860"></a><span class="lineno"> 3860</span>&#160;  }</div><div class="line"><a name="l03861"></a><span class="lineno"> 3861</span>&#160;</div><div class="line"><a name="l03866"></a><span class="lineno"> 3866</span>&#160;  <a class="code" href="config_8h.html#a1d1d58e8be15e5c4285f6892e5f33136">DEAL_II_ALWAYS_INLINE</a></div><div class="line"><a name="l03867"></a><span class="lineno"> 3867</span>&#160;  <a class="code" href="classVectorizedArray.html">VectorizedArray</a></div><div class="line"><a name="l03868"></a><span class="lineno"> 3868</span>&#160;  get_abs()<span class="keyword"> const</span></div><div class="line"><a name="l03869"></a><span class="lineno"> 3869</span>&#160;<span class="keyword">  </span>{</div><div class="line"><a name="l03870"></a><span class="lineno"> 3870</span>&#160;    <span class="comment">// to compute the absolute value, perform bitwise andnot with -0. This</span></div><div class="line"><a name="l03871"></a><span class="lineno"> 3871</span>&#160;    <span class="comment">// will leave all value and exponent bits unchanged but force the sign</span></div><div class="line"><a name="l03872"></a><span class="lineno"> 3872</span>&#160;    <span class="comment">// value to +.</span></div><div class="line"><a name="l03873"></a><span class="lineno"> 3873</span>&#160;    __m128          mask = _mm_set1_ps(-0.f);</div><div class="line"><a name="l03874"></a><span class="lineno"> 3874</span>&#160;    <a class="code" href="classVectorizedArray.html">VectorizedArray</a> res;</div><div class="line"><a name="l03875"></a><span class="lineno"> 3875</span>&#160;    res.<a class="code" href="classVectorizedArray.html#ad38190d02537705964e021da7ecbab3f">data</a> = _mm_andnot_ps(mask, data);</div><div class="line"><a name="l03876"></a><span class="lineno"> 3876</span>&#160;    <span class="keywordflow">return</span> res;</div><div class="line"><a name="l03877"></a><span class="lineno"> 3877</span>&#160;  }</div><div class="line"><a name="l03878"></a><span class="lineno"> 3878</span>&#160;</div><div class="line"><a name="l03883"></a><span class="lineno"> 3883</span>&#160;  <a class="code" href="config_8h.html#a1d1d58e8be15e5c4285f6892e5f33136">DEAL_II_ALWAYS_INLINE</a></div><div class="line"><a name="l03884"></a><span class="lineno"> 3884</span>&#160;  <a class="code" href="classVectorizedArray.html">VectorizedArray</a></div><div class="line"><a name="l03885"></a><span class="lineno"> 3885</span>&#160;  get_max(<span class="keyword">const</span> <a class="code" href="classVectorizedArray.html">VectorizedArray</a> &amp;other)<span class="keyword"> const</span></div><div class="line"><a name="l03886"></a><span class="lineno"> 3886</span>&#160;<span class="keyword">  </span>{</div><div class="line"><a name="l03887"></a><span class="lineno"> 3887</span>&#160;    <a class="code" href="classVectorizedArray.html">VectorizedArray</a> res;</div><div class="line"><a name="l03888"></a><span class="lineno"> 3888</span>&#160;    res.<a class="code" href="classVectorizedArray.html#ad38190d02537705964e021da7ecbab3f">data</a> = _mm_max_ps(data, other.<a class="code" href="classVectorizedArray.html#ad38190d02537705964e021da7ecbab3f">data</a>);</div><div class="line"><a name="l03889"></a><span class="lineno"> 3889</span>&#160;    <span class="keywordflow">return</span> res;</div><div class="line"><a name="l03890"></a><span class="lineno"> 3890</span>&#160;  }</div><div class="line"><a name="l03891"></a><span class="lineno"> 3891</span>&#160;</div><div class="line"><a name="l03896"></a><span class="lineno"> 3896</span>&#160;  <a class="code" href="config_8h.html#a1d1d58e8be15e5c4285f6892e5f33136">DEAL_II_ALWAYS_INLINE</a></div><div class="line"><a name="l03897"></a><span class="lineno"> 3897</span>&#160;  <a class="code" href="classVectorizedArray.html">VectorizedArray</a></div><div class="line"><a name="l03898"></a><span class="lineno"> 3898</span>&#160;  get_min(<span class="keyword">const</span> <a class="code" href="classVectorizedArray.html">VectorizedArray</a> &amp;other)<span class="keyword"> const</span></div><div class="line"><a name="l03899"></a><span class="lineno"> 3899</span>&#160;<span class="keyword">  </span>{</div><div class="line"><a name="l03900"></a><span class="lineno"> 3900</span>&#160;    <a class="code" href="classVectorizedArray.html">VectorizedArray</a> res;</div><div class="line"><a name="l03901"></a><span class="lineno"> 3901</span>&#160;    res.<a class="code" href="classVectorizedArray.html#ad38190d02537705964e021da7ecbab3f">data</a> = _mm_min_ps(data, other.<a class="code" href="classVectorizedArray.html#ad38190d02537705964e021da7ecbab3f">data</a>);</div><div class="line"><a name="l03902"></a><span class="lineno"> 3902</span>&#160;    <span class="keywordflow">return</span> res;</div><div class="line"><a name="l03903"></a><span class="lineno"> 3903</span>&#160;  }</div><div class="line"><a name="l03904"></a><span class="lineno"> 3904</span>&#160;</div><div class="line"><a name="l03905"></a><span class="lineno"> 3905</span>&#160;  <span class="comment">// Make a few functions friends.</span></div><div class="line"><a name="l03906"></a><span class="lineno"> 3906</span>&#160;  <span class="keyword">template</span> &lt;<span class="keyword">typename</span> Number2, std::<span class="keywordtype">size_t</span> w<span class="keywordtype">id</span>th2&gt;</div><div class="line"><a name="l03907"></a><span class="lineno"> 3907</span>&#160;  <span class="keyword">friend</span> <a class="code" href="classVectorizedArray.html">VectorizedArray&lt;Number2, width2&gt;</a></div><div class="line"><a name="l03908"></a><span class="lineno"> 3908</span>&#160;  std::sqrt(<span class="keyword">const</span> <a class="code" href="classVectorizedArray.html">VectorizedArray&lt;Number2, width2&gt;</a> &amp;);</div><div class="line"><a name="l03909"></a><span class="lineno"> 3909</span>&#160;  <span class="keyword">template</span> &lt;<span class="keyword">typename</span> Number2, std::<span class="keywordtype">size_t</span> w<span class="keywordtype">id</span>th2&gt;</div><div class="line"><a name="l03910"></a><span class="lineno"> 3910</span>&#160;  <span class="keyword">friend</span> <a class="code" href="classVectorizedArray.html">VectorizedArray&lt;Number2, width2&gt;</a></div><div class="line"><a name="l03911"></a><span class="lineno"> 3911</span>&#160;  std::abs(<span class="keyword">const</span> <a class="code" href="classVectorizedArray.html">VectorizedArray&lt;Number2, width2&gt;</a> &amp;);</div><div class="line"><a name="l03912"></a><span class="lineno"> 3912</span>&#160;  <span class="keyword">template</span> &lt;<span class="keyword">typename</span> Number2, std::<span class="keywordtype">size_t</span> w<span class="keywordtype">id</span>th2&gt;</div><div class="line"><a name="l03913"></a><span class="lineno"> 3913</span>&#160;  <span class="keyword">friend</span> <a class="code" href="classVectorizedArray.html">VectorizedArray&lt;Number2, width2&gt;</a></div><div class="line"><a name="l03914"></a><span class="lineno"> 3914</span>&#160;  std::max(<span class="keyword">const</span> <a class="code" href="classVectorizedArray.html">VectorizedArray&lt;Number2, width2&gt;</a> &amp;,</div><div class="line"><a name="l03915"></a><span class="lineno"> 3915</span>&#160;           <span class="keyword">const</span> <a class="code" href="classVectorizedArray.html">VectorizedArray&lt;Number2, width2&gt;</a> &amp;);</div><div class="line"><a name="l03916"></a><span class="lineno"> 3916</span>&#160;  <span class="keyword">template</span> &lt;<span class="keyword">typename</span> Number2, std::<span class="keywordtype">size_t</span> w<span class="keywordtype">id</span>th2&gt;</div><div class="line"><a name="l03917"></a><span class="lineno"> 3917</span>&#160;  <span class="keyword">friend</span> <a class="code" href="classVectorizedArray.html">VectorizedArray&lt;Number2, width2&gt;</a></div><div class="line"><a name="l03918"></a><span class="lineno"> 3918</span>&#160;  std::min(<span class="keyword">const</span> <a class="code" href="classVectorizedArray.html">VectorizedArray&lt;Number2, width2&gt;</a> &amp;,</div><div class="line"><a name="l03919"></a><span class="lineno"> 3919</span>&#160;           <span class="keyword">const</span> <a class="code" href="classVectorizedArray.html">VectorizedArray&lt;Number2, width2&gt;</a> &amp;);</div><div class="line"><a name="l03920"></a><span class="lineno"> 3920</span>&#160;};</div><div class="line"><a name="l03921"></a><span class="lineno"> 3921</span>&#160;</div><div class="line"><a name="l03922"></a><span class="lineno"> 3922</span>&#160;</div><div class="line"><a name="l03923"></a><span class="lineno"> 3923</span>&#160;</div><div class="line"><a name="l03929"></a><span class="lineno"> 3929</span>&#160;<span class="keyword">template</span> &lt;&gt;</div><div class="line"><a name="l03930"></a><span class="lineno"> 3930</span>&#160;<span class="keyword">inline</span> <a class="code" href="config_8h.html#a1d1d58e8be15e5c4285f6892e5f33136">DEAL_II_ALWAYS_INLINE</a> <span class="keywordtype">void</span></div><div class="line"><a name="l03931"></a><span class="lineno"> 3931</span>&#160;<a class="code" href="vectorization_8h.html#a14da4327264fd3a88a9f73a8f72a9094">vectorized_load_and_transpose</a>(<span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span>         n_entries,</div><div class="line"><a name="l03932"></a><span class="lineno"> 3932</span>&#160;                              <span class="keyword">const</span> <span class="keywordtype">float</span> *              in,</div><div class="line"><a name="l03933"></a><span class="lineno"> 3933</span>&#160;                              <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> *       offsets,</div><div class="line"><a name="l03934"></a><span class="lineno"> 3934</span>&#160;                              <a class="code" href="classVectorizedArray.html">VectorizedArray&lt;float, 4&gt;</a> *out)</div><div class="line"><a name="l03935"></a><span class="lineno"> 3935</span>&#160;{</div><div class="line"><a name="l03936"></a><span class="lineno"> 3936</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> n_chunks = n_entries / 4;</div><div class="line"><a name="l03937"></a><span class="lineno"> 3937</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i = 0; i &lt; n_chunks; ++i)</div><div class="line"><a name="l03938"></a><span class="lineno"> 3938</span>&#160;    {</div><div class="line"><a name="l03939"></a><span class="lineno"> 3939</span>&#160;      __m128 u0           = _mm_loadu_ps(in + 4 * i + offsets[0]);</div><div class="line"><a name="l03940"></a><span class="lineno"> 3940</span>&#160;      __m128 u1           = _mm_loadu_ps(in + 4 * i + offsets[1]);</div><div class="line"><a name="l03941"></a><span class="lineno"> 3941</span>&#160;      __m128 u2           = _mm_loadu_ps(in + 4 * i + offsets[2]);</div><div class="line"><a name="l03942"></a><span class="lineno"> 3942</span>&#160;      __m128 u3           = _mm_loadu_ps(in + 4 * i + offsets[3]);</div><div class="line"><a name="l03943"></a><span class="lineno"> 3943</span>&#160;      __m128 <a class="code" href="grid__tools_8cc.html#ad817a8f7e41831b2c2971f6eb7142f26">v0</a>           = _mm_shuffle_ps(u0, u1, 0x44);</div><div class="line"><a name="l03944"></a><span class="lineno"> 3944</span>&#160;      __m128 <a class="code" href="grid__tools_8cc.html#adec67e1e77f5ae4fad3d65a5fb8036e9">v1</a>           = _mm_shuffle_ps(u0, u1, 0xee);</div><div class="line"><a name="l03945"></a><span class="lineno"> 3945</span>&#160;      __m128 v2           = _mm_shuffle_ps(u2, u3, 0x44);</div><div class="line"><a name="l03946"></a><span class="lineno"> 3946</span>&#160;      __m128 v3           = _mm_shuffle_ps(u2, u3, 0xee);</div><div class="line"><a name="l03947"></a><span class="lineno"> 3947</span>&#160;      out[4 * i + 0].<a class="code" href="classVectorizedArray.html#ad38190d02537705964e021da7ecbab3f">data</a> = _mm_shuffle_ps(v0, v2, 0x88);</div><div class="line"><a name="l03948"></a><span class="lineno"> 3948</span>&#160;      out[4 * i + 1].<a class="code" href="classVectorizedArray.html#ad38190d02537705964e021da7ecbab3f">data</a> = _mm_shuffle_ps(v0, v2, 0xdd);</div><div class="line"><a name="l03949"></a><span class="lineno"> 3949</span>&#160;      out[4 * i + 2].<a class="code" href="classVectorizedArray.html#ad38190d02537705964e021da7ecbab3f">data</a> = _mm_shuffle_ps(v1, v3, 0x88);</div><div class="line"><a name="l03950"></a><span class="lineno"> 3950</span>&#160;      out[4 * i + 3].<a class="code" href="classVectorizedArray.html#ad38190d02537705964e021da7ecbab3f">data</a> = _mm_shuffle_ps(v1, v3, 0xdd);</div><div class="line"><a name="l03951"></a><span class="lineno"> 3951</span>&#160;    }</div><div class="line"><a name="l03952"></a><span class="lineno"> 3952</span>&#160;</div><div class="line"><a name="l03953"></a><span class="lineno"> 3953</span>&#160;  <span class="comment">// remainder loop of work that does not divide by 4</span></div><div class="line"><a name="l03954"></a><span class="lineno"> 3954</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i = 4 * n_chunks; i &lt; n_entries; ++i)</div><div class="line"><a name="l03955"></a><span class="lineno"> 3955</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> v = 0; v &lt; 4; ++v)</div><div class="line"><a name="l03956"></a><span class="lineno"> 3956</span>&#160;      out[i][v] = in[offsets[v] + i];</div><div class="line"><a name="l03957"></a><span class="lineno"> 3957</span>&#160;}</div><div class="line"><a name="l03958"></a><span class="lineno"> 3958</span>&#160;</div><div class="line"><a name="l03959"></a><span class="lineno"> 3959</span>&#160;</div><div class="line"><a name="l03960"></a><span class="lineno"> 3960</span>&#160;</div><div class="line"><a name="l03966"></a><span class="lineno"> 3966</span>&#160;<span class="keyword">template</span> &lt;&gt;</div><div class="line"><a name="l03967"></a><span class="lineno"> 3967</span>&#160;<span class="keyword">inline</span> <a class="code" href="config_8h.html#a1d1d58e8be15e5c4285f6892e5f33136">DEAL_II_ALWAYS_INLINE</a> <span class="keywordtype">void</span></div><div class="line"><a name="l03968"></a><span class="lineno"> 3968</span>&#160;<a class="code" href="vectorization_8h.html#a14da4327264fd3a88a9f73a8f72a9094">vectorized_load_and_transpose</a>(<span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span>            n_entries,</div><div class="line"><a name="l03969"></a><span class="lineno"> 3969</span>&#160;                              <span class="keyword">const</span> std::array&lt;float *, 4&gt; &amp;in,</div><div class="line"><a name="l03970"></a><span class="lineno"> 3970</span>&#160;                              <a class="code" href="classVectorizedArray.html">VectorizedArray&lt;float, 4&gt;</a> *   out)</div><div class="line"><a name="l03971"></a><span class="lineno"> 3971</span>&#160;{</div><div class="line"><a name="l03972"></a><span class="lineno"> 3972</span>&#160;  <span class="comment">// see the comments in the vectorized_load_and_transpose above</span></div><div class="line"><a name="l03973"></a><span class="lineno"> 3973</span>&#160;</div><div class="line"><a name="l03974"></a><span class="lineno"> 3974</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> n_chunks = n_entries / 4;</div><div class="line"><a name="l03975"></a><span class="lineno"> 3975</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i = 0; i &lt; n_chunks; ++i)</div><div class="line"><a name="l03976"></a><span class="lineno"> 3976</span>&#160;    {</div><div class="line"><a name="l03977"></a><span class="lineno"> 3977</span>&#160;      __m128 u0           = _mm_loadu_ps(in[0] + 4 * i);</div><div class="line"><a name="l03978"></a><span class="lineno"> 3978</span>&#160;      __m128 u1           = _mm_loadu_ps(in[1] + 4 * i);</div><div class="line"><a name="l03979"></a><span class="lineno"> 3979</span>&#160;      __m128 u2           = _mm_loadu_ps(in[2] + 4 * i);</div><div class="line"><a name="l03980"></a><span class="lineno"> 3980</span>&#160;      __m128 u3           = _mm_loadu_ps(in[3] + 4 * i);</div><div class="line"><a name="l03981"></a><span class="lineno"> 3981</span>&#160;      __m128 <a class="code" href="grid__tools_8cc.html#ad817a8f7e41831b2c2971f6eb7142f26">v0</a>           = _mm_shuffle_ps(u0, u1, 0x44);</div><div class="line"><a name="l03982"></a><span class="lineno"> 3982</span>&#160;      __m128 <a class="code" href="grid__tools_8cc.html#adec67e1e77f5ae4fad3d65a5fb8036e9">v1</a>           = _mm_shuffle_ps(u0, u1, 0xee);</div><div class="line"><a name="l03983"></a><span class="lineno"> 3983</span>&#160;      __m128 v2           = _mm_shuffle_ps(u2, u3, 0x44);</div><div class="line"><a name="l03984"></a><span class="lineno"> 3984</span>&#160;      __m128 v3           = _mm_shuffle_ps(u2, u3, 0xee);</div><div class="line"><a name="l03985"></a><span class="lineno"> 3985</span>&#160;      out[4 * i + 0].<a class="code" href="classVectorizedArray.html#ad38190d02537705964e021da7ecbab3f">data</a> = _mm_shuffle_ps(v0, v2, 0x88);</div><div class="line"><a name="l03986"></a><span class="lineno"> 3986</span>&#160;      out[4 * i + 1].<a class="code" href="classVectorizedArray.html#ad38190d02537705964e021da7ecbab3f">data</a> = _mm_shuffle_ps(v0, v2, 0xdd);</div><div class="line"><a name="l03987"></a><span class="lineno"> 3987</span>&#160;      out[4 * i + 2].<a class="code" href="classVectorizedArray.html#ad38190d02537705964e021da7ecbab3f">data</a> = _mm_shuffle_ps(v1, v3, 0x88);</div><div class="line"><a name="l03988"></a><span class="lineno"> 3988</span>&#160;      out[4 * i + 3].<a class="code" href="classVectorizedArray.html#ad38190d02537705964e021da7ecbab3f">data</a> = _mm_shuffle_ps(v1, v3, 0xdd);</div><div class="line"><a name="l03989"></a><span class="lineno"> 3989</span>&#160;    }</div><div class="line"><a name="l03990"></a><span class="lineno"> 3990</span>&#160;</div><div class="line"><a name="l03991"></a><span class="lineno"> 3991</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i = 4 * n_chunks; i &lt; n_entries; ++i)</div><div class="line"><a name="l03992"></a><span class="lineno"> 3992</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> v = 0; v &lt; 4; ++v)</div><div class="line"><a name="l03993"></a><span class="lineno"> 3993</span>&#160;      out[i][v] = in[v][i];</div><div class="line"><a name="l03994"></a><span class="lineno"> 3994</span>&#160;}</div><div class="line"><a name="l03995"></a><span class="lineno"> 3995</span>&#160;</div><div class="line"><a name="l03996"></a><span class="lineno"> 3996</span>&#160;</div><div class="line"><a name="l03997"></a><span class="lineno"> 3997</span>&#160;</div><div class="line"><a name="l04003"></a><span class="lineno"> 4003</span>&#160;<span class="keyword">template</span> &lt;&gt;</div><div class="line"><a name="l04004"></a><span class="lineno"> 4004</span>&#160;<span class="keyword">inline</span> <a class="code" href="config_8h.html#a1d1d58e8be15e5c4285f6892e5f33136">DEAL_II_ALWAYS_INLINE</a> <span class="keywordtype">void</span></div><div class="line"><a name="l04005"></a><span class="lineno"> 4005</span>&#160;<a class="code" href="vectorization_8h.html#af396b43c783502e8acd2ca7d071a7325">vectorized_transpose_and_store</a>(<span class="keyword">const</span> <span class="keywordtype">bool</span>                       add_into,</div><div class="line"><a name="l04006"></a><span class="lineno"> 4006</span>&#160;                               <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span>               n_entries,</div><div class="line"><a name="l04007"></a><span class="lineno"> 4007</span>&#160;                               <span class="keyword">const</span> <a class="code" href="classVectorizedArray.html">VectorizedArray&lt;float, 4&gt;</a> *in,</div><div class="line"><a name="l04008"></a><span class="lineno"> 4008</span>&#160;                               <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> *             offsets,</div><div class="line"><a name="l04009"></a><span class="lineno"> 4009</span>&#160;                               <span class="keywordtype">float</span> *                          out)</div><div class="line"><a name="l04010"></a><span class="lineno"> 4010</span>&#160;{</div><div class="line"><a name="l04011"></a><span class="lineno"> 4011</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> n_chunks = n_entries / 4;</div><div class="line"><a name="l04012"></a><span class="lineno"> 4012</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i = 0; i &lt; n_chunks; ++i)</div><div class="line"><a name="l04013"></a><span class="lineno"> 4013</span>&#160;    {</div><div class="line"><a name="l04014"></a><span class="lineno"> 4014</span>&#160;      __m128 u0 = in[4 * i + 0].<a class="code" href="classVectorizedArray.html#ad38190d02537705964e021da7ecbab3f">data</a>;</div><div class="line"><a name="l04015"></a><span class="lineno"> 4015</span>&#160;      __m128 u1 = in[4 * i + 1].<a class="code" href="classVectorizedArray.html#ad38190d02537705964e021da7ecbab3f">data</a>;</div><div class="line"><a name="l04016"></a><span class="lineno"> 4016</span>&#160;      __m128 u2 = in[4 * i + 2].<a class="code" href="classVectorizedArray.html#ad38190d02537705964e021da7ecbab3f">data</a>;</div><div class="line"><a name="l04017"></a><span class="lineno"> 4017</span>&#160;      __m128 u3 = in[4 * i + 3].<a class="code" href="classVectorizedArray.html#ad38190d02537705964e021da7ecbab3f">data</a>;</div><div class="line"><a name="l04018"></a><span class="lineno"> 4018</span>&#160;      __m128 t0 = _mm_shuffle_ps(u0, u1, 0x44);</div><div class="line"><a name="l04019"></a><span class="lineno"> 4019</span>&#160;      __m128 t1 = _mm_shuffle_ps(u0, u1, 0xee);</div><div class="line"><a name="l04020"></a><span class="lineno"> 4020</span>&#160;      __m128 t2 = _mm_shuffle_ps(u2, u3, 0x44);</div><div class="line"><a name="l04021"></a><span class="lineno"> 4021</span>&#160;      __m128 t3 = _mm_shuffle_ps(u2, u3, 0xee);</div><div class="line"><a name="l04022"></a><span class="lineno"> 4022</span>&#160;      u0        = _mm_shuffle_ps(t0, t2, 0x88);</div><div class="line"><a name="l04023"></a><span class="lineno"> 4023</span>&#160;      u1        = _mm_shuffle_ps(t0, t2, 0xdd);</div><div class="line"><a name="l04024"></a><span class="lineno"> 4024</span>&#160;      u2        = _mm_shuffle_ps(t1, t3, 0x88);</div><div class="line"><a name="l04025"></a><span class="lineno"> 4025</span>&#160;      u3        = _mm_shuffle_ps(t1, t3, 0xdd);</div><div class="line"><a name="l04026"></a><span class="lineno"> 4026</span>&#160;</div><div class="line"><a name="l04027"></a><span class="lineno"> 4027</span>&#160;      <span class="comment">// Cannot use the same store instructions in both paths of the &#39;if&#39;</span></div><div class="line"><a name="l04028"></a><span class="lineno"> 4028</span>&#160;      <span class="comment">// because the compiler cannot know that there is no aliasing between</span></div><div class="line"><a name="l04029"></a><span class="lineno"> 4029</span>&#160;      <span class="comment">// pointers</span></div><div class="line"><a name="l04030"></a><span class="lineno"> 4030</span>&#160;      <span class="keywordflow">if</span> (add_into)</div><div class="line"><a name="l04031"></a><span class="lineno"> 4031</span>&#160;        {</div><div class="line"><a name="l04032"></a><span class="lineno"> 4032</span>&#160;          u0 = _mm_add_ps(_mm_loadu_ps(out + 4 * i + offsets[0]), u0);</div><div class="line"><a name="l04033"></a><span class="lineno"> 4033</span>&#160;          _mm_storeu_ps(out + 4 * i + offsets[0], u0);</div><div class="line"><a name="l04034"></a><span class="lineno"> 4034</span>&#160;          u1 = _mm_add_ps(_mm_loadu_ps(out + 4 * i + offsets[1]), u1);</div><div class="line"><a name="l04035"></a><span class="lineno"> 4035</span>&#160;          _mm_storeu_ps(out + 4 * i + offsets[1], u1);</div><div class="line"><a name="l04036"></a><span class="lineno"> 4036</span>&#160;          u2 = _mm_add_ps(_mm_loadu_ps(out + 4 * i + offsets[2]), u2);</div><div class="line"><a name="l04037"></a><span class="lineno"> 4037</span>&#160;          _mm_storeu_ps(out + 4 * i + offsets[2], u2);</div><div class="line"><a name="l04038"></a><span class="lineno"> 4038</span>&#160;          u3 = _mm_add_ps(_mm_loadu_ps(out + 4 * i + offsets[3]), u3);</div><div class="line"><a name="l04039"></a><span class="lineno"> 4039</span>&#160;          _mm_storeu_ps(out + 4 * i + offsets[3], u3);</div><div class="line"><a name="l04040"></a><span class="lineno"> 4040</span>&#160;        }</div><div class="line"><a name="l04041"></a><span class="lineno"> 4041</span>&#160;      <span class="keywordflow">else</span></div><div class="line"><a name="l04042"></a><span class="lineno"> 4042</span>&#160;        {</div><div class="line"><a name="l04043"></a><span class="lineno"> 4043</span>&#160;          _mm_storeu_ps(out + 4 * i + offsets[0], u0);</div><div class="line"><a name="l04044"></a><span class="lineno"> 4044</span>&#160;          _mm_storeu_ps(out + 4 * i + offsets[1], u1);</div><div class="line"><a name="l04045"></a><span class="lineno"> 4045</span>&#160;          _mm_storeu_ps(out + 4 * i + offsets[2], u2);</div><div class="line"><a name="l04046"></a><span class="lineno"> 4046</span>&#160;          _mm_storeu_ps(out + 4 * i + offsets[3], u3);</div><div class="line"><a name="l04047"></a><span class="lineno"> 4047</span>&#160;        }</div><div class="line"><a name="l04048"></a><span class="lineno"> 4048</span>&#160;    }</div><div class="line"><a name="l04049"></a><span class="lineno"> 4049</span>&#160;</div><div class="line"><a name="l04050"></a><span class="lineno"> 4050</span>&#160;  <span class="comment">// remainder loop of work that does not divide by 4</span></div><div class="line"><a name="l04051"></a><span class="lineno"> 4051</span>&#160;  <span class="keywordflow">if</span> (add_into)</div><div class="line"><a name="l04052"></a><span class="lineno"> 4052</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i = 4 * n_chunks; i &lt; n_entries; ++i)</div><div class="line"><a name="l04053"></a><span class="lineno"> 4053</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> v = 0; v &lt; 4; ++v)</div><div class="line"><a name="l04054"></a><span class="lineno"> 4054</span>&#160;        out[offsets[v] + i] += in[i][v];</div><div class="line"><a name="l04055"></a><span class="lineno"> 4055</span>&#160;  <span class="keywordflow">else</span></div><div class="line"><a name="l04056"></a><span class="lineno"> 4056</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i = 4 * n_chunks; i &lt; n_entries; ++i)</div><div class="line"><a name="l04057"></a><span class="lineno"> 4057</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> v = 0; v &lt; 4; ++v)</div><div class="line"><a name="l04058"></a><span class="lineno"> 4058</span>&#160;        out[offsets[v] + i] = in[i][v];</div><div class="line"><a name="l04059"></a><span class="lineno"> 4059</span>&#160;}</div><div class="line"><a name="l04060"></a><span class="lineno"> 4060</span>&#160;</div><div class="line"><a name="l04061"></a><span class="lineno"> 4061</span>&#160;</div><div class="line"><a name="l04062"></a><span class="lineno"> 4062</span>&#160;</div><div class="line"><a name="l04068"></a><span class="lineno"> 4068</span>&#160;<span class="keyword">template</span> &lt;&gt;</div><div class="line"><a name="l04069"></a><span class="lineno"> 4069</span>&#160;<span class="keyword">inline</span> <a class="code" href="config_8h.html#a1d1d58e8be15e5c4285f6892e5f33136">DEAL_II_ALWAYS_INLINE</a> <span class="keywordtype">void</span></div><div class="line"><a name="l04070"></a><span class="lineno"> 4070</span>&#160;<a class="code" href="vectorization_8h.html#af396b43c783502e8acd2ca7d071a7325">vectorized_transpose_and_store</a>(<span class="keyword">const</span> <span class="keywordtype">bool</span>                       add_into,</div><div class="line"><a name="l04071"></a><span class="lineno"> 4071</span>&#160;                               <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span>               n_entries,</div><div class="line"><a name="l04072"></a><span class="lineno"> 4072</span>&#160;                               <span class="keyword">const</span> <a class="code" href="classVectorizedArray.html">VectorizedArray&lt;float, 4&gt;</a> *in,</div><div class="line"><a name="l04073"></a><span class="lineno"> 4073</span>&#160;                               std::array&lt;float *, 4&gt; &amp;         out)</div><div class="line"><a name="l04074"></a><span class="lineno"> 4074</span>&#160;{</div><div class="line"><a name="l04075"></a><span class="lineno"> 4075</span>&#160;  <span class="comment">// see the comments in the vectorized_transpose_and_store above</span></div><div class="line"><a name="l04076"></a><span class="lineno"> 4076</span>&#160;</div><div class="line"><a name="l04077"></a><span class="lineno"> 4077</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> n_chunks = n_entries / 4;</div><div class="line"><a name="l04078"></a><span class="lineno"> 4078</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i = 0; i &lt; n_chunks; ++i)</div><div class="line"><a name="l04079"></a><span class="lineno"> 4079</span>&#160;    {</div><div class="line"><a name="l04080"></a><span class="lineno"> 4080</span>&#160;      __m128 u0 = in[4 * i + 0].<a class="code" href="classVectorizedArray.html#ad38190d02537705964e021da7ecbab3f">data</a>;</div><div class="line"><a name="l04081"></a><span class="lineno"> 4081</span>&#160;      __m128 u1 = in[4 * i + 1].<a class="code" href="classVectorizedArray.html#ad38190d02537705964e021da7ecbab3f">data</a>;</div><div class="line"><a name="l04082"></a><span class="lineno"> 4082</span>&#160;      __m128 u2 = in[4 * i + 2].<a class="code" href="classVectorizedArray.html#ad38190d02537705964e021da7ecbab3f">data</a>;</div><div class="line"><a name="l04083"></a><span class="lineno"> 4083</span>&#160;      __m128 u3 = in[4 * i + 3].<a class="code" href="classVectorizedArray.html#ad38190d02537705964e021da7ecbab3f">data</a>;</div><div class="line"><a name="l04084"></a><span class="lineno"> 4084</span>&#160;      __m128 t0 = _mm_shuffle_ps(u0, u1, 0x44);</div><div class="line"><a name="l04085"></a><span class="lineno"> 4085</span>&#160;      __m128 t1 = _mm_shuffle_ps(u0, u1, 0xee);</div><div class="line"><a name="l04086"></a><span class="lineno"> 4086</span>&#160;      __m128 t2 = _mm_shuffle_ps(u2, u3, 0x44);</div><div class="line"><a name="l04087"></a><span class="lineno"> 4087</span>&#160;      __m128 t3 = _mm_shuffle_ps(u2, u3, 0xee);</div><div class="line"><a name="l04088"></a><span class="lineno"> 4088</span>&#160;      u0        = _mm_shuffle_ps(t0, t2, 0x88);</div><div class="line"><a name="l04089"></a><span class="lineno"> 4089</span>&#160;      u1        = _mm_shuffle_ps(t0, t2, 0xdd);</div><div class="line"><a name="l04090"></a><span class="lineno"> 4090</span>&#160;      u2        = _mm_shuffle_ps(t1, t3, 0x88);</div><div class="line"><a name="l04091"></a><span class="lineno"> 4091</span>&#160;      u3        = _mm_shuffle_ps(t1, t3, 0xdd);</div><div class="line"><a name="l04092"></a><span class="lineno"> 4092</span>&#160;</div><div class="line"><a name="l04093"></a><span class="lineno"> 4093</span>&#160;      <span class="keywordflow">if</span> (add_into)</div><div class="line"><a name="l04094"></a><span class="lineno"> 4094</span>&#160;        {</div><div class="line"><a name="l04095"></a><span class="lineno"> 4095</span>&#160;          u0 = _mm_add_ps(_mm_loadu_ps(out[0] + 4 * i), u0);</div><div class="line"><a name="l04096"></a><span class="lineno"> 4096</span>&#160;          _mm_storeu_ps(out[0] + 4 * i, u0);</div><div class="line"><a name="l04097"></a><span class="lineno"> 4097</span>&#160;          u1 = _mm_add_ps(_mm_loadu_ps(out[1] + 4 * i), u1);</div><div class="line"><a name="l04098"></a><span class="lineno"> 4098</span>&#160;          _mm_storeu_ps(out[1] + 4 * i, u1);</div><div class="line"><a name="l04099"></a><span class="lineno"> 4099</span>&#160;          u2 = _mm_add_ps(_mm_loadu_ps(out[2] + 4 * i), u2);</div><div class="line"><a name="l04100"></a><span class="lineno"> 4100</span>&#160;          _mm_storeu_ps(out[2] + 4 * i, u2);</div><div class="line"><a name="l04101"></a><span class="lineno"> 4101</span>&#160;          u3 = _mm_add_ps(_mm_loadu_ps(out[3] + 4 * i), u3);</div><div class="line"><a name="l04102"></a><span class="lineno"> 4102</span>&#160;          _mm_storeu_ps(out[3] + 4 * i, u3);</div><div class="line"><a name="l04103"></a><span class="lineno"> 4103</span>&#160;        }</div><div class="line"><a name="l04104"></a><span class="lineno"> 4104</span>&#160;      <span class="keywordflow">else</span></div><div class="line"><a name="l04105"></a><span class="lineno"> 4105</span>&#160;        {</div><div class="line"><a name="l04106"></a><span class="lineno"> 4106</span>&#160;          _mm_storeu_ps(out[0] + 4 * i, u0);</div><div class="line"><a name="l04107"></a><span class="lineno"> 4107</span>&#160;          _mm_storeu_ps(out[1] + 4 * i, u1);</div><div class="line"><a name="l04108"></a><span class="lineno"> 4108</span>&#160;          _mm_storeu_ps(out[2] + 4 * i, u2);</div><div class="line"><a name="l04109"></a><span class="lineno"> 4109</span>&#160;          _mm_storeu_ps(out[3] + 4 * i, u3);</div><div class="line"><a name="l04110"></a><span class="lineno"> 4110</span>&#160;        }</div><div class="line"><a name="l04111"></a><span class="lineno"> 4111</span>&#160;    }</div><div class="line"><a name="l04112"></a><span class="lineno"> 4112</span>&#160;</div><div class="line"><a name="l04113"></a><span class="lineno"> 4113</span>&#160;  <span class="keywordflow">if</span> (add_into)</div><div class="line"><a name="l04114"></a><span class="lineno"> 4114</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i = 4 * n_chunks; i &lt; n_entries; ++i)</div><div class="line"><a name="l04115"></a><span class="lineno"> 4115</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> v = 0; v &lt; 4; ++v)</div><div class="line"><a name="l04116"></a><span class="lineno"> 4116</span>&#160;        out[v][i] += in[i][v];</div><div class="line"><a name="l04117"></a><span class="lineno"> 4117</span>&#160;  <span class="keywordflow">else</span></div><div class="line"><a name="l04118"></a><span class="lineno"> 4118</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i = 4 * n_chunks; i &lt; n_entries; ++i)</div><div class="line"><a name="l04119"></a><span class="lineno"> 4119</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> v = 0; v &lt; 4; ++v)</div><div class="line"><a name="l04120"></a><span class="lineno"> 4120</span>&#160;        out[v][i] = in[i][v];</div><div class="line"><a name="l04121"></a><span class="lineno"> 4121</span>&#160;}</div><div class="line"><a name="l04122"></a><span class="lineno"> 4122</span>&#160;</div><div class="line"><a name="l04123"></a><span class="lineno"> 4123</span>&#160;</div><div class="line"><a name="l04124"></a><span class="lineno"> 4124</span>&#160;</div><div class="line"><a name="l04125"></a><span class="lineno"> 4125</span>&#160;<span class="preprocessor">#  endif // if DEAL_II_VECTORIZATION_WIDTH_IN_BITS &gt; 0 &amp;&amp; defined(__SSE2__)</span></div><div class="line"><a name="l04126"></a><span class="lineno"> 4126</span>&#160;</div><div class="line"><a name="l04127"></a><span class="lineno"> 4127</span>&#160;<span class="preprocessor">#  if DEAL_II_VECTORIZATION_WIDTH_IN_BITS &gt;= 128 &amp;&amp; defined(__ALTIVEC__) &amp;&amp; \</span></div><div class="line"><a name="l04128"></a><span class="lineno"> 4128</span>&#160;<span class="preprocessor">    defined(__VSX__)</span></div><div class="line"><a name="l04129"></a><span class="lineno"> 4129</span>&#160;</div><div class="line"><a name="l04130"></a><span class="lineno"> 4130</span>&#160;<span class="keyword">template</span> &lt;&gt;</div><div class="line"><a name="l04131"></a><span class="lineno"> 4131</span>&#160;<span class="keyword">class </span><a class="code" href="classVectorizedArray.html">VectorizedArray</a>&lt;double, 2&gt;</div><div class="line"><a name="l04132"></a><span class="lineno"> 4132</span>&#160;  : <span class="keyword">public</span> <a class="code" href="classVectorizedArrayBase.html">VectorizedArrayBase</a>&lt;VectorizedArray&lt;double, 2&gt;, 2&gt;</div><div class="line"><a name="l04133"></a><span class="lineno"> 4133</span>&#160;{</div><div class="line"><a name="l04134"></a><span class="lineno"> 4134</span>&#160;<span class="keyword">public</span>:</div><div class="line"><a name="l04139"></a><span class="lineno"> 4139</span>&#160;  <span class="keyword">using</span> value_type = double;</div><div class="line"><a name="l04140"></a><span class="lineno"> 4140</span>&#160;</div><div class="line"><a name="l04145"></a><span class="lineno"> 4145</span>&#160;  <a class="code" href="classVectorizedArray.html">VectorizedArray</a>() = <span class="keywordflow">default</span>;</div><div class="line"><a name="l04146"></a><span class="lineno"> 4146</span>&#160;</div><div class="line"><a name="l04151"></a><span class="lineno"> 4151</span>&#160;  <a class="code" href="classVectorizedArray.html">VectorizedArray</a>(<span class="keyword">const</span> <span class="keywordtype">double</span> scalar)</div><div class="line"><a name="l04152"></a><span class="lineno"> 4152</span>&#160;  {</div><div class="line"><a name="l04153"></a><span class="lineno"> 4153</span>&#160;    this-&gt;operator=(scalar);</div><div class="line"><a name="l04154"></a><span class="lineno"> 4154</span>&#160;  }</div><div class="line"><a name="l04155"></a><span class="lineno"> 4155</span>&#160;</div><div class="line"><a name="l04160"></a><span class="lineno"> 4160</span>&#160;  <a class="code" href="config_8h.html#a1d1d58e8be15e5c4285f6892e5f33136">DEAL_II_ALWAYS_INLINE</a></div><div class="line"><a name="l04161"></a><span class="lineno"> 4161</span>&#160;  <a class="code" href="classVectorizedArray.html">VectorizedArray</a> &amp;</div><div class="line"><a name="l04162"></a><span class="lineno"> 4162</span>&#160;  operator=(<span class="keyword">const</span> <span class="keywordtype">double</span> x)</div><div class="line"><a name="l04163"></a><span class="lineno"> 4163</span>&#160;  {</div><div class="line"><a name="l04164"></a><span class="lineno"> 4164</span>&#160;    data = vec_splats(x);</div><div class="line"><a name="l04165"></a><span class="lineno"> 4165</span>&#160;</div><div class="line"><a name="l04166"></a><span class="lineno"> 4166</span>&#160;    <span class="comment">// Some compilers believe that vec_splats sets &#39;x&#39;, but that&#39;s not true.</span></div><div class="line"><a name="l04167"></a><span class="lineno"> 4167</span>&#160;    <span class="comment">// They then warn about setting a variable and not using it. Suppress the</span></div><div class="line"><a name="l04168"></a><span class="lineno"> 4168</span>&#160;    <span class="comment">// warning by &quot;using&quot; the variable:</span></div><div class="line"><a name="l04169"></a><span class="lineno"> 4169</span>&#160;    (void)x;</div><div class="line"><a name="l04170"></a><span class="lineno"> 4170</span>&#160;    <span class="keywordflow">return</span> *<span class="keyword">this</span>;</div><div class="line"><a name="l04171"></a><span class="lineno"> 4171</span>&#160;  }</div><div class="line"><a name="l04172"></a><span class="lineno"> 4172</span>&#160;</div><div class="line"><a name="l04177"></a><span class="lineno"> 4177</span>&#160;  <a class="code" href="config_8h.html#a1d1d58e8be15e5c4285f6892e5f33136">DEAL_II_ALWAYS_INLINE</a></div><div class="line"><a name="l04178"></a><span class="lineno"> 4178</span>&#160;  <span class="keywordtype">double</span> &amp;operator[](<span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> comp)</div><div class="line"><a name="l04179"></a><span class="lineno"> 4179</span>&#160;  {</div><div class="line"><a name="l04180"></a><span class="lineno"> 4180</span>&#160;    <a class="code" href="group__Exceptions.html#gaafbb69cc2a791ae55880fd8d57d0c1b0">AssertIndexRange</a>(comp, 2);</div><div class="line"><a name="l04181"></a><span class="lineno"> 4181</span>&#160;    <span class="keywordflow">return</span> *(<span class="keyword">reinterpret_cast&lt;</span><span class="keywordtype">double</span> *<span class="keyword">&gt;</span>(&amp;data) + comp);</div><div class="line"><a name="l04182"></a><span class="lineno"> 4182</span>&#160;  }</div><div class="line"><a name="l04183"></a><span class="lineno"> 4183</span>&#160;</div><div class="line"><a name="l04188"></a><span class="lineno"> 4188</span>&#160;  <a class="code" href="config_8h.html#a1d1d58e8be15e5c4285f6892e5f33136">DEAL_II_ALWAYS_INLINE</a></div><div class="line"><a name="l04189"></a><span class="lineno"> 4189</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">double</span> &amp;operator[](<span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> comp)<span class="keyword"> const</span></div><div class="line"><a name="l04190"></a><span class="lineno"> 4190</span>&#160;<span class="keyword">  </span>{</div><div class="line"><a name="l04191"></a><span class="lineno"> 4191</span>&#160;    <a class="code" href="group__Exceptions.html#gaafbb69cc2a791ae55880fd8d57d0c1b0">AssertIndexRange</a>(comp, 2);</div><div class="line"><a name="l04192"></a><span class="lineno"> 4192</span>&#160;    <span class="keywordflow">return</span> *(<span class="keyword">reinterpret_cast&lt;</span><span class="keyword">const </span><span class="keywordtype">double</span> *<span class="keyword">&gt;</span>(&amp;data) + comp);</div><div class="line"><a name="l04193"></a><span class="lineno"> 4193</span>&#160;  }</div><div class="line"><a name="l04194"></a><span class="lineno"> 4194</span>&#160;</div><div class="line"><a name="l04199"></a><span class="lineno"> 4199</span>&#160;  <a class="code" href="config_8h.html#a1d1d58e8be15e5c4285f6892e5f33136">DEAL_II_ALWAYS_INLINE</a></div><div class="line"><a name="l04200"></a><span class="lineno"> 4200</span>&#160;  <a class="code" href="classVectorizedArray.html">VectorizedArray</a> &amp;</div><div class="line"><a name="l04201"></a><span class="lineno"> 4201</span>&#160;  operator+=(<span class="keyword">const</span> <a class="code" href="classVectorizedArray.html">VectorizedArray</a> &amp;vec)</div><div class="line"><a name="l04202"></a><span class="lineno"> 4202</span>&#160;  {</div><div class="line"><a name="l04203"></a><span class="lineno"> 4203</span>&#160;    data = <a class="code" href="group__CUDAWrappers.html#ga509717d30efa99a22a7730b16b17b3ab">vec_add</a>(data, vec.<a class="code" href="classVectorizedArray.html#ad38190d02537705964e021da7ecbab3f">data</a>);</div><div class="line"><a name="l04204"></a><span class="lineno"> 4204</span>&#160;    <span class="keywordflow">return</span> *<span class="keyword">this</span>;</div><div class="line"><a name="l04205"></a><span class="lineno"> 4205</span>&#160;  }</div><div class="line"><a name="l04206"></a><span class="lineno"> 4206</span>&#160;</div><div class="line"><a name="l04211"></a><span class="lineno"> 4211</span>&#160;  <a class="code" href="config_8h.html#a1d1d58e8be15e5c4285f6892e5f33136">DEAL_II_ALWAYS_INLINE</a></div><div class="line"><a name="l04212"></a><span class="lineno"> 4212</span>&#160;  <a class="code" href="classVectorizedArray.html">VectorizedArray</a> &amp;</div><div class="line"><a name="l04213"></a><span class="lineno"> 4213</span>&#160;  operator-=(<span class="keyword">const</span> <a class="code" href="classVectorizedArray.html">VectorizedArray</a> &amp;vec)</div><div class="line"><a name="l04214"></a><span class="lineno"> 4214</span>&#160;  {</div><div class="line"><a name="l04215"></a><span class="lineno"> 4215</span>&#160;    data = vec_sub(data, vec.<a class="code" href="classVectorizedArray.html#ad38190d02537705964e021da7ecbab3f">data</a>);</div><div class="line"><a name="l04216"></a><span class="lineno"> 4216</span>&#160;    <span class="keywordflow">return</span> *<span class="keyword">this</span>;</div><div class="line"><a name="l04217"></a><span class="lineno"> 4217</span>&#160;  }</div><div class="line"><a name="l04218"></a><span class="lineno"> 4218</span>&#160;</div><div class="line"><a name="l04223"></a><span class="lineno"> 4223</span>&#160;  <a class="code" href="config_8h.html#a1d1d58e8be15e5c4285f6892e5f33136">DEAL_II_ALWAYS_INLINE</a></div><div class="line"><a name="l04224"></a><span class="lineno"> 4224</span>&#160;  <a class="code" href="classVectorizedArray.html">VectorizedArray</a> &amp;</div><div class="line"><a name="l04225"></a><span class="lineno"> 4225</span>&#160;  operator*=(<span class="keyword">const</span> <a class="code" href="classVectorizedArray.html">VectorizedArray</a> &amp;vec)</div><div class="line"><a name="l04226"></a><span class="lineno"> 4226</span>&#160;  {</div><div class="line"><a name="l04227"></a><span class="lineno"> 4227</span>&#160;    data = vec_mul(data, vec.<a class="code" href="classVectorizedArray.html#ad38190d02537705964e021da7ecbab3f">data</a>);</div><div class="line"><a name="l04228"></a><span class="lineno"> 4228</span>&#160;    <span class="keywordflow">return</span> *<span class="keyword">this</span>;</div><div class="line"><a name="l04229"></a><span class="lineno"> 4229</span>&#160;  }</div><div class="line"><a name="l04230"></a><span class="lineno"> 4230</span>&#160;</div><div class="line"><a name="l04235"></a><span class="lineno"> 4235</span>&#160;  <a class="code" href="config_8h.html#a1d1d58e8be15e5c4285f6892e5f33136">DEAL_II_ALWAYS_INLINE</a></div><div class="line"><a name="l04236"></a><span class="lineno"> 4236</span>&#160;  <a class="code" href="classVectorizedArray.html">VectorizedArray</a> &amp;</div><div class="line"><a name="l04237"></a><span class="lineno"> 4237</span>&#160;  operator/=(<span class="keyword">const</span> <a class="code" href="classVectorizedArray.html">VectorizedArray</a> &amp;vec)</div><div class="line"><a name="l04238"></a><span class="lineno"> 4238</span>&#160;  {</div><div class="line"><a name="l04239"></a><span class="lineno"> 4239</span>&#160;    data = vec_div(data, vec.<a class="code" href="classVectorizedArray.html#ad38190d02537705964e021da7ecbab3f">data</a>);</div><div class="line"><a name="l04240"></a><span class="lineno"> 4240</span>&#160;    <span class="keywordflow">return</span> *<span class="keyword">this</span>;</div><div class="line"><a name="l04241"></a><span class="lineno"> 4241</span>&#160;  }</div><div class="line"><a name="l04242"></a><span class="lineno"> 4242</span>&#160;</div><div class="line"><a name="l04248"></a><span class="lineno"> 4248</span>&#160;  <a class="code" href="config_8h.html#a1d1d58e8be15e5c4285f6892e5f33136">DEAL_II_ALWAYS_INLINE</a></div><div class="line"><a name="l04249"></a><span class="lineno"> 4249</span>&#160;  <span class="keywordtype">void</span></div><div class="line"><a name="l04250"></a><span class="lineno"> 4250</span>&#160;  load(<span class="keyword">const</span> <span class="keywordtype">double</span> *ptr)</div><div class="line"><a name="l04251"></a><span class="lineno"> 4251</span>&#160;  {</div><div class="line"><a name="l04252"></a><span class="lineno"> 4252</span>&#160;    data = vec_vsx_ld(0, ptr);</div><div class="line"><a name="l04253"></a><span class="lineno"> 4253</span>&#160;  }</div><div class="line"><a name="l04254"></a><span class="lineno"> 4254</span>&#160;</div><div class="line"><a name="l04260"></a><span class="lineno"> 4260</span>&#160;  <a class="code" href="config_8h.html#a1d1d58e8be15e5c4285f6892e5f33136">DEAL_II_ALWAYS_INLINE</a></div><div class="line"><a name="l04261"></a><span class="lineno"> 4261</span>&#160;  <span class="keywordtype">void</span></div><div class="line"><a name="l04262"></a><span class="lineno"> 4262</span>&#160;  store(<span class="keywordtype">double</span> *ptr)<span class="keyword"> const</span></div><div class="line"><a name="l04263"></a><span class="lineno"> 4263</span>&#160;<span class="keyword">  </span>{</div><div class="line"><a name="l04264"></a><span class="lineno"> 4264</span>&#160;    vec_vsx_st(data, 0, ptr);</div><div class="line"><a name="l04265"></a><span class="lineno"> 4265</span>&#160;  }</div><div class="line"><a name="l04266"></a><span class="lineno"> 4266</span>&#160;</div><div class="line"><a name="l04270"></a><span class="lineno"> 4270</span>&#160;  <a class="code" href="config_8h.html#a1d1d58e8be15e5c4285f6892e5f33136">DEAL_II_ALWAYS_INLINE</a></div><div class="line"><a name="l04271"></a><span class="lineno"> 4271</span>&#160;  <span class="keywordtype">void</span></div><div class="line"><a name="l04272"></a><span class="lineno"> 4272</span>&#160;  streaming_store(<span class="keywordtype">double</span> *ptr)<span class="keyword"> const</span></div><div class="line"><a name="l04273"></a><span class="lineno"> 4273</span>&#160;<span class="keyword">  </span>{</div><div class="line"><a name="l04274"></a><span class="lineno"> 4274</span>&#160;    store(ptr);</div><div class="line"><a name="l04275"></a><span class="lineno"> 4275</span>&#160;  }</div><div class="line"><a name="l04276"></a><span class="lineno"> 4276</span>&#160;</div><div class="line"><a name="l04280"></a><span class="lineno"> 4280</span>&#160;  <a class="code" href="config_8h.html#a1d1d58e8be15e5c4285f6892e5f33136">DEAL_II_ALWAYS_INLINE</a></div><div class="line"><a name="l04281"></a><span class="lineno"> 4281</span>&#160;  <span class="keywordtype">void</span></div><div class="line"><a name="l04282"></a><span class="lineno"> 4282</span>&#160;  <a class="code" href="vectorization_8h.html#a078ca5de8d3a59aedc130823be15ad26">gather</a>(<span class="keyword">const</span> <span class="keywordtype">double</span> *base_ptr, <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> *offsets)</div><div class="line"><a name="l04283"></a><span class="lineno"> 4283</span>&#160;  {</div><div class="line"><a name="l04284"></a><span class="lineno"> 4284</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i = 0; i &lt; 2; ++i)</div><div class="line"><a name="l04285"></a><span class="lineno"> 4285</span>&#160;      *(reinterpret_cast&lt;double *&gt;(&amp;data) + i) = base_ptr[offsets[i]];</div><div class="line"><a name="l04286"></a><span class="lineno"> 4286</span>&#160;  }</div><div class="line"><a name="l04287"></a><span class="lineno"> 4287</span>&#160;</div><div class="line"><a name="l04291"></a><span class="lineno"> 4291</span>&#160;  <a class="code" href="config_8h.html#a1d1d58e8be15e5c4285f6892e5f33136">DEAL_II_ALWAYS_INLINE</a></div><div class="line"><a name="l04292"></a><span class="lineno"> 4292</span>&#160;  <span class="keywordtype">void</span></div><div class="line"><a name="l04293"></a><span class="lineno"> 4293</span>&#160;  scatter(<span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> *offsets, <span class="keywordtype">double</span> *base_ptr)<span class="keyword"> const</span></div><div class="line"><a name="l04294"></a><span class="lineno"> 4294</span>&#160;<span class="keyword">  </span>{</div><div class="line"><a name="l04295"></a><span class="lineno"> 4295</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i = 0; i &lt; 2; ++i)</div><div class="line"><a name="l04296"></a><span class="lineno"> 4296</span>&#160;      base_ptr[offsets[i]] = *(reinterpret_cast&lt;const double *&gt;(&amp;data) + i);</div><div class="line"><a name="l04297"></a><span class="lineno"> 4297</span>&#160;  }</div><div class="line"><a name="l04298"></a><span class="lineno"> 4298</span>&#160;</div><div class="line"><a name="l04303"></a><span class="lineno"> 4303</span>&#160;  __vector <span class="keywordtype">double</span> data;</div><div class="line"><a name="l04304"></a><span class="lineno"> 4304</span>&#160;</div><div class="line"><a name="l04305"></a><span class="lineno"> 4305</span>&#160;<span class="keyword">private</span>:</div><div class="line"><a name="l04310"></a><span class="lineno"> 4310</span>&#160;  <a class="code" href="config_8h.html#a1d1d58e8be15e5c4285f6892e5f33136">DEAL_II_ALWAYS_INLINE</a></div><div class="line"><a name="l04311"></a><span class="lineno"> 4311</span>&#160;  <a class="code" href="classVectorizedArray.html">VectorizedArray</a></div><div class="line"><a name="l04312"></a><span class="lineno"> 4312</span>&#160;  get_sqrt()<span class="keyword"> const</span></div><div class="line"><a name="l04313"></a><span class="lineno"> 4313</span>&#160;<span class="keyword">  </span>{</div><div class="line"><a name="l04314"></a><span class="lineno"> 4314</span>&#160;    <a class="code" href="classVectorizedArray.html">VectorizedArray</a> res;</div><div class="line"><a name="l04315"></a><span class="lineno"> 4315</span>&#160;    res.<a class="code" href="classVectorizedArray.html#ad38190d02537705964e021da7ecbab3f">data</a> = vec_sqrt(data);</div><div class="line"><a name="l04316"></a><span class="lineno"> 4316</span>&#160;    <span class="keywordflow">return</span> res;</div><div class="line"><a name="l04317"></a><span class="lineno"> 4317</span>&#160;  }</div><div class="line"><a name="l04318"></a><span class="lineno"> 4318</span>&#160;</div><div class="line"><a name="l04323"></a><span class="lineno"> 4323</span>&#160;  <a class="code" href="config_8h.html#a1d1d58e8be15e5c4285f6892e5f33136">DEAL_II_ALWAYS_INLINE</a></div><div class="line"><a name="l04324"></a><span class="lineno"> 4324</span>&#160;  <a class="code" href="classVectorizedArray.html">VectorizedArray</a></div><div class="line"><a name="l04325"></a><span class="lineno"> 4325</span>&#160;  get_abs()<span class="keyword"> const</span></div><div class="line"><a name="l04326"></a><span class="lineno"> 4326</span>&#160;<span class="keyword">  </span>{</div><div class="line"><a name="l04327"></a><span class="lineno"> 4327</span>&#160;    <a class="code" href="classVectorizedArray.html">VectorizedArray</a> res;</div><div class="line"><a name="l04328"></a><span class="lineno"> 4328</span>&#160;    res.<a class="code" href="classVectorizedArray.html#ad38190d02537705964e021da7ecbab3f">data</a> = vec_abs(data);</div><div class="line"><a name="l04329"></a><span class="lineno"> 4329</span>&#160;    <span class="keywordflow">return</span> res;</div><div class="line"><a name="l04330"></a><span class="lineno"> 4330</span>&#160;  }</div><div class="line"><a name="l04331"></a><span class="lineno"> 4331</span>&#160;</div><div class="line"><a name="l04336"></a><span class="lineno"> 4336</span>&#160;  <a class="code" href="config_8h.html#a1d1d58e8be15e5c4285f6892e5f33136">DEAL_II_ALWAYS_INLINE</a></div><div class="line"><a name="l04337"></a><span class="lineno"> 4337</span>&#160;  <a class="code" href="classVectorizedArray.html">VectorizedArray</a></div><div class="line"><a name="l04338"></a><span class="lineno"> 4338</span>&#160;  get_max(<span class="keyword">const</span> <a class="code" href="classVectorizedArray.html">VectorizedArray</a> &amp;other)<span class="keyword"> const</span></div><div class="line"><a name="l04339"></a><span class="lineno"> 4339</span>&#160;<span class="keyword">  </span>{</div><div class="line"><a name="l04340"></a><span class="lineno"> 4340</span>&#160;    <a class="code" href="classVectorizedArray.html">VectorizedArray</a> res;</div><div class="line"><a name="l04341"></a><span class="lineno"> 4341</span>&#160;    res.<a class="code" href="classVectorizedArray.html#ad38190d02537705964e021da7ecbab3f">data</a> = vec_max(data, other.<a class="code" href="classVectorizedArray.html#ad38190d02537705964e021da7ecbab3f">data</a>);</div><div class="line"><a name="l04342"></a><span class="lineno"> 4342</span>&#160;    <span class="keywordflow">return</span> res;</div><div class="line"><a name="l04343"></a><span class="lineno"> 4343</span>&#160;  }</div><div class="line"><a name="l04344"></a><span class="lineno"> 4344</span>&#160;</div><div class="line"><a name="l04349"></a><span class="lineno"> 4349</span>&#160;  <a class="code" href="config_8h.html#a1d1d58e8be15e5c4285f6892e5f33136">DEAL_II_ALWAYS_INLINE</a></div><div class="line"><a name="l04350"></a><span class="lineno"> 4350</span>&#160;  <a class="code" href="classVectorizedArray.html">VectorizedArray</a></div><div class="line"><a name="l04351"></a><span class="lineno"> 4351</span>&#160;  get_min(<span class="keyword">const</span> <a class="code" href="classVectorizedArray.html">VectorizedArray</a> &amp;other)<span class="keyword"> const</span></div><div class="line"><a name="l04352"></a><span class="lineno"> 4352</span>&#160;<span class="keyword">  </span>{</div><div class="line"><a name="l04353"></a><span class="lineno"> 4353</span>&#160;    <a class="code" href="classVectorizedArray.html">VectorizedArray</a> res;</div><div class="line"><a name="l04354"></a><span class="lineno"> 4354</span>&#160;    res.<a class="code" href="classVectorizedArray.html#ad38190d02537705964e021da7ecbab3f">data</a> = vec_min(data, other.<a class="code" href="classVectorizedArray.html#ad38190d02537705964e021da7ecbab3f">data</a>);</div><div class="line"><a name="l04355"></a><span class="lineno"> 4355</span>&#160;    <span class="keywordflow">return</span> res;</div><div class="line"><a name="l04356"></a><span class="lineno"> 4356</span>&#160;  }</div><div class="line"><a name="l04357"></a><span class="lineno"> 4357</span>&#160;</div><div class="line"><a name="l04358"></a><span class="lineno"> 4358</span>&#160;  <span class="comment">// Make a few functions friends.</span></div><div class="line"><a name="l04359"></a><span class="lineno"> 4359</span>&#160;  <span class="keyword">template</span> &lt;<span class="keyword">typename</span> Number2, std::<span class="keywordtype">size_t</span> w<span class="keywordtype">id</span>th2&gt;</div><div class="line"><a name="l04360"></a><span class="lineno"> 4360</span>&#160;  <span class="keyword">friend</span> <a class="code" href="classVectorizedArray.html">VectorizedArray&lt;Number2, width2&gt;</a></div><div class="line"><a name="l04361"></a><span class="lineno"> 4361</span>&#160;  std::sqrt(<span class="keyword">const</span> <a class="code" href="classVectorizedArray.html">VectorizedArray&lt;Number2, width2&gt;</a> &amp;);</div><div class="line"><a name="l04362"></a><span class="lineno"> 4362</span>&#160;  <span class="keyword">template</span> &lt;<span class="keyword">typename</span> Number2, std::<span class="keywordtype">size_t</span> w<span class="keywordtype">id</span>th2&gt;</div><div class="line"><a name="l04363"></a><span class="lineno"> 4363</span>&#160;  <span class="keyword">friend</span> <a class="code" href="classVectorizedArray.html">VectorizedArray&lt;Number2, width2&gt;</a></div><div class="line"><a name="l04364"></a><span class="lineno"> 4364</span>&#160;  std::abs(<span class="keyword">const</span> <a class="code" href="classVectorizedArray.html">VectorizedArray&lt;Number2, width2&gt;</a> &amp;);</div><div class="line"><a name="l04365"></a><span class="lineno"> 4365</span>&#160;  <span class="keyword">template</span> &lt;<span class="keyword">typename</span> Number2, std::<span class="keywordtype">size_t</span> w<span class="keywordtype">id</span>th2&gt;</div><div class="line"><a name="l04366"></a><span class="lineno"> 4366</span>&#160;  <span class="keyword">friend</span> <a class="code" href="classVectorizedArray.html">VectorizedArray&lt;Number2, width2&gt;</a></div><div class="line"><a name="l04367"></a><span class="lineno"> 4367</span>&#160;  std::max(<span class="keyword">const</span> <a class="code" href="classVectorizedArray.html">VectorizedArray&lt;Number2, width2&gt;</a> &amp;,</div><div class="line"><a name="l04368"></a><span class="lineno"> 4368</span>&#160;           <span class="keyword">const</span> <a class="code" href="classVectorizedArray.html">VectorizedArray&lt;Number2, width2&gt;</a> &amp;);</div><div class="line"><a name="l04369"></a><span class="lineno"> 4369</span>&#160;  <span class="keyword">template</span> &lt;<span class="keyword">typename</span> Number2, std::<span class="keywordtype">size_t</span> w<span class="keywordtype">id</span>th2&gt;</div><div class="line"><a name="l04370"></a><span class="lineno"> 4370</span>&#160;  <span class="keyword">friend</span> <a class="code" href="classVectorizedArray.html">VectorizedArray&lt;Number2, width2&gt;</a></div><div class="line"><a name="l04371"></a><span class="lineno"> 4371</span>&#160;  std::min(<span class="keyword">const</span> <a class="code" href="classVectorizedArray.html">VectorizedArray&lt;Number2, width2&gt;</a> &amp;,</div><div class="line"><a name="l04372"></a><span class="lineno"> 4372</span>&#160;           <span class="keyword">const</span> <a class="code" href="classVectorizedArray.html">VectorizedArray&lt;Number2, width2&gt;</a> &amp;);</div><div class="line"><a name="l04373"></a><span class="lineno"> 4373</span>&#160;};</div><div class="line"><a name="l04374"></a><span class="lineno"> 4374</span>&#160;</div><div class="line"><a name="l04375"></a><span class="lineno"> 4375</span>&#160;</div><div class="line"><a name="l04376"></a><span class="lineno"> 4376</span>&#160;</div><div class="line"><a name="l04377"></a><span class="lineno"> 4377</span>&#160;<span class="keyword">template</span> &lt;&gt;</div><div class="line"><a name="l04378"></a><span class="lineno"> 4378</span>&#160;<span class="keyword">class </span><a class="code" href="classVectorizedArray.html">VectorizedArray</a>&lt;float, 4&gt;</div><div class="line"><a name="l04379"></a><span class="lineno"> 4379</span>&#160;  : <span class="keyword">public</span> <a class="code" href="classVectorizedArrayBase.html">VectorizedArrayBase</a>&lt;VectorizedArray&lt;float, 4&gt;, 4&gt;</div><div class="line"><a name="l04380"></a><span class="lineno"> 4380</span>&#160;{</div><div class="line"><a name="l04381"></a><span class="lineno"> 4381</span>&#160;<span class="keyword">public</span>:</div><div class="line"><a name="l04386"></a><span class="lineno"> 4386</span>&#160;  <span class="keyword">using</span> value_type = float;</div><div class="line"><a name="l04387"></a><span class="lineno"> 4387</span>&#160;</div><div class="line"><a name="l04392"></a><span class="lineno"> 4392</span>&#160;  <a class="code" href="classVectorizedArray.html">VectorizedArray</a>() = <span class="keywordflow">default</span>;</div><div class="line"><a name="l04393"></a><span class="lineno"> 4393</span>&#160;</div><div class="line"><a name="l04398"></a><span class="lineno"> 4398</span>&#160;  <a class="code" href="classVectorizedArray.html">VectorizedArray</a>(<span class="keyword">const</span> <span class="keywordtype">float</span> scalar)</div><div class="line"><a name="l04399"></a><span class="lineno"> 4399</span>&#160;  {</div><div class="line"><a name="l04400"></a><span class="lineno"> 4400</span>&#160;    this-&gt;operator=(scalar);</div><div class="line"><a name="l04401"></a><span class="lineno"> 4401</span>&#160;  }</div><div class="line"><a name="l04402"></a><span class="lineno"> 4402</span>&#160;</div><div class="line"><a name="l04407"></a><span class="lineno"> 4407</span>&#160;  <a class="code" href="config_8h.html#a1d1d58e8be15e5c4285f6892e5f33136">DEAL_II_ALWAYS_INLINE</a></div><div class="line"><a name="l04408"></a><span class="lineno"> 4408</span>&#160;  <a class="code" href="classVectorizedArray.html">VectorizedArray</a> &amp;</div><div class="line"><a name="l04409"></a><span class="lineno"> 4409</span>&#160;  operator=(<span class="keyword">const</span> <span class="keywordtype">float</span> x)</div><div class="line"><a name="l04410"></a><span class="lineno"> 4410</span>&#160;  {</div><div class="line"><a name="l04411"></a><span class="lineno"> 4411</span>&#160;    data = vec_splats(x);</div><div class="line"><a name="l04412"></a><span class="lineno"> 4412</span>&#160;</div><div class="line"><a name="l04413"></a><span class="lineno"> 4413</span>&#160;    <span class="comment">// Some compilers believe that vec_splats sets &#39;x&#39;, but that&#39;s not true.</span></div><div class="line"><a name="l04414"></a><span class="lineno"> 4414</span>&#160;    <span class="comment">// They then warn about setting a variable and not using it. Suppress the</span></div><div class="line"><a name="l04415"></a><span class="lineno"> 4415</span>&#160;    <span class="comment">// warning by &quot;using&quot; the variable:</span></div><div class="line"><a name="l04416"></a><span class="lineno"> 4416</span>&#160;    (void)x;</div><div class="line"><a name="l04417"></a><span class="lineno"> 4417</span>&#160;    <span class="keywordflow">return</span> *<span class="keyword">this</span>;</div><div class="line"><a name="l04418"></a><span class="lineno"> 4418</span>&#160;  }</div><div class="line"><a name="l04419"></a><span class="lineno"> 4419</span>&#160;</div><div class="line"><a name="l04424"></a><span class="lineno"> 4424</span>&#160;  <a class="code" href="config_8h.html#a1d1d58e8be15e5c4285f6892e5f33136">DEAL_II_ALWAYS_INLINE</a></div><div class="line"><a name="l04425"></a><span class="lineno"> 4425</span>&#160;  <span class="keywordtype">float</span> &amp;operator[](<span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> comp)</div><div class="line"><a name="l04426"></a><span class="lineno"> 4426</span>&#160;  {</div><div class="line"><a name="l04427"></a><span class="lineno"> 4427</span>&#160;    <a class="code" href="group__Exceptions.html#gaafbb69cc2a791ae55880fd8d57d0c1b0">AssertIndexRange</a>(comp, 4);</div><div class="line"><a name="l04428"></a><span class="lineno"> 4428</span>&#160;    <span class="keywordflow">return</span> *(<span class="keyword">reinterpret_cast&lt;</span><span class="keywordtype">float</span> *<span class="keyword">&gt;</span>(&amp;data) + comp);</div><div class="line"><a name="l04429"></a><span class="lineno"> 4429</span>&#160;  }</div><div class="line"><a name="l04430"></a><span class="lineno"> 4430</span>&#160;</div><div class="line"><a name="l04435"></a><span class="lineno"> 4435</span>&#160;  <a class="code" href="config_8h.html#a1d1d58e8be15e5c4285f6892e5f33136">DEAL_II_ALWAYS_INLINE</a></div><div class="line"><a name="l04436"></a><span class="lineno"> 4436</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">float</span> &amp;operator[](<span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> comp)<span class="keyword"> const</span></div><div class="line"><a name="l04437"></a><span class="lineno"> 4437</span>&#160;<span class="keyword">  </span>{</div><div class="line"><a name="l04438"></a><span class="lineno"> 4438</span>&#160;    <a class="code" href="group__Exceptions.html#gaafbb69cc2a791ae55880fd8d57d0c1b0">AssertIndexRange</a>(comp, 4);</div><div class="line"><a name="l04439"></a><span class="lineno"> 4439</span>&#160;    <span class="keywordflow">return</span> *(<span class="keyword">reinterpret_cast&lt;</span><span class="keyword">const </span><span class="keywordtype">float</span> *<span class="keyword">&gt;</span>(&amp;data) + comp);</div><div class="line"><a name="l04440"></a><span class="lineno"> 4440</span>&#160;  }</div><div class="line"><a name="l04441"></a><span class="lineno"> 4441</span>&#160;</div><div class="line"><a name="l04446"></a><span class="lineno"> 4446</span>&#160;  <a class="code" href="config_8h.html#a1d1d58e8be15e5c4285f6892e5f33136">DEAL_II_ALWAYS_INLINE</a></div><div class="line"><a name="l04447"></a><span class="lineno"> 4447</span>&#160;  <a class="code" href="classVectorizedArray.html">VectorizedArray</a> &amp;</div><div class="line"><a name="l04448"></a><span class="lineno"> 4448</span>&#160;  operator+=(<span class="keyword">const</span> <a class="code" href="classVectorizedArray.html">VectorizedArray</a> &amp;vec)</div><div class="line"><a name="l04449"></a><span class="lineno"> 4449</span>&#160;  {</div><div class="line"><a name="l04450"></a><span class="lineno"> 4450</span>&#160;    data = <a class="code" href="group__CUDAWrappers.html#ga509717d30efa99a22a7730b16b17b3ab">vec_add</a>(data, vec.<a class="code" href="classVectorizedArray.html#ad38190d02537705964e021da7ecbab3f">data</a>);</div><div class="line"><a name="l04451"></a><span class="lineno"> 4451</span>&#160;    <span class="keywordflow">return</span> *<span class="keyword">this</span>;</div><div class="line"><a name="l04452"></a><span class="lineno"> 4452</span>&#160;  }</div><div class="line"><a name="l04453"></a><span class="lineno"> 4453</span>&#160;</div><div class="line"><a name="l04458"></a><span class="lineno"> 4458</span>&#160;  <a class="code" href="config_8h.html#a1d1d58e8be15e5c4285f6892e5f33136">DEAL_II_ALWAYS_INLINE</a></div><div class="line"><a name="l04459"></a><span class="lineno"> 4459</span>&#160;  <a class="code" href="classVectorizedArray.html">VectorizedArray</a> &amp;</div><div class="line"><a name="l04460"></a><span class="lineno"> 4460</span>&#160;  operator-=(<span class="keyword">const</span> <a class="code" href="classVectorizedArray.html">VectorizedArray</a> &amp;vec)</div><div class="line"><a name="l04461"></a><span class="lineno"> 4461</span>&#160;  {</div><div class="line"><a name="l04462"></a><span class="lineno"> 4462</span>&#160;    data = vec_sub(data, vec.<a class="code" href="classVectorizedArray.html#ad38190d02537705964e021da7ecbab3f">data</a>);</div><div class="line"><a name="l04463"></a><span class="lineno"> 4463</span>&#160;    <span class="keywordflow">return</span> *<span class="keyword">this</span>;</div><div class="line"><a name="l04464"></a><span class="lineno"> 4464</span>&#160;  }</div><div class="line"><a name="l04465"></a><span class="lineno"> 4465</span>&#160;</div><div class="line"><a name="l04470"></a><span class="lineno"> 4470</span>&#160;  <a class="code" href="config_8h.html#a1d1d58e8be15e5c4285f6892e5f33136">DEAL_II_ALWAYS_INLINE</a></div><div class="line"><a name="l04471"></a><span class="lineno"> 4471</span>&#160;  <a class="code" href="classVectorizedArray.html">VectorizedArray</a> &amp;</div><div class="line"><a name="l04472"></a><span class="lineno"> 4472</span>&#160;  operator*=(<span class="keyword">const</span> <a class="code" href="classVectorizedArray.html">VectorizedArray</a> &amp;vec)</div><div class="line"><a name="l04473"></a><span class="lineno"> 4473</span>&#160;  {</div><div class="line"><a name="l04474"></a><span class="lineno"> 4474</span>&#160;    data = vec_mul(data, vec.<a class="code" href="classVectorizedArray.html#ad38190d02537705964e021da7ecbab3f">data</a>);</div><div class="line"><a name="l04475"></a><span class="lineno"> 4475</span>&#160;    <span class="keywordflow">return</span> *<span class="keyword">this</span>;</div><div class="line"><a name="l04476"></a><span class="lineno"> 4476</span>&#160;  }</div><div class="line"><a name="l04477"></a><span class="lineno"> 4477</span>&#160;</div><div class="line"><a name="l04482"></a><span class="lineno"> 4482</span>&#160;  <a class="code" href="config_8h.html#a1d1d58e8be15e5c4285f6892e5f33136">DEAL_II_ALWAYS_INLINE</a></div><div class="line"><a name="l04483"></a><span class="lineno"> 4483</span>&#160;  <a class="code" href="classVectorizedArray.html">VectorizedArray</a> &amp;</div><div class="line"><a name="l04484"></a><span class="lineno"> 4484</span>&#160;  operator/=(<span class="keyword">const</span> <a class="code" href="classVectorizedArray.html">VectorizedArray</a> &amp;vec)</div><div class="line"><a name="l04485"></a><span class="lineno"> 4485</span>&#160;  {</div><div class="line"><a name="l04486"></a><span class="lineno"> 4486</span>&#160;    data = vec_div(data, vec.<a class="code" href="classVectorizedArray.html#ad38190d02537705964e021da7ecbab3f">data</a>);</div><div class="line"><a name="l04487"></a><span class="lineno"> 4487</span>&#160;    <span class="keywordflow">return</span> *<span class="keyword">this</span>;</div><div class="line"><a name="l04488"></a><span class="lineno"> 4488</span>&#160;  }</div><div class="line"><a name="l04489"></a><span class="lineno"> 4489</span>&#160;</div><div class="line"><a name="l04495"></a><span class="lineno"> 4495</span>&#160;  <a class="code" href="config_8h.html#a1d1d58e8be15e5c4285f6892e5f33136">DEAL_II_ALWAYS_INLINE</a></div><div class="line"><a name="l04496"></a><span class="lineno"> 4496</span>&#160;  <span class="keywordtype">void</span></div><div class="line"><a name="l04497"></a><span class="lineno"> 4497</span>&#160;  load(<span class="keyword">const</span> <span class="keywordtype">float</span> *ptr)</div><div class="line"><a name="l04498"></a><span class="lineno"> 4498</span>&#160;  {</div><div class="line"><a name="l04499"></a><span class="lineno"> 4499</span>&#160;    data = vec_vsx_ld(0, ptr);</div><div class="line"><a name="l04500"></a><span class="lineno"> 4500</span>&#160;  }</div><div class="line"><a name="l04501"></a><span class="lineno"> 4501</span>&#160;</div><div class="line"><a name="l04507"></a><span class="lineno"> 4507</span>&#160;  <a class="code" href="config_8h.html#a1d1d58e8be15e5c4285f6892e5f33136">DEAL_II_ALWAYS_INLINE</a></div><div class="line"><a name="l04508"></a><span class="lineno"> 4508</span>&#160;  <span class="keywordtype">void</span></div><div class="line"><a name="l04509"></a><span class="lineno"> 4509</span>&#160;  store(<span class="keywordtype">float</span> *ptr)<span class="keyword"> const</span></div><div class="line"><a name="l04510"></a><span class="lineno"> 4510</span>&#160;<span class="keyword">  </span>{</div><div class="line"><a name="l04511"></a><span class="lineno"> 4511</span>&#160;    vec_vsx_st(data, 0, ptr);</div><div class="line"><a name="l04512"></a><span class="lineno"> 4512</span>&#160;  }</div><div class="line"><a name="l04513"></a><span class="lineno"> 4513</span>&#160;</div><div class="line"><a name="l04517"></a><span class="lineno"> 4517</span>&#160;  <a class="code" href="config_8h.html#a1d1d58e8be15e5c4285f6892e5f33136">DEAL_II_ALWAYS_INLINE</a></div><div class="line"><a name="l04518"></a><span class="lineno"> 4518</span>&#160;  <span class="keywordtype">void</span></div><div class="line"><a name="l04519"></a><span class="lineno"> 4519</span>&#160;  streaming_store(<span class="keywordtype">float</span> *ptr)<span class="keyword"> const</span></div><div class="line"><a name="l04520"></a><span class="lineno"> 4520</span>&#160;<span class="keyword">  </span>{</div><div class="line"><a name="l04521"></a><span class="lineno"> 4521</span>&#160;    store(ptr);</div><div class="line"><a name="l04522"></a><span class="lineno"> 4522</span>&#160;  }</div><div class="line"><a name="l04523"></a><span class="lineno"> 4523</span>&#160;</div><div class="line"><a name="l04527"></a><span class="lineno"> 4527</span>&#160;  <a class="code" href="config_8h.html#a1d1d58e8be15e5c4285f6892e5f33136">DEAL_II_ALWAYS_INLINE</a></div><div class="line"><a name="l04528"></a><span class="lineno"> 4528</span>&#160;  <span class="keywordtype">void</span></div><div class="line"><a name="l04529"></a><span class="lineno"> 4529</span>&#160;  <a class="code" href="vectorization_8h.html#a078ca5de8d3a59aedc130823be15ad26">gather</a>(<span class="keyword">const</span> <span class="keywordtype">float</span> *base_ptr, <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> *offsets)</div><div class="line"><a name="l04530"></a><span class="lineno"> 4530</span>&#160;  {</div><div class="line"><a name="l04531"></a><span class="lineno"> 4531</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i = 0; i &lt; 4; ++i)</div><div class="line"><a name="l04532"></a><span class="lineno"> 4532</span>&#160;      *(reinterpret_cast&lt;float *&gt;(&amp;data) + i) = base_ptr[offsets[i]];</div><div class="line"><a name="l04533"></a><span class="lineno"> 4533</span>&#160;  }</div><div class="line"><a name="l04534"></a><span class="lineno"> 4534</span>&#160;</div><div class="line"><a name="l04538"></a><span class="lineno"> 4538</span>&#160;  <a class="code" href="config_8h.html#a1d1d58e8be15e5c4285f6892e5f33136">DEAL_II_ALWAYS_INLINE</a></div><div class="line"><a name="l04539"></a><span class="lineno"> 4539</span>&#160;  <span class="keywordtype">void</span></div><div class="line"><a name="l04540"></a><span class="lineno"> 4540</span>&#160;  scatter(<span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> *offsets, <span class="keywordtype">float</span> *base_ptr)<span class="keyword"> const</span></div><div class="line"><a name="l04541"></a><span class="lineno"> 4541</span>&#160;<span class="keyword">  </span>{</div><div class="line"><a name="l04542"></a><span class="lineno"> 4542</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i = 0; i &lt; 4; ++i)</div><div class="line"><a name="l04543"></a><span class="lineno"> 4543</span>&#160;      base_ptr[offsets[i]] = *(reinterpret_cast&lt;const float *&gt;(&amp;data) + i);</div><div class="line"><a name="l04544"></a><span class="lineno"> 4544</span>&#160;  }</div><div class="line"><a name="l04545"></a><span class="lineno"> 4545</span>&#160;</div><div class="line"><a name="l04550"></a><span class="lineno"> 4550</span>&#160;  __vector <span class="keywordtype">float</span> data;</div><div class="line"><a name="l04551"></a><span class="lineno"> 4551</span>&#160;</div><div class="line"><a name="l04552"></a><span class="lineno"> 4552</span>&#160;<span class="keyword">private</span>:</div><div class="line"><a name="l04557"></a><span class="lineno"> 4557</span>&#160;  <a class="code" href="config_8h.html#a1d1d58e8be15e5c4285f6892e5f33136">DEAL_II_ALWAYS_INLINE</a></div><div class="line"><a name="l04558"></a><span class="lineno"> 4558</span>&#160;  <a class="code" href="classVectorizedArray.html">VectorizedArray</a></div><div class="line"><a name="l04559"></a><span class="lineno"> 4559</span>&#160;  get_sqrt()<span class="keyword"> const</span></div><div class="line"><a name="l04560"></a><span class="lineno"> 4560</span>&#160;<span class="keyword">  </span>{</div><div class="line"><a name="l04561"></a><span class="lineno"> 4561</span>&#160;    <a class="code" href="classVectorizedArray.html">VectorizedArray</a> res;</div><div class="line"><a name="l04562"></a><span class="lineno"> 4562</span>&#160;    res.<a class="code" href="classVectorizedArray.html#ad38190d02537705964e021da7ecbab3f">data</a> = vec_sqrt(data);</div><div class="line"><a name="l04563"></a><span class="lineno"> 4563</span>&#160;    <span class="keywordflow">return</span> res;</div><div class="line"><a name="l04564"></a><span class="lineno"> 4564</span>&#160;  }</div><div class="line"><a name="l04565"></a><span class="lineno"> 4565</span>&#160;</div><div class="line"><a name="l04570"></a><span class="lineno"> 4570</span>&#160;  <a class="code" href="config_8h.html#a1d1d58e8be15e5c4285f6892e5f33136">DEAL_II_ALWAYS_INLINE</a></div><div class="line"><a name="l04571"></a><span class="lineno"> 4571</span>&#160;  <a class="code" href="classVectorizedArray.html">VectorizedArray</a></div><div class="line"><a name="l04572"></a><span class="lineno"> 4572</span>&#160;  get_abs()<span class="keyword"> const</span></div><div class="line"><a name="l04573"></a><span class="lineno"> 4573</span>&#160;<span class="keyword">  </span>{</div><div class="line"><a name="l04574"></a><span class="lineno"> 4574</span>&#160;    <a class="code" href="classVectorizedArray.html">VectorizedArray</a> res;</div><div class="line"><a name="l04575"></a><span class="lineno"> 4575</span>&#160;    res.<a class="code" href="classVectorizedArray.html#ad38190d02537705964e021da7ecbab3f">data</a> = vec_abs(data);</div><div class="line"><a name="l04576"></a><span class="lineno"> 4576</span>&#160;    <span class="keywordflow">return</span> res;</div><div class="line"><a name="l04577"></a><span class="lineno"> 4577</span>&#160;  }</div><div class="line"><a name="l04578"></a><span class="lineno"> 4578</span>&#160;</div><div class="line"><a name="l04583"></a><span class="lineno"> 4583</span>&#160;  <a class="code" href="config_8h.html#a1d1d58e8be15e5c4285f6892e5f33136">DEAL_II_ALWAYS_INLINE</a></div><div class="line"><a name="l04584"></a><span class="lineno"> 4584</span>&#160;  <a class="code" href="classVectorizedArray.html">VectorizedArray</a></div><div class="line"><a name="l04585"></a><span class="lineno"> 4585</span>&#160;  get_max(<span class="keyword">const</span> <a class="code" href="classVectorizedArray.html">VectorizedArray</a> &amp;other)<span class="keyword"> const</span></div><div class="line"><a name="l04586"></a><span class="lineno"> 4586</span>&#160;<span class="keyword">  </span>{</div><div class="line"><a name="l04587"></a><span class="lineno"> 4587</span>&#160;    <a class="code" href="classVectorizedArray.html">VectorizedArray</a> res;</div><div class="line"><a name="l04588"></a><span class="lineno"> 4588</span>&#160;    res.<a class="code" href="classVectorizedArray.html#ad38190d02537705964e021da7ecbab3f">data</a> = vec_max(data, other.<a class="code" href="classVectorizedArray.html#ad38190d02537705964e021da7ecbab3f">data</a>);</div><div class="line"><a name="l04589"></a><span class="lineno"> 4589</span>&#160;    <span class="keywordflow">return</span> res;</div><div class="line"><a name="l04590"></a><span class="lineno"> 4590</span>&#160;  }</div><div class="line"><a name="l04591"></a><span class="lineno"> 4591</span>&#160;</div><div class="line"><a name="l04596"></a><span class="lineno"> 4596</span>&#160;  <a class="code" href="config_8h.html#a1d1d58e8be15e5c4285f6892e5f33136">DEAL_II_ALWAYS_INLINE</a></div><div class="line"><a name="l04597"></a><span class="lineno"> 4597</span>&#160;  <a class="code" href="classVectorizedArray.html">VectorizedArray</a></div><div class="line"><a name="l04598"></a><span class="lineno"> 4598</span>&#160;  get_min(<span class="keyword">const</span> <a class="code" href="classVectorizedArray.html">VectorizedArray</a> &amp;other)<span class="keyword"> const</span></div><div class="line"><a name="l04599"></a><span class="lineno"> 4599</span>&#160;<span class="keyword">  </span>{</div><div class="line"><a name="l04600"></a><span class="lineno"> 4600</span>&#160;    <a class="code" href="classVectorizedArray.html">VectorizedArray</a> res;</div><div class="line"><a name="l04601"></a><span class="lineno"> 4601</span>&#160;    res.<a class="code" href="classVectorizedArray.html#ad38190d02537705964e021da7ecbab3f">data</a> = vec_min(data, other.<a class="code" href="classVectorizedArray.html#ad38190d02537705964e021da7ecbab3f">data</a>);</div><div class="line"><a name="l04602"></a><span class="lineno"> 4602</span>&#160;    <span class="keywordflow">return</span> res;</div><div class="line"><a name="l04603"></a><span class="lineno"> 4603</span>&#160;  }</div><div class="line"><a name="l04604"></a><span class="lineno"> 4604</span>&#160;</div><div class="line"><a name="l04605"></a><span class="lineno"> 4605</span>&#160;  <span class="comment">// Make a few functions friends.</span></div><div class="line"><a name="l04606"></a><span class="lineno"> 4606</span>&#160;  <span class="keyword">template</span> &lt;<span class="keyword">typename</span> Number2, std::<span class="keywordtype">size_t</span> w<span class="keywordtype">id</span>th2&gt;</div><div class="line"><a name="l04607"></a><span class="lineno"> 4607</span>&#160;  <span class="keyword">friend</span> <a class="code" href="classVectorizedArray.html">VectorizedArray&lt;Number2, width2&gt;</a></div><div class="line"><a name="l04608"></a><span class="lineno"> 4608</span>&#160;  std::sqrt(<span class="keyword">const</span> <a class="code" href="classVectorizedArray.html">VectorizedArray&lt;Number2, width2&gt;</a> &amp;);</div><div class="line"><a name="l04609"></a><span class="lineno"> 4609</span>&#160;  <span class="keyword">template</span> &lt;<span class="keyword">typename</span> Number2, std::<span class="keywordtype">size_t</span> w<span class="keywordtype">id</span>th2&gt;</div><div class="line"><a name="l04610"></a><span class="lineno"> 4610</span>&#160;  <span class="keyword">friend</span> <a class="code" href="classVectorizedArray.html">VectorizedArray&lt;Number2, width2&gt;</a></div><div class="line"><a name="l04611"></a><span class="lineno"> 4611</span>&#160;  std::abs(<span class="keyword">const</span> <a class="code" href="classVectorizedArray.html">VectorizedArray&lt;Number2, width2&gt;</a> &amp;);</div><div class="line"><a name="l04612"></a><span class="lineno"> 4612</span>&#160;  <span class="keyword">template</span> &lt;<span class="keyword">typename</span> Number2, std::<span class="keywordtype">size_t</span> w<span class="keywordtype">id</span>th2&gt;</div><div class="line"><a name="l04613"></a><span class="lineno"> 4613</span>&#160;  <span class="keyword">friend</span> <a class="code" href="classVectorizedArray.html">VectorizedArray&lt;Number2, width2&gt;</a></div><div class="line"><a name="l04614"></a><span class="lineno"> 4614</span>&#160;  std::max(<span class="keyword">const</span> <a class="code" href="classVectorizedArray.html">VectorizedArray&lt;Number2, width2&gt;</a> &amp;,</div><div class="line"><a name="l04615"></a><span class="lineno"> 4615</span>&#160;           <span class="keyword">const</span> <a class="code" href="classVectorizedArray.html">VectorizedArray&lt;Number2, width2&gt;</a> &amp;);</div><div class="line"><a name="l04616"></a><span class="lineno"> 4616</span>&#160;  <span class="keyword">template</span> &lt;<span class="keyword">typename</span> Number2, std::<span class="keywordtype">size_t</span> w<span class="keywordtype">id</span>th2&gt;</div><div class="line"><a name="l04617"></a><span class="lineno"> 4617</span>&#160;  <span class="keyword">friend</span> <a class="code" href="classVectorizedArray.html">VectorizedArray&lt;Number2, width2&gt;</a></div><div class="line"><a name="l04618"></a><span class="lineno"> 4618</span>&#160;  std::min(<span class="keyword">const</span> <a class="code" href="classVectorizedArray.html">VectorizedArray&lt;Number2, width2&gt;</a> &amp;,</div><div class="line"><a name="l04619"></a><span class="lineno"> 4619</span>&#160;           <span class="keyword">const</span> <a class="code" href="classVectorizedArray.html">VectorizedArray&lt;Number2, width2&gt;</a> &amp;);</div><div class="line"><a name="l04620"></a><span class="lineno"> 4620</span>&#160;};</div><div class="line"><a name="l04621"></a><span class="lineno"> 4621</span>&#160;</div><div class="line"><a name="l04622"></a><span class="lineno"> 4622</span>&#160;<span class="preprocessor">#  endif // if DEAL_II_VECTORIZATION_LEVEL &gt;=1 &amp;&amp; defined(__ALTIVEC__) &amp;&amp;</span></div><div class="line"><a name="l04623"></a><span class="lineno"> 4623</span>&#160;         <span class="comment">// defined(__VSX__)</span></div><div class="line"><a name="l04624"></a><span class="lineno"> 4624</span>&#160;</div><div class="line"><a name="l04625"></a><span class="lineno"> 4625</span>&#160;</div><div class="line"><a name="l04626"></a><span class="lineno"> 4626</span>&#160;<span class="preprocessor">#endif // DOXYGEN</span></div><div class="line"><a name="l04627"></a><span class="lineno"> 4627</span>&#160;</div><div class="line"><a name="l04634"></a><span class="lineno"> 4634</span>&#160;</div><div class="line"><a name="l04642"></a><span class="lineno"> 4642</span>&#160;<span class="keyword">template</span> &lt;<span class="keyword">typename</span> Number, std::<span class="keywordtype">size_t</span> w<span class="keywordtype">id</span>th&gt;</div><div class="line"><a name="l04643"></a><span class="lineno"> 4643</span>&#160;<span class="keyword">inline</span> <a class="code" href="config_8h.html#a1d1d58e8be15e5c4285f6892e5f33136">DEAL_II_ALWAYS_INLINE</a> <span class="keywordtype">bool</span></div><div class="line"><a name="l04644"></a><span class="lineno"><a class="line" href="vectorization_8h.html#a60e4e5dd338cf4353bbdccc117fa883d"> 4644</a></span>&#160;<a class="code" href="vectorization_8h.html#a60e4e5dd338cf4353bbdccc117fa883d">operator==</a>(<span class="keyword">const</span> <a class="code" href="classVectorizedArray.html">VectorizedArray&lt;Number, width&gt;</a> &amp;lhs,</div><div class="line"><a name="l04645"></a><span class="lineno"> 4645</span>&#160;           <span class="keyword">const</span> <a class="code" href="classVectorizedArray.html">VectorizedArray&lt;Number, width&gt;</a> &amp;rhs)</div><div class="line"><a name="l04646"></a><span class="lineno"> 4646</span>&#160;{</div><div class="line"><a name="l04647"></a><span class="lineno"> 4647</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i = 0; i &lt; VectorizedArray&lt;Number, width&gt;::size(); ++i)</div><div class="line"><a name="l04648"></a><span class="lineno"> 4648</span>&#160;    <span class="keywordflow">if</span> (lhs[i] != rhs[i])</div><div class="line"><a name="l04649"></a><span class="lineno"> 4649</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">false</span>;</div><div class="line"><a name="l04650"></a><span class="lineno"> 4650</span>&#160;</div><div class="line"><a name="l04651"></a><span class="lineno"> 4651</span>&#160;  <span class="keywordflow">return</span> <span class="keyword">true</span>;</div><div class="line"><a name="l04652"></a><span class="lineno"> 4652</span>&#160;}</div><div class="line"><a name="l04653"></a><span class="lineno"> 4653</span>&#160;</div><div class="line"><a name="l04654"></a><span class="lineno"> 4654</span>&#160;</div><div class="line"><a name="l04661"></a><span class="lineno"> 4661</span>&#160;<span class="keyword">template</span> &lt;<span class="keyword">typename</span> Number, std::<span class="keywordtype">size_t</span> w<span class="keywordtype">id</span>th&gt;</div><div class="line"><a name="l04662"></a><span class="lineno"> 4662</span>&#160;<span class="keyword">inline</span> <a class="code" href="config_8h.html#a1d1d58e8be15e5c4285f6892e5f33136">DEAL_II_ALWAYS_INLINE</a> <a class="code" href="classVectorizedArray.html">VectorizedArray&lt;Number, width&gt;</a></div><div class="line"><a name="l04663"></a><span class="lineno"><a class="line" href="vectorization_8h.html#ad938a80e7098f4bf2193b14a14e73460"> 4663</a></span>&#160;                             <a class="code" href="vectorization_8h.html#ad938a80e7098f4bf2193b14a14e73460">operator+</a>(<span class="keyword">const</span> <a class="code" href="classVectorizedArray.html">VectorizedArray&lt;Number, width&gt;</a> &amp;u,</div><div class="line"><a name="l04664"></a><span class="lineno"> 4664</span>&#160;          <span class="keyword">const</span> <a class="code" href="classVectorizedArray.html">VectorizedArray&lt;Number, width&gt;</a> &amp;v)</div><div class="line"><a name="l04665"></a><span class="lineno"> 4665</span>&#160;{</div><div class="line"><a name="l04666"></a><span class="lineno"> 4666</span>&#160;  <a class="code" href="classVectorizedArray.html">VectorizedArray&lt;Number, width&gt;</a> tmp = u;</div><div class="line"><a name="l04667"></a><span class="lineno"> 4667</span>&#160;  <span class="keywordflow">return</span> tmp += v;</div><div class="line"><a name="l04668"></a><span class="lineno"> 4668</span>&#160;}</div><div class="line"><a name="l04669"></a><span class="lineno"> 4669</span>&#160;</div><div class="line"><a name="l04678"></a><span class="lineno"> 4678</span>&#160;<span class="keyword">template</span> &lt;<span class="keyword">typename</span> Number, std::<span class="keywordtype">size_t</span> w<span class="keywordtype">id</span>th&gt;</div><div class="line"><a name="l04679"></a><span class="lineno"> 4679</span>&#160;<span class="keyword">inline</span> <a class="code" href="config_8h.html#a1d1d58e8be15e5c4285f6892e5f33136">DEAL_II_ALWAYS_INLINE</a> <a class="code" href="classVectorizedArray.html">VectorizedArray&lt;Number, width&gt;</a></div><div class="line"><a name="l04680"></a><span class="lineno"><a class="line" href="vectorization_8h.html#a655230f65541b3787d1f71fa57a44072"> 4680</a></span>&#160;                             <a class="code" href="vectorization_8h.html#a655230f65541b3787d1f71fa57a44072">operator-</a>(<span class="keyword">const</span> <a class="code" href="classVectorizedArray.html">VectorizedArray&lt;Number, width&gt;</a> &amp;u,</div><div class="line"><a name="l04681"></a><span class="lineno"> 4681</span>&#160;          <span class="keyword">const</span> <a class="code" href="classVectorizedArray.html">VectorizedArray&lt;Number, width&gt;</a> &amp;v)</div><div class="line"><a name="l04682"></a><span class="lineno"> 4682</span>&#160;{</div><div class="line"><a name="l04683"></a><span class="lineno"> 4683</span>&#160;  <a class="code" href="classVectorizedArray.html">VectorizedArray&lt;Number, width&gt;</a> tmp = u;</div><div class="line"><a name="l04684"></a><span class="lineno"> 4684</span>&#160;  <span class="keywordflow">return</span> tmp -= v;</div><div class="line"><a name="l04685"></a><span class="lineno"> 4685</span>&#160;}</div><div class="line"><a name="l04686"></a><span class="lineno"> 4686</span>&#160;</div><div class="line"><a name="l04693"></a><span class="lineno"> 4693</span>&#160;<span class="keyword">template</span> &lt;<span class="keyword">typename</span> Number, std::<span class="keywordtype">size_t</span> w<span class="keywordtype">id</span>th&gt;</div><div class="line"><a name="l04694"></a><span class="lineno"> 4694</span>&#160;<span class="keyword">inline</span> <a class="code" href="config_8h.html#a1d1d58e8be15e5c4285f6892e5f33136">DEAL_II_ALWAYS_INLINE</a> <a class="code" href="classVectorizedArray.html">VectorizedArray&lt;Number, width&gt;</a></div><div class="line"><a name="l04695"></a><span class="lineno"><a class="line" href="vectorization_8h.html#ab848bd1da37f381f87cb5eaf51de6019"> 4695</a></span>&#160;                             <a class="code" href="structEnableIfScalar.html#af9b78c6f821c17d862d818dbacbf1813">operator*</a>(<span class="keyword">const</span> <a class="code" href="classVectorizedArray.html">VectorizedArray&lt;Number, width&gt;</a> &amp;u,</div><div class="line"><a name="l04696"></a><span class="lineno"> 4696</span>&#160;          <span class="keyword">const</span> <a class="code" href="classVectorizedArray.html">VectorizedArray&lt;Number, width&gt;</a> &amp;v)</div><div class="line"><a name="l04697"></a><span class="lineno"> 4697</span>&#160;{</div><div class="line"><a name="l04698"></a><span class="lineno"> 4698</span>&#160;  <a class="code" href="classVectorizedArray.html">VectorizedArray&lt;Number, width&gt;</a> tmp = u;</div><div class="line"><a name="l04699"></a><span class="lineno"> 4699</span>&#160;  <span class="keywordflow">return</span> tmp *= v;</div><div class="line"><a name="l04700"></a><span class="lineno"> 4700</span>&#160;}</div><div class="line"><a name="l04701"></a><span class="lineno"> 4701</span>&#160;</div><div class="line"><a name="l04708"></a><span class="lineno"> 4708</span>&#160;<span class="keyword">template</span> &lt;<span class="keyword">typename</span> Number, std::<span class="keywordtype">size_t</span> w<span class="keywordtype">id</span>th&gt;</div><div class="line"><a name="l04709"></a><span class="lineno"> 4709</span>&#160;<span class="keyword">inline</span> <a class="code" href="config_8h.html#a1d1d58e8be15e5c4285f6892e5f33136">DEAL_II_ALWAYS_INLINE</a> <a class="code" href="classVectorizedArray.html">VectorizedArray&lt;Number, width&gt;</a></div><div class="line"><a name="l04710"></a><span class="lineno"><a class="line" href="vectorization_8h.html#ad92490d85f7b45a7e55a1a77b1e070b1"> 4710</a></span>&#160;                             <a class="code" href="vectorization_8h.html#ad92490d85f7b45a7e55a1a77b1e070b1">operator/</a>(<span class="keyword">const</span> <a class="code" href="classVectorizedArray.html">VectorizedArray&lt;Number, width&gt;</a> &amp;u,</div><div class="line"><a name="l04711"></a><span class="lineno"> 4711</span>&#160;          <span class="keyword">const</span> <a class="code" href="classVectorizedArray.html">VectorizedArray&lt;Number, width&gt;</a> &amp;v)</div><div class="line"><a name="l04712"></a><span class="lineno"> 4712</span>&#160;{</div><div class="line"><a name="l04713"></a><span class="lineno"> 4713</span>&#160;  <a class="code" href="classVectorizedArray.html">VectorizedArray&lt;Number, width&gt;</a> tmp = u;</div><div class="line"><a name="l04714"></a><span class="lineno"> 4714</span>&#160;  <span class="keywordflow">return</span> tmp /= v;</div><div class="line"><a name="l04715"></a><span class="lineno"> 4715</span>&#160;}</div><div class="line"><a name="l04716"></a><span class="lineno"> 4716</span>&#160;</div><div class="line"><a name="l04724"></a><span class="lineno"> 4724</span>&#160;<span class="keyword">template</span> &lt;<span class="keyword">typename</span> Number, std::<span class="keywordtype">size_t</span> w<span class="keywordtype">id</span>th&gt;</div><div class="line"><a name="l04725"></a><span class="lineno"> 4725</span>&#160;<span class="keyword">inline</span> <a class="code" href="config_8h.html#a1d1d58e8be15e5c4285f6892e5f33136">DEAL_II_ALWAYS_INLINE</a> <a class="code" href="classVectorizedArray.html">VectorizedArray&lt;Number, width&gt;</a></div><div class="line"><a name="l04726"></a><span class="lineno"><a class="line" href="vectorization_8h.html#a53b8b0dc43deb68af60df1a76f8badb3"> 4726</a></span>&#160;                             <a class="code" href="vectorization_8h.html#ad938a80e7098f4bf2193b14a14e73460">operator+</a>(<span class="keyword">const</span> Number &amp;u, <span class="keyword">const</span> <a class="code" href="classVectorizedArray.html">VectorizedArray&lt;Number, width&gt;</a> &amp;v)</div><div class="line"><a name="l04727"></a><span class="lineno"> 4727</span>&#160;{</div><div class="line"><a name="l04728"></a><span class="lineno"> 4728</span>&#160;  <a class="code" href="classVectorizedArray.html">VectorizedArray&lt;Number, width&gt;</a> tmp = u;</div><div class="line"><a name="l04729"></a><span class="lineno"> 4729</span>&#160;  <span class="keywordflow">return</span> tmp += v;</div><div class="line"><a name="l04730"></a><span class="lineno"> 4730</span>&#160;}</div><div class="line"><a name="l04731"></a><span class="lineno"> 4731</span>&#160;</div><div class="line"><a name="l04740"></a><span class="lineno"> 4740</span>&#160;<span class="keyword">template</span> &lt;std::<span class="keywordtype">size_t</span> w<span class="keywordtype">id</span>th&gt;</div><div class="line"><a name="l04741"></a><span class="lineno"> 4741</span>&#160;<span class="keyword">inline</span> <a class="code" href="config_8h.html#a1d1d58e8be15e5c4285f6892e5f33136">DEAL_II_ALWAYS_INLINE</a> <a class="code" href="classVectorizedArray.html">VectorizedArray&lt;float, width&gt;</a></div><div class="line"><a name="l04742"></a><span class="lineno"><a class="line" href="vectorization_8h.html#abd1ad99276a124e6b2262e6adc2621a4"> 4742</a></span>&#160;                             <a class="code" href="vectorization_8h.html#ad938a80e7098f4bf2193b14a14e73460">operator+</a>(<span class="keyword">const</span> <span class="keywordtype">double</span> u, <span class="keyword">const</span> <a class="code" href="classVectorizedArray.html">VectorizedArray&lt;float, width&gt;</a> &amp;v)</div><div class="line"><a name="l04743"></a><span class="lineno"> 4743</span>&#160;{</div><div class="line"><a name="l04744"></a><span class="lineno"> 4744</span>&#160;  <a class="code" href="classVectorizedArray.html">VectorizedArray&lt;float, width&gt;</a> tmp = u;</div><div class="line"><a name="l04745"></a><span class="lineno"> 4745</span>&#160;  <span class="keywordflow">return</span> tmp += v;</div><div class="line"><a name="l04746"></a><span class="lineno"> 4746</span>&#160;}</div><div class="line"><a name="l04747"></a><span class="lineno"> 4747</span>&#160;</div><div class="line"><a name="l04755"></a><span class="lineno"> 4755</span>&#160;<span class="keyword">template</span> &lt;<span class="keyword">typename</span> Number, std::<span class="keywordtype">size_t</span> w<span class="keywordtype">id</span>th&gt;</div><div class="line"><a name="l04756"></a><span class="lineno"> 4756</span>&#160;<span class="keyword">inline</span> <a class="code" href="config_8h.html#a1d1d58e8be15e5c4285f6892e5f33136">DEAL_II_ALWAYS_INLINE</a> <a class="code" href="classVectorizedArray.html">VectorizedArray&lt;Number, width&gt;</a></div><div class="line"><a name="l04757"></a><span class="lineno"><a class="line" href="vectorization_8h.html#a1bfc4e9feda79490243911ac8389abeb"> 4757</a></span>&#160;                             <a class="code" href="vectorization_8h.html#ad938a80e7098f4bf2193b14a14e73460">operator+</a>(<span class="keyword">const</span> <a class="code" href="classVectorizedArray.html">VectorizedArray&lt;Number, width&gt;</a> &amp;v, <span class="keyword">const</span> Number &amp;u)</div><div class="line"><a name="l04758"></a><span class="lineno"> 4758</span>&#160;{</div><div class="line"><a name="l04759"></a><span class="lineno"> 4759</span>&#160;  <span class="keywordflow">return</span> u + v;</div><div class="line"><a name="l04760"></a><span class="lineno"> 4760</span>&#160;}</div><div class="line"><a name="l04761"></a><span class="lineno"> 4761</span>&#160;</div><div class="line"><a name="l04770"></a><span class="lineno"> 4770</span>&#160;<span class="keyword">template</span> &lt;std::<span class="keywordtype">size_t</span> w<span class="keywordtype">id</span>th&gt;</div><div class="line"><a name="l04771"></a><span class="lineno"> 4771</span>&#160;<span class="keyword">inline</span> <a class="code" href="config_8h.html#a1d1d58e8be15e5c4285f6892e5f33136">DEAL_II_ALWAYS_INLINE</a> <a class="code" href="classVectorizedArray.html">VectorizedArray&lt;float, width&gt;</a></div><div class="line"><a name="l04772"></a><span class="lineno"><a class="line" href="vectorization_8h.html#a041de227d36132ca524ee4178d98093b"> 4772</a></span>&#160;                             <a class="code" href="vectorization_8h.html#ad938a80e7098f4bf2193b14a14e73460">operator+</a>(<span class="keyword">const</span> <a class="code" href="classVectorizedArray.html">VectorizedArray&lt;float, width&gt;</a> &amp;v, <span class="keyword">const</span> <span class="keywordtype">double</span> u)</div><div class="line"><a name="l04773"></a><span class="lineno"> 4773</span>&#160;{</div><div class="line"><a name="l04774"></a><span class="lineno"> 4774</span>&#160;  <span class="keywordflow">return</span> u + v;</div><div class="line"><a name="l04775"></a><span class="lineno"> 4775</span>&#160;}</div><div class="line"><a name="l04776"></a><span class="lineno"> 4776</span>&#160;</div><div class="line"><a name="l04784"></a><span class="lineno"> 4784</span>&#160;<span class="keyword">template</span> &lt;<span class="keyword">typename</span> Number, std::<span class="keywordtype">size_t</span> w<span class="keywordtype">id</span>th&gt;</div><div class="line"><a name="l04785"></a><span class="lineno"> 4785</span>&#160;<span class="keyword">inline</span> <a class="code" href="config_8h.html#a1d1d58e8be15e5c4285f6892e5f33136">DEAL_II_ALWAYS_INLINE</a> <a class="code" href="classVectorizedArray.html">VectorizedArray&lt;Number, width&gt;</a></div><div class="line"><a name="l04786"></a><span class="lineno"><a class="line" href="vectorization_8h.html#aad492519b2494af83eaa083eee9a7d7f"> 4786</a></span>&#160;                             <a class="code" href="vectorization_8h.html#a655230f65541b3787d1f71fa57a44072">operator-</a>(<span class="keyword">const</span> Number &amp;u, <span class="keyword">const</span> <a class="code" href="classVectorizedArray.html">VectorizedArray&lt;Number, width&gt;</a> &amp;v)</div><div class="line"><a name="l04787"></a><span class="lineno"> 4787</span>&#160;{</div><div class="line"><a name="l04788"></a><span class="lineno"> 4788</span>&#160;  <a class="code" href="classVectorizedArray.html">VectorizedArray&lt;Number, width&gt;</a> tmp = u;</div><div class="line"><a name="l04789"></a><span class="lineno"> 4789</span>&#160;  <span class="keywordflow">return</span> tmp -= v;</div><div class="line"><a name="l04790"></a><span class="lineno"> 4790</span>&#160;}</div><div class="line"><a name="l04791"></a><span class="lineno"> 4791</span>&#160;</div><div class="line"><a name="l04800"></a><span class="lineno"> 4800</span>&#160;<span class="keyword">template</span> &lt;std::<span class="keywordtype">size_t</span> w<span class="keywordtype">id</span>th&gt;</div><div class="line"><a name="l04801"></a><span class="lineno"> 4801</span>&#160;<span class="keyword">inline</span> <a class="code" href="config_8h.html#a1d1d58e8be15e5c4285f6892e5f33136">DEAL_II_ALWAYS_INLINE</a> <a class="code" href="classVectorizedArray.html">VectorizedArray&lt;float, width&gt;</a></div><div class="line"><a name="l04802"></a><span class="lineno"><a class="line" href="vectorization_8h.html#a4c891c4bdf89ab5fece2d15da7f7e21a"> 4802</a></span>&#160;                             <a class="code" href="vectorization_8h.html#a655230f65541b3787d1f71fa57a44072">operator-</a>(<span class="keyword">const</span> <span class="keywordtype">double</span> u, <span class="keyword">const</span> <a class="code" href="classVectorizedArray.html">VectorizedArray&lt;float, width&gt;</a> &amp;v)</div><div class="line"><a name="l04803"></a><span class="lineno"> 4803</span>&#160;{</div><div class="line"><a name="l04804"></a><span class="lineno"> 4804</span>&#160;  <a class="code" href="classVectorizedArray.html">VectorizedArray&lt;float, width&gt;</a> tmp = <span class="keyword">static_cast&lt;</span><span class="keywordtype">float</span><span class="keyword">&gt;</span>(u);</div><div class="line"><a name="l04805"></a><span class="lineno"> 4805</span>&#160;  <span class="keywordflow">return</span> tmp -= v;</div><div class="line"><a name="l04806"></a><span class="lineno"> 4806</span>&#160;}</div><div class="line"><a name="l04807"></a><span class="lineno"> 4807</span>&#160;</div><div class="line"><a name="l04815"></a><span class="lineno"> 4815</span>&#160;<span class="keyword">template</span> &lt;<span class="keyword">typename</span> Number, std::<span class="keywordtype">size_t</span> w<span class="keywordtype">id</span>th&gt;</div><div class="line"><a name="l04816"></a><span class="lineno"> 4816</span>&#160;<span class="keyword">inline</span> <a class="code" href="config_8h.html#a1d1d58e8be15e5c4285f6892e5f33136">DEAL_II_ALWAYS_INLINE</a> <a class="code" href="classVectorizedArray.html">VectorizedArray&lt;Number, width&gt;</a></div><div class="line"><a name="l04817"></a><span class="lineno"><a class="line" href="vectorization_8h.html#a3bda9e065a143791d3a12c41843c603d"> 4817</a></span>&#160;                             <a class="code" href="vectorization_8h.html#a655230f65541b3787d1f71fa57a44072">operator-</a>(<span class="keyword">const</span> <a class="code" href="classVectorizedArray.html">VectorizedArray&lt;Number, width&gt;</a> &amp;v, <span class="keyword">const</span> Number &amp;u)</div><div class="line"><a name="l04818"></a><span class="lineno"> 4818</span>&#160;{</div><div class="line"><a name="l04819"></a><span class="lineno"> 4819</span>&#160;  <a class="code" href="classVectorizedArray.html">VectorizedArray&lt;Number, width&gt;</a> tmp = u;</div><div class="line"><a name="l04820"></a><span class="lineno"> 4820</span>&#160;  <span class="keywordflow">return</span> v - tmp;</div><div class="line"><a name="l04821"></a><span class="lineno"> 4821</span>&#160;}</div><div class="line"><a name="l04822"></a><span class="lineno"> 4822</span>&#160;</div><div class="line"><a name="l04831"></a><span class="lineno"> 4831</span>&#160;<span class="keyword">template</span> &lt;std::<span class="keywordtype">size_t</span> w<span class="keywordtype">id</span>th&gt;</div><div class="line"><a name="l04832"></a><span class="lineno"> 4832</span>&#160;<span class="keyword">inline</span> <a class="code" href="config_8h.html#a1d1d58e8be15e5c4285f6892e5f33136">DEAL_II_ALWAYS_INLINE</a> <a class="code" href="classVectorizedArray.html">VectorizedArray&lt;float, width&gt;</a></div><div class="line"><a name="l04833"></a><span class="lineno"><a class="line" href="vectorization_8h.html#a9740a3e31e10c1a08e1c3d0a673da29e"> 4833</a></span>&#160;                             <a class="code" href="vectorization_8h.html#a655230f65541b3787d1f71fa57a44072">operator-</a>(<span class="keyword">const</span> <a class="code" href="classVectorizedArray.html">VectorizedArray&lt;float, width&gt;</a> &amp;v, <span class="keyword">const</span> <span class="keywordtype">double</span> u)</div><div class="line"><a name="l04834"></a><span class="lineno"> 4834</span>&#160;{</div><div class="line"><a name="l04835"></a><span class="lineno"> 4835</span>&#160;  <a class="code" href="classVectorizedArray.html">VectorizedArray&lt;float, width&gt;</a> tmp = <span class="keyword">static_cast&lt;</span><span class="keywordtype">float</span><span class="keyword">&gt;</span>(u);</div><div class="line"><a name="l04836"></a><span class="lineno"> 4836</span>&#160;  <span class="keywordflow">return</span> v - tmp;</div><div class="line"><a name="l04837"></a><span class="lineno"> 4837</span>&#160;}</div><div class="line"><a name="l04838"></a><span class="lineno"> 4838</span>&#160;</div><div class="line"><a name="l04846"></a><span class="lineno"> 4846</span>&#160;<span class="keyword">template</span> &lt;<span class="keyword">typename</span> Number, std::<span class="keywordtype">size_t</span> w<span class="keywordtype">id</span>th&gt;</div><div class="line"><a name="l04847"></a><span class="lineno"> 4847</span>&#160;<span class="keyword">inline</span> <a class="code" href="config_8h.html#a1d1d58e8be15e5c4285f6892e5f33136">DEAL_II_ALWAYS_INLINE</a> <a class="code" href="classVectorizedArray.html">VectorizedArray&lt;Number, width&gt;</a></div><div class="line"><a name="l04848"></a><span class="lineno"><a class="line" href="vectorization_8h.html#abd70ba108142e51cf551ef397538d319"> 4848</a></span>&#160;                             <a class="code" href="structEnableIfScalar.html#af9b78c6f821c17d862d818dbacbf1813">operator*</a>(<span class="keyword">const</span> Number &amp;u, <span class="keyword">const</span> <a class="code" href="classVectorizedArray.html">VectorizedArray&lt;Number, width&gt;</a> &amp;v)</div><div class="line"><a name="l04849"></a><span class="lineno"> 4849</span>&#160;{</div><div class="line"><a name="l04850"></a><span class="lineno"> 4850</span>&#160;  <a class="code" href="classVectorizedArray.html">VectorizedArray&lt;Number, width&gt;</a> tmp = u;</div><div class="line"><a name="l04851"></a><span class="lineno"> 4851</span>&#160;  <span class="keywordflow">return</span> tmp *= v;</div><div class="line"><a name="l04852"></a><span class="lineno"> 4852</span>&#160;}</div><div class="line"><a name="l04853"></a><span class="lineno"> 4853</span>&#160;</div><div class="line"><a name="l04861"></a><span class="lineno"> 4861</span>&#160;<span class="keyword">template</span> &lt;std::<span class="keywordtype">size_t</span> w<span class="keywordtype">id</span>th&gt;</div><div class="line"><a name="l04862"></a><span class="lineno"> 4862</span>&#160;<span class="keyword">inline</span> <a class="code" href="config_8h.html#a1d1d58e8be15e5c4285f6892e5f33136">DEAL_II_ALWAYS_INLINE</a> <a class="code" href="classVectorizedArray.html">VectorizedArray&lt;float, width&gt;</a></div><div class="line"><a name="l04863"></a><span class="lineno"><a class="line" href="vectorization_8h.html#af88298154660a2544e69a5d98e9c1347"> 4863</a></span>&#160;                             <a class="code" href="structEnableIfScalar.html#af9b78c6f821c17d862d818dbacbf1813">operator*</a>(<span class="keyword">const</span> <span class="keywordtype">double</span> u, <span class="keyword">const</span> <a class="code" href="classVectorizedArray.html">VectorizedArray&lt;float, width&gt;</a> &amp;v)</div><div class="line"><a name="l04864"></a><span class="lineno"> 4864</span>&#160;{</div><div class="line"><a name="l04865"></a><span class="lineno"> 4865</span>&#160;  <a class="code" href="classVectorizedArray.html">VectorizedArray&lt;float, width&gt;</a> tmp = <span class="keyword">static_cast&lt;</span><span class="keywordtype">float</span><span class="keyword">&gt;</span>(u);</div><div class="line"><a name="l04866"></a><span class="lineno"> 4866</span>&#160;  <span class="keywordflow">return</span> tmp *= v;</div><div class="line"><a name="l04867"></a><span class="lineno"> 4867</span>&#160;}</div><div class="line"><a name="l04868"></a><span class="lineno"> 4868</span>&#160;</div><div class="line"><a name="l04876"></a><span class="lineno"> 4876</span>&#160;<span class="keyword">template</span> &lt;<span class="keyword">typename</span> Number, std::<span class="keywordtype">size_t</span> w<span class="keywordtype">id</span>th&gt;</div><div class="line"><a name="l04877"></a><span class="lineno"> 4877</span>&#160;<span class="keyword">inline</span> <a class="code" href="config_8h.html#a1d1d58e8be15e5c4285f6892e5f33136">DEAL_II_ALWAYS_INLINE</a> <a class="code" href="classVectorizedArray.html">VectorizedArray&lt;Number, width&gt;</a></div><div class="line"><a name="l04878"></a><span class="lineno"><a class="line" href="vectorization_8h.html#a36e38a9fd6c14af630fd5d2ce05a90a7"> 4878</a></span>&#160;                             <a class="code" href="structEnableIfScalar.html#af9b78c6f821c17d862d818dbacbf1813">operator*</a>(<span class="keyword">const</span> <a class="code" href="classVectorizedArray.html">VectorizedArray&lt;Number, width&gt;</a> &amp;v, <span class="keyword">const</span> Number &amp;u)</div><div class="line"><a name="l04879"></a><span class="lineno"> 4879</span>&#160;{</div><div class="line"><a name="l04880"></a><span class="lineno"> 4880</span>&#160;  <span class="keywordflow">return</span> u * v;</div><div class="line"><a name="l04881"></a><span class="lineno"> 4881</span>&#160;}</div><div class="line"><a name="l04882"></a><span class="lineno"> 4882</span>&#160;</div><div class="line"><a name="l04891"></a><span class="lineno"> 4891</span>&#160;<span class="keyword">template</span> &lt;std::<span class="keywordtype">size_t</span> w<span class="keywordtype">id</span>th&gt;</div><div class="line"><a name="l04892"></a><span class="lineno"> 4892</span>&#160;<span class="keyword">inline</span> <a class="code" href="config_8h.html#a1d1d58e8be15e5c4285f6892e5f33136">DEAL_II_ALWAYS_INLINE</a> <a class="code" href="classVectorizedArray.html">VectorizedArray&lt;float, width&gt;</a></div><div class="line"><a name="l04893"></a><span class="lineno"><a class="line" href="vectorization_8h.html#a67c6e2d4507e185ef3e691897d068885"> 4893</a></span>&#160;                             <a class="code" href="structEnableIfScalar.html#af9b78c6f821c17d862d818dbacbf1813">operator*</a>(<span class="keyword">const</span> <a class="code" href="classVectorizedArray.html">VectorizedArray&lt;float, width&gt;</a> &amp;v, <span class="keyword">const</span> <span class="keywordtype">double</span> u)</div><div class="line"><a name="l04894"></a><span class="lineno"> 4894</span>&#160;{</div><div class="line"><a name="l04895"></a><span class="lineno"> 4895</span>&#160;  <span class="keywordflow">return</span> u * v;</div><div class="line"><a name="l04896"></a><span class="lineno"> 4896</span>&#160;}</div><div class="line"><a name="l04897"></a><span class="lineno"> 4897</span>&#160;</div><div class="line"><a name="l04905"></a><span class="lineno"> 4905</span>&#160;<span class="keyword">template</span> &lt;<span class="keyword">typename</span> Number, std::<span class="keywordtype">size_t</span> w<span class="keywordtype">id</span>th&gt;</div><div class="line"><a name="l04906"></a><span class="lineno"> 4906</span>&#160;<span class="keyword">inline</span> <a class="code" href="config_8h.html#a1d1d58e8be15e5c4285f6892e5f33136">DEAL_II_ALWAYS_INLINE</a> <a class="code" href="classVectorizedArray.html">VectorizedArray&lt;Number, width&gt;</a></div><div class="line"><a name="l04907"></a><span class="lineno"><a class="line" href="vectorization_8h.html#ac8b532bf8e52de9bdf6f50a32e0e7850"> 4907</a></span>&#160;                             <a class="code" href="vectorization_8h.html#ad92490d85f7b45a7e55a1a77b1e070b1">operator/</a>(<span class="keyword">const</span> Number &amp;u, <span class="keyword">const</span> <a class="code" href="classVectorizedArray.html">VectorizedArray&lt;Number, width&gt;</a> &amp;v)</div><div class="line"><a name="l04908"></a><span class="lineno"> 4908</span>&#160;{</div><div class="line"><a name="l04909"></a><span class="lineno"> 4909</span>&#160;  <a class="code" href="classVectorizedArray.html">VectorizedArray&lt;Number, width&gt;</a> tmp = u;</div><div class="line"><a name="l04910"></a><span class="lineno"> 4910</span>&#160;  <span class="keywordflow">return</span> tmp /= v;</div><div class="line"><a name="l04911"></a><span class="lineno"> 4911</span>&#160;}</div><div class="line"><a name="l04912"></a><span class="lineno"> 4912</span>&#160;</div><div class="line"><a name="l04920"></a><span class="lineno"> 4920</span>&#160;<span class="keyword">template</span> &lt;std::<span class="keywordtype">size_t</span> w<span class="keywordtype">id</span>th&gt;</div><div class="line"><a name="l04921"></a><span class="lineno"> 4921</span>&#160;<span class="keyword">inline</span> <a class="code" href="config_8h.html#a1d1d58e8be15e5c4285f6892e5f33136">DEAL_II_ALWAYS_INLINE</a> <a class="code" href="classVectorizedArray.html">VectorizedArray&lt;float, width&gt;</a></div><div class="line"><a name="l04922"></a><span class="lineno"><a class="line" href="vectorization_8h.html#af6f25b89d500cb7729727d9fb88aba1d"> 4922</a></span>&#160;                             <a class="code" href="vectorization_8h.html#ad92490d85f7b45a7e55a1a77b1e070b1">operator/</a>(<span class="keyword">const</span> <span class="keywordtype">double</span> u, <span class="keyword">const</span> <a class="code" href="classVectorizedArray.html">VectorizedArray&lt;float, width&gt;</a> &amp;v)</div><div class="line"><a name="l04923"></a><span class="lineno"> 4923</span>&#160;{</div><div class="line"><a name="l04924"></a><span class="lineno"> 4924</span>&#160;  <a class="code" href="classVectorizedArray.html">VectorizedArray&lt;float, width&gt;</a> tmp = <span class="keyword">static_cast&lt;</span><span class="keywordtype">float</span><span class="keyword">&gt;</span>(u);</div><div class="line"><a name="l04925"></a><span class="lineno"> 4925</span>&#160;  <span class="keywordflow">return</span> tmp /= v;</div><div class="line"><a name="l04926"></a><span class="lineno"> 4926</span>&#160;}</div><div class="line"><a name="l04927"></a><span class="lineno"> 4927</span>&#160;</div><div class="line"><a name="l04935"></a><span class="lineno"> 4935</span>&#160;<span class="keyword">template</span> &lt;<span class="keyword">typename</span> Number, std::<span class="keywordtype">size_t</span> w<span class="keywordtype">id</span>th&gt;</div><div class="line"><a name="l04936"></a><span class="lineno"> 4936</span>&#160;<span class="keyword">inline</span> <a class="code" href="config_8h.html#a1d1d58e8be15e5c4285f6892e5f33136">DEAL_II_ALWAYS_INLINE</a> <a class="code" href="classVectorizedArray.html">VectorizedArray&lt;Number, width&gt;</a></div><div class="line"><a name="l04937"></a><span class="lineno"><a class="line" href="vectorization_8h.html#a250c9df8da4b13efaab02e1302dfc60f"> 4937</a></span>&#160;                             <a class="code" href="vectorization_8h.html#ad92490d85f7b45a7e55a1a77b1e070b1">operator/</a>(<span class="keyword">const</span> <a class="code" href="classVectorizedArray.html">VectorizedArray&lt;Number, width&gt;</a> &amp;v, <span class="keyword">const</span> Number &amp;u)</div><div class="line"><a name="l04938"></a><span class="lineno"> 4938</span>&#160;{</div><div class="line"><a name="l04939"></a><span class="lineno"> 4939</span>&#160;  <a class="code" href="classVectorizedArray.html">VectorizedArray&lt;Number, width&gt;</a> tmp = u;</div><div class="line"><a name="l04940"></a><span class="lineno"> 4940</span>&#160;  <span class="keywordflow">return</span> v / tmp;</div><div class="line"><a name="l04941"></a><span class="lineno"> 4941</span>&#160;}</div><div class="line"><a name="l04942"></a><span class="lineno"> 4942</span>&#160;</div><div class="line"><a name="l04951"></a><span class="lineno"> 4951</span>&#160;<span class="keyword">template</span> &lt;std::<span class="keywordtype">size_t</span> w<span class="keywordtype">id</span>th&gt;</div><div class="line"><a name="l04952"></a><span class="lineno"> 4952</span>&#160;<span class="keyword">inline</span> <a class="code" href="config_8h.html#a1d1d58e8be15e5c4285f6892e5f33136">DEAL_II_ALWAYS_INLINE</a> <a class="code" href="classVectorizedArray.html">VectorizedArray&lt;float, width&gt;</a></div><div class="line"><a name="l04953"></a><span class="lineno"><a class="line" href="vectorization_8h.html#a2ba8c9defa578058e48dde1e112a67da"> 4953</a></span>&#160;                             <a class="code" href="vectorization_8h.html#ad92490d85f7b45a7e55a1a77b1e070b1">operator/</a>(<span class="keyword">const</span> <a class="code" href="classVectorizedArray.html">VectorizedArray&lt;float, width&gt;</a> &amp;v, <span class="keyword">const</span> <span class="keywordtype">double</span> u)</div><div class="line"><a name="l04954"></a><span class="lineno"> 4954</span>&#160;{</div><div class="line"><a name="l04955"></a><span class="lineno"> 4955</span>&#160;  <a class="code" href="classVectorizedArray.html">VectorizedArray&lt;float, width&gt;</a> tmp = <span class="keyword">static_cast&lt;</span><span class="keywordtype">float</span><span class="keyword">&gt;</span>(u);</div><div class="line"><a name="l04956"></a><span class="lineno"> 4956</span>&#160;  <span class="keywordflow">return</span> v / tmp;</div><div class="line"><a name="l04957"></a><span class="lineno"> 4957</span>&#160;}</div><div class="line"><a name="l04958"></a><span class="lineno"> 4958</span>&#160;</div><div class="line"><a name="l04965"></a><span class="lineno"> 4965</span>&#160;<span class="keyword">template</span> &lt;<span class="keyword">typename</span> Number, std::<span class="keywordtype">size_t</span> w<span class="keywordtype">id</span>th&gt;</div><div class="line"><a name="l04966"></a><span class="lineno"> 4966</span>&#160;<span class="keyword">inline</span> <a class="code" href="config_8h.html#a1d1d58e8be15e5c4285f6892e5f33136">DEAL_II_ALWAYS_INLINE</a> <a class="code" href="classVectorizedArray.html">VectorizedArray&lt;Number, width&gt;</a></div><div class="line"><a name="l04967"></a><span class="lineno"><a class="line" href="vectorization_8h.html#a55f68552b3739e75e9ff533277174863"> 4967</a></span>&#160;                             <a class="code" href="vectorization_8h.html#ad938a80e7098f4bf2193b14a14e73460">operator+</a>(<span class="keyword">const</span> <a class="code" href="classVectorizedArray.html">VectorizedArray&lt;Number, width&gt;</a> &amp;u)</div><div class="line"><a name="l04968"></a><span class="lineno"> 4968</span>&#160;{</div><div class="line"><a name="l04969"></a><span class="lineno"> 4969</span>&#160;  <span class="keywordflow">return</span> u;</div><div class="line"><a name="l04970"></a><span class="lineno"> 4970</span>&#160;}</div><div class="line"><a name="l04971"></a><span class="lineno"> 4971</span>&#160;</div><div class="line"><a name="l04980"></a><span class="lineno"> 4980</span>&#160;<span class="keyword">template</span> &lt;<span class="keyword">typename</span> Number, std::<span class="keywordtype">size_t</span> w<span class="keywordtype">id</span>th&gt;</div><div class="line"><a name="l04981"></a><span class="lineno"> 4981</span>&#160;<span class="keyword">inline</span> <a class="code" href="config_8h.html#a1d1d58e8be15e5c4285f6892e5f33136">DEAL_II_ALWAYS_INLINE</a> <a class="code" href="classVectorizedArray.html">VectorizedArray&lt;Number, width&gt;</a></div><div class="line"><a name="l04982"></a><span class="lineno"><a class="line" href="vectorization_8h.html#a00794d026f4360efda32d2e3a0c0ce72"> 4982</a></span>&#160;                             <a class="code" href="vectorization_8h.html#a655230f65541b3787d1f71fa57a44072">operator-</a>(<span class="keyword">const</span> <a class="code" href="classVectorizedArray.html">VectorizedArray&lt;Number, width&gt;</a> &amp;u)</div><div class="line"><a name="l04983"></a><span class="lineno"> 4983</span>&#160;{</div><div class="line"><a name="l04984"></a><span class="lineno"> 4984</span>&#160;  <span class="comment">// to get a negative sign, subtract the input from zero (could also</span></div><div class="line"><a name="l04985"></a><span class="lineno"> 4985</span>&#160;  <span class="comment">// multiply by -1, but this one is slightly simpler)</span></div><div class="line"><a name="l04986"></a><span class="lineno"> 4986</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="classVectorizedArray.html">VectorizedArray&lt;Number, width&gt;</a>() - u;</div><div class="line"><a name="l04987"></a><span class="lineno"> 4987</span>&#160;}</div><div class="line"><a name="l04988"></a><span class="lineno"> 4988</span>&#160;</div><div class="line"><a name="l04995"></a><span class="lineno"> 4995</span>&#160;<span class="keyword">template</span> &lt;<span class="keyword">typename</span> Number, std::<span class="keywordtype">size_t</span> w<span class="keywordtype">id</span>th&gt;</div><div class="line"><a name="l04996"></a><span class="lineno"> 4996</span>&#160;<span class="keyword">inline</span> std::ostream &amp;</div><div class="line"><a name="l04997"></a><span class="lineno"><a class="line" href="vectorization_8h.html#a3676d2de40d79d2ab01808334e9a69b9"> 4997</a></span>&#160;operator&lt;&lt;(std::ostream &amp;out, const VectorizedArray&lt;Number, width&gt; &amp;p)</div><div class="line"><a name="l04998"></a><span class="lineno"> 4998</span>&#160;{</div><div class="line"><a name="l04999"></a><span class="lineno"> 4999</span>&#160;  constexpr <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> n = <a class="code" href="classVectorizedArrayBase.html#acb35404acc1693aee6e990228924cc09">VectorizedArray&lt;Number, width&gt;::size</a>();</div><div class="line"><a name="l05000"></a><span class="lineno"> 5000</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i = 0; i &lt; n - 1; ++i)</div><div class="line"><a name="l05001"></a><span class="lineno"> 5001</span>&#160;    out &lt;&lt; p[i] &lt;&lt; <span class="charliteral">&#39; &#39;</span>;</div><div class="line"><a name="l05002"></a><span class="lineno"> 5002</span>&#160;  out &lt;&lt; p[n - 1];</div><div class="line"><a name="l05003"></a><span class="lineno"> 5003</span>&#160;</div><div class="line"><a name="l05004"></a><span class="lineno"> 5004</span>&#160;  <span class="keywordflow">return</span> out;</div><div class="line"><a name="l05005"></a><span class="lineno"> 5005</span>&#160;}</div><div class="line"><a name="l05006"></a><span class="lineno"> 5006</span>&#160;</div><div class="line"><a name="l05008"></a><span class="lineno"> 5008</span>&#160;</div><div class="line"><a name="l05015"></a><span class="lineno"> 5015</span>&#160;</div><div class="line"><a name="l05016"></a><span class="lineno"> 5016</span>&#160;</div><div class="line"><a name="l05027"></a><span class="lineno"><a class="line" href="vectorization_8h.html#a31b02447b71a04a1ec9bdd1358751e45"> 5027</a></span>&#160;<span class="keyword">enum class</span> <a class="code" href="vectorization_8h.html#a31b02447b71a04a1ec9bdd1358751e45">SIMDComparison</a> : <a class="code" href="classint.html">int</a></div><div class="line"><a name="l05028"></a><span class="lineno"> 5028</span>&#160;{</div><div class="line"><a name="l05029"></a><span class="lineno"> 5029</span>&#160;<span class="preprocessor">#if DEAL_II_VECTORIZATION_WIDTH_IN_BITS &gt;= 256 &amp;&amp; defined(__AVX__)</span></div><div class="line"><a name="l05030"></a><span class="lineno"> 5030</span>&#160;  <a class="code" href="vectorization_8h.html#a31b02447b71a04a1ec9bdd1358751e45a465289687a70db7aa7217cc240c29f0f">equal</a>                 = _CMP_EQ_OQ,</div><div class="line"><a name="l05031"></a><span class="lineno"> 5031</span>&#160;  <a class="code" href="vectorization_8h.html#a31b02447b71a04a1ec9bdd1358751e45a96ee5c0e2a7149613e7fd0b83316486e">not_equal</a>             = _CMP_NEQ_OQ,</div><div class="line"><a name="l05032"></a><span class="lineno"> 5032</span>&#160;  <a class="code" href="vectorization_8h.html#a31b02447b71a04a1ec9bdd1358751e45a7875e44acb1bebecb46c929deb43cef4">less_than</a>             = _CMP_LT_OQ,</div><div class="line"><a name="l05033"></a><span class="lineno"> 5033</span>&#160;  <a class="code" href="vectorization_8h.html#a31b02447b71a04a1ec9bdd1358751e45a9f6a1c1739ff468513ed276436f3db72">less_than_or_equal</a>    = _CMP_LE_OQ,</div><div class="line"><a name="l05034"></a><span class="lineno"> 5034</span>&#160;  <a class="code" href="vectorization_8h.html#a31b02447b71a04a1ec9bdd1358751e45af9001e5685fe6f7cb467dc66269470b2">greater_than</a>          = _CMP_GT_OQ,</div><div class="line"><a name="l05035"></a><span class="lineno"> 5035</span>&#160;  <a class="code" href="vectorization_8h.html#a31b02447b71a04a1ec9bdd1358751e45ae69e99a9a1111b6a811f8e5bd832454f">greater_than_or_equal</a> = _CMP_GE_OQ</div><div class="line"><a name="l05036"></a><span class="lineno"> 5036</span>&#160;<span class="preprocessor">#else</span></div><div class="line"><a name="l05037"></a><span class="lineno"> 5037</span>&#160;  <a class="code" href="vectorization_8h.html#a31b02447b71a04a1ec9bdd1358751e45a465289687a70db7aa7217cc240c29f0f">equal</a>,</div><div class="line"><a name="l05038"></a><span class="lineno"> 5038</span>&#160;  <a class="code" href="vectorization_8h.html#a31b02447b71a04a1ec9bdd1358751e45a96ee5c0e2a7149613e7fd0b83316486e">not_equal</a>,</div><div class="line"><a name="l05039"></a><span class="lineno"> 5039</span>&#160;  <a class="code" href="vectorization_8h.html#a31b02447b71a04a1ec9bdd1358751e45a7875e44acb1bebecb46c929deb43cef4">less_than</a>,</div><div class="line"><a name="l05040"></a><span class="lineno"> 5040</span>&#160;  <a class="code" href="vectorization_8h.html#a31b02447b71a04a1ec9bdd1358751e45a9f6a1c1739ff468513ed276436f3db72">less_than_or_equal</a>,</div><div class="line"><a name="l05041"></a><span class="lineno"> 5041</span>&#160;  <a class="code" href="vectorization_8h.html#a31b02447b71a04a1ec9bdd1358751e45af9001e5685fe6f7cb467dc66269470b2">greater_than</a>,</div><div class="line"><a name="l05042"></a><span class="lineno"> 5042</span>&#160;  greater_than_or_equal</div><div class="line"><a name="l05043"></a><span class="lineno"> 5043</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l05044"></a><span class="lineno"> 5044</span>&#160;};</div><div class="line"><a name="l05045"></a><span class="lineno"> 5045</span>&#160;</div><div class="line"><a name="l05046"></a><span class="lineno"> 5046</span>&#160;</div><div class="line"><a name="l05106"></a><span class="lineno"> 5106</span>&#160;<span class="keyword">template</span> &lt;SIMDComparison predicate, <span class="keyword">typename</span> Number&gt;</div><div class="line"><a name="l05107"></a><span class="lineno"> 5107</span>&#160;<a class="code" href="config_8h.html#a1d1d58e8be15e5c4285f6892e5f33136">DEAL_II_ALWAYS_INLINE</a> <span class="keyword">inline</span> Number</div><div class="line"><a name="l05108"></a><span class="lineno"><a class="line" href="vectorization_8h.html#ac274b257ee3ff9666b2062b8ba56db8f"> 5108</a></span>&#160;<a class="code" href="vectorization_8h.html#ac274b257ee3ff9666b2062b8ba56db8f">compare_and_apply_mask</a>(<span class="keyword">const</span> Number &amp;left,</div><div class="line"><a name="l05109"></a><span class="lineno"> 5109</span>&#160;                       <span class="keyword">const</span> Number &amp;right,</div><div class="line"><a name="l05110"></a><span class="lineno"> 5110</span>&#160;                       <span class="keyword">const</span> Number &amp;true_value,</div><div class="line"><a name="l05111"></a><span class="lineno"> 5111</span>&#160;                       <span class="keyword">const</span> Number &amp;false_value)</div><div class="line"><a name="l05112"></a><span class="lineno"> 5112</span>&#160;{</div><div class="line"><a name="l05113"></a><span class="lineno"> 5113</span>&#160;  <span class="keywordtype">bool</span> mask;</div><div class="line"><a name="l05114"></a><span class="lineno"> 5114</span>&#160;  <span class="keywordflow">switch</span> (predicate)</div><div class="line"><a name="l05115"></a><span class="lineno"> 5115</span>&#160;    {</div><div class="line"><a name="l05116"></a><span class="lineno"> 5116</span>&#160;      <span class="keywordflow">case</span> <a class="code" href="vectorization_8h.html#a31b02447b71a04a1ec9bdd1358751e45a465289687a70db7aa7217cc240c29f0f">SIMDComparison::equal</a>:</div><div class="line"><a name="l05117"></a><span class="lineno"> 5117</span>&#160;        mask = (left == right);</div><div class="line"><a name="l05118"></a><span class="lineno"> 5118</span>&#160;        <span class="keywordflow">break</span>;</div><div class="line"><a name="l05119"></a><span class="lineno"> 5119</span>&#160;      <span class="keywordflow">case</span> <a class="code" href="vectorization_8h.html#a31b02447b71a04a1ec9bdd1358751e45a96ee5c0e2a7149613e7fd0b83316486e">SIMDComparison::not_equal</a>:</div><div class="line"><a name="l05120"></a><span class="lineno"> 5120</span>&#160;        mask = (left != right);</div><div class="line"><a name="l05121"></a><span class="lineno"> 5121</span>&#160;        <span class="keywordflow">break</span>;</div><div class="line"><a name="l05122"></a><span class="lineno"> 5122</span>&#160;      <span class="keywordflow">case</span> <a class="code" href="vectorization_8h.html#a31b02447b71a04a1ec9bdd1358751e45a7875e44acb1bebecb46c929deb43cef4">SIMDComparison::less_than</a>:</div><div class="line"><a name="l05123"></a><span class="lineno"> 5123</span>&#160;        mask = (left &lt; right);</div><div class="line"><a name="l05124"></a><span class="lineno"> 5124</span>&#160;        <span class="keywordflow">break</span>;</div><div class="line"><a name="l05125"></a><span class="lineno"> 5125</span>&#160;      <span class="keywordflow">case</span> <a class="code" href="vectorization_8h.html#a31b02447b71a04a1ec9bdd1358751e45a9f6a1c1739ff468513ed276436f3db72">SIMDComparison::less_than_or_equal</a>:</div><div class="line"><a name="l05126"></a><span class="lineno"> 5126</span>&#160;        mask = (left &lt;= right);</div><div class="line"><a name="l05127"></a><span class="lineno"> 5127</span>&#160;        <span class="keywordflow">break</span>;</div><div class="line"><a name="l05128"></a><span class="lineno"> 5128</span>&#160;      <span class="keywordflow">case</span> <a class="code" href="vectorization_8h.html#a31b02447b71a04a1ec9bdd1358751e45af9001e5685fe6f7cb467dc66269470b2">SIMDComparison::greater_than</a>:</div><div class="line"><a name="l05129"></a><span class="lineno"> 5129</span>&#160;        mask = (left &gt; right);</div><div class="line"><a name="l05130"></a><span class="lineno"> 5130</span>&#160;        <span class="keywordflow">break</span>;</div><div class="line"><a name="l05131"></a><span class="lineno"> 5131</span>&#160;      <span class="keywordflow">case</span> <a class="code" href="vectorization_8h.html#a31b02447b71a04a1ec9bdd1358751e45ae69e99a9a1111b6a811f8e5bd832454f">SIMDComparison::greater_than_or_equal</a>:</div><div class="line"><a name="l05132"></a><span class="lineno"> 5132</span>&#160;        mask = (left &gt;= right);</div><div class="line"><a name="l05133"></a><span class="lineno"> 5133</span>&#160;        <span class="keywordflow">break</span>;</div><div class="line"><a name="l05134"></a><span class="lineno"> 5134</span>&#160;    }</div><div class="line"><a name="l05135"></a><span class="lineno"> 5135</span>&#160;</div><div class="line"><a name="l05136"></a><span class="lineno"> 5136</span>&#160;  <span class="keywordflow">return</span> mask ? true_value : false_value;</div><div class="line"><a name="l05137"></a><span class="lineno"> 5137</span>&#160;}</div><div class="line"><a name="l05138"></a><span class="lineno"> 5138</span>&#160;</div><div class="line"><a name="l05139"></a><span class="lineno"> 5139</span>&#160;</div><div class="line"><a name="l05146"></a><span class="lineno"> 5146</span>&#160;<span class="keyword">template</span> &lt;SIMDComparison predicate, <span class="keyword">typename</span> Number&gt;</div><div class="line"><a name="l05147"></a><span class="lineno"> 5147</span>&#160;<a class="code" href="config_8h.html#a1d1d58e8be15e5c4285f6892e5f33136">DEAL_II_ALWAYS_INLINE</a> <span class="keyword">inline</span> <a class="code" href="classVectorizedArray.html">VectorizedArray&lt;Number, 1&gt;</a></div><div class="line"><a name="l05148"></a><span class="lineno"><a class="line" href="vectorization_8h.html#a67a14956ceb21a6bc048b2c5ced72845"> 5148</a></span>&#160;<a class="code" href="vectorization_8h.html#ac274b257ee3ff9666b2062b8ba56db8f">compare_and_apply_mask</a>(<span class="keyword">const</span> <a class="code" href="classVectorizedArray.html">VectorizedArray&lt;Number, 1&gt;</a> &amp;left,</div><div class="line"><a name="l05149"></a><span class="lineno"> 5149</span>&#160;                       <span class="keyword">const</span> <a class="code" href="classVectorizedArray.html">VectorizedArray&lt;Number, 1&gt;</a> &amp;right,</div><div class="line"><a name="l05150"></a><span class="lineno"> 5150</span>&#160;                       <span class="keyword">const</span> <a class="code" href="classVectorizedArray.html">VectorizedArray&lt;Number, 1&gt;</a> &amp;true_value,</div><div class="line"><a name="l05151"></a><span class="lineno"> 5151</span>&#160;                       <span class="keyword">const</span> <a class="code" href="classVectorizedArray.html">VectorizedArray&lt;Number, 1&gt;</a> &amp;false_value)</div><div class="line"><a name="l05152"></a><span class="lineno"> 5152</span>&#160;{</div><div class="line"><a name="l05153"></a><span class="lineno"> 5153</span>&#160;  <a class="code" href="classVectorizedArray.html">VectorizedArray&lt;Number, 1&gt;</a> result;</div><div class="line"><a name="l05154"></a><span class="lineno"> 5154</span>&#160;  result.<a class="code" href="classVectorizedArray.html#ad38190d02537705964e021da7ecbab3f">data</a> = compare_and_apply_mask&lt;predicate, Number&gt;(left.<a class="code" href="classVectorizedArray.html#ad38190d02537705964e021da7ecbab3f">data</a>,</div><div class="line"><a name="l05155"></a><span class="lineno"> 5155</span>&#160;                                                          right.<a class="code" href="classVectorizedArray.html#ad38190d02537705964e021da7ecbab3f">data</a>,</div><div class="line"><a name="l05156"></a><span class="lineno"> 5156</span>&#160;                                                          true_value.<a class="code" href="classVectorizedArray.html#ad38190d02537705964e021da7ecbab3f">data</a>,</div><div class="line"><a name="l05157"></a><span class="lineno"> 5157</span>&#160;                                                          false_value.<a class="code" href="classVectorizedArray.html#ad38190d02537705964e021da7ecbab3f">data</a>);</div><div class="line"><a name="l05158"></a><span class="lineno"> 5158</span>&#160;  <span class="keywordflow">return</span> result;</div><div class="line"><a name="l05159"></a><span class="lineno"> 5159</span>&#160;}</div><div class="line"><a name="l05160"></a><span class="lineno"> 5160</span>&#160;</div><div class="line"><a name="l05162"></a><span class="lineno"> 5162</span>&#160;</div><div class="line"><a name="l05163"></a><span class="lineno"> 5163</span>&#160;<span class="preprocessor">#ifndef DOXYGEN</span></div><div class="line"><a name="l05164"></a><span class="lineno"> 5164</span>&#160;<span class="preprocessor">#  if DEAL_II_VECTORIZATION_WIDTH_IN_BITS &gt;= 512 &amp;&amp; defined(__AVX512F__)</span></div><div class="line"><a name="l05165"></a><span class="lineno"> 5165</span>&#160;</div><div class="line"><a name="l05166"></a><span class="lineno"> 5166</span>&#160;<span class="keyword">template</span> &lt;SIMDComparison predicate&gt;</div><div class="line"><a name="l05167"></a><span class="lineno"> 5167</span>&#160;<a class="code" href="config_8h.html#a1d1d58e8be15e5c4285f6892e5f33136">DEAL_II_ALWAYS_INLINE</a> <span class="keyword">inline</span> <a class="code" href="classVectorizedArray.html">VectorizedArray&lt;float, 16&gt;</a></div><div class="line"><a name="l05168"></a><span class="lineno"> 5168</span>&#160;<a class="code" href="vectorization_8h.html#ac274b257ee3ff9666b2062b8ba56db8f">compare_and_apply_mask</a>(<span class="keyword">const</span> <a class="code" href="classVectorizedArray.html">VectorizedArray&lt;float, 16&gt;</a> &amp;left,</div><div class="line"><a name="l05169"></a><span class="lineno"> 5169</span>&#160;                       <span class="keyword">const</span> <a class="code" href="classVectorizedArray.html">VectorizedArray&lt;float, 16&gt;</a> &amp;right,</div><div class="line"><a name="l05170"></a><span class="lineno"> 5170</span>&#160;                       <span class="keyword">const</span> <a class="code" href="classVectorizedArray.html">VectorizedArray&lt;float, 16&gt;</a> &amp;true_values,</div><div class="line"><a name="l05171"></a><span class="lineno"> 5171</span>&#160;                       <span class="keyword">const</span> <a class="code" href="classVectorizedArray.html">VectorizedArray&lt;float, 16&gt;</a> &amp;false_values)</div><div class="line"><a name="l05172"></a><span class="lineno"> 5172</span>&#160;{</div><div class="line"><a name="l05173"></a><span class="lineno"> 5173</span>&#160;  <span class="keyword">const</span> __mmask16 mask =</div><div class="line"><a name="l05174"></a><span class="lineno"> 5174</span>&#160;    _mm512_cmp_ps_mask(left.<a class="code" href="classVectorizedArray.html#ad38190d02537705964e021da7ecbab3f">data</a>, right.<a class="code" href="classVectorizedArray.html#ad38190d02537705964e021da7ecbab3f">data</a>, static_cast&lt;int&gt;(predicate));</div><div class="line"><a name="l05175"></a><span class="lineno"> 5175</span>&#160;  <a class="code" href="classVectorizedArray.html">VectorizedArray&lt;float, 16&gt;</a> result;</div><div class="line"><a name="l05176"></a><span class="lineno"> 5176</span>&#160;  result.<a class="code" href="classVectorizedArray.html#ad38190d02537705964e021da7ecbab3f">data</a> = _mm512_mask_mov_ps(false_values.<a class="code" href="classVectorizedArray.html#ad38190d02537705964e021da7ecbab3f">data</a>, mask, true_values.<a class="code" href="classVectorizedArray.html#ad38190d02537705964e021da7ecbab3f">data</a>);</div><div class="line"><a name="l05177"></a><span class="lineno"> 5177</span>&#160;  <span class="keywordflow">return</span> result;</div><div class="line"><a name="l05178"></a><span class="lineno"> 5178</span>&#160;}</div><div class="line"><a name="l05179"></a><span class="lineno"> 5179</span>&#160;</div><div class="line"><a name="l05180"></a><span class="lineno"> 5180</span>&#160;</div><div class="line"><a name="l05181"></a><span class="lineno"> 5181</span>&#160;</div><div class="line"><a name="l05182"></a><span class="lineno"> 5182</span>&#160;<span class="keyword">template</span> &lt;SIMDComparison predicate&gt;</div><div class="line"><a name="l05183"></a><span class="lineno"> 5183</span>&#160;<a class="code" href="config_8h.html#a1d1d58e8be15e5c4285f6892e5f33136">DEAL_II_ALWAYS_INLINE</a> <span class="keyword">inline</span> <a class="code" href="classVectorizedArray.html">VectorizedArray&lt;double, 8&gt;</a></div><div class="line"><a name="l05184"></a><span class="lineno"> 5184</span>&#160;<a class="code" href="vectorization_8h.html#ac274b257ee3ff9666b2062b8ba56db8f">compare_and_apply_mask</a>(<span class="keyword">const</span> <a class="code" href="classVectorizedArray.html">VectorizedArray&lt;double, 8&gt;</a> &amp;left,</div><div class="line"><a name="l05185"></a><span class="lineno"> 5185</span>&#160;                       <span class="keyword">const</span> <a class="code" href="classVectorizedArray.html">VectorizedArray&lt;double, 8&gt;</a> &amp;right,</div><div class="line"><a name="l05186"></a><span class="lineno"> 5186</span>&#160;                       <span class="keyword">const</span> <a class="code" href="classVectorizedArray.html">VectorizedArray&lt;double, 8&gt;</a> &amp;true_values,</div><div class="line"><a name="l05187"></a><span class="lineno"> 5187</span>&#160;                       <span class="keyword">const</span> <a class="code" href="classVectorizedArray.html">VectorizedArray&lt;double, 8&gt;</a> &amp;false_values)</div><div class="line"><a name="l05188"></a><span class="lineno"> 5188</span>&#160;{</div><div class="line"><a name="l05189"></a><span class="lineno"> 5189</span>&#160;  <span class="keyword">const</span> __mmask16 mask =</div><div class="line"><a name="l05190"></a><span class="lineno"> 5190</span>&#160;    _mm512_cmp_pd_mask(left.<a class="code" href="classVectorizedArray.html#ad38190d02537705964e021da7ecbab3f">data</a>, right.<a class="code" href="classVectorizedArray.html#ad38190d02537705964e021da7ecbab3f">data</a>, static_cast&lt;int&gt;(predicate));</div><div class="line"><a name="l05191"></a><span class="lineno"> 5191</span>&#160;  <a class="code" href="classVectorizedArray.html">VectorizedArray&lt;double, 8&gt;</a> result;</div><div class="line"><a name="l05192"></a><span class="lineno"> 5192</span>&#160;  result.<a class="code" href="classVectorizedArray.html#ad38190d02537705964e021da7ecbab3f">data</a> = _mm512_mask_mov_pd(false_values.<a class="code" href="classVectorizedArray.html#ad38190d02537705964e021da7ecbab3f">data</a>, mask, true_values.<a class="code" href="classVectorizedArray.html#ad38190d02537705964e021da7ecbab3f">data</a>);</div><div class="line"><a name="l05193"></a><span class="lineno"> 5193</span>&#160;  <span class="keywordflow">return</span> result;</div><div class="line"><a name="l05194"></a><span class="lineno"> 5194</span>&#160;}</div><div class="line"><a name="l05195"></a><span class="lineno"> 5195</span>&#160;</div><div class="line"><a name="l05196"></a><span class="lineno"> 5196</span>&#160;<span class="preprocessor">#  endif</span></div><div class="line"><a name="l05197"></a><span class="lineno"> 5197</span>&#160;</div><div class="line"><a name="l05198"></a><span class="lineno"> 5198</span>&#160;<span class="preprocessor">#  if DEAL_II_VECTORIZATION_WIDTH_IN_BITS &gt;= 256 &amp;&amp; defined(__AVX__)</span></div><div class="line"><a name="l05199"></a><span class="lineno"> 5199</span>&#160;</div><div class="line"><a name="l05200"></a><span class="lineno"> 5200</span>&#160;<span class="keyword">template</span> &lt;SIMDComparison predicate&gt;</div><div class="line"><a name="l05201"></a><span class="lineno"> 5201</span>&#160;<a class="code" href="config_8h.html#a1d1d58e8be15e5c4285f6892e5f33136">DEAL_II_ALWAYS_INLINE</a> <span class="keyword">inline</span> <a class="code" href="classVectorizedArray.html">VectorizedArray&lt;float, 8&gt;</a></div><div class="line"><a name="l05202"></a><span class="lineno"> 5202</span>&#160;<a class="code" href="vectorization_8h.html#ac274b257ee3ff9666b2062b8ba56db8f">compare_and_apply_mask</a>(<span class="keyword">const</span> <a class="code" href="classVectorizedArray.html">VectorizedArray&lt;float, 8&gt;</a> &amp;left,</div><div class="line"><a name="l05203"></a><span class="lineno"> 5203</span>&#160;                       <span class="keyword">const</span> <a class="code" href="classVectorizedArray.html">VectorizedArray&lt;float, 8&gt;</a> &amp;right,</div><div class="line"><a name="l05204"></a><span class="lineno"> 5204</span>&#160;                       <span class="keyword">const</span> <a class="code" href="classVectorizedArray.html">VectorizedArray&lt;float, 8&gt;</a> &amp;true_values,</div><div class="line"><a name="l05205"></a><span class="lineno"> 5205</span>&#160;                       <span class="keyword">const</span> <a class="code" href="classVectorizedArray.html">VectorizedArray&lt;float, 8&gt;</a> &amp;false_values)</div><div class="line"><a name="l05206"></a><span class="lineno"> 5206</span>&#160;{</div><div class="line"><a name="l05207"></a><span class="lineno"> 5207</span>&#160;  <span class="keyword">const</span> <span class="keyword">auto</span> mask =</div><div class="line"><a name="l05208"></a><span class="lineno"> 5208</span>&#160;    _mm256_cmp_ps(left.<a class="code" href="classVectorizedArray.html#ad38190d02537705964e021da7ecbab3f">data</a>, right.<a class="code" href="classVectorizedArray.html#ad38190d02537705964e021da7ecbab3f">data</a>, static_cast&lt;int&gt;(predicate));</div><div class="line"><a name="l05209"></a><span class="lineno"> 5209</span>&#160;</div><div class="line"><a name="l05210"></a><span class="lineno"> 5210</span>&#160;  <a class="code" href="classVectorizedArray.html">VectorizedArray&lt;float, 8&gt;</a> result;</div><div class="line"><a name="l05211"></a><span class="lineno"> 5211</span>&#160;  result.<a class="code" href="classVectorizedArray.html#ad38190d02537705964e021da7ecbab3f">data</a> = _mm256_or_ps(_mm256_and_ps(mask, true_values.<a class="code" href="classVectorizedArray.html#ad38190d02537705964e021da7ecbab3f">data</a>),</div><div class="line"><a name="l05212"></a><span class="lineno"> 5212</span>&#160;                             _mm256_andnot_ps(mask, false_values.<a class="code" href="classVectorizedArray.html#ad38190d02537705964e021da7ecbab3f">data</a>));</div><div class="line"><a name="l05213"></a><span class="lineno"> 5213</span>&#160;  <span class="keywordflow">return</span> result;</div><div class="line"><a name="l05214"></a><span class="lineno"> 5214</span>&#160;}</div><div class="line"><a name="l05215"></a><span class="lineno"> 5215</span>&#160;</div><div class="line"><a name="l05216"></a><span class="lineno"> 5216</span>&#160;</div><div class="line"><a name="l05217"></a><span class="lineno"> 5217</span>&#160;<span class="keyword">template</span> &lt;SIMDComparison predicate&gt;</div><div class="line"><a name="l05218"></a><span class="lineno"> 5218</span>&#160;<a class="code" href="config_8h.html#a1d1d58e8be15e5c4285f6892e5f33136">DEAL_II_ALWAYS_INLINE</a> <span class="keyword">inline</span> <a class="code" href="classVectorizedArray.html">VectorizedArray&lt;double, 4&gt;</a></div><div class="line"><a name="l05219"></a><span class="lineno"> 5219</span>&#160;<a class="code" href="vectorization_8h.html#ac274b257ee3ff9666b2062b8ba56db8f">compare_and_apply_mask</a>(<span class="keyword">const</span> <a class="code" href="classVectorizedArray.html">VectorizedArray&lt;double, 4&gt;</a> &amp;left,</div><div class="line"><a name="l05220"></a><span class="lineno"> 5220</span>&#160;                       <span class="keyword">const</span> <a class="code" href="classVectorizedArray.html">VectorizedArray&lt;double, 4&gt;</a> &amp;right,</div><div class="line"><a name="l05221"></a><span class="lineno"> 5221</span>&#160;                       <span class="keyword">const</span> <a class="code" href="classVectorizedArray.html">VectorizedArray&lt;double, 4&gt;</a> &amp;true_values,</div><div class="line"><a name="l05222"></a><span class="lineno"> 5222</span>&#160;                       <span class="keyword">const</span> <a class="code" href="classVectorizedArray.html">VectorizedArray&lt;double, 4&gt;</a> &amp;false_values)</div><div class="line"><a name="l05223"></a><span class="lineno"> 5223</span>&#160;{</div><div class="line"><a name="l05224"></a><span class="lineno"> 5224</span>&#160;  <span class="keyword">const</span> <span class="keyword">auto</span> mask =</div><div class="line"><a name="l05225"></a><span class="lineno"> 5225</span>&#160;    _mm256_cmp_pd(left.<a class="code" href="classVectorizedArray.html#ad38190d02537705964e021da7ecbab3f">data</a>, right.<a class="code" href="classVectorizedArray.html#ad38190d02537705964e021da7ecbab3f">data</a>, static_cast&lt;int&gt;(predicate));</div><div class="line"><a name="l05226"></a><span class="lineno"> 5226</span>&#160;</div><div class="line"><a name="l05227"></a><span class="lineno"> 5227</span>&#160;  <a class="code" href="classVectorizedArray.html">VectorizedArray&lt;double, 4&gt;</a> result;</div><div class="line"><a name="l05228"></a><span class="lineno"> 5228</span>&#160;  result.<a class="code" href="classVectorizedArray.html#ad38190d02537705964e021da7ecbab3f">data</a> = _mm256_or_pd(_mm256_and_pd(mask, true_values.<a class="code" href="classVectorizedArray.html#ad38190d02537705964e021da7ecbab3f">data</a>),</div><div class="line"><a name="l05229"></a><span class="lineno"> 5229</span>&#160;                             _mm256_andnot_pd(mask, false_values.<a class="code" href="classVectorizedArray.html#ad38190d02537705964e021da7ecbab3f">data</a>));</div><div class="line"><a name="l05230"></a><span class="lineno"> 5230</span>&#160;  <span class="keywordflow">return</span> result;</div><div class="line"><a name="l05231"></a><span class="lineno"> 5231</span>&#160;}</div><div class="line"><a name="l05232"></a><span class="lineno"> 5232</span>&#160;</div><div class="line"><a name="l05233"></a><span class="lineno"> 5233</span>&#160;<span class="preprocessor">#  endif</span></div><div class="line"><a name="l05234"></a><span class="lineno"> 5234</span>&#160;</div><div class="line"><a name="l05235"></a><span class="lineno"> 5235</span>&#160;<span class="preprocessor">#  if DEAL_II_VECTORIZATION_WIDTH_IN_BITS &gt;= 128 &amp;&amp; defined(__SSE2__)</span></div><div class="line"><a name="l05236"></a><span class="lineno"> 5236</span>&#160;</div><div class="line"><a name="l05237"></a><span class="lineno"> 5237</span>&#160;<span class="keyword">template</span> &lt;SIMDComparison predicate&gt;</div><div class="line"><a name="l05238"></a><span class="lineno"> 5238</span>&#160;<a class="code" href="config_8h.html#a1d1d58e8be15e5c4285f6892e5f33136">DEAL_II_ALWAYS_INLINE</a> <span class="keyword">inline</span> <a class="code" href="classVectorizedArray.html">VectorizedArray&lt;float, 4&gt;</a></div><div class="line"><a name="l05239"></a><span class="lineno"> 5239</span>&#160;<a class="code" href="vectorization_8h.html#ac274b257ee3ff9666b2062b8ba56db8f">compare_and_apply_mask</a>(<span class="keyword">const</span> <a class="code" href="classVectorizedArray.html">VectorizedArray&lt;float, 4&gt;</a> &amp;left,</div><div class="line"><a name="l05240"></a><span class="lineno"> 5240</span>&#160;                       <span class="keyword">const</span> <a class="code" href="classVectorizedArray.html">VectorizedArray&lt;float, 4&gt;</a> &amp;right,</div><div class="line"><a name="l05241"></a><span class="lineno"> 5241</span>&#160;                       <span class="keyword">const</span> <a class="code" href="classVectorizedArray.html">VectorizedArray&lt;float, 4&gt;</a> &amp;true_values,</div><div class="line"><a name="l05242"></a><span class="lineno"> 5242</span>&#160;                       <span class="keyword">const</span> <a class="code" href="classVectorizedArray.html">VectorizedArray&lt;float, 4&gt;</a> &amp;false_values)</div><div class="line"><a name="l05243"></a><span class="lineno"> 5243</span>&#160;{</div><div class="line"><a name="l05244"></a><span class="lineno"> 5244</span>&#160;  __m128 mask;</div><div class="line"><a name="l05245"></a><span class="lineno"> 5245</span>&#160;  <span class="keywordflow">switch</span> (predicate)</div><div class="line"><a name="l05246"></a><span class="lineno"> 5246</span>&#160;    {</div><div class="line"><a name="l05247"></a><span class="lineno"> 5247</span>&#160;      <span class="keywordflow">case</span> <a class="code" href="vectorization_8h.html#a31b02447b71a04a1ec9bdd1358751e45a465289687a70db7aa7217cc240c29f0f">SIMDComparison::equal</a>:</div><div class="line"><a name="l05248"></a><span class="lineno"> 5248</span>&#160;        mask = _mm_cmpeq_ps(left.<a class="code" href="classVectorizedArray.html#ad38190d02537705964e021da7ecbab3f">data</a>, right.<a class="code" href="classVectorizedArray.html#ad38190d02537705964e021da7ecbab3f">data</a>);</div><div class="line"><a name="l05249"></a><span class="lineno"> 5249</span>&#160;        <span class="keywordflow">break</span>;</div><div class="line"><a name="l05250"></a><span class="lineno"> 5250</span>&#160;      <span class="keywordflow">case</span> <a class="code" href="vectorization_8h.html#a31b02447b71a04a1ec9bdd1358751e45a96ee5c0e2a7149613e7fd0b83316486e">SIMDComparison::not_equal</a>:</div><div class="line"><a name="l05251"></a><span class="lineno"> 5251</span>&#160;        mask = _mm_cmpneq_ps(left.<a class="code" href="classVectorizedArray.html#ad38190d02537705964e021da7ecbab3f">data</a>, right.<a class="code" href="classVectorizedArray.html#ad38190d02537705964e021da7ecbab3f">data</a>);</div><div class="line"><a name="l05252"></a><span class="lineno"> 5252</span>&#160;        <span class="keywordflow">break</span>;</div><div class="line"><a name="l05253"></a><span class="lineno"> 5253</span>&#160;      <span class="keywordflow">case</span> <a class="code" href="vectorization_8h.html#a31b02447b71a04a1ec9bdd1358751e45a7875e44acb1bebecb46c929deb43cef4">SIMDComparison::less_than</a>:</div><div class="line"><a name="l05254"></a><span class="lineno"> 5254</span>&#160;        mask = _mm_cmplt_ps(left.<a class="code" href="classVectorizedArray.html#ad38190d02537705964e021da7ecbab3f">data</a>, right.<a class="code" href="classVectorizedArray.html#ad38190d02537705964e021da7ecbab3f">data</a>);</div><div class="line"><a name="l05255"></a><span class="lineno"> 5255</span>&#160;        <span class="keywordflow">break</span>;</div><div class="line"><a name="l05256"></a><span class="lineno"> 5256</span>&#160;      <span class="keywordflow">case</span> <a class="code" href="vectorization_8h.html#a31b02447b71a04a1ec9bdd1358751e45a9f6a1c1739ff468513ed276436f3db72">SIMDComparison::less_than_or_equal</a>:</div><div class="line"><a name="l05257"></a><span class="lineno"> 5257</span>&#160;        mask = _mm_cmple_ps(left.<a class="code" href="classVectorizedArray.html#ad38190d02537705964e021da7ecbab3f">data</a>, right.<a class="code" href="classVectorizedArray.html#ad38190d02537705964e021da7ecbab3f">data</a>);</div><div class="line"><a name="l05258"></a><span class="lineno"> 5258</span>&#160;        <span class="keywordflow">break</span>;</div><div class="line"><a name="l05259"></a><span class="lineno"> 5259</span>&#160;      <span class="keywordflow">case</span> <a class="code" href="vectorization_8h.html#a31b02447b71a04a1ec9bdd1358751e45af9001e5685fe6f7cb467dc66269470b2">SIMDComparison::greater_than</a>:</div><div class="line"><a name="l05260"></a><span class="lineno"> 5260</span>&#160;        mask = _mm_cmpgt_ps(left.<a class="code" href="classVectorizedArray.html#ad38190d02537705964e021da7ecbab3f">data</a>, right.<a class="code" href="classVectorizedArray.html#ad38190d02537705964e021da7ecbab3f">data</a>);</div><div class="line"><a name="l05261"></a><span class="lineno"> 5261</span>&#160;        <span class="keywordflow">break</span>;</div><div class="line"><a name="l05262"></a><span class="lineno"> 5262</span>&#160;      <span class="keywordflow">case</span> <a class="code" href="vectorization_8h.html#a31b02447b71a04a1ec9bdd1358751e45ae69e99a9a1111b6a811f8e5bd832454f">SIMDComparison::greater_than_or_equal</a>:</div><div class="line"><a name="l05263"></a><span class="lineno"> 5263</span>&#160;        mask = _mm_cmpge_ps(left.<a class="code" href="classVectorizedArray.html#ad38190d02537705964e021da7ecbab3f">data</a>, right.<a class="code" href="classVectorizedArray.html#ad38190d02537705964e021da7ecbab3f">data</a>);</div><div class="line"><a name="l05264"></a><span class="lineno"> 5264</span>&#160;        <span class="keywordflow">break</span>;</div><div class="line"><a name="l05265"></a><span class="lineno"> 5265</span>&#160;    }</div><div class="line"><a name="l05266"></a><span class="lineno"> 5266</span>&#160;</div><div class="line"><a name="l05267"></a><span class="lineno"> 5267</span>&#160;  <a class="code" href="classVectorizedArray.html">VectorizedArray&lt;float, 4&gt;</a> result;</div><div class="line"><a name="l05268"></a><span class="lineno"> 5268</span>&#160;  result.<a class="code" href="classVectorizedArray.html#ad38190d02537705964e021da7ecbab3f">data</a> = _mm_or_ps(_mm_and_ps(mask, true_values.<a class="code" href="classVectorizedArray.html#ad38190d02537705964e021da7ecbab3f">data</a>),</div><div class="line"><a name="l05269"></a><span class="lineno"> 5269</span>&#160;                          _mm_andnot_ps(mask, false_values.<a class="code" href="classVectorizedArray.html#ad38190d02537705964e021da7ecbab3f">data</a>));</div><div class="line"><a name="l05270"></a><span class="lineno"> 5270</span>&#160;</div><div class="line"><a name="l05271"></a><span class="lineno"> 5271</span>&#160;  <span class="keywordflow">return</span> result;</div><div class="line"><a name="l05272"></a><span class="lineno"> 5272</span>&#160;}</div><div class="line"><a name="l05273"></a><span class="lineno"> 5273</span>&#160;</div><div class="line"><a name="l05274"></a><span class="lineno"> 5274</span>&#160;</div><div class="line"><a name="l05275"></a><span class="lineno"> 5275</span>&#160;<span class="keyword">template</span> &lt;SIMDComparison predicate&gt;</div><div class="line"><a name="l05276"></a><span class="lineno"> 5276</span>&#160;<a class="code" href="config_8h.html#a1d1d58e8be15e5c4285f6892e5f33136">DEAL_II_ALWAYS_INLINE</a> <span class="keyword">inline</span> <a class="code" href="classVectorizedArray.html">VectorizedArray&lt;double, 2&gt;</a></div><div class="line"><a name="l05277"></a><span class="lineno"> 5277</span>&#160;<a class="code" href="vectorization_8h.html#ac274b257ee3ff9666b2062b8ba56db8f">compare_and_apply_mask</a>(<span class="keyword">const</span> <a class="code" href="classVectorizedArray.html">VectorizedArray&lt;double, 2&gt;</a> &amp;left,</div><div class="line"><a name="l05278"></a><span class="lineno"> 5278</span>&#160;                       <span class="keyword">const</span> <a class="code" href="classVectorizedArray.html">VectorizedArray&lt;double, 2&gt;</a> &amp;right,</div><div class="line"><a name="l05279"></a><span class="lineno"> 5279</span>&#160;                       <span class="keyword">const</span> <a class="code" href="classVectorizedArray.html">VectorizedArray&lt;double, 2&gt;</a> &amp;true_values,</div><div class="line"><a name="l05280"></a><span class="lineno"> 5280</span>&#160;                       <span class="keyword">const</span> <a class="code" href="classVectorizedArray.html">VectorizedArray&lt;double, 2&gt;</a> &amp;false_values)</div><div class="line"><a name="l05281"></a><span class="lineno"> 5281</span>&#160;{</div><div class="line"><a name="l05282"></a><span class="lineno"> 5282</span>&#160;  __m128d mask;</div><div class="line"><a name="l05283"></a><span class="lineno"> 5283</span>&#160;  <span class="keywordflow">switch</span> (predicate)</div><div class="line"><a name="l05284"></a><span class="lineno"> 5284</span>&#160;    {</div><div class="line"><a name="l05285"></a><span class="lineno"> 5285</span>&#160;      <span class="keywordflow">case</span> <a class="code" href="vectorization_8h.html#a31b02447b71a04a1ec9bdd1358751e45a465289687a70db7aa7217cc240c29f0f">SIMDComparison::equal</a>:</div><div class="line"><a name="l05286"></a><span class="lineno"> 5286</span>&#160;        mask = _mm_cmpeq_pd(left.<a class="code" href="classVectorizedArray.html#ad38190d02537705964e021da7ecbab3f">data</a>, right.<a class="code" href="classVectorizedArray.html#ad38190d02537705964e021da7ecbab3f">data</a>);</div><div class="line"><a name="l05287"></a><span class="lineno"> 5287</span>&#160;        <span class="keywordflow">break</span>;</div><div class="line"><a name="l05288"></a><span class="lineno"> 5288</span>&#160;      <span class="keywordflow">case</span> <a class="code" href="vectorization_8h.html#a31b02447b71a04a1ec9bdd1358751e45a96ee5c0e2a7149613e7fd0b83316486e">SIMDComparison::not_equal</a>:</div><div class="line"><a name="l05289"></a><span class="lineno"> 5289</span>&#160;        mask = _mm_cmpneq_pd(left.<a class="code" href="classVectorizedArray.html#ad38190d02537705964e021da7ecbab3f">data</a>, right.<a class="code" href="classVectorizedArray.html#ad38190d02537705964e021da7ecbab3f">data</a>);</div><div class="line"><a name="l05290"></a><span class="lineno"> 5290</span>&#160;        <span class="keywordflow">break</span>;</div><div class="line"><a name="l05291"></a><span class="lineno"> 5291</span>&#160;      <span class="keywordflow">case</span> <a class="code" href="vectorization_8h.html#a31b02447b71a04a1ec9bdd1358751e45a7875e44acb1bebecb46c929deb43cef4">SIMDComparison::less_than</a>:</div><div class="line"><a name="l05292"></a><span class="lineno"> 5292</span>&#160;        mask = _mm_cmplt_pd(left.<a class="code" href="classVectorizedArray.html#ad38190d02537705964e021da7ecbab3f">data</a>, right.<a class="code" href="classVectorizedArray.html#ad38190d02537705964e021da7ecbab3f">data</a>);</div><div class="line"><a name="l05293"></a><span class="lineno"> 5293</span>&#160;        <span class="keywordflow">break</span>;</div><div class="line"><a name="l05294"></a><span class="lineno"> 5294</span>&#160;      <span class="keywordflow">case</span> <a class="code" href="vectorization_8h.html#a31b02447b71a04a1ec9bdd1358751e45a9f6a1c1739ff468513ed276436f3db72">SIMDComparison::less_than_or_equal</a>:</div><div class="line"><a name="l05295"></a><span class="lineno"> 5295</span>&#160;        mask = _mm_cmple_pd(left.<a class="code" href="classVectorizedArray.html#ad38190d02537705964e021da7ecbab3f">data</a>, right.<a class="code" href="classVectorizedArray.html#ad38190d02537705964e021da7ecbab3f">data</a>);</div><div class="line"><a name="l05296"></a><span class="lineno"> 5296</span>&#160;        <span class="keywordflow">break</span>;</div><div class="line"><a name="l05297"></a><span class="lineno"> 5297</span>&#160;      <span class="keywordflow">case</span> <a class="code" href="vectorization_8h.html#a31b02447b71a04a1ec9bdd1358751e45af9001e5685fe6f7cb467dc66269470b2">SIMDComparison::greater_than</a>:</div><div class="line"><a name="l05298"></a><span class="lineno"> 5298</span>&#160;        mask = _mm_cmpgt_pd(left.<a class="code" href="classVectorizedArray.html#ad38190d02537705964e021da7ecbab3f">data</a>, right.<a class="code" href="classVectorizedArray.html#ad38190d02537705964e021da7ecbab3f">data</a>);</div><div class="line"><a name="l05299"></a><span class="lineno"> 5299</span>&#160;        <span class="keywordflow">break</span>;</div><div class="line"><a name="l05300"></a><span class="lineno"> 5300</span>&#160;      <span class="keywordflow">case</span> <a class="code" href="vectorization_8h.html#a31b02447b71a04a1ec9bdd1358751e45ae69e99a9a1111b6a811f8e5bd832454f">SIMDComparison::greater_than_or_equal</a>:</div><div class="line"><a name="l05301"></a><span class="lineno"> 5301</span>&#160;        mask = _mm_cmpge_pd(left.<a class="code" href="classVectorizedArray.html#ad38190d02537705964e021da7ecbab3f">data</a>, right.<a class="code" href="classVectorizedArray.html#ad38190d02537705964e021da7ecbab3f">data</a>);</div><div class="line"><a name="l05302"></a><span class="lineno"> 5302</span>&#160;        <span class="keywordflow">break</span>;</div><div class="line"><a name="l05303"></a><span class="lineno"> 5303</span>&#160;    }</div><div class="line"><a name="l05304"></a><span class="lineno"> 5304</span>&#160;</div><div class="line"><a name="l05305"></a><span class="lineno"> 5305</span>&#160;  <a class="code" href="classVectorizedArray.html">VectorizedArray&lt;double, 2&gt;</a> result;</div><div class="line"><a name="l05306"></a><span class="lineno"> 5306</span>&#160;  result.<a class="code" href="classVectorizedArray.html#ad38190d02537705964e021da7ecbab3f">data</a> = _mm_or_pd(_mm_and_pd(mask, true_values.<a class="code" href="classVectorizedArray.html#ad38190d02537705964e021da7ecbab3f">data</a>),</div><div class="line"><a name="l05307"></a><span class="lineno"> 5307</span>&#160;                          _mm_andnot_pd(mask, false_values.<a class="code" href="classVectorizedArray.html#ad38190d02537705964e021da7ecbab3f">data</a>));</div><div class="line"><a name="l05308"></a><span class="lineno"> 5308</span>&#160;</div><div class="line"><a name="l05309"></a><span class="lineno"> 5309</span>&#160;  <span class="keywordflow">return</span> result;</div><div class="line"><a name="l05310"></a><span class="lineno"> 5310</span>&#160;}</div><div class="line"><a name="l05311"></a><span class="lineno"> 5311</span>&#160;</div><div class="line"><a name="l05312"></a><span class="lineno"> 5312</span>&#160;<span class="preprocessor">#  endif</span></div><div class="line"><a name="l05313"></a><span class="lineno"> 5313</span>&#160;<span class="preprocessor">#endif // DOXYGEN</span></div><div class="line"><a name="l05314"></a><span class="lineno"> 5314</span>&#160;</div><div class="line"><a name="l05315"></a><span class="lineno"> 5315</span>&#160;</div><div class="line"><a name="l05316"></a><span class="lineno"> 5316</span>&#160;<a class="code" href="config_8h.html#a998f224639942da0567cbd1ec77913b7">DEAL_II_NAMESPACE_CLOSE</a></div><div class="line"><a name="l05317"></a><span class="lineno"> 5317</span>&#160;</div><div class="line"><a name="l05324"></a><span class="lineno"> 5324</span>&#160;<span class="keyword">namespace </span><a class="code" href="namespacestd.html">std</a></div><div class="line"><a name="l05325"></a><span class="lineno"> 5325</span>&#160;{</div><div class="line"><a name="l05332"></a><span class="lineno"> 5332</span>&#160;  <span class="keyword">template</span> &lt;<span class="keyword">typename</span> Number, std::<span class="keywordtype">size_t</span> w<span class="keywordtype">id</span>th&gt;</div><div class="line"><a name="l05333"></a><span class="lineno"> 5333</span>&#160;  inline ::VectorizedArray&lt;Number, width&gt;</div><div class="line"><a name="l05334"></a><span class="lineno"><a class="line" href="vectorization_8h.html#ad9b7aa5c50bf9ce988a0f756a3f2baa5"> 5334</a></span>&#160;  <a class="code" href="numbers_8h.html#a27989bdc7b4b828564982787d126bd91">sin</a>(const ::VectorizedArray&lt;Number, width&gt; &amp;x)</div><div class="line"><a name="l05335"></a><span class="lineno"> 5335</span>&#160;  {</div><div class="line"><a name="l05336"></a><span class="lineno"> 5336</span>&#160;    <span class="comment">// put values in an array and later read in that array with an unaligned</span></div><div class="line"><a name="l05337"></a><span class="lineno"> 5337</span>&#160;    <span class="comment">// read. This should save some instructions as compared to directly</span></div><div class="line"><a name="l05338"></a><span class="lineno"> 5338</span>&#160;    <span class="comment">// setting the individual elements and also circumvents a compiler</span></div><div class="line"><a name="l05339"></a><span class="lineno"> 5339</span>&#160;    <span class="comment">// optimization bug in gcc-4.6 with SSE2 (see also deal.II developers list</span></div><div class="line"><a name="l05340"></a><span class="lineno"> 5340</span>&#160;    <span class="comment">// from April 2014, topic &quot;matrix_free/step-48 Test&quot;).</span></div><div class="line"><a name="l05341"></a><span class="lineno"> 5341</span>&#160;    Number <a class="code" href="namespaceEvaluationFlags.html#a9b7c6d689cb76386839d0d13640f59aeaf9825c682f693a6a200094641a0d6a58">values</a>[<a class="code" href="classVectorizedArrayBase.html#acb35404acc1693aee6e990228924cc09">::VectorizedArray&lt;Number, width&gt;::size</a>()];</div><div class="line"><a name="l05342"></a><span class="lineno"> 5342</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i = 0; i &lt; ::VectorizedArray&lt;Number, width&gt;::size();</div><div class="line"><a name="l05343"></a><span class="lineno"> 5343</span>&#160;         ++i)</div><div class="line"><a name="l05344"></a><span class="lineno"> 5344</span>&#160;      values[i] = <a class="code" href="vectorization_8h.html#ad9b7aa5c50bf9ce988a0f756a3f2baa5">std::sin</a>(x[i]);</div><div class="line"><a name="l05345"></a><span class="lineno"> 5345</span>&#160;    <a class="code" href="classVectorizedArray.html">::VectorizedArray&lt;Number, width&gt;</a> out;</div><div class="line"><a name="l05346"></a><span class="lineno"> 5346</span>&#160;    out.<a class="code" href="classVectorizedArray.html#ab0c3d5bcdf208c37fc1f8055765c03b1">load</a>(&amp;values[0]);</div><div class="line"><a name="l05347"></a><span class="lineno"> 5347</span>&#160;    <span class="keywordflow">return</span> out;</div><div class="line"><a name="l05348"></a><span class="lineno"> 5348</span>&#160;  }</div><div class="line"><a name="l05349"></a><span class="lineno"> 5349</span>&#160;</div><div class="line"><a name="l05350"></a><span class="lineno"> 5350</span>&#160;</div><div class="line"><a name="l05351"></a><span class="lineno"> 5351</span>&#160;</div><div class="line"><a name="l05357"></a><span class="lineno"> 5357</span>&#160;  <span class="keyword">template</span> &lt;<span class="keyword">typename</span> Number, std::<span class="keywordtype">size_t</span> w<span class="keywordtype">id</span>th&gt;</div><div class="line"><a name="l05358"></a><span class="lineno"> 5358</span>&#160;  inline ::VectorizedArray&lt;Number, width&gt;</div><div class="line"><a name="l05359"></a><span class="lineno"><a class="line" href="vectorization_8h.html#a11c48f86a4f2adf21555e64049ecde8c"> 5359</a></span>&#160;  <a class="code" href="numbers_8h.html#a02761f62f66f685e954daed42bcb3a1b">cos</a>(const ::VectorizedArray&lt;Number, width&gt; &amp;x)</div><div class="line"><a name="l05360"></a><span class="lineno"> 5360</span>&#160;  {</div><div class="line"><a name="l05361"></a><span class="lineno"> 5361</span>&#160;    Number <a class="code" href="namespaceEvaluationFlags.html#a9b7c6d689cb76386839d0d13640f59aeaf9825c682f693a6a200094641a0d6a58">values</a>[<a class="code" href="classVectorizedArrayBase.html#acb35404acc1693aee6e990228924cc09">::VectorizedArray&lt;Number, width&gt;::size</a>()];</div><div class="line"><a name="l05362"></a><span class="lineno"> 5362</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i = 0; i &lt; ::VectorizedArray&lt;Number, width&gt;::size();</div><div class="line"><a name="l05363"></a><span class="lineno"> 5363</span>&#160;         ++i)</div><div class="line"><a name="l05364"></a><span class="lineno"> 5364</span>&#160;      values[i] = <a class="code" href="vectorization_8h.html#a11c48f86a4f2adf21555e64049ecde8c">std::cos</a>(x[i]);</div><div class="line"><a name="l05365"></a><span class="lineno"> 5365</span>&#160;    <a class="code" href="classVectorizedArray.html">::VectorizedArray&lt;Number, width&gt;</a> out;</div><div class="line"><a name="l05366"></a><span class="lineno"> 5366</span>&#160;    out.<a class="code" href="classVectorizedArray.html#ab0c3d5bcdf208c37fc1f8055765c03b1">load</a>(&amp;values[0]);</div><div class="line"><a name="l05367"></a><span class="lineno"> 5367</span>&#160;    <span class="keywordflow">return</span> out;</div><div class="line"><a name="l05368"></a><span class="lineno"> 5368</span>&#160;  }</div><div class="line"><a name="l05369"></a><span class="lineno"> 5369</span>&#160;</div><div class="line"><a name="l05370"></a><span class="lineno"> 5370</span>&#160;</div><div class="line"><a name="l05371"></a><span class="lineno"> 5371</span>&#160;</div><div class="line"><a name="l05377"></a><span class="lineno"> 5377</span>&#160;  <span class="keyword">template</span> &lt;<span class="keyword">typename</span> Number, std::<span class="keywordtype">size_t</span> w<span class="keywordtype">id</span>th&gt;</div><div class="line"><a name="l05378"></a><span class="lineno"> 5378</span>&#160;  inline ::VectorizedArray&lt;Number, width&gt;</div><div class="line"><a name="l05379"></a><span class="lineno"><a class="line" href="vectorization_8h.html#ac2d0134a018bfda1707088d44fa20a86"> 5379</a></span>&#160;  <a class="code" href="numbers_8h.html#a744c1a2f59eee344cde5a970be8e6c99">tan</a>(const ::VectorizedArray&lt;Number, width&gt; &amp;x)</div><div class="line"><a name="l05380"></a><span class="lineno"> 5380</span>&#160;  {</div><div class="line"><a name="l05381"></a><span class="lineno"> 5381</span>&#160;    Number <a class="code" href="namespaceEvaluationFlags.html#a9b7c6d689cb76386839d0d13640f59aeaf9825c682f693a6a200094641a0d6a58">values</a>[<a class="code" href="classVectorizedArrayBase.html#acb35404acc1693aee6e990228924cc09">::VectorizedArray&lt;Number, width&gt;::size</a>()];</div><div class="line"><a name="l05382"></a><span class="lineno"> 5382</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i = 0; i &lt; ::VectorizedArray&lt;Number, width&gt;::size();</div><div class="line"><a name="l05383"></a><span class="lineno"> 5383</span>&#160;         ++i)</div><div class="line"><a name="l05384"></a><span class="lineno"> 5384</span>&#160;      values[i] = <a class="code" href="vectorization_8h.html#ac2d0134a018bfda1707088d44fa20a86">std::tan</a>(x[i]);</div><div class="line"><a name="l05385"></a><span class="lineno"> 5385</span>&#160;    <a class="code" href="classVectorizedArray.html">::VectorizedArray&lt;Number, width&gt;</a> out;</div><div class="line"><a name="l05386"></a><span class="lineno"> 5386</span>&#160;    out.<a class="code" href="classVectorizedArray.html#ab0c3d5bcdf208c37fc1f8055765c03b1">load</a>(&amp;values[0]);</div><div class="line"><a name="l05387"></a><span class="lineno"> 5387</span>&#160;    <span class="keywordflow">return</span> out;</div><div class="line"><a name="l05388"></a><span class="lineno"> 5388</span>&#160;  }</div><div class="line"><a name="l05389"></a><span class="lineno"> 5389</span>&#160;</div><div class="line"><a name="l05390"></a><span class="lineno"> 5390</span>&#160;</div><div class="line"><a name="l05391"></a><span class="lineno"> 5391</span>&#160;</div><div class="line"><a name="l05398"></a><span class="lineno"> 5398</span>&#160;  <span class="keyword">template</span> &lt;<span class="keyword">typename</span> Number, std::<span class="keywordtype">size_t</span> w<span class="keywordtype">id</span>th&gt;</div><div class="line"><a name="l05399"></a><span class="lineno"> 5399</span>&#160;  inline ::VectorizedArray&lt;Number, width&gt;</div><div class="line"><a name="l05400"></a><span class="lineno"><a class="line" href="vectorization_8h.html#a19f846bda83b7e3f4531daacb40c64e1"> 5400</a></span>&#160;  <a class="code" href="numbers_8h.html#a372e01cd9d1d07fdf136f4f40975d5cf">exp</a>(const ::VectorizedArray&lt;Number, width&gt; &amp;x)</div><div class="line"><a name="l05401"></a><span class="lineno"> 5401</span>&#160;  {</div><div class="line"><a name="l05402"></a><span class="lineno"> 5402</span>&#160;    Number <a class="code" href="namespaceEvaluationFlags.html#a9b7c6d689cb76386839d0d13640f59aeaf9825c682f693a6a200094641a0d6a58">values</a>[<a class="code" href="classVectorizedArrayBase.html#acb35404acc1693aee6e990228924cc09">::VectorizedArray&lt;Number, width&gt;::size</a>()];</div><div class="line"><a name="l05403"></a><span class="lineno"> 5403</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i = 0; i &lt; ::VectorizedArray&lt;Number, width&gt;::size();</div><div class="line"><a name="l05404"></a><span class="lineno"> 5404</span>&#160;         ++i)</div><div class="line"><a name="l05405"></a><span class="lineno"> 5405</span>&#160;      values[i] = <a class="code" href="vectorization_8h.html#a19f846bda83b7e3f4531daacb40c64e1">std::exp</a>(x[i]);</div><div class="line"><a name="l05406"></a><span class="lineno"> 5406</span>&#160;    <a class="code" href="classVectorizedArray.html">::VectorizedArray&lt;Number, width&gt;</a> out;</div><div class="line"><a name="l05407"></a><span class="lineno"> 5407</span>&#160;    out.<a class="code" href="classVectorizedArray.html#ab0c3d5bcdf208c37fc1f8055765c03b1">load</a>(&amp;values[0]);</div><div class="line"><a name="l05408"></a><span class="lineno"> 5408</span>&#160;    <span class="keywordflow">return</span> out;</div><div class="line"><a name="l05409"></a><span class="lineno"> 5409</span>&#160;  }</div><div class="line"><a name="l05410"></a><span class="lineno"> 5410</span>&#160;</div><div class="line"><a name="l05411"></a><span class="lineno"> 5411</span>&#160;</div><div class="line"><a name="l05412"></a><span class="lineno"> 5412</span>&#160;</div><div class="line"><a name="l05419"></a><span class="lineno"> 5419</span>&#160;  <span class="keyword">template</span> &lt;<span class="keyword">typename</span> Number, std::<span class="keywordtype">size_t</span> w<span class="keywordtype">id</span>th&gt;</div><div class="line"><a name="l05420"></a><span class="lineno"> 5420</span>&#160;  inline ::VectorizedArray&lt;Number, width&gt;</div><div class="line"><a name="l05421"></a><span class="lineno"><a class="line" href="vectorization_8h.html#a2aa674852f105b0ed1b35f569c19fea6"> 5421</a></span>&#160;  <a class="code" href="numbers_8h.html#a5ecbfe991bebf7e99864f2e4eb3ea8df">log</a>(const ::VectorizedArray&lt;Number, width&gt; &amp;x)</div><div class="line"><a name="l05422"></a><span class="lineno"> 5422</span>&#160;  {</div><div class="line"><a name="l05423"></a><span class="lineno"> 5423</span>&#160;    Number <a class="code" href="namespaceEvaluationFlags.html#a9b7c6d689cb76386839d0d13640f59aeaf9825c682f693a6a200094641a0d6a58">values</a>[<a class="code" href="classVectorizedArrayBase.html#acb35404acc1693aee6e990228924cc09">::VectorizedArray&lt;Number, width&gt;::size</a>()];</div><div class="line"><a name="l05424"></a><span class="lineno"> 5424</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i = 0; i &lt; ::VectorizedArray&lt;Number, width&gt;::size();</div><div class="line"><a name="l05425"></a><span class="lineno"> 5425</span>&#160;         ++i)</div><div class="line"><a name="l05426"></a><span class="lineno"> 5426</span>&#160;      values[i] = <a class="code" href="vectorization_8h.html#a2aa674852f105b0ed1b35f569c19fea6">std::log</a>(x[i]);</div><div class="line"><a name="l05427"></a><span class="lineno"> 5427</span>&#160;    <a class="code" href="classVectorizedArray.html">::VectorizedArray&lt;Number, width&gt;</a> out;</div><div class="line"><a name="l05428"></a><span class="lineno"> 5428</span>&#160;    out.<a class="code" href="classVectorizedArray.html#ab0c3d5bcdf208c37fc1f8055765c03b1">load</a>(&amp;values[0]);</div><div class="line"><a name="l05429"></a><span class="lineno"> 5429</span>&#160;    <span class="keywordflow">return</span> out;</div><div class="line"><a name="l05430"></a><span class="lineno"> 5430</span>&#160;  }</div><div class="line"><a name="l05431"></a><span class="lineno"> 5431</span>&#160;</div><div class="line"><a name="l05432"></a><span class="lineno"> 5432</span>&#160;</div><div class="line"><a name="l05433"></a><span class="lineno"> 5433</span>&#160;</div><div class="line"><a name="l05440"></a><span class="lineno"> 5440</span>&#160;  <span class="keyword">template</span> &lt;<span class="keyword">typename</span> Number, std::<span class="keywordtype">size_t</span> w<span class="keywordtype">id</span>th&gt;</div><div class="line"><a name="l05441"></a><span class="lineno"> 5441</span>&#160;  inline ::VectorizedArray&lt;Number, width&gt;</div><div class="line"><a name="l05442"></a><span class="lineno"><a class="line" href="vectorization_8h.html#a303f564e3c189251976da401ee2e44fa"> 5442</a></span>&#160;  <a class="code" href="numbers_8h.html#ac4a2ed1890a931d0b6a55933310eadca">sqrt</a>(const ::VectorizedArray&lt;Number, width&gt; &amp;x)</div><div class="line"><a name="l05443"></a><span class="lineno"> 5443</span>&#160;  {</div><div class="line"><a name="l05444"></a><span class="lineno"> 5444</span>&#160;    <span class="keywordflow">return</span> x.get_sqrt();</div><div class="line"><a name="l05445"></a><span class="lineno"> 5445</span>&#160;  }</div><div class="line"><a name="l05446"></a><span class="lineno"> 5446</span>&#160;</div><div class="line"><a name="l05447"></a><span class="lineno"> 5447</span>&#160;</div><div class="line"><a name="l05448"></a><span class="lineno"> 5448</span>&#160;</div><div class="line"><a name="l05456"></a><span class="lineno"> 5456</span>&#160;  <span class="keyword">template</span> &lt;<span class="keyword">typename</span> Number, std::<span class="keywordtype">size_t</span> w<span class="keywordtype">id</span>th&gt;</div><div class="line"><a name="l05457"></a><span class="lineno"> 5457</span>&#160;  inline ::VectorizedArray&lt;Number, width&gt;</div><div class="line"><a name="l05458"></a><span class="lineno"><a class="line" href="vectorization_8h.html#ac114cf7bf36e485eb78fedea2488a0d5"> 5458</a></span>&#160;  <a class="code" href="numbers_8h.html#af44aee1db5cdcd0bab54e3c011d2be66">pow</a>(const ::VectorizedArray&lt;Number, width&gt; &amp;x, <span class="keyword">const</span> Number p)</div><div class="line"><a name="l05459"></a><span class="lineno"> 5459</span>&#160;  {</div><div class="line"><a name="l05460"></a><span class="lineno"> 5460</span>&#160;    Number <a class="code" href="namespaceEvaluationFlags.html#a9b7c6d689cb76386839d0d13640f59aeaf9825c682f693a6a200094641a0d6a58">values</a>[<a class="code" href="classVectorizedArrayBase.html#acb35404acc1693aee6e990228924cc09">::VectorizedArray&lt;Number, width&gt;::size</a>()];</div><div class="line"><a name="l05461"></a><span class="lineno"> 5461</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i = 0; i &lt; ::VectorizedArray&lt;Number, width&gt;::size();</div><div class="line"><a name="l05462"></a><span class="lineno"> 5462</span>&#160;         ++i)</div><div class="line"><a name="l05463"></a><span class="lineno"> 5463</span>&#160;      values[i] = <a class="code" href="vectorization_8h.html#ae5c8b2cd70b2640bab8f1ee4ccb7f4cc">std::pow</a>(x[i], p);</div><div class="line"><a name="l05464"></a><span class="lineno"> 5464</span>&#160;    <a class="code" href="classVectorizedArray.html">::VectorizedArray&lt;Number, width&gt;</a> out;</div><div class="line"><a name="l05465"></a><span class="lineno"> 5465</span>&#160;    out.<a class="code" href="classVectorizedArray.html#ab0c3d5bcdf208c37fc1f8055765c03b1">load</a>(&amp;values[0]);</div><div class="line"><a name="l05466"></a><span class="lineno"> 5466</span>&#160;    <span class="keywordflow">return</span> out;</div><div class="line"><a name="l05467"></a><span class="lineno"> 5467</span>&#160;  }</div><div class="line"><a name="l05468"></a><span class="lineno"> 5468</span>&#160;</div><div class="line"><a name="l05469"></a><span class="lineno"> 5469</span>&#160;</div><div class="line"><a name="l05470"></a><span class="lineno"> 5470</span>&#160;</div><div class="line"><a name="l05478"></a><span class="lineno"> 5478</span>&#160;  <span class="keyword">template</span> &lt;<span class="keyword">typename</span> Number, std::<span class="keywordtype">size_t</span> w<span class="keywordtype">id</span>th&gt;</div><div class="line"><a name="l05479"></a><span class="lineno"> 5479</span>&#160;  inline ::VectorizedArray&lt;Number, width&gt;</div><div class="line"><a name="l05480"></a><span class="lineno"><a class="line" href="vectorization_8h.html#ae5c8b2cd70b2640bab8f1ee4ccb7f4cc"> 5480</a></span>&#160;  <a class="code" href="numbers_8h.html#af44aee1db5cdcd0bab54e3c011d2be66">pow</a>(const ::VectorizedArray&lt;Number, width&gt; &amp;x,</div><div class="line"><a name="l05481"></a><span class="lineno"> 5481</span>&#160;      const ::VectorizedArray&lt;Number, width&gt; &amp;p)</div><div class="line"><a name="l05482"></a><span class="lineno"> 5482</span>&#160;  {</div><div class="line"><a name="l05483"></a><span class="lineno"> 5483</span>&#160;    Number <a class="code" href="namespaceEvaluationFlags.html#a9b7c6d689cb76386839d0d13640f59aeaf9825c682f693a6a200094641a0d6a58">values</a>[<a class="code" href="classVectorizedArrayBase.html#acb35404acc1693aee6e990228924cc09">::VectorizedArray&lt;Number, width&gt;::size</a>()];</div><div class="line"><a name="l05484"></a><span class="lineno"> 5484</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i = 0; i &lt; ::VectorizedArray&lt;Number, width&gt;::size();</div><div class="line"><a name="l05485"></a><span class="lineno"> 5485</span>&#160;         ++i)</div><div class="line"><a name="l05486"></a><span class="lineno"> 5486</span>&#160;      values[i] = <a class="code" href="vectorization_8h.html#ae5c8b2cd70b2640bab8f1ee4ccb7f4cc">std::pow</a>(x[i], p[i]);</div><div class="line"><a name="l05487"></a><span class="lineno"> 5487</span>&#160;    <a class="code" href="classVectorizedArray.html">::VectorizedArray&lt;Number, width&gt;</a> out;</div><div class="line"><a name="l05488"></a><span class="lineno"> 5488</span>&#160;    out.<a class="code" href="classVectorizedArray.html#ab0c3d5bcdf208c37fc1f8055765c03b1">load</a>(&amp;values[0]);</div><div class="line"><a name="l05489"></a><span class="lineno"> 5489</span>&#160;    <span class="keywordflow">return</span> out;</div><div class="line"><a name="l05490"></a><span class="lineno"> 5490</span>&#160;  }</div><div class="line"><a name="l05491"></a><span class="lineno"> 5491</span>&#160;</div><div class="line"><a name="l05492"></a><span class="lineno"> 5492</span>&#160;</div><div class="line"><a name="l05493"></a><span class="lineno"> 5493</span>&#160;</div><div class="line"><a name="l05500"></a><span class="lineno"> 5500</span>&#160;  <span class="keyword">template</span> &lt;<span class="keyword">typename</span> Number, std::<span class="keywordtype">size_t</span> w<span class="keywordtype">id</span>th&gt;</div><div class="line"><a name="l05501"></a><span class="lineno"> 5501</span>&#160;  inline ::VectorizedArray&lt;Number, width&gt;</div><div class="line"><a name="l05502"></a><span class="lineno"><a class="line" href="vectorization_8h.html#aafbdfdd72b6cfe4eae5fa7a16385582f"> 5502</a></span>&#160;  <a class="code" href="numbers_8h.html#a0ebae11c64606a73e80a6328b1ab0802">abs</a>(const ::VectorizedArray&lt;Number, width&gt; &amp;x)</div><div class="line"><a name="l05503"></a><span class="lineno"> 5503</span>&#160;  {</div><div class="line"><a name="l05504"></a><span class="lineno"> 5504</span>&#160;    <span class="keywordflow">return</span> x.get_abs();</div><div class="line"><a name="l05505"></a><span class="lineno"> 5505</span>&#160;  }</div><div class="line"><a name="l05506"></a><span class="lineno"> 5506</span>&#160;</div><div class="line"><a name="l05507"></a><span class="lineno"> 5507</span>&#160;</div><div class="line"><a name="l05508"></a><span class="lineno"> 5508</span>&#160;</div><div class="line"><a name="l05514"></a><span class="lineno"> 5514</span>&#160;  <span class="keyword">template</span> &lt;<span class="keyword">typename</span> Number, std::<span class="keywordtype">size_t</span> w<span class="keywordtype">id</span>th&gt;</div><div class="line"><a name="l05515"></a><span class="lineno"> 5515</span>&#160;  inline ::VectorizedArray&lt;Number, width&gt;</div><div class="line"><a name="l05516"></a><span class="lineno"><a class="line" href="vectorization_8h.html#a93a4b202af7a0b7a652d6572c422663f"> 5516</a></span>&#160;  max(const ::VectorizedArray&lt;Number, width&gt; &amp;x,</div><div class="line"><a name="l05517"></a><span class="lineno"> 5517</span>&#160;      const ::VectorizedArray&lt;Number, width&gt; &amp;y)</div><div class="line"><a name="l05518"></a><span class="lineno"> 5518</span>&#160;  {</div><div class="line"><a name="l05519"></a><span class="lineno"> 5519</span>&#160;    <span class="keywordflow">return</span> x.get_max(y);</div><div class="line"><a name="l05520"></a><span class="lineno"> 5520</span>&#160;  }</div><div class="line"><a name="l05521"></a><span class="lineno"> 5521</span>&#160;</div><div class="line"><a name="l05522"></a><span class="lineno"> 5522</span>&#160;</div><div class="line"><a name="l05523"></a><span class="lineno"> 5523</span>&#160;</div><div class="line"><a name="l05529"></a><span class="lineno"> 5529</span>&#160;  <span class="keyword">template</span> &lt;<span class="keyword">typename</span> Number, std::<span class="keywordtype">size_t</span> w<span class="keywordtype">id</span>th&gt;</div><div class="line"><a name="l05530"></a><span class="lineno"> 5530</span>&#160;  inline ::VectorizedArray&lt;Number, width&gt;</div><div class="line"><a name="l05531"></a><span class="lineno"><a class="line" href="vectorization_8h.html#aa42ab6dd95b8becedec9f3fb4afb0203"> 5531</a></span>&#160;  min(const ::VectorizedArray&lt;Number, width&gt; &amp;x,</div><div class="line"><a name="l05532"></a><span class="lineno"> 5532</span>&#160;      const ::VectorizedArray&lt;Number, width&gt; &amp;y)</div><div class="line"><a name="l05533"></a><span class="lineno"> 5533</span>&#160;  {</div><div class="line"><a name="l05534"></a><span class="lineno"> 5534</span>&#160;    <span class="keywordflow">return</span> x.get_min(y);</div><div class="line"><a name="l05535"></a><span class="lineno"> 5535</span>&#160;  }</div><div class="line"><a name="l05536"></a><span class="lineno"> 5536</span>&#160;</div><div class="line"><a name="l05537"></a><span class="lineno"> 5537</span>&#160;</div><div class="line"><a name="l05538"></a><span class="lineno"> 5538</span>&#160;</div><div class="line"><a name="l05543"></a><span class="lineno"> 5543</span>&#160;  <span class="keyword">template</span> &lt;<span class="keyword">class</span> T&gt;</div><div class="line"><a name="l05544"></a><span class="lineno"><a class="line" href="structstd_1_1iterator__traits_3_1_1VectorizedArrayIterator_3_01T_01_4_01_4.html"> 5544</a></span>&#160;  <span class="keyword">struct </span>iterator_traits&lt;::<a class="code" href="classVectorizedArrayIterator.html">VectorizedArrayIterator</a>&lt;T&gt;&gt;</div><div class="line"><a name="l05545"></a><span class="lineno"> 5545</span>&#160;  {</div><div class="line"><a name="l05546"></a><span class="lineno"><a class="line" href="structstd_1_1iterator__traits_3_1_1VectorizedArrayIterator_3_01T_01_4_01_4.html#a40dc5ad012012f052621247876247b0f"> 5546</a></span>&#160;    <span class="keyword">using</span> <a class="code" href="structstd_1_1iterator__traits_3_1_1VectorizedArrayIterator_3_01T_01_4_01_4.html#a40dc5ad012012f052621247876247b0f">iterator_category</a> = random_access_iterator_tag;</div><div class="line"><a name="l05547"></a><span class="lineno"><a class="line" href="structstd_1_1iterator__traits_3_1_1VectorizedArrayIterator_3_01T_01_4_01_4.html#a063b6f6d1cc63a3b0a2bb8ef79b9c773"> 5547</a></span>&#160;    <span class="keyword">using</span> <a class="code" href="structstd_1_1iterator__traits_3_1_1VectorizedArrayIterator_3_01T_01_4_01_4.html#a063b6f6d1cc63a3b0a2bb8ef79b9c773">value_type</a>        = <span class="keyword">typename</span> T::value_type;</div><div class="line"><a name="l05548"></a><span class="lineno"><a class="line" href="structstd_1_1iterator__traits_3_1_1VectorizedArrayIterator_3_01T_01_4_01_4.html#a1120d014195db41ca6e94601e6ba647a"> 5548</a></span>&#160;    <span class="keyword">using</span> <a class="code" href="structstd_1_1iterator__traits_3_1_1VectorizedArrayIterator_3_01T_01_4_01_4.html#a1120d014195db41ca6e94601e6ba647a">difference_type</a>   = std::ptrdiff_t;</div><div class="line"><a name="l05549"></a><span class="lineno"> 5549</span>&#160;  };</div><div class="line"><a name="l05550"></a><span class="lineno"> 5550</span>&#160;</div><div class="line"><a name="l05551"></a><span class="lineno"> 5551</span>&#160;} <span class="comment">// namespace std</span></div><div class="line"><a name="l05552"></a><span class="lineno"> 5552</span>&#160;</div><div class="line"><a name="l05553"></a><span class="lineno"> 5553</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l05554"></a><span class="lineno"> 5554</span>&#160;</div><div class="line"><a name="l05555"></a><span class="lineno"> 5555</span>&#160;</div><div class="ttc" id="vectorization_8h_html_a11c48f86a4f2adf21555e64049ecde8c"><div class="ttname"><a href="vectorization_8h.html#a11c48f86a4f2adf21555e64049ecde8c">std::cos</a></div><div class="ttdeci">inline ::VectorizedArray&lt; Number, width &gt; cos(const ::VectorizedArray&lt; Number, width &gt; &amp;x)</div><div class="ttdef"><b>Definition:</b> <a href="vectorization_8h_source.html#l05359">vectorization.h:5359</a></div></div>
<div class="ttc" id="structstd_1_1iterator__traits_3_1_1VectorizedArrayIterator_3_01T_01_4_01_4_html_a1120d014195db41ca6e94601e6ba647a"><div class="ttname"><a href="structstd_1_1iterator__traits_3_1_1VectorizedArrayIterator_3_01T_01_4_01_4.html#a1120d014195db41ca6e94601e6ba647a">std::iterator_traits&lt;::VectorizedArrayIterator&lt; T &gt; &gt;::difference_type</a></div><div class="ttdeci">std::ptrdiff_t difference_type</div><div class="ttdef"><b>Definition:</b> <a href="vectorization_8h_source.html#l05548">vectorization.h:5548</a></div></div>
<div class="ttc" id="vectorization_8h_html_ac274b257ee3ff9666b2062b8ba56db8f"><div class="ttname"><a href="vectorization_8h.html#ac274b257ee3ff9666b2062b8ba56db8f">compare_and_apply_mask</a></div><div class="ttdeci">Number compare_and_apply_mask(const Number &amp;left, const Number &amp;right, const Number &amp;true_value, const Number &amp;false_value)</div><div class="ttdef"><b>Definition:</b> <a href="vectorization_8h_source.html#l05108">vectorization.h:5108</a></div></div>
<div class="ttc" id="numbers_8h_html_a5ecbfe991bebf7e99864f2e4eb3ea8df"><div class="ttname"><a href="numbers_8h.html#a5ecbfe991bebf7e99864f2e4eb3ea8df">std::log</a></div><div class="ttdeci">::VectorizedArray&lt; Number, width &gt; log(const ::VectorizedArray&lt; Number, width &gt; &amp;)</div><div class="ttdef"><b>Definition:</b> <a href="vectorization_8h_source.html#l05421">vectorization.h:5421</a></div></div>
<div class="ttc" id="vectorization_8h_html_a19f846bda83b7e3f4531daacb40c64e1"><div class="ttname"><a href="vectorization_8h.html#a19f846bda83b7e3f4531daacb40c64e1">std::exp</a></div><div class="ttdeci">inline ::VectorizedArray&lt; Number, width &gt; exp(const ::VectorizedArray&lt; Number, width &gt; &amp;x)</div><div class="ttdef"><b>Definition:</b> <a href="vectorization_8h_source.html#l05400">vectorization.h:5400</a></div></div>
<div class="ttc" id="structEnableIfScalar_html_af9b78c6f821c17d862d818dbacbf1813"><div class="ttname"><a href="structEnableIfScalar.html#af9b78c6f821c17d862d818dbacbf1813">EnableIfScalar::operator*</a></div><div class="ttdeci">Point&lt; dim, typename ProductType&lt; Number, typename EnableIfScalar&lt; OtherNumber &gt;::type &gt;::type &gt; operator*(const OtherNumber factor, const Point&lt; dim, Number &gt; &amp;p)</div><div class="ttdef"><b>Definition:</b> <a href="base_2point_8h_source.html#l00606">point.h:606</a></div></div>
<div class="ttc" id="numbers_8h_html_af44aee1db5cdcd0bab54e3c011d2be66"><div class="ttname"><a href="numbers_8h.html#af44aee1db5cdcd0bab54e3c011d2be66">std::pow</a></div><div class="ttdeci">::VectorizedArray&lt; Number, width &gt; pow(const ::VectorizedArray&lt; Number, width &gt; &amp;, const Number p)</div><div class="ttdef"><b>Definition:</b> <a href="vectorization_8h_source.html#l05458">vectorization.h:5458</a></div></div>
<div class="ttc" id="vectorization_8h_html_ad92490d85f7b45a7e55a1a77b1e070b1"><div class="ttname"><a href="vectorization_8h.html#ad92490d85f7b45a7e55a1a77b1e070b1">operator/</a></div><div class="ttdeci">VectorizedArray&lt; Number, width &gt; operator/(const VectorizedArray&lt; Number, width &gt; &amp;u, const VectorizedArray&lt; Number, width &gt; &amp;v)</div><div class="ttdef"><b>Definition:</b> <a href="vectorization_8h_source.html#l04710">vectorization.h:4710</a></div></div>
<div class="ttc" id="vectorization_8h_html_a31b02447b71a04a1ec9bdd1358751e45a96ee5c0e2a7149613e7fd0b83316486e"><div class="ttname"><a href="vectorization_8h.html#a31b02447b71a04a1ec9bdd1358751e45a96ee5c0e2a7149613e7fd0b83316486e">SIMDComparison::not_equal</a></div></div>
<div class="ttc" id="vectorization_8h_html_a078ca5de8d3a59aedc130823be15ad26"><div class="ttname"><a href="vectorization_8h.html#a078ca5de8d3a59aedc130823be15ad26">gather</a></div><div class="ttdeci">void gather(VectorizedArray&lt; Number, width &gt; &amp;out, const std::array&lt; Number *, width &gt; &amp;ptrs, const unsigned int offset)</div><div class="ttdef"><b>Definition:</b> <a href="vectorization_8h_source.html#l00738">vectorization.h:738</a></div></div>
<div class="ttc" id="numbers_8h_html_a02761f62f66f685e954daed42bcb3a1b"><div class="ttname"><a href="numbers_8h.html#a02761f62f66f685e954daed42bcb3a1b">std::cos</a></div><div class="ttdeci">::VectorizedArray&lt; Number, width &gt; cos(const ::VectorizedArray&lt; Number, width &gt; &amp;)</div><div class="ttdef"><b>Definition:</b> <a href="vectorization_8h_source.html#l05359">vectorization.h:5359</a></div></div>
<div class="ttc" id="classVectorizedArray_html_a23cd28d5bd07f3944d7e56fe33f652fc"><div class="ttname"><a href="classVectorizedArray.html#a23cd28d5bd07f3944d7e56fe33f652fc">VectorizedArray::operator+=</a></div><div class="ttdeci">VectorizedArray &amp; operator+=(const VectorizedArray &amp;vec)</div><div class="ttdef"><b>Definition:</b> <a href="vectorization_8h_source.html#l00479">vectorization.h:479</a></div></div>
<div class="ttc" id="classVectorizedArray_html_ac3828c2f77428ee28013df11e678a897"><div class="ttname"><a href="classVectorizedArray.html#ac3828c2f77428ee28013df11e678a897">VectorizedArray::get_sqrt</a></div><div class="ttdeci">VectorizedArray get_sqrt() const</div><div class="ttdef"><b>Definition:</b> <a href="vectorization_8h_source.html#l00610">vectorization.h:610</a></div></div>
<div class="ttc" id="classVectorizedArrayIterator_html_a3d832202485823dcc45057b7353bc89a"><div class="ttname"><a href="classVectorizedArrayIterator.html#a3d832202485823dcc45057b7353bc89a">VectorizedArrayIterator::data</a></div><div class="ttdeci">T * data</div><div class="ttdef"><b>Definition:</b> <a href="vectorization_8h_source.html#l00237">vectorization.h:237</a></div></div>
<div class="ttc" id="numbers_8h_html_a744c1a2f59eee344cde5a970be8e6c99"><div class="ttname"><a href="numbers_8h.html#a744c1a2f59eee344cde5a970be8e6c99">std::tan</a></div><div class="ttdeci">::VectorizedArray&lt; Number, width &gt; tan(const ::VectorizedArray&lt; Number, width &gt; &amp;)</div><div class="ttdef"><b>Definition:</b> <a href="vectorization_8h_source.html#l05379">vectorization.h:5379</a></div></div>
<div class="ttc" id="numbers_8h_html_a27989bdc7b4b828564982787d126bd91"><div class="ttname"><a href="numbers_8h.html#a27989bdc7b4b828564982787d126bd91">std::sin</a></div><div class="ttdeci">::VectorizedArray&lt; Number, width &gt; sin(const ::VectorizedArray&lt; Number, width &gt; &amp;)</div><div class="ttdef"><b>Definition:</b> <a href="vectorization_8h_source.html#l05334">vectorization.h:5334</a></div></div>
<div class="ttc" id="classVectorizedArray_html"><div class="ttname"><a href="classVectorizedArray.html">VectorizedArray</a></div><div class="ttdef"><b>Definition:</b> <a href="vectorization_8h_source.html#l00409">vectorization.h:409</a></div></div>
<div class="ttc" id="group__Exceptions_html_gaafbb69cc2a791ae55880fd8d57d0c1b0"><div class="ttname"><a href="group__Exceptions.html#gaafbb69cc2a791ae55880fd8d57d0c1b0">AssertIndexRange</a></div><div class="ttdeci">#define AssertIndexRange(index, range)</div><div class="ttdef"><b>Definition:</b> <a href="include_2deal_8II_2base_2exceptions_8h_source.html#l01630">exceptions.h:1630</a></div></div>
<div class="ttc" id="classVectorizedArrayBase_html_ac3079ced5292fcebec8a4ff8a6bdb0f0"><div class="ttname"><a href="classVectorizedArrayBase.html#ac3079ced5292fcebec8a4ff8a6bdb0f0">VectorizedArrayBase::begin</a></div><div class="ttdeci">VectorizedArrayIterator&lt; T &gt; begin()</div><div class="ttdef"><b>Definition:</b> <a href="vectorization_8h_source.html#l00276">vectorization.h:276</a></div></div>
<div class="ttc" id="classVectorizedArray_html_ae5fa52c39ffcb5a2e740552a92833009"><div class="ttname"><a href="classVectorizedArray.html#ae5fa52c39ffcb5a2e740552a92833009">VectorizedArray::streaming_store</a></div><div class="ttdeci">void streaming_store(Number *ptr) const</div><div class="ttdef"><b>Definition:</b> <a href="vectorization_8h_source.html#l00559">vectorization.h:559</a></div></div>
<div class="ttc" id="config_8h_html"><div class="ttname"><a href="config_8h.html">config.h</a></div></div>
<div class="ttc" id="grid__tools_8cc_html_ad817a8f7e41831b2c2971f6eb7142f26"><div class="ttname"><a href="grid__tools_8cc.html#ad817a8f7e41831b2c2971f6eb7142f26">v0</a></div><div class="ttdeci">const unsigned int v0</div><div class="ttdef"><b>Definition:</b> <a href="grid__tools_8cc_source.html#l00963">grid_tools.cc:963</a></div></div>
<div class="ttc" id="namespacestd_html"><div class="ttname"><a href="namespacestd.html">std</a></div><div class="ttdoc">STL namespace. </div></div>
<div class="ttc" id="classVectorizedArray_html_aab5595f01cf6de1bb959befa44bb6603"><div class="ttname"><a href="classVectorizedArray.html#aab5595f01cf6de1bb959befa44bb6603">VectorizedArray::operator*=</a></div><div class="ttdeci">VectorizedArray &amp; operator*=(const VectorizedArray &amp;vec)</div><div class="ttdef"><b>Definition:</b> <a href="vectorization_8h_source.html#l00503">vectorization.h:503</a></div></div>
<div class="ttc" id="grid__tools_8cc_html_adec67e1e77f5ae4fad3d65a5fb8036e9"><div class="ttname"><a href="grid__tools_8cc.html#adec67e1e77f5ae4fad3d65a5fb8036e9">v1</a></div><div class="ttdeci">const unsigned int v1</div><div class="ttdef"><b>Definition:</b> <a href="grid__tools_8cc_source.html#l00963">grid_tools.cc:963</a></div></div>
<div class="ttc" id="classVectorizedArrayIterator_html_ac99439a37b8c798eff7e273d86e751c1"><div class="ttname"><a href="classVectorizedArrayIterator.html#ac99439a37b8c798eff7e273d86e751c1">VectorizedArrayIterator::operator*</a></div><div class="ttdeci">std::enable_if&lt;!std::is_same&lt; U, const U &gt;::value, typename T::value_type &gt;::type &amp; operator*()</div><div class="ttdef"><b>Definition:</b> <a href="vectorization_8h_source.html#l00164">vectorization.h:164</a></div></div>
<div class="ttc" id="group__CUDAWrappers_html_ga509717d30efa99a22a7730b16b17b3ab"><div class="ttname"><a href="group__CUDAWrappers.html#ga509717d30efa99a22a7730b16b17b3ab">LinearAlgebra::CUDAWrappers::kernel::vec_add</a></div><div class="ttdeci">__global__ void vec_add(Number *val, const Number a, const size_type N)</div></div>
<div class="ttc" id="vectorization_8h_html_a655230f65541b3787d1f71fa57a44072"><div class="ttname"><a href="vectorization_8h.html#a655230f65541b3787d1f71fa57a44072">operator-</a></div><div class="ttdeci">VectorizedArray&lt; Number, width &gt; operator-(const VectorizedArray&lt; Number, width &gt; &amp;u, const VectorizedArray&lt; Number, width &gt; &amp;v)</div><div class="ttdef"><b>Definition:</b> <a href="vectorization_8h_source.html#l04680">vectorization.h:4680</a></div></div>
<div class="ttc" id="classVectorizedArray_html_a9f2cef2c40dbc7871c7c702bc0cfe533"><div class="ttname"><a href="classVectorizedArray.html#a9f2cef2c40dbc7871c7c702bc0cfe533">VectorizedArray::store</a></div><div class="ttdeci">void store(Number *ptr) const</div><div class="ttdef"><b>Definition:</b> <a href="vectorization_8h_source.html#l00538">vectorization.h:538</a></div></div>
<div class="ttc" id="vectorization_8h_html_a31b02447b71a04a1ec9bdd1358751e45ae69e99a9a1111b6a811f8e5bd832454f"><div class="ttname"><a href="vectorization_8h.html#a31b02447b71a04a1ec9bdd1358751e45ae69e99a9a1111b6a811f8e5bd832454f">SIMDComparison::greater_than_or_equal</a></div></div>
<div class="ttc" id="classVectorizedArray_html_aff4825de67b123e97613fd1f1dd96436"><div class="ttname"><a href="classVectorizedArray.html#aff4825de67b123e97613fd1f1dd96436">VectorizedArray::operator-=</a></div><div class="ttdeci">VectorizedArray &amp; operator-=(const VectorizedArray &amp;vec)</div><div class="ttdef"><b>Definition:</b> <a href="vectorization_8h_source.html#l00491">vectorization.h:491</a></div></div>
<div class="ttc" id="classVectorizedArrayIterator_html_a04edb009a66cc9b4710efbf247ddbe92"><div class="ttname"><a href="classVectorizedArrayIterator.html#a04edb009a66cc9b4710efbf247ddbe92">VectorizedArrayIterator::operator+</a></div><div class="ttdeci">VectorizedArrayIterator&lt; T &gt; operator+(const std::size_t &amp;offset) const</div><div class="ttdef"><b>Definition:</b> <a href="vectorization_8h_source.html#l00215">vectorization.h:215</a></div></div>
<div class="ttc" id="classVectorizedArrayIterator_html_aab509ac7f9e1c0b9c27e43d9f86147f4"><div class="ttname"><a href="classVectorizedArrayIterator.html#aab509ac7f9e1c0b9c27e43d9f86147f4">VectorizedArrayIterator::operator+=</a></div><div class="ttdeci">VectorizedArrayIterator&lt; T &gt; &amp; operator+=(const std::size_t offset)</div><div class="ttdef"><b>Definition:</b> <a href="vectorization_8h_source.html#l00188">vectorization.h:188</a></div></div>
<div class="ttc" id="structinternal_1_1VectorizedArrayWidthSpecifier_html"><div class="ttname"><a href="structinternal_1_1VectorizedArrayWidthSpecifier.html">internal::VectorizedArrayWidthSpecifier</a></div><div class="ttdef"><b>Definition:</b> <a href="numbers_8h_source.html#l00054">numbers.h:54</a></div></div>
<div class="ttc" id="vectorization_8h_html_a31b02447b71a04a1ec9bdd1358751e45a465289687a70db7aa7217cc240c29f0f"><div class="ttname"><a href="vectorization_8h.html#a31b02447b71a04a1ec9bdd1358751e45a465289687a70db7aa7217cc240c29f0f">SIMDComparison::equal</a></div></div>
<div class="ttc" id="vectorization_8h_html_a14da4327264fd3a88a9f73a8f72a9094"><div class="ttname"><a href="vectorization_8h.html#a14da4327264fd3a88a9f73a8f72a9094">vectorized_load_and_transpose</a></div><div class="ttdeci">void vectorized_load_and_transpose(const unsigned int n_entries, const Number *in, const unsigned int *offsets, VectorizedArray&lt; Number, width &gt; *out)</div><div class="ttdef"><b>Definition:</b> <a href="vectorization_8h_source.html#l00771">vectorization.h:771</a></div></div>
<div class="ttc" id="group__Exceptions_html_gae9a45f517af1401c50811a11083f9114"><div class="ttname"><a href="group__Exceptions.html#gae9a45f517af1401c50811a11083f9114">StandardExceptions::ExcMessage</a></div><div class="ttdeci">static ::ExceptionBase &amp; ExcMessage(std::string arg1)</div></div>
<div class="ttc" id="structstd_1_1iterator__traits_3_1_1VectorizedArrayIterator_3_01T_01_4_01_4_html_a40dc5ad012012f052621247876247b0f"><div class="ttname"><a href="structstd_1_1iterator__traits_3_1_1VectorizedArrayIterator_3_01T_01_4_01_4.html#a40dc5ad012012f052621247876247b0f">std::iterator_traits&lt;::VectorizedArrayIterator&lt; T &gt; &gt;::iterator_category</a></div><div class="ttdeci">random_access_iterator_tag iterator_category</div><div class="ttdef"><b>Definition:</b> <a href="vectorization_8h_source.html#l05546">vectorization.h:5546</a></div></div>
<div class="ttc" id="namespaceLAPACKSupport_html_a8cac1e477eff052db622c8a9a9426ea3"><div class="ttname"><a href="namespaceLAPACKSupport.html#a8cac1e477eff052db622c8a9a9426ea3">LAPACKSupport::T</a></div><div class="ttdeci">static const char T</div><div class="ttdef"><b>Definition:</b> <a href="lapack__support_8h_source.html#l00173">lapack_support.h:173</a></div></div>
<div class="ttc" id="classVectorizedArray_html_a137b7cf45664efddbc332cad9c5c8839"><div class="ttname"><a href="classVectorizedArray.html#a137b7cf45664efddbc332cad9c5c8839">VectorizedArray::gather</a></div><div class="ttdeci">void gather(const Number *base_ptr, const unsigned int *offsets)</div><div class="ttdef"><b>Definition:</b> <a href="vectorization_8h_source.html#l00576">vectorization.h:576</a></div></div>
<div class="ttc" id="classVectorizedArrayIterator_html_aa88eaef9423311e81e73d13ff20e7c64"><div class="ttname"><a href="classVectorizedArrayIterator.html#aa88eaef9423311e81e73d13ff20e7c64">VectorizedArrayIterator::VectorizedArrayIterator</a></div><div class="ttdeci">VectorizedArrayIterator(T &amp;data, const std::size_t lane)</div><div class="ttdef"><b>Definition:</b> <a href="vectorization_8h_source.html#l00108">vectorization.h:108</a></div></div>
<div class="ttc" id="vectorization_8h_html_ac2d0134a018bfda1707088d44fa20a86"><div class="ttname"><a href="vectorization_8h.html#ac2d0134a018bfda1707088d44fa20a86">std::tan</a></div><div class="ttdeci">inline ::VectorizedArray&lt; Number, width &gt; tan(const ::VectorizedArray&lt; Number, width &gt; &amp;x)</div><div class="ttdef"><b>Definition:</b> <a href="vectorization_8h_source.html#l05379">vectorization.h:5379</a></div></div>
<div class="ttc" id="classVectorizedArrayIterator_html"><div class="ttname"><a href="classVectorizedArrayIterator.html">VectorizedArrayIterator</a></div><div class="ttdef"><b>Definition:</b> <a href="vectorization_8h_source.html#l00100">vectorization.h:100</a></div></div>
<div class="ttc" id="group__Exceptions_html_ga70a0bb353656e704acf927945277bbc6"><div class="ttname"><a href="group__Exceptions.html#ga70a0bb353656e704acf927945277bbc6">Assert</a></div><div class="ttdeci">#define Assert(cond, exc)</div><div class="ttdef"><b>Definition:</b> <a href="include_2deal_8II_2base_2exceptions_8h_source.html#l01415">exceptions.h:1415</a></div></div>
<div class="ttc" id="classVectorizedArray_html_ad38190d02537705964e021da7ecbab3f"><div class="ttname"><a href="classVectorizedArray.html#ad38190d02537705964e021da7ecbab3f">VectorizedArray::data</a></div><div class="ttdeci">Number data</div><div class="ttdef"><b>Definition:</b> <a href="vectorization_8h_source.html#l00601">vectorization.h:601</a></div></div>
<div class="ttc" id="classVectorizedArrayIterator_html_a8bf1cdfcc45f1a960d59ccf5c180490b"><div class="ttname"><a href="classVectorizedArrayIterator.html#a8bf1cdfcc45f1a960d59ccf5c180490b">VectorizedArrayIterator::operator==</a></div><div class="ttdeci">bool operator==(const VectorizedArrayIterator&lt; T &gt; &amp;other) const</div><div class="ttdef"><b>Definition:</b> <a href="vectorization_8h_source.html#l00118">vectorization.h:118</a></div></div>
<div class="ttc" id="classVectorizedArrayIterator_html_a6ce102e8f469efe6a63bcbed0f643099"><div class="ttname"><a href="classVectorizedArrayIterator.html#a6ce102e8f469efe6a63bcbed0f643099">VectorizedArrayIterator::operator-</a></div><div class="ttdeci">std::ptrdiff_t operator-(const VectorizedArrayIterator&lt; T &gt; &amp;other) const</div><div class="ttdef"><b>Definition:</b> <a href="vectorization_8h_source.html#l00226">vectorization.h:226</a></div></div>
<div class="ttc" id="template__constraints_8h_html"><div class="ttname"><a href="template__constraints_8h.html">template_constraints.h</a></div></div>
<div class="ttc" id="vectorization_8h_html_a2aa674852f105b0ed1b35f569c19fea6"><div class="ttname"><a href="vectorization_8h.html#a2aa674852f105b0ed1b35f569c19fea6">std::log</a></div><div class="ttdeci">inline ::VectorizedArray&lt; Number, width &gt; log(const ::VectorizedArray&lt; Number, width &gt; &amp;x)</div><div class="ttdef"><b>Definition:</b> <a href="vectorization_8h_source.html#l05421">vectorization.h:5421</a></div></div>
<div class="ttc" id="numbers_8h_html_ac4a2ed1890a931d0b6a55933310eadca"><div class="ttname"><a href="numbers_8h.html#ac4a2ed1890a931d0b6a55933310eadca">std::sqrt</a></div><div class="ttdeci">::VectorizedArray&lt; Number, width &gt; sqrt(const ::VectorizedArray&lt; Number, width &gt; &amp;)</div><div class="ttdef"><b>Definition:</b> <a href="vectorization_8h_source.html#l05442">vectorization.h:5442</a></div></div>
<div class="ttc" id="numbers_8h_html_a372e01cd9d1d07fdf136f4f40975d5cf"><div class="ttname"><a href="numbers_8h.html#a372e01cd9d1d07fdf136f4f40975d5cf">std::exp</a></div><div class="ttdeci">::VectorizedArray&lt; Number, width &gt; exp(const ::VectorizedArray&lt; Number, width &gt; &amp;)</div><div class="ttdef"><b>Definition:</b> <a href="vectorization_8h_source.html#l05400">vectorization.h:5400</a></div></div>
<div class="ttc" id="config_8h_html_a998f224639942da0567cbd1ec77913b7"><div class="ttname"><a href="config_8h.html#a998f224639942da0567cbd1ec77913b7">DEAL_II_NAMESPACE_CLOSE</a></div><div class="ttdeci">#define DEAL_II_NAMESPACE_CLOSE</div><div class="ttdef"><b>Definition:</b> <a href="config_8h_source.html#l00399">config.h:399</a></div></div>
<div class="ttc" id="classVectorizedArray_html_ab0c3d5bcdf208c37fc1f8055765c03b1"><div class="ttname"><a href="classVectorizedArray.html#ab0c3d5bcdf208c37fc1f8055765c03b1">VectorizedArray::load</a></div><div class="ttdeci">void load(const Number *ptr)</div><div class="ttdef"><b>Definition:</b> <a href="vectorization_8h_source.html#l00527">vectorization.h:527</a></div></div>
<div class="ttc" id="config_8h_html_a1d1d58e8be15e5c4285f6892e5f33136"><div class="ttname"><a href="config_8h.html#a1d1d58e8be15e5c4285f6892e5f33136">DEAL_II_ALWAYS_INLINE</a></div><div class="ttdeci">#define DEAL_II_ALWAYS_INLINE</div><div class="ttdef"><b>Definition:</b> <a href="config_8h_source.html#l00096">config.h:96</a></div></div>
<div class="ttc" id="classVectorizedArrayIterator_html_aebfab490af179c78ee97f1407a8cd9bc"><div class="ttname"><a href="classVectorizedArrayIterator.html#aebfab490af179c78ee97f1407a8cd9bc">VectorizedArrayIterator::operator!=</a></div><div class="ttdeci">bool operator!=(const VectorizedArrayIterator&lt; T &gt; &amp;other) const</div><div class="ttdef"><b>Definition:</b> <a href="vectorization_8h_source.html#l00131">vectorization.h:131</a></div></div>
<div class="ttc" id="classVectorizedArray_html_a84c9518b5e35e5596944e124d6a3a2d9"><div class="ttname"><a href="classVectorizedArray.html#a84c9518b5e35e5596944e124d6a3a2d9">VectorizedArray::get_min</a></div><div class="ttdeci">VectorizedArray get_min(const VectorizedArray &amp;other) const</div><div class="ttdef"><b>Definition:</b> <a href="vectorization_8h_source.html#l00649">vectorization.h:649</a></div></div>
<div class="ttc" id="classVectorizedArrayBase_html_acb35404acc1693aee6e990228924cc09"><div class="ttname"><a href="classVectorizedArrayBase.html#acb35404acc1693aee6e990228924cc09">VectorizedArrayBase::size</a></div><div class="ttdeci">static constexpr std::size_t size()</div><div class="ttdef"><b>Definition:</b> <a href="vectorization_8h_source.html#l00266">vectorization.h:266</a></div></div>
<div class="ttc" id="namespaceDifferentiation_1_1SD_html_a592560ee80355620422a86087f11b9df"><div class="ttname"><a href="namespaceDifferentiation_1_1SD.html#a592560ee80355620422a86087f11b9df">Differentiation::SD::fabs</a></div><div class="ttdeci">Expression fabs(const Expression &amp;x)</div><div class="ttdef"><b>Definition:</b> <a href="symengine__math_8cc_source.html#l00273">symengine_math.cc:273</a></div></div>
<div class="ttc" id="classVectorizedArrayIterator_html_a396f2193b51e7ef97f6c7f73fa7baf3a"><div class="ttname"><a href="classVectorizedArrayIterator.html#a396f2193b51e7ef97f6c7f73fa7baf3a">VectorizedArrayIterator::lane</a></div><div class="ttdeci">std::size_t lane</div><div class="ttdef"><b>Definition:</b> <a href="vectorization_8h_source.html#l00243">vectorization.h:243</a></div></div>
<div class="ttc" id="include_2deal_8II_2base_2exceptions_8h_html"><div class="ttname"><a href="include_2deal_8II_2base_2exceptions_8h.html">exceptions.h</a></div></div>
<div class="ttc" id="vectorization_8h_html_a31b02447b71a04a1ec9bdd1358751e45a7875e44acb1bebecb46c929deb43cef4"><div class="ttname"><a href="vectorization_8h.html#a31b02447b71a04a1ec9bdd1358751e45a7875e44acb1bebecb46c929deb43cef4">SIMDComparison::less_than</a></div></div>
<div class="ttc" id="classVectorizedArray_html_a4bab1253b131475943b076b83179ae76"><div class="ttname"><a href="classVectorizedArray.html#a4bab1253b131475943b076b83179ae76">VectorizedArray::operator=</a></div><div class="ttdeci">VectorizedArray &amp; operator=(const Number scalar)</div><div class="ttdef"><b>Definition:</b> <a href="vectorization_8h_source.html#l00443">vectorization.h:443</a></div></div>
<div class="ttc" id="classVectorizedArray_html_a6bce743d38c5e0afd42e8834f8f6dabf"><div class="ttname"><a href="classVectorizedArray.html#a6bce743d38c5e0afd42e8834f8f6dabf">VectorizedArray::get_max</a></div><div class="ttdeci">VectorizedArray get_max(const VectorizedArray &amp;other) const</div><div class="ttdef"><b>Definition:</b> <a href="vectorization_8h_source.html#l00636">vectorization.h:636</a></div></div>
<div class="ttc" id="vectorization_8h_html_a31b02447b71a04a1ec9bdd1358751e45"><div class="ttname"><a href="vectorization_8h.html#a31b02447b71a04a1ec9bdd1358751e45">SIMDComparison</a></div><div class="ttdeci">SIMDComparison</div><div class="ttdef"><b>Definition:</b> <a href="vectorization_8h_source.html#l05027">vectorization.h:5027</a></div></div>
<div class="ttc" id="classVectorizedArrayIterator_html_a2a2b466061bfd63279b534a151904bea"><div class="ttname"><a href="classVectorizedArrayIterator.html#a2a2b466061bfd63279b534a151904bea">VectorizedArrayIterator::operator--</a></div><div class="ttdeci">VectorizedArrayIterator&lt; T &gt; &amp; operator--()</div><div class="ttdef"><b>Definition:</b> <a href="vectorization_8h_source.html#l00200">vectorization.h:200</a></div></div>
<div class="ttc" id="classVectorizedArrayBase_html"><div class="ttname"><a href="classVectorizedArrayBase.html">VectorizedArrayBase</a></div><div class="ttdef"><b>Definition:</b> <a href="vectorization_8h_source.html#l00258">vectorization.h:258</a></div></div>
<div class="ttc" id="classVectorizedArray_html_ad5e3061a2d2cf13c446354059e6fa8ef"><div class="ttname"><a href="classVectorizedArray.html#ad5e3061a2d2cf13c446354059e6fa8ef">VectorizedArray&lt; Number &gt;::value_type</a></div><div class="ttdeci">Number value_type</div><div class="ttdef"><b>Definition:</b> <a href="vectorization_8h_source.html#l00417">vectorization.h:417</a></div></div>
<div class="ttc" id="structEnableIfScalar_html"><div class="ttname"><a href="structEnableIfScalar.html">EnableIfScalar</a></div><div class="ttdef"><b>Definition:</b> <a href="template__constraints_8h_source.html#l00413">template_constraints.h:413</a></div></div>
<div class="ttc" id="classVectorizedArrayBase_html_a78e62fef92c4dd89eee5bcd616be5ef0"><div class="ttname"><a href="classVectorizedArrayBase.html#a78e62fef92c4dd89eee5bcd616be5ef0">VectorizedArrayBase::end</a></div><div class="ttdeci">VectorizedArrayIterator&lt; T &gt; end()</div><div class="ttdef"><b>Definition:</b> <a href="vectorization_8h_source.html#l00296">vectorization.h:296</a></div></div>
<div class="ttc" id="vectorization_8h_html_ae5c8b2cd70b2640bab8f1ee4ccb7f4cc"><div class="ttname"><a href="vectorization_8h.html#ae5c8b2cd70b2640bab8f1ee4ccb7f4cc">std::pow</a></div><div class="ttdeci">inline ::VectorizedArray&lt; Number, width &gt; pow(const ::VectorizedArray&lt; Number, width &gt; &amp;x, const ::VectorizedArray&lt; Number, width &gt; &amp;p)</div><div class="ttdef"><b>Definition:</b> <a href="vectorization_8h_source.html#l05480">vectorization.h:5480</a></div></div>
<div class="ttc" id="classVectorizedArray_html_a73ed02d36053ebd2d903eac17fc832d2"><div class="ttname"><a href="classVectorizedArray.html#a73ed02d36053ebd2d903eac17fc832d2">VectorizedArray::operator/=</a></div><div class="ttdeci">VectorizedArray &amp; operator/=(const VectorizedArray &amp;vec)</div><div class="ttdef"><b>Definition:</b> <a href="vectorization_8h_source.html#l00515">vectorization.h:515</a></div></div>
<div class="ttc" id="vectorization_8h_html_ad938a80e7098f4bf2193b14a14e73460"><div class="ttname"><a href="vectorization_8h.html#ad938a80e7098f4bf2193b14a14e73460">operator+</a></div><div class="ttdeci">VectorizedArray&lt; Number, width &gt; operator+(const VectorizedArray&lt; Number, width &gt; &amp;u, const VectorizedArray&lt; Number, width &gt; &amp;v)</div><div class="ttdef"><b>Definition:</b> <a href="vectorization_8h_source.html#l04663">vectorization.h:4663</a></div></div>
<div class="ttc" id="numbers_8h_html_a0ebae11c64606a73e80a6328b1ab0802"><div class="ttname"><a href="numbers_8h.html#a0ebae11c64606a73e80a6328b1ab0802">std::abs</a></div><div class="ttdeci">::VectorizedArray&lt; Number, width &gt; abs(const ::VectorizedArray&lt; Number, width &gt; &amp;)</div><div class="ttdef"><b>Definition:</b> <a href="vectorization_8h_source.html#l05502">vectorization.h:5502</a></div></div>
<div class="ttc" id="classVectorizedArrayIterator_html_afc5b011dc689df8f4a1cd07e18af4471"><div class="ttname"><a href="classVectorizedArrayIterator.html#afc5b011dc689df8f4a1cd07e18af4471">VectorizedArrayIterator::operator*</a></div><div class="ttdeci">const T::value_type &amp; operator*() const</div><div class="ttdef"><b>Definition:</b> <a href="vectorization_8h_source.html#l00150">vectorization.h:150</a></div></div>
<div class="ttc" id="classVectorizedArray_html_a99f8bdefac7d751bef7e42be5dae12fa"><div class="ttname"><a href="classVectorizedArray.html#a99f8bdefac7d751bef7e42be5dae12fa">VectorizedArray::operator[]</a></div><div class="ttdeci">Number &amp; operator[](const unsigned int comp)</div><div class="ttdef"><b>Definition:</b> <a href="vectorization_8h_source.html#l00454">vectorization.h:454</a></div></div>
<div class="ttc" id="config_8h_html_a37029dc5bac94f70ea13386b692956b6"><div class="ttname"><a href="config_8h.html#a37029dc5bac94f70ea13386b692956b6">DEAL_II_NAMESPACE_OPEN</a></div><div class="ttdeci">#define DEAL_II_NAMESPACE_OPEN</div><div class="ttdef"><b>Definition:</b> <a href="config_8h_source.html#l00398">config.h:398</a></div></div>
<div class="ttc" id="vectorization_8h_html_a31b02447b71a04a1ec9bdd1358751e45af9001e5685fe6f7cb467dc66269470b2"><div class="ttname"><a href="vectorization_8h.html#a31b02447b71a04a1ec9bdd1358751e45af9001e5685fe6f7cb467dc66269470b2">SIMDComparison::greater_than</a></div></div>
<div class="ttc" id="classVectorizedArrayBase_html_a4abc43c177332ab7133ae7b42850c3cc"><div class="ttname"><a href="classVectorizedArrayBase.html#a4abc43c177332ab7133ae7b42850c3cc">VectorizedArrayBase::begin</a></div><div class="ttdeci">VectorizedArrayIterator&lt; const T &gt; begin() const</div><div class="ttdef"><b>Definition:</b> <a href="vectorization_8h_source.html#l00286">vectorization.h:286</a></div></div>
<div class="ttc" id="structstd_1_1iterator__traits_3_1_1VectorizedArrayIterator_3_01T_01_4_01_4_html_a063b6f6d1cc63a3b0a2bb8ef79b9c773"><div class="ttname"><a href="structstd_1_1iterator__traits_3_1_1VectorizedArrayIterator_3_01T_01_4_01_4.html#a063b6f6d1cc63a3b0a2bb8ef79b9c773">std::iterator_traits&lt;::VectorizedArrayIterator&lt; T &gt; &gt;::value_type</a></div><div class="ttdeci">typename T::value_type value_type</div><div class="ttdef"><b>Definition:</b> <a href="vectorization_8h_source.html#l05547">vectorization.h:5547</a></div></div>
<div class="ttc" id="classVectorizedArray_html_a6367cca1b81fc817e58f1d961d223fc4"><div class="ttname"><a href="classVectorizedArray.html#a6367cca1b81fc817e58f1d961d223fc4">VectorizedArray::VectorizedArray</a></div><div class="ttdeci">VectorizedArray(const Number scalar)</div><div class="ttdef"><b>Definition:</b> <a href="vectorization_8h_source.html#l00432">vectorization.h:432</a></div></div>
<div class="ttc" id="classVectorizedArrayBase_html_a60230d197dc20a35c0fe0289e4a03b53"><div class="ttname"><a href="classVectorizedArrayBase.html#a60230d197dc20a35c0fe0289e4a03b53">VectorizedArrayBase::end</a></div><div class="ttdeci">VectorizedArrayIterator&lt; const T &gt; end() const</div><div class="ttdef"><b>Definition:</b> <a href="vectorization_8h_source.html#l00306">vectorization.h:306</a></div></div>
<div class="ttc" id="vectorization_8h_html_a60e4e5dd338cf4353bbdccc117fa883d"><div class="ttname"><a href="vectorization_8h.html#a60e4e5dd338cf4353bbdccc117fa883d">operator==</a></div><div class="ttdeci">bool operator==(const VectorizedArray&lt; Number, width &gt; &amp;lhs, const VectorizedArray&lt; Number, width &gt; &amp;rhs)</div><div class="ttdef"><b>Definition:</b> <a href="vectorization_8h_source.html#l04644">vectorization.h:4644</a></div></div>
<div class="ttc" id="vectorization_8h_html_ad7d7e08942faeecf438c75a254e06cbe"><div class="ttname"><a href="vectorization_8h.html#ad7d7e08942faeecf438c75a254e06cbe">make_vectorized_array</a></div><div class="ttdeci">VectorizedArray&lt; Number, width &gt; make_vectorized_array(const Number &amp;u)</div><div class="ttdef"><b>Definition:</b> <a href="vectorization_8h_source.html#l00693">vectorization.h:693</a></div></div>
<div class="ttc" id="classVectorizedArrayIterator_html_abcd785ad700ce2660fc5edfe7a960b3b"><div class="ttname"><a href="classVectorizedArrayIterator.html#abcd785ad700ce2660fc5edfe7a960b3b">VectorizedArrayIterator::operator++</a></div><div class="ttdeci">VectorizedArrayIterator&lt; T &gt; &amp; operator++()</div><div class="ttdef"><b>Definition:</b> <a href="vectorization_8h_source.html#l00175">vectorization.h:175</a></div></div>
<div class="ttc" id="namespaceEvaluationFlags_html_a9b7c6d689cb76386839d0d13640f59aeaf9825c682f693a6a200094641a0d6a58"><div class="ttname"><a href="namespaceEvaluationFlags.html#a9b7c6d689cb76386839d0d13640f59aeaf9825c682f693a6a200094641a0d6a58">EvaluationFlags::values</a></div><div class="ttdef"><b>Definition:</b> <a href="evaluation__flags_8h_source.html#l00054">evaluation_flags.h:54</a></div></div>
<div class="ttc" id="vectorization_8h_html_a31b02447b71a04a1ec9bdd1358751e45a9f6a1c1739ff468513ed276436f3db72"><div class="ttname"><a href="vectorization_8h.html#a31b02447b71a04a1ec9bdd1358751e45a9f6a1c1739ff468513ed276436f3db72">SIMDComparison::less_than_or_equal</a></div></div>
<div class="ttc" id="vectorization_8h_html_af396b43c783502e8acd2ca7d071a7325"><div class="ttname"><a href="vectorization_8h.html#af396b43c783502e8acd2ca7d071a7325">vectorized_transpose_and_store</a></div><div class="ttdeci">void vectorized_transpose_and_store(const bool add_into, const unsigned int n_entries, const VectorizedArray&lt; Number, width &gt; *in, const unsigned int *offsets, Number *out)</div><div class="ttdef"><b>Definition:</b> <a href="vectorization_8h_source.html#l00834">vectorization.h:834</a></div></div>
<div class="ttc" id="classVectorizedArray_html_ab40f56a62c0f7c527629540a7af0d9d0"><div class="ttname"><a href="classVectorizedArray.html#ab40f56a62c0f7c527629540a7af0d9d0">VectorizedArray::operator[]</a></div><div class="ttdeci">const Number &amp; operator[](const unsigned int comp) const</div><div class="ttdef"><b>Definition:</b> <a href="vectorization_8h_source.html#l00466">vectorization.h:466</a></div></div>
<div class="ttc" id="classVectorizedArray_html_a29d1dcaad4340a1a08f9660ff3f4ac7f"><div class="ttname"><a href="classVectorizedArray.html#a29d1dcaad4340a1a08f9660ff3f4ac7f">VectorizedArray::get_abs</a></div><div class="ttdeci">VectorizedArray get_abs() const</div><div class="ttdef"><b>Definition:</b> <a href="vectorization_8h_source.html#l00623">vectorization.h:623</a></div></div>
<div class="ttc" id="classVectorizedArray_html_aa05c67eb5742dc4eea633174e8a88986"><div class="ttname"><a href="classVectorizedArray.html#aa05c67eb5742dc4eea633174e8a88986">VectorizedArray::scatter</a></div><div class="ttdeci">void scatter(const unsigned int *offsets, Number *base_ptr) const</div><div class="ttdef"><b>Definition:</b> <a href="vectorization_8h_source.html#l00592">vectorization.h:592</a></div></div>
<div class="ttc" id="classint_html"><div class="ttname"><a href="classint.html">int</a></div></div>
<div class="ttc" id="vectorization_8h_html_ad9b7aa5c50bf9ce988a0f756a3f2baa5"><div class="ttname"><a href="vectorization_8h.html#ad9b7aa5c50bf9ce988a0f756a3f2baa5">std::sin</a></div><div class="ttdeci">inline ::VectorizedArray&lt; Number, width &gt; sin(const ::VectorizedArray&lt; Number, width &gt; &amp;x)</div><div class="ttdef"><b>Definition:</b> <a href="vectorization_8h_source.html#l05334">vectorization.h:5334</a></div></div>
</div><!-- fragment --></div><!-- contents -->
<!-- HTML footer for doxygen 1.8.13-->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.13
</small></address>
</body>
</html>
